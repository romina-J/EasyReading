var classMapping = {'ContinuousChoiceButton':ContinuousChoiceButton,'AudioHighlighter':AudioHighlighter,'TwoStateButton':TwoStateButton,'AutoButton':AutoButton,'ContentReplacementSwitcher':ContentReplacementSwitcher,'Button':Button,'SingleChoiceButton':SingleChoiceButton,'TippyTooltip':TippyTooltip,'TabSlideOutUserInterface':TabSlideOutUserInterface,'SpinnerBusyAnimation':SpinnerBusyAnimation,};if(functionMapping){delete functionMapping;}  var functionMapping = {'colorize':colorize,'magnifyFont':magnifyFont,'shrinkFont':shrinkFont,'increaseLineHeight':increaseLineHeight,'decreaseLineHeight':decreaseLineHeight,'readability':readability,'easyReadingScreenRuler':easyReadingScreenRuler,};

let uiCollection = {
    "id": 22,
    "googleID": "",
    "email": "anonym8319283@easyreading.eu",
    "locale": "de",
    "type": 1,
    "ui_mode": "adaptable",
    "userLoaded": true,
    "userInterfaces": [
        {
            "source": {
                "id": "tab-slide-out",
                "name": "TabSlideOut",
                "description": "Simple tab slide out",
                "version": "1.0",
                "versionDescription": "Initial Version",
                "debugMode": false,
                "remoteAssetDirectory": "/components/user-interface/tab-slide-out/1.0/ui/images",
                "remoteBaseDirectory": "components/user-interface/tab-slide-out/1.0/",
                "implementationClass": "TabSlideOutUserInterface",
                "contentScripts": [
                    {
                        "id": "ui/jquery-ui.js",
                        "source": "LyohIGpRdWVyeSBVSSAtIHYxLjEyLjEgLSAyMDE2LTA5LTE0DQoqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiogSW5jbHVkZXM6IHdpZGdldC5qcywgcG9zaXRpb24uanMsIGRhdGEuanMsIGRpc2FibGUtc2VsZWN0aW9uLmpzLCBlZmZlY3QuanMsIGVmZmVjdHMvZWZmZWN0LWJsaW5kLmpzLCBlZmZlY3RzL2VmZmVjdC1ib3VuY2UuanMsIGVmZmVjdHMvZWZmZWN0LWNsaXAuanMsIGVmZmVjdHMvZWZmZWN0LWRyb3AuanMsIGVmZmVjdHMvZWZmZWN0LWV4cGxvZGUuanMsIGVmZmVjdHMvZWZmZWN0LWZhZGUuanMsIGVmZmVjdHMvZWZmZWN0LWZvbGQuanMsIGVmZmVjdHMvZWZmZWN0LWhpZ2hsaWdodC5qcywgZWZmZWN0cy9lZmZlY3QtcHVmZi5qcywgZWZmZWN0cy9lZmZlY3QtcHVsc2F0ZS5qcywgZWZmZWN0cy9lZmZlY3Qtc2NhbGUuanMsIGVmZmVjdHMvZWZmZWN0LXNoYWtlLmpzLCBlZmZlY3RzL2VmZmVjdC1zaXplLmpzLCBlZmZlY3RzL2VmZmVjdC1zbGlkZS5qcywgZWZmZWN0cy9lZmZlY3QtdHJhbnNmZXIuanMsIGZvY3VzYWJsZS5qcywgZm9ybS1yZXNldC1taXhpbi5qcywganF1ZXJ5LTEtNy5qcywga2V5Y29kZS5qcywgbGFiZWxzLmpzLCBzY3JvbGwtcGFyZW50LmpzLCB0YWJiYWJsZS5qcywgdW5pcXVlLWlkLmpzLCB3aWRnZXRzL2FjY29yZGlvbi5qcywgd2lkZ2V0cy9hdXRvY29tcGxldGUuanMsIHdpZGdldHMvYnV0dG9uLmpzLCB3aWRnZXRzL2NoZWNrYm94cmFkaW8uanMsIHdpZGdldHMvY29udHJvbGdyb3VwLmpzLCB3aWRnZXRzL2RhdGVwaWNrZXIuanMsIHdpZGdldHMvZGlhbG9nLmpzLCB3aWRnZXRzL2RyYWdnYWJsZS5qcywgd2lkZ2V0cy9kcm9wcGFibGUuanMsIHdpZGdldHMvbWVudS5qcywgd2lkZ2V0cy9tb3VzZS5qcywgd2lkZ2V0cy9wcm9ncmVzc2Jhci5qcywgd2lkZ2V0cy9yZXNpemFibGUuanMsIHdpZGdldHMvc2VsZWN0YWJsZS5qcywgd2lkZ2V0cy9zZWxlY3RtZW51LmpzLCB3aWRnZXRzL3NsaWRlci5qcywgd2lkZ2V0cy9zb3J0YWJsZS5qcywgd2lkZ2V0cy9zcGlubmVyLmpzLCB3aWRnZXRzL3RhYnMuanMsIHdpZGdldHMvdG9vbHRpcC5qcw0KKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yczsgTGljZW5zZWQgTUlUICovDQoNCihmdW5jdGlvbiggZmFjdG9yeSApIHsNCiAgICBpZiAoIHR5cGVvZiBkZWZpbmUgPT09ICJmdW5jdGlvbiIgJiYgZGVmaW5lLmFtZCApIHsNCg0KICAgICAgICAvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuDQogICAgICAgIGRlZmluZShbICJqcXVlcnkiIF0sIGZhY3RvcnkgKTsNCiAgICB9IGVsc2Ugew0KDQogICAgICAgIC8vIEJyb3dzZXIgZ2xvYmFscw0KICAgICAgICBmYWN0b3J5KCBqUXVlcnkgKTsNCiAgICB9DQp9KGZ1bmN0aW9uKCAkICkgew0KDQogICAgJC51aSA9ICQudWkgfHwge307DQoNCiAgICB2YXIgdmVyc2lvbiA9ICQudWkudmVyc2lvbiA9ICIxLjEyLjEiOw0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBXaWRnZXQgMS4xMi4xDQogKiBodHRwOi8vanF1ZXJ5dWkuY29tDQogKg0KICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMNCiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UNCiAqLw0KDQovLz4+bGFiZWw6IFdpZGdldA0KLy8+Pmdyb3VwOiBDb3JlDQovLz4+ZGVzY3JpcHRpb246IFByb3ZpZGVzIGEgZmFjdG9yeSBmb3IgY3JlYXRpbmcgc3RhdGVmdWwgd2lkZ2V0cyB3aXRoIGEgY29tbW9uIEFQSS4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9qUXVlcnkud2lkZ2V0Lw0KLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL3dpZGdldC8NCg0KDQoNCiAgICB2YXIgd2lkZ2V0VXVpZCA9IDA7DQogICAgdmFyIHdpZGdldFNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlOw0KDQogICAgJC5jbGVhbkRhdGEgPSAoIGZ1bmN0aW9uKCBvcmlnICkgew0KICAgICAgICByZXR1cm4gZnVuY3Rpb24oIGVsZW1zICkgew0KICAgICAgICAgICAgdmFyIGV2ZW50cywgZWxlbSwgaTsNCiAgICAgICAgICAgIGZvciAoIGkgPSAwOyAoIGVsZW0gPSBlbGVtc1sgaSBdICkgIT0gbnVsbDsgaSsrICkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gT25seSB0cmlnZ2VyIHJlbW92ZSB3aGVuIG5lY2Vzc2FyeSB0byBzYXZlIHRpbWUNCiAgICAgICAgICAgICAgICAgICAgZXZlbnRzID0gJC5fZGF0YSggZWxlbSwgImV2ZW50cyIgKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBldmVudHMgJiYgZXZlbnRzLnJlbW92ZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQoIGVsZW0gKS50cmlnZ2VySGFuZGxlciggInJlbW92ZSIgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIEh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzgyMzUNCiAgICAgICAgICAgICAgICB9IGNhdGNoICggZSApIHt9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBvcmlnKCBlbGVtcyApOw0KICAgICAgICB9Ow0KICAgIH0gKSggJC5jbGVhbkRhdGEgKTsNCg0KICAgICQud2lkZ2V0ID0gZnVuY3Rpb24oIG5hbWUsIGJhc2UsIHByb3RvdHlwZSApIHsNCiAgICAgICAgdmFyIGV4aXN0aW5nQ29uc3RydWN0b3IsIGNvbnN0cnVjdG9yLCBiYXNlUHJvdG90eXBlOw0KDQogICAgICAgIC8vIFByb3hpZWRQcm90b3R5cGUgYWxsb3dzIHRoZSBwcm92aWRlZCBwcm90b3R5cGUgdG8gcmVtYWluIHVubW9kaWZpZWQNCiAgICAgICAgLy8gc28gdGhhdCBpdCBjYW4gYmUgdXNlZCBhcyBhIG1peGluIGZvciBtdWx0aXBsZSB3aWRnZXRzICgjODg3NikNCiAgICAgICAgdmFyIHByb3hpZWRQcm90b3R5cGUgPSB7fTsNCg0KICAgICAgICB2YXIgbmFtZXNwYWNlID0gbmFtZS5zcGxpdCggIi4iIClbIDAgXTsNCiAgICAgICAgbmFtZSA9IG5hbWUuc3BsaXQoICIuIiApWyAxIF07DQogICAgICAgIHZhciBmdWxsTmFtZSA9IG5hbWVzcGFjZSArICItIiArIG5hbWU7DQoNCiAgICAgICAgaWYgKCAhcHJvdG90eXBlICkgew0KICAgICAgICAgICAgcHJvdG90eXBlID0gYmFzZTsNCiAgICAgICAgICAgIGJhc2UgPSAkLldpZGdldDsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICggJC5pc0FycmF5KCBwcm90b3R5cGUgKSApIHsNCiAgICAgICAgICAgIHByb3RvdHlwZSA9ICQuZXh0ZW5kLmFwcGx5KCBudWxsLCBbIHt9IF0uY29uY2F0KCBwcm90b3R5cGUgKSApOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQ3JlYXRlIHNlbGVjdG9yIGZvciBwbHVnaW4NCiAgICAgICAgJC5leHByWyAiOiIgXVsgZnVsbE5hbWUudG9Mb3dlckNhc2UoKSBdID0gZnVuY3Rpb24oIGVsZW0gKSB7DQogICAgICAgICAgICByZXR1cm4gISEkLmRhdGEoIGVsZW0sIGZ1bGxOYW1lICk7DQogICAgICAgIH07DQoNCiAgICAgICAgJFsgbmFtZXNwYWNlIF0gPSAkWyBuYW1lc3BhY2UgXSB8fCB7fTsNCiAgICAgICAgZXhpc3RpbmdDb25zdHJ1Y3RvciA9ICRbIG5hbWVzcGFjZSBdWyBuYW1lIF07DQogICAgICAgIGNvbnN0cnVjdG9yID0gJFsgbmFtZXNwYWNlIF1bIG5hbWUgXSA9IGZ1bmN0aW9uKCBvcHRpb25zLCBlbGVtZW50ICkgew0KDQogICAgICAgICAgICAvLyBBbGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgIm5ldyIga2V5d29yZA0KICAgICAgICAgICAgaWYgKCAhdGhpcy5fY3JlYXRlV2lkZ2V0ICkgew0KICAgICAgICAgICAgICAgIHJldHVybiBuZXcgY29uc3RydWN0b3IoIG9wdGlvbnMsIGVsZW1lbnQgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gQWxsb3cgaW5zdGFudGlhdGlvbiB3aXRob3V0IGluaXRpYWxpemluZyBmb3Igc2ltcGxlIGluaGVyaXRhbmNlDQogICAgICAgICAgICAvLyBtdXN0IHVzZSAibmV3IiBrZXl3b3JkICh0aGUgY29kZSBhYm92ZSBhbHdheXMgcGFzc2VzIGFyZ3MpDQogICAgICAgICAgICBpZiAoIGFyZ3VtZW50cy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fY3JlYXRlV2lkZ2V0KCBvcHRpb25zLCBlbGVtZW50ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH07DQoNCiAgICAgICAgLy8gRXh0ZW5kIHdpdGggdGhlIGV4aXN0aW5nIGNvbnN0cnVjdG9yIHRvIGNhcnJ5IG92ZXIgYW55IHN0YXRpYyBwcm9wZXJ0aWVzDQogICAgICAgICQuZXh0ZW5kKCBjb25zdHJ1Y3RvciwgZXhpc3RpbmdDb25zdHJ1Y3Rvciwgew0KICAgICAgICAgICAgdmVyc2lvbjogcHJvdG90eXBlLnZlcnNpb24sDQoNCiAgICAgICAgICAgIC8vIENvcHkgdGhlIG9iamVjdCB1c2VkIHRvIGNyZWF0ZSB0aGUgcHJvdG90eXBlIGluIGNhc2Ugd2UgbmVlZCB0bw0KICAgICAgICAgICAgLy8gcmVkZWZpbmUgdGhlIHdpZGdldCBsYXRlcg0KICAgICAgICAgICAgX3Byb3RvOiAkLmV4dGVuZCgge30sIHByb3RvdHlwZSApLA0KDQogICAgICAgICAgICAvLyBUcmFjayB3aWRnZXRzIHRoYXQgaW5oZXJpdCBmcm9tIHRoaXMgd2lkZ2V0IGluIGNhc2UgdGhpcyB3aWRnZXQgaXMNCiAgICAgICAgICAgIC8vIHJlZGVmaW5lZCBhZnRlciBhIHdpZGdldCBpbmhlcml0cyBmcm9tIGl0DQogICAgICAgICAgICBfY2hpbGRDb25zdHJ1Y3RvcnM6IFtdDQogICAgICAgIH0gKTsNCg0KICAgICAgICBiYXNlUHJvdG90eXBlID0gbmV3IGJhc2UoKTsNCg0KICAgICAgICAvLyBXZSBuZWVkIHRvIG1ha2UgdGhlIG9wdGlvbnMgaGFzaCBhIHByb3BlcnR5IGRpcmVjdGx5IG9uIHRoZSBuZXcgaW5zdGFuY2UNCiAgICAgICAgLy8gb3RoZXJ3aXNlIHdlJ2xsIG1vZGlmeSB0aGUgb3B0aW9ucyBoYXNoIG9uIHRoZSBwcm90b3R5cGUgdGhhdCB3ZSdyZQ0KICAgICAgICAvLyBpbmhlcml0aW5nIGZyb20NCiAgICAgICAgYmFzZVByb3RvdHlwZS5vcHRpb25zID0gJC53aWRnZXQuZXh0ZW5kKCB7fSwgYmFzZVByb3RvdHlwZS5vcHRpb25zICk7DQogICAgICAgICQuZWFjaCggcHJvdG90eXBlLCBmdW5jdGlvbiggcHJvcCwgdmFsdWUgKSB7DQogICAgICAgICAgICBpZiAoICEkLmlzRnVuY3Rpb24oIHZhbHVlICkgKSB7DQogICAgICAgICAgICAgICAgcHJveGllZFByb3RvdHlwZVsgcHJvcCBdID0gdmFsdWU7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcHJveGllZFByb3RvdHlwZVsgcHJvcCBdID0gKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBfc3VwZXIoKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBiYXNlLnByb3RvdHlwZVsgcHJvcCBdLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBfc3VwZXJBcHBseSggYXJncyApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJhc2UucHJvdG90eXBlWyBwcm9wIF0uYXBwbHkoIHRoaXMsIGFyZ3MgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBfX3N1cGVyID0gdGhpcy5fc3VwZXI7DQogICAgICAgICAgICAgICAgICAgIHZhciBfX3N1cGVyQXBwbHkgPSB0aGlzLl9zdXBlckFwcGx5Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgcmV0dXJuVmFsdWU7DQoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3VwZXIgPSBfc3VwZXI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3N1cGVyQXBwbHkgPSBfc3VwZXJBcHBseTsNCg0KICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZSA9IHZhbHVlLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsNCg0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdXBlciA9IF9fc3VwZXI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3N1cGVyQXBwbHkgPSBfX3N1cGVyQXBwbHk7DQoNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldHVyblZhbHVlOw0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9ICkoKTsNCiAgICAgICAgfSApOw0KICAgICAgICBjb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSAkLndpZGdldC5leHRlbmQoIGJhc2VQcm90b3R5cGUsIHsNCg0KICAgICAgICAgICAgLy8gVE9ETzogcmVtb3ZlIHN1cHBvcnQgZm9yIHdpZGdldEV2ZW50UHJlZml4DQogICAgICAgICAgICAvLyBhbHdheXMgdXNlIHRoZSBuYW1lICsgYSBjb2xvbiBhcyB0aGUgcHJlZml4LCBlLmcuLCBkcmFnZ2FibGU6c3RhcnQNCiAgICAgICAgICAgIC8vIGRvbid0IHByZWZpeCBmb3Igd2lkZ2V0cyB0aGF0IGFyZW4ndCBET00tYmFzZWQNCiAgICAgICAgICAgIHdpZGdldEV2ZW50UHJlZml4OiBleGlzdGluZ0NvbnN0cnVjdG9yID8gKCBiYXNlUHJvdG90eXBlLndpZGdldEV2ZW50UHJlZml4IHx8IG5hbWUgKSA6IG5hbWUNCiAgICAgICAgfSwgcHJveGllZFByb3RvdHlwZSwgew0KICAgICAgICAgICAgY29uc3RydWN0b3I6IGNvbnN0cnVjdG9yLA0KICAgICAgICAgICAgbmFtZXNwYWNlOiBuYW1lc3BhY2UsDQogICAgICAgICAgICB3aWRnZXROYW1lOiBuYW1lLA0KICAgICAgICAgICAgd2lkZ2V0RnVsbE5hbWU6IGZ1bGxOYW1lDQogICAgICAgIH0gKTsNCg0KICAgICAgICAvLyBJZiB0aGlzIHdpZGdldCBpcyBiZWluZyByZWRlZmluZWQgdGhlbiB3ZSBuZWVkIHRvIGZpbmQgYWxsIHdpZGdldHMgdGhhdA0KICAgICAgICAvLyBhcmUgaW5oZXJpdGluZyBmcm9tIGl0IGFuZCByZWRlZmluZSBhbGwgb2YgdGhlbSBzbyB0aGF0IHRoZXkgaW5oZXJpdCBmcm9tDQogICAgICAgIC8vIHRoZSBuZXcgdmVyc2lvbiBvZiB0aGlzIHdpZGdldC4gV2UncmUgZXNzZW50aWFsbHkgdHJ5aW5nIHRvIHJlcGxhY2Ugb25lDQogICAgICAgIC8vIGxldmVsIGluIHRoZSBwcm90b3R5cGUgY2hhaW4uDQogICAgICAgIGlmICggZXhpc3RpbmdDb25zdHJ1Y3RvciApIHsNCiAgICAgICAgICAgICQuZWFjaCggZXhpc3RpbmdDb25zdHJ1Y3Rvci5fY2hpbGRDb25zdHJ1Y3RvcnMsIGZ1bmN0aW9uKCBpLCBjaGlsZCApIHsNCiAgICAgICAgICAgICAgICB2YXIgY2hpbGRQcm90b3R5cGUgPSBjaGlsZC5wcm90b3R5cGU7DQoNCiAgICAgICAgICAgICAgICAvLyBSZWRlZmluZSB0aGUgY2hpbGQgd2lkZ2V0IHVzaW5nIHRoZSBzYW1lIHByb3RvdHlwZSB0aGF0IHdhcw0KICAgICAgICAgICAgICAgIC8vIG9yaWdpbmFsbHkgdXNlZCwgYnV0IGluaGVyaXQgZnJvbSB0aGUgbmV3IHZlcnNpb24gb2YgdGhlIGJhc2UNCiAgICAgICAgICAgICAgICAkLndpZGdldCggY2hpbGRQcm90b3R5cGUubmFtZXNwYWNlICsgIi4iICsgY2hpbGRQcm90b3R5cGUud2lkZ2V0TmFtZSwgY29uc3RydWN0b3IsDQogICAgICAgICAgICAgICAgICAgIGNoaWxkLl9wcm90byApOw0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGxpc3Qgb2YgZXhpc3RpbmcgY2hpbGQgY29uc3RydWN0b3JzIGZyb20gdGhlIG9sZCBjb25zdHJ1Y3Rvcg0KICAgICAgICAgICAgLy8gc28gdGhlIG9sZCBjaGlsZCBjb25zdHJ1Y3RvcnMgY2FuIGJlIGdhcmJhZ2UgY29sbGVjdGVkDQogICAgICAgICAgICBkZWxldGUgZXhpc3RpbmdDb25zdHJ1Y3Rvci5fY2hpbGRDb25zdHJ1Y3RvcnM7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBiYXNlLl9jaGlsZENvbnN0cnVjdG9ycy5wdXNoKCBjb25zdHJ1Y3RvciApOw0KICAgICAgICB9DQoNCiAgICAgICAgJC53aWRnZXQuYnJpZGdlKCBuYW1lLCBjb25zdHJ1Y3RvciApOw0KDQogICAgICAgIHJldHVybiBjb25zdHJ1Y3RvcjsNCiAgICB9Ow0KDQogICAgJC53aWRnZXQuZXh0ZW5kID0gZnVuY3Rpb24oIHRhcmdldCApIHsNCiAgICAgICAgdmFyIGlucHV0ID0gd2lkZ2V0U2xpY2UuY2FsbCggYXJndW1lbnRzLCAxICk7DQogICAgICAgIHZhciBpbnB1dEluZGV4ID0gMDsNCiAgICAgICAgdmFyIGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoOw0KICAgICAgICB2YXIga2V5Ow0KICAgICAgICB2YXIgdmFsdWU7DQoNCiAgICAgICAgZm9yICggOyBpbnB1dEluZGV4IDwgaW5wdXRMZW5ndGg7IGlucHV0SW5kZXgrKyApIHsNCiAgICAgICAgICAgIGZvciAoIGtleSBpbiBpbnB1dFsgaW5wdXRJbmRleCBdICkgew0KICAgICAgICAgICAgICAgIHZhbHVlID0gaW5wdXRbIGlucHV0SW5kZXggXVsga2V5IF07DQogICAgICAgICAgICAgICAgaWYgKCBpbnB1dFsgaW5wdXRJbmRleCBdLmhhc093blByb3BlcnR5KCBrZXkgKSAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkICkgew0KDQogICAgICAgICAgICAgICAgICAgIC8vIENsb25lIG9iamVjdHMNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAkLmlzUGxhaW5PYmplY3QoIHZhbHVlICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRbIGtleSBdID0gJC5pc1BsYWluT2JqZWN0KCB0YXJnZXRbIGtleSBdICkgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQud2lkZ2V0LmV4dGVuZCgge30sIHRhcmdldFsga2V5IF0sIHZhbHVlICkgOg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG9uJ3QgZXh0ZW5kIHN0cmluZ3MsIGFycmF5cywgZXRjLiB3aXRoIG9iamVjdHMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLndpZGdldC5leHRlbmQoIHt9LCB2YWx1ZSApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3B5IGV2ZXJ5dGhpbmcgZWxzZSBieSByZWZlcmVuY2UNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFsga2V5IF0gPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdGFyZ2V0Ow0KICAgIH07DQoNCiAgICAkLndpZGdldC5icmlkZ2UgPSBmdW5jdGlvbiggbmFtZSwgb2JqZWN0ICkgew0KICAgICAgICB2YXIgZnVsbE5hbWUgPSBvYmplY3QucHJvdG90eXBlLndpZGdldEZ1bGxOYW1lIHx8IG5hbWU7DQogICAgICAgICQuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCBvcHRpb25zICkgew0KICAgICAgICAgICAgdmFyIGlzTWV0aG9kQ2FsbCA9IHR5cGVvZiBvcHRpb25zID09PSAic3RyaW5nIjsNCiAgICAgICAgICAgIHZhciBhcmdzID0gd2lkZ2V0U2xpY2UuY2FsbCggYXJndW1lbnRzLCAxICk7DQogICAgICAgICAgICB2YXIgcmV0dXJuVmFsdWUgPSB0aGlzOw0KDQogICAgICAgICAgICBpZiAoIGlzTWV0aG9kQ2FsbCApIHsNCg0KICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgaXMgYW4gZW1wdHkgY29sbGVjdGlvbiwgd2UgbmVlZCB0byBoYXZlIHRoZSBpbnN0YW5jZSBtZXRob2QNCiAgICAgICAgICAgICAgICAvLyByZXR1cm4gdW5kZWZpbmVkIGluc3RlYWQgb2YgdGhlIGpRdWVyeSBpbnN0YW5jZQ0KICAgICAgICAgICAgICAgIGlmICggIXRoaXMubGVuZ3RoICYmIG9wdGlvbnMgPT09ICJpbnN0YW5jZSIgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVyblZhbHVlID0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWV0aG9kVmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSAkLmRhdGEoIHRoaXMsIGZ1bGxOYW1lICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggb3B0aW9ucyA9PT0gImluc3RhbmNlIiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZSA9IGluc3RhbmNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhaW5zdGFuY2UgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQuZXJyb3IoICJjYW5ub3QgY2FsbCBtZXRob2RzIG9uICIgKyBuYW1lICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBwcmlvciB0byBpbml0aWFsaXphdGlvbjsgIiArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhdHRlbXB0ZWQgdG8gY2FsbCBtZXRob2QgJyIgKyBvcHRpb25zICsgIiciICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggISQuaXNGdW5jdGlvbiggaW5zdGFuY2VbIG9wdGlvbnMgXSApIHx8IG9wdGlvbnMuY2hhckF0KCAwICkgPT09ICJfIiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJC5lcnJvciggIm5vIHN1Y2ggbWV0aG9kICciICsgb3B0aW9ucyArICInIGZvciAiICsgbmFtZSArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgd2lkZ2V0IGluc3RhbmNlIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBtZXRob2RWYWx1ZSA9IGluc3RhbmNlWyBvcHRpb25zIF0uYXBwbHkoIGluc3RhbmNlLCBhcmdzICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggbWV0aG9kVmFsdWUgIT09IGluc3RhbmNlICYmIG1ldGhvZFZhbHVlICE9PSB1bmRlZmluZWQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSBtZXRob2RWYWx1ZSAmJiBtZXRob2RWYWx1ZS5qcXVlcnkgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZS5wdXNoU3RhY2soIG1ldGhvZFZhbHVlLmdldCgpICkgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2RWYWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgICAgICAgLy8gQWxsb3cgbXVsdGlwbGUgaGFzaGVzIHRvIGJlIHBhc3NlZCBvbiBpbml0DQogICAgICAgICAgICAgICAgaWYgKCBhcmdzLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyA9ICQud2lkZ2V0LmV4dGVuZC5hcHBseSggbnVsbCwgWyBvcHRpb25zIF0uY29uY2F0KCBhcmdzICkgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSAkLmRhdGEoIHRoaXMsIGZ1bGxOYW1lICk7DQogICAgICAgICAgICAgICAgICAgIGlmICggaW5zdGFuY2UgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5vcHRpb24oIG9wdGlvbnMgfHwge30gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggaW5zdGFuY2UuX2luaXQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuX2luaXQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0YSggdGhpcywgZnVsbE5hbWUsIG5ldyBvYmplY3QoIG9wdGlvbnMsIHRoaXMgKSApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gcmV0dXJuVmFsdWU7DQogICAgICAgIH07DQogICAgfTsNCg0KICAgICQuV2lkZ2V0ID0gZnVuY3Rpb24oIC8qIG9wdGlvbnMsIGVsZW1lbnQgKi8gKSB7fTsNCiAgICAkLldpZGdldC5fY2hpbGRDb25zdHJ1Y3RvcnMgPSBbXTsNCg0KICAgICQuV2lkZ2V0LnByb3RvdHlwZSA9IHsNCiAgICAgICAgd2lkZ2V0TmFtZTogIndpZGdldCIsDQogICAgICAgIHdpZGdldEV2ZW50UHJlZml4OiAiIiwNCiAgICAgICAgZGVmYXVsdEVsZW1lbnQ6ICI8ZGl2PiIsDQoNCiAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgY2xhc3Nlczoge30sDQogICAgICAgICAgICBkaXNhYmxlZDogZmFsc2UsDQoNCiAgICAgICAgICAgIC8vIENhbGxiYWNrcw0KICAgICAgICAgICAgY3JlYXRlOiBudWxsDQogICAgICAgIH0sDQoNCiAgICAgICAgX2NyZWF0ZVdpZGdldDogZnVuY3Rpb24oIG9wdGlvbnMsIGVsZW1lbnQgKSB7DQogICAgICAgICAgICBlbGVtZW50ID0gJCggZWxlbWVudCB8fCB0aGlzLmRlZmF1bHRFbGVtZW50IHx8IHRoaXMgKVsgMCBdOw0KICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gJCggZWxlbWVudCApOw0KICAgICAgICAgICAgdGhpcy51dWlkID0gd2lkZ2V0VXVpZCsrOw0KICAgICAgICAgICAgdGhpcy5ldmVudE5hbWVzcGFjZSA9ICIuIiArIHRoaXMud2lkZ2V0TmFtZSArIHRoaXMudXVpZDsNCg0KICAgICAgICAgICAgdGhpcy5iaW5kaW5ncyA9ICQoKTsNCiAgICAgICAgICAgIHRoaXMuaG92ZXJhYmxlID0gJCgpOw0KICAgICAgICAgICAgdGhpcy5mb2N1c2FibGUgPSAkKCk7DQogICAgICAgICAgICB0aGlzLmNsYXNzZXNFbGVtZW50TG9va3VwID0ge307DQoNCiAgICAgICAgICAgIGlmICggZWxlbWVudCAhPT0gdGhpcyApIHsNCiAgICAgICAgICAgICAgICAkLmRhdGEoIGVsZW1lbnQsIHRoaXMud2lkZ2V0RnVsbE5hbWUsIHRoaXMgKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9vbiggdHJ1ZSwgdGhpcy5lbGVtZW50LCB7DQogICAgICAgICAgICAgICAgICAgIHJlbW92ZTogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBldmVudC50YXJnZXQgPT09IGVsZW1lbnQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXN0cm95KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudCA9ICQoIGVsZW1lbnQuc3R5bGUgPw0KDQogICAgICAgICAgICAgICAgICAgIC8vIEVsZW1lbnQgd2l0aGluIHRoZSBkb2N1bWVudA0KICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm93bmVyRG9jdW1lbnQgOg0KDQogICAgICAgICAgICAgICAgICAgIC8vIEVsZW1lbnQgaXMgd2luZG93IG9yIGRvY3VtZW50DQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZG9jdW1lbnQgfHwgZWxlbWVudCApOw0KICAgICAgICAgICAgICAgIHRoaXMud2luZG93ID0gJCggdGhpcy5kb2N1bWVudFsgMCBdLmRlZmF1bHRWaWV3IHx8IHRoaXMuZG9jdW1lbnRbIDAgXS5wYXJlbnRXaW5kb3cgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gJC53aWRnZXQuZXh0ZW5kKCB7fSwNCiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMsDQogICAgICAgICAgICAgICAgdGhpcy5fZ2V0Q3JlYXRlT3B0aW9ucygpLA0KICAgICAgICAgICAgICAgIG9wdGlvbnMgKTsNCg0KICAgICAgICAgICAgdGhpcy5fY3JlYXRlKCk7DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmRpc2FibGVkICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3NldE9wdGlvbkRpc2FibGVkKCB0aGlzLm9wdGlvbnMuZGlzYWJsZWQgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fdHJpZ2dlciggImNyZWF0ZSIsIG51bGwsIHRoaXMuX2dldENyZWF0ZUV2ZW50RGF0YSgpICk7DQogICAgICAgICAgICB0aGlzLl9pbml0KCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2dldENyZWF0ZU9wdGlvbnM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHt9Ow0KICAgICAgICB9LA0KDQogICAgICAgIF9nZXRDcmVhdGVFdmVudERhdGE6ICQubm9vcCwNCg0KICAgICAgICBfY3JlYXRlOiAkLm5vb3AsDQoNCiAgICAgICAgX2luaXQ6ICQubm9vcCwNCg0KICAgICAgICBkZXN0cm95OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpczsNCg0KICAgICAgICAgICAgdGhpcy5fZGVzdHJveSgpOw0KICAgICAgICAgICAgJC5lYWNoKCB0aGlzLmNsYXNzZXNFbGVtZW50TG9va3VwLCBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHsNCiAgICAgICAgICAgICAgICB0aGF0Ll9yZW1vdmVDbGFzcyggdmFsdWUsIGtleSApOw0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAvLyBXZSBjYW4gcHJvYmFibHkgcmVtb3ZlIHRoZSB1bmJpbmQgY2FsbHMgaW4gMi4wDQogICAgICAgICAgICAvLyBhbGwgZXZlbnQgYmluZGluZ3Mgc2hvdWxkIGdvIHRocm91Z2ggdGhpcy5fb24oKQ0KICAgICAgICAgICAgdGhpcy5lbGVtZW50DQogICAgICAgICAgICAgICAgLm9mZiggdGhpcy5ldmVudE5hbWVzcGFjZSApDQogICAgICAgICAgICAgICAgLnJlbW92ZURhdGEoIHRoaXMud2lkZ2V0RnVsbE5hbWUgKTsNCiAgICAgICAgICAgIHRoaXMud2lkZ2V0KCkNCiAgICAgICAgICAgICAgICAub2ZmKCB0aGlzLmV2ZW50TmFtZXNwYWNlICkNCiAgICAgICAgICAgICAgICAucmVtb3ZlQXR0ciggImFyaWEtZGlzYWJsZWQiICk7DQoNCiAgICAgICAgICAgIC8vIENsZWFuIHVwIGV2ZW50cyBhbmQgc3RhdGVzDQogICAgICAgICAgICB0aGlzLmJpbmRpbmdzLm9mZiggdGhpcy5ldmVudE5hbWVzcGFjZSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9kZXN0cm95OiAkLm5vb3AsDQoNCiAgICAgICAgd2lkZ2V0OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQ7DQogICAgICAgIH0sDQoNCiAgICAgICAgb3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHsNCiAgICAgICAgICAgIHZhciBvcHRpb25zID0ga2V5Ow0KICAgICAgICAgICAgdmFyIHBhcnRzOw0KICAgICAgICAgICAgdmFyIGN1ck9wdGlvbjsNCiAgICAgICAgICAgIHZhciBpOw0KDQogICAgICAgICAgICBpZiAoIGFyZ3VtZW50cy5sZW5ndGggPT09IDAgKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBEb24ndCByZXR1cm4gYSByZWZlcmVuY2UgdG8gdGhlIGludGVybmFsIGhhc2gNCiAgICAgICAgICAgICAgICByZXR1cm4gJC53aWRnZXQuZXh0ZW5kKCB7fSwgdGhpcy5vcHRpb25zICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdHlwZW9mIGtleSA9PT0gInN0cmluZyIgKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBIYW5kbGUgbmVzdGVkIGtleXMsIGUuZy4sICJmb28uYmFyIiA9PiB7IGZvbzogeyBiYXI6IF9fXyB9IH0NCiAgICAgICAgICAgICAgICBvcHRpb25zID0ge307DQogICAgICAgICAgICAgICAgcGFydHMgPSBrZXkuc3BsaXQoICIuIiApOw0KICAgICAgICAgICAgICAgIGtleSA9IHBhcnRzLnNoaWZ0KCk7DQogICAgICAgICAgICAgICAgaWYgKCBwYXJ0cy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgICAgIGN1ck9wdGlvbiA9IG9wdGlvbnNbIGtleSBdID0gJC53aWRnZXQuZXh0ZW5kKCB7fSwgdGhpcy5vcHRpb25zWyBrZXkgXSApOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IHBhcnRzLmxlbmd0aCAtIDE7IGkrKyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1ck9wdGlvblsgcGFydHNbIGkgXSBdID0gY3VyT3B0aW9uWyBwYXJ0c1sgaSBdIF0gfHwge307DQogICAgICAgICAgICAgICAgICAgICAgICBjdXJPcHRpb24gPSBjdXJPcHRpb25bIHBhcnRzWyBpIF0gXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBrZXkgPSBwYXJ0cy5wb3AoKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAxICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN1ck9wdGlvblsga2V5IF0gPT09IHVuZGVmaW5lZCA/IG51bGwgOiBjdXJPcHRpb25bIGtleSBdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGN1ck9wdGlvblsga2V5IF0gPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBpZiAoIGFyZ3VtZW50cy5sZW5ndGggPT09IDEgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zWyBrZXkgXSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IHRoaXMub3B0aW9uc1sga2V5IF07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgb3B0aW9uc1sga2V5IF0gPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX3NldE9wdGlvbnMoIG9wdGlvbnMgKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldE9wdGlvbnM6IGZ1bmN0aW9uKCBvcHRpb25zICkgew0KICAgICAgICAgICAgdmFyIGtleTsNCg0KICAgICAgICAgICAgZm9yICgga2V5IGluIG9wdGlvbnMgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fc2V0T3B0aW9uKCBrZXksIG9wdGlvbnNbIGtleSBdICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiB0aGlzOw0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgew0KICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJjbGFzc2VzIiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9zZXRPcHRpb25DbGFzc2VzKCB2YWx1ZSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLm9wdGlvbnNbIGtleSBdID0gdmFsdWU7DQoNCiAgICAgICAgICAgIGlmICgga2V5ID09PSAiZGlzYWJsZWQiICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3NldE9wdGlvbkRpc2FibGVkKCB2YWx1ZSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gdGhpczsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0T3B0aW9uQ2xhc3NlczogZnVuY3Rpb24oIHZhbHVlICkgew0KICAgICAgICAgICAgdmFyIGNsYXNzS2V5LCBlbGVtZW50cywgY3VycmVudEVsZW1lbnRzOw0KDQogICAgICAgICAgICBmb3IgKCBjbGFzc0tleSBpbiB2YWx1ZSApIHsNCiAgICAgICAgICAgICAgICBjdXJyZW50RWxlbWVudHMgPSB0aGlzLmNsYXNzZXNFbGVtZW50TG9va3VwWyBjbGFzc0tleSBdOw0KICAgICAgICAgICAgICAgIGlmICggdmFsdWVbIGNsYXNzS2V5IF0gPT09IHRoaXMub3B0aW9ucy5jbGFzc2VzWyBjbGFzc0tleSBdIHx8DQogICAgICAgICAgICAgICAgICAgICFjdXJyZW50RWxlbWVudHMgfHwNCiAgICAgICAgICAgICAgICAgICAgIWN1cnJlbnRFbGVtZW50cy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIFdlIGFyZSBkb2luZyB0aGlzIHRvIGNyZWF0ZSBhIG5ldyBqUXVlcnkgb2JqZWN0IGJlY2F1c2UgdGhlIF9yZW1vdmVDbGFzcygpIGNhbGwNCiAgICAgICAgICAgICAgICAvLyBvbiB0aGUgbmV4dCBsaW5lIGlzIGdvaW5nIHRvIGRlc3Ryb3kgdGhlIHJlZmVyZW5jZSB0byB0aGUgY3VycmVudCBlbGVtZW50cyBiZWluZw0KICAgICAgICAgICAgICAgIC8vIHRyYWNrZWQuIFdlIG5lZWQgdG8gc2F2ZSBhIGNvcHkgb2YgdGhpcyBjb2xsZWN0aW9uIHNvIHRoYXQgd2UgY2FuIGFkZCB0aGUgbmV3IGNsYXNzZXMNCiAgICAgICAgICAgICAgICAvLyBiZWxvdy4NCiAgICAgICAgICAgICAgICBlbGVtZW50cyA9ICQoIGN1cnJlbnRFbGVtZW50cy5nZXQoKSApOw0KICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCBjdXJyZW50RWxlbWVudHMsIGNsYXNzS2V5ICk7DQoNCiAgICAgICAgICAgICAgICAvLyBXZSBkb24ndCB1c2UgX2FkZENsYXNzKCkgaGVyZSwgYmVjYXVzZSB0aGF0IHVzZXMgdGhpcy5vcHRpb25zLmNsYXNzZXMNCiAgICAgICAgICAgICAgICAvLyBmb3IgZ2VuZXJhdGluZyB0aGUgc3RyaW5nIG9mIGNsYXNzZXMuIFdlIHdhbnQgdG8gdXNlIHRoZSB2YWx1ZSBwYXNzZWQgaW4gZnJvbQ0KICAgICAgICAgICAgICAgIC8vIF9zZXRPcHRpb24oKSwgdGhpcyBpcyB0aGUgbmV3IHZhbHVlIG9mIHRoZSBjbGFzc2VzIG9wdGlvbiB3aGljaCB3YXMgcGFzc2VkIHRvDQogICAgICAgICAgICAgICAgLy8gX3NldE9wdGlvbigpLiBXZSBwYXNzIHRoaXMgdmFsdWUgZGlyZWN0bHkgdG8gX2NsYXNzZXMoKS4NCiAgICAgICAgICAgICAgICBlbGVtZW50cy5hZGRDbGFzcyggdGhpcy5fY2xhc3Nlcyggew0KICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiBlbGVtZW50cywNCiAgICAgICAgICAgICAgICAgICAga2V5czogY2xhc3NLZXksDQogICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6IHZhbHVlLA0KICAgICAgICAgICAgICAgICAgICBhZGQ6IHRydWUNCiAgICAgICAgICAgICAgICB9ICkgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0T3B0aW9uRGlzYWJsZWQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHsNCiAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUNsYXNzKCB0aGlzLndpZGdldCgpLCB0aGlzLndpZGdldEZ1bGxOYW1lICsgIi1kaXNhYmxlZCIsIG51bGwsICEhdmFsdWUgKTsNCg0KICAgICAgICAgICAgLy8gSWYgdGhlIHdpZGdldCBpcyBiZWNvbWluZyBkaXNhYmxlZCwgdGhlbiBub3RoaW5nIGlzIGludGVyYWN0aXZlDQogICAgICAgICAgICBpZiAoIHZhbHVlICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLmhvdmVyYWJsZSwgbnVsbCwgInVpLXN0YXRlLWhvdmVyIiApOw0KICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLmZvY3VzYWJsZSwgbnVsbCwgInVpLXN0YXRlLWZvY3VzIiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIGVuYWJsZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5fc2V0T3B0aW9ucyggeyBkaXNhYmxlZDogZmFsc2UgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIGRpc2FibGU6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NldE9wdGlvbnMoIHsgZGlzYWJsZWQ6IHRydWUgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9jbGFzc2VzOiBmdW5jdGlvbiggb3B0aW9ucyApIHsNCiAgICAgICAgICAgIHZhciBmdWxsID0gW107DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7DQoNCiAgICAgICAgICAgIG9wdGlvbnMgPSAkLmV4dGVuZCggew0KICAgICAgICAgICAgICAgIGVsZW1lbnQ6IHRoaXMuZWxlbWVudCwNCiAgICAgICAgICAgICAgICBjbGFzc2VzOiB0aGlzLm9wdGlvbnMuY2xhc3NlcyB8fCB7fQ0KICAgICAgICAgICAgfSwgb3B0aW9ucyApOw0KDQogICAgICAgICAgICBmdW5jdGlvbiBwcm9jZXNzQ2xhc3NTdHJpbmcoIGNsYXNzZXMsIGNoZWNrT3B0aW9uICkgew0KICAgICAgICAgICAgICAgIHZhciBjdXJyZW50LCBpOw0KICAgICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgY2xhc3Nlcy5sZW5ndGg7IGkrKyApIHsNCiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IHRoYXQuY2xhc3Nlc0VsZW1lbnRMb29rdXBbIGNsYXNzZXNbIGkgXSBdIHx8ICQoKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBvcHRpb25zLmFkZCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSAkKCAkLnVuaXF1ZSggY3VycmVudC5nZXQoKS5jb25jYXQoIG9wdGlvbnMuZWxlbWVudC5nZXQoKSApICkgKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSAkKCBjdXJyZW50Lm5vdCggb3B0aW9ucy5lbGVtZW50ICkuZ2V0KCkgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGF0LmNsYXNzZXNFbGVtZW50TG9va3VwWyBjbGFzc2VzWyBpIF0gXSA9IGN1cnJlbnQ7DQogICAgICAgICAgICAgICAgICAgIGZ1bGwucHVzaCggY2xhc3Nlc1sgaSBdICk7DQogICAgICAgICAgICAgICAgICAgIGlmICggY2hlY2tPcHRpb24gJiYgb3B0aW9ucy5jbGFzc2VzWyBjbGFzc2VzWyBpIF0gXSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGwucHVzaCggb3B0aW9ucy5jbGFzc2VzWyBjbGFzc2VzWyBpIF0gXSApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLl9vbiggb3B0aW9ucy5lbGVtZW50LCB7DQogICAgICAgICAgICAgICAgInJlbW92ZSI6ICJfdW50cmFja0NsYXNzZXNFbGVtZW50Ig0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICBpZiAoIG9wdGlvbnMua2V5cyApIHsNCiAgICAgICAgICAgICAgICBwcm9jZXNzQ2xhc3NTdHJpbmcoIG9wdGlvbnMua2V5cy5tYXRjaCggL1xTKy9nICkgfHwgW10sIHRydWUgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggb3B0aW9ucy5leHRyYSApIHsNCiAgICAgICAgICAgICAgICBwcm9jZXNzQ2xhc3NTdHJpbmcoIG9wdGlvbnMuZXh0cmEubWF0Y2goIC9cUysvZyApIHx8IFtdICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBmdWxsLmpvaW4oICIgIiApOw0KICAgICAgICB9LA0KDQogICAgICAgIF91bnRyYWNrQ2xhc3Nlc0VsZW1lbnQ6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpczsNCiAgICAgICAgICAgICQuZWFjaCggdGhhdC5jbGFzc2VzRWxlbWVudExvb2t1cCwgZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7DQogICAgICAgICAgICAgICAgaWYgKCAkLmluQXJyYXkoIGV2ZW50LnRhcmdldCwgdmFsdWUgKSAhPT0gLTEgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuY2xhc3Nlc0VsZW1lbnRMb29rdXBbIGtleSBdID0gJCggdmFsdWUubm90KCBldmVudC50YXJnZXQgKS5nZXQoKSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKCBlbGVtZW50LCBrZXlzLCBleHRyYSApIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLl90b2dnbGVDbGFzcyggZWxlbWVudCwga2V5cywgZXh0cmEsIGZhbHNlICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2FkZENsYXNzOiBmdW5jdGlvbiggZWxlbWVudCwga2V5cywgZXh0cmEgKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5fdG9nZ2xlQ2xhc3MoIGVsZW1lbnQsIGtleXMsIGV4dHJhLCB0cnVlICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3RvZ2dsZUNsYXNzOiBmdW5jdGlvbiggZWxlbWVudCwga2V5cywgZXh0cmEsIGFkZCApIHsNCiAgICAgICAgICAgIGFkZCA9ICggdHlwZW9mIGFkZCA9PT0gImJvb2xlYW4iICkgPyBhZGQgOiBleHRyYTsNCiAgICAgICAgICAgIHZhciBzaGlmdCA9ICggdHlwZW9mIGVsZW1lbnQgPT09ICJzdHJpbmciIHx8IGVsZW1lbnQgPT09IG51bGwgKSwNCiAgICAgICAgICAgICAgICBvcHRpb25zID0gew0KICAgICAgICAgICAgICAgICAgICBleHRyYTogc2hpZnQgPyBrZXlzIDogZXh0cmEsDQogICAgICAgICAgICAgICAgICAgIGtleXM6IHNoaWZ0ID8gZWxlbWVudCA6IGtleXMsDQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IHNoaWZ0ID8gdGhpcy5lbGVtZW50IDogZWxlbWVudCwNCiAgICAgICAgICAgICAgICAgICAgYWRkOiBhZGQNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgb3B0aW9ucy5lbGVtZW50LnRvZ2dsZUNsYXNzKCB0aGlzLl9jbGFzc2VzKCBvcHRpb25zICksIGFkZCApOw0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgIH0sDQoNCiAgICAgICAgX29uOiBmdW5jdGlvbiggc3VwcHJlc3NEaXNhYmxlZENoZWNrLCBlbGVtZW50LCBoYW5kbGVycyApIHsNCiAgICAgICAgICAgIHZhciBkZWxlZ2F0ZUVsZW1lbnQ7DQogICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSB0aGlzOw0KDQogICAgICAgICAgICAvLyBObyBzdXBwcmVzc0Rpc2FibGVkQ2hlY2sgZmxhZywgc2h1ZmZsZSBhcmd1bWVudHMNCiAgICAgICAgICAgIGlmICggdHlwZW9mIHN1cHByZXNzRGlzYWJsZWRDaGVjayAhPT0gImJvb2xlYW4iICkgew0KICAgICAgICAgICAgICAgIGhhbmRsZXJzID0gZWxlbWVudDsNCiAgICAgICAgICAgICAgICBlbGVtZW50ID0gc3VwcHJlc3NEaXNhYmxlZENoZWNrOw0KICAgICAgICAgICAgICAgIHN1cHByZXNzRGlzYWJsZWRDaGVjayA9IGZhbHNlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBObyBlbGVtZW50IGFyZ3VtZW50LCBzaHVmZmxlIGFuZCB1c2UgdGhpcy5lbGVtZW50DQogICAgICAgICAgICBpZiAoICFoYW5kbGVycyApIHsNCiAgICAgICAgICAgICAgICBoYW5kbGVycyA9IGVsZW1lbnQ7DQogICAgICAgICAgICAgICAgZWxlbWVudCA9IHRoaXMuZWxlbWVudDsNCiAgICAgICAgICAgICAgICBkZWxlZ2F0ZUVsZW1lbnQgPSB0aGlzLndpZGdldCgpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50ID0gZGVsZWdhdGVFbGVtZW50ID0gJCggZWxlbWVudCApOw0KICAgICAgICAgICAgICAgIHRoaXMuYmluZGluZ3MgPSB0aGlzLmJpbmRpbmdzLmFkZCggZWxlbWVudCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkLmVhY2goIGhhbmRsZXJzLCBmdW5jdGlvbiggZXZlbnQsIGhhbmRsZXIgKSB7DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlclByb3h5KCkgew0KDQogICAgICAgICAgICAgICAgICAgIC8vIEFsbG93IHdpZGdldHMgdG8gY3VzdG9taXplIHRoZSBkaXNhYmxlZCBoYW5kbGluZw0KICAgICAgICAgICAgICAgICAgICAvLyAtIGRpc2FibGVkIGFzIGFuIGFycmF5IGluc3RlYWQgb2YgYm9vbGVhbg0KICAgICAgICAgICAgICAgICAgICAvLyAtIGRpc2FibGVkIGNsYXNzIGFzIG1ldGhvZCBmb3IgZGlzYWJsaW5nIGluZGl2aWR1YWwgcGFydHMNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAhc3VwcHJlc3NEaXNhYmxlZENoZWNrICYmDQogICAgICAgICAgICAgICAgICAgICAgICAoIGluc3RhbmNlLm9wdGlvbnMuZGlzYWJsZWQgPT09IHRydWUgfHwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCB0aGlzICkuaGFzQ2xhc3MoICJ1aS1zdGF0ZS1kaXNhYmxlZCIgKSApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAoIHR5cGVvZiBoYW5kbGVyID09PSAic3RyaW5nIiA/IGluc3RhbmNlWyBoYW5kbGVyIF0gOiBoYW5kbGVyICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBseSggaW5zdGFuY2UsIGFyZ3VtZW50cyApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIGd1aWQgc28gZGlyZWN0IHVuYmluZGluZyB3b3Jrcw0KICAgICAgICAgICAgICAgIGlmICggdHlwZW9mIGhhbmRsZXIgIT09ICJzdHJpbmciICkgew0KICAgICAgICAgICAgICAgICAgICBoYW5kbGVyUHJveHkuZ3VpZCA9IGhhbmRsZXIuZ3VpZCA9DQogICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyLmd1aWQgfHwgaGFuZGxlclByb3h5Lmd1aWQgfHwgJC5ndWlkKys7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdmFyIG1hdGNoID0gZXZlbnQubWF0Y2goIC9eKFtcdzotXSopXHMqKC4qKSQvICk7DQogICAgICAgICAgICAgICAgdmFyIGV2ZW50TmFtZSA9IG1hdGNoWyAxIF0gKyBpbnN0YW5jZS5ldmVudE5hbWVzcGFjZTsNCiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3IgPSBtYXRjaFsgMiBdOw0KDQogICAgICAgICAgICAgICAgaWYgKCBzZWxlY3RvciApIHsNCiAgICAgICAgICAgICAgICAgICAgZGVsZWdhdGVFbGVtZW50Lm9uKCBldmVudE5hbWUsIHNlbGVjdG9yLCBoYW5kbGVyUHJveHkgKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm9uKCBldmVudE5hbWUsIGhhbmRsZXJQcm94eSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfb2ZmOiBmdW5jdGlvbiggZWxlbWVudCwgZXZlbnROYW1lICkgew0KICAgICAgICAgICAgZXZlbnROYW1lID0gKCBldmVudE5hbWUgfHwgIiIgKS5zcGxpdCggIiAiICkuam9pbiggdGhpcy5ldmVudE5hbWVzcGFjZSArICIgIiApICsNCiAgICAgICAgICAgICAgICB0aGlzLmV2ZW50TmFtZXNwYWNlOw0KICAgICAgICAgICAgZWxlbWVudC5vZmYoIGV2ZW50TmFtZSApLm9mZiggZXZlbnROYW1lICk7DQoNCiAgICAgICAgICAgIC8vIENsZWFyIHRoZSBzdGFjayB0byBhdm9pZCBtZW1vcnkgbGVha3MgKCMxMDA1NikNCiAgICAgICAgICAgIHRoaXMuYmluZGluZ3MgPSAkKCB0aGlzLmJpbmRpbmdzLm5vdCggZWxlbWVudCApLmdldCgpICk7DQogICAgICAgICAgICB0aGlzLmZvY3VzYWJsZSA9ICQoIHRoaXMuZm9jdXNhYmxlLm5vdCggZWxlbWVudCApLmdldCgpICk7DQogICAgICAgICAgICB0aGlzLmhvdmVyYWJsZSA9ICQoIHRoaXMuaG92ZXJhYmxlLm5vdCggZWxlbWVudCApLmdldCgpICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2RlbGF5OiBmdW5jdGlvbiggaGFuZGxlciwgZGVsYXkgKSB7DQogICAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVyUHJveHkoKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICggdHlwZW9mIGhhbmRsZXIgPT09ICJzdHJpbmciID8gaW5zdGFuY2VbIGhhbmRsZXIgXSA6IGhhbmRsZXIgKQ0KICAgICAgICAgICAgICAgICAgICAuYXBwbHkoIGluc3RhbmNlLCBhcmd1bWVudHMgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXM7DQogICAgICAgICAgICByZXR1cm4gc2V0VGltZW91dCggaGFuZGxlclByb3h5LCBkZWxheSB8fCAwICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2hvdmVyYWJsZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7DQogICAgICAgICAgICB0aGlzLmhvdmVyYWJsZSA9IHRoaXMuaG92ZXJhYmxlLmFkZCggZWxlbWVudCApOw0KICAgICAgICAgICAgdGhpcy5fb24oIGVsZW1lbnQsIHsNCiAgICAgICAgICAgICAgICBtb3VzZWVudGVyOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCAkKCBldmVudC5jdXJyZW50VGFyZ2V0ICksIG51bGwsICJ1aS1zdGF0ZS1ob3ZlciIgKTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG1vdXNlbGVhdmU6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ2xhc3MoICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwgbnVsbCwgInVpLXN0YXRlLWhvdmVyIiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZm9jdXNhYmxlOiBmdW5jdGlvbiggZWxlbWVudCApIHsNCiAgICAgICAgICAgIHRoaXMuZm9jdXNhYmxlID0gdGhpcy5mb2N1c2FibGUuYWRkKCBlbGVtZW50ICk7DQogICAgICAgICAgICB0aGlzLl9vbiggZWxlbWVudCwgew0KICAgICAgICAgICAgICAgIGZvY3VzaW46IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwgbnVsbCwgInVpLXN0YXRlLWZvY3VzIiApOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgZm9jdXNvdXQ6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ2xhc3MoICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwgbnVsbCwgInVpLXN0YXRlLWZvY3VzIiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfdHJpZ2dlcjogZnVuY3Rpb24oIHR5cGUsIGV2ZW50LCBkYXRhICkgew0KICAgICAgICAgICAgdmFyIHByb3AsIG9yaWc7DQogICAgICAgICAgICB2YXIgY2FsbGJhY2sgPSB0aGlzLm9wdGlvbnNbIHR5cGUgXTsNCg0KICAgICAgICAgICAgZGF0YSA9IGRhdGEgfHwge307DQogICAgICAgICAgICBldmVudCA9ICQuRXZlbnQoIGV2ZW50ICk7DQogICAgICAgICAgICBldmVudC50eXBlID0gKCB0eXBlID09PSB0aGlzLndpZGdldEV2ZW50UHJlZml4ID8NCiAgICAgICAgICAgICAgICB0eXBlIDoNCiAgICAgICAgICAgICAgICB0aGlzLndpZGdldEV2ZW50UHJlZml4ICsgdHlwZSApLnRvTG93ZXJDYXNlKCk7DQoNCiAgICAgICAgICAgIC8vIFRoZSBvcmlnaW5hbCBldmVudCBtYXkgY29tZSBmcm9tIGFueSBlbGVtZW50DQogICAgICAgICAgICAvLyBzbyB3ZSBuZWVkIHRvIHJlc2V0IHRoZSB0YXJnZXQgb24gdGhlIG5ldyBldmVudA0KICAgICAgICAgICAgZXZlbnQudGFyZ2V0ID0gdGhpcy5lbGVtZW50WyAwIF07DQoNCiAgICAgICAgICAgIC8vIENvcHkgb3JpZ2luYWwgZXZlbnQgcHJvcGVydGllcyBvdmVyIHRvIHRoZSBuZXcgZXZlbnQNCiAgICAgICAgICAgIG9yaWcgPSBldmVudC5vcmlnaW5hbEV2ZW50Ow0KICAgICAgICAgICAgaWYgKCBvcmlnICkgew0KICAgICAgICAgICAgICAgIGZvciAoIHByb3AgaW4gb3JpZyApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAhKCBwcm9wIGluIGV2ZW50ICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBldmVudFsgcHJvcCBdID0gb3JpZ1sgcHJvcCBdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLmVsZW1lbnQudHJpZ2dlciggZXZlbnQsIGRhdGEgKTsNCiAgICAgICAgICAgIHJldHVybiAhKCAkLmlzRnVuY3Rpb24oIGNhbGxiYWNrICkgJiYNCiAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseSggdGhpcy5lbGVtZW50WyAwIF0sIFsgZXZlbnQgXS5jb25jYXQoIGRhdGEgKSApID09PSBmYWxzZSB8fA0KICAgICAgICAgICAgICAgIGV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpICk7DQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgJC5lYWNoKCB7IHNob3c6ICJmYWRlSW4iLCBoaWRlOiAiZmFkZU91dCIgfSwgZnVuY3Rpb24oIG1ldGhvZCwgZGVmYXVsdEVmZmVjdCApIHsNCiAgICAgICAgJC5XaWRnZXQucHJvdG90eXBlWyAiXyIgKyBtZXRob2QgXSA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb25zLCBjYWxsYmFjayApIHsNCiAgICAgICAgICAgIGlmICggdHlwZW9mIG9wdGlvbnMgPT09ICJzdHJpbmciICkgew0KICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7IGVmZmVjdDogb3B0aW9ucyB9Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgaGFzT3B0aW9uczsNCiAgICAgICAgICAgIHZhciBlZmZlY3ROYW1lID0gIW9wdGlvbnMgPw0KICAgICAgICAgICAgICAgIG1ldGhvZCA6DQogICAgICAgICAgICAgICAgb3B0aW9ucyA9PT0gdHJ1ZSB8fCB0eXBlb2Ygb3B0aW9ucyA9PT0gIm51bWJlciIgPw0KICAgICAgICAgICAgICAgICAgICBkZWZhdWx0RWZmZWN0IDoNCiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5lZmZlY3QgfHwgZGVmYXVsdEVmZmVjdDsNCg0KICAgICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307DQogICAgICAgICAgICBpZiAoIHR5cGVvZiBvcHRpb25zID09PSAibnVtYmVyIiApIHsNCiAgICAgICAgICAgICAgICBvcHRpb25zID0geyBkdXJhdGlvbjogb3B0aW9ucyB9Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBoYXNPcHRpb25zID0gISQuaXNFbXB0eU9iamVjdCggb3B0aW9ucyApOw0KICAgICAgICAgICAgb3B0aW9ucy5jb21wbGV0ZSA9IGNhbGxiYWNrOw0KDQogICAgICAgICAgICBpZiAoIG9wdGlvbnMuZGVsYXkgKSB7DQogICAgICAgICAgICAgICAgZWxlbWVudC5kZWxheSggb3B0aW9ucy5kZWxheSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGhhc09wdGlvbnMgJiYgJC5lZmZlY3RzICYmICQuZWZmZWN0cy5lZmZlY3RbIGVmZmVjdE5hbWUgXSApIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50WyBtZXRob2QgXSggb3B0aW9ucyApOw0KICAgICAgICAgICAgfSBlbHNlIGlmICggZWZmZWN0TmFtZSAhPT0gbWV0aG9kICYmIGVsZW1lbnRbIGVmZmVjdE5hbWUgXSApIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50WyBlZmZlY3ROYW1lIF0oIG9wdGlvbnMuZHVyYXRpb24sIG9wdGlvbnMuZWFzaW5nLCBjYWxsYmFjayApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50LnF1ZXVlKCBmdW5jdGlvbiggbmV4dCApIHsNCiAgICAgICAgICAgICAgICAgICAgJCggdGhpcyApWyBtZXRob2QgXSgpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIGNhbGxiYWNrICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2suY2FsbCggZWxlbWVudFsgMCBdICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgbmV4dCgpOw0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCiAgICB9ICk7DQoNCiAgICB2YXIgd2lkZ2V0ID0gJC53aWRnZXQ7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIFBvc2l0aW9uIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKg0KICogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vcG9zaXRpb24vDQogKi8NCg0KLy8+PmxhYmVsOiBQb3NpdGlvbg0KLy8+Pmdyb3VwOiBDb3JlDQovLz4+ZGVzY3JpcHRpb246IFBvc2l0aW9ucyBlbGVtZW50cyByZWxhdGl2ZSB0byBvdGhlciBlbGVtZW50cy4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9wb3NpdGlvbi8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9wb3NpdGlvbi8NCg0KDQogICAgKCBmdW5jdGlvbigpIHsNCiAgICAgICAgdmFyIGNhY2hlZFNjcm9sbGJhcldpZHRoLA0KICAgICAgICAgICAgbWF4ID0gTWF0aC5tYXgsDQogICAgICAgICAgICBhYnMgPSBNYXRoLmFicywNCiAgICAgICAgICAgIHJob3Jpem9udGFsID0gL2xlZnR8Y2VudGVyfHJpZ2h0LywNCiAgICAgICAgICAgIHJ2ZXJ0aWNhbCA9IC90b3B8Y2VudGVyfGJvdHRvbS8sDQogICAgICAgICAgICByb2Zmc2V0ID0gL1tcK1wtXVxkKyhcLltcZF0rKT8lPy8sDQogICAgICAgICAgICBycG9zaXRpb24gPSAvXlx3Ky8sDQogICAgICAgICAgICBycGVyY2VudCA9IC8lJC8sDQogICAgICAgICAgICBfcG9zaXRpb24gPSAkLmZuLnBvc2l0aW9uOw0KDQogICAgICAgIGZ1bmN0aW9uIGdldE9mZnNldHMoIG9mZnNldHMsIHdpZHRoLCBoZWlnaHQgKSB7DQogICAgICAgICAgICByZXR1cm4gWw0KICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQoIG9mZnNldHNbIDAgXSApICogKCBycGVyY2VudC50ZXN0KCBvZmZzZXRzWyAwIF0gKSA/IHdpZHRoIC8gMTAwIDogMSApLA0KICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQoIG9mZnNldHNbIDEgXSApICogKCBycGVyY2VudC50ZXN0KCBvZmZzZXRzWyAxIF0gKSA/IGhlaWdodCAvIDEwMCA6IDEgKQ0KICAgICAgICAgICAgXTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZ1bmN0aW9uIHBhcnNlQ3NzKCBlbGVtZW50LCBwcm9wZXJ0eSApIHsNCiAgICAgICAgICAgIHJldHVybiBwYXJzZUludCggJC5jc3MoIGVsZW1lbnQsIHByb3BlcnR5ICksIDEwICkgfHwgMDsNCiAgICAgICAgfQ0KDQogICAgICAgIGZ1bmN0aW9uIGdldERpbWVuc2lvbnMoIGVsZW0gKSB7DQogICAgICAgICAgICB2YXIgcmF3ID0gZWxlbVsgMCBdOw0KICAgICAgICAgICAgaWYgKCByYXcubm9kZVR5cGUgPT09IDkgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGVsZW0ud2lkdGgoKSwNCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBlbGVtLmhlaWdodCgpLA0KICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IHsgdG9wOiAwLCBsZWZ0OiAwIH0NCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCAkLmlzV2luZG93KCByYXcgKSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogZWxlbS53aWR0aCgpLA0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGVsZW0uaGVpZ2h0KCksDQogICAgICAgICAgICAgICAgICAgIG9mZnNldDogeyB0b3A6IGVsZW0uc2Nyb2xsVG9wKCksIGxlZnQ6IGVsZW0uc2Nyb2xsTGVmdCgpIH0NCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCByYXcucHJldmVudERlZmF1bHQgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDAsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodDogMCwNCiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiB7IHRvcDogcmF3LnBhZ2VZLCBsZWZ0OiByYXcucGFnZVggfQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIHdpZHRoOiBlbGVtLm91dGVyV2lkdGgoKSwNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IGVsZW0ub3V0ZXJIZWlnaHQoKSwNCiAgICAgICAgICAgICAgICBvZmZzZXQ6IGVsZW0ub2Zmc2V0KCkNCiAgICAgICAgICAgIH07DQogICAgICAgIH0NCg0KICAgICAgICAkLnBvc2l0aW9uID0gew0KICAgICAgICAgICAgc2Nyb2xsYmFyV2lkdGg6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGlmICggY2FjaGVkU2Nyb2xsYmFyV2lkdGggIT09IHVuZGVmaW5lZCApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNjcm9sbGJhcldpZHRoOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB2YXIgdzEsIHcyLA0KICAgICAgICAgICAgICAgICAgICBkaXYgPSAkKCAiPGRpdiAiICsNCiAgICAgICAgICAgICAgICAgICAgICAgICJzdHlsZT0nZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDo1MHB4O2hlaWdodDo1MHB4O292ZXJmbG93OmhpZGRlbjsnPiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgIjxkaXYgc3R5bGU9J2hlaWdodDoxMDBweDt3aWR0aDphdXRvOyc+PC9kaXY+PC9kaXY+IiApLA0KICAgICAgICAgICAgICAgICAgICBpbm5lckRpdiA9IGRpdi5jaGlsZHJlbigpWyAwIF07DQoNCiAgICAgICAgICAgICAgICAkKCAiYm9keSIgKS5hcHBlbmQoIGRpdiApOw0KICAgICAgICAgICAgICAgIHcxID0gaW5uZXJEaXYub2Zmc2V0V2lkdGg7DQogICAgICAgICAgICAgICAgZGl2LmNzcyggIm92ZXJmbG93IiwgInNjcm9sbCIgKTsNCg0KICAgICAgICAgICAgICAgIHcyID0gaW5uZXJEaXYub2Zmc2V0V2lkdGg7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHcxID09PSB3MiApIHsNCiAgICAgICAgICAgICAgICAgICAgdzIgPSBkaXZbIDAgXS5jbGllbnRXaWR0aDsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBkaXYucmVtb3ZlKCk7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gKCBjYWNoZWRTY3JvbGxiYXJXaWR0aCA9IHcxIC0gdzIgKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBnZXRTY3JvbGxJbmZvOiBmdW5jdGlvbiggd2l0aGluICkgew0KICAgICAgICAgICAgICAgIHZhciBvdmVyZmxvd1ggPSB3aXRoaW4uaXNXaW5kb3cgfHwgd2l0aGluLmlzRG9jdW1lbnQgPyAiIiA6DQogICAgICAgICAgICAgICAgICAgIHdpdGhpbi5lbGVtZW50LmNzcyggIm92ZXJmbG93LXgiICksDQogICAgICAgICAgICAgICAgICAgIG92ZXJmbG93WSA9IHdpdGhpbi5pc1dpbmRvdyB8fCB3aXRoaW4uaXNEb2N1bWVudCA/ICIiIDoNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpdGhpbi5lbGVtZW50LmNzcyggIm92ZXJmbG93LXkiICksDQogICAgICAgICAgICAgICAgICAgIGhhc092ZXJmbG93WCA9IG92ZXJmbG93WCA9PT0gInNjcm9sbCIgfHwNCiAgICAgICAgICAgICAgICAgICAgICAgICggb3ZlcmZsb3dYID09PSAiYXV0byIgJiYgd2l0aGluLndpZHRoIDwgd2l0aGluLmVsZW1lbnRbIDAgXS5zY3JvbGxXaWR0aCApLA0KICAgICAgICAgICAgICAgICAgICBoYXNPdmVyZmxvd1kgPSBvdmVyZmxvd1kgPT09ICJzY3JvbGwiIHx8DQogICAgICAgICAgICAgICAgICAgICAgICAoIG92ZXJmbG93WSA9PT0gImF1dG8iICYmIHdpdGhpbi5oZWlnaHQgPCB3aXRoaW4uZWxlbWVudFsgMCBdLnNjcm9sbEhlaWdodCApOw0KICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiBoYXNPdmVyZmxvd1kgPyAkLnBvc2l0aW9uLnNjcm9sbGJhcldpZHRoKCkgOiAwLA0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGhhc092ZXJmbG93WCA/ICQucG9zaXRpb24uc2Nyb2xsYmFyV2lkdGgoKSA6IDANCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGdldFdpdGhpbkluZm86IGZ1bmN0aW9uKCBlbGVtZW50ICkgew0KICAgICAgICAgICAgICAgIHZhciB3aXRoaW5FbGVtZW50ID0gJCggZWxlbWVudCB8fCB3aW5kb3cgKSwNCiAgICAgICAgICAgICAgICAgICAgaXNXaW5kb3cgPSAkLmlzV2luZG93KCB3aXRoaW5FbGVtZW50WyAwIF0gKSwNCiAgICAgICAgICAgICAgICAgICAgaXNEb2N1bWVudCA9ICEhd2l0aGluRWxlbWVudFsgMCBdICYmIHdpdGhpbkVsZW1lbnRbIDAgXS5ub2RlVHlwZSA9PT0gOSwNCiAgICAgICAgICAgICAgICAgICAgaGFzT2Zmc2V0ID0gIWlzV2luZG93ICYmICFpc0RvY3VtZW50Ow0KICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IHdpdGhpbkVsZW1lbnQsDQogICAgICAgICAgICAgICAgICAgIGlzV2luZG93OiBpc1dpbmRvdywNCiAgICAgICAgICAgICAgICAgICAgaXNEb2N1bWVudDogaXNEb2N1bWVudCwNCiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiBoYXNPZmZzZXQgPyAkKCBlbGVtZW50ICkub2Zmc2V0KCkgOiB7IGxlZnQ6IDAsIHRvcDogMCB9LA0KICAgICAgICAgICAgICAgICAgICBzY3JvbGxMZWZ0OiB3aXRoaW5FbGVtZW50LnNjcm9sbExlZnQoKSwNCiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9wOiB3aXRoaW5FbGVtZW50LnNjcm9sbFRvcCgpLA0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogd2l0aGluRWxlbWVudC5vdXRlcldpZHRoKCksDQogICAgICAgICAgICAgICAgICAgIGhlaWdodDogd2l0aGluRWxlbWVudC5vdXRlckhlaWdodCgpDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCg0KICAgICAgICAkLmZuLnBvc2l0aW9uID0gZnVuY3Rpb24oIG9wdGlvbnMgKSB7DQogICAgICAgICAgICBpZiAoICFvcHRpb25zIHx8ICFvcHRpb25zLm9mICkgew0KICAgICAgICAgICAgICAgIHJldHVybiBfcG9zaXRpb24uYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBNYWtlIGEgY29weSwgd2UgZG9uJ3Qgd2FudCB0byBtb2RpZnkgYXJndW1lbnRzDQogICAgICAgICAgICBvcHRpb25zID0gJC5leHRlbmQoIHt9LCBvcHRpb25zICk7DQoNCiAgICAgICAgICAgIHZhciBhdE9mZnNldCwgdGFyZ2V0V2lkdGgsIHRhcmdldEhlaWdodCwgdGFyZ2V0T2Zmc2V0LCBiYXNlUG9zaXRpb24sIGRpbWVuc2lvbnMsDQogICAgICAgICAgICAgICAgdGFyZ2V0ID0gJCggb3B0aW9ucy5vZiApLA0KICAgICAgICAgICAgICAgIHdpdGhpbiA9ICQucG9zaXRpb24uZ2V0V2l0aGluSW5mbyggb3B0aW9ucy53aXRoaW4gKSwNCiAgICAgICAgICAgICAgICBzY3JvbGxJbmZvID0gJC5wb3NpdGlvbi5nZXRTY3JvbGxJbmZvKCB3aXRoaW4gKSwNCiAgICAgICAgICAgICAgICBjb2xsaXNpb24gPSAoIG9wdGlvbnMuY29sbGlzaW9uIHx8ICJmbGlwIiApLnNwbGl0KCAiICIgKSwNCiAgICAgICAgICAgICAgICBvZmZzZXRzID0ge307DQoNCiAgICAgICAgICAgIGRpbWVuc2lvbnMgPSBnZXREaW1lbnNpb25zKCB0YXJnZXQgKTsNCiAgICAgICAgICAgIGlmICggdGFyZ2V0WyAwIF0ucHJldmVudERlZmF1bHQgKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBGb3JjZSBsZWZ0IHRvcCB0byBhbGxvdyBmbGlwcGluZw0KICAgICAgICAgICAgICAgIG9wdGlvbnMuYXQgPSAibGVmdCB0b3AiOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGFyZ2V0V2lkdGggPSBkaW1lbnNpb25zLndpZHRoOw0KICAgICAgICAgICAgdGFyZ2V0SGVpZ2h0ID0gZGltZW5zaW9ucy5oZWlnaHQ7DQogICAgICAgICAgICB0YXJnZXRPZmZzZXQgPSBkaW1lbnNpb25zLm9mZnNldDsNCg0KICAgICAgICAgICAgLy8gQ2xvbmUgdG8gcmV1c2Ugb3JpZ2luYWwgdGFyZ2V0T2Zmc2V0IGxhdGVyDQogICAgICAgICAgICBiYXNlUG9zaXRpb24gPSAkLmV4dGVuZCgge30sIHRhcmdldE9mZnNldCApOw0KDQogICAgICAgICAgICAvLyBGb3JjZSBteSBhbmQgYXQgdG8gaGF2ZSB2YWxpZCBob3Jpem9udGFsIGFuZCB2ZXJ0aWNhbCBwb3NpdGlvbnMNCiAgICAgICAgICAgIC8vIGlmIGEgdmFsdWUgaXMgbWlzc2luZyBvciBpbnZhbGlkLCBpdCB3aWxsIGJlIGNvbnZlcnRlZCB0byBjZW50ZXINCiAgICAgICAgICAgICQuZWFjaCggWyAibXkiLCAiYXQiIF0sIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciBwb3MgPSAoIG9wdGlvbnNbIHRoaXMgXSB8fCAiIiApLnNwbGl0KCAiICIgKSwNCiAgICAgICAgICAgICAgICAgICAgaG9yaXpvbnRhbE9mZnNldCwNCiAgICAgICAgICAgICAgICAgICAgdmVydGljYWxPZmZzZXQ7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHBvcy5sZW5ndGggPT09IDEgKSB7DQogICAgICAgICAgICAgICAgICAgIHBvcyA9IHJob3Jpem9udGFsLnRlc3QoIHBvc1sgMCBdICkgPw0KICAgICAgICAgICAgICAgICAgICAgICAgcG9zLmNvbmNhdCggWyAiY2VudGVyIiBdICkgOg0KICAgICAgICAgICAgICAgICAgICAgICAgcnZlcnRpY2FsLnRlc3QoIHBvc1sgMCBdICkgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsgImNlbnRlciIgXS5jb25jYXQoIHBvcyApIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbICJjZW50ZXIiLCAiY2VudGVyIiBdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBwb3NbIDAgXSA9IHJob3Jpem9udGFsLnRlc3QoIHBvc1sgMCBdICkgPyBwb3NbIDAgXSA6ICJjZW50ZXIiOw0KICAgICAgICAgICAgICAgIHBvc1sgMSBdID0gcnZlcnRpY2FsLnRlc3QoIHBvc1sgMSBdICkgPyBwb3NbIDEgXSA6ICJjZW50ZXIiOw0KDQogICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG9mZnNldHMNCiAgICAgICAgICAgICAgICBob3Jpem9udGFsT2Zmc2V0ID0gcm9mZnNldC5leGVjKCBwb3NbIDAgXSApOw0KICAgICAgICAgICAgICAgIHZlcnRpY2FsT2Zmc2V0ID0gcm9mZnNldC5leGVjKCBwb3NbIDEgXSApOw0KICAgICAgICAgICAgICAgIG9mZnNldHNbIHRoaXMgXSA9IFsNCiAgICAgICAgICAgICAgICAgICAgaG9yaXpvbnRhbE9mZnNldCA/IGhvcml6b250YWxPZmZzZXRbIDAgXSA6IDAsDQogICAgICAgICAgICAgICAgICAgIHZlcnRpY2FsT2Zmc2V0ID8gdmVydGljYWxPZmZzZXRbIDAgXSA6IDANCiAgICAgICAgICAgICAgICBdOw0KDQogICAgICAgICAgICAgICAgLy8gUmVkdWNlIHRvIGp1c3QgdGhlIHBvc2l0aW9ucyB3aXRob3V0IHRoZSBvZmZzZXRzDQogICAgICAgICAgICAgICAgb3B0aW9uc1sgdGhpcyBdID0gWw0KICAgICAgICAgICAgICAgICAgICBycG9zaXRpb24uZXhlYyggcG9zWyAwIF0gKVsgMCBdLA0KICAgICAgICAgICAgICAgICAgICBycG9zaXRpb24uZXhlYyggcG9zWyAxIF0gKVsgMCBdDQogICAgICAgICAgICAgICAgXTsNCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgLy8gTm9ybWFsaXplIGNvbGxpc2lvbiBvcHRpb24NCiAgICAgICAgICAgIGlmICggY29sbGlzaW9uLmxlbmd0aCA9PT0gMSApIHsNCiAgICAgICAgICAgICAgICBjb2xsaXNpb25bIDEgXSA9IGNvbGxpc2lvblsgMCBdOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIG9wdGlvbnMuYXRbIDAgXSA9PT0gInJpZ2h0IiApIHsNCiAgICAgICAgICAgICAgICBiYXNlUG9zaXRpb24ubGVmdCArPSB0YXJnZXRXaWR0aDsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIG9wdGlvbnMuYXRbIDAgXSA9PT0gImNlbnRlciIgKSB7DQogICAgICAgICAgICAgICAgYmFzZVBvc2l0aW9uLmxlZnQgKz0gdGFyZ2V0V2lkdGggLyAyOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIG9wdGlvbnMuYXRbIDEgXSA9PT0gImJvdHRvbSIgKSB7DQogICAgICAgICAgICAgICAgYmFzZVBvc2l0aW9uLnRvcCArPSB0YXJnZXRIZWlnaHQ7DQogICAgICAgICAgICB9IGVsc2UgaWYgKCBvcHRpb25zLmF0WyAxIF0gPT09ICJjZW50ZXIiICkgew0KICAgICAgICAgICAgICAgIGJhc2VQb3NpdGlvbi50b3AgKz0gdGFyZ2V0SGVpZ2h0IC8gMjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgYXRPZmZzZXQgPSBnZXRPZmZzZXRzKCBvZmZzZXRzLmF0LCB0YXJnZXRXaWR0aCwgdGFyZ2V0SGVpZ2h0ICk7DQogICAgICAgICAgICBiYXNlUG9zaXRpb24ubGVmdCArPSBhdE9mZnNldFsgMCBdOw0KICAgICAgICAgICAgYmFzZVBvc2l0aW9uLnRvcCArPSBhdE9mZnNldFsgMSBdOw0KDQogICAgICAgICAgICByZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB2YXIgY29sbGlzaW9uUG9zaXRpb24sIHVzaW5nLA0KICAgICAgICAgICAgICAgICAgICBlbGVtID0gJCggdGhpcyApLA0KICAgICAgICAgICAgICAgICAgICBlbGVtV2lkdGggPSBlbGVtLm91dGVyV2lkdGgoKSwNCiAgICAgICAgICAgICAgICAgICAgZWxlbUhlaWdodCA9IGVsZW0ub3V0ZXJIZWlnaHQoKSwNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luTGVmdCA9IHBhcnNlQ3NzKCB0aGlzLCAibWFyZ2luTGVmdCIgKSwNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luVG9wID0gcGFyc2VDc3MoIHRoaXMsICJtYXJnaW5Ub3AiICksDQogICAgICAgICAgICAgICAgICAgIGNvbGxpc2lvbldpZHRoID0gZWxlbVdpZHRoICsgbWFyZ2luTGVmdCArIHBhcnNlQ3NzKCB0aGlzLCAibWFyZ2luUmlnaHQiICkgKw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsSW5mby53aWR0aCwNCiAgICAgICAgICAgICAgICAgICAgY29sbGlzaW9uSGVpZ2h0ID0gZWxlbUhlaWdodCArIG1hcmdpblRvcCArIHBhcnNlQ3NzKCB0aGlzLCAibWFyZ2luQm90dG9tIiApICsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbEluZm8uaGVpZ2h0LA0KICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9ICQuZXh0ZW5kKCB7fSwgYmFzZVBvc2l0aW9uICksDQogICAgICAgICAgICAgICAgICAgIG15T2Zmc2V0ID0gZ2V0T2Zmc2V0cyggb2Zmc2V0cy5teSwgZWxlbS5vdXRlcldpZHRoKCksIGVsZW0ub3V0ZXJIZWlnaHQoKSApOw0KDQogICAgICAgICAgICAgICAgaWYgKCBvcHRpb25zLm15WyAwIF0gPT09ICJyaWdodCIgKSB7DQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLmxlZnQgLT0gZWxlbVdpZHRoOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIG9wdGlvbnMubXlbIDAgXSA9PT0gImNlbnRlciIgKSB7DQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLmxlZnQgLT0gZWxlbVdpZHRoIC8gMjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoIG9wdGlvbnMubXlbIDEgXSA9PT0gImJvdHRvbSIgKSB7DQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLnRvcCAtPSBlbGVtSGVpZ2h0Ow0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIG9wdGlvbnMubXlbIDEgXSA9PT0gImNlbnRlciIgKSB7DQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLnRvcCAtPSBlbGVtSGVpZ2h0IC8gMjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBwb3NpdGlvbi5sZWZ0ICs9IG15T2Zmc2V0WyAwIF07DQogICAgICAgICAgICAgICAgcG9zaXRpb24udG9wICs9IG15T2Zmc2V0WyAxIF07DQoNCiAgICAgICAgICAgICAgICBjb2xsaXNpb25Qb3NpdGlvbiA9IHsNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luTGVmdDogbWFyZ2luTGVmdCwNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luVG9wOiBtYXJnaW5Ub3ANCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAgICAgJC5lYWNoKCBbICJsZWZ0IiwgInRvcCIgXSwgZnVuY3Rpb24oIGksIGRpciApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAkLnVpLnBvc2l0aW9uWyBjb2xsaXNpb25bIGkgXSBdICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgJC51aS5wb3NpdGlvblsgY29sbGlzaW9uWyBpIF0gXVsgZGlyIF0oIHBvc2l0aW9uLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0V2lkdGg6IHRhcmdldFdpZHRoLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEhlaWdodDogdGFyZ2V0SGVpZ2h0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1XaWR0aDogZWxlbVdpZHRoLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1IZWlnaHQ6IGVsZW1IZWlnaHQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sbGlzaW9uUG9zaXRpb246IGNvbGxpc2lvblBvc2l0aW9uLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbGxpc2lvbldpZHRoOiBjb2xsaXNpb25XaWR0aCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xsaXNpb25IZWlnaHQ6IGNvbGxpc2lvbkhlaWdodCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IFsgYXRPZmZzZXRbIDAgXSArIG15T2Zmc2V0WyAwIF0sIGF0T2Zmc2V0IFsgMSBdICsgbXlPZmZzZXRbIDEgXSBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15OiBvcHRpb25zLm15LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0OiBvcHRpb25zLmF0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGhpbjogd2l0aGluLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW06IGVsZW0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgICAgIGlmICggb3B0aW9ucy51c2luZyApIHsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBBZGRzIGZlZWRiYWNrIGFzIHNlY29uZCBhcmd1bWVudCB0byB1c2luZyBjYWxsYmFjaywgaWYgcHJlc2VudA0KICAgICAgICAgICAgICAgICAgICB1c2luZyA9IGZ1bmN0aW9uKCBwcm9wcyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZWZ0ID0gdGFyZ2V0T2Zmc2V0LmxlZnQgLSBwb3NpdGlvbi5sZWZ0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0gbGVmdCArIHRhcmdldFdpZHRoIC0gZWxlbVdpZHRoLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IHRhcmdldE9mZnNldC50b3AgLSBwb3NpdGlvbi50b3AsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0gdG9wICsgdGFyZ2V0SGVpZ2h0IC0gZWxlbUhlaWdodCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmZWVkYmFjayA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiB0YXJnZXQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiB0YXJnZXRPZmZzZXQubGVmdCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogdGFyZ2V0T2Zmc2V0LnRvcCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiB0YXJnZXRXaWR0aCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogdGFyZ2V0SGVpZ2h0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBwb3NpdGlvbi5sZWZ0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiBwb3NpdGlvbi50b3AsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogZWxlbVdpZHRoLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBlbGVtSGVpZ2h0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvcml6b250YWw6IHJpZ2h0IDwgMCA/ICJsZWZ0IiA6IGxlZnQgPiAwID8gInJpZ2h0IiA6ICJjZW50ZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNhbDogYm90dG9tIDwgMCA/ICJ0b3AiIDogdG9wID4gMCA/ICJib3R0b20iIDogIm1pZGRsZSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0YXJnZXRXaWR0aCA8IGVsZW1XaWR0aCAmJiBhYnMoIGxlZnQgKyByaWdodCApIDwgdGFyZ2V0V2lkdGggKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVlZGJhY2suaG9yaXpvbnRhbCA9ICJjZW50ZXIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0YXJnZXRIZWlnaHQgPCBlbGVtSGVpZ2h0ICYmIGFicyggdG9wICsgYm90dG9tICkgPCB0YXJnZXRIZWlnaHQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVlZGJhY2sudmVydGljYWwgPSAibWlkZGxlIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggbWF4KCBhYnMoIGxlZnQgKSwgYWJzKCByaWdodCApICkgPiBtYXgoIGFicyggdG9wICksIGFicyggYm90dG9tICkgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmZWVkYmFjay5pbXBvcnRhbnQgPSAiaG9yaXpvbnRhbCI7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlZWRiYWNrLmltcG9ydGFudCA9ICJ2ZXJ0aWNhbCI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnVzaW5nLmNhbGwoIHRoaXMsIHByb3BzLCBmZWVkYmFjayApOw0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGVsZW0ub2Zmc2V0KCAkLmV4dGVuZCggcG9zaXRpb24sIHsgdXNpbmc6IHVzaW5nIH0gKSApOw0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9Ow0KDQogICAgICAgICQudWkucG9zaXRpb24gPSB7DQogICAgICAgICAgICBmaXQ6IHsNCiAgICAgICAgICAgICAgICBsZWZ0OiBmdW5jdGlvbiggcG9zaXRpb24sIGRhdGEgKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciB3aXRoaW4gPSBkYXRhLndpdGhpbiwNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpdGhpbk9mZnNldCA9IHdpdGhpbi5pc1dpbmRvdyA/IHdpdGhpbi5zY3JvbGxMZWZ0IDogd2l0aGluLm9mZnNldC5sZWZ0LA0KICAgICAgICAgICAgICAgICAgICAgICAgb3V0ZXJXaWR0aCA9IHdpdGhpbi53aWR0aCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbGxpc2lvblBvc0xlZnQgPSBwb3NpdGlvbi5sZWZ0IC0gZGF0YS5jb2xsaXNpb25Qb3NpdGlvbi5tYXJnaW5MZWZ0LA0KICAgICAgICAgICAgICAgICAgICAgICAgb3ZlckxlZnQgPSB3aXRoaW5PZmZzZXQgLSBjb2xsaXNpb25Qb3NMZWZ0LA0KICAgICAgICAgICAgICAgICAgICAgICAgb3ZlclJpZ2h0ID0gY29sbGlzaW9uUG9zTGVmdCArIGRhdGEuY29sbGlzaW9uV2lkdGggLSBvdXRlcldpZHRoIC0gd2l0aGluT2Zmc2V0LA0KICAgICAgICAgICAgICAgICAgICAgICAgbmV3T3ZlclJpZ2h0Ow0KDQogICAgICAgICAgICAgICAgICAgIC8vIEVsZW1lbnQgaXMgd2lkZXIgdGhhbiB3aXRoaW4NCiAgICAgICAgICAgICAgICAgICAgaWYgKCBkYXRhLmNvbGxpc2lvbldpZHRoID4gb3V0ZXJXaWR0aCApIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gRWxlbWVudCBpcyBpbml0aWFsbHkgb3ZlciB0aGUgbGVmdCBzaWRlIG9mIHdpdGhpbg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBvdmVyTGVmdCA+IDAgJiYgb3ZlclJpZ2h0IDw9IDAgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3T3ZlclJpZ2h0ID0gcG9zaXRpb24ubGVmdCArIG92ZXJMZWZ0ICsgZGF0YS5jb2xsaXNpb25XaWR0aCAtIG91dGVyV2lkdGggLQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aXRoaW5PZmZzZXQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24ubGVmdCArPSBvdmVyTGVmdCAtIG5ld092ZXJSaWdodDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVsZW1lbnQgaXMgaW5pdGlhbGx5IG92ZXIgcmlnaHQgc2lkZSBvZiB3aXRoaW4NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIG92ZXJSaWdodCA+IDAgJiYgb3ZlckxlZnQgPD0gMCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi5sZWZ0ID0gd2l0aGluT2Zmc2V0Ow0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRWxlbWVudCBpcyBpbml0aWFsbHkgb3ZlciBib3RoIGxlZnQgYW5kIHJpZ2h0IHNpZGVzIG9mIHdpdGhpbg0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG92ZXJMZWZ0ID4gb3ZlclJpZ2h0ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi5sZWZ0ID0gd2l0aGluT2Zmc2V0ICsgb3V0ZXJXaWR0aCAtIGRhdGEuY29sbGlzaW9uV2lkdGg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24ubGVmdCA9IHdpdGhpbk9mZnNldDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRvbyBmYXIgbGVmdCAtPiBhbGlnbiB3aXRoIGxlZnQgZWRnZQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBvdmVyTGVmdCA+IDAgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi5sZWZ0ICs9IG92ZXJMZWZ0Ow0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBUb28gZmFyIHJpZ2h0IC0+IGFsaWduIHdpdGggcmlnaHQgZWRnZQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBvdmVyUmlnaHQgPiAwICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24ubGVmdCAtPSBvdmVyUmlnaHQ7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkanVzdCBiYXNlZCBvbiBwb3NpdGlvbiBhbmQgbWFyZ2luDQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi5sZWZ0ID0gbWF4KCBwb3NpdGlvbi5sZWZ0IC0gY29sbGlzaW9uUG9zTGVmdCwgcG9zaXRpb24ubGVmdCApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB0b3A6IGZ1bmN0aW9uKCBwb3NpdGlvbiwgZGF0YSApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHdpdGhpbiA9IGRhdGEud2l0aGluLA0KICAgICAgICAgICAgICAgICAgICAgICAgd2l0aGluT2Zmc2V0ID0gd2l0aGluLmlzV2luZG93ID8gd2l0aGluLnNjcm9sbFRvcCA6IHdpdGhpbi5vZmZzZXQudG9wLA0KICAgICAgICAgICAgICAgICAgICAgICAgb3V0ZXJIZWlnaHQgPSBkYXRhLndpdGhpbi5oZWlnaHQsDQogICAgICAgICAgICAgICAgICAgICAgICBjb2xsaXNpb25Qb3NUb3AgPSBwb3NpdGlvbi50b3AgLSBkYXRhLmNvbGxpc2lvblBvc2l0aW9uLm1hcmdpblRvcCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJUb3AgPSB3aXRoaW5PZmZzZXQgLSBjb2xsaXNpb25Qb3NUb3AsDQogICAgICAgICAgICAgICAgICAgICAgICBvdmVyQm90dG9tID0gY29sbGlzaW9uUG9zVG9wICsgZGF0YS5jb2xsaXNpb25IZWlnaHQgLSBvdXRlckhlaWdodCAtIHdpdGhpbk9mZnNldCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld092ZXJCb3R0b207DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gRWxlbWVudCBpcyB0YWxsZXIgdGhhbiB3aXRoaW4NCiAgICAgICAgICAgICAgICAgICAgaWYgKCBkYXRhLmNvbGxpc2lvbkhlaWdodCA+IG91dGVySGVpZ2h0ICkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBFbGVtZW50IGlzIGluaXRpYWxseSBvdmVyIHRoZSB0b3Agb2Ygd2l0aGluDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG92ZXJUb3AgPiAwICYmIG92ZXJCb3R0b20gPD0gMCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdPdmVyQm90dG9tID0gcG9zaXRpb24udG9wICsgb3ZlclRvcCArIGRhdGEuY29sbGlzaW9uSGVpZ2h0IC0gb3V0ZXJIZWlnaHQgLQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aXRoaW5PZmZzZXQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24udG9wICs9IG92ZXJUb3AgLSBuZXdPdmVyQm90dG9tOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRWxlbWVudCBpcyBpbml0aWFsbHkgb3ZlciBib3R0b20gb2Ygd2l0aGluDQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBvdmVyQm90dG9tID4gMCAmJiBvdmVyVG9wIDw9IDAgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24udG9wID0gd2l0aGluT2Zmc2V0Ow0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRWxlbWVudCBpcyBpbml0aWFsbHkgb3ZlciBib3RoIHRvcCBhbmQgYm90dG9tIG9mIHdpdGhpbg0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG92ZXJUb3AgPiBvdmVyQm90dG9tICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi50b3AgPSB3aXRoaW5PZmZzZXQgKyBvdXRlckhlaWdodCAtIGRhdGEuY29sbGlzaW9uSGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLnRvcCA9IHdpdGhpbk9mZnNldDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRvbyBmYXIgdXAgLT4gYWxpZ24gd2l0aCB0b3ANCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggb3ZlclRvcCA+IDAgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi50b3AgKz0gb3ZlclRvcDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gVG9vIGZhciBkb3duIC0+IGFsaWduIHdpdGggYm90dG9tIGVkZ2UNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggb3ZlckJvdHRvbSA+IDAgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi50b3AgLT0gb3ZlckJvdHRvbTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRqdXN0IGJhc2VkIG9uIHBvc2l0aW9uIGFuZCBtYXJnaW4NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLnRvcCA9IG1heCggcG9zaXRpb24udG9wIC0gY29sbGlzaW9uUG9zVG9wLCBwb3NpdGlvbi50b3AgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBmbGlwOiB7DQogICAgICAgICAgICAgICAgbGVmdDogZnVuY3Rpb24oIHBvc2l0aW9uLCBkYXRhICkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgd2l0aGluID0gZGF0YS53aXRoaW4sDQogICAgICAgICAgICAgICAgICAgICAgICB3aXRoaW5PZmZzZXQgPSB3aXRoaW4ub2Zmc2V0LmxlZnQgKyB3aXRoaW4uc2Nyb2xsTGVmdCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG91dGVyV2lkdGggPSB3aXRoaW4ud2lkdGgsDQogICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRMZWZ0ID0gd2l0aGluLmlzV2luZG93ID8gd2l0aGluLnNjcm9sbExlZnQgOiB3aXRoaW4ub2Zmc2V0LmxlZnQsDQogICAgICAgICAgICAgICAgICAgICAgICBjb2xsaXNpb25Qb3NMZWZ0ID0gcG9zaXRpb24ubGVmdCAtIGRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luTGVmdCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJMZWZ0ID0gY29sbGlzaW9uUG9zTGVmdCAtIG9mZnNldExlZnQsDQogICAgICAgICAgICAgICAgICAgICAgICBvdmVyUmlnaHQgPSBjb2xsaXNpb25Qb3NMZWZ0ICsgZGF0YS5jb2xsaXNpb25XaWR0aCAtIG91dGVyV2lkdGggLSBvZmZzZXRMZWZ0LA0KICAgICAgICAgICAgICAgICAgICAgICAgbXlPZmZzZXQgPSBkYXRhLm15WyAwIF0gPT09ICJsZWZ0IiA/DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLWRhdGEuZWxlbVdpZHRoIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLm15WyAwIF0gPT09ICJyaWdodCIgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmVsZW1XaWR0aCA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAsDQogICAgICAgICAgICAgICAgICAgICAgICBhdE9mZnNldCA9IGRhdGEuYXRbIDAgXSA9PT0gImxlZnQiID8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnRhcmdldFdpZHRoIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmF0WyAwIF0gPT09ICJyaWdodCIgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtZGF0YS50YXJnZXRXaWR0aCA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAsDQogICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSAtMiAqIGRhdGEub2Zmc2V0WyAwIF0sDQogICAgICAgICAgICAgICAgICAgICAgICBuZXdPdmVyUmlnaHQsDQogICAgICAgICAgICAgICAgICAgICAgICBuZXdPdmVyTGVmdDsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoIG92ZXJMZWZ0IDwgMCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld092ZXJSaWdodCA9IHBvc2l0aW9uLmxlZnQgKyBteU9mZnNldCArIGF0T2Zmc2V0ICsgb2Zmc2V0ICsgZGF0YS5jb2xsaXNpb25XaWR0aCAtDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0ZXJXaWR0aCAtIHdpdGhpbk9mZnNldDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggbmV3T3ZlclJpZ2h0IDwgMCB8fCBuZXdPdmVyUmlnaHQgPCBhYnMoIG92ZXJMZWZ0ICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24ubGVmdCArPSBteU9mZnNldCArIGF0T2Zmc2V0ICsgb2Zmc2V0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBvdmVyUmlnaHQgPiAwICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbmV3T3ZlckxlZnQgPSBwb3NpdGlvbi5sZWZ0IC0gZGF0YS5jb2xsaXNpb25Qb3NpdGlvbi5tYXJnaW5MZWZ0ICsgbXlPZmZzZXQgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0T2Zmc2V0ICsgb2Zmc2V0IC0gb2Zmc2V0TGVmdDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggbmV3T3ZlckxlZnQgPiAwIHx8IGFicyggbmV3T3ZlckxlZnQgKSA8IG92ZXJSaWdodCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi5sZWZ0ICs9IG15T2Zmc2V0ICsgYXRPZmZzZXQgKyBvZmZzZXQ7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHRvcDogZnVuY3Rpb24oIHBvc2l0aW9uLCBkYXRhICkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgd2l0aGluID0gZGF0YS53aXRoaW4sDQogICAgICAgICAgICAgICAgICAgICAgICB3aXRoaW5PZmZzZXQgPSB3aXRoaW4ub2Zmc2V0LnRvcCArIHdpdGhpbi5zY3JvbGxUb3AsDQogICAgICAgICAgICAgICAgICAgICAgICBvdXRlckhlaWdodCA9IHdpdGhpbi5oZWlnaHQsDQogICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRUb3AgPSB3aXRoaW4uaXNXaW5kb3cgPyB3aXRoaW4uc2Nyb2xsVG9wIDogd2l0aGluLm9mZnNldC50b3AsDQogICAgICAgICAgICAgICAgICAgICAgICBjb2xsaXNpb25Qb3NUb3AgPSBwb3NpdGlvbi50b3AgLSBkYXRhLmNvbGxpc2lvblBvc2l0aW9uLm1hcmdpblRvcCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJUb3AgPSBjb2xsaXNpb25Qb3NUb3AgLSBvZmZzZXRUb3AsDQogICAgICAgICAgICAgICAgICAgICAgICBvdmVyQm90dG9tID0gY29sbGlzaW9uUG9zVG9wICsgZGF0YS5jb2xsaXNpb25IZWlnaHQgLSBvdXRlckhlaWdodCAtIG9mZnNldFRvcCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IGRhdGEubXlbIDEgXSA9PT0gInRvcCIsDQogICAgICAgICAgICAgICAgICAgICAgICBteU9mZnNldCA9IHRvcCA/DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLWRhdGEuZWxlbUhlaWdodCA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5teVsgMSBdID09PSAiYm90dG9tIiA/DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuZWxlbUhlaWdodCA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAsDQogICAgICAgICAgICAgICAgICAgICAgICBhdE9mZnNldCA9IGRhdGEuYXRbIDEgXSA9PT0gInRvcCIgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEudGFyZ2V0SGVpZ2h0IDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmF0WyAxIF0gPT09ICJib3R0b20iID8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLWRhdGEudGFyZ2V0SGVpZ2h0IDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IC0yICogZGF0YS5vZmZzZXRbIDEgXSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld092ZXJUb3AsDQogICAgICAgICAgICAgICAgICAgICAgICBuZXdPdmVyQm90dG9tOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIG92ZXJUb3AgPCAwICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbmV3T3ZlckJvdHRvbSA9IHBvc2l0aW9uLnRvcCArIG15T2Zmc2V0ICsgYXRPZmZzZXQgKyBvZmZzZXQgKyBkYXRhLmNvbGxpc2lvbkhlaWdodCAtDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0ZXJIZWlnaHQgLSB3aXRoaW5PZmZzZXQ7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG5ld092ZXJCb3R0b20gPCAwIHx8IG5ld092ZXJCb3R0b20gPCBhYnMoIG92ZXJUb3AgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi50b3AgKz0gbXlPZmZzZXQgKyBhdE9mZnNldCArIG9mZnNldDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggb3ZlckJvdHRvbSA+IDAgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBuZXdPdmVyVG9wID0gcG9zaXRpb24udG9wIC0gZGF0YS5jb2xsaXNpb25Qb3NpdGlvbi5tYXJnaW5Ub3AgKyBteU9mZnNldCArIGF0T2Zmc2V0ICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgLSBvZmZzZXRUb3A7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG5ld092ZXJUb3AgPiAwIHx8IGFicyggbmV3T3ZlclRvcCApIDwgb3ZlckJvdHRvbSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbi50b3AgKz0gbXlPZmZzZXQgKyBhdE9mZnNldCArIG9mZnNldDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBmbGlwZml0OiB7DQogICAgICAgICAgICAgICAgbGVmdDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICQudWkucG9zaXRpb24uZmxpcC5sZWZ0LmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsNCiAgICAgICAgICAgICAgICAgICAgJC51aS5wb3NpdGlvbi5maXQubGVmdC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB0b3A6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAkLnVpLnBvc2l0aW9uLmZsaXAudG9wLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsNCiAgICAgICAgICAgICAgICAgICAgJC51aS5wb3NpdGlvbi5maXQudG9wLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH07DQoNCiAgICB9ICkoKTsNCg0KICAgIHZhciBwb3NpdGlvbiA9ICQudWkucG9zaXRpb247DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIDpkYXRhIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiA6ZGF0YSBTZWxlY3Rvcg0KLy8+Pmdyb3VwOiBDb3JlDQovLz4+ZGVzY3JpcHRpb246IFNlbGVjdHMgZWxlbWVudHMgd2hpY2ggaGF2ZSBkYXRhIHN0b3JlZCB1bmRlciB0aGUgc3BlY2lmaWVkIGtleS4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9kYXRhLXNlbGVjdG9yLw0KDQoNCiAgICB2YXIgZGF0YSA9ICQuZXh0ZW5kKCAkLmV4cHJbICI6IiBdLCB7DQogICAgICAgIGRhdGE6ICQuZXhwci5jcmVhdGVQc2V1ZG8gPw0KICAgICAgICAgICAgJC5leHByLmNyZWF0ZVBzZXVkbyggZnVuY3Rpb24oIGRhdGFOYW1lICkgew0KICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiggZWxlbSApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEhJC5kYXRhKCBlbGVtLCBkYXRhTmFtZSApOw0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9ICkgOg0KDQogICAgICAgICAgICAvLyBTdXBwb3J0OiBqUXVlcnkgPDEuOA0KICAgICAgICAgICAgZnVuY3Rpb24oIGVsZW0sIGksIG1hdGNoICkgew0KICAgICAgICAgICAgICAgIHJldHVybiAhISQuZGF0YSggZWxlbSwgbWF0Y2hbIDMgXSApOw0KICAgICAgICAgICAgfQ0KICAgIH0gKTsNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIERpc2FibGUgU2VsZWN0aW9uIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBkaXNhYmxlU2VsZWN0aW9uDQovLz4+Z3JvdXA6IENvcmUNCi8vPj5kZXNjcmlwdGlvbjogRGlzYWJsZSBzZWxlY3Rpb24gb2YgdGV4dCBjb250ZW50IHdpdGhpbiB0aGUgc2V0IG9mIG1hdGNoZWQgZWxlbWVudHMuDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZGlzYWJsZVNlbGVjdGlvbi8NCg0KLy8gVGhpcyBmaWxlIGlzIGRlcHJlY2F0ZWQNCg0KDQogICAgdmFyIGRpc2FibGVTZWxlY3Rpb24gPSAkLmZuLmV4dGVuZCggew0KICAgICAgICBkaXNhYmxlU2VsZWN0aW9uOiAoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGV2ZW50VHlwZSA9ICJvbnNlbGVjdHN0YXJ0IiBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApID8NCiAgICAgICAgICAgICAgICAic2VsZWN0c3RhcnQiIDoNCiAgICAgICAgICAgICAgICAibW91c2Vkb3duIjsNCg0KICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm9uKCBldmVudFR5cGUgKyAiLnVpLWRpc2FibGVTZWxlY3Rpb24iLCBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgfSApKCksDQoNCiAgICAgICAgZW5hYmxlU2VsZWN0aW9uOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLm9mZiggIi51aS1kaXNhYmxlU2VsZWN0aW9uIiApOw0KICAgICAgICB9DQogICAgfSApOw0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBFZmZlY3RzIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBFZmZlY3RzIENvcmUNCi8vPj5ncm91cDogRWZmZWN0cw0KLy8ganNjczpkaXNhYmxlIG1heGltdW1MaW5lTGVuZ3RoDQovLz4+ZGVzY3JpcHRpb246IEV4dGVuZHMgdGhlIGludGVybmFsIGpRdWVyeSBlZmZlY3RzLiBJbmNsdWRlcyBtb3JwaGluZyBhbmQgZWFzaW5nLiBSZXF1aXJlZCBieSBhbGwgb3RoZXIgZWZmZWN0cy4NCi8vIGpzY3M6ZW5hYmxlIG1heGltdW1MaW5lTGVuZ3RoDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vY2F0ZWdvcnkvZWZmZWN0cy1jb3JlLw0KLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL2VmZmVjdC8NCg0KDQoNCiAgICB2YXIgZGF0YVNwYWNlID0gInVpLWVmZmVjdHMtIiwNCiAgICAgICAgZGF0YVNwYWNlU3R5bGUgPSAidWktZWZmZWN0cy1zdHlsZSIsDQogICAgICAgIGRhdGFTcGFjZUFuaW1hdGVkID0gInVpLWVmZmVjdHMtYW5pbWF0ZWQiLA0KDQogICAgICAgIC8vIENyZWF0ZSBhIGxvY2FsIGpRdWVyeSBiZWNhdXNlIGpRdWVyeSBDb2xvciByZWxpZXMgb24gaXQgYW5kIHRoZQ0KICAgICAgICAvLyBnbG9iYWwgbWF5IG5vdCBleGlzdCB3aXRoIEFNRCBhbmQgYSBjdXN0b20gYnVpbGQgKCMxMDE5OSkNCiAgICAgICAgalF1ZXJ5ID0gJDsNCg0KICAgICQuZWZmZWN0cyA9IHsNCiAgICAgICAgZWZmZWN0OiB7fQ0KICAgIH07DQoNCiAgICAvKiENCiAqIGpRdWVyeSBDb2xvciBBbmltYXRpb25zIHYyLjEuMg0KICogaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnktY29sb3INCiAqDQogKiBDb3B5cmlnaHQgMjAxNCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKg0KICogRGF0ZTogV2VkIEphbiAxNiAwODo0NzowOSAyMDEzIC0wNjAwDQogKi8NCiAgICAoIGZ1bmN0aW9uKCBqUXVlcnksIHVuZGVmaW5lZCApIHsNCg0KICAgICAgICB2YXIgc3RlcEhvb2tzID0gImJhY2tncm91bmRDb2xvciBib3JkZXJCb3R0b21Db2xvciBib3JkZXJMZWZ0Q29sb3IgYm9yZGVyUmlnaHRDb2xvciAiICsNCiAgICAgICAgICAgICJib3JkZXJUb3BDb2xvciBjb2xvciBjb2x1bW5SdWxlQ29sb3Igb3V0bGluZUNvbG9yIHRleHREZWNvcmF0aW9uQ29sb3IgdGV4dEVtcGhhc2lzQ29sb3IiLA0KDQogICAgICAgICAgICAvLyBQbHVzZXF1YWxzIHRlc3QgZm9yICs9IDEwMCAtPSAxMDANCiAgICAgICAgICAgIHJwbHVzZXF1YWxzID0gL14oW1wtK10pPVxzKihcZCtcLj9cZCopLywNCg0KICAgICAgICAgICAgLy8gQSBzZXQgb2YgUkUncyB0aGF0IGNhbiBtYXRjaCBzdHJpbmdzIGFuZCBnZW5lcmF0ZSBjb2xvciB0dXBsZXMuDQogICAgICAgICAgICBzdHJpbmdQYXJzZXJzID0gWyB7DQogICAgICAgICAgICAgICAgcmU6IC9yZ2JhP1woXHMqKFxkezEsM30pXHMqLFxzKihcZHsxLDN9KVxzKixccyooXGR7MSwzfSlccyooPzosXHMqKFxkPyg/OlwuXGQrKT8pXHMqKT9cKS8sDQogICAgICAgICAgICAgICAgcGFyc2U6IGZ1bmN0aW9uKCBleGVjUmVzdWx0ICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gWw0KICAgICAgICAgICAgICAgICAgICAgICAgZXhlY1Jlc3VsdFsgMSBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgZXhlY1Jlc3VsdFsgMiBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgZXhlY1Jlc3VsdFsgMyBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgZXhlY1Jlc3VsdFsgNCBdDQogICAgICAgICAgICAgICAgICAgIF07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIHJlOiAvcmdiYT9cKFxzKihcZCsoPzpcLlxkKyk/KVwlXHMqLFxzKihcZCsoPzpcLlxkKyk/KVwlXHMqLFxzKihcZCsoPzpcLlxkKyk/KVwlXHMqKD86LFxzKihcZD8oPzpcLlxkKyk/KVxzKik/XCkvLA0KICAgICAgICAgICAgICAgIHBhcnNlOiBmdW5jdGlvbiggZXhlY1Jlc3VsdCApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWNSZXN1bHRbIDEgXSAqIDIuNTUsDQogICAgICAgICAgICAgICAgICAgICAgICBleGVjUmVzdWx0WyAyIF0gKiAyLjU1LA0KICAgICAgICAgICAgICAgICAgICAgICAgZXhlY1Jlc3VsdFsgMyBdICogMi41NSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWNSZXN1bHRbIDQgXQ0KICAgICAgICAgICAgICAgICAgICBdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCg0KICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVnZXggaWdub3JlcyBBLUYgYmVjYXVzZSBpdCdzIGNvbXBhcmVkIGFnYWluc3QgYW4gYWxyZWFkeSBsb3dlcmNhc2VkIHN0cmluZw0KICAgICAgICAgICAgICAgIHJlOiAvIyhbYS1mMC05XXsyfSkoW2EtZjAtOV17Mn0pKFthLWYwLTldezJ9KS8sDQogICAgICAgICAgICAgICAgcGFyc2U6IGZ1bmN0aW9uKCBleGVjUmVzdWx0ICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gWw0KICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQoIGV4ZWNSZXN1bHRbIDEgXSwgMTYgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KCBleGVjUmVzdWx0WyAyIF0sIDE2ICksDQogICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCggZXhlY1Jlc3VsdFsgMyBdLCAxNiApDQogICAgICAgICAgICAgICAgICAgIF07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KDQogICAgICAgICAgICAgICAgLy8gVGhpcyByZWdleCBpZ25vcmVzIEEtRiBiZWNhdXNlIGl0J3MgY29tcGFyZWQgYWdhaW5zdCBhbiBhbHJlYWR5IGxvd2VyY2FzZWQgc3RyaW5nDQogICAgICAgICAgICAgICAgcmU6IC8jKFthLWYwLTldKShbYS1mMC05XSkoW2EtZjAtOV0pLywNCiAgICAgICAgICAgICAgICBwYXJzZTogZnVuY3Rpb24oIGV4ZWNSZXN1bHQgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBbDQogICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCggZXhlY1Jlc3VsdFsgMSBdICsgZXhlY1Jlc3VsdFsgMSBdLCAxNiApLA0KICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQoIGV4ZWNSZXN1bHRbIDIgXSArIGV4ZWNSZXN1bHRbIDIgXSwgMTYgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KCBleGVjUmVzdWx0WyAzIF0gKyBleGVjUmVzdWx0WyAzIF0sIDE2ICkNCiAgICAgICAgICAgICAgICAgICAgXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgcmU6IC9oc2xhP1woXHMqKFxkKyg/OlwuXGQrKT8pXHMqLFxzKihcZCsoPzpcLlxkKyk/KVwlXHMqLFxzKihcZCsoPzpcLlxkKyk/KVwlXHMqKD86LFxzKihcZD8oPzpcLlxkKyk/KVxzKik/XCkvLA0KICAgICAgICAgICAgICAgIHNwYWNlOiAiaHNsYSIsDQogICAgICAgICAgICAgICAgcGFyc2U6IGZ1bmN0aW9uKCBleGVjUmVzdWx0ICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gWw0KICAgICAgICAgICAgICAgICAgICAgICAgZXhlY1Jlc3VsdFsgMSBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgZXhlY1Jlc3VsdFsgMiBdIC8gMTAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgZXhlY1Jlc3VsdFsgMyBdIC8gMTAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgZXhlY1Jlc3VsdFsgNCBdDQogICAgICAgICAgICAgICAgICAgIF07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBdLA0KDQogICAgICAgICAgICAvLyBKUXVlcnkuQ29sb3IoICkNCiAgICAgICAgICAgIGNvbG9yID0galF1ZXJ5LkNvbG9yID0gZnVuY3Rpb24oIGNvbG9yLCBncmVlbiwgYmx1ZSwgYWxwaGEgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBqUXVlcnkuQ29sb3IuZm4ucGFyc2UoIGNvbG9yLCBncmVlbiwgYmx1ZSwgYWxwaGEgKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBzcGFjZXMgPSB7DQogICAgICAgICAgICAgICAgcmdiYTogew0KICAgICAgICAgICAgICAgICAgICBwcm9wczogew0KICAgICAgICAgICAgICAgICAgICAgICAgcmVkOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWR4OiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJieXRlIg0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGdyZWVuOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWR4OiAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJieXRlIg0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGJsdWU6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZHg6IDIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImJ5dGUiDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgaHNsYTogew0KICAgICAgICAgICAgICAgICAgICBwcm9wczogew0KICAgICAgICAgICAgICAgICAgICAgICAgaHVlOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWR4OiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJkZWdyZWVzIg0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHNhdHVyYXRpb246IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZHg6IDEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogInBlcmNlbnQiDQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgbGlnaHRuZXNzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWR4OiAyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJwZXJjZW50Ig0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHByb3BUeXBlcyA9IHsNCiAgICAgICAgICAgICAgICAiYnl0ZSI6IHsNCiAgICAgICAgICAgICAgICAgICAgZmxvb3I6IHRydWUsDQogICAgICAgICAgICAgICAgICAgIG1heDogMjU1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAicGVyY2VudCI6IHsNCiAgICAgICAgICAgICAgICAgICAgbWF4OiAxDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAiZGVncmVlcyI6IHsNCiAgICAgICAgICAgICAgICAgICAgbW9kOiAzNjAsDQogICAgICAgICAgICAgICAgICAgIGZsb29yOiB0cnVlDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHN1cHBvcnQgPSBjb2xvci5zdXBwb3J0ID0ge30sDQoNCiAgICAgICAgICAgIC8vIEVsZW1lbnQgZm9yIHN1cHBvcnQgdGVzdHMNCiAgICAgICAgICAgIHN1cHBvcnRFbGVtID0galF1ZXJ5KCAiPHA+IiApWyAwIF0sDQoNCiAgICAgICAgICAgIC8vIENvbG9ycyA9IGpRdWVyeS5Db2xvci5uYW1lcw0KICAgICAgICAgICAgY29sb3JzLA0KDQogICAgICAgICAgICAvLyBMb2NhbCBhbGlhc2VzIG9mIGZ1bmN0aW9ucyBjYWxsZWQgb2Z0ZW4NCiAgICAgICAgICAgIGVhY2ggPSBqUXVlcnkuZWFjaDsNCg0KLy8gRGV0ZXJtaW5lIHJnYmEgc3VwcG9ydCBpbW1lZGlhdGVseQ0KICAgICAgICBzdXBwb3J0RWxlbS5zdHlsZS5jc3NUZXh0ID0gImJhY2tncm91bmQtY29sb3I6cmdiYSgxLDEsMSwuNSkiOw0KICAgICAgICBzdXBwb3J0LnJnYmEgPSBzdXBwb3J0RWxlbS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IuaW5kZXhPZiggInJnYmEiICkgPiAtMTsNCg0KLy8gRGVmaW5lIGNhY2hlIG5hbWUgYW5kIGFscGhhIHByb3BlcnRpZXMNCi8vIGZvciByZ2JhIGFuZCBoc2xhIHNwYWNlcw0KICAgICAgICBlYWNoKCBzcGFjZXMsIGZ1bmN0aW9uKCBzcGFjZU5hbWUsIHNwYWNlICkgew0KICAgICAgICAgICAgc3BhY2UuY2FjaGUgPSAiXyIgKyBzcGFjZU5hbWU7DQogICAgICAgICAgICBzcGFjZS5wcm9wcy5hbHBoYSA9IHsNCiAgICAgICAgICAgICAgICBpZHg6IDMsDQogICAgICAgICAgICAgICAgdHlwZTogInBlcmNlbnQiLA0KICAgICAgICAgICAgICAgIGRlZjogMQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgfSApOw0KDQogICAgICAgIGZ1bmN0aW9uIGNsYW1wKCB2YWx1ZSwgcHJvcCwgYWxsb3dFbXB0eSApIHsNCiAgICAgICAgICAgIHZhciB0eXBlID0gcHJvcFR5cGVzWyBwcm9wLnR5cGUgXSB8fCB7fTsNCg0KICAgICAgICAgICAgaWYgKCB2YWx1ZSA9PSBudWxsICkgew0KICAgICAgICAgICAgICAgIHJldHVybiAoIGFsbG93RW1wdHkgfHwgIXByb3AuZGVmICkgPyBudWxsIDogcHJvcC5kZWY7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIH5+IGlzIGFuIHNob3J0IHdheSBvZiBkb2luZyBmbG9vciBmb3IgcG9zaXRpdmUgbnVtYmVycw0KICAgICAgICAgICAgdmFsdWUgPSB0eXBlLmZsb29yID8gfn52YWx1ZSA6IHBhcnNlRmxvYXQoIHZhbHVlICk7DQoNCiAgICAgICAgICAgIC8vIElFIHdpbGwgcGFzcyBpbiBlbXB0eSBzdHJpbmdzIGFzIHZhbHVlIGZvciBhbHBoYSwNCiAgICAgICAgICAgIC8vIHdoaWNoIHdpbGwgaGl0IHRoaXMgY2FzZQ0KICAgICAgICAgICAgaWYgKCBpc05hTiggdmFsdWUgKSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gcHJvcC5kZWY7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdHlwZS5tb2QgKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBXZSBhZGQgbW9kIGJlZm9yZSBtb2RkaW5nIHRvIG1ha2Ugc3VyZSB0aGF0IG5lZ2F0aXZlcyB2YWx1ZXMNCiAgICAgICAgICAgICAgICAvLyBnZXQgY29udmVydGVkIHByb3Blcmx5OiAtMTAgLT4gMzUwDQogICAgICAgICAgICAgICAgcmV0dXJuICggdmFsdWUgKyB0eXBlLm1vZCApICUgdHlwZS5tb2Q7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIEZvciBub3cgYWxsIHByb3BlcnR5IHR5cGVzIHdpdGhvdXQgbW9kIGhhdmUgbWluIGFuZCBtYXgNCiAgICAgICAgICAgIHJldHVybiAwID4gdmFsdWUgPyAwIDogdHlwZS5tYXggPCB2YWx1ZSA/IHR5cGUubWF4IDogdmFsdWU7DQogICAgICAgIH0NCg0KICAgICAgICBmdW5jdGlvbiBzdHJpbmdQYXJzZSggc3RyaW5nICkgew0KICAgICAgICAgICAgdmFyIGluc3QgPSBjb2xvcigpLA0KICAgICAgICAgICAgICAgIHJnYmEgPSBpbnN0Ll9yZ2JhID0gW107DQoNCiAgICAgICAgICAgIHN0cmluZyA9IHN0cmluZy50b0xvd2VyQ2FzZSgpOw0KDQogICAgICAgICAgICBlYWNoKCBzdHJpbmdQYXJzZXJzLCBmdW5jdGlvbiggaSwgcGFyc2VyICkgew0KICAgICAgICAgICAgICAgIHZhciBwYXJzZWQsDQogICAgICAgICAgICAgICAgICAgIG1hdGNoID0gcGFyc2VyLnJlLmV4ZWMoIHN0cmluZyApLA0KICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSBtYXRjaCAmJiBwYXJzZXIucGFyc2UoIG1hdGNoICksDQogICAgICAgICAgICAgICAgICAgIHNwYWNlTmFtZSA9IHBhcnNlci5zcGFjZSB8fCAicmdiYSI7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHZhbHVlcyApIHsNCiAgICAgICAgICAgICAgICAgICAgcGFyc2VkID0gaW5zdFsgc3BhY2VOYW1lIF0oIHZhbHVlcyApOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgd2FzIGFuIHJnYmEgcGFyc2UgdGhlIGFzc2lnbm1lbnQgbWlnaHQgaGFwcGVuIHR3aWNlDQogICAgICAgICAgICAgICAgICAgIC8vIG9oIHdlbGwuLi4uDQogICAgICAgICAgICAgICAgICAgIGluc3RbIHNwYWNlc1sgc3BhY2VOYW1lIF0uY2FjaGUgXSA9IHBhcnNlZFsgc3BhY2VzWyBzcGFjZU5hbWUgXS5jYWNoZSBdOw0KICAgICAgICAgICAgICAgICAgICByZ2JhID0gaW5zdC5fcmdiYSA9IHBhcnNlZC5fcmdiYTsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBFeGl0IGVhY2goIHN0cmluZ1BhcnNlcnMgKSBoZXJlIGJlY2F1c2Ugd2UgbWF0Y2hlZA0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAvLyBGb3VuZCBhIHN0cmluZ1BhcnNlciB0aGF0IGhhbmRsZWQgaXQNCiAgICAgICAgICAgIGlmICggcmdiYS5sZW5ndGggKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIGNhbWUgZnJvbSBhIHBhcnNlZCBzdHJpbmcsIGZvcmNlICJ0cmFuc3BhcmVudCIgd2hlbiBhbHBoYSBpcyAwDQogICAgICAgICAgICAgICAgLy8gY2hyb21lLCAoYW5kIG1heWJlIG90aGVycykgcmV0dXJuICJ0cmFuc3BhcmVudCIgYXMgcmdiYSgwLDAsMCwwKQ0KICAgICAgICAgICAgICAgIGlmICggcmdiYS5qb2luKCkgPT09ICIwLDAsMCwwIiApIHsNCiAgICAgICAgICAgICAgICAgICAgalF1ZXJ5LmV4dGVuZCggcmdiYSwgY29sb3JzLnRyYW5zcGFyZW50ICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiBpbnN0Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBOYW1lZCBjb2xvcnMNCiAgICAgICAgICAgIHJldHVybiBjb2xvcnNbIHN0cmluZyBdOw0KICAgICAgICB9DQoNCiAgICAgICAgY29sb3IuZm4gPSBqUXVlcnkuZXh0ZW5kKCBjb2xvci5wcm90b3R5cGUsIHsNCiAgICAgICAgICAgIHBhcnNlOiBmdW5jdGlvbiggcmVkLCBncmVlbiwgYmx1ZSwgYWxwaGEgKSB7DQogICAgICAgICAgICAgICAgaWYgKCByZWQgPT09IHVuZGVmaW5lZCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmdiYSA9IFsgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCBdOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCByZWQuanF1ZXJ5IHx8IHJlZC5ub2RlVHlwZSApIHsNCiAgICAgICAgICAgICAgICAgICAgcmVkID0galF1ZXJ5KCByZWQgKS5jc3MoIGdyZWVuICk7DQogICAgICAgICAgICAgICAgICAgIGdyZWVuID0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHZhciBpbnN0ID0gdGhpcywNCiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IGpRdWVyeS50eXBlKCByZWQgKSwNCiAgICAgICAgICAgICAgICAgICAgcmdiYSA9IHRoaXMuX3JnYmEgPSBbXTsNCg0KICAgICAgICAgICAgICAgIC8vIE1vcmUgdGhhbiAxIGFyZ3VtZW50IHNwZWNpZmllZCAtIGFzc3VtZSAoIHJlZCwgZ3JlZW4sIGJsdWUsIGFscGhhICkNCiAgICAgICAgICAgICAgICBpZiAoIGdyZWVuICE9PSB1bmRlZmluZWQgKSB7DQogICAgICAgICAgICAgICAgICAgIHJlZCA9IFsgcmVkLCBncmVlbiwgYmx1ZSwgYWxwaGEgXTsNCiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICJhcnJheSI7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCB0eXBlID09PSAic3RyaW5nIiApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2UoIHN0cmluZ1BhcnNlKCByZWQgKSB8fCBjb2xvcnMuX2RlZmF1bHQgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoIHR5cGUgPT09ICJhcnJheSIgKSB7DQogICAgICAgICAgICAgICAgICAgIGVhY2goIHNwYWNlcy5yZ2JhLnByb3BzLCBmdW5jdGlvbigga2V5LCBwcm9wICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmdiYVsgcHJvcC5pZHggXSA9IGNsYW1wKCByZWRbIHByb3AuaWR4IF0sIHByb3AgKTsNCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoIHR5cGUgPT09ICJvYmplY3QiICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIHJlZCBpbnN0YW5jZW9mIGNvbG9yICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZWFjaCggc3BhY2VzLCBmdW5jdGlvbiggc3BhY2VOYW1lLCBzcGFjZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHJlZFsgc3BhY2UuY2FjaGUgXSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdFsgc3BhY2UuY2FjaGUgXSA9IHJlZFsgc3BhY2UuY2FjaGUgXS5zbGljZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVhY2goIHNwYWNlcywgZnVuY3Rpb24oIHNwYWNlTmFtZSwgc3BhY2UgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlID0gc3BhY2UuY2FjaGU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWFjaCggc3BhY2UucHJvcHMsIGZ1bmN0aW9uKCBrZXksIHByb3AgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIGNhY2hlIGRvZXNuJ3QgZXhpc3QsIGFuZCB3ZSBrbm93IGhvdyB0byBjb252ZXJ0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggIWluc3RbIGNhY2hlIF0gJiYgc3BhY2UudG8gKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSB2YWx1ZSB3YXMgbnVsbCwgd2UgZG9uJ3QgbmVlZCB0byBjb3B5IGl0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUga2V5IHdhcyBhbHBoYSwgd2UgZG9uJ3QgbmVlZCB0byBjb3B5IGl0IGVpdGhlcg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJhbHBoYSIgfHwgcmVkWyBrZXkgXSA9PSBudWxsICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RbIGNhY2hlIF0gPSBzcGFjZS50byggaW5zdC5fcmdiYSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgb25seSBjYXNlIHdoZXJlIHdlIGFsbG93IG51bGxzIGZvciBBTEwgcHJvcGVydGllcy4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2FsbCBjbGFtcCB3aXRoIGFsd2F5c0FsbG93RW1wdHkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdFsgY2FjaGUgXVsgcHJvcC5pZHggXSA9IGNsYW1wKCByZWRbIGtleSBdLCBwcm9wLCB0cnVlICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXZlcnl0aGluZyBkZWZpbmVkIGJ1dCBhbHBoYT8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGluc3RbIGNhY2hlIF0gJiYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgalF1ZXJ5LmluQXJyYXkoIG51bGwsIGluc3RbIGNhY2hlIF0uc2xpY2UoIDAsIDMgKSApIDwgMCApIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdGhlIGRlZmF1bHQgb2YgMQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0WyBjYWNoZSBdWyAzIF0gPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHNwYWNlLmZyb20gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0Ll9yZ2JhID0gc3BhY2UuZnJvbSggaW5zdFsgY2FjaGUgXSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBpczogZnVuY3Rpb24oIGNvbXBhcmUgKSB7DQogICAgICAgICAgICAgICAgdmFyIGlzID0gY29sb3IoIGNvbXBhcmUgKSwNCiAgICAgICAgICAgICAgICAgICAgc2FtZSA9IHRydWUsDQogICAgICAgICAgICAgICAgICAgIGluc3QgPSB0aGlzOw0KDQogICAgICAgICAgICAgICAgZWFjaCggc3BhY2VzLCBmdW5jdGlvbiggXywgc3BhY2UgKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbENhY2hlLA0KICAgICAgICAgICAgICAgICAgICAgICAgaXNDYWNoZSA9IGlzWyBzcGFjZS5jYWNoZSBdOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIGlzQ2FjaGUgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbENhY2hlID0gaW5zdFsgc3BhY2UuY2FjaGUgXSB8fCBzcGFjZS50byAmJiBzcGFjZS50byggaW5zdC5fcmdiYSApIHx8IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWFjaCggc3BhY2UucHJvcHMsIGZ1bmN0aW9uKCBfLCBwcm9wICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggaXNDYWNoZVsgcHJvcC5pZHggXSAhPSBudWxsICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW1lID0gKCBpc0NhY2hlWyBwcm9wLmlkeCBdID09PSBsb2NhbENhY2hlWyBwcm9wLmlkeCBdICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzYW1lOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2FtZTsNCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHNhbWU7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgX3NwYWNlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB2YXIgdXNlZCA9IFtdLA0KICAgICAgICAgICAgICAgICAgICBpbnN0ID0gdGhpczsNCiAgICAgICAgICAgICAgICBlYWNoKCBzcGFjZXMsIGZ1bmN0aW9uKCBzcGFjZU5hbWUsIHNwYWNlICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIGluc3RbIHNwYWNlLmNhY2hlIF0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB1c2VkLnB1c2goIHNwYWNlTmFtZSApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIHJldHVybiB1c2VkLnBvcCgpOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHRyYW5zaXRpb246IGZ1bmN0aW9uKCBvdGhlciwgZGlzdGFuY2UgKSB7DQogICAgICAgICAgICAgICAgdmFyIGVuZCA9IGNvbG9yKCBvdGhlciApLA0KICAgICAgICAgICAgICAgICAgICBzcGFjZU5hbWUgPSBlbmQuX3NwYWNlKCksDQogICAgICAgICAgICAgICAgICAgIHNwYWNlID0gc3BhY2VzWyBzcGFjZU5hbWUgXSwNCiAgICAgICAgICAgICAgICAgICAgc3RhcnRDb2xvciA9IHRoaXMuYWxwaGEoKSA9PT0gMCA/IGNvbG9yKCAidHJhbnNwYXJlbnQiICkgOiB0aGlzLA0KICAgICAgICAgICAgICAgICAgICBzdGFydCA9IHN0YXJ0Q29sb3JbIHNwYWNlLmNhY2hlIF0gfHwgc3BhY2UudG8oIHN0YXJ0Q29sb3IuX3JnYmEgKSwNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gc3RhcnQuc2xpY2UoKTsNCg0KICAgICAgICAgICAgICAgIGVuZCA9IGVuZFsgc3BhY2UuY2FjaGUgXTsNCiAgICAgICAgICAgICAgICBlYWNoKCBzcGFjZS5wcm9wcywgZnVuY3Rpb24oIGtleSwgcHJvcCApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gcHJvcC5pZHgsDQogICAgICAgICAgICAgICAgICAgICAgICBzdGFydFZhbHVlID0gc3RhcnRbIGluZGV4IF0sDQogICAgICAgICAgICAgICAgICAgICAgICBlbmRWYWx1ZSA9IGVuZFsgaW5kZXggXSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSBwcm9wVHlwZXNbIHByb3AudHlwZSBdIHx8IHt9Ow0KDQogICAgICAgICAgICAgICAgICAgIC8vIElmIG51bGwsIGRvbid0IG92ZXJyaWRlIHN0YXJ0IHZhbHVlDQogICAgICAgICAgICAgICAgICAgIGlmICggZW5kVmFsdWUgPT09IG51bGwgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBJZiBudWxsIC0gdXNlIGVuZA0KICAgICAgICAgICAgICAgICAgICBpZiAoIHN0YXJ0VmFsdWUgPT09IG51bGwgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbIGluZGV4IF0gPSBlbmRWYWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggdHlwZS5tb2QgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBlbmRWYWx1ZSAtIHN0YXJ0VmFsdWUgPiB0eXBlLm1vZCAvIDIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0VmFsdWUgKz0gdHlwZS5tb2Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggc3RhcnRWYWx1ZSAtIGVuZFZhbHVlID4gdHlwZS5tb2QgLyAyICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydFZhbHVlIC09IHR5cGUubW9kOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFsgaW5kZXggXSA9IGNsYW1wKCAoIGVuZFZhbHVlIC0gc3RhcnRWYWx1ZSApICogZGlzdGFuY2UgKyBzdGFydFZhbHVlLCBwcm9wICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbIHNwYWNlTmFtZSBdKCByZXN1bHQgKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBibGVuZDogZnVuY3Rpb24oIG9wYXF1ZSApIHsNCg0KICAgICAgICAgICAgICAgIC8vIElmIHdlIGFyZSBhbHJlYWR5IG9wYXF1ZSAtIHJldHVybiBvdXJzZWxmDQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLl9yZ2JhWyAzIF0gPT09IDEgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHZhciByZ2IgPSB0aGlzLl9yZ2JhLnNsaWNlKCksDQogICAgICAgICAgICAgICAgICAgIGEgPSByZ2IucG9wKCksDQogICAgICAgICAgICAgICAgICAgIGJsZW5kID0gY29sb3IoIG9wYXF1ZSApLl9yZ2JhOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuIGNvbG9yKCBqUXVlcnkubWFwKCByZ2IsIGZ1bmN0aW9uKCB2LCBpICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCAxIC0gYSApICogYmxlbmRbIGkgXSArIGEgKiB2Ow0KICAgICAgICAgICAgICAgIH0gKSApOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHRvUmdiYVN0cmluZzogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIHByZWZpeCA9ICJyZ2JhKCIsDQogICAgICAgICAgICAgICAgICAgIHJnYmEgPSBqUXVlcnkubWFwKCB0aGlzLl9yZ2JhLCBmdW5jdGlvbiggdiwgaSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2ID09IG51bGwgPyAoIGkgPiAyID8gMSA6IDAgKSA6IHY7DQogICAgICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgICAgIGlmICggcmdiYVsgMyBdID09PSAxICkgew0KICAgICAgICAgICAgICAgICAgICByZ2JhLnBvcCgpOw0KICAgICAgICAgICAgICAgICAgICBwcmVmaXggPSAicmdiKCI7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHByZWZpeCArIHJnYmEuam9pbigpICsgIikiOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHRvSHNsYVN0cmluZzogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIHByZWZpeCA9ICJoc2xhKCIsDQogICAgICAgICAgICAgICAgICAgIGhzbGEgPSBqUXVlcnkubWFwKCB0aGlzLmhzbGEoKSwgZnVuY3Rpb24oIHYsIGkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHYgPT0gbnVsbCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ID0gaSA+IDIgPyAxIDogMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2F0Y2ggMSBhbmQgMg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBpICYmIGkgPCAzICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYgPSBNYXRoLnJvdW5kKCB2ICogMTAwICkgKyAiJSI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdjsNCiAgICAgICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgaWYgKCBoc2xhWyAzIF0gPT09IDEgKSB7DQogICAgICAgICAgICAgICAgICAgIGhzbGEucG9wKCk7DQogICAgICAgICAgICAgICAgICAgIHByZWZpeCA9ICJoc2woIjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIHByZWZpeCArIGhzbGEuam9pbigpICsgIikiOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHRvSGV4U3RyaW5nOiBmdW5jdGlvbiggaW5jbHVkZUFscGhhICkgew0KICAgICAgICAgICAgICAgIHZhciByZ2JhID0gdGhpcy5fcmdiYS5zbGljZSgpLA0KICAgICAgICAgICAgICAgICAgICBhbHBoYSA9IHJnYmEucG9wKCk7DQoNCiAgICAgICAgICAgICAgICBpZiAoIGluY2x1ZGVBbHBoYSApIHsNCiAgICAgICAgICAgICAgICAgICAgcmdiYS5wdXNoKCB+figgYWxwaGEgKiAyNTUgKSApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiAiIyIgKyBqUXVlcnkubWFwKCByZ2JhLCBmdW5jdGlvbiggdiApIHsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBEZWZhdWx0IHRvIDAgd2hlbiBudWxscyBleGlzdA0KICAgICAgICAgICAgICAgICAgICB2ID0gKCB2IHx8IDAgKS50b1N0cmluZyggMTYgKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHYubGVuZ3RoID09PSAxID8gIjAiICsgdiA6IHY7DQogICAgICAgICAgICAgICAgfSApLmpvaW4oICIiICk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZ2JhWyAzIF0gPT09IDAgPyAidHJhbnNwYXJlbnQiIDogdGhpcy50b1JnYmFTdHJpbmcoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSApOw0KICAgICAgICBjb2xvci5mbi5wYXJzZS5wcm90b3R5cGUgPSBjb2xvci5mbjsNCg0KLy8gSHNsYSBjb252ZXJzaW9ucyBhZGFwdGVkIGZyb206DQovLyBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL21hYXNoYWFjay9zb3VyY2UvYnJvd3NlL3BhY2thZ2VzL2dyYXBoaWNzL3RydW5rL3NyYy9ncmFwaGljcy9jb2xvcnMvSFVFMlJHQi5hcz9yPTUwMjENCg0KICAgICAgICBmdW5jdGlvbiBodWUycmdiKCBwLCBxLCBoICkgew0KICAgICAgICAgICAgaCA9ICggaCArIDEgKSAlIDE7DQogICAgICAgICAgICBpZiAoIGggKiA2IDwgMSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gcCArICggcSAtIHAgKSAqIGggKiA2Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCBoICogMiA8IDEgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHE7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIGggKiAzIDwgMiApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gcCArICggcSAtIHAgKSAqICggKCAyIC8gMyApIC0gaCApICogNjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBwOw0KICAgICAgICB9DQoNCiAgICAgICAgc3BhY2VzLmhzbGEudG8gPSBmdW5jdGlvbiggcmdiYSApIHsNCiAgICAgICAgICAgIGlmICggcmdiYVsgMCBdID09IG51bGwgfHwgcmdiYVsgMSBdID09IG51bGwgfHwgcmdiYVsgMiBdID09IG51bGwgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIFsgbnVsbCwgbnVsbCwgbnVsbCwgcmdiYVsgMyBdIF07DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgciA9IHJnYmFbIDAgXSAvIDI1NSwNCiAgICAgICAgICAgICAgICBnID0gcmdiYVsgMSBdIC8gMjU1LA0KICAgICAgICAgICAgICAgIGIgPSByZ2JhWyAyIF0gLyAyNTUsDQogICAgICAgICAgICAgICAgYSA9IHJnYmFbIDMgXSwNCiAgICAgICAgICAgICAgICBtYXggPSBNYXRoLm1heCggciwgZywgYiApLA0KICAgICAgICAgICAgICAgIG1pbiA9IE1hdGgubWluKCByLCBnLCBiICksDQogICAgICAgICAgICAgICAgZGlmZiA9IG1heCAtIG1pbiwNCiAgICAgICAgICAgICAgICBhZGQgPSBtYXggKyBtaW4sDQogICAgICAgICAgICAgICAgbCA9IGFkZCAqIDAuNSwNCiAgICAgICAgICAgICAgICBoLCBzOw0KDQogICAgICAgICAgICBpZiAoIG1pbiA9PT0gbWF4ICkgew0KICAgICAgICAgICAgICAgIGggPSAwOw0KICAgICAgICAgICAgfSBlbHNlIGlmICggciA9PT0gbWF4ICkgew0KICAgICAgICAgICAgICAgIGggPSAoIDYwICogKCBnIC0gYiApIC8gZGlmZiApICsgMzYwOw0KICAgICAgICAgICAgfSBlbHNlIGlmICggZyA9PT0gbWF4ICkgew0KICAgICAgICAgICAgICAgIGggPSAoIDYwICogKCBiIC0gciApIC8gZGlmZiApICsgMTIwOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBoID0gKCA2MCAqICggciAtIGcgKSAvIGRpZmYgKSArIDI0MDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gQ2hyb21hIChkaWZmKSA9PSAwIG1lYW5zIGdyZXlzY2FsZSB3aGljaCwgYnkgZGVmaW5pdGlvbiwgc2F0dXJhdGlvbiA9IDAlDQogICAgICAgICAgICAvLyBvdGhlcndpc2UsIHNhdHVyYXRpb24gaXMgYmFzZWQgb24gdGhlIHJhdGlvIG9mIGNocm9tYSAoZGlmZikgdG8gbGlnaHRuZXNzIChhZGQpDQogICAgICAgICAgICBpZiAoIGRpZmYgPT09IDAgKSB7DQogICAgICAgICAgICAgICAgcyA9IDA7DQogICAgICAgICAgICB9IGVsc2UgaWYgKCBsIDw9IDAuNSApIHsNCiAgICAgICAgICAgICAgICBzID0gZGlmZiAvIGFkZDsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcyA9IGRpZmYgLyAoIDIgLSBhZGQgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBbIE1hdGgucm91bmQoIGggKSAlIDM2MCwgcywgbCwgYSA9PSBudWxsID8gMSA6IGEgXTsNCiAgICAgICAgfTsNCg0KICAgICAgICBzcGFjZXMuaHNsYS5mcm9tID0gZnVuY3Rpb24oIGhzbGEgKSB7DQogICAgICAgICAgICBpZiAoIGhzbGFbIDAgXSA9PSBudWxsIHx8IGhzbGFbIDEgXSA9PSBudWxsIHx8IGhzbGFbIDIgXSA9PSBudWxsICkgew0KICAgICAgICAgICAgICAgIHJldHVybiBbIG51bGwsIG51bGwsIG51bGwsIGhzbGFbIDMgXSBdOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIGggPSBoc2xhWyAwIF0gLyAzNjAsDQogICAgICAgICAgICAgICAgcyA9IGhzbGFbIDEgXSwNCiAgICAgICAgICAgICAgICBsID0gaHNsYVsgMiBdLA0KICAgICAgICAgICAgICAgIGEgPSBoc2xhWyAzIF0sDQogICAgICAgICAgICAgICAgcSA9IGwgPD0gMC41ID8gbCAqICggMSArIHMgKSA6IGwgKyBzIC0gbCAqIHMsDQogICAgICAgICAgICAgICAgcCA9IDIgKiBsIC0gcTsNCg0KICAgICAgICAgICAgcmV0dXJuIFsNCiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKCBodWUycmdiKCBwLCBxLCBoICsgKCAxIC8gMyApICkgKiAyNTUgKSwNCiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKCBodWUycmdiKCBwLCBxLCBoICkgKiAyNTUgKSwNCiAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKCBodWUycmdiKCBwLCBxLCBoIC0gKCAxIC8gMyApICkgKiAyNTUgKSwNCiAgICAgICAgICAgICAgICBhDQogICAgICAgICAgICBdOw0KICAgICAgICB9Ow0KDQogICAgICAgIGVhY2goIHNwYWNlcywgZnVuY3Rpb24oIHNwYWNlTmFtZSwgc3BhY2UgKSB7DQogICAgICAgICAgICB2YXIgcHJvcHMgPSBzcGFjZS5wcm9wcywNCiAgICAgICAgICAgICAgICBjYWNoZSA9IHNwYWNlLmNhY2hlLA0KICAgICAgICAgICAgICAgIHRvID0gc3BhY2UudG8sDQogICAgICAgICAgICAgICAgZnJvbSA9IHNwYWNlLmZyb207DQoNCiAgICAgICAgICAgIC8vIE1ha2VzIHJnYmEoKSBhbmQgaHNsYSgpDQogICAgICAgICAgICBjb2xvci5mblsgc3BhY2VOYW1lIF0gPSBmdW5jdGlvbiggdmFsdWUgKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBHZW5lcmF0ZSBhIGNhY2hlIGZvciB0aGlzIHNwYWNlIGlmIGl0IGRvZXNuJ3QgZXhpc3QNCiAgICAgICAgICAgICAgICBpZiAoIHRvICYmICF0aGlzWyBjYWNoZSBdICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzWyBjYWNoZSBdID0gdG8oIHRoaXMuX3JnYmEgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCB2YWx1ZSA9PT0gdW5kZWZpbmVkICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1sgY2FjaGUgXS5zbGljZSgpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHZhciByZXQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUgPSBqUXVlcnkudHlwZSggdmFsdWUgKSwNCiAgICAgICAgICAgICAgICAgICAgYXJyID0gKCB0eXBlID09PSAiYXJyYXkiIHx8IHR5cGUgPT09ICJvYmplY3QiICkgPyB2YWx1ZSA6IGFyZ3VtZW50cywNCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgPSB0aGlzWyBjYWNoZSBdLnNsaWNlKCk7DQoNCiAgICAgICAgICAgICAgICBlYWNoKCBwcm9wcywgZnVuY3Rpb24oIGtleSwgcHJvcCApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbCA9IGFyclsgdHlwZSA9PT0gIm9iamVjdCIgPyBrZXkgOiBwcm9wLmlkeCBdOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIHZhbCA9PSBudWxsICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFsID0gbG9jYWxbIHByb3AuaWR4IF07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgbG9jYWxbIHByb3AuaWR4IF0gPSBjbGFtcCggdmFsLCBwcm9wICk7DQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgaWYgKCBmcm9tICkgew0KICAgICAgICAgICAgICAgICAgICByZXQgPSBjb2xvciggZnJvbSggbG9jYWwgKSApOw0KICAgICAgICAgICAgICAgICAgICByZXRbIGNhY2hlIF0gPSBsb2NhbDsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sb3IoIGxvY2FsICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgLy8gTWFrZXMgcmVkKCkgZ3JlZW4oKSBibHVlKCkgYWxwaGEoKSBodWUoKSBzYXR1cmF0aW9uKCkgbGlnaHRuZXNzKCkNCiAgICAgICAgICAgIGVhY2goIHByb3BzLCBmdW5jdGlvbigga2V5LCBwcm9wICkgew0KDQogICAgICAgICAgICAgICAgLy8gQWxwaGEgaXMgaW5jbHVkZWQgaW4gbW9yZSB0aGFuIG9uZSBzcGFjZQ0KICAgICAgICAgICAgICAgIGlmICggY29sb3IuZm5bIGtleSBdICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGNvbG9yLmZuWyBrZXkgXSA9IGZ1bmN0aW9uKCB2YWx1ZSApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHZ0eXBlID0galF1ZXJ5LnR5cGUoIHZhbHVlICksDQogICAgICAgICAgICAgICAgICAgICAgICBmbiA9ICgga2V5ID09PSAiYWxwaGEiID8gKCB0aGlzLl9oc2xhID8gImhzbGEiIDogInJnYmEiICkgOiBzcGFjZU5hbWUgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsID0gdGhpc1sgZm4gXSgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgY3VyID0gbG9jYWxbIHByb3AuaWR4IF0sDQogICAgICAgICAgICAgICAgICAgICAgICBtYXRjaDsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoIHZ0eXBlID09PSAidW5kZWZpbmVkIiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdXI7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZiAoIHZ0eXBlID09PSAiZnVuY3Rpb24iICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5jYWxsKCB0aGlzLCBjdXIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZ0eXBlID0galF1ZXJ5LnR5cGUoIHZhbHVlICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCB2YWx1ZSA9PSBudWxsICYmIHByb3AuZW1wdHkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIHZ0eXBlID09PSAic3RyaW5nIiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoID0gcnBsdXNlcXVhbHMuZXhlYyggdmFsdWUgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggbWF0Y2ggKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBjdXIgKyBwYXJzZUZsb2F0KCBtYXRjaFsgMiBdICkgKiAoIG1hdGNoWyAxIF0gPT09ICIrIiA/IDEgOiAtMSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGxvY2FsWyBwcm9wLmlkeCBdID0gdmFsdWU7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzWyBmbiBdKCBsb2NhbCApOw0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0gKTsNCg0KLy8gQWRkIGNzc0hvb2sgYW5kIC5meC5zdGVwIGZ1bmN0aW9uIGZvciBlYWNoIG5hbWVkIGhvb2suDQovLyBhY2NlcHQgYSBzcGFjZSBzZXBhcmF0ZWQgc3RyaW5nIG9mIHByb3BlcnRpZXMNCiAgICAgICAgY29sb3IuaG9vayA9IGZ1bmN0aW9uKCBob29rICkgew0KICAgICAgICAgICAgdmFyIGhvb2tzID0gaG9vay5zcGxpdCggIiAiICk7DQogICAgICAgICAgICBlYWNoKCBob29rcywgZnVuY3Rpb24oIGksIGhvb2sgKSB7DQogICAgICAgICAgICAgICAgalF1ZXJ5LmNzc0hvb2tzWyBob29rIF0gPSB7DQogICAgICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnNlZCwgY3VyRWxlbSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3IgPSAiIjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB2YWx1ZSAhPT0gInRyYW5zcGFyZW50IiAmJiAoIGpRdWVyeS50eXBlKCB2YWx1ZSApICE9PSAic3RyaW5nIiB8fA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICggcGFyc2VkID0gc3RyaW5nUGFyc2UoIHZhbHVlICkgKSApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gY29sb3IoIHBhcnNlZCB8fCB2YWx1ZSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggIXN1cHBvcnQucmdiYSAmJiB2YWx1ZS5fcmdiYVsgMyBdICE9PSAxICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJFbGVtID0gaG9vayA9PT0gImJhY2tncm91bmRDb2xvciIgPyBlbGVtLnBhcmVudE5vZGUgOiBlbGVtOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIGJhY2tncm91bmRDb2xvciA9PT0gIiIgfHwgYmFja2dyb3VuZENvbG9yID09PSAidHJhbnNwYXJlbnQiICkgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1ckVsZW0gJiYgY3VyRWxlbS5zdHlsZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvciA9IGpRdWVyeS5jc3MoIGN1ckVsZW0sICJiYWNrZ3JvdW5kQ29sb3IiICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VyRWxlbSA9IGN1ckVsZW0ucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKCBlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5ibGVuZCggYmFja2dyb3VuZENvbG9yICYmIGJhY2tncm91bmRDb2xvciAhPT0gInRyYW5zcGFyZW50IiA/DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3IgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl9kZWZhdWx0IiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUudG9SZ2JhU3RyaW5nKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW0uc3R5bGVbIGhvb2sgXSA9IHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoIGUgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBXcmFwcGVkIHRvIHByZXZlbnQgSUUgZnJvbSB0aHJvd2luZyBlcnJvcnMgb24gImludmFsaWQiIHZhbHVlcyBsaWtlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gJ2F1dG8nIG9yICdpbmhlcml0Jw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBqUXVlcnkuZnguc3RlcFsgaG9vayBdID0gZnVuY3Rpb24oIGZ4ICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoICFmeC5jb2xvckluaXQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmeC5zdGFydCA9IGNvbG9yKCBmeC5lbGVtLCBob29rICk7DQogICAgICAgICAgICAgICAgICAgICAgICBmeC5lbmQgPSBjb2xvciggZnguZW5kICk7DQogICAgICAgICAgICAgICAgICAgICAgICBmeC5jb2xvckluaXQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGpRdWVyeS5jc3NIb29rc1sgaG9vayBdLnNldCggZnguZWxlbSwgZnguc3RhcnQudHJhbnNpdGlvbiggZnguZW5kLCBmeC5wb3MgKSApOw0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgfTsNCg0KICAgICAgICBjb2xvci5ob29rKCBzdGVwSG9va3MgKTsNCg0KICAgICAgICBqUXVlcnkuY3NzSG9va3MuYm9yZGVyQ29sb3IgPSB7DQogICAgICAgICAgICBleHBhbmQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHsNCiAgICAgICAgICAgICAgICB2YXIgZXhwYW5kZWQgPSB7fTsNCg0KICAgICAgICAgICAgICAgIGVhY2goIFsgIlRvcCIsICJSaWdodCIsICJCb3R0b20iLCAiTGVmdCIgXSwgZnVuY3Rpb24oIGksIHBhcnQgKSB7DQogICAgICAgICAgICAgICAgICAgIGV4cGFuZGVkWyAiYm9yZGVyIiArIHBhcnQgKyAiQ29sb3IiIF0gPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGV4cGFuZGVkOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KDQovLyBCYXNpYyBjb2xvciBuYW1lcyBvbmx5Lg0KLy8gVXNhZ2Ugb2YgYW55IG9mIHRoZSBvdGhlciBjb2xvciBuYW1lcyByZXF1aXJlcyBhZGRpbmcgeW91cnNlbGYgb3IgaW5jbHVkaW5nDQovLyBqcXVlcnkuY29sb3Iuc3ZnLW5hbWVzLmpzLg0KICAgICAgICBjb2xvcnMgPSBqUXVlcnkuQ29sb3IubmFtZXMgPSB7DQoNCiAgICAgICAgICAgIC8vIDQuMS4gQmFzaWMgY29sb3Iga2V5d29yZHMNCiAgICAgICAgICAgIGFxdWE6ICIjMDBmZmZmIiwNCiAgICAgICAgICAgIGJsYWNrOiAiIzAwMDAwMCIsDQogICAgICAgICAgICBibHVlOiAiIzAwMDBmZiIsDQogICAgICAgICAgICBmdWNoc2lhOiAiI2ZmMDBmZiIsDQogICAgICAgICAgICBncmF5OiAiIzgwODA4MCIsDQogICAgICAgICAgICBncmVlbjogIiMwMDgwMDAiLA0KICAgICAgICAgICAgbGltZTogIiMwMGZmMDAiLA0KICAgICAgICAgICAgbWFyb29uOiAiIzgwMDAwMCIsDQogICAgICAgICAgICBuYXZ5OiAiIzAwMDA4MCIsDQogICAgICAgICAgICBvbGl2ZTogIiM4MDgwMDAiLA0KICAgICAgICAgICAgcHVycGxlOiAiIzgwMDA4MCIsDQogICAgICAgICAgICByZWQ6ICIjZmYwMDAwIiwNCiAgICAgICAgICAgIHNpbHZlcjogIiNjMGMwYzAiLA0KICAgICAgICAgICAgdGVhbDogIiMwMDgwODAiLA0KICAgICAgICAgICAgd2hpdGU6ICIjZmZmZmZmIiwNCiAgICAgICAgICAgIHllbGxvdzogIiNmZmZmMDAiLA0KDQogICAgICAgICAgICAvLyA0LjIuMy4gInRyYW5zcGFyZW50IiBjb2xvciBrZXl3b3JkDQogICAgICAgICAgICB0cmFuc3BhcmVudDogWyBudWxsLCBudWxsLCBudWxsLCAwIF0sDQoNCiAgICAgICAgICAgIF9kZWZhdWx0OiAiI2ZmZmZmZiINCiAgICAgICAgfTsNCg0KICAgIH0gKSggalF1ZXJ5ICk7DQoNCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogQ0xBU1MgQU5JTUFUSU9OUyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovDQogICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAoIGZ1bmN0aW9uKCkgew0KDQogICAgICAgIHZhciBjbGFzc0FuaW1hdGlvbkFjdGlvbnMgPSBbICJhZGQiLCAicmVtb3ZlIiwgInRvZ2dsZSIgXSwNCiAgICAgICAgICAgIHNob3J0aGFuZFN0eWxlcyA9IHsNCiAgICAgICAgICAgICAgICBib3JkZXI6IDEsDQogICAgICAgICAgICAgICAgYm9yZGVyQm90dG9tOiAxLA0KICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yOiAxLA0KICAgICAgICAgICAgICAgIGJvcmRlckxlZnQ6IDEsDQogICAgICAgICAgICAgICAgYm9yZGVyUmlnaHQ6IDEsDQogICAgICAgICAgICAgICAgYm9yZGVyVG9wOiAxLA0KICAgICAgICAgICAgICAgIGJvcmRlcldpZHRoOiAxLA0KICAgICAgICAgICAgICAgIG1hcmdpbjogMSwNCiAgICAgICAgICAgICAgICBwYWRkaW5nOiAxDQogICAgICAgICAgICB9Ow0KDQogICAgICAgICQuZWFjaCgNCiAgICAgICAgICAgIFsgImJvcmRlckxlZnRTdHlsZSIsICJib3JkZXJSaWdodFN0eWxlIiwgImJvcmRlckJvdHRvbVN0eWxlIiwgImJvcmRlclRvcFN0eWxlIiBdLA0KICAgICAgICAgICAgZnVuY3Rpb24oIF8sIHByb3AgKSB7DQogICAgICAgICAgICAgICAgJC5meC5zdGVwWyBwcm9wIF0gPSBmdW5jdGlvbiggZnggKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggZnguZW5kICE9PSAibm9uZSIgJiYgIWZ4LnNldEF0dHIgfHwgZngucG9zID09PSAxICYmICFmeC5zZXRBdHRyICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgalF1ZXJ5LnN0eWxlKCBmeC5lbGVtLCBwcm9wLCBmeC5lbmQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZ4LnNldEF0dHIgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgKTsNCg0KICAgICAgICBmdW5jdGlvbiBnZXRFbGVtZW50U3R5bGVzKCBlbGVtICkgew0KICAgICAgICAgICAgdmFyIGtleSwgbGVuLA0KICAgICAgICAgICAgICAgIHN0eWxlID0gZWxlbS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3ID8NCiAgICAgICAgICAgICAgICAgICAgZWxlbS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoIGVsZW0sIG51bGwgKSA6DQogICAgICAgICAgICAgICAgICAgIGVsZW0uY3VycmVudFN0eWxlLA0KICAgICAgICAgICAgICAgIHN0eWxlcyA9IHt9Ow0KDQogICAgICAgICAgICBpZiAoIHN0eWxlICYmIHN0eWxlLmxlbmd0aCAmJiBzdHlsZVsgMCBdICYmIHN0eWxlWyBzdHlsZVsgMCBdIF0gKSB7DQogICAgICAgICAgICAgICAgbGVuID0gc3R5bGUubGVuZ3RoOw0KICAgICAgICAgICAgICAgIHdoaWxlICggbGVuLS0gKSB7DQogICAgICAgICAgICAgICAgICAgIGtleSA9IHN0eWxlWyBsZW4gXTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0eXBlb2Ygc3R5bGVbIGtleSBdID09PSAic3RyaW5nIiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlc1sgJC5jYW1lbENhc2UoIGtleSApIF0gPSBzdHlsZVsga2V5IF07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBTdXBwb3J0OiBPcGVyYSwgSUUgPDkNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZm9yICgga2V5IGluIHN0eWxlICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIHR5cGVvZiBzdHlsZVsga2V5IF0gPT09ICJzdHJpbmciICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGVzWyBrZXkgXSA9IHN0eWxlWyBrZXkgXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHN0eWxlczsNCiAgICAgICAgfQ0KDQogICAgICAgIGZ1bmN0aW9uIHN0eWxlRGlmZmVyZW5jZSggb2xkU3R5bGUsIG5ld1N0eWxlICkgew0KICAgICAgICAgICAgdmFyIGRpZmYgPSB7fSwNCiAgICAgICAgICAgICAgICBuYW1lLCB2YWx1ZTsNCg0KICAgICAgICAgICAgZm9yICggbmFtZSBpbiBuZXdTdHlsZSApIHsNCiAgICAgICAgICAgICAgICB2YWx1ZSA9IG5ld1N0eWxlWyBuYW1lIF07DQogICAgICAgICAgICAgICAgaWYgKCBvbGRTdHlsZVsgbmFtZSBdICE9PSB2YWx1ZSApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAhc2hvcnRoYW5kU3R5bGVzWyBuYW1lIF0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoICQuZnguc3RlcFsgbmFtZSBdIHx8ICFpc05hTiggcGFyc2VGbG9hdCggdmFsdWUgKSApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZbIG5hbWUgXSA9IHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gZGlmZjsNCiAgICAgICAgfQ0KDQovLyBTdXBwb3J0OiBqUXVlcnkgPDEuOA0KICAgICAgICBpZiAoICEkLmZuLmFkZEJhY2sgKSB7DQogICAgICAgICAgICAkLmZuLmFkZEJhY2sgPSBmdW5jdGlvbiggc2VsZWN0b3IgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWRkKCBzZWxlY3RvciA9PSBudWxsID8NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2T2JqZWN0IDogdGhpcy5wcmV2T2JqZWN0LmZpbHRlciggc2VsZWN0b3IgKQ0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQoNCiAgICAgICAgJC5lZmZlY3RzLmFuaW1hdGVDbGFzcyA9IGZ1bmN0aW9uKCB2YWx1ZSwgZHVyYXRpb24sIGVhc2luZywgY2FsbGJhY2sgKSB7DQogICAgICAgICAgICB2YXIgbyA9ICQuc3BlZWQoIGR1cmF0aW9uLCBlYXNpbmcsIGNhbGxiYWNrICk7DQoNCiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXVlKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB2YXIgYW5pbWF0ZWQgPSAkKCB0aGlzICksDQogICAgICAgICAgICAgICAgICAgIGJhc2VDbGFzcyA9IGFuaW1hdGVkLmF0dHIoICJjbGFzcyIgKSB8fCAiIiwNCiAgICAgICAgICAgICAgICAgICAgYXBwbHlDbGFzc0NoYW5nZSwNCiAgICAgICAgICAgICAgICAgICAgYWxsQW5pbWF0aW9ucyA9IG8uY2hpbGRyZW4gPyBhbmltYXRlZC5maW5kKCAiKiIgKS5hZGRCYWNrKCkgOiBhbmltYXRlZDsNCg0KICAgICAgICAgICAgICAgIC8vIE1hcCB0aGUgYW5pbWF0ZWQgb2JqZWN0cyB0byBzdG9yZSB0aGUgb3JpZ2luYWwgc3R5bGVzLg0KICAgICAgICAgICAgICAgIGFsbEFuaW1hdGlvbnMgPSBhbGxBbmltYXRpb25zLm1hcCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBlbCA9ICQoIHRoaXMgKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsOiBlbCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBnZXRFbGVtZW50U3R5bGVzKCB0aGlzICkNCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgICAgICAvLyBBcHBseSBjbGFzcyBjaGFuZ2UNCiAgICAgICAgICAgICAgICBhcHBseUNsYXNzQ2hhbmdlID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICQuZWFjaCggY2xhc3NBbmltYXRpb25BY3Rpb25zLCBmdW5jdGlvbiggaSwgYWN0aW9uICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB2YWx1ZVsgYWN0aW9uIF0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZWRbIGFjdGlvbiArICJDbGFzcyIgXSggdmFsdWVbIGFjdGlvbiBdICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIGFwcGx5Q2xhc3NDaGFuZ2UoKTsNCg0KICAgICAgICAgICAgICAgIC8vIE1hcCBhbGwgYW5pbWF0ZWQgb2JqZWN0cyBhZ2FpbiAtIGNhbGN1bGF0ZSBuZXcgc3R5bGVzIGFuZCBkaWZmDQogICAgICAgICAgICAgICAgYWxsQW5pbWF0aW9ucyA9IGFsbEFuaW1hdGlvbnMubWFwKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmQgPSBnZXRFbGVtZW50U3R5bGVzKCB0aGlzLmVsWyAwIF0gKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaWZmID0gc3R5bGVEaWZmZXJlbmNlKCB0aGlzLnN0YXJ0LCB0aGlzLmVuZCApOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsNCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgICAgICAvLyBBcHBseSBvcmlnaW5hbCBjbGFzcw0KICAgICAgICAgICAgICAgIGFuaW1hdGVkLmF0dHIoICJjbGFzcyIsIGJhc2VDbGFzcyApOw0KDQogICAgICAgICAgICAgICAgLy8gTWFwIGFsbCBhbmltYXRlZCBvYmplY3RzIGFnYWluIC0gdGhpcyB0aW1lIGNvbGxlY3RpbmcgYSBwcm9taXNlDQogICAgICAgICAgICAgICAgYWxsQW5pbWF0aW9ucyA9IGFsbEFuaW1hdGlvbnMubWFwKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHN0eWxlSW5mbyA9IHRoaXMsDQogICAgICAgICAgICAgICAgICAgICAgICBkZmQgPSAkLkRlZmVycmVkKCksDQogICAgICAgICAgICAgICAgICAgICAgICBvcHRzID0gJC5leHRlbmQoIHt9LCBvLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVldWU6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGZkLnJlc29sdmUoIHN0eWxlSW5mbyApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVsLmFuaW1hdGUoIHRoaXMuZGlmZiwgb3B0cyApOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGZkLnByb21pc2UoKTsNCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgICAgICAvLyBPbmNlIGFsbCBhbmltYXRpb25zIGhhdmUgY29tcGxldGVkOg0KICAgICAgICAgICAgICAgICQud2hlbi5hcHBseSggJCwgYWxsQW5pbWF0aW9ucy5nZXQoKSApLmRvbmUoIGZ1bmN0aW9uKCkgew0KDQogICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgZmluYWwgY2xhc3MNCiAgICAgICAgICAgICAgICAgICAgYXBwbHlDbGFzc0NoYW5nZSgpOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIEZvciBlYWNoIGFuaW1hdGVkIGVsZW1lbnQsDQogICAgICAgICAgICAgICAgICAgIC8vIGNsZWFyIGFsbCBjc3MgcHJvcGVydGllcyB0aGF0IHdlcmUgYW5pbWF0ZWQNCiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKCBhcmd1bWVudHMsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsID0gdGhpcy5lbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICQuZWFjaCggdGhpcy5kaWZmLCBmdW5jdGlvbigga2V5ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsLmNzcygga2V5LCAiIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBndWFybnRlZWQgdG8gYmUgdGhlcmUgaWYgeW91IHVzZSBqUXVlcnkuc3BlZWQoKQ0KICAgICAgICAgICAgICAgICAgICAvLyBpdCBhbHNvIGhhbmRsZXMgZGVxdWV1aW5nIHRoZSBuZXh0IGFuaW0uLi4NCiAgICAgICAgICAgICAgICAgICAgby5jb21wbGV0ZS5jYWxsKCBhbmltYXRlZFsgMCBdICk7DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9Ow0KDQogICAgICAgICQuZm4uZXh0ZW5kKCB7DQogICAgICAgICAgICBhZGRDbGFzczogKCBmdW5jdGlvbiggb3JpZyApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oIGNsYXNzTmFtZXMsIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3BlZWQgPw0KICAgICAgICAgICAgICAgICAgICAgICAgJC5lZmZlY3RzLmFuaW1hdGVDbGFzcy5jYWxsKCB0aGlzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgYWRkOiBjbGFzc05hbWVzIH0sIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkgOg0KICAgICAgICAgICAgICAgICAgICAgICAgb3JpZy5hcHBseSggdGhpcywgYXJndW1lbnRzICk7DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0gKSggJC5mbi5hZGRDbGFzcyApLA0KDQogICAgICAgICAgICByZW1vdmVDbGFzczogKCBmdW5jdGlvbiggb3JpZyApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oIGNsYXNzTmFtZXMsIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDEgPw0KICAgICAgICAgICAgICAgICAgICAgICAgJC5lZmZlY3RzLmFuaW1hdGVDbGFzcy5jYWxsKCB0aGlzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcmVtb3ZlOiBjbGFzc05hbWVzIH0sIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkgOg0KICAgICAgICAgICAgICAgICAgICAgICAgb3JpZy5hcHBseSggdGhpcywgYXJndW1lbnRzICk7DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0gKSggJC5mbi5yZW1vdmVDbGFzcyApLA0KDQogICAgICAgICAgICB0b2dnbGVDbGFzczogKCBmdW5jdGlvbiggb3JpZyApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oIGNsYXNzTmFtZXMsIGZvcmNlLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0eXBlb2YgZm9yY2UgPT09ICJib29sZWFuIiB8fCBmb3JjZSA9PT0gdW5kZWZpbmVkICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhc3BlZWQgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBXaXRob3V0IHNwZWVkIHBhcmFtZXRlcg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmlnLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQuZWZmZWN0cy5hbmltYXRlQ2xhc3MuY2FsbCggdGhpcywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCBmb3JjZSA/IHsgYWRkOiBjbGFzc05hbWVzIH0gOiB7IHJlbW92ZTogY2xhc3NOYW1lcyB9ICksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdpdGhvdXQgZm9yY2UgcGFyYW1ldGVyDQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJC5lZmZlY3RzLmFuaW1hdGVDbGFzcy5jYWxsKCB0aGlzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdG9nZ2xlOiBjbGFzc05hbWVzIH0sIGZvcmNlLCBzcGVlZCwgZWFzaW5nICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfSApKCAkLmZuLnRvZ2dsZUNsYXNzICksDQoNCiAgICAgICAgICAgIHN3aXRjaENsYXNzOiBmdW5jdGlvbiggcmVtb3ZlLCBhZGQsIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkLmVmZmVjdHMuYW5pbWF0ZUNsYXNzLmNhbGwoIHRoaXMsIHsNCiAgICAgICAgICAgICAgICAgICAgYWRkOiBhZGQsDQogICAgICAgICAgICAgICAgICAgIHJlbW92ZTogcmVtb3ZlDQogICAgICAgICAgICAgICAgfSwgc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSApOw0KDQogICAgfSApKCk7DQoNCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBFRkZFQ1RTICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovDQogICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICggZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgaWYgKCAkLmV4cHIgJiYgJC5leHByLmZpbHRlcnMgJiYgJC5leHByLmZpbHRlcnMuYW5pbWF0ZWQgKSB7DQogICAgICAgICAgICAkLmV4cHIuZmlsdGVycy5hbmltYXRlZCA9ICggZnVuY3Rpb24oIG9yaWcgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gISEkKCBlbGVtICkuZGF0YSggZGF0YVNwYWNlQW5pbWF0ZWQgKSB8fCBvcmlnKCBlbGVtICk7DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0gKSggJC5leHByLmZpbHRlcnMuYW5pbWF0ZWQgKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICggJC51aUJhY2tDb21wYXQgIT09IGZhbHNlICkgew0KICAgICAgICAgICAgJC5leHRlbmQoICQuZWZmZWN0cywgew0KDQogICAgICAgICAgICAgICAgLy8gU2F2ZXMgYSBzZXQgb2YgcHJvcGVydGllcyBpbiBhIGRhdGEgc3RvcmFnZQ0KICAgICAgICAgICAgICAgIHNhdmU6IGZ1bmN0aW9uKCBlbGVtZW50LCBzZXQgKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBpID0gMCwgbGVuZ3RoID0gc2V0Lmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHNldFsgaSBdICE9PSBudWxsICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZGF0YSggZGF0YVNwYWNlICsgc2V0WyBpIF0sIGVsZW1lbnRbIDAgXS5zdHlsZVsgc2V0WyBpIF0gXSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIC8vIFJlc3RvcmVzIGEgc2V0IG9mIHByZXZpb3VzbHkgc2F2ZWQgcHJvcGVydGllcyBmcm9tIGEgZGF0YSBzdG9yYWdlDQogICAgICAgICAgICAgICAgcmVzdG9yZTogZnVuY3Rpb24oIGVsZW1lbnQsIHNldCApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbCwgaSA9IDAsIGxlbmd0aCA9IHNldC5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIGZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBzZXRbIGkgXSAhPT0gbnVsbCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWwgPSBlbGVtZW50LmRhdGEoIGRhdGFTcGFjZSArIHNldFsgaSBdICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jc3MoIHNldFsgaSBdLCB2YWwgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICBzZXRNb2RlOiBmdW5jdGlvbiggZWwsIG1vZGUgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggbW9kZSA9PT0gInRvZ2dsZSIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtb2RlID0gZWwuaXMoICI6aGlkZGVuIiApID8gInNob3ciIDogImhpZGUiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2RlOw0KICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAvLyBXcmFwcyB0aGUgZWxlbWVudCBhcm91bmQgYSB3cmFwcGVyIHRoYXQgY29waWVzIHBvc2l0aW9uIHByb3BlcnRpZXMNCiAgICAgICAgICAgICAgICBjcmVhdGVXcmFwcGVyOiBmdW5jdGlvbiggZWxlbWVudCApIHsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgZWxlbWVudCBpcyBhbHJlYWR5IHdyYXBwZWQsIHJldHVybiBpdA0KICAgICAgICAgICAgICAgICAgICBpZiAoIGVsZW1lbnQucGFyZW50KCkuaXMoICIudWktZWZmZWN0cy13cmFwcGVyIiApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQucGFyZW50KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBXcmFwIHRoZSBlbGVtZW50DQogICAgICAgICAgICAgICAgICAgIHZhciBwcm9wcyA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogZWxlbWVudC5vdXRlcldpZHRoKCB0cnVlICksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBlbGVtZW50Lm91dGVySGVpZ2h0KCB0cnVlICksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImZsb2F0IjogZWxlbWVudC5jc3MoICJmbG9hdCIgKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHdyYXBwZXIgPSAkKCAiPGRpdj48L2Rpdj4iICkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoICJ1aS1lZmZlY3RzLXdyYXBwZXIiICkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY3NzKCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiAiMTAwJSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICJ0cmFuc3BhcmVudCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlcjogIm5vbmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW46IDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICksDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBzaXplIGluIGNhc2Ugd2lkdGgvaGVpZ2h0IGFyZSBkZWZpbmVkIGluICUgLSBGaXhlcyAjNTI0NQ0KICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogZWxlbWVudC53aWR0aCgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogZWxlbWVudC5oZWlnaHQoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZSA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gU3VwcG9ydDogRmlyZWZveA0KICAgICAgICAgICAgICAgICAgICAvLyBGaXJlZm94IGluY29ycmVjdGx5IGV4cG9zZXMgYW5vbnltb3VzIGNvbnRlbnQNCiAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NTYxNjY0DQogICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmUuaWQ7DQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKCBlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlID0gZG9jdW1lbnQuYm9keTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQud3JhcCggd3JhcHBlciApOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIEZpeGVzICM3NTk1IC0gRWxlbWVudHMgbG9zZSBmb2N1cyB3aGVuIHdyYXBwZWQuDQogICAgICAgICAgICAgICAgICAgIGlmICggZWxlbWVudFsgMCBdID09PSBhY3RpdmUgfHwgJC5jb250YWlucyggZWxlbWVudFsgMCBdLCBhY3RpdmUgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQoIGFjdGl2ZSApLnRyaWdnZXIoICJmb2N1cyIgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIEhvdGZpeCBmb3IgalF1ZXJ5IDEuNCBzaW5jZSBzb21lIGNoYW5nZSBpbiB3cmFwKCkgc2VlbXMgdG8gYWN0dWFsbHkNCiAgICAgICAgICAgICAgICAgICAgLy8gbG9zZSB0aGUgcmVmZXJlbmNlIHRvIHRoZSB3cmFwcGVkIGVsZW1lbnQNCiAgICAgICAgICAgICAgICAgICAgd3JhcHBlciA9IGVsZW1lbnQucGFyZW50KCk7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gVHJhbnNmZXIgcG9zaXRpb25pbmcgcHJvcGVydGllcyB0byB0aGUgd3JhcHBlcg0KICAgICAgICAgICAgICAgICAgICBpZiAoIGVsZW1lbnQuY3NzKCAicG9zaXRpb24iICkgPT09ICJzdGF0aWMiICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5jc3MoIHsgcG9zaXRpb246ICJyZWxhdGl2ZSIgfSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jc3MoIHsgcG9zaXRpb246ICJyZWxhdGl2ZSIgfSApOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgJC5leHRlbmQoIHByb3BzLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGVsZW1lbnQuY3NzKCAicG9zaXRpb24iICksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4OiBlbGVtZW50LmNzcyggInotaW5kZXgiICkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICQuZWFjaCggWyAidG9wIiwgImxlZnQiLCAiYm90dG9tIiwgInJpZ2h0IiBdLCBmdW5jdGlvbiggaSwgcG9zICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzWyBwb3MgXSA9IGVsZW1lbnQuY3NzKCBwb3MgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGlzTmFOKCBwYXJzZUludCggcHJvcHNbIHBvcyBdLCAxMCApICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzWyBwb3MgXSA9ICJhdXRvIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNzcyggew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAicmVsYXRpdmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiAiYXV0byIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tOiAiYXV0byINCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNzcyggc2l6ZSApOw0KDQogICAgICAgICAgICAgICAgICAgIHJldHVybiB3cmFwcGVyLmNzcyggcHJvcHMgKS5zaG93KCk7DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIHJlbW92ZVdyYXBwZXI6IGZ1bmN0aW9uKCBlbGVtZW50ICkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoIGVsZW1lbnQucGFyZW50KCkuaXMoICIudWktZWZmZWN0cy13cmFwcGVyIiApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5wYXJlbnQoKS5yZXBsYWNlV2l0aCggZWxlbWVudCApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBGaXhlcyAjNzU5NSAtIEVsZW1lbnRzIGxvc2UgZm9jdXMgd2hlbiB3cmFwcGVkLg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBlbGVtZW50WyAwIF0gPT09IGFjdGl2ZSB8fCAkLmNvbnRhaW5zKCBlbGVtZW50WyAwIF0sIGFjdGl2ZSApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIGFjdGl2ZSApLnRyaWdnZXIoICJmb2N1cyIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfQ0KDQogICAgICAgICQuZXh0ZW5kKCAkLmVmZmVjdHMsIHsNCiAgICAgICAgICAgIHZlcnNpb246ICIxLjEyLjEiLA0KDQogICAgICAgICAgICBkZWZpbmU6IGZ1bmN0aW9uKCBuYW1lLCBtb2RlLCBlZmZlY3QgKSB7DQogICAgICAgICAgICAgICAgaWYgKCAhZWZmZWN0ICkgew0KICAgICAgICAgICAgICAgICAgICBlZmZlY3QgPSBtb2RlOw0KICAgICAgICAgICAgICAgICAgICBtb2RlID0gImVmZmVjdCI7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgJC5lZmZlY3RzLmVmZmVjdFsgbmFtZSBdID0gZWZmZWN0Ow0KICAgICAgICAgICAgICAgICQuZWZmZWN0cy5lZmZlY3RbIG5hbWUgXS5tb2RlID0gbW9kZTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiBlZmZlY3Q7DQogICAgICAgICAgICB9LA0KDQogICAgICAgICAgICBzY2FsZWREaW1lbnNpb25zOiBmdW5jdGlvbiggZWxlbWVudCwgcGVyY2VudCwgZGlyZWN0aW9uICkgew0KICAgICAgICAgICAgICAgIGlmICggcGVyY2VudCA9PT0gMCApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgb3V0ZXJIZWlnaHQ6IDAsDQogICAgICAgICAgICAgICAgICAgICAgICBvdXRlcldpZHRoOiAwDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdmFyIHggPSBkaXJlY3Rpb24gIT09ICJob3Jpem9udGFsIiA/ICggKCBwZXJjZW50IHx8IDEwMCApIC8gMTAwICkgOiAxLA0KICAgICAgICAgICAgICAgICAgICB5ID0gZGlyZWN0aW9uICE9PSAidmVydGljYWwiID8gKCAoIHBlcmNlbnQgfHwgMTAwICkgLyAxMDAgKSA6IDE7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGVsZW1lbnQuaGVpZ2h0KCkgKiB5LA0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogZWxlbWVudC53aWR0aCgpICogeCwNCiAgICAgICAgICAgICAgICAgICAgb3V0ZXJIZWlnaHQ6IGVsZW1lbnQub3V0ZXJIZWlnaHQoKSAqIHksDQogICAgICAgICAgICAgICAgICAgIG91dGVyV2lkdGg6IGVsZW1lbnQub3V0ZXJXaWR0aCgpICogeA0KICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgIGNsaXBUb0JveDogZnVuY3Rpb24oIGFuaW1hdGlvbiApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogYW5pbWF0aW9uLmNsaXAucmlnaHQgLSBhbmltYXRpb24uY2xpcC5sZWZ0LA0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGFuaW1hdGlvbi5jbGlwLmJvdHRvbSAtIGFuaW1hdGlvbi5jbGlwLnRvcCwNCiAgICAgICAgICAgICAgICAgICAgbGVmdDogYW5pbWF0aW9uLmNsaXAubGVmdCwNCiAgICAgICAgICAgICAgICAgICAgdG9wOiBhbmltYXRpb24uY2xpcC50b3ANCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgLy8gSW5qZWN0cyByZWNlbnRseSBxdWV1ZWQgZnVuY3Rpb25zIHRvIGJlIGZpcnN0IGluIGxpbmUgKGFmdGVyICJpbnByb2dyZXNzIikNCiAgICAgICAgICAgIHVuc2hpZnQ6IGZ1bmN0aW9uKCBlbGVtZW50LCBxdWV1ZUxlbmd0aCwgY291bnQgKSB7DQogICAgICAgICAgICAgICAgdmFyIHF1ZXVlID0gZWxlbWVudC5xdWV1ZSgpOw0KDQogICAgICAgICAgICAgICAgaWYgKCBxdWV1ZUxlbmd0aCA+IDEgKSB7DQogICAgICAgICAgICAgICAgICAgIHF1ZXVlLnNwbGljZS5hcHBseSggcXVldWUsDQogICAgICAgICAgICAgICAgICAgICAgICBbIDEsIDAgXS5jb25jYXQoIHF1ZXVlLnNwbGljZSggcXVldWVMZW5ndGgsIGNvdW50ICkgKSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbGVtZW50LmRlcXVldWUoKTsNCiAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgIHNhdmVTdHlsZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7DQogICAgICAgICAgICAgICAgZWxlbWVudC5kYXRhKCBkYXRhU3BhY2VTdHlsZSwgZWxlbWVudFsgMCBdLnN0eWxlLmNzc1RleHQgKTsNCiAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgIHJlc3RvcmVTdHlsZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7DQogICAgICAgICAgICAgICAgZWxlbWVudFsgMCBdLnN0eWxlLmNzc1RleHQgPSBlbGVtZW50LmRhdGEoIGRhdGFTcGFjZVN0eWxlICkgfHwgIiI7DQogICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVEYXRhKCBkYXRhU3BhY2VTdHlsZSApOw0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgbW9kZTogZnVuY3Rpb24oIGVsZW1lbnQsIG1vZGUgKSB7DQogICAgICAgICAgICAgICAgdmFyIGhpZGRlbiA9IGVsZW1lbnQuaXMoICI6aGlkZGVuIiApOw0KDQogICAgICAgICAgICAgICAgaWYgKCBtb2RlID09PSAidG9nZ2xlIiApIHsNCiAgICAgICAgICAgICAgICAgICAgbW9kZSA9IGhpZGRlbiA/ICJzaG93IiA6ICJoaWRlIjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCBoaWRkZW4gPyBtb2RlID09PSAiaGlkZSIgOiBtb2RlID09PSAic2hvdyIgKSB7DQogICAgICAgICAgICAgICAgICAgIG1vZGUgPSAibm9uZSI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiBtb2RlOw0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgLy8gVHJhbnNsYXRlcyBhIFt0b3AsbGVmdF0gYXJyYXkgaW50byBhIGJhc2VsaW5lIHZhbHVlDQogICAgICAgICAgICBnZXRCYXNlbGluZTogZnVuY3Rpb24oIG9yaWdpbiwgb3JpZ2luYWwgKSB7DQogICAgICAgICAgICAgICAgdmFyIHksIHg7DQoNCiAgICAgICAgICAgICAgICBzd2l0Y2ggKCBvcmlnaW5bIDAgXSApIHsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAidG9wIjoNCiAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgIm1pZGRsZSI6DQogICAgICAgICAgICAgICAgICAgICAgICB5ID0gMC41Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgImJvdHRvbSI6DQogICAgICAgICAgICAgICAgICAgICAgICB5ID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICAgICAgeSA9IG9yaWdpblsgMCBdIC8gb3JpZ2luYWwuaGVpZ2h0Ow0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHN3aXRjaCAoIG9yaWdpblsgMSBdICkgew0KICAgICAgICAgICAgICAgICAgICBjYXNlICJsZWZ0IjoNCiAgICAgICAgICAgICAgICAgICAgICAgIHggPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgImNlbnRlciI6DQogICAgICAgICAgICAgICAgICAgICAgICB4ID0gMC41Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgInJpZ2h0IjoNCiAgICAgICAgICAgICAgICAgICAgICAgIHggPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgICAgICB4ID0gb3JpZ2luWyAxIF0gLyBvcmlnaW5hbC53aWR0aDsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICB4OiB4LA0KICAgICAgICAgICAgICAgICAgICB5OiB5DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgIC8vIENyZWF0ZXMgYSBwbGFjZWhvbGRlciBlbGVtZW50IHNvIHRoYXQgdGhlIG9yaWdpbmFsIGVsZW1lbnQgY2FuIGJlIG1hZGUgYWJzb2x1dGUNCiAgICAgICAgICAgIGNyZWF0ZVBsYWNlaG9sZGVyOiBmdW5jdGlvbiggZWxlbWVudCApIHsNCiAgICAgICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXIsDQogICAgICAgICAgICAgICAgICAgIGNzc1Bvc2l0aW9uID0gZWxlbWVudC5jc3MoICJwb3NpdGlvbiIgKSwNCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSBlbGVtZW50LnBvc2l0aW9uKCk7DQoNCiAgICAgICAgICAgICAgICAvLyBMb2NrIGluIG1hcmdpbnMgZmlyc3QgdG8gYWNjb3VudCBmb3IgZm9ybSBlbGVtZW50cywgd2hpY2gNCiAgICAgICAgICAgICAgICAvLyB3aWxsIGNoYW5nZSBtYXJnaW4gaWYgeW91IGV4cGxpY2l0bHkgc2V0IGhlaWdodA0KICAgICAgICAgICAgICAgIC8vIHNlZTogaHR0cDovL2pzZmlkZGxlLm5ldC9KWlNNdC8zLyBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTA3MzgwDQogICAgICAgICAgICAgICAgLy8gU3VwcG9ydDogU2FmYXJpDQogICAgICAgICAgICAgICAgZWxlbWVudC5jc3MoIHsNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luVG9wOiBlbGVtZW50LmNzcyggIm1hcmdpblRvcCIgKSwNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luQm90dG9tOiBlbGVtZW50LmNzcyggIm1hcmdpbkJvdHRvbSIgKSwNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luTGVmdDogZWxlbWVudC5jc3MoICJtYXJnaW5MZWZ0IiApLA0KICAgICAgICAgICAgICAgICAgICBtYXJnaW5SaWdodDogZWxlbWVudC5jc3MoICJtYXJnaW5SaWdodCIgKQ0KICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgICAgICAub3V0ZXJXaWR0aCggZWxlbWVudC5vdXRlcldpZHRoKCkgKQ0KICAgICAgICAgICAgICAgICAgICAub3V0ZXJIZWlnaHQoIGVsZW1lbnQub3V0ZXJIZWlnaHQoKSApOw0KDQogICAgICAgICAgICAgICAgaWYgKCAvXihzdGF0aWN8cmVsYXRpdmUpLy50ZXN0KCBjc3NQb3NpdGlvbiApICkgew0KICAgICAgICAgICAgICAgICAgICBjc3NQb3NpdGlvbiA9ICJhYnNvbHV0ZSI7DQoNCiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIgPSAkKCAiPCIgKyBlbGVtZW50WyAwIF0ubm9kZU5hbWUgKyAiPiIgKS5pbnNlcnRBZnRlciggZWxlbWVudCApLmNzcyggew0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBDb252ZXJ0IGlubGluZSB0byBpbmxpbmUgYmxvY2sgdG8gYWNjb3VudCBmb3IgaW5saW5lIGVsZW1lbnRzDQogICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGF0IHR1cm4gdG8gaW5saW5lIGJsb2NrIGJhc2VkIG9uIGNvbnRlbnQgKGxpa2UgaW1nKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogL14oaW5saW5lfHJ1YnkpLy50ZXN0KCBlbGVtZW50LmNzcyggImRpc3BsYXkiICkgKSA/DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImlubGluZS1ibG9jayIgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJibG9jayIsDQogICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiAiaGlkZGVuIiwNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyZ2lucyBuZWVkIHRvIGJlIHNldCB0byBhY2NvdW50IGZvciBtYXJnaW4gY29sbGFwc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpblRvcDogZWxlbWVudC5jc3MoICJtYXJnaW5Ub3AiICksDQogICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5Cb3R0b206IGVsZW1lbnQuY3NzKCAibWFyZ2luQm90dG9tIiApLA0KICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luTGVmdDogZWxlbWVudC5jc3MoICJtYXJnaW5MZWZ0IiApLA0KICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luUmlnaHQ6IGVsZW1lbnQuY3NzKCAibWFyZ2luUmlnaHQiICksDQogICAgICAgICAgICAgICAgICAgICAgICAiZmxvYXQiOiBlbGVtZW50LmNzcyggImZsb2F0IiApDQogICAgICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgICAgICAgICAgLm91dGVyV2lkdGgoIGVsZW1lbnQub3V0ZXJXaWR0aCgpICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5vdXRlckhlaWdodCggZWxlbWVudC5vdXRlckhlaWdodCgpICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyggInVpLWVmZmVjdHMtcGxhY2Vob2xkZXIiICk7DQoNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5kYXRhKCBkYXRhU3BhY2UgKyAicGxhY2Vob2xkZXIiLCBwbGFjZWhvbGRlciApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGVsZW1lbnQuY3NzKCB7DQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBjc3NQb3NpdGlvbiwNCiAgICAgICAgICAgICAgICAgICAgbGVmdDogcG9zaXRpb24ubGVmdCwNCiAgICAgICAgICAgICAgICAgICAgdG9wOiBwb3NpdGlvbi50b3ANCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gcGxhY2Vob2xkZXI7DQogICAgICAgICAgICB9LA0KDQogICAgICAgICAgICByZW1vdmVQbGFjZWhvbGRlcjogZnVuY3Rpb24oIGVsZW1lbnQgKSB7DQogICAgICAgICAgICAgICAgdmFyIGRhdGFLZXkgPSBkYXRhU3BhY2UgKyAicGxhY2Vob2xkZXIiLA0KICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlciA9IGVsZW1lbnQuZGF0YSggZGF0YUtleSApOw0KDQogICAgICAgICAgICAgICAgaWYgKCBwbGFjZWhvbGRlciApIHsNCiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlRGF0YSggZGF0YUtleSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgIC8vIFJlbW92ZXMgYSBwbGFjZWhvbGRlciBpZiBpdCBleGlzdHMgYW5kIHJlc3RvcmVzDQogICAgICAgICAgICAvLyBwcm9wZXJ0aWVzIHRoYXQgd2VyZSBtb2RpZmllZCBkdXJpbmcgcGxhY2Vob2xkZXIgY3JlYXRpb24NCiAgICAgICAgICAgIGNsZWFuVXA6IGZ1bmN0aW9uKCBlbGVtZW50ICkgew0KICAgICAgICAgICAgICAgICQuZWZmZWN0cy5yZXN0b3JlU3R5bGUoIGVsZW1lbnQgKTsNCiAgICAgICAgICAgICAgICAkLmVmZmVjdHMucmVtb3ZlUGxhY2Vob2xkZXIoIGVsZW1lbnQgKTsNCiAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgIHNldFRyYW5zaXRpb246IGZ1bmN0aW9uKCBlbGVtZW50LCBsaXN0LCBmYWN0b3IsIHZhbHVlICkgew0KICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgfHwge307DQogICAgICAgICAgICAgICAgJC5lYWNoKCBsaXN0LCBmdW5jdGlvbiggaSwgeCApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHVuaXQgPSBlbGVtZW50LmNzc1VuaXQoIHggKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB1bml0WyAwIF0gPiAwICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVbIHggXSA9IHVuaXRbIDAgXSAqIGZhY3RvciArIHVuaXRbIDEgXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0gKTsNCg0KLy8gUmV0dXJuIGFuIGVmZmVjdCBvcHRpb25zIG9iamVjdCBmb3IgdGhlIGdpdmVuIHBhcmFtZXRlcnM6DQogICAgICAgIGZ1bmN0aW9uIF9ub3JtYWxpemVBcmd1bWVudHMoIGVmZmVjdCwgb3B0aW9ucywgc3BlZWQsIGNhbGxiYWNrICkgew0KDQogICAgICAgICAgICAvLyBBbGxvdyBwYXNzaW5nIGFsbCBvcHRpb25zIGFzIHRoZSBmaXJzdCBwYXJhbWV0ZXINCiAgICAgICAgICAgIGlmICggJC5pc1BsYWluT2JqZWN0KCBlZmZlY3QgKSApIHsNCiAgICAgICAgICAgICAgICBvcHRpb25zID0gZWZmZWN0Ow0KICAgICAgICAgICAgICAgIGVmZmVjdCA9IGVmZmVjdC5lZmZlY3Q7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIENvbnZlcnQgdG8gYW4gb2JqZWN0DQogICAgICAgICAgICBlZmZlY3QgPSB7IGVmZmVjdDogZWZmZWN0IH07DQoNCiAgICAgICAgICAgIC8vIENhdGNoIChlZmZlY3QsIG51bGwsIC4uLikNCiAgICAgICAgICAgIGlmICggb3B0aW9ucyA9PSBudWxsICkgew0KICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7fTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gQ2F0Y2ggKGVmZmVjdCwgY2FsbGJhY2spDQogICAgICAgICAgICBpZiAoICQuaXNGdW5jdGlvbiggb3B0aW9ucyApICkgew0KICAgICAgICAgICAgICAgIGNhbGxiYWNrID0gb3B0aW9uczsNCiAgICAgICAgICAgICAgICBzcGVlZCA9IG51bGw7DQogICAgICAgICAgICAgICAgb3B0aW9ucyA9IHt9Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBDYXRjaCAoZWZmZWN0LCBzcGVlZCwgPykNCiAgICAgICAgICAgIGlmICggdHlwZW9mIG9wdGlvbnMgPT09ICJudW1iZXIiIHx8ICQuZnguc3BlZWRzWyBvcHRpb25zIF0gKSB7DQogICAgICAgICAgICAgICAgY2FsbGJhY2sgPSBzcGVlZDsNCiAgICAgICAgICAgICAgICBzcGVlZCA9IG9wdGlvbnM7DQogICAgICAgICAgICAgICAgb3B0aW9ucyA9IHt9Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBDYXRjaCAoZWZmZWN0LCBvcHRpb25zLCBjYWxsYmFjaykNCiAgICAgICAgICAgIGlmICggJC5pc0Z1bmN0aW9uKCBzcGVlZCApICkgew0KICAgICAgICAgICAgICAgIGNhbGxiYWNrID0gc3BlZWQ7DQogICAgICAgICAgICAgICAgc3BlZWQgPSBudWxsOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBBZGQgb3B0aW9ucyB0byBlZmZlY3QNCiAgICAgICAgICAgIGlmICggb3B0aW9ucyApIHsNCiAgICAgICAgICAgICAgICAkLmV4dGVuZCggZWZmZWN0LCBvcHRpb25zICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHNwZWVkID0gc3BlZWQgfHwgb3B0aW9ucy5kdXJhdGlvbjsNCiAgICAgICAgICAgIGVmZmVjdC5kdXJhdGlvbiA9ICQuZngub2ZmID8gMCA6DQogICAgICAgICAgICAgICAgdHlwZW9mIHNwZWVkID09PSAibnVtYmVyIiA/IHNwZWVkIDoNCiAgICAgICAgICAgICAgICAgICAgc3BlZWQgaW4gJC5meC5zcGVlZHMgPyAkLmZ4LnNwZWVkc1sgc3BlZWQgXSA6DQogICAgICAgICAgICAgICAgICAgICAgICAkLmZ4LnNwZWVkcy5fZGVmYXVsdDsNCg0KICAgICAgICAgICAgZWZmZWN0LmNvbXBsZXRlID0gY2FsbGJhY2sgfHwgb3B0aW9ucy5jb21wbGV0ZTsNCg0KICAgICAgICAgICAgcmV0dXJuIGVmZmVjdDsNCiAgICAgICAgfQ0KDQogICAgICAgIGZ1bmN0aW9uIHN0YW5kYXJkQW5pbWF0aW9uT3B0aW9uKCBvcHRpb24gKSB7DQoNCiAgICAgICAgICAgIC8vIFZhbGlkIHN0YW5kYXJkIHNwZWVkcyAobm90aGluZywgbnVtYmVyLCBuYW1lZCBzcGVlZCkNCiAgICAgICAgICAgIGlmICggIW9wdGlvbiB8fCB0eXBlb2Ygb3B0aW9uID09PSAibnVtYmVyIiB8fCAkLmZ4LnNwZWVkc1sgb3B0aW9uIF0gKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIEludmFsaWQgc3RyaW5ncyAtIHRyZWF0IGFzICJub3JtYWwiIHNwZWVkDQogICAgICAgICAgICBpZiAoIHR5cGVvZiBvcHRpb24gPT09ICJzdHJpbmciICYmICEkLmVmZmVjdHMuZWZmZWN0WyBvcHRpb24gXSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gQ29tcGxldGUgY2FsbGJhY2sNCiAgICAgICAgICAgIGlmICggJC5pc0Z1bmN0aW9uKCBvcHRpb24gKSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gT3B0aW9ucyBoYXNoIChidXQgbm90IG5hbWluZyBhbiBlZmZlY3QpDQogICAgICAgICAgICBpZiAoIHR5cGVvZiBvcHRpb24gPT09ICJvYmplY3QiICYmICFvcHRpb24uZWZmZWN0ICkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBEaWRuJ3QgbWF0Y2ggYW55IHN0YW5kYXJkIEFQSQ0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJC5mbi5leHRlbmQoIHsNCiAgICAgICAgICAgIGVmZmVjdDogZnVuY3Rpb24oIC8qIGVmZmVjdCwgb3B0aW9ucywgc3BlZWQsIGNhbGxiYWNrICovICkgew0KICAgICAgICAgICAgICAgIHZhciBhcmdzID0gX25vcm1hbGl6ZUFyZ3VtZW50cy5hcHBseSggdGhpcywgYXJndW1lbnRzICksDQogICAgICAgICAgICAgICAgICAgIGVmZmVjdE1ldGhvZCA9ICQuZWZmZWN0cy5lZmZlY3RbIGFyZ3MuZWZmZWN0IF0sDQogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRNb2RlID0gZWZmZWN0TWV0aG9kLm1vZGUsDQogICAgICAgICAgICAgICAgICAgIHF1ZXVlID0gYXJncy5xdWV1ZSwNCiAgICAgICAgICAgICAgICAgICAgcXVldWVOYW1lID0gcXVldWUgfHwgImZ4IiwNCiAgICAgICAgICAgICAgICAgICAgY29tcGxldGUgPSBhcmdzLmNvbXBsZXRlLA0KICAgICAgICAgICAgICAgICAgICBtb2RlID0gYXJncy5tb2RlLA0KICAgICAgICAgICAgICAgICAgICBtb2RlcyA9IFtdLA0KICAgICAgICAgICAgICAgICAgICBwcmVmaWx0ZXIgPSBmdW5jdGlvbiggbmV4dCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbCA9ICQoIHRoaXMgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3JtYWxpemVkTW9kZSA9ICQuZWZmZWN0cy5tb2RlKCBlbCwgbW9kZSApIHx8IGRlZmF1bHRNb2RlOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBTZW50aW5lbCBmb3IgZHVjay1wdW5jaGluZyB0aGUgOmFuaW1hdGVkIHBzdWVkby1zZWxlY3Rvcg0KICAgICAgICAgICAgICAgICAgICAgICAgZWwuZGF0YSggZGF0YVNwYWNlQW5pbWF0ZWQsIHRydWUgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2F2ZSBlZmZlY3QgbW9kZSBmb3IgbGF0ZXIgdXNlLA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgY2FuJ3QganVzdCBjYWxsICQuZWZmZWN0cy5tb2RlIGFnYWluIGxhdGVyLA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXMgdGhlIC5zaG93KCkgYmVsb3cgZGVzdHJveXMgdGhlIGluaXRpYWwgc3RhdGUNCiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVzLnB1c2goIG5vcm1hbGl6ZWRNb2RlICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNlZSAkLnVpQmFja0NvbXBhdCBpbnNpZGUgb2YgcnVuKCkgZm9yIHJlbW92YWwgb2YgZGVmYXVsdE1vZGUgaW4gMS4xMw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBkZWZhdWx0TW9kZSAmJiAoIG5vcm1hbGl6ZWRNb2RlID09PSAic2hvdyIgfHwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIG5vcm1hbGl6ZWRNb2RlID09PSBkZWZhdWx0TW9kZSAmJiBub3JtYWxpemVkTW9kZSA9PT0gImhpZGUiICkgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbC5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggIWRlZmF1bHRNb2RlIHx8IG5vcm1hbGl6ZWRNb2RlICE9PSAibm9uZSIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5lZmZlY3RzLnNhdmVTdHlsZSggZWwgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAkLmlzRnVuY3Rpb24oIG5leHQgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICBpZiAoICQuZngub2ZmIHx8ICFlZmZlY3RNZXRob2QgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gRGVsZWdhdGUgdG8gdGhlIG9yaWdpbmFsIG1ldGhvZCAoZS5nLiwgLnNob3coKSkgaWYgcG9zc2libGUNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBtb2RlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbIG1vZGUgXSggYXJncy5kdXJhdGlvbiwgY29tcGxldGUgKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggY29tcGxldGUgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlLmNhbGwoIHRoaXMgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBydW4oIG5leHQgKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBlbGVtID0gJCggdGhpcyApOw0KDQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNsZWFudXAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlbGVtLnJlbW92ZURhdGEoIGRhdGFTcGFjZUFuaW1hdGVkICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICQuZWZmZWN0cy5jbGVhblVwKCBlbGVtICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggYXJncy5tb2RlID09PSAiaGlkZSIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5oaWRlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbmUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRvbmUoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoICQuaXNGdW5jdGlvbiggY29tcGxldGUgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZS5jYWxsKCBlbGVtWyAwIF0gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAkLmlzRnVuY3Rpb24oIG5leHQgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBPdmVycmlkZSBtb2RlIG9wdGlvbiBvbiBhIHBlciBlbGVtZW50IGJhc2lzLA0KICAgICAgICAgICAgICAgICAgICAvLyBhcyB0b2dnbGUgY2FuIGJlIGVpdGhlciBzaG93IG9yIGhpZGUgZGVwZW5kaW5nIG9uIGVsZW1lbnQgc3RhdGUNCiAgICAgICAgICAgICAgICAgICAgYXJncy5tb2RlID0gbW9kZXMuc2hpZnQoKTsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoICQudWlCYWNrQ29tcGF0ICE9PSBmYWxzZSAmJiAhZGVmYXVsdE1vZGUgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGVsZW0uaXMoICI6aGlkZGVuIiApID8gbW9kZSA9PT0gImhpZGUiIDogbW9kZSA9PT0gInNob3ciICkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FsbCB0aGUgY29yZSBtZXRob2QgdG8gdHJhY2sgIm9sZGRpc3BsYXkiIHByb3Blcmx5DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbVsgbW9kZSBdKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9uZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZmZlY3RNZXRob2QuY2FsbCggZWxlbVsgMCBdLCBhcmdzLCBkb25lICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGFyZ3MubW9kZSA9PT0gIm5vbmUiICkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FsbCB0aGUgY29yZSBtZXRob2QgdG8gdHJhY2sgIm9sZGRpc3BsYXkiIHByb3Blcmx5DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbVsgbW9kZSBdKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9uZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZmZlY3RNZXRob2QuY2FsbCggZWxlbVsgMCBdLCBhcmdzLCBjbGVhbnVwICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBSdW4gcHJlZmlsdGVyIG9uIGFsbCBlbGVtZW50cyBmaXJzdCB0byBlbnN1cmUgdGhhdA0KICAgICAgICAgICAgICAgIC8vIGFueSBzaG93aW5nIG9yIGhpZGluZyBoYXBwZW5zIGJlZm9yZSBwbGFjZWhvbGRlciBjcmVhdGlvbiwNCiAgICAgICAgICAgICAgICAvLyB3aGljaCBlbnN1cmVzIHRoYXQgYW55IGxheW91dCBjaGFuZ2VzIGFyZSBjb3JyZWN0bHkgY2FwdHVyZWQuDQogICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXVlID09PSBmYWxzZSA/DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWFjaCggcHJlZmlsdGVyICkuZWFjaCggcnVuICkgOg0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXVlKCBxdWV1ZU5hbWUsIHByZWZpbHRlciApLnF1ZXVlKCBxdWV1ZU5hbWUsIHJ1biApOw0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgc2hvdzogKCBmdW5jdGlvbiggb3JpZyApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oIG9wdGlvbiApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBzdGFuZGFyZEFuaW1hdGlvbk9wdGlvbiggb3B0aW9uICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JpZy5hcHBseSggdGhpcywgYXJndW1lbnRzICk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IF9ub3JtYWxpemVBcmd1bWVudHMuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5tb2RlID0gInNob3ciOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWZmZWN0LmNhbGwoIHRoaXMsIGFyZ3MgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9ICkoICQuZm4uc2hvdyApLA0KDQogICAgICAgICAgICBoaWRlOiAoIGZ1bmN0aW9uKCBvcmlnICkgew0KICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiggb3B0aW9uICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIHN0YW5kYXJkQW5pbWF0aW9uT3B0aW9uKCBvcHRpb24gKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmlnLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gX25vcm1hbGl6ZUFyZ3VtZW50cy5hcHBseSggdGhpcywgYXJndW1lbnRzICk7DQogICAgICAgICAgICAgICAgICAgICAgICBhcmdzLm1vZGUgPSAiaGlkZSI7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lZmZlY3QuY2FsbCggdGhpcywgYXJncyApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0gKSggJC5mbi5oaWRlICksDQoNCiAgICAgICAgICAgIHRvZ2dsZTogKCBmdW5jdGlvbiggb3JpZyApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oIG9wdGlvbiApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBzdGFuZGFyZEFuaW1hdGlvbk9wdGlvbiggb3B0aW9uICkgfHwgdHlwZW9mIG9wdGlvbiA9PT0gImJvb2xlYW4iICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9yaWcuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBfbm9ybWFsaXplQXJndW1lbnRzLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MubW9kZSA9ICJ0b2dnbGUiOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWZmZWN0LmNhbGwoIHRoaXMsIGFyZ3MgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9ICkoICQuZm4udG9nZ2xlICksDQoNCiAgICAgICAgICAgIGNzc1VuaXQ6IGZ1bmN0aW9uKCBrZXkgKSB7DQogICAgICAgICAgICAgICAgdmFyIHN0eWxlID0gdGhpcy5jc3MoIGtleSApLA0KICAgICAgICAgICAgICAgICAgICB2YWwgPSBbXTsNCg0KICAgICAgICAgICAgICAgICQuZWFjaCggWyAiZW0iLCAicHgiLCAiJSIsICJwdCIgXSwgZnVuY3Rpb24oIGksIHVuaXQgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggc3R5bGUuaW5kZXhPZiggdW5pdCApID4gMCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9IFsgcGFyc2VGbG9hdCggc3R5bGUgKSwgdW5pdCBdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIHJldHVybiB2YWw7DQogICAgICAgICAgICB9LA0KDQogICAgICAgICAgICBjc3NDbGlwOiBmdW5jdGlvbiggY2xpcE9iaiApIHsNCiAgICAgICAgICAgICAgICBpZiAoIGNsaXBPYmogKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNzcyggImNsaXAiLCAicmVjdCgiICsgY2xpcE9iai50b3AgKyAicHggIiArIGNsaXBPYmoucmlnaHQgKyAicHggIiArDQogICAgICAgICAgICAgICAgICAgICAgICBjbGlwT2JqLmJvdHRvbSArICJweCAiICsgY2xpcE9iai5sZWZ0ICsgInB4KSIgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlQ2xpcCggdGhpcy5jc3MoICJjbGlwIiApLCB0aGlzICk7DQogICAgICAgICAgICB9LA0KDQogICAgICAgICAgICB0cmFuc2ZlcjogZnVuY3Rpb24oIG9wdGlvbnMsIGRvbmUgKSB7DQogICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSAkKCB0aGlzICksDQogICAgICAgICAgICAgICAgICAgIHRhcmdldCA9ICQoIG9wdGlvbnMudG8gKSwNCiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Rml4ZWQgPSB0YXJnZXQuY3NzKCAicG9zaXRpb24iICkgPT09ICJmaXhlZCIsDQogICAgICAgICAgICAgICAgICAgIGJvZHkgPSAkKCAiYm9keSIgKSwNCiAgICAgICAgICAgICAgICAgICAgZml4VG9wID0gdGFyZ2V0Rml4ZWQgPyBib2R5LnNjcm9sbFRvcCgpIDogMCwNCiAgICAgICAgICAgICAgICAgICAgZml4TGVmdCA9IHRhcmdldEZpeGVkID8gYm9keS5zY3JvbGxMZWZ0KCkgOiAwLA0KICAgICAgICAgICAgICAgICAgICBlbmRQb3NpdGlvbiA9IHRhcmdldC5vZmZzZXQoKSwNCiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiBlbmRQb3NpdGlvbi50b3AgLSBmaXhUb3AsDQogICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBlbmRQb3NpdGlvbi5sZWZ0IC0gZml4TGVmdCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogdGFyZ2V0LmlubmVySGVpZ2h0KCksDQogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogdGFyZ2V0LmlubmVyV2lkdGgoKQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBzdGFydFBvc2l0aW9uID0gZWxlbWVudC5vZmZzZXQoKSwNCiAgICAgICAgICAgICAgICAgICAgdHJhbnNmZXIgPSAkKCAiPGRpdiBjbGFzcz0ndWktZWZmZWN0cy10cmFuc2Zlcic+PC9kaXY+IiApDQogICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kVG8oICJib2R5IiApDQogICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoIG9wdGlvbnMuY2xhc3NOYW1lICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5jc3MoIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHN0YXJ0UG9zaXRpb24udG9wIC0gZml4VG9wLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IHN0YXJ0UG9zaXRpb24ubGVmdCAtIGZpeExlZnQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBlbGVtZW50LmlubmVySGVpZ2h0KCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGVsZW1lbnQuaW5uZXJXaWR0aCgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0YXJnZXRGaXhlZCA/ICJmaXhlZCIgOiAiYWJzb2x1dGUiDQogICAgICAgICAgICAgICAgICAgICAgICB9ICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5hbmltYXRlKCBhbmltYXRpb24sIG9wdGlvbnMuZHVyYXRpb24sIG9wdGlvbnMuZWFzaW5nLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zlci5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoICQuaXNGdW5jdGlvbiggZG9uZSApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9ICk7DQoNCiAgICAgICAgZnVuY3Rpb24gcGFyc2VDbGlwKCBzdHIsIGVsZW1lbnQgKSB7DQogICAgICAgICAgICB2YXIgb3V0ZXJXaWR0aCA9IGVsZW1lbnQub3V0ZXJXaWR0aCgpLA0KICAgICAgICAgICAgICAgIG91dGVySGVpZ2h0ID0gZWxlbWVudC5vdXRlckhlaWdodCgpLA0KICAgICAgICAgICAgICAgIGNsaXBSZWdleCA9IC9ecmVjdFwoKC0/XGQqXC4/XGQqcHh8LT9cZCslfGF1dG8pLD9ccyooLT9cZCpcLj9cZCpweHwtP1xkKyV8YXV0byksP1xzKigtP1xkKlwuP1xkKnB4fC0/XGQrJXxhdXRvKSw/XHMqKC0/XGQqXC4/XGQqcHh8LT9cZCslfGF1dG8pXCkkLywNCiAgICAgICAgICAgICAgICB2YWx1ZXMgPSBjbGlwUmVnZXguZXhlYyggc3RyICkgfHwgWyAiIiwgMCwgb3V0ZXJXaWR0aCwgb3V0ZXJIZWlnaHQsIDAgXTsNCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICB0b3A6IHBhcnNlRmxvYXQoIHZhbHVlc1sgMSBdICkgfHwgMCwNCiAgICAgICAgICAgICAgICByaWdodDogdmFsdWVzWyAyIF0gPT09ICJhdXRvIiA/IG91dGVyV2lkdGggOiBwYXJzZUZsb2F0KCB2YWx1ZXNbIDIgXSApLA0KICAgICAgICAgICAgICAgIGJvdHRvbTogdmFsdWVzWyAzIF0gPT09ICJhdXRvIiA/IG91dGVySGVpZ2h0IDogcGFyc2VGbG9hdCggdmFsdWVzWyAzIF0gKSwNCiAgICAgICAgICAgICAgICBsZWZ0OiBwYXJzZUZsb2F0KCB2YWx1ZXNbIDQgXSApIHx8IDANCiAgICAgICAgICAgIH07DQogICAgICAgIH0NCg0KICAgICAgICAkLmZ4LnN0ZXAuY2xpcCA9IGZ1bmN0aW9uKCBmeCApIHsNCiAgICAgICAgICAgIGlmICggIWZ4LmNsaXBJbml0ICkgew0KICAgICAgICAgICAgICAgIGZ4LnN0YXJ0ID0gJCggZnguZWxlbSApLmNzc0NsaXAoKTsNCiAgICAgICAgICAgICAgICBpZiAoIHR5cGVvZiBmeC5lbmQgPT09ICJzdHJpbmciICkgew0KICAgICAgICAgICAgICAgICAgICBmeC5lbmQgPSBwYXJzZUNsaXAoIGZ4LmVuZCwgZnguZWxlbSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmeC5jbGlwSW5pdCA9IHRydWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICQoIGZ4LmVsZW0gKS5jc3NDbGlwKCB7DQogICAgICAgICAgICAgICAgdG9wOiBmeC5wb3MgKiAoIGZ4LmVuZC50b3AgLSBmeC5zdGFydC50b3AgKSArIGZ4LnN0YXJ0LnRvcCwNCiAgICAgICAgICAgICAgICByaWdodDogZngucG9zICogKCBmeC5lbmQucmlnaHQgLSBmeC5zdGFydC5yaWdodCApICsgZnguc3RhcnQucmlnaHQsDQogICAgICAgICAgICAgICAgYm90dG9tOiBmeC5wb3MgKiAoIGZ4LmVuZC5ib3R0b20gLSBmeC5zdGFydC5ib3R0b20gKSArIGZ4LnN0YXJ0LmJvdHRvbSwNCiAgICAgICAgICAgICAgICBsZWZ0OiBmeC5wb3MgKiAoIGZ4LmVuZC5sZWZ0IC0gZnguc3RhcnQubGVmdCApICsgZnguc3RhcnQubGVmdA0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9Ow0KDQogICAgfSApKCk7DQoNCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBFQVNJTkcgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovDQogICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICggZnVuY3Rpb24oKSB7DQoNCi8vIEJhc2VkIG9uIGVhc2luZyBlcXVhdGlvbnMgZnJvbSBSb2JlcnQgUGVubmVyIChodHRwOi8vd3d3LnJvYmVydHBlbm5lci5jb20vZWFzaW5nKQ0KDQogICAgICAgIHZhciBiYXNlRWFzaW5ncyA9IHt9Ow0KDQogICAgICAgICQuZWFjaCggWyAiUXVhZCIsICJDdWJpYyIsICJRdWFydCIsICJRdWludCIsICJFeHBvIiBdLCBmdW5jdGlvbiggaSwgbmFtZSApIHsNCiAgICAgICAgICAgIGJhc2VFYXNpbmdzWyBuYW1lIF0gPSBmdW5jdGlvbiggcCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5wb3coIHAsIGkgKyAyICk7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9ICk7DQoNCiAgICAgICAgJC5leHRlbmQoIGJhc2VFYXNpbmdzLCB7DQogICAgICAgICAgICBTaW5lOiBmdW5jdGlvbiggcCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gMSAtIE1hdGguY29zKCBwICogTWF0aC5QSSAvIDIgKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBDaXJjOiBmdW5jdGlvbiggcCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gMSAtIE1hdGguc3FydCggMSAtIHAgKiBwICk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgRWxhc3RpYzogZnVuY3Rpb24oIHAgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHAgPT09IDAgfHwgcCA9PT0gMSA/IHAgOg0KICAgICAgICAgICAgICAgICAgICAtTWF0aC5wb3coIDIsIDggKiAoIHAgLSAxICkgKSAqIE1hdGguc2luKCAoICggcCAtIDEgKSAqIDgwIC0gNy41ICkgKiBNYXRoLlBJIC8gMTUgKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBCYWNrOiBmdW5jdGlvbiggcCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gcCAqIHAgKiAoIDMgKiBwIC0gMiApOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIEJvdW5jZTogZnVuY3Rpb24oIHAgKSB7DQogICAgICAgICAgICAgICAgdmFyIHBvdzIsDQogICAgICAgICAgICAgICAgICAgIGJvdW5jZSA9IDQ7DQoNCiAgICAgICAgICAgICAgICB3aGlsZSAoIHAgPCAoICggcG93MiA9IE1hdGgucG93KCAyLCAtLWJvdW5jZSApICkgLSAxICkgLyAxMSApIHt9DQogICAgICAgICAgICAgICAgcmV0dXJuIDEgLyBNYXRoLnBvdyggNCwgMyAtIGJvdW5jZSApIC0gNy41NjI1ICogTWF0aC5wb3coICggcG93MiAqIDMgLSAyICkgLyAyMiAtIHAsIDIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSApOw0KDQogICAgICAgICQuZWFjaCggYmFzZUVhc2luZ3MsIGZ1bmN0aW9uKCBuYW1lLCBlYXNlSW4gKSB7DQogICAgICAgICAgICAkLmVhc2luZ1sgImVhc2VJbiIgKyBuYW1lIF0gPSBlYXNlSW47DQogICAgICAgICAgICAkLmVhc2luZ1sgImVhc2VPdXQiICsgbmFtZSBdID0gZnVuY3Rpb24oIHAgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIDEgLSBlYXNlSW4oIDEgLSBwICk7DQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgJC5lYXNpbmdbICJlYXNlSW5PdXQiICsgbmFtZSBdID0gZnVuY3Rpb24oIHAgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHAgPCAwLjUgPw0KICAgICAgICAgICAgICAgICAgICBlYXNlSW4oIHAgKiAyICkgLyAyIDoNCiAgICAgICAgICAgICAgICAgICAgMSAtIGVhc2VJbiggcCAqIC0yICsgMiApIC8gMjsNCiAgICAgICAgICAgIH07DQogICAgICAgIH0gKTsNCg0KICAgIH0gKSgpOw0KDQogICAgdmFyIGVmZmVjdCA9ICQuZWZmZWN0czsNCg0KDQogICAgLyohDQogKiBqUXVlcnkgVUkgRWZmZWN0cyBCbGluZCAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogQmxpbmQgRWZmZWN0DQovLz4+Z3JvdXA6IEVmZmVjdHMNCi8vPj5kZXNjcmlwdGlvbjogQmxpbmRzIHRoZSBlbGVtZW50Lg0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2JsaW5kLWVmZmVjdC8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9lZmZlY3QvDQoNCg0KDQogICAgdmFyIGVmZmVjdHNFZmZlY3RCbGluZCA9ICQuZWZmZWN0cy5kZWZpbmUoICJibGluZCIsICJoaWRlIiwgZnVuY3Rpb24oIG9wdGlvbnMsIGRvbmUgKSB7DQogICAgICAgIHZhciBtYXAgPSB7DQogICAgICAgICAgICAgICAgdXA6IFsgImJvdHRvbSIsICJ0b3AiIF0sDQogICAgICAgICAgICAgICAgdmVydGljYWw6IFsgImJvdHRvbSIsICJ0b3AiIF0sDQogICAgICAgICAgICAgICAgZG93bjogWyAidG9wIiwgImJvdHRvbSIgXSwNCiAgICAgICAgICAgICAgICBsZWZ0OiBbICJyaWdodCIsICJsZWZ0IiBdLA0KICAgICAgICAgICAgICAgIGhvcml6b250YWw6IFsgInJpZ2h0IiwgImxlZnQiIF0sDQogICAgICAgICAgICAgICAgcmlnaHQ6IFsgImxlZnQiLCAicmlnaHQiIF0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBlbGVtZW50ID0gJCggdGhpcyApLA0KICAgICAgICAgICAgZGlyZWN0aW9uID0gb3B0aW9ucy5kaXJlY3Rpb24gfHwgInVwIiwNCiAgICAgICAgICAgIHN0YXJ0ID0gZWxlbWVudC5jc3NDbGlwKCksDQogICAgICAgICAgICBhbmltYXRlID0geyBjbGlwOiAkLmV4dGVuZCgge30sIHN0YXJ0ICkgfSwNCiAgICAgICAgICAgIHBsYWNlaG9sZGVyID0gJC5lZmZlY3RzLmNyZWF0ZVBsYWNlaG9sZGVyKCBlbGVtZW50ICk7DQoNCiAgICAgICAgYW5pbWF0ZS5jbGlwWyBtYXBbIGRpcmVjdGlvbiBdWyAwIF0gXSA9IGFuaW1hdGUuY2xpcFsgbWFwWyBkaXJlY3Rpb24gXVsgMSBdIF07DQoNCiAgICAgICAgaWYgKCBvcHRpb25zLm1vZGUgPT09ICJzaG93IiApIHsNCiAgICAgICAgICAgIGVsZW1lbnQuY3NzQ2xpcCggYW5pbWF0ZS5jbGlwICk7DQogICAgICAgICAgICBpZiAoIHBsYWNlaG9sZGVyICkgew0KICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyLmNzcyggJC5lZmZlY3RzLmNsaXBUb0JveCggYW5pbWF0ZSApICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGFuaW1hdGUuY2xpcCA9IHN0YXJ0Ow0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCBwbGFjZWhvbGRlciApIHsNCiAgICAgICAgICAgIHBsYWNlaG9sZGVyLmFuaW1hdGUoICQuZWZmZWN0cy5jbGlwVG9Cb3goIGFuaW1hdGUgKSwgb3B0aW9ucy5kdXJhdGlvbiwgb3B0aW9ucy5lYXNpbmcgKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGVsZW1lbnQuYW5pbWF0ZSggYW5pbWF0ZSwgew0KICAgICAgICAgICAgcXVldWU6IGZhbHNlLA0KICAgICAgICAgICAgZHVyYXRpb246IG9wdGlvbnMuZHVyYXRpb24sDQogICAgICAgICAgICBlYXNpbmc6IG9wdGlvbnMuZWFzaW5nLA0KICAgICAgICAgICAgY29tcGxldGU6IGRvbmUNCiAgICAgICAgfSApOw0KICAgIH0gKTsNCg0KDQogICAgLyohDQogKiBqUXVlcnkgVUkgRWZmZWN0cyBCb3VuY2UgMS4xMi4xDQogKiBodHRwOi8vanF1ZXJ5dWkuY29tDQogKg0KICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMNCiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UNCiAqLw0KDQovLz4+bGFiZWw6IEJvdW5jZSBFZmZlY3QNCi8vPj5ncm91cDogRWZmZWN0cw0KLy8+PmRlc2NyaXB0aW9uOiBCb3VuY2VzIGFuIGVsZW1lbnQgaG9yaXpvbnRhbGx5IG9yIHZlcnRpY2FsbHkgbiB0aW1lcy4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9ib3VuY2UtZWZmZWN0Lw0KLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL2VmZmVjdC8NCg0KDQoNCiAgICB2YXIgZWZmZWN0c0VmZmVjdEJvdW5jZSA9ICQuZWZmZWN0cy5kZWZpbmUoICJib3VuY2UiLCBmdW5jdGlvbiggb3B0aW9ucywgZG9uZSApIHsNCiAgICAgICAgdmFyIHVwQW5pbSwgZG93bkFuaW0sIHJlZlZhbHVlLA0KICAgICAgICAgICAgZWxlbWVudCA9ICQoIHRoaXMgKSwNCg0KICAgICAgICAgICAgLy8gRGVmYXVsdHM6DQogICAgICAgICAgICBtb2RlID0gb3B0aW9ucy5tb2RlLA0KICAgICAgICAgICAgaGlkZSA9IG1vZGUgPT09ICJoaWRlIiwNCiAgICAgICAgICAgIHNob3cgPSBtb2RlID09PSAic2hvdyIsDQogICAgICAgICAgICBkaXJlY3Rpb24gPSBvcHRpb25zLmRpcmVjdGlvbiB8fCAidXAiLA0KICAgICAgICAgICAgZGlzdGFuY2UgPSBvcHRpb25zLmRpc3RhbmNlLA0KICAgICAgICAgICAgdGltZXMgPSBvcHRpb25zLnRpbWVzIHx8IDUsDQoNCiAgICAgICAgICAgIC8vIE51bWJlciBvZiBpbnRlcm5hbCBhbmltYXRpb25zDQogICAgICAgICAgICBhbmltcyA9IHRpbWVzICogMiArICggc2hvdyB8fCBoaWRlID8gMSA6IDAgKSwNCiAgICAgICAgICAgIHNwZWVkID0gb3B0aW9ucy5kdXJhdGlvbiAvIGFuaW1zLA0KICAgICAgICAgICAgZWFzaW5nID0gb3B0aW9ucy5lYXNpbmcsDQoNCiAgICAgICAgICAgIC8vIFV0aWxpdHk6DQogICAgICAgICAgICByZWYgPSAoIGRpcmVjdGlvbiA9PT0gInVwIiB8fCBkaXJlY3Rpb24gPT09ICJkb3duIiApID8gInRvcCIgOiAibGVmdCIsDQogICAgICAgICAgICBtb3Rpb24gPSAoIGRpcmVjdGlvbiA9PT0gInVwIiB8fCBkaXJlY3Rpb24gPT09ICJsZWZ0IiApLA0KICAgICAgICAgICAgaSA9IDAsDQoNCiAgICAgICAgICAgIHF1ZXVlbGVuID0gZWxlbWVudC5xdWV1ZSgpLmxlbmd0aDsNCg0KICAgICAgICAkLmVmZmVjdHMuY3JlYXRlUGxhY2Vob2xkZXIoIGVsZW1lbnQgKTsNCg0KICAgICAgICByZWZWYWx1ZSA9IGVsZW1lbnQuY3NzKCByZWYgKTsNCg0KICAgICAgICAvLyBEZWZhdWx0IGRpc3RhbmNlIGZvciB0aGUgQklHR0VTVCBib3VuY2UgaXMgdGhlIG91dGVyIERpc3RhbmNlIC8gMw0KICAgICAgICBpZiAoICFkaXN0YW5jZSApIHsNCiAgICAgICAgICAgIGRpc3RhbmNlID0gZWxlbWVudFsgcmVmID09PSAidG9wIiA/ICJvdXRlckhlaWdodCIgOiAib3V0ZXJXaWR0aCIgXSgpIC8gMzsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICggc2hvdyApIHsNCiAgICAgICAgICAgIGRvd25BbmltID0geyBvcGFjaXR5OiAxIH07DQogICAgICAgICAgICBkb3duQW5pbVsgcmVmIF0gPSByZWZWYWx1ZTsNCg0KICAgICAgICAgICAgLy8gSWYgd2UgYXJlIHNob3dpbmcsIGZvcmNlIG9wYWNpdHkgMCBhbmQgc2V0IHRoZSBpbml0aWFsIHBvc2l0aW9uDQogICAgICAgICAgICAvLyB0aGVuIGRvIHRoZSAiZmlyc3QiIGFuaW1hdGlvbg0KICAgICAgICAgICAgZWxlbWVudA0KICAgICAgICAgICAgICAgIC5jc3MoICJvcGFjaXR5IiwgMCApDQogICAgICAgICAgICAgICAgLmNzcyggcmVmLCBtb3Rpb24gPyAtZGlzdGFuY2UgKiAyIDogZGlzdGFuY2UgKiAyICkNCiAgICAgICAgICAgICAgICAuYW5pbWF0ZSggZG93bkFuaW0sIHNwZWVkLCBlYXNpbmcgKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN0YXJ0IGF0IHRoZSBzbWFsbGVzdCBkaXN0YW5jZSBpZiB3ZSBhcmUgaGlkaW5nDQogICAgICAgIGlmICggaGlkZSApIHsNCiAgICAgICAgICAgIGRpc3RhbmNlID0gZGlzdGFuY2UgLyBNYXRoLnBvdyggMiwgdGltZXMgLSAxICk7DQogICAgICAgIH0NCg0KICAgICAgICBkb3duQW5pbSA9IHt9Ow0KICAgICAgICBkb3duQW5pbVsgcmVmIF0gPSByZWZWYWx1ZTsNCg0KICAgICAgICAvLyBCb3VuY2VzIHVwL2Rvd24vbGVmdC9yaWdodCB0aGVuIGJhY2sgdG8gMCAtLSB0aW1lcyAqIDIgYW5pbWF0aW9ucyBoYXBwZW4gaGVyZQ0KICAgICAgICBmb3IgKCA7IGkgPCB0aW1lczsgaSsrICkgew0KICAgICAgICAgICAgdXBBbmltID0ge307DQogICAgICAgICAgICB1cEFuaW1bIHJlZiBdID0gKCBtb3Rpb24gPyAiLT0iIDogIis9IiApICsgZGlzdGFuY2U7DQoNCiAgICAgICAgICAgIGVsZW1lbnQNCiAgICAgICAgICAgICAgICAuYW5pbWF0ZSggdXBBbmltLCBzcGVlZCwgZWFzaW5nICkNCiAgICAgICAgICAgICAgICAuYW5pbWF0ZSggZG93bkFuaW0sIHNwZWVkLCBlYXNpbmcgKTsNCg0KICAgICAgICAgICAgZGlzdGFuY2UgPSBoaWRlID8gZGlzdGFuY2UgKiAyIDogZGlzdGFuY2UgLyAyOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gTGFzdCBCb3VuY2Ugd2hlbiBIaWRpbmcNCiAgICAgICAgaWYgKCBoaWRlICkgew0KICAgICAgICAgICAgdXBBbmltID0geyBvcGFjaXR5OiAwIH07DQogICAgICAgICAgICB1cEFuaW1bIHJlZiBdID0gKCBtb3Rpb24gPyAiLT0iIDogIis9IiApICsgZGlzdGFuY2U7DQoNCiAgICAgICAgICAgIGVsZW1lbnQuYW5pbWF0ZSggdXBBbmltLCBzcGVlZCwgZWFzaW5nICk7DQogICAgICAgIH0NCg0KICAgICAgICBlbGVtZW50LnF1ZXVlKCBkb25lICk7DQoNCiAgICAgICAgJC5lZmZlY3RzLnVuc2hpZnQoIGVsZW1lbnQsIHF1ZXVlbGVuLCBhbmltcyArIDEgKTsNCiAgICB9ICk7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIEVmZmVjdHMgQ2xpcCAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogQ2xpcCBFZmZlY3QNCi8vPj5ncm91cDogRWZmZWN0cw0KLy8+PmRlc2NyaXB0aW9uOiBDbGlwcyB0aGUgZWxlbWVudCBvbiBhbmQgb2ZmIGxpa2UgYW4gb2xkIFRWLg0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2NsaXAtZWZmZWN0Lw0KLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL2VmZmVjdC8NCg0KDQoNCiAgICB2YXIgZWZmZWN0c0VmZmVjdENsaXAgPSAkLmVmZmVjdHMuZGVmaW5lKCAiY2xpcCIsICJoaWRlIiwgZnVuY3Rpb24oIG9wdGlvbnMsIGRvbmUgKSB7DQogICAgICAgIHZhciBzdGFydCwNCiAgICAgICAgICAgIGFuaW1hdGUgPSB7fSwNCiAgICAgICAgICAgIGVsZW1lbnQgPSAkKCB0aGlzICksDQogICAgICAgICAgICBkaXJlY3Rpb24gPSBvcHRpb25zLmRpcmVjdGlvbiB8fCAidmVydGljYWwiLA0KICAgICAgICAgICAgYm90aCA9IGRpcmVjdGlvbiA9PT0gImJvdGgiLA0KICAgICAgICAgICAgaG9yaXpvbnRhbCA9IGJvdGggfHwgZGlyZWN0aW9uID09PSAiaG9yaXpvbnRhbCIsDQogICAgICAgICAgICB2ZXJ0aWNhbCA9IGJvdGggfHwgZGlyZWN0aW9uID09PSAidmVydGljYWwiOw0KDQogICAgICAgIHN0YXJ0ID0gZWxlbWVudC5jc3NDbGlwKCk7DQogICAgICAgIGFuaW1hdGUuY2xpcCA9IHsNCiAgICAgICAgICAgIHRvcDogdmVydGljYWwgPyAoIHN0YXJ0LmJvdHRvbSAtIHN0YXJ0LnRvcCApIC8gMiA6IHN0YXJ0LnRvcCwNCiAgICAgICAgICAgIHJpZ2h0OiBob3Jpem9udGFsID8gKCBzdGFydC5yaWdodCAtIHN0YXJ0LmxlZnQgKSAvIDIgOiBzdGFydC5yaWdodCwNCiAgICAgICAgICAgIGJvdHRvbTogdmVydGljYWwgPyAoIHN0YXJ0LmJvdHRvbSAtIHN0YXJ0LnRvcCApIC8gMiA6IHN0YXJ0LmJvdHRvbSwNCiAgICAgICAgICAgIGxlZnQ6IGhvcml6b250YWwgPyAoIHN0YXJ0LnJpZ2h0IC0gc3RhcnQubGVmdCApIC8gMiA6IHN0YXJ0LmxlZnQNCiAgICAgICAgfTsNCg0KICAgICAgICAkLmVmZmVjdHMuY3JlYXRlUGxhY2Vob2xkZXIoIGVsZW1lbnQgKTsNCg0KICAgICAgICBpZiAoIG9wdGlvbnMubW9kZSA9PT0gInNob3ciICkgew0KICAgICAgICAgICAgZWxlbWVudC5jc3NDbGlwKCBhbmltYXRlLmNsaXAgKTsNCiAgICAgICAgICAgIGFuaW1hdGUuY2xpcCA9IHN0YXJ0Ow0KICAgICAgICB9DQoNCiAgICAgICAgZWxlbWVudC5hbmltYXRlKCBhbmltYXRlLCB7DQogICAgICAgICAgICBxdWV1ZTogZmFsc2UsDQogICAgICAgICAgICBkdXJhdGlvbjogb3B0aW9ucy5kdXJhdGlvbiwNCiAgICAgICAgICAgIGVhc2luZzogb3B0aW9ucy5lYXNpbmcsDQogICAgICAgICAgICBjb21wbGV0ZTogZG9uZQ0KICAgICAgICB9ICk7DQoNCiAgICB9ICk7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIEVmZmVjdHMgRHJvcCAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogRHJvcCBFZmZlY3QNCi8vPj5ncm91cDogRWZmZWN0cw0KLy8+PmRlc2NyaXB0aW9uOiBNb3ZlcyBhbiBlbGVtZW50IGluIG9uZSBkaXJlY3Rpb24gYW5kIGhpZGVzIGl0IGF0IHRoZSBzYW1lIHRpbWUuDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZHJvcC1lZmZlY3QvDQovLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vZWZmZWN0Lw0KDQoNCg0KICAgIHZhciBlZmZlY3RzRWZmZWN0RHJvcCA9ICQuZWZmZWN0cy5kZWZpbmUoICJkcm9wIiwgImhpZGUiLCBmdW5jdGlvbiggb3B0aW9ucywgZG9uZSApIHsNCg0KICAgICAgICB2YXIgZGlzdGFuY2UsDQogICAgICAgICAgICBlbGVtZW50ID0gJCggdGhpcyApLA0KICAgICAgICAgICAgbW9kZSA9IG9wdGlvbnMubW9kZSwNCiAgICAgICAgICAgIHNob3cgPSBtb2RlID09PSAic2hvdyIsDQogICAgICAgICAgICBkaXJlY3Rpb24gPSBvcHRpb25zLmRpcmVjdGlvbiB8fCAibGVmdCIsDQogICAgICAgICAgICByZWYgPSAoIGRpcmVjdGlvbiA9PT0gInVwIiB8fCBkaXJlY3Rpb24gPT09ICJkb3duIiApID8gInRvcCIgOiAibGVmdCIsDQogICAgICAgICAgICBtb3Rpb24gPSAoIGRpcmVjdGlvbiA9PT0gInVwIiB8fCBkaXJlY3Rpb24gPT09ICJsZWZ0IiApID8gIi09IiA6ICIrPSIsDQogICAgICAgICAgICBvcHBvc2l0ZU1vdGlvbiA9ICggbW90aW9uID09PSAiKz0iICkgPyAiLT0iIDogIis9IiwNCiAgICAgICAgICAgIGFuaW1hdGlvbiA9IHsNCiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwDQogICAgICAgICAgICB9Ow0KDQogICAgICAgICQuZWZmZWN0cy5jcmVhdGVQbGFjZWhvbGRlciggZWxlbWVudCApOw0KDQogICAgICAgIGRpc3RhbmNlID0gb3B0aW9ucy5kaXN0YW5jZSB8fA0KICAgICAgICAgICAgZWxlbWVudFsgcmVmID09PSAidG9wIiA/ICJvdXRlckhlaWdodCIgOiAib3V0ZXJXaWR0aCIgXSggdHJ1ZSApIC8gMjsNCg0KICAgICAgICBhbmltYXRpb25bIHJlZiBdID0gbW90aW9uICsgZGlzdGFuY2U7DQoNCiAgICAgICAgaWYgKCBzaG93ICkgew0KICAgICAgICAgICAgZWxlbWVudC5jc3MoIGFuaW1hdGlvbiApOw0KDQogICAgICAgICAgICBhbmltYXRpb25bIHJlZiBdID0gb3Bwb3NpdGVNb3Rpb24gKyBkaXN0YW5jZTsNCiAgICAgICAgICAgIGFuaW1hdGlvbi5vcGFjaXR5ID0gMTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEFuaW1hdGUNCiAgICAgICAgZWxlbWVudC5hbmltYXRlKCBhbmltYXRpb24sIHsNCiAgICAgICAgICAgIHF1ZXVlOiBmYWxzZSwNCiAgICAgICAgICAgIGR1cmF0aW9uOiBvcHRpb25zLmR1cmF0aW9uLA0KICAgICAgICAgICAgZWFzaW5nOiBvcHRpb25zLmVhc2luZywNCiAgICAgICAgICAgIGNvbXBsZXRlOiBkb25lDQogICAgICAgIH0gKTsNCiAgICB9ICk7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIEVmZmVjdHMgRXhwbG9kZSAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogRXhwbG9kZSBFZmZlY3QNCi8vPj5ncm91cDogRWZmZWN0cw0KLy8ganNjczpkaXNhYmxlIG1heGltdW1MaW5lTGVuZ3RoDQovLz4+ZGVzY3JpcHRpb246IEV4cGxvZGVzIGFuIGVsZW1lbnQgaW4gYWxsIGRpcmVjdGlvbnMgaW50byBuIHBpZWNlcy4gSW1wbG9kZXMgYW4gZWxlbWVudCB0byBpdHMgb3JpZ2luYWwgd2hvbGVuZXNzLg0KLy8ganNjczplbmFibGUgbWF4aW11bUxpbmVMZW5ndGgNCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9leHBsb2RlLWVmZmVjdC8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9lZmZlY3QvDQoNCg0KDQogICAgdmFyIGVmZmVjdHNFZmZlY3RFeHBsb2RlID0gJC5lZmZlY3RzLmRlZmluZSggImV4cGxvZGUiLCAiaGlkZSIsIGZ1bmN0aW9uKCBvcHRpb25zLCBkb25lICkgew0KDQogICAgICAgIHZhciBpLCBqLCBsZWZ0LCB0b3AsIG14LCBteSwNCiAgICAgICAgICAgIHJvd3MgPSBvcHRpb25zLnBpZWNlcyA/IE1hdGgucm91bmQoIE1hdGguc3FydCggb3B0aW9ucy5waWVjZXMgKSApIDogMywNCiAgICAgICAgICAgIGNlbGxzID0gcm93cywNCiAgICAgICAgICAgIGVsZW1lbnQgPSAkKCB0aGlzICksDQogICAgICAgICAgICBtb2RlID0gb3B0aW9ucy5tb2RlLA0KICAgICAgICAgICAgc2hvdyA9IG1vZGUgPT09ICJzaG93IiwNCg0KICAgICAgICAgICAgLy8gU2hvdyBhbmQgdGhlbiB2aXNpYmlsaXR5OmhpZGRlbiB0aGUgZWxlbWVudCBiZWZvcmUgY2FsY3VsYXRpbmcgb2Zmc2V0DQogICAgICAgICAgICBvZmZzZXQgPSBlbGVtZW50LnNob3coKS5jc3MoICJ2aXNpYmlsaXR5IiwgImhpZGRlbiIgKS5vZmZzZXQoKSwNCg0KICAgICAgICAgICAgLy8gV2lkdGggYW5kIGhlaWdodCBvZiBhIHBpZWNlDQogICAgICAgICAgICB3aWR0aCA9IE1hdGguY2VpbCggZWxlbWVudC5vdXRlcldpZHRoKCkgLyBjZWxscyApLA0KICAgICAgICAgICAgaGVpZ2h0ID0gTWF0aC5jZWlsKCBlbGVtZW50Lm91dGVySGVpZ2h0KCkgLyByb3dzICksDQogICAgICAgICAgICBwaWVjZXMgPSBbXTsNCg0KICAgICAgICAvLyBDaGlsZHJlbiBhbmltYXRlIGNvbXBsZXRlOg0KICAgICAgICBmdW5jdGlvbiBjaGlsZENvbXBsZXRlKCkgew0KICAgICAgICAgICAgcGllY2VzLnB1c2goIHRoaXMgKTsNCiAgICAgICAgICAgIGlmICggcGllY2VzLmxlbmd0aCA9PT0gcm93cyAqIGNlbGxzICkgew0KICAgICAgICAgICAgICAgIGFuaW1Db21wbGV0ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQ2xvbmUgdGhlIGVsZW1lbnQgZm9yIGVhY2ggcm93IGFuZCBjZWxsLg0KICAgICAgICBmb3IgKCBpID0gMDsgaSA8IHJvd3M7IGkrKyApIHsgLy8gPT09Pg0KICAgICAgICAgICAgdG9wID0gb2Zmc2V0LnRvcCArIGkgKiBoZWlnaHQ7DQogICAgICAgICAgICBteSA9IGkgLSAoIHJvd3MgLSAxICkgLyAyOw0KDQogICAgICAgICAgICBmb3IgKCBqID0gMDsgaiA8IGNlbGxzOyBqKysgKSB7IC8vIHx8fA0KICAgICAgICAgICAgICAgIGxlZnQgPSBvZmZzZXQubGVmdCArIGogKiB3aWR0aDsNCiAgICAgICAgICAgICAgICBteCA9IGogLSAoIGNlbGxzIC0gMSApIC8gMjsNCg0KICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhIGNsb25lIG9mIHRoZSBub3cgaGlkZGVuIG1haW4gZWxlbWVudCB0aGF0IHdpbGwgYmUgYWJzb2x1dGUgcG9zaXRpb25lZA0KICAgICAgICAgICAgICAgIC8vIHdpdGhpbiBhIHdyYXBwZXIgZGl2IG9mZiB0aGUgLWxlZnQgYW5kIC10b3AgZXF1YWwgdG8gc2l6ZSBvZiBvdXIgcGllY2VzDQogICAgICAgICAgICAgICAgZWxlbWVudA0KICAgICAgICAgICAgICAgICAgICAuY2xvbmUoKQ0KICAgICAgICAgICAgICAgICAgICAuYXBwZW5kVG8oICJib2R5IiApDQogICAgICAgICAgICAgICAgICAgIC53cmFwKCAiPGRpdj48L2Rpdj4iICkNCiAgICAgICAgICAgICAgICAgICAgLmNzcyggew0KICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJhYnNvbHV0ZSIsDQogICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiAidmlzaWJsZSIsDQogICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAtaiAqIHdpZHRoLA0KICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAtaSAqIGhlaWdodA0KICAgICAgICAgICAgICAgICAgICB9ICkNCg0KICAgICAgICAgICAgICAgICAgICAvLyBTZWxlY3QgdGhlIHdyYXBwZXIgLSBtYWtlIGl0IG92ZXJmbG93OiBoaWRkZW4gYW5kIGFic29sdXRlIHBvc2l0aW9uZWQgYmFzZWQgb24NCiAgICAgICAgICAgICAgICAgICAgLy8gd2hlcmUgdGhlIG9yaWdpbmFsIHdhcyBsb2NhdGVkICtsZWZ0IGFuZCArdG9wIGVxdWFsIHRvIHRoZSBzaXplIG9mIHBpZWNlcw0KICAgICAgICAgICAgICAgICAgICAucGFyZW50KCkNCiAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKCAidWktZWZmZWN0cy1leHBsb2RlIiApDQogICAgICAgICAgICAgICAgICAgIC5jc3MoIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAiYWJzb2x1dGUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3c6ICJoaWRkZW4iLA0KICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoLA0KICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsDQogICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBsZWZ0ICsgKCBzaG93ID8gbXggKiB3aWR0aCA6IDAgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogdG9wICsgKCBzaG93ID8gbXkgKiBoZWlnaHQgOiAwICksDQogICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiBzaG93ID8gMCA6IDENCiAgICAgICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgICAgIC5hbmltYXRlKCB7DQogICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBsZWZ0ICsgKCBzaG93ID8gMCA6IG14ICogd2lkdGggKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogdG9wICsgKCBzaG93ID8gMCA6IG15ICogaGVpZ2h0ICksDQogICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiBzaG93ID8gMSA6IDANCiAgICAgICAgICAgICAgICAgICAgfSwgb3B0aW9ucy5kdXJhdGlvbiB8fCA1MDAsIG9wdGlvbnMuZWFzaW5nLCBjaGlsZENvbXBsZXRlICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBmdW5jdGlvbiBhbmltQ29tcGxldGUoKSB7DQogICAgICAgICAgICBlbGVtZW50LmNzcyggew0KICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6ICJ2aXNpYmxlIg0KICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgJCggcGllY2VzICkucmVtb3ZlKCk7DQogICAgICAgICAgICBkb25lKCk7DQogICAgICAgIH0NCiAgICB9ICk7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIEVmZmVjdHMgRmFkZSAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogRmFkZSBFZmZlY3QNCi8vPj5ncm91cDogRWZmZWN0cw0KLy8+PmRlc2NyaXB0aW9uOiBGYWRlcyB0aGUgZWxlbWVudC4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9mYWRlLWVmZmVjdC8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9lZmZlY3QvDQoNCg0KDQogICAgdmFyIGVmZmVjdHNFZmZlY3RGYWRlID0gJC5lZmZlY3RzLmRlZmluZSggImZhZGUiLCAidG9nZ2xlIiwgZnVuY3Rpb24oIG9wdGlvbnMsIGRvbmUgKSB7DQogICAgICAgIHZhciBzaG93ID0gb3B0aW9ucy5tb2RlID09PSAic2hvdyI7DQoNCiAgICAgICAgJCggdGhpcyApDQogICAgICAgICAgICAuY3NzKCAib3BhY2l0eSIsIHNob3cgPyAwIDogMSApDQogICAgICAgICAgICAuYW5pbWF0ZSggew0KICAgICAgICAgICAgICAgIG9wYWNpdHk6IHNob3cgPyAxIDogMA0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIHF1ZXVlOiBmYWxzZSwNCiAgICAgICAgICAgICAgICBkdXJhdGlvbjogb3B0aW9ucy5kdXJhdGlvbiwNCiAgICAgICAgICAgICAgICBlYXNpbmc6IG9wdGlvbnMuZWFzaW5nLA0KICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBkb25lDQogICAgICAgICAgICB9ICk7DQogICAgfSApOw0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBFZmZlY3RzIEZvbGQgMS4xMi4xDQogKiBodHRwOi8vanF1ZXJ5dWkuY29tDQogKg0KICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMNCiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UNCiAqLw0KDQovLz4+bGFiZWw6IEZvbGQgRWZmZWN0DQovLz4+Z3JvdXA6IEVmZmVjdHMNCi8vPj5kZXNjcmlwdGlvbjogRm9sZHMgYW4gZWxlbWVudCBmaXJzdCBob3Jpem9udGFsbHkgYW5kIHRoZW4gdmVydGljYWxseS4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9mb2xkLWVmZmVjdC8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9lZmZlY3QvDQoNCg0KDQogICAgdmFyIGVmZmVjdHNFZmZlY3RGb2xkID0gJC5lZmZlY3RzLmRlZmluZSggImZvbGQiLCAiaGlkZSIsIGZ1bmN0aW9uKCBvcHRpb25zLCBkb25lICkgew0KDQogICAgICAgIC8vIENyZWF0ZSBlbGVtZW50DQogICAgICAgIHZhciBlbGVtZW50ID0gJCggdGhpcyApLA0KICAgICAgICAgICAgbW9kZSA9IG9wdGlvbnMubW9kZSwNCiAgICAgICAgICAgIHNob3cgPSBtb2RlID09PSAic2hvdyIsDQogICAgICAgICAgICBoaWRlID0gbW9kZSA9PT0gImhpZGUiLA0KICAgICAgICAgICAgc2l6ZSA9IG9wdGlvbnMuc2l6ZSB8fCAxNSwNCiAgICAgICAgICAgIHBlcmNlbnQgPSAvKFswLTldKyklLy5leGVjKCBzaXplICksDQogICAgICAgICAgICBob3JpekZpcnN0ID0gISFvcHRpb25zLmhvcml6Rmlyc3QsDQogICAgICAgICAgICByZWYgPSBob3JpekZpcnN0ID8gWyAicmlnaHQiLCAiYm90dG9tIiBdIDogWyAiYm90dG9tIiwgInJpZ2h0IiBdLA0KICAgICAgICAgICAgZHVyYXRpb24gPSBvcHRpb25zLmR1cmF0aW9uIC8gMiwNCg0KICAgICAgICAgICAgcGxhY2Vob2xkZXIgPSAkLmVmZmVjdHMuY3JlYXRlUGxhY2Vob2xkZXIoIGVsZW1lbnQgKSwNCg0KICAgICAgICAgICAgc3RhcnQgPSBlbGVtZW50LmNzc0NsaXAoKSwNCiAgICAgICAgICAgIGFuaW1hdGlvbjEgPSB7IGNsaXA6ICQuZXh0ZW5kKCB7fSwgc3RhcnQgKSB9LA0KICAgICAgICAgICAgYW5pbWF0aW9uMiA9IHsgY2xpcDogJC5leHRlbmQoIHt9LCBzdGFydCApIH0sDQoNCiAgICAgICAgICAgIGRpc3RhbmNlID0gWyBzdGFydFsgcmVmWyAwIF0gXSwgc3RhcnRbIHJlZlsgMSBdIF0gXSwNCg0KICAgICAgICAgICAgcXVldWVsZW4gPSBlbGVtZW50LnF1ZXVlKCkubGVuZ3RoOw0KDQogICAgICAgIGlmICggcGVyY2VudCApIHsNCiAgICAgICAgICAgIHNpemUgPSBwYXJzZUludCggcGVyY2VudFsgMSBdLCAxMCApIC8gMTAwICogZGlzdGFuY2VbIGhpZGUgPyAwIDogMSBdOw0KICAgICAgICB9DQogICAgICAgIGFuaW1hdGlvbjEuY2xpcFsgcmVmWyAwIF0gXSA9IHNpemU7DQogICAgICAgIGFuaW1hdGlvbjIuY2xpcFsgcmVmWyAwIF0gXSA9IHNpemU7DQogICAgICAgIGFuaW1hdGlvbjIuY2xpcFsgcmVmWyAxIF0gXSA9IDA7DQoNCiAgICAgICAgaWYgKCBzaG93ICkgew0KICAgICAgICAgICAgZWxlbWVudC5jc3NDbGlwKCBhbmltYXRpb24yLmNsaXAgKTsNCiAgICAgICAgICAgIGlmICggcGxhY2Vob2xkZXIgKSB7DQogICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIuY3NzKCAkLmVmZmVjdHMuY2xpcFRvQm94KCBhbmltYXRpb24yICkgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgYW5pbWF0aW9uMi5jbGlwID0gc3RhcnQ7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBBbmltYXRlDQogICAgICAgIGVsZW1lbnQNCiAgICAgICAgICAgIC5xdWV1ZSggZnVuY3Rpb24oIG5leHQgKSB7DQogICAgICAgICAgICAgICAgaWYgKCBwbGFjZWhvbGRlciApIHsNCiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXINCiAgICAgICAgICAgICAgICAgICAgICAgIC5hbmltYXRlKCAkLmVmZmVjdHMuY2xpcFRvQm94KCBhbmltYXRpb24xICksIGR1cmF0aW9uLCBvcHRpb25zLmVhc2luZyApDQogICAgICAgICAgICAgICAgICAgICAgICAuYW5pbWF0ZSggJC5lZmZlY3RzLmNsaXBUb0JveCggYW5pbWF0aW9uMiApLCBkdXJhdGlvbiwgb3B0aW9ucy5lYXNpbmcgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBuZXh0KCk7DQogICAgICAgICAgICB9ICkNCiAgICAgICAgICAgIC5hbmltYXRlKCBhbmltYXRpb24xLCBkdXJhdGlvbiwgb3B0aW9ucy5lYXNpbmcgKQ0KICAgICAgICAgICAgLmFuaW1hdGUoIGFuaW1hdGlvbjIsIGR1cmF0aW9uLCBvcHRpb25zLmVhc2luZyApDQogICAgICAgICAgICAucXVldWUoIGRvbmUgKTsNCg0KICAgICAgICAkLmVmZmVjdHMudW5zaGlmdCggZWxlbWVudCwgcXVldWVsZW4sIDQgKTsNCiAgICB9ICk7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIEVmZmVjdHMgSGlnaGxpZ2h0IDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBIaWdobGlnaHQgRWZmZWN0DQovLz4+Z3JvdXA6IEVmZmVjdHMNCi8vPj5kZXNjcmlwdGlvbjogSGlnaGxpZ2h0cyB0aGUgYmFja2dyb3VuZCBvZiBhbiBlbGVtZW50IGluIGEgZGVmaW5lZCBjb2xvciBmb3IgYSBjdXN0b20gZHVyYXRpb24uDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vaGlnaGxpZ2h0LWVmZmVjdC8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9lZmZlY3QvDQoNCg0KDQogICAgdmFyIGVmZmVjdHNFZmZlY3RIaWdobGlnaHQgPSAkLmVmZmVjdHMuZGVmaW5lKCAiaGlnaGxpZ2h0IiwgInNob3ciLCBmdW5jdGlvbiggb3B0aW9ucywgZG9uZSApIHsNCiAgICAgICAgdmFyIGVsZW1lbnQgPSAkKCB0aGlzICksDQogICAgICAgICAgICBhbmltYXRpb24gPSB7DQogICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBlbGVtZW50LmNzcyggImJhY2tncm91bmRDb2xvciIgKQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICBpZiAoIG9wdGlvbnMubW9kZSA9PT0gImhpZGUiICkgew0KICAgICAgICAgICAgYW5pbWF0aW9uLm9wYWNpdHkgPSAwOw0KICAgICAgICB9DQoNCiAgICAgICAgJC5lZmZlY3RzLnNhdmVTdHlsZSggZWxlbWVudCApOw0KDQogICAgICAgIGVsZW1lbnQNCiAgICAgICAgICAgIC5jc3MoIHsNCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U6ICJub25lIiwNCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IG9wdGlvbnMuY29sb3IgfHwgIiNmZmZmOTkiDQogICAgICAgICAgICB9ICkNCiAgICAgICAgICAgIC5hbmltYXRlKCBhbmltYXRpb24sIHsNCiAgICAgICAgICAgICAgICBxdWV1ZTogZmFsc2UsDQogICAgICAgICAgICAgICAgZHVyYXRpb246IG9wdGlvbnMuZHVyYXRpb24sDQogICAgICAgICAgICAgICAgZWFzaW5nOiBvcHRpb25zLmVhc2luZywNCiAgICAgICAgICAgICAgICBjb21wbGV0ZTogZG9uZQ0KICAgICAgICAgICAgfSApOw0KICAgIH0gKTsNCg0KDQogICAgLyohDQogKiBqUXVlcnkgVUkgRWZmZWN0cyBTaXplIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBTaXplIEVmZmVjdA0KLy8+Pmdyb3VwOiBFZmZlY3RzDQovLz4+ZGVzY3JpcHRpb246IFJlc2l6ZSBhbiBlbGVtZW50IHRvIGEgc3BlY2lmaWVkIHdpZHRoIGFuZCBoZWlnaHQuDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vc2l6ZS1lZmZlY3QvDQovLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vZWZmZWN0Lw0KDQoNCg0KICAgIHZhciBlZmZlY3RzRWZmZWN0U2l6ZSA9ICQuZWZmZWN0cy5kZWZpbmUoICJzaXplIiwgZnVuY3Rpb24oIG9wdGlvbnMsIGRvbmUgKSB7DQoNCiAgICAgICAgLy8gQ3JlYXRlIGVsZW1lbnQNCiAgICAgICAgdmFyIGJhc2VsaW5lLCBmYWN0b3IsIHRlbXAsDQogICAgICAgICAgICBlbGVtZW50ID0gJCggdGhpcyApLA0KDQogICAgICAgICAgICAvLyBDb3B5IGZvciBjaGlsZHJlbg0KICAgICAgICAgICAgY1Byb3BzID0gWyAiZm9udFNpemUiIF0sDQogICAgICAgICAgICB2UHJvcHMgPSBbICJib3JkZXJUb3BXaWR0aCIsICJib3JkZXJCb3R0b21XaWR0aCIsICJwYWRkaW5nVG9wIiwgInBhZGRpbmdCb3R0b20iIF0sDQogICAgICAgICAgICBoUHJvcHMgPSBbICJib3JkZXJMZWZ0V2lkdGgiLCAiYm9yZGVyUmlnaHRXaWR0aCIsICJwYWRkaW5nTGVmdCIsICJwYWRkaW5nUmlnaHQiIF0sDQoNCiAgICAgICAgICAgIC8vIFNldCBvcHRpb25zDQogICAgICAgICAgICBtb2RlID0gb3B0aW9ucy5tb2RlLA0KICAgICAgICAgICAgcmVzdG9yZSA9IG1vZGUgIT09ICJlZmZlY3QiLA0KICAgICAgICAgICAgc2NhbGUgPSBvcHRpb25zLnNjYWxlIHx8ICJib3RoIiwNCiAgICAgICAgICAgIG9yaWdpbiA9IG9wdGlvbnMub3JpZ2luIHx8IFsgIm1pZGRsZSIsICJjZW50ZXIiIF0sDQogICAgICAgICAgICBwb3NpdGlvbiA9IGVsZW1lbnQuY3NzKCAicG9zaXRpb24iICksDQogICAgICAgICAgICBwb3MgPSBlbGVtZW50LnBvc2l0aW9uKCksDQogICAgICAgICAgICBvcmlnaW5hbCA9ICQuZWZmZWN0cy5zY2FsZWREaW1lbnNpb25zKCBlbGVtZW50ICksDQogICAgICAgICAgICBmcm9tID0gb3B0aW9ucy5mcm9tIHx8IG9yaWdpbmFsLA0KICAgICAgICAgICAgdG8gPSBvcHRpb25zLnRvIHx8ICQuZWZmZWN0cy5zY2FsZWREaW1lbnNpb25zKCBlbGVtZW50LCAwICk7DQoNCiAgICAgICAgJC5lZmZlY3RzLmNyZWF0ZVBsYWNlaG9sZGVyKCBlbGVtZW50ICk7DQoNCiAgICAgICAgaWYgKCBtb2RlID09PSAic2hvdyIgKSB7DQogICAgICAgICAgICB0ZW1wID0gZnJvbTsNCiAgICAgICAgICAgIGZyb20gPSB0bzsNCiAgICAgICAgICAgIHRvID0gdGVtcDsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFNldCBzY2FsaW5nIGZhY3Rvcg0KICAgICAgICBmYWN0b3IgPSB7DQogICAgICAgICAgICBmcm9tOiB7DQogICAgICAgICAgICAgICAgeTogZnJvbS5oZWlnaHQgLyBvcmlnaW5hbC5oZWlnaHQsDQogICAgICAgICAgICAgICAgeDogZnJvbS53aWR0aCAvIG9yaWdpbmFsLndpZHRoDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgdG86IHsNCiAgICAgICAgICAgICAgICB5OiB0by5oZWlnaHQgLyBvcmlnaW5hbC5oZWlnaHQsDQogICAgICAgICAgICAgICAgeDogdG8ud2lkdGggLyBvcmlnaW5hbC53aWR0aA0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KDQogICAgICAgIC8vIFNjYWxlIHRoZSBjc3MgYm94DQogICAgICAgIGlmICggc2NhbGUgPT09ICJib3giIHx8IHNjYWxlID09PSAiYm90aCIgKSB7DQoNCiAgICAgICAgICAgIC8vIFZlcnRpY2FsIHByb3BzIHNjYWxpbmcNCiAgICAgICAgICAgIGlmICggZmFjdG9yLmZyb20ueSAhPT0gZmFjdG9yLnRvLnkgKSB7DQogICAgICAgICAgICAgICAgZnJvbSA9ICQuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKCBlbGVtZW50LCB2UHJvcHMsIGZhY3Rvci5mcm9tLnksIGZyb20gKTsNCiAgICAgICAgICAgICAgICB0byA9ICQuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKCBlbGVtZW50LCB2UHJvcHMsIGZhY3Rvci50by55LCB0byApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBIb3Jpem9udGFsIHByb3BzIHNjYWxpbmcNCiAgICAgICAgICAgIGlmICggZmFjdG9yLmZyb20ueCAhPT0gZmFjdG9yLnRvLnggKSB7DQogICAgICAgICAgICAgICAgZnJvbSA9ICQuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKCBlbGVtZW50LCBoUHJvcHMsIGZhY3Rvci5mcm9tLngsIGZyb20gKTsNCiAgICAgICAgICAgICAgICB0byA9ICQuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKCBlbGVtZW50LCBoUHJvcHMsIGZhY3Rvci50by54LCB0byApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU2NhbGUgdGhlIGNvbnRlbnQNCiAgICAgICAgaWYgKCBzY2FsZSA9PT0gImNvbnRlbnQiIHx8IHNjYWxlID09PSAiYm90aCIgKSB7DQoNCiAgICAgICAgICAgIC8vIFZlcnRpY2FsIHByb3BzIHNjYWxpbmcNCiAgICAgICAgICAgIGlmICggZmFjdG9yLmZyb20ueSAhPT0gZmFjdG9yLnRvLnkgKSB7DQogICAgICAgICAgICAgICAgZnJvbSA9ICQuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKCBlbGVtZW50LCBjUHJvcHMsIGZhY3Rvci5mcm9tLnksIGZyb20gKTsNCiAgICAgICAgICAgICAgICB0byA9ICQuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKCBlbGVtZW50LCBjUHJvcHMsIGZhY3Rvci50by55LCB0byApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQWRqdXN0IHRoZSBwb3NpdGlvbiBwcm9wZXJ0aWVzIGJhc2VkIG9uIHRoZSBwcm92aWRlZCBvcmlnaW4gcG9pbnRzDQogICAgICAgIGlmICggb3JpZ2luICkgew0KICAgICAgICAgICAgYmFzZWxpbmUgPSAkLmVmZmVjdHMuZ2V0QmFzZWxpbmUoIG9yaWdpbiwgb3JpZ2luYWwgKTsNCiAgICAgICAgICAgIGZyb20udG9wID0gKCBvcmlnaW5hbC5vdXRlckhlaWdodCAtIGZyb20ub3V0ZXJIZWlnaHQgKSAqIGJhc2VsaW5lLnkgKyBwb3MudG9wOw0KICAgICAgICAgICAgZnJvbS5sZWZ0ID0gKCBvcmlnaW5hbC5vdXRlcldpZHRoIC0gZnJvbS5vdXRlcldpZHRoICkgKiBiYXNlbGluZS54ICsgcG9zLmxlZnQ7DQogICAgICAgICAgICB0by50b3AgPSAoIG9yaWdpbmFsLm91dGVySGVpZ2h0IC0gdG8ub3V0ZXJIZWlnaHQgKSAqIGJhc2VsaW5lLnkgKyBwb3MudG9wOw0KICAgICAgICAgICAgdG8ubGVmdCA9ICggb3JpZ2luYWwub3V0ZXJXaWR0aCAtIHRvLm91dGVyV2lkdGggKSAqIGJhc2VsaW5lLnggKyBwb3MubGVmdDsNCiAgICAgICAgfQ0KICAgICAgICBlbGVtZW50LmNzcyggZnJvbSApOw0KDQogICAgICAgIC8vIEFuaW1hdGUgdGhlIGNoaWxkcmVuIGlmIGRlc2lyZWQNCiAgICAgICAgaWYgKCBzY2FsZSA9PT0gImNvbnRlbnQiIHx8IHNjYWxlID09PSAiYm90aCIgKSB7DQoNCiAgICAgICAgICAgIHZQcm9wcyA9IHZQcm9wcy5jb25jYXQoIFsgIm1hcmdpblRvcCIsICJtYXJnaW5Cb3R0b20iIF0gKS5jb25jYXQoIGNQcm9wcyApOw0KICAgICAgICAgICAgaFByb3BzID0gaFByb3BzLmNvbmNhdCggWyAibWFyZ2luTGVmdCIsICJtYXJnaW5SaWdodCIgXSApOw0KDQogICAgICAgICAgICAvLyBPbmx5IGFuaW1hdGUgY2hpbGRyZW4gd2l0aCB3aWR0aCBhdHRyaWJ1dGVzIHNwZWNpZmllZA0KICAgICAgICAgICAgLy8gVE9ETzogaXMgdGhpcyByaWdodD8gc2hvdWxkIHdlIGluY2x1ZGUgYW55dGhpbmcgd2l0aCBjc3Mgd2lkdGggc3BlY2lmaWVkIGFzIHdlbGwNCiAgICAgICAgICAgIGVsZW1lbnQuZmluZCggIipbd2lkdGhdIiApLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9ICQoIHRoaXMgKSwNCiAgICAgICAgICAgICAgICAgICAgY2hpbGRPcmlnaW5hbCA9ICQuZWZmZWN0cy5zY2FsZWREaW1lbnNpb25zKCBjaGlsZCApLA0KICAgICAgICAgICAgICAgICAgICBjaGlsZEZyb20gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGNoaWxkT3JpZ2luYWwuaGVpZ2h0ICogZmFjdG9yLmZyb20ueSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBjaGlsZE9yaWdpbmFsLndpZHRoICogZmFjdG9yLmZyb20ueCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG91dGVySGVpZ2h0OiBjaGlsZE9yaWdpbmFsLm91dGVySGVpZ2h0ICogZmFjdG9yLmZyb20ueSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG91dGVyV2lkdGg6IGNoaWxkT3JpZ2luYWwub3V0ZXJXaWR0aCAqIGZhY3Rvci5mcm9tLngNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgY2hpbGRUbyA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogY2hpbGRPcmlnaW5hbC5oZWlnaHQgKiBmYWN0b3IudG8ueSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBjaGlsZE9yaWdpbmFsLndpZHRoICogZmFjdG9yLnRvLngsDQogICAgICAgICAgICAgICAgICAgICAgICBvdXRlckhlaWdodDogY2hpbGRPcmlnaW5hbC5oZWlnaHQgKiBmYWN0b3IudG8ueSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG91dGVyV2lkdGg6IGNoaWxkT3JpZ2luYWwud2lkdGggKiBmYWN0b3IudG8ueA0KICAgICAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAgICAgLy8gVmVydGljYWwgcHJvcHMgc2NhbGluZw0KICAgICAgICAgICAgICAgIGlmICggZmFjdG9yLmZyb20ueSAhPT0gZmFjdG9yLnRvLnkgKSB7DQogICAgICAgICAgICAgICAgICAgIGNoaWxkRnJvbSA9ICQuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKCBjaGlsZCwgdlByb3BzLCBmYWN0b3IuZnJvbS55LCBjaGlsZEZyb20gKTsNCiAgICAgICAgICAgICAgICAgICAgY2hpbGRUbyA9ICQuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKCBjaGlsZCwgdlByb3BzLCBmYWN0b3IudG8ueSwgY2hpbGRUbyApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIEhvcml6b250YWwgcHJvcHMgc2NhbGluZw0KICAgICAgICAgICAgICAgIGlmICggZmFjdG9yLmZyb20ueCAhPT0gZmFjdG9yLnRvLnggKSB7DQogICAgICAgICAgICAgICAgICAgIGNoaWxkRnJvbSA9ICQuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKCBjaGlsZCwgaFByb3BzLCBmYWN0b3IuZnJvbS54LCBjaGlsZEZyb20gKTsNCiAgICAgICAgICAgICAgICAgICAgY2hpbGRUbyA9ICQuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKCBjaGlsZCwgaFByb3BzLCBmYWN0b3IudG8ueCwgY2hpbGRUbyApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggcmVzdG9yZSApIHsNCiAgICAgICAgICAgICAgICAgICAgJC5lZmZlY3RzLnNhdmVTdHlsZSggY2hpbGQgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBBbmltYXRlIGNoaWxkcmVuDQogICAgICAgICAgICAgICAgY2hpbGQuY3NzKCBjaGlsZEZyb20gKTsNCiAgICAgICAgICAgICAgICBjaGlsZC5hbmltYXRlKCBjaGlsZFRvLCBvcHRpb25zLmR1cmF0aW9uLCBvcHRpb25zLmVhc2luZywgZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gUmVzdG9yZSBjaGlsZHJlbg0KICAgICAgICAgICAgICAgICAgICBpZiAoIHJlc3RvcmUgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkLmVmZmVjdHMucmVzdG9yZVN0eWxlKCBjaGlsZCApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQW5pbWF0ZQ0KICAgICAgICBlbGVtZW50LmFuaW1hdGUoIHRvLCB7DQogICAgICAgICAgICBxdWV1ZTogZmFsc2UsDQogICAgICAgICAgICBkdXJhdGlvbjogb3B0aW9ucy5kdXJhdGlvbiwNCiAgICAgICAgICAgIGVhc2luZzogb3B0aW9ucy5lYXNpbmcsDQogICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gZWxlbWVudC5vZmZzZXQoKTsNCg0KICAgICAgICAgICAgICAgIGlmICggdG8ub3BhY2l0eSA9PT0gMCApIHsNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jc3MoICJvcGFjaXR5IiwgZnJvbS5vcGFjaXR5ICk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCAhcmVzdG9yZSApIHsNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudA0KICAgICAgICAgICAgICAgICAgICAgICAgLmNzcyggInBvc2l0aW9uIiwgcG9zaXRpb24gPT09ICJzdGF0aWMiID8gInJlbGF0aXZlIiA6IHBvc2l0aW9uICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5vZmZzZXQoIG9mZnNldCApOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIE5lZWQgdG8gc2F2ZSBzdHlsZSBoZXJlIHNvIHRoYXQgYXV0b21hdGljIHN0eWxlIHJlc3RvcmF0aW9uDQogICAgICAgICAgICAgICAgICAgIC8vIGRvZXNuJ3QgcmVzdG9yZSB0byB0aGUgb3JpZ2luYWwgc3R5bGVzIGZyb20gYmVmb3JlIHRoZSBhbmltYXRpb24uDQogICAgICAgICAgICAgICAgICAgICQuZWZmZWN0cy5zYXZlU3R5bGUoIGVsZW1lbnQgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBkb25lKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gKTsNCg0KICAgIH0gKTsNCg0KDQogICAgLyohDQogKiBqUXVlcnkgVUkgRWZmZWN0cyBTY2FsZSAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogU2NhbGUgRWZmZWN0DQovLz4+Z3JvdXA6IEVmZmVjdHMNCi8vPj5kZXNjcmlwdGlvbjogR3Jvd3Mgb3Igc2hyaW5rcyBhbiBlbGVtZW50IGFuZCBpdHMgY29udGVudC4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9zY2FsZS1lZmZlY3QvDQovLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vZWZmZWN0Lw0KDQoNCg0KICAgIHZhciBlZmZlY3RzRWZmZWN0U2NhbGUgPSAkLmVmZmVjdHMuZGVmaW5lKCAic2NhbGUiLCBmdW5jdGlvbiggb3B0aW9ucywgZG9uZSApIHsNCg0KICAgICAgICAvLyBDcmVhdGUgZWxlbWVudA0KICAgICAgICB2YXIgZWwgPSAkKCB0aGlzICksDQogICAgICAgICAgICBtb2RlID0gb3B0aW9ucy5tb2RlLA0KICAgICAgICAgICAgcGVyY2VudCA9IHBhcnNlSW50KCBvcHRpb25zLnBlcmNlbnQsIDEwICkgfHwNCiAgICAgICAgICAgICAgICAoIHBhcnNlSW50KCBvcHRpb25zLnBlcmNlbnQsIDEwICkgPT09IDAgPyAwIDogKCBtb2RlICE9PSAiZWZmZWN0IiA/IDAgOiAxMDAgKSApLA0KDQogICAgICAgICAgICBuZXdPcHRpb25zID0gJC5leHRlbmQoIHRydWUsIHsNCiAgICAgICAgICAgICAgICBmcm9tOiAkLmVmZmVjdHMuc2NhbGVkRGltZW5zaW9ucyggZWwgKSwNCiAgICAgICAgICAgICAgICB0bzogJC5lZmZlY3RzLnNjYWxlZERpbWVuc2lvbnMoIGVsLCBwZXJjZW50LCBvcHRpb25zLmRpcmVjdGlvbiB8fCAiYm90aCIgKSwNCiAgICAgICAgICAgICAgICBvcmlnaW46IG9wdGlvbnMub3JpZ2luIHx8IFsgIm1pZGRsZSIsICJjZW50ZXIiIF0NCiAgICAgICAgICAgIH0sIG9wdGlvbnMgKTsNCg0KICAgICAgICAvLyBGYWRlIG9wdGlvbiB0byBzdXBwb3J0IHB1ZmYNCiAgICAgICAgaWYgKCBvcHRpb25zLmZhZGUgKSB7DQogICAgICAgICAgICBuZXdPcHRpb25zLmZyb20ub3BhY2l0eSA9IDE7DQogICAgICAgICAgICBuZXdPcHRpb25zLnRvLm9wYWNpdHkgPSAwOw0KICAgICAgICB9DQoNCiAgICAgICAgJC5lZmZlY3RzLmVmZmVjdC5zaXplLmNhbGwoIHRoaXMsIG5ld09wdGlvbnMsIGRvbmUgKTsNCiAgICB9ICk7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIEVmZmVjdHMgUHVmZiAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogUHVmZiBFZmZlY3QNCi8vPj5ncm91cDogRWZmZWN0cw0KLy8+PmRlc2NyaXB0aW9uOiBDcmVhdGVzIGEgcHVmZiBlZmZlY3QgYnkgc2NhbGluZyB0aGUgZWxlbWVudCB1cCBhbmQgaGlkaW5nIGl0IGF0IHRoZSBzYW1lIHRpbWUuDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vcHVmZi1lZmZlY3QvDQovLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vZWZmZWN0Lw0KDQoNCg0KICAgIHZhciBlZmZlY3RzRWZmZWN0UHVmZiA9ICQuZWZmZWN0cy5kZWZpbmUoICJwdWZmIiwgImhpZGUiLCBmdW5jdGlvbiggb3B0aW9ucywgZG9uZSApIHsNCiAgICAgICAgdmFyIG5ld09wdGlvbnMgPSAkLmV4dGVuZCggdHJ1ZSwge30sIG9wdGlvbnMsIHsNCiAgICAgICAgICAgIGZhZGU6IHRydWUsDQogICAgICAgICAgICBwZXJjZW50OiBwYXJzZUludCggb3B0aW9ucy5wZXJjZW50LCAxMCApIHx8IDE1MA0KICAgICAgICB9ICk7DQoNCiAgICAgICAgJC5lZmZlY3RzLmVmZmVjdC5zY2FsZS5jYWxsKCB0aGlzLCBuZXdPcHRpb25zLCBkb25lICk7DQogICAgfSApOw0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBFZmZlY3RzIFB1bHNhdGUgMS4xMi4xDQogKiBodHRwOi8vanF1ZXJ5dWkuY29tDQogKg0KICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMNCiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UNCiAqLw0KDQovLz4+bGFiZWw6IFB1bHNhdGUgRWZmZWN0DQovLz4+Z3JvdXA6IEVmZmVjdHMNCi8vPj5kZXNjcmlwdGlvbjogUHVsc2F0ZXMgYW4gZWxlbWVudCBuIHRpbWVzIGJ5IGNoYW5naW5nIHRoZSBvcGFjaXR5IHRvIHplcm8gYW5kIGJhY2suDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vcHVsc2F0ZS1lZmZlY3QvDQovLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vZWZmZWN0Lw0KDQoNCg0KICAgIHZhciBlZmZlY3RzRWZmZWN0UHVsc2F0ZSA9ICQuZWZmZWN0cy5kZWZpbmUoICJwdWxzYXRlIiwgInNob3ciLCBmdW5jdGlvbiggb3B0aW9ucywgZG9uZSApIHsNCiAgICAgICAgdmFyIGVsZW1lbnQgPSAkKCB0aGlzICksDQogICAgICAgICAgICBtb2RlID0gb3B0aW9ucy5tb2RlLA0KICAgICAgICAgICAgc2hvdyA9IG1vZGUgPT09ICJzaG93IiwNCiAgICAgICAgICAgIGhpZGUgPSBtb2RlID09PSAiaGlkZSIsDQogICAgICAgICAgICBzaG93aGlkZSA9IHNob3cgfHwgaGlkZSwNCg0KICAgICAgICAgICAgLy8gU2hvd2luZyBvciBoaWRpbmcgbGVhdmVzIG9mZiB0aGUgImxhc3QiIGFuaW1hdGlvbg0KICAgICAgICAgICAgYW5pbXMgPSAoICggb3B0aW9ucy50aW1lcyB8fCA1ICkgKiAyICkgKyAoIHNob3doaWRlID8gMSA6IDAgKSwNCiAgICAgICAgICAgIGR1cmF0aW9uID0gb3B0aW9ucy5kdXJhdGlvbiAvIGFuaW1zLA0KICAgICAgICAgICAgYW5pbWF0ZVRvID0gMCwNCiAgICAgICAgICAgIGkgPSAxLA0KICAgICAgICAgICAgcXVldWVsZW4gPSBlbGVtZW50LnF1ZXVlKCkubGVuZ3RoOw0KDQogICAgICAgIGlmICggc2hvdyB8fCAhZWxlbWVudC5pcyggIjp2aXNpYmxlIiApICkgew0KICAgICAgICAgICAgZWxlbWVudC5jc3MoICJvcGFjaXR5IiwgMCApLnNob3coKTsNCiAgICAgICAgICAgIGFuaW1hdGVUbyA9IDE7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBBbmltcyAtIDEgb3BhY2l0eSAidG9nZ2xlcyINCiAgICAgICAgZm9yICggOyBpIDwgYW5pbXM7IGkrKyApIHsNCiAgICAgICAgICAgIGVsZW1lbnQuYW5pbWF0ZSggeyBvcGFjaXR5OiBhbmltYXRlVG8gfSwgZHVyYXRpb24sIG9wdGlvbnMuZWFzaW5nICk7DQogICAgICAgICAgICBhbmltYXRlVG8gPSAxIC0gYW5pbWF0ZVRvOw0KICAgICAgICB9DQoNCiAgICAgICAgZWxlbWVudC5hbmltYXRlKCB7IG9wYWNpdHk6IGFuaW1hdGVUbyB9LCBkdXJhdGlvbiwgb3B0aW9ucy5lYXNpbmcgKTsNCg0KICAgICAgICBlbGVtZW50LnF1ZXVlKCBkb25lICk7DQoNCiAgICAgICAgJC5lZmZlY3RzLnVuc2hpZnQoIGVsZW1lbnQsIHF1ZXVlbGVuLCBhbmltcyArIDEgKTsNCiAgICB9ICk7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIEVmZmVjdHMgU2hha2UgMS4xMi4xDQogKiBodHRwOi8vanF1ZXJ5dWkuY29tDQogKg0KICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMNCiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UNCiAqLw0KDQovLz4+bGFiZWw6IFNoYWtlIEVmZmVjdA0KLy8+Pmdyb3VwOiBFZmZlY3RzDQovLz4+ZGVzY3JpcHRpb246IFNoYWtlcyBhbiBlbGVtZW50IGhvcml6b250YWxseSBvciB2ZXJ0aWNhbGx5IG4gdGltZXMuDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vc2hha2UtZWZmZWN0Lw0KLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL2VmZmVjdC8NCg0KDQoNCiAgICB2YXIgZWZmZWN0c0VmZmVjdFNoYWtlID0gJC5lZmZlY3RzLmRlZmluZSggInNoYWtlIiwgZnVuY3Rpb24oIG9wdGlvbnMsIGRvbmUgKSB7DQoNCiAgICAgICAgdmFyIGkgPSAxLA0KICAgICAgICAgICAgZWxlbWVudCA9ICQoIHRoaXMgKSwNCiAgICAgICAgICAgIGRpcmVjdGlvbiA9IG9wdGlvbnMuZGlyZWN0aW9uIHx8ICJsZWZ0IiwNCiAgICAgICAgICAgIGRpc3RhbmNlID0gb3B0aW9ucy5kaXN0YW5jZSB8fCAyMCwNCiAgICAgICAgICAgIHRpbWVzID0gb3B0aW9ucy50aW1lcyB8fCAzLA0KICAgICAgICAgICAgYW5pbXMgPSB0aW1lcyAqIDIgKyAxLA0KICAgICAgICAgICAgc3BlZWQgPSBNYXRoLnJvdW5kKCBvcHRpb25zLmR1cmF0aW9uIC8gYW5pbXMgKSwNCiAgICAgICAgICAgIHJlZiA9ICggZGlyZWN0aW9uID09PSAidXAiIHx8IGRpcmVjdGlvbiA9PT0gImRvd24iICkgPyAidG9wIiA6ICJsZWZ0IiwNCiAgICAgICAgICAgIHBvc2l0aXZlTW90aW9uID0gKCBkaXJlY3Rpb24gPT09ICJ1cCIgfHwgZGlyZWN0aW9uID09PSAibGVmdCIgKSwNCiAgICAgICAgICAgIGFuaW1hdGlvbiA9IHt9LA0KICAgICAgICAgICAgYW5pbWF0aW9uMSA9IHt9LA0KICAgICAgICAgICAgYW5pbWF0aW9uMiA9IHt9LA0KDQogICAgICAgICAgICBxdWV1ZWxlbiA9IGVsZW1lbnQucXVldWUoKS5sZW5ndGg7DQoNCiAgICAgICAgJC5lZmZlY3RzLmNyZWF0ZVBsYWNlaG9sZGVyKCBlbGVtZW50ICk7DQoNCiAgICAgICAgLy8gQW5pbWF0aW9uDQogICAgICAgIGFuaW1hdGlvblsgcmVmIF0gPSAoIHBvc2l0aXZlTW90aW9uID8gIi09IiA6ICIrPSIgKSArIGRpc3RhbmNlOw0KICAgICAgICBhbmltYXRpb24xWyByZWYgXSA9ICggcG9zaXRpdmVNb3Rpb24gPyAiKz0iIDogIi09IiApICsgZGlzdGFuY2UgKiAyOw0KICAgICAgICBhbmltYXRpb24yWyByZWYgXSA9ICggcG9zaXRpdmVNb3Rpb24gPyAiLT0iIDogIis9IiApICsgZGlzdGFuY2UgKiAyOw0KDQogICAgICAgIC8vIEFuaW1hdGUNCiAgICAgICAgZWxlbWVudC5hbmltYXRlKCBhbmltYXRpb24sIHNwZWVkLCBvcHRpb25zLmVhc2luZyApOw0KDQogICAgICAgIC8vIFNoYWtlcw0KICAgICAgICBmb3IgKCA7IGkgPCB0aW1lczsgaSsrICkgew0KICAgICAgICAgICAgZWxlbWVudA0KICAgICAgICAgICAgICAgIC5hbmltYXRlKCBhbmltYXRpb24xLCBzcGVlZCwgb3B0aW9ucy5lYXNpbmcgKQ0KICAgICAgICAgICAgICAgIC5hbmltYXRlKCBhbmltYXRpb24yLCBzcGVlZCwgb3B0aW9ucy5lYXNpbmcgKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGVsZW1lbnQNCiAgICAgICAgICAgIC5hbmltYXRlKCBhbmltYXRpb24xLCBzcGVlZCwgb3B0aW9ucy5lYXNpbmcgKQ0KICAgICAgICAgICAgLmFuaW1hdGUoIGFuaW1hdGlvbiwgc3BlZWQgLyAyLCBvcHRpb25zLmVhc2luZyApDQogICAgICAgICAgICAucXVldWUoIGRvbmUgKTsNCg0KICAgICAgICAkLmVmZmVjdHMudW5zaGlmdCggZWxlbWVudCwgcXVldWVsZW4sIGFuaW1zICsgMSApOw0KICAgIH0gKTsNCg0KDQogICAgLyohDQogKiBqUXVlcnkgVUkgRWZmZWN0cyBTbGlkZSAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogU2xpZGUgRWZmZWN0DQovLz4+Z3JvdXA6IEVmZmVjdHMNCi8vPj5kZXNjcmlwdGlvbjogU2xpZGVzIGFuIGVsZW1lbnQgaW4gYW5kIG91dCBvZiB0aGUgdmlld3BvcnQuDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vc2xpZGUtZWZmZWN0Lw0KLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL2VmZmVjdC8NCg0KDQoNCiAgICB2YXIgZWZmZWN0c0VmZmVjdFNsaWRlID0gJC5lZmZlY3RzLmRlZmluZSggInNsaWRlIiwgInNob3ciLCBmdW5jdGlvbiggb3B0aW9ucywgZG9uZSApIHsNCiAgICAgICAgdmFyIHN0YXJ0Q2xpcCwgc3RhcnRSZWYsDQogICAgICAgICAgICBlbGVtZW50ID0gJCggdGhpcyApLA0KICAgICAgICAgICAgbWFwID0gew0KICAgICAgICAgICAgICAgIHVwOiBbICJib3R0b20iLCAidG9wIiBdLA0KICAgICAgICAgICAgICAgIGRvd246IFsgInRvcCIsICJib3R0b20iIF0sDQogICAgICAgICAgICAgICAgbGVmdDogWyAicmlnaHQiLCAibGVmdCIgXSwNCiAgICAgICAgICAgICAgICByaWdodDogWyAibGVmdCIsICJyaWdodCIgXQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG1vZGUgPSBvcHRpb25zLm1vZGUsDQogICAgICAgICAgICBkaXJlY3Rpb24gPSBvcHRpb25zLmRpcmVjdGlvbiB8fCAibGVmdCIsDQogICAgICAgICAgICByZWYgPSAoIGRpcmVjdGlvbiA9PT0gInVwIiB8fCBkaXJlY3Rpb24gPT09ICJkb3duIiApID8gInRvcCIgOiAibGVmdCIsDQogICAgICAgICAgICBwb3NpdGl2ZU1vdGlvbiA9ICggZGlyZWN0aW9uID09PSAidXAiIHx8IGRpcmVjdGlvbiA9PT0gImxlZnQiICksDQogICAgICAgICAgICBkaXN0YW5jZSA9IG9wdGlvbnMuZGlzdGFuY2UgfHwNCiAgICAgICAgICAgICAgICBlbGVtZW50WyByZWYgPT09ICJ0b3AiID8gIm91dGVySGVpZ2h0IiA6ICJvdXRlcldpZHRoIiBdKCB0cnVlICksDQogICAgICAgICAgICBhbmltYXRpb24gPSB7fTsNCg0KICAgICAgICAkLmVmZmVjdHMuY3JlYXRlUGxhY2Vob2xkZXIoIGVsZW1lbnQgKTsNCg0KICAgICAgICBzdGFydENsaXAgPSBlbGVtZW50LmNzc0NsaXAoKTsNCiAgICAgICAgc3RhcnRSZWYgPSBlbGVtZW50LnBvc2l0aW9uKClbIHJlZiBdOw0KDQogICAgICAgIC8vIERlZmluZSBoaWRlIGFuaW1hdGlvbg0KICAgICAgICBhbmltYXRpb25bIHJlZiBdID0gKCBwb3NpdGl2ZU1vdGlvbiA/IC0xIDogMSApICogZGlzdGFuY2UgKyBzdGFydFJlZjsNCiAgICAgICAgYW5pbWF0aW9uLmNsaXAgPSBlbGVtZW50LmNzc0NsaXAoKTsNCiAgICAgICAgYW5pbWF0aW9uLmNsaXBbIG1hcFsgZGlyZWN0aW9uIF1bIDEgXSBdID0gYW5pbWF0aW9uLmNsaXBbIG1hcFsgZGlyZWN0aW9uIF1bIDAgXSBdOw0KDQogICAgICAgIC8vIFJldmVyc2UgdGhlIGFuaW1hdGlvbiBpZiB3ZSdyZSBzaG93aW5nDQogICAgICAgIGlmICggbW9kZSA9PT0gInNob3ciICkgew0KICAgICAgICAgICAgZWxlbWVudC5jc3NDbGlwKCBhbmltYXRpb24uY2xpcCApOw0KICAgICAgICAgICAgZWxlbWVudC5jc3MoIHJlZiwgYW5pbWF0aW9uWyByZWYgXSApOw0KICAgICAgICAgICAgYW5pbWF0aW9uLmNsaXAgPSBzdGFydENsaXA7DQogICAgICAgICAgICBhbmltYXRpb25bIHJlZiBdID0gc3RhcnRSZWY7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBBY3R1YWxseSBhbmltYXRlDQogICAgICAgIGVsZW1lbnQuYW5pbWF0ZSggYW5pbWF0aW9uLCB7DQogICAgICAgICAgICBxdWV1ZTogZmFsc2UsDQogICAgICAgICAgICBkdXJhdGlvbjogb3B0aW9ucy5kdXJhdGlvbiwNCiAgICAgICAgICAgIGVhc2luZzogb3B0aW9ucy5lYXNpbmcsDQogICAgICAgICAgICBjb21wbGV0ZTogZG9uZQ0KICAgICAgICB9ICk7DQogICAgfSApOw0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBFZmZlY3RzIFRyYW5zZmVyIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBUcmFuc2ZlciBFZmZlY3QNCi8vPj5ncm91cDogRWZmZWN0cw0KLy8+PmRlc2NyaXB0aW9uOiBEaXNwbGF5cyBhIHRyYW5zZmVyIGVmZmVjdCBmcm9tIG9uZSBlbGVtZW50IHRvIGFub3RoZXIuDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vdHJhbnNmZXItZWZmZWN0Lw0KLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL2VmZmVjdC8NCg0KDQoNCiAgICB2YXIgZWZmZWN0Ow0KICAgIGlmICggJC51aUJhY2tDb21wYXQgIT09IGZhbHNlICkgew0KICAgICAgICBlZmZlY3QgPSAkLmVmZmVjdHMuZGVmaW5lKCAidHJhbnNmZXIiLCBmdW5jdGlvbiggb3B0aW9ucywgZG9uZSApIHsNCiAgICAgICAgICAgICQoIHRoaXMgKS50cmFuc2Zlciggb3B0aW9ucywgZG9uZSApOw0KICAgICAgICB9ICk7DQogICAgfQ0KICAgIHZhciBlZmZlY3RzRWZmZWN0VHJhbnNmZXIgPSBlZmZlY3Q7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIEZvY3VzYWJsZSAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogOmZvY3VzYWJsZSBTZWxlY3Rvcg0KLy8+Pmdyb3VwOiBDb3JlDQovLz4+ZGVzY3JpcHRpb246IFNlbGVjdHMgZWxlbWVudHMgd2hpY2ggY2FuIGJlIGZvY3VzZWQuDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZm9jdXNhYmxlLXNlbGVjdG9yLw0KDQoNCg0KLy8gU2VsZWN0b3JzDQogICAgJC51aS5mb2N1c2FibGUgPSBmdW5jdGlvbiggZWxlbWVudCwgaGFzVGFiaW5kZXggKSB7DQogICAgICAgIHZhciBtYXAsIG1hcE5hbWUsIGltZywgZm9jdXNhYmxlSWZWaXNpYmxlLCBmaWVsZHNldCwNCiAgICAgICAgICAgIG5vZGVOYW1lID0gZWxlbWVudC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOw0KDQogICAgICAgIGlmICggImFyZWEiID09PSBub2RlTmFtZSApIHsNCiAgICAgICAgICAgIG1hcCA9IGVsZW1lbnQucGFyZW50Tm9kZTsNCiAgICAgICAgICAgIG1hcE5hbWUgPSBtYXAubmFtZTsNCiAgICAgICAgICAgIGlmICggIWVsZW1lbnQuaHJlZiB8fCAhbWFwTmFtZSB8fCBtYXAubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gIm1hcCIgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaW1nID0gJCggImltZ1t1c2VtYXA9JyMiICsgbWFwTmFtZSArICInXSIgKTsNCiAgICAgICAgICAgIHJldHVybiBpbWcubGVuZ3RoID4gMCAmJiBpbWcuaXMoICI6dmlzaWJsZSIgKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICggL14oaW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbnxvYmplY3QpJC8udGVzdCggbm9kZU5hbWUgKSApIHsNCiAgICAgICAgICAgIGZvY3VzYWJsZUlmVmlzaWJsZSA9ICFlbGVtZW50LmRpc2FibGVkOw0KDQogICAgICAgICAgICBpZiAoIGZvY3VzYWJsZUlmVmlzaWJsZSApIHsNCg0KICAgICAgICAgICAgICAgIC8vIEZvcm0gY29udHJvbHMgd2l0aGluIGEgZGlzYWJsZWQgZmllbGRzZXQgYXJlIGRpc2FibGVkLg0KICAgICAgICAgICAgICAgIC8vIEhvd2V2ZXIsIGNvbnRyb2xzIHdpdGhpbiB0aGUgZmllbGRzZXQncyBsZWdlbmQgZG8gbm90IGdldCBkaXNhYmxlZC4NCiAgICAgICAgICAgICAgICAvLyBTaW5jZSBjb250cm9scyBnZW5lcmFsbHkgYXJlbid0IHBsYWNlZCBpbnNpZGUgbGVnZW5kcywgd2Ugc2tpcA0KICAgICAgICAgICAgICAgIC8vIHRoaXMgcG9ydGlvbiBvZiB0aGUgY2hlY2suDQogICAgICAgICAgICAgICAgZmllbGRzZXQgPSAkKCBlbGVtZW50ICkuY2xvc2VzdCggImZpZWxkc2V0IiApWyAwIF07DQogICAgICAgICAgICAgICAgaWYgKCBmaWVsZHNldCApIHsNCiAgICAgICAgICAgICAgICAgICAgZm9jdXNhYmxlSWZWaXNpYmxlID0gIWZpZWxkc2V0LmRpc2FibGVkOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIGlmICggImEiID09PSBub2RlTmFtZSApIHsNCiAgICAgICAgICAgIGZvY3VzYWJsZUlmVmlzaWJsZSA9IGVsZW1lbnQuaHJlZiB8fCBoYXNUYWJpbmRleDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGZvY3VzYWJsZUlmVmlzaWJsZSA9IGhhc1RhYmluZGV4Ow0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZvY3VzYWJsZUlmVmlzaWJsZSAmJiAkKCBlbGVtZW50ICkuaXMoICI6dmlzaWJsZSIgKSAmJiB2aXNpYmxlKCAkKCBlbGVtZW50ICkgKTsNCiAgICB9Ow0KDQovLyBTdXBwb3J0OiBJRSA4IG9ubHkNCi8vIElFIDggZG9lc24ndCByZXNvbHZlIGluaGVyaXQgdG8gdmlzaWJsZS9oaWRkZW4gZm9yIGNvbXB1dGVkIHZhbHVlcw0KICAgIGZ1bmN0aW9uIHZpc2libGUoIGVsZW1lbnQgKSB7DQogICAgICAgIHZhciB2aXNpYmlsaXR5ID0gZWxlbWVudC5jc3MoICJ2aXNpYmlsaXR5IiApOw0KICAgICAgICB3aGlsZSAoIHZpc2liaWxpdHkgPT09ICJpbmhlcml0IiApIHsNCiAgICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudCgpOw0KICAgICAgICAgICAgdmlzaWJpbGl0eSA9IGVsZW1lbnQuY3NzKCAidmlzaWJpbGl0eSIgKTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdmlzaWJpbGl0eSAhPT0gImhpZGRlbiI7DQogICAgfQ0KDQogICAgJC5leHRlbmQoICQuZXhwclsgIjoiIF0sIHsNCiAgICAgICAgZm9jdXNhYmxlOiBmdW5jdGlvbiggZWxlbWVudCApIHsNCiAgICAgICAgICAgIHJldHVybiAkLnVpLmZvY3VzYWJsZSggZWxlbWVudCwgJC5hdHRyKCBlbGVtZW50LCAidGFiaW5kZXgiICkgIT0gbnVsbCApOw0KICAgICAgICB9DQogICAgfSApOw0KDQogICAgdmFyIGZvY3VzYWJsZSA9ICQudWkuZm9jdXNhYmxlOw0KDQoNCg0KDQovLyBTdXBwb3J0OiBJRTggT25seQ0KLy8gSUU4IGRvZXMgbm90IHN1cHBvcnQgdGhlIGZvcm0gYXR0cmlidXRlIGFuZCB3aGVuIGl0IGlzIHN1cHBsaWVkLiBJdCBvdmVyd3JpdGVzIHRoZSBmb3JtIHByb3ANCi8vIHdpdGggYSBzdHJpbmcsIHNvIHdlIG5lZWQgdG8gZmluZCB0aGUgcHJvcGVyIGZvcm0uDQogICAgdmFyIGZvcm0gPSAkLmZuLmZvcm0gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgcmV0dXJuIHR5cGVvZiB0aGlzWyAwIF0uZm9ybSA9PT0gInN0cmluZyIgPyB0aGlzLmNsb3Nlc3QoICJmb3JtIiApIDogJCggdGhpc1sgMCBdLmZvcm0gKTsNCiAgICB9Ow0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBGb3JtIFJlc2V0IE1peGluIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBGb3JtIFJlc2V0IE1peGluDQovLz4+Z3JvdXA6IENvcmUNCi8vPj5kZXNjcmlwdGlvbjogUmVmcmVzaCBpbnB1dCB3aWRnZXRzIHdoZW4gdGhlaXIgZm9ybSBpcyByZXNldA0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2Zvcm0tcmVzZXQtbWl4aW4vDQoNCg0KDQogICAgdmFyIGZvcm1SZXNldE1peGluID0gJC51aS5mb3JtUmVzZXRNaXhpbiA9IHsNCiAgICAgICAgX2Zvcm1SZXNldEhhbmRsZXI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGZvcm0gPSAkKCB0aGlzICk7DQoNCiAgICAgICAgICAgIC8vIFdhaXQgZm9yIHRoZSBmb3JtIHJlc2V0IHRvIGFjdHVhbGx5IGhhcHBlbiBiZWZvcmUgcmVmcmVzaGluZw0KICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlcyA9IGZvcm0uZGF0YSggInVpLWZvcm0tcmVzZXQtaW5zdGFuY2VzIiApOw0KICAgICAgICAgICAgICAgICQuZWFjaCggaW5zdGFuY2VzLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9iaW5kRm9ybVJlc2V0SGFuZGxlcjogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLmZvcm0gPSB0aGlzLmVsZW1lbnQuZm9ybSgpOw0KICAgICAgICAgICAgaWYgKCAhdGhpcy5mb3JtLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciBpbnN0YW5jZXMgPSB0aGlzLmZvcm0uZGF0YSggInVpLWZvcm0tcmVzZXQtaW5zdGFuY2VzIiApIHx8IFtdOw0KICAgICAgICAgICAgaWYgKCAhaW5zdGFuY2VzLmxlbmd0aCApIHsNCg0KICAgICAgICAgICAgICAgIC8vIFdlIGRvbid0IHVzZSBfb24oKSBoZXJlIGJlY2F1c2Ugd2UgdXNlIGEgc2luZ2xlIGV2ZW50IGhhbmRsZXIgcGVyIGZvcm0NCiAgICAgICAgICAgICAgICB0aGlzLmZvcm0ub24oICJyZXNldC51aS1mb3JtLXJlc2V0IiwgdGhpcy5fZm9ybVJlc2V0SGFuZGxlciApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaW5zdGFuY2VzLnB1c2goIHRoaXMgKTsNCiAgICAgICAgICAgIHRoaXMuZm9ybS5kYXRhKCAidWktZm9ybS1yZXNldC1pbnN0YW5jZXMiLCBpbnN0YW5jZXMgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfdW5iaW5kRm9ybVJlc2V0SGFuZGxlcjogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBpZiAoICF0aGlzLmZvcm0ubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdmFyIGluc3RhbmNlcyA9IHRoaXMuZm9ybS5kYXRhKCAidWktZm9ybS1yZXNldC1pbnN0YW5jZXMiICk7DQogICAgICAgICAgICBpbnN0YW5jZXMuc3BsaWNlKCAkLmluQXJyYXkoIHRoaXMsIGluc3RhbmNlcyApLCAxICk7DQogICAgICAgICAgICBpZiAoIGluc3RhbmNlcy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgdGhpcy5mb3JtLmRhdGEoICJ1aS1mb3JtLXJlc2V0LWluc3RhbmNlcyIsIGluc3RhbmNlcyApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLmZvcm0NCiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZURhdGEoICJ1aS1mb3JtLXJlc2V0LWluc3RhbmNlcyIgKQ0KICAgICAgICAgICAgICAgICAgICAub2ZmKCAicmVzZXQudWktZm9ybS1yZXNldCIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH07DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIFN1cHBvcnQgZm9yIGpRdWVyeSBjb3JlIDEuNy54IDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKg0KICovDQoNCi8vPj5sYWJlbDogalF1ZXJ5IDEuNyBTdXBwb3J0DQovLz4+Z3JvdXA6IENvcmUNCi8vPj5kZXNjcmlwdGlvbjogU3VwcG9ydCB2ZXJzaW9uIDEuNy54IG9mIGpRdWVyeSBjb3JlDQoNCg0KDQovLyBTdXBwb3J0OiBqUXVlcnkgMS43IG9ubHkNCi8vIE5vdCBhIGdyZWF0IHdheSB0byBjaGVjayB2ZXJzaW9ucywgYnV0IHNpbmNlIHdlIG9ubHkgc3VwcG9ydCAxLjcrIGFuZCBvbmx5DQovLyBuZWVkIHRvIGRldGVjdCA8MS44LCB0aGlzIGlzIGEgc2ltcGxlIGNoZWNrIHRoYXQgc2hvdWxkIHN1ZmZpY2UuIENoZWNraW5nDQovLyBmb3IgIjEuNy4iIHdvdWxkIGJlIGEgYml0IHNhZmVyLCBidXQgdGhlIHZlcnNpb24gc3RyaW5nIGlzIDEuNywgbm90IDEuNy4wDQovLyBhbmQgd2UnbGwgbmV2ZXIgcmVhY2ggMS43MC4wIChpZiB3ZSBkbywgd2UgY2VydGFpbmx5IHdvbid0IGJlIHN1cHBvcnRpbmcNCi8vIDEuNyBhbnltb3JlKS4gU2VlICMxMTE5NyBmb3Igd2h5IHdlJ3JlIG5vdCB1c2luZyBmZWF0dXJlIGRldGVjdGlvbi4NCiAgICBpZiAoICQuZm4uanF1ZXJ5LnN1YnN0cmluZyggMCwgMyApID09PSAiMS43IiApIHsNCg0KICAgICAgICAvLyBTZXR0ZXJzIGZvciAuaW5uZXJXaWR0aCgpLCAuaW5uZXJIZWlnaHQoKSwgLm91dGVyV2lkdGgoKSwgLm91dGVySGVpZ2h0KCkNCiAgICAgICAgLy8gVW5saWtlIGpRdWVyeSBDb3JlIDEuOCssIHRoZXNlIG9ubHkgc3VwcG9ydCBudW1lcmljIHZhbHVlcyB0byBzZXQgdGhlDQogICAgICAgIC8vIGRpbWVuc2lvbnMgaW4gcGl4ZWxzDQogICAgICAgICQuZWFjaCggWyAiV2lkdGgiLCAiSGVpZ2h0IiBdLCBmdW5jdGlvbiggaSwgbmFtZSApIHsNCiAgICAgICAgICAgIHZhciBzaWRlID0gbmFtZSA9PT0gIldpZHRoIiA/IFsgIkxlZnQiLCAiUmlnaHQiIF0gOiBbICJUb3AiLCAiQm90dG9tIiBdLA0KICAgICAgICAgICAgICAgIHR5cGUgPSBuYW1lLnRvTG93ZXJDYXNlKCksDQogICAgICAgICAgICAgICAgb3JpZyA9IHsNCiAgICAgICAgICAgICAgICAgICAgaW5uZXJXaWR0aDogJC5mbi5pbm5lcldpZHRoLA0KICAgICAgICAgICAgICAgICAgICBpbm5lckhlaWdodDogJC5mbi5pbm5lckhlaWdodCwNCiAgICAgICAgICAgICAgICAgICAgb3V0ZXJXaWR0aDogJC5mbi5vdXRlcldpZHRoLA0KICAgICAgICAgICAgICAgICAgICBvdXRlckhlaWdodDogJC5mbi5vdXRlckhlaWdodA0KICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIGZ1bmN0aW9uIHJlZHVjZSggZWxlbSwgc2l6ZSwgYm9yZGVyLCBtYXJnaW4gKSB7DQogICAgICAgICAgICAgICAgJC5lYWNoKCBzaWRlLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgc2l6ZSAtPSBwYXJzZUZsb2F0KCAkLmNzcyggZWxlbSwgInBhZGRpbmciICsgdGhpcyApICkgfHwgMDsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBib3JkZXIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzaXplIC09IHBhcnNlRmxvYXQoICQuY3NzKCBlbGVtLCAiYm9yZGVyIiArIHRoaXMgKyAiV2lkdGgiICkgKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICggbWFyZ2luICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSAtPSBwYXJzZUZsb2F0KCAkLmNzcyggZWxlbSwgIm1hcmdpbiIgKyB0aGlzICkgKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIHJldHVybiBzaXplOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkLmZuWyAiaW5uZXIiICsgbmFtZSBdID0gZnVuY3Rpb24oIHNpemUgKSB7DQogICAgICAgICAgICAgICAgaWYgKCBzaXplID09PSB1bmRlZmluZWQgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmlnWyAiaW5uZXIiICsgbmFtZSBdLmNhbGwoIHRoaXMgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgJCggdGhpcyApLmNzcyggdHlwZSwgcmVkdWNlKCB0aGlzLCBzaXplICkgKyAicHgiICk7DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgJC5mblsgIm91dGVyIiArIG5hbWUgXSA9IGZ1bmN0aW9uKCBzaXplLCBtYXJnaW4gKSB7DQogICAgICAgICAgICAgICAgaWYgKCB0eXBlb2Ygc2l6ZSAhPT0gIm51bWJlciIgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmlnWyAib3V0ZXIiICsgbmFtZSBdLmNhbGwoIHRoaXMsIHNpemUgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgJCggdGhpcyApLmNzcyggdHlwZSwgcmVkdWNlKCB0aGlzLCBzaXplLCB0cnVlLCBtYXJnaW4gKSArICJweCIgKTsNCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9ICk7DQoNCiAgICAgICAgJC5mbi5hZGRCYWNrID0gZnVuY3Rpb24oIHNlbGVjdG9yICkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWRkKCBzZWxlY3RvciA9PSBudWxsID8NCiAgICAgICAgICAgICAgICB0aGlzLnByZXZPYmplY3QgOiB0aGlzLnByZXZPYmplY3QuZmlsdGVyKCBzZWxlY3RvciApDQogICAgICAgICAgICApOw0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIDsNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBLZXljb2RlIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBLZXljb2RlDQovLz4+Z3JvdXA6IENvcmUNCi8vPj5kZXNjcmlwdGlvbjogUHJvdmlkZSBrZXljb2RlcyBhcyBrZXluYW1lcw0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2pRdWVyeS51aS5rZXlDb2RlLw0KDQoNCiAgICB2YXIga2V5Y29kZSA9ICQudWkua2V5Q29kZSA9IHsNCiAgICAgICAgQkFDS1NQQUNFOiA4LA0KICAgICAgICBDT01NQTogMTg4LA0KICAgICAgICBERUxFVEU6IDQ2LA0KICAgICAgICBET1dOOiA0MCwNCiAgICAgICAgRU5EOiAzNSwNCiAgICAgICAgRU5URVI6IDEzLA0KICAgICAgICBFU0NBUEU6IDI3LA0KICAgICAgICBIT01FOiAzNiwNCiAgICAgICAgTEVGVDogMzcsDQogICAgICAgIFBBR0VfRE9XTjogMzQsDQogICAgICAgIFBBR0VfVVA6IDMzLA0KICAgICAgICBQRVJJT0Q6IDE5MCwNCiAgICAgICAgUklHSFQ6IDM5LA0KICAgICAgICBTUEFDRTogMzIsDQogICAgICAgIFRBQjogOSwNCiAgICAgICAgVVA6IDM4DQogICAgfTsNCg0KDQoNCg0KLy8gSW50ZXJuYWwgdXNlIG9ubHkNCiAgICB2YXIgZXNjYXBlU2VsZWN0b3IgPSAkLnVpLmVzY2FwZVNlbGVjdG9yID0gKCBmdW5jdGlvbigpIHsNCiAgICAgICAgdmFyIHNlbGVjdG9yRXNjYXBlID0gLyhbISIjJCUmJygpKissLi86Ozw9Pj9AW1xdXmB7fH1+XSkvZzsNCiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCBzZWxlY3RvciApIHsNCiAgICAgICAgICAgIHJldHVybiBzZWxlY3Rvci5yZXBsYWNlKCBzZWxlY3RvckVzY2FwZSwgIlxcJDEiICk7DQogICAgICAgIH07DQogICAgfSApKCk7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIExhYmVscyAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogbGFiZWxzDQovLz4+Z3JvdXA6IENvcmUNCi8vPj5kZXNjcmlwdGlvbjogRmluZCBhbGwgdGhlIGxhYmVscyBhc3NvY2lhdGVkIHdpdGggYSBnaXZlbiBpbnB1dA0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2xhYmVscy8NCg0KDQoNCiAgICB2YXIgbGFiZWxzID0gJC5mbi5sYWJlbHMgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgdmFyIGFuY2VzdG9yLCBzZWxlY3RvciwgaWQsIGxhYmVscywgYW5jZXN0b3JzOw0KDQogICAgICAgIC8vIENoZWNrIGNvbnRyb2wubGFiZWxzIGZpcnN0DQogICAgICAgIGlmICggdGhpc1sgMCBdLmxhYmVscyAmJiB0aGlzWyAwIF0ubGFiZWxzLmxlbmd0aCApIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayggdGhpc1sgMCBdLmxhYmVscyApOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU3VwcG9ydDogSUUgPD0gMTEsIEZGIDw9IDM3LCBBbmRyb2lkIDw9IDIuMyBvbmx5DQogICAgICAgIC8vIEFib3ZlIGJyb3dzZXJzIGRvIG5vdCBzdXBwb3J0IGNvbnRyb2wubGFiZWxzLiBFdmVyeXRoaW5nIGJlbG93IGlzIHRvIHN1cHBvcnQgdGhlbQ0KICAgICAgICAvLyBhcyB3ZWxsIGFzIGRvY3VtZW50IGZyYWdtZW50cy4gY29udHJvbC5sYWJlbHMgZG9lcyBub3Qgd29yayBvbiBkb2N1bWVudCBmcmFnbWVudHMNCiAgICAgICAgbGFiZWxzID0gdGhpcy5lcSggMCApLnBhcmVudHMoICJsYWJlbCIgKTsNCg0KICAgICAgICAvLyBMb29rIGZvciB0aGUgbGFiZWwgYmFzZWQgb24gdGhlIGlkDQogICAgICAgIGlkID0gdGhpcy5hdHRyKCAiaWQiICk7DQogICAgICAgIGlmICggaWQgKSB7DQoNCiAgICAgICAgICAgIC8vIFdlIGRvbid0IHNlYXJjaCBhZ2FpbnN0IHRoZSBkb2N1bWVudCBpbiBjYXNlIHRoZSBlbGVtZW50DQogICAgICAgICAgICAvLyBpcyBkaXNjb25uZWN0ZWQgZnJvbSB0aGUgRE9NDQogICAgICAgICAgICBhbmNlc3RvciA9IHRoaXMuZXEoIDAgKS5wYXJlbnRzKCkubGFzdCgpOw0KDQogICAgICAgICAgICAvLyBHZXQgYSBmdWxsIHNldCBvZiB0b3AgbGV2ZWwgYW5jZXN0b3JzDQogICAgICAgICAgICBhbmNlc3RvcnMgPSBhbmNlc3Rvci5hZGQoIGFuY2VzdG9yLmxlbmd0aCA/IGFuY2VzdG9yLnNpYmxpbmdzKCkgOiB0aGlzLnNpYmxpbmdzKCkgKTsNCg0KICAgICAgICAgICAgLy8gQ3JlYXRlIGEgc2VsZWN0b3IgZm9yIHRoZSBsYWJlbCBiYXNlZCBvbiB0aGUgaWQNCiAgICAgICAgICAgIHNlbGVjdG9yID0gImxhYmVsW2Zvcj0nIiArICQudWkuZXNjYXBlU2VsZWN0b3IoIGlkICkgKyAiJ10iOw0KDQogICAgICAgICAgICBsYWJlbHMgPSBsYWJlbHMuYWRkKCBhbmNlc3RvcnMuZmluZCggc2VsZWN0b3IgKS5hZGRCYWNrKCBzZWxlY3RvciApICk7DQoNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFJldHVybiB3aGF0ZXZlciB3ZSBoYXZlIGZvdW5kIGZvciBsYWJlbHMNCiAgICAgICAgcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBsYWJlbHMgKTsNCiAgICB9Ow0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBTY3JvbGwgUGFyZW50IDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBzY3JvbGxQYXJlbnQNCi8vPj5ncm91cDogQ29yZQ0KLy8+PmRlc2NyaXB0aW9uOiBHZXQgdGhlIGNsb3Nlc3QgYW5jZXN0b3IgZWxlbWVudCB0aGF0IGlzIHNjcm9sbGFibGUuDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vc2Nyb2xsUGFyZW50Lw0KDQoNCg0KICAgIHZhciBzY3JvbGxQYXJlbnQgPSAkLmZuLnNjcm9sbFBhcmVudCA9IGZ1bmN0aW9uKCBpbmNsdWRlSGlkZGVuICkgew0KICAgICAgICB2YXIgcG9zaXRpb24gPSB0aGlzLmNzcyggInBvc2l0aW9uIiApLA0KICAgICAgICAgICAgZXhjbHVkZVN0YXRpY1BhcmVudCA9IHBvc2l0aW9uID09PSAiYWJzb2x1dGUiLA0KICAgICAgICAgICAgb3ZlcmZsb3dSZWdleCA9IGluY2x1ZGVIaWRkZW4gPyAvKGF1dG98c2Nyb2xsfGhpZGRlbikvIDogLyhhdXRvfHNjcm9sbCkvLA0KICAgICAgICAgICAgc2Nyb2xsUGFyZW50ID0gdGhpcy5wYXJlbnRzKCkuZmlsdGVyKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gJCggdGhpcyApOw0KICAgICAgICAgICAgICAgIGlmICggZXhjbHVkZVN0YXRpY1BhcmVudCAmJiBwYXJlbnQuY3NzKCAicG9zaXRpb24iICkgPT09ICJzdGF0aWMiICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiBvdmVyZmxvd1JlZ2V4LnRlc3QoIHBhcmVudC5jc3MoICJvdmVyZmxvdyIgKSArIHBhcmVudC5jc3MoICJvdmVyZmxvdy15IiApICsNCiAgICAgICAgICAgICAgICAgICAgcGFyZW50LmNzcyggIm92ZXJmbG93LXgiICkgKTsNCiAgICAgICAgICAgIH0gKS5lcSggMCApOw0KDQogICAgICAgIHJldHVybiBwb3NpdGlvbiA9PT0gImZpeGVkIiB8fCAhc2Nyb2xsUGFyZW50Lmxlbmd0aCA/DQogICAgICAgICAgICAkKCB0aGlzWyAwIF0ub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudCApIDoNCiAgICAgICAgICAgIHNjcm9sbFBhcmVudDsNCiAgICB9Ow0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBUYWJiYWJsZSAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogOnRhYmJhYmxlIFNlbGVjdG9yDQovLz4+Z3JvdXA6IENvcmUNCi8vPj5kZXNjcmlwdGlvbjogU2VsZWN0cyBlbGVtZW50cyB3aGljaCBjYW4gYmUgdGFiYmVkIHRvLg0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL3RhYmJhYmxlLXNlbGVjdG9yLw0KDQoNCg0KICAgIHZhciB0YWJiYWJsZSA9ICQuZXh0ZW5kKCAkLmV4cHJbICI6IiBdLCB7DQogICAgICAgIHRhYmJhYmxlOiBmdW5jdGlvbiggZWxlbWVudCApIHsNCiAgICAgICAgICAgIHZhciB0YWJJbmRleCA9ICQuYXR0ciggZWxlbWVudCwgInRhYmluZGV4IiApLA0KICAgICAgICAgICAgICAgIGhhc1RhYmluZGV4ID0gdGFiSW5kZXggIT0gbnVsbDsNCiAgICAgICAgICAgIHJldHVybiAoICFoYXNUYWJpbmRleCB8fCB0YWJJbmRleCA+PSAwICkgJiYgJC51aS5mb2N1c2FibGUoIGVsZW1lbnQsIGhhc1RhYmluZGV4ICk7DQogICAgICAgIH0NCiAgICB9ICk7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIFVuaXF1ZSBJRCAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogdW5pcXVlSWQNCi8vPj5ncm91cDogQ29yZQ0KLy8+PmRlc2NyaXB0aW9uOiBGdW5jdGlvbnMgdG8gZ2VuZXJhdGUgYW5kIHJlbW92ZSB1bmlxdWVJZCdzDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vdW5pcXVlSWQvDQoNCg0KDQogICAgdmFyIHVuaXF1ZUlkID0gJC5mbi5leHRlbmQoIHsNCiAgICAgICAgdW5pcXVlSWQ6ICggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgdXVpZCA9IDA7DQoNCiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5pZCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaWQgPSAidWktaWQtIiArICggKyt1dWlkICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9ICkoKSwNCg0KICAgICAgICByZW1vdmVVbmlxdWVJZDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBpZiAoIC9edWktaWQtXGQrJC8udGVzdCggdGhpcy5pZCApICkgew0KICAgICAgICAgICAgICAgICAgICAkKCB0aGlzICkucmVtb3ZlQXR0ciggImlkIiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfQ0KICAgIH0gKTsNCg0KDQogICAgLyohDQogKiBqUXVlcnkgVUkgQWNjb3JkaW9uIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBBY2NvcmRpb24NCi8vPj5ncm91cDogV2lkZ2V0cw0KLy8ganNjczpkaXNhYmxlIG1heGltdW1MaW5lTGVuZ3RoDQovLz4+ZGVzY3JpcHRpb246IERpc3BsYXlzIGNvbGxhcHNpYmxlIGNvbnRlbnQgcGFuZWxzIGZvciBwcmVzZW50aW5nIGluZm9ybWF0aW9uIGluIGEgbGltaXRlZCBhbW91bnQgb2Ygc3BhY2UuDQovLyBqc2NzOmVuYWJsZSBtYXhpbXVtTGluZUxlbmd0aA0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2FjY29yZGlvbi8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9hY2NvcmRpb24vDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29yZS5jc3MNCi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9hY2NvcmRpb24uY3NzDQovLz4+Y3NzLnRoZW1lOiAuLi8uLi90aGVtZXMvYmFzZS90aGVtZS5jc3MNCg0KDQoNCiAgICB2YXIgd2lkZ2V0c0FjY29yZGlvbiA9ICQud2lkZ2V0KCAidWkuYWNjb3JkaW9uIiwgew0KICAgICAgICB2ZXJzaW9uOiAiMS4xMi4xIiwNCiAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgYWN0aXZlOiAwLA0KICAgICAgICAgICAgYW5pbWF0ZToge30sDQogICAgICAgICAgICBjbGFzc2VzOiB7DQogICAgICAgICAgICAgICAgInVpLWFjY29yZGlvbi1oZWFkZXIiOiAidWktY29ybmVyLXRvcCIsDQogICAgICAgICAgICAgICAgInVpLWFjY29yZGlvbi1oZWFkZXItY29sbGFwc2VkIjogInVpLWNvcm5lci1hbGwiLA0KICAgICAgICAgICAgICAgICJ1aS1hY2NvcmRpb24tY29udGVudCI6ICJ1aS1jb3JuZXItYm90dG9tIg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGNvbGxhcHNpYmxlOiBmYWxzZSwNCiAgICAgICAgICAgIGV2ZW50OiAiY2xpY2siLA0KICAgICAgICAgICAgaGVhZGVyOiAiPiBsaSA+IDpmaXJzdC1jaGlsZCwgPiA6bm90KGxpKTpldmVuIiwNCiAgICAgICAgICAgIGhlaWdodFN0eWxlOiAiYXV0byIsDQogICAgICAgICAgICBpY29uczogew0KICAgICAgICAgICAgICAgIGFjdGl2ZUhlYWRlcjogInVpLWljb24tdHJpYW5nbGUtMS1zIiwNCiAgICAgICAgICAgICAgICBoZWFkZXI6ICJ1aS1pY29uLXRyaWFuZ2xlLTEtZSINCiAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgIC8vIENhbGxiYWNrcw0KICAgICAgICAgICAgYWN0aXZhdGU6IG51bGwsDQogICAgICAgICAgICBiZWZvcmVBY3RpdmF0ZTogbnVsbA0KICAgICAgICB9LA0KDQogICAgICAgIGhpZGVQcm9wczogew0KICAgICAgICAgICAgYm9yZGVyVG9wV2lkdGg6ICJoaWRlIiwNCiAgICAgICAgICAgIGJvcmRlckJvdHRvbVdpZHRoOiAiaGlkZSIsDQogICAgICAgICAgICBwYWRkaW5nVG9wOiAiaGlkZSIsDQogICAgICAgICAgICBwYWRkaW5nQm90dG9tOiAiaGlkZSIsDQogICAgICAgICAgICBoZWlnaHQ6ICJoaWRlIg0KICAgICAgICB9LA0KDQogICAgICAgIHNob3dQcm9wczogew0KICAgICAgICAgICAgYm9yZGVyVG9wV2lkdGg6ICJzaG93IiwNCiAgICAgICAgICAgIGJvcmRlckJvdHRvbVdpZHRoOiAic2hvdyIsDQogICAgICAgICAgICBwYWRkaW5nVG9wOiAic2hvdyIsDQogICAgICAgICAgICBwYWRkaW5nQm90dG9tOiAic2hvdyIsDQogICAgICAgICAgICBoZWlnaHQ6ICJzaG93Ig0KICAgICAgICB9LA0KDQogICAgICAgIF9jcmVhdGU6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7DQoNCiAgICAgICAgICAgIHRoaXMucHJldlNob3cgPSB0aGlzLnByZXZIaWRlID0gJCgpOw0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoICJ1aS1hY2NvcmRpb24iLCAidWktd2lkZ2V0IHVpLWhlbHBlci1yZXNldCIgKTsNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hdHRyKCAicm9sZSIsICJ0YWJsaXN0IiApOw0KDQogICAgICAgICAgICAvLyBEb24ndCBhbGxvdyBjb2xsYXBzaWJsZTogZmFsc2UgYW5kIGFjdGl2ZTogZmFsc2UgLyBudWxsDQogICAgICAgICAgICBpZiAoICFvcHRpb25zLmNvbGxhcHNpYmxlICYmICggb3B0aW9ucy5hY3RpdmUgPT09IGZhbHNlIHx8IG9wdGlvbnMuYWN0aXZlID09IG51bGwgKSApIHsNCiAgICAgICAgICAgICAgICBvcHRpb25zLmFjdGl2ZSA9IDA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3NQYW5lbHMoKTsNCg0KICAgICAgICAgICAgLy8gaGFuZGxlIG5lZ2F0aXZlIHZhbHVlcw0KICAgICAgICAgICAgaWYgKCBvcHRpb25zLmFjdGl2ZSA8IDAgKSB7DQogICAgICAgICAgICAgICAgb3B0aW9ucy5hY3RpdmUgKz0gdGhpcy5oZWFkZXJzLmxlbmd0aDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX3JlZnJlc2goKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZ2V0Q3JlYXRlRXZlbnREYXRhOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgaGVhZGVyOiB0aGlzLmFjdGl2ZSwNCiAgICAgICAgICAgICAgICBwYW5lbDogIXRoaXMuYWN0aXZlLmxlbmd0aCA/ICQoKSA6IHRoaXMuYWN0aXZlLm5leHQoKQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfY3JlYXRlSWNvbnM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGljb24sIGNoaWxkcmVuLA0KICAgICAgICAgICAgICAgIGljb25zID0gdGhpcy5vcHRpb25zLmljb25zOw0KDQogICAgICAgICAgICBpZiAoIGljb25zICkgew0KICAgICAgICAgICAgICAgIGljb24gPSAkKCAiPHNwYW4+IiApOw0KICAgICAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCBpY29uLCAidWktYWNjb3JkaW9uLWhlYWRlci1pY29uIiwgInVpLWljb24gIiArIGljb25zLmhlYWRlciApOw0KICAgICAgICAgICAgICAgIGljb24ucHJlcGVuZFRvKCB0aGlzLmhlYWRlcnMgKTsNCiAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IHRoaXMuYWN0aXZlLmNoaWxkcmVuKCAiLnVpLWFjY29yZGlvbi1oZWFkZXItaWNvbiIgKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggY2hpbGRyZW4sIGljb25zLmhlYWRlciApDQogICAgICAgICAgICAgICAgICAgIC5fYWRkQ2xhc3MoIGNoaWxkcmVuLCBudWxsLCBpY29ucy5hY3RpdmVIZWFkZXIgKQ0KICAgICAgICAgICAgICAgICAgICAuX2FkZENsYXNzKCB0aGlzLmhlYWRlcnMsICJ1aS1hY2NvcmRpb24taWNvbnMiICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2Rlc3Ryb3lJY29uczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5oZWFkZXJzLCAidWktYWNjb3JkaW9uLWljb25zIiApOw0KICAgICAgICAgICAgdGhpcy5oZWFkZXJzLmNoaWxkcmVuKCAiLnVpLWFjY29yZGlvbi1oZWFkZXItaWNvbiIgKS5yZW1vdmUoKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZGVzdHJveTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgY29udGVudHM7DQoNCiAgICAgICAgICAgIC8vIENsZWFuIHVwIG1haW4gZWxlbWVudA0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoICJyb2xlIiApOw0KDQogICAgICAgICAgICAvLyBDbGVhbiB1cCBoZWFkZXJzDQogICAgICAgICAgICB0aGlzLmhlYWRlcnMNCiAgICAgICAgICAgICAgICAucmVtb3ZlQXR0ciggInJvbGUgYXJpYS1leHBhbmRlZCBhcmlhLXNlbGVjdGVkIGFyaWEtY29udHJvbHMgdGFiSW5kZXgiICkNCiAgICAgICAgICAgICAgICAucmVtb3ZlVW5pcXVlSWQoKTsNCg0KICAgICAgICAgICAgdGhpcy5fZGVzdHJveUljb25zKCk7DQoNCiAgICAgICAgICAgIC8vIENsZWFuIHVwIGNvbnRlbnQgcGFuZWxzDQogICAgICAgICAgICBjb250ZW50cyA9IHRoaXMuaGVhZGVycy5uZXh0KCkNCiAgICAgICAgICAgICAgICAuY3NzKCAiZGlzcGxheSIsICIiICkNCiAgICAgICAgICAgICAgICAucmVtb3ZlQXR0ciggInJvbGUgYXJpYS1oaWRkZW4gYXJpYS1sYWJlbGxlZGJ5IiApDQogICAgICAgICAgICAgICAgLnJlbW92ZVVuaXF1ZUlkKCk7DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmhlaWdodFN0eWxlICE9PSAiY29udGVudCIgKSB7DQogICAgICAgICAgICAgICAgY29udGVudHMuY3NzKCAiaGVpZ2h0IiwgIiIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHsNCiAgICAgICAgICAgIGlmICgga2V5ID09PSAiYWN0aXZlIiApIHsNCg0KICAgICAgICAgICAgICAgIC8vIF9hY3RpdmF0ZSgpIHdpbGwgaGFuZGxlIGludmFsaWQgdmFsdWVzIGFuZCB1cGRhdGUgdGhpcy5vcHRpb25zDQogICAgICAgICAgICAgICAgdGhpcy5fYWN0aXZhdGUoIHZhbHVlICk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImV2ZW50IiApIHsNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5ldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb2ZmKCB0aGlzLmhlYWRlcnMsIHRoaXMub3B0aW9ucy5ldmVudCApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLl9zZXR1cEV2ZW50cyggdmFsdWUgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTsNCg0KICAgICAgICAgICAgLy8gU2V0dGluZyBjb2xsYXBzaWJsZTogZmFsc2Ugd2hpbGUgY29sbGFwc2VkOyBvcGVuIGZpcnN0IHBhbmVsDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImNvbGxhcHNpYmxlIiAmJiAhdmFsdWUgJiYgdGhpcy5vcHRpb25zLmFjdGl2ZSA9PT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fYWN0aXZhdGUoIDAgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJpY29ucyIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fZGVzdHJveUljb25zKCk7DQogICAgICAgICAgICAgICAgaWYgKCB2YWx1ZSApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3JlYXRlSWNvbnMoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldE9wdGlvbkRpc2FibGVkOiBmdW5jdGlvbiggdmFsdWUgKSB7DQogICAgICAgICAgICB0aGlzLl9zdXBlciggdmFsdWUgKTsNCg0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LmF0dHIoICJhcmlhLWRpc2FibGVkIiwgdmFsdWUgKTsNCg0KICAgICAgICAgICAgLy8gU3VwcG9ydDogSUU4IE9ubHkNCiAgICAgICAgICAgIC8vICM1MzMyIC8gIzYwNTkgLSBvcGFjaXR5IGRvZXNuJ3QgY2FzY2FkZSB0byBwb3NpdGlvbmVkIGVsZW1lbnRzIGluIElFDQogICAgICAgICAgICAvLyBzbyB3ZSBuZWVkIHRvIGFkZCB0aGUgZGlzYWJsZWQgY2xhc3MgdG8gdGhlIGhlYWRlcnMgYW5kIHBhbmVscw0KICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQ2xhc3MoIG51bGwsICJ1aS1zdGF0ZS1kaXNhYmxlZCIsICEhdmFsdWUgKTsNCiAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUNsYXNzKCB0aGlzLmhlYWRlcnMuYWRkKCB0aGlzLmhlYWRlcnMubmV4dCgpICksIG51bGwsICJ1aS1zdGF0ZS1kaXNhYmxlZCIsDQogICAgICAgICAgICAgICAgISF2YWx1ZSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9rZXlkb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICBpZiAoIGV2ZW50LmFsdEtleSB8fCBldmVudC5jdHJsS2V5ICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdmFyIGtleUNvZGUgPSAkLnVpLmtleUNvZGUsDQogICAgICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5oZWFkZXJzLmxlbmd0aCwNCiAgICAgICAgICAgICAgICBjdXJyZW50SW5kZXggPSB0aGlzLmhlYWRlcnMuaW5kZXgoIGV2ZW50LnRhcmdldCApLA0KICAgICAgICAgICAgICAgIHRvRm9jdXMgPSBmYWxzZTsNCg0KICAgICAgICAgICAgc3dpdGNoICggZXZlbnQua2V5Q29kZSApIHsNCiAgICAgICAgICAgICAgICBjYXNlIGtleUNvZGUuUklHSFQ6DQogICAgICAgICAgICAgICAgY2FzZSBrZXlDb2RlLkRPV046DQogICAgICAgICAgICAgICAgICAgIHRvRm9jdXMgPSB0aGlzLmhlYWRlcnNbICggY3VycmVudEluZGV4ICsgMSApICUgbGVuZ3RoIF07DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2Uga2V5Q29kZS5MRUZUOg0KICAgICAgICAgICAgICAgIGNhc2Uga2V5Q29kZS5VUDoNCiAgICAgICAgICAgICAgICAgICAgdG9Gb2N1cyA9IHRoaXMuaGVhZGVyc1sgKCBjdXJyZW50SW5kZXggLSAxICsgbGVuZ3RoICkgJSBsZW5ndGggXTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSBrZXlDb2RlLlNQQUNFOg0KICAgICAgICAgICAgICAgIGNhc2Uga2V5Q29kZS5FTlRFUjoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRIYW5kbGVyKCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIGtleUNvZGUuSE9NRToNCiAgICAgICAgICAgICAgICAgICAgdG9Gb2N1cyA9IHRoaXMuaGVhZGVyc1sgMCBdOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIGtleUNvZGUuRU5EOg0KICAgICAgICAgICAgICAgICAgICB0b0ZvY3VzID0gdGhpcy5oZWFkZXJzWyBsZW5ndGggLSAxIF07DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHRvRm9jdXMgKSB7DQogICAgICAgICAgICAgICAgJCggZXZlbnQudGFyZ2V0ICkuYXR0ciggInRhYkluZGV4IiwgLTEgKTsNCiAgICAgICAgICAgICAgICAkKCB0b0ZvY3VzICkuYXR0ciggInRhYkluZGV4IiwgMCApOw0KICAgICAgICAgICAgICAgICQoIHRvRm9jdXMgKS50cmlnZ2VyKCAiZm9jdXMiICk7DQogICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfcGFuZWxLZXlEb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICBpZiAoIGV2ZW50LmtleUNvZGUgPT09ICQudWkua2V5Q29kZS5VUCAmJiBldmVudC5jdHJsS2V5ICkgew0KICAgICAgICAgICAgICAgICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKS5wcmV2KCkudHJpZ2dlciggImZvY3VzIiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHJlZnJlc2g6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7DQogICAgICAgICAgICB0aGlzLl9wcm9jZXNzUGFuZWxzKCk7DQoNCiAgICAgICAgICAgIC8vIFdhcyBjb2xsYXBzZWQgb3Igbm8gcGFuZWwNCiAgICAgICAgICAgIGlmICggKCBvcHRpb25zLmFjdGl2ZSA9PT0gZmFsc2UgJiYgb3B0aW9ucy5jb2xsYXBzaWJsZSA9PT0gdHJ1ZSApIHx8DQogICAgICAgICAgICAgICAgIXRoaXMuaGVhZGVycy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgb3B0aW9ucy5hY3RpdmUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZSA9ICQoKTsNCg0KICAgICAgICAgICAgICAgIC8vIGFjdGl2ZSBmYWxzZSBvbmx5IHdoZW4gY29sbGFwc2libGUgaXMgdHJ1ZQ0KICAgICAgICAgICAgfSBlbHNlIGlmICggb3B0aW9ucy5hY3RpdmUgPT09IGZhbHNlICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX2FjdGl2YXRlKCAwICk7DQoNCiAgICAgICAgICAgICAgICAvLyB3YXMgYWN0aXZlLCBidXQgYWN0aXZlIHBhbmVsIGlzIGdvbmUNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHRoaXMuYWN0aXZlLmxlbmd0aCAmJiAhJC5jb250YWlucyggdGhpcy5lbGVtZW50WyAwIF0sIHRoaXMuYWN0aXZlWyAwIF0gKSApIHsNCg0KICAgICAgICAgICAgICAgIC8vIGFsbCByZW1haW5pbmcgcGFuZWwgYXJlIGRpc2FibGVkDQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLmhlYWRlcnMubGVuZ3RoID09PSB0aGlzLmhlYWRlcnMuZmluZCggIi51aS1zdGF0ZS1kaXNhYmxlZCIgKS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuYWN0aXZlID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gJCgpOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIGFjdGl2YXRlIHByZXZpb3VzIHBhbmVsDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWN0aXZhdGUoIE1hdGgubWF4KCAwLCBvcHRpb25zLmFjdGl2ZSAtIDEgKSApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIHdhcyBhY3RpdmUsIGFjdGl2ZSBwYW5lbCBzdGlsbCBleGlzdHMNCiAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUgYWN0aXZlIGluZGV4IGlzIGNvcnJlY3QNCiAgICAgICAgICAgICAgICBvcHRpb25zLmFjdGl2ZSA9IHRoaXMuaGVhZGVycy5pbmRleCggdGhpcy5hY3RpdmUgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fZGVzdHJveUljb25zKCk7DQoNCiAgICAgICAgICAgIHRoaXMuX3JlZnJlc2goKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcHJvY2Vzc1BhbmVsczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgcHJldkhlYWRlcnMgPSB0aGlzLmhlYWRlcnMsDQogICAgICAgICAgICAgICAgcHJldlBhbmVscyA9IHRoaXMucGFuZWxzOw0KDQogICAgICAgICAgICB0aGlzLmhlYWRlcnMgPSB0aGlzLmVsZW1lbnQuZmluZCggdGhpcy5vcHRpb25zLmhlYWRlciApOw0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMuaGVhZGVycywgInVpLWFjY29yZGlvbi1oZWFkZXIgdWktYWNjb3JkaW9uLWhlYWRlci1jb2xsYXBzZWQiLA0KICAgICAgICAgICAgICAgICJ1aS1zdGF0ZS1kZWZhdWx0IiApOw0KDQogICAgICAgICAgICB0aGlzLnBhbmVscyA9IHRoaXMuaGVhZGVycy5uZXh0KCkuZmlsdGVyKCAiOm5vdCgudWktYWNjb3JkaW9uLWNvbnRlbnQtYWN0aXZlKSIgKS5oaWRlKCk7DQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy5wYW5lbHMsICJ1aS1hY2NvcmRpb24tY29udGVudCIsICJ1aS1oZWxwZXItcmVzZXQgdWktd2lkZ2V0LWNvbnRlbnQiICk7DQoNCiAgICAgICAgICAgIC8vIEF2b2lkIG1lbW9yeSBsZWFrcyAoIzEwMDU2KQ0KICAgICAgICAgICAgaWYgKCBwcmV2UGFuZWxzICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX29mZiggcHJldkhlYWRlcnMubm90KCB0aGlzLmhlYWRlcnMgKSApOw0KICAgICAgICAgICAgICAgIHRoaXMuX29mZiggcHJldlBhbmVscy5ub3QoIHRoaXMucGFuZWxzICkgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfcmVmcmVzaDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgbWF4SGVpZ2h0LA0KICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsDQogICAgICAgICAgICAgICAgaGVpZ2h0U3R5bGUgPSBvcHRpb25zLmhlaWdodFN0eWxlLA0KICAgICAgICAgICAgICAgIHBhcmVudCA9IHRoaXMuZWxlbWVudC5wYXJlbnQoKTsNCg0KICAgICAgICAgICAgdGhpcy5hY3RpdmUgPSB0aGlzLl9maW5kQWN0aXZlKCBvcHRpb25zLmFjdGl2ZSApOw0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMuYWN0aXZlLCAidWktYWNjb3JkaW9uLWhlYWRlci1hY3RpdmUiLCAidWktc3RhdGUtYWN0aXZlIiApDQogICAgICAgICAgICAgICAgLl9yZW1vdmVDbGFzcyggdGhpcy5hY3RpdmUsICJ1aS1hY2NvcmRpb24taGVhZGVyLWNvbGxhcHNlZCIgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLmFjdGl2ZS5uZXh0KCksICJ1aS1hY2NvcmRpb24tY29udGVudC1hY3RpdmUiICk7DQogICAgICAgICAgICB0aGlzLmFjdGl2ZS5uZXh0KCkuc2hvdygpOw0KDQogICAgICAgICAgICB0aGlzLmhlYWRlcnMNCiAgICAgICAgICAgICAgICAuYXR0ciggInJvbGUiLCAidGFiIiApDQogICAgICAgICAgICAgICAgLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgaGVhZGVyID0gJCggdGhpcyApLA0KICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVySWQgPSBoZWFkZXIudW5pcXVlSWQoKS5hdHRyKCAiaWQiICksDQogICAgICAgICAgICAgICAgICAgICAgICBwYW5lbCA9IGhlYWRlci5uZXh0KCksDQogICAgICAgICAgICAgICAgICAgICAgICBwYW5lbElkID0gcGFuZWwudW5pcXVlSWQoKS5hdHRyKCAiaWQiICk7DQogICAgICAgICAgICAgICAgICAgIGhlYWRlci5hdHRyKCAiYXJpYS1jb250cm9scyIsIHBhbmVsSWQgKTsNCiAgICAgICAgICAgICAgICAgICAgcGFuZWwuYXR0ciggImFyaWEtbGFiZWxsZWRieSIsIGhlYWRlcklkICk7DQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLm5leHQoKQ0KICAgICAgICAgICAgICAgIC5hdHRyKCAicm9sZSIsICJ0YWJwYW5lbCIgKTsNCg0KICAgICAgICAgICAgdGhpcy5oZWFkZXJzDQogICAgICAgICAgICAgICAgLm5vdCggdGhpcy5hY3RpdmUgKQ0KICAgICAgICAgICAgICAgIC5hdHRyKCB7DQogICAgICAgICAgICAgICAgICAgICJhcmlhLXNlbGVjdGVkIjogImZhbHNlIiwNCiAgICAgICAgICAgICAgICAgICAgImFyaWEtZXhwYW5kZWQiOiAiZmFsc2UiLA0KICAgICAgICAgICAgICAgICAgICB0YWJJbmRleDogLTENCiAgICAgICAgICAgICAgICB9ICkNCiAgICAgICAgICAgICAgICAubmV4dCgpDQogICAgICAgICAgICAgICAgLmF0dHIoIHsNCiAgICAgICAgICAgICAgICAgICAgImFyaWEtaGlkZGVuIjogInRydWUiDQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLmhpZGUoKTsNCg0KICAgICAgICAgICAgLy8gTWFrZSBzdXJlIGF0IGxlYXN0IG9uZSBoZWFkZXIgaXMgaW4gdGhlIHRhYiBvcmRlcg0KICAgICAgICAgICAgaWYgKCAhdGhpcy5hY3RpdmUubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVycy5lcSggMCApLmF0dHIoICJ0YWJJbmRleCIsIDAgKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUuYXR0ciggew0KICAgICAgICAgICAgICAgICAgICAiYXJpYS1zZWxlY3RlZCI6ICJ0cnVlIiwNCiAgICAgICAgICAgICAgICAgICAgImFyaWEtZXhwYW5kZWQiOiAidHJ1ZSIsDQogICAgICAgICAgICAgICAgICAgIHRhYkluZGV4OiAwDQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgICAgIC5uZXh0KCkNCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJhcmlhLWhpZGRlbiI6ICJmYWxzZSINCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLl9jcmVhdGVJY29ucygpOw0KDQogICAgICAgICAgICB0aGlzLl9zZXR1cEV2ZW50cyggb3B0aW9ucy5ldmVudCApOw0KDQogICAgICAgICAgICBpZiAoIGhlaWdodFN0eWxlID09PSAiZmlsbCIgKSB7DQogICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gcGFyZW50LmhlaWdodCgpOw0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zaWJsaW5ncyggIjp2aXNpYmxlIiApLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbSA9ICQoIHRoaXMgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gZWxlbS5jc3MoICJwb3NpdGlvbiIgKTsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoIHBvc2l0aW9uID09PSAiYWJzb2x1dGUiIHx8IHBvc2l0aW9uID09PSAiZml4ZWQiICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIG1heEhlaWdodCAtPSBlbGVtLm91dGVySGVpZ2h0KCB0cnVlICk7DQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgdGhpcy5oZWFkZXJzLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBtYXhIZWlnaHQgLT0gJCggdGhpcyApLm91dGVySGVpZ2h0KCB0cnVlICk7DQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgdGhpcy5oZWFkZXJzLm5leHQoKQ0KICAgICAgICAgICAgICAgICAgICAuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkKCB0aGlzICkuaGVpZ2h0KCBNYXRoLm1heCggMCwgbWF4SGVpZ2h0IC0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCB0aGlzICkuaW5uZXJIZWlnaHQoKSArICQoIHRoaXMgKS5oZWlnaHQoKSApICk7DQogICAgICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgICAgICAuY3NzKCAib3ZlcmZsb3ciLCAiYXV0byIgKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGhlaWdodFN0eWxlID09PSAiYXV0byIgKSB7DQogICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gMDsNCiAgICAgICAgICAgICAgICB0aGlzLmhlYWRlcnMubmV4dCgpDQogICAgICAgICAgICAgICAgICAgIC5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc1Zpc2libGUgPSAkKCB0aGlzICkuaXMoICI6dmlzaWJsZSIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggIWlzVmlzaWJsZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCB0aGlzICkuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gTWF0aC5tYXgoIG1heEhlaWdodCwgJCggdGhpcyApLmNzcyggImhlaWdodCIsICIiICkuaGVpZ2h0KCkgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggIWlzVmlzaWJsZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCB0aGlzICkuaGlkZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9ICkNCiAgICAgICAgICAgICAgICAgICAgLmhlaWdodCggbWF4SGVpZ2h0ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2FjdGl2YXRlOiBmdW5jdGlvbiggaW5kZXggKSB7DQogICAgICAgICAgICB2YXIgYWN0aXZlID0gdGhpcy5fZmluZEFjdGl2ZSggaW5kZXggKVsgMCBdOw0KDQogICAgICAgICAgICAvLyBUcnlpbmcgdG8gYWN0aXZhdGUgdGhlIGFscmVhZHkgYWN0aXZlIHBhbmVsDQogICAgICAgICAgICBpZiAoIGFjdGl2ZSA9PT0gdGhpcy5hY3RpdmVbIDAgXSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFRyeWluZyB0byBjb2xsYXBzZSwgc2ltdWxhdGUgYSBjbGljayBvbiB0aGUgY3VycmVudGx5IGFjdGl2ZSBoZWFkZXINCiAgICAgICAgICAgIGFjdGl2ZSA9IGFjdGl2ZSB8fCB0aGlzLmFjdGl2ZVsgMCBdOw0KDQogICAgICAgICAgICB0aGlzLl9ldmVudEhhbmRsZXIoIHsNCiAgICAgICAgICAgICAgICB0YXJnZXQ6IGFjdGl2ZSwNCiAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0OiBhY3RpdmUsDQogICAgICAgICAgICAgICAgcHJldmVudERlZmF1bHQ6ICQubm9vcA0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9maW5kQWN0aXZlOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7DQogICAgICAgICAgICByZXR1cm4gdHlwZW9mIHNlbGVjdG9yID09PSAibnVtYmVyIiA/IHRoaXMuaGVhZGVycy5lcSggc2VsZWN0b3IgKSA6ICQoKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0dXBFdmVudHM6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciBldmVudHMgPSB7DQogICAgICAgICAgICAgICAga2V5ZG93bjogIl9rZXlkb3duIg0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIGlmICggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgJC5lYWNoKCBldmVudC5zcGxpdCggIiAiICksIGZ1bmN0aW9uKCBpbmRleCwgZXZlbnROYW1lICkgew0KICAgICAgICAgICAgICAgICAgICBldmVudHNbIGV2ZW50TmFtZSBdID0gIl9ldmVudEhhbmRsZXIiOw0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fb2ZmKCB0aGlzLmhlYWRlcnMuYWRkKCB0aGlzLmhlYWRlcnMubmV4dCgpICkgKTsNCiAgICAgICAgICAgIHRoaXMuX29uKCB0aGlzLmhlYWRlcnMsIGV2ZW50cyApOw0KICAgICAgICAgICAgdGhpcy5fb24oIHRoaXMuaGVhZGVycy5uZXh0KCksIHsga2V5ZG93bjogIl9wYW5lbEtleURvd24iIH0gKTsNCiAgICAgICAgICAgIHRoaXMuX2hvdmVyYWJsZSggdGhpcy5oZWFkZXJzICk7DQogICAgICAgICAgICB0aGlzLl9mb2N1c2FibGUoIHRoaXMuaGVhZGVycyApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9ldmVudEhhbmRsZXI6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciBhY3RpdmVDaGlsZHJlbiwgY2xpY2tlZENoaWxkcmVuLA0KICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsDQogICAgICAgICAgICAgICAgYWN0aXZlID0gdGhpcy5hY3RpdmUsDQogICAgICAgICAgICAgICAgY2xpY2tlZCA9ICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwNCiAgICAgICAgICAgICAgICBjbGlja2VkSXNBY3RpdmUgPSBjbGlja2VkWyAwIF0gPT09IGFjdGl2ZVsgMCBdLA0KICAgICAgICAgICAgICAgIGNvbGxhcHNpbmcgPSBjbGlja2VkSXNBY3RpdmUgJiYgb3B0aW9ucy5jb2xsYXBzaWJsZSwNCiAgICAgICAgICAgICAgICB0b1Nob3cgPSBjb2xsYXBzaW5nID8gJCgpIDogY2xpY2tlZC5uZXh0KCksDQogICAgICAgICAgICAgICAgdG9IaWRlID0gYWN0aXZlLm5leHQoKSwNCiAgICAgICAgICAgICAgICBldmVudERhdGEgPSB7DQogICAgICAgICAgICAgICAgICAgIG9sZEhlYWRlcjogYWN0aXZlLA0KICAgICAgICAgICAgICAgICAgICBvbGRQYW5lbDogdG9IaWRlLA0KICAgICAgICAgICAgICAgICAgICBuZXdIZWFkZXI6IGNvbGxhcHNpbmcgPyAkKCkgOiBjbGlja2VkLA0KICAgICAgICAgICAgICAgICAgICBuZXdQYW5lbDogdG9TaG93DQogICAgICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCg0KICAgICAgICAgICAgaWYgKA0KDQogICAgICAgICAgICAgICAgLy8gY2xpY2sgb24gYWN0aXZlIGhlYWRlciwgYnV0IG5vdCBjb2xsYXBzaWJsZQ0KICAgICAgICAgICAgICAgICggY2xpY2tlZElzQWN0aXZlICYmICFvcHRpb25zLmNvbGxhcHNpYmxlICkgfHwNCg0KICAgICAgICAgICAgICAgIC8vIGFsbG93IGNhbmNlbGluZyBhY3RpdmF0aW9uDQogICAgICAgICAgICAgICAgKCB0aGlzLl90cmlnZ2VyKCAiYmVmb3JlQWN0aXZhdGUiLCBldmVudCwgZXZlbnREYXRhICkgPT09IGZhbHNlICkgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBvcHRpb25zLmFjdGl2ZSA9IGNvbGxhcHNpbmcgPyBmYWxzZSA6IHRoaXMuaGVhZGVycy5pbmRleCggY2xpY2tlZCApOw0KDQogICAgICAgICAgICAvLyBXaGVuIHRoZSBjYWxsIHRvIC5fdG9nZ2xlKCkgY29tZXMgYWZ0ZXIgdGhlIGNsYXNzIGNoYW5nZXMNCiAgICAgICAgICAgIC8vIGl0IGNhdXNlcyBhIHZlcnkgb2RkIGJ1ZyBpbiBJRSA4IChzZWUgIzY3MjApDQogICAgICAgICAgICB0aGlzLmFjdGl2ZSA9IGNsaWNrZWRJc0FjdGl2ZSA/ICQoKSA6IGNsaWNrZWQ7DQogICAgICAgICAgICB0aGlzLl90b2dnbGUoIGV2ZW50RGF0YSApOw0KDQogICAgICAgICAgICAvLyBTd2l0Y2ggY2xhc3Nlcw0KICAgICAgICAgICAgLy8gY29ybmVyIGNsYXNzZXMgb24gdGhlIHByZXZpb3VzbHkgYWN0aXZlIGhlYWRlciBzdGF5IGFmdGVyIHRoZSBhbmltYXRpb24NCiAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCBhY3RpdmUsICJ1aS1hY2NvcmRpb24taGVhZGVyLWFjdGl2ZSIsICJ1aS1zdGF0ZS1hY3RpdmUiICk7DQogICAgICAgICAgICBpZiAoIG9wdGlvbnMuaWNvbnMgKSB7DQogICAgICAgICAgICAgICAgYWN0aXZlQ2hpbGRyZW4gPSBhY3RpdmUuY2hpbGRyZW4oICIudWktYWNjb3JkaW9uLWhlYWRlci1pY29uIiApOw0KICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCBhY3RpdmVDaGlsZHJlbiwgbnVsbCwgb3B0aW9ucy5pY29ucy5hY3RpdmVIZWFkZXIgKQ0KICAgICAgICAgICAgICAgICAgICAuX2FkZENsYXNzKCBhY3RpdmVDaGlsZHJlbiwgbnVsbCwgb3B0aW9ucy5pY29ucy5oZWFkZXIgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCAhY2xpY2tlZElzQWN0aXZlICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCBjbGlja2VkLCAidWktYWNjb3JkaW9uLWhlYWRlci1jb2xsYXBzZWQiICkNCiAgICAgICAgICAgICAgICAgICAgLl9hZGRDbGFzcyggY2xpY2tlZCwgInVpLWFjY29yZGlvbi1oZWFkZXItYWN0aXZlIiwgInVpLXN0YXRlLWFjdGl2ZSIgKTsNCiAgICAgICAgICAgICAgICBpZiAoIG9wdGlvbnMuaWNvbnMgKSB7DQogICAgICAgICAgICAgICAgICAgIGNsaWNrZWRDaGlsZHJlbiA9IGNsaWNrZWQuY2hpbGRyZW4oICIudWktYWNjb3JkaW9uLWhlYWRlci1pY29uIiApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggY2xpY2tlZENoaWxkcmVuLCBudWxsLCBvcHRpb25zLmljb25zLmhlYWRlciApDQogICAgICAgICAgICAgICAgICAgICAgICAuX2FkZENsYXNzKCBjbGlja2VkQ2hpbGRyZW4sIG51bGwsIG9wdGlvbnMuaWNvbnMuYWN0aXZlSGVhZGVyICk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIGNsaWNrZWQubmV4dCgpLCAidWktYWNjb3JkaW9uLWNvbnRlbnQtYWN0aXZlIiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF90b2dnbGU6IGZ1bmN0aW9uKCBkYXRhICkgew0KICAgICAgICAgICAgdmFyIHRvU2hvdyA9IGRhdGEubmV3UGFuZWwsDQogICAgICAgICAgICAgICAgdG9IaWRlID0gdGhpcy5wcmV2U2hvdy5sZW5ndGggPyB0aGlzLnByZXZTaG93IDogZGF0YS5vbGRQYW5lbDsNCg0KICAgICAgICAgICAgLy8gSGFuZGxlIGFjdGl2YXRpbmcgYSBwYW5lbCBkdXJpbmcgdGhlIGFuaW1hdGlvbiBmb3IgYW5vdGhlciBhY3RpdmF0aW9uDQogICAgICAgICAgICB0aGlzLnByZXZTaG93LmFkZCggdGhpcy5wcmV2SGlkZSApLnN0b3AoIHRydWUsIHRydWUgKTsNCiAgICAgICAgICAgIHRoaXMucHJldlNob3cgPSB0b1Nob3c7DQogICAgICAgICAgICB0aGlzLnByZXZIaWRlID0gdG9IaWRlOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5hbmltYXRlICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX2FuaW1hdGUoIHRvU2hvdywgdG9IaWRlLCBkYXRhICk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRvSGlkZS5oaWRlKCk7DQogICAgICAgICAgICAgICAgdG9TaG93LnNob3coKTsNCiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVDb21wbGV0ZSggZGF0YSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0b0hpZGUuYXR0ciggew0KICAgICAgICAgICAgICAgICJhcmlhLWhpZGRlbiI6ICJ0cnVlIg0KICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgdG9IaWRlLnByZXYoKS5hdHRyKCB7DQogICAgICAgICAgICAgICAgImFyaWEtc2VsZWN0ZWQiOiAiZmFsc2UiLA0KICAgICAgICAgICAgICAgICJhcmlhLWV4cGFuZGVkIjogImZhbHNlIg0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAvLyBpZiB3ZSdyZSBzd2l0Y2hpbmcgcGFuZWxzLCByZW1vdmUgdGhlIG9sZCBoZWFkZXIgZnJvbSB0aGUgdGFiIG9yZGVyDQogICAgICAgICAgICAvLyBpZiB3ZSdyZSBvcGVuaW5nIGZyb20gY29sbGFwc2VkIHN0YXRlLCByZW1vdmUgdGhlIHByZXZpb3VzIGhlYWRlciBmcm9tIHRoZSB0YWIgb3JkZXINCiAgICAgICAgICAgIC8vIGlmIHdlJ3JlIGNvbGxhcHNpbmcsIHRoZW4ga2VlcCB0aGUgY29sbGFwc2luZyBoZWFkZXIgaW4gdGhlIHRhYiBvcmRlcg0KICAgICAgICAgICAgaWYgKCB0b1Nob3cubGVuZ3RoICYmIHRvSGlkZS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgdG9IaWRlLnByZXYoKS5hdHRyKCB7DQogICAgICAgICAgICAgICAgICAgICJ0YWJJbmRleCI6IC0xLA0KICAgICAgICAgICAgICAgICAgICAiYXJpYS1leHBhbmRlZCI6ICJmYWxzZSINCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKCB0b1Nob3cubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVycy5maWx0ZXIoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoICQoIHRoaXMgKS5hdHRyKCAidGFiSW5kZXgiICksIDEwICkgPT09IDA7DQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgICAgIC5hdHRyKCAidGFiSW5kZXgiLCAtMSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0b1Nob3cNCiAgICAgICAgICAgICAgICAuYXR0ciggImFyaWEtaGlkZGVuIiwgImZhbHNlIiApDQogICAgICAgICAgICAgICAgLnByZXYoKQ0KICAgICAgICAgICAgICAgIC5hdHRyKCB7DQogICAgICAgICAgICAgICAgICAgICJhcmlhLXNlbGVjdGVkIjogInRydWUiLA0KICAgICAgICAgICAgICAgICAgICAiYXJpYS1leHBhbmRlZCI6ICJ0cnVlIiwNCiAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg6IDANCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2FuaW1hdGU6IGZ1bmN0aW9uKCB0b1Nob3csIHRvSGlkZSwgZGF0YSApIHsNCiAgICAgICAgICAgIHZhciB0b3RhbCwgZWFzaW5nLCBkdXJhdGlvbiwNCiAgICAgICAgICAgICAgICB0aGF0ID0gdGhpcywNCiAgICAgICAgICAgICAgICBhZGp1c3QgPSAwLA0KICAgICAgICAgICAgICAgIGJveFNpemluZyA9IHRvU2hvdy5jc3MoICJib3gtc2l6aW5nIiApLA0KICAgICAgICAgICAgICAgIGRvd24gPSB0b1Nob3cubGVuZ3RoICYmDQogICAgICAgICAgICAgICAgICAgICggIXRvSGlkZS5sZW5ndGggfHwgKCB0b1Nob3cuaW5kZXgoKSA8IHRvSGlkZS5pbmRleCgpICkgKSwNCiAgICAgICAgICAgICAgICBhbmltYXRlID0gdGhpcy5vcHRpb25zLmFuaW1hdGUgfHwge30sDQogICAgICAgICAgICAgICAgb3B0aW9ucyA9IGRvd24gJiYgYW5pbWF0ZS5kb3duIHx8IGFuaW1hdGUsDQogICAgICAgICAgICAgICAgY29tcGxldGUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fdG9nZ2xlQ29tcGxldGUoIGRhdGEgKTsNCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICBpZiAoIHR5cGVvZiBvcHRpb25zID09PSAibnVtYmVyIiApIHsNCiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IG9wdGlvbnM7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIHR5cGVvZiBvcHRpb25zID09PSAic3RyaW5nIiApIHsNCiAgICAgICAgICAgICAgICBlYXNpbmcgPSBvcHRpb25zOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBmYWxsIGJhY2sgZnJvbSBvcHRpb25zIHRvIGFuaW1hdGlvbiBpbiBjYXNlIG9mIHBhcnRpYWwgZG93biBzZXR0aW5ncw0KICAgICAgICAgICAgZWFzaW5nID0gZWFzaW5nIHx8IG9wdGlvbnMuZWFzaW5nIHx8IGFuaW1hdGUuZWFzaW5nOw0KICAgICAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbiB8fCBvcHRpb25zLmR1cmF0aW9uIHx8IGFuaW1hdGUuZHVyYXRpb247DQoNCiAgICAgICAgICAgIGlmICggIXRvSGlkZS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRvU2hvdy5hbmltYXRlKCB0aGlzLnNob3dQcm9wcywgZHVyYXRpb24sIGVhc2luZywgY29tcGxldGUgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggIXRvU2hvdy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRvSGlkZS5hbmltYXRlKCB0aGlzLmhpZGVQcm9wcywgZHVyYXRpb24sIGVhc2luZywgY29tcGxldGUgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdG90YWwgPSB0b1Nob3cuc2hvdygpLm91dGVySGVpZ2h0KCk7DQogICAgICAgICAgICB0b0hpZGUuYW5pbWF0ZSggdGhpcy5oaWRlUHJvcHMsIHsNCiAgICAgICAgICAgICAgICBkdXJhdGlvbjogZHVyYXRpb24sDQogICAgICAgICAgICAgICAgZWFzaW5nOiBlYXNpbmcsDQogICAgICAgICAgICAgICAgc3RlcDogZnVuY3Rpb24oIG5vdywgZnggKSB7DQogICAgICAgICAgICAgICAgICAgIGZ4Lm5vdyA9IE1hdGgucm91bmQoIG5vdyApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIHRvU2hvdw0KICAgICAgICAgICAgICAgIC5oaWRlKCkNCiAgICAgICAgICAgICAgICAuYW5pbWF0ZSggdGhpcy5zaG93UHJvcHMsIHsNCiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IGR1cmF0aW9uLA0KICAgICAgICAgICAgICAgICAgICBlYXNpbmc6IGVhc2luZywNCiAgICAgICAgICAgICAgICAgICAgY29tcGxldGU6IGNvbXBsZXRlLA0KICAgICAgICAgICAgICAgICAgICBzdGVwOiBmdW5jdGlvbiggbm93LCBmeCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZ4Lm5vdyA9IE1hdGgucm91bmQoIG5vdyApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBmeC5wcm9wICE9PSAiaGVpZ2h0IiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGJveFNpemluZyA9PT0gImNvbnRlbnQtYm94IiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRqdXN0ICs9IGZ4Lm5vdzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB0aGF0Lm9wdGlvbnMuaGVpZ2h0U3R5bGUgIT09ICJjb250ZW50IiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmeC5ub3cgPSBNYXRoLnJvdW5kKCB0b3RhbCAtIHRvSGlkZS5vdXRlckhlaWdodCgpIC0gYWRqdXN0ICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRqdXN0ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfdG9nZ2xlQ29tcGxldGU6IGZ1bmN0aW9uKCBkYXRhICkgew0KICAgICAgICAgICAgdmFyIHRvSGlkZSA9IGRhdGEub2xkUGFuZWwsDQogICAgICAgICAgICAgICAgcHJldiA9IHRvSGlkZS5wcmV2KCk7DQoNCiAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCB0b0hpZGUsICJ1aS1hY2NvcmRpb24tY29udGVudC1hY3RpdmUiICk7DQogICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggcHJldiwgInVpLWFjY29yZGlvbi1oZWFkZXItYWN0aXZlIiApDQogICAgICAgICAgICAgICAgLl9hZGRDbGFzcyggcHJldiwgInVpLWFjY29yZGlvbi1oZWFkZXItY29sbGFwc2VkIiApOw0KDQogICAgICAgICAgICAvLyBXb3JrIGFyb3VuZCBmb3IgcmVuZGVyaW5nIGJ1ZyBpbiBJRSAoIzU0MjEpDQogICAgICAgICAgICBpZiAoIHRvSGlkZS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgdG9IaWRlLnBhcmVudCgpWyAwIF0uY2xhc3NOYW1lID0gdG9IaWRlLnBhcmVudCgpWyAwIF0uY2xhc3NOYW1lOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5fdHJpZ2dlciggImFjdGl2YXRlIiwgbnVsbCwgZGF0YSApOw0KICAgICAgICB9DQogICAgfSApOw0KDQoNCg0KICAgIHZhciBzYWZlQWN0aXZlRWxlbWVudCA9ICQudWkuc2FmZUFjdGl2ZUVsZW1lbnQgPSBmdW5jdGlvbiggZG9jdW1lbnQgKSB7DQogICAgICAgIHZhciBhY3RpdmVFbGVtZW50Ow0KDQogICAgICAgIC8vIFN1cHBvcnQ6IElFIDkgb25seQ0KICAgICAgICAvLyBJRTkgdGhyb3dzIGFuICJVbnNwZWNpZmllZCBlcnJvciIgYWNjZXNzaW5nIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgZnJvbSBhbiA8aWZyYW1lPg0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgYWN0aXZlRWxlbWVudCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7DQogICAgICAgIH0gY2F0Y2ggKCBlcnJvciApIHsNCiAgICAgICAgICAgIGFjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5ib2R5Ow0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU3VwcG9ydDogSUUgOSAtIDExIG9ubHkNCiAgICAgICAgLy8gSUUgbWF5IHJldHVybiBudWxsIGluc3RlYWQgb2YgYW4gZWxlbWVudA0KICAgICAgICAvLyBJbnRlcmVzdGluZ2x5LCB0aGlzIG9ubHkgc2VlbXMgdG8gb2NjdXIgd2hlbiBOT1QgaW4gYW4gaWZyYW1lDQogICAgICAgIGlmICggIWFjdGl2ZUVsZW1lbnQgKSB7DQogICAgICAgICAgICBhY3RpdmVFbGVtZW50ID0gZG9jdW1lbnQuYm9keTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFN1cHBvcnQ6IElFIDExIG9ubHkNCiAgICAgICAgLy8gSUUxMSByZXR1cm5zIGEgc2VlbWluZ2x5IGVtcHR5IG9iamVjdCBpbiBzb21lIGNhc2VzIHdoZW4gYWNjZXNzaW5nDQogICAgICAgIC8vIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgZnJvbSBhbiA8aWZyYW1lPg0KICAgICAgICBpZiAoICFhY3RpdmVFbGVtZW50Lm5vZGVOYW1lICkgew0KICAgICAgICAgICAgYWN0aXZlRWxlbWVudCA9IGRvY3VtZW50LmJvZHk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gYWN0aXZlRWxlbWVudDsNCiAgICB9Ow0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBNZW51IDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBNZW51DQovLz4+Z3JvdXA6IFdpZGdldHMNCi8vPj5kZXNjcmlwdGlvbjogQ3JlYXRlcyBuZXN0YWJsZSBtZW51cy4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9tZW51Lw0KLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL21lbnUvDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29yZS5jc3MNCi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9tZW51LmNzcw0KLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzDQoNCg0KDQogICAgdmFyIHdpZGdldHNNZW51ID0gJC53aWRnZXQoICJ1aS5tZW51Iiwgew0KICAgICAgICB2ZXJzaW9uOiAiMS4xMi4xIiwNCiAgICAgICAgZGVmYXVsdEVsZW1lbnQ6ICI8dWw+IiwNCiAgICAgICAgZGVsYXk6IDMwMCwNCiAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgaWNvbnM6IHsNCiAgICAgICAgICAgICAgICBzdWJtZW51OiAidWktaWNvbi1jYXJldC0xLWUiDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgaXRlbXM6ICI+ICoiLA0KICAgICAgICAgICAgbWVudXM6ICJ1bCIsDQogICAgICAgICAgICBwb3NpdGlvbjogew0KICAgICAgICAgICAgICAgIG15OiAibGVmdCB0b3AiLA0KICAgICAgICAgICAgICAgIGF0OiAicmlnaHQgdG9wIg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHJvbGU6ICJtZW51IiwNCg0KICAgICAgICAgICAgLy8gQ2FsbGJhY2tzDQogICAgICAgICAgICBibHVyOiBudWxsLA0KICAgICAgICAgICAgZm9jdXM6IG51bGwsDQogICAgICAgICAgICBzZWxlY3Q6IG51bGwNCiAgICAgICAgfSwNCg0KICAgICAgICBfY3JlYXRlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuYWN0aXZlTWVudSA9IHRoaXMuZWxlbWVudDsNCg0KICAgICAgICAgICAgLy8gRmxhZyB1c2VkIHRvIHByZXZlbnQgZmlyaW5nIG9mIHRoZSBjbGljayBoYW5kbGVyDQogICAgICAgICAgICAvLyBhcyB0aGUgZXZlbnQgYnViYmxlcyB1cCB0aHJvdWdoIG5lc3RlZCBtZW51cw0KICAgICAgICAgICAgdGhpcy5tb3VzZUhhbmRsZWQgPSBmYWxzZTsNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudA0KICAgICAgICAgICAgICAgIC51bmlxdWVJZCgpDQogICAgICAgICAgICAgICAgLmF0dHIoIHsNCiAgICAgICAgICAgICAgICAgICAgcm9sZTogdGhpcy5vcHRpb25zLnJvbGUsDQogICAgICAgICAgICAgICAgICAgIHRhYkluZGV4OiAwDQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggInVpLW1lbnUiLCAidWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IiApOw0KICAgICAgICAgICAgdGhpcy5fb24oIHsNCg0KICAgICAgICAgICAgICAgIC8vIFByZXZlbnQgZm9jdXMgZnJvbSBzdGlja2luZyB0byBsaW5rcyBpbnNpZGUgbWVudSBhZnRlciBjbGlja2luZw0KICAgICAgICAgICAgICAgIC8vIHRoZW0gKGZvY3VzIHNob3VsZCBhbHdheXMgc3RheSBvbiBVTCBkdXJpbmcgbmF2aWdhdGlvbikuDQogICAgICAgICAgICAgICAgIm1vdXNlZG93biAudWktbWVudS1pdGVtIjogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgImNsaWNrIC51aS1tZW51LWl0ZW0iOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSAkKCBldmVudC50YXJnZXQgKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZSA9ICQoICQudWkuc2FmZUFjdGl2ZUVsZW1lbnQoIHRoaXMuZG9jdW1lbnRbIDAgXSApICk7DQogICAgICAgICAgICAgICAgICAgIGlmICggIXRoaXMubW91c2VIYW5kbGVkICYmIHRhcmdldC5ub3QoICIudWktc3RhdGUtZGlzYWJsZWQiICkubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3QoIGV2ZW50ICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgc2V0IHRoZSBtb3VzZUhhbmRsZWQgZmxhZyBpZiB0aGUgZXZlbnQgd2lsbCBidWJibGUsIHNlZSAjOTQ2OS4NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggIWV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZUhhbmRsZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVuIHN1Ym1lbnUgb24gY2xpY2sNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggdGFyZ2V0LmhhcyggIi51aS1tZW51IiApLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cGFuZCggZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoICF0aGlzLmVsZW1lbnQuaXMoICI6Zm9jdXMiICkgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmUuY2xvc2VzdCggIi51aS1tZW51IiApLmxlbmd0aCApIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlZGlyZWN0IGZvY3VzIHRvIHRoZSBtZW51DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnRyaWdnZXIoICJmb2N1cyIsIFsgdHJ1ZSBdICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgYWN0aXZlIGl0ZW0gaXMgb24gdGhlIHRvcCBsZXZlbCwgbGV0IGl0IHN0YXkgYWN0aXZlLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSwgYmx1ciB0aGUgYWN0aXZlIGl0ZW0gc2luY2UgaXQgaXMgbm8gbG9uZ2VyIHZpc2libGUuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLmFjdGl2ZSAmJiB0aGlzLmFjdGl2ZS5wYXJlbnRzKCAiLnVpLW1lbnUiICkubGVuZ3RoID09PSAxICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoIHRoaXMudGltZXIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICJtb3VzZWVudGVyIC51aS1tZW51LWl0ZW0iOiBmdW5jdGlvbiggZXZlbnQgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlIG1vdXNlIGV2ZW50cyB3aGlsZSB0eXBlYWhlYWQgaXMgYWN0aXZlLCBzZWUgIzEwNDU4Lg0KICAgICAgICAgICAgICAgICAgICAvLyBQcmV2ZW50cyBmb2N1c2luZyB0aGUgd3JvbmcgaXRlbSB3aGVuIHR5cGVhaGVhZCBjYXVzZXMgYSBzY3JvbGwgd2hpbGUgdGhlIG1vdXNlDQogICAgICAgICAgICAgICAgICAgIC8vIGlzIG92ZXIgYW4gaXRlbSBpbiB0aGUgbWVudQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMucHJldmlvdXNGaWx0ZXIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICB2YXIgYWN0dWFsVGFyZ2V0ID0gJCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggIi51aS1tZW51LWl0ZW0iICksDQogICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSAkKCBldmVudC5jdXJyZW50VGFyZ2V0ICk7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlIGJ1YmJsZWQgZXZlbnRzIG9uIHBhcmVudCBpdGVtcywgc2VlICMxMTY0MQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIGFjdHVhbFRhcmdldFsgMCBdICE9PSB0YXJnZXRbIDAgXSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB1aS1zdGF0ZS1hY3RpdmUgY2xhc3MgZnJvbSBzaWJsaW5ncyBvZiB0aGUgbmV3bHkgZm9jdXNlZCBtZW51IGl0ZW0NCiAgICAgICAgICAgICAgICAgICAgLy8gdG8gYXZvaWQgYSBqdW1wIGNhdXNlZCBieSBhZGphY2VudCBlbGVtZW50cyBib3RoIGhhdmluZyBhIGNsYXNzIHdpdGggYSBib3JkZXINCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ2xhc3MoIHRhcmdldC5zaWJsaW5ncygpLmNoaWxkcmVuKCAiLnVpLXN0YXRlLWFjdGl2ZSIgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwsICJ1aS1zdGF0ZS1hY3RpdmUiICk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXMoIGV2ZW50LCB0YXJnZXQgKTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG1vdXNlbGVhdmU6ICJjb2xsYXBzZUFsbCIsDQogICAgICAgICAgICAgICAgIm1vdXNlbGVhdmUgLnVpLW1lbnUiOiAiY29sbGFwc2VBbGwiLA0KICAgICAgICAgICAgICAgIGZvY3VzOiBmdW5jdGlvbiggZXZlbnQsIGtlZXBBY3RpdmVJdGVtICkgew0KDQogICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlJ3MgYWxyZWFkeSBhbiBhY3RpdmUgaXRlbSwga2VlcCBpdCBhY3RpdmUNCiAgICAgICAgICAgICAgICAgICAgLy8gSWYgbm90LCBhY3RpdmF0ZSB0aGUgZmlyc3QgaXRlbQ0KICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMuYWN0aXZlIHx8IHRoaXMuZWxlbWVudC5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKS5lcSggMCApOw0KDQogICAgICAgICAgICAgICAgICAgIGlmICggIWtlZXBBY3RpdmVJdGVtICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2N1cyggZXZlbnQsIGl0ZW0gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgYmx1cjogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm90Q29udGFpbmVkID0gISQuY29udGFpbnMoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50WyAwIF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICkNCiAgICAgICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG5vdENvbnRhaW5lZCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbGxhcHNlQWxsKCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBrZXlkb3duOiAiX2tleWRvd24iDQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpOw0KDQogICAgICAgICAgICAvLyBDbGlja3Mgb3V0c2lkZSBvZiBhIG1lbnUgY29sbGFwc2UgYW55IG9wZW4gbWVudXMNCiAgICAgICAgICAgIHRoaXMuX29uKCB0aGlzLmRvY3VtZW50LCB7DQogICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLl9jbG9zZU9uRG9jdW1lbnRDbGljayggZXZlbnQgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29sbGFwc2VBbGwoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBSZXNldCB0aGUgbW91c2VIYW5kbGVkIGZsYWcNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZUhhbmRsZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2Rlc3Ryb3k6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5lbGVtZW50LmZpbmQoICIudWktbWVudS1pdGVtIiApDQogICAgICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKCAicm9sZSBhcmlhLWRpc2FibGVkIiApLA0KICAgICAgICAgICAgICAgIHN1Ym1lbnVzID0gaXRlbXMuY2hpbGRyZW4oICIudWktbWVudS1pdGVtLXdyYXBwZXIiICkNCiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZVVuaXF1ZUlkKCkNCiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoICJ0YWJJbmRleCByb2xlIGFyaWEtaGFzcG9wdXAiICk7DQoNCiAgICAgICAgICAgIC8vIERlc3Ryb3kgKHN1YiltZW51cw0KICAgICAgICAgICAgdGhpcy5lbGVtZW50DQogICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoICJhcmlhLWFjdGl2ZWRlc2NlbmRhbnQiICkNCiAgICAgICAgICAgICAgICAuZmluZCggIi51aS1tZW51IiApLmFkZEJhY2soKQ0KICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKCAicm9sZSBhcmlhLWxhYmVsbGVkYnkgYXJpYS1leHBhbmRlZCBhcmlhLWhpZGRlbiBhcmlhLWRpc2FibGVkICIgKw0KICAgICAgICAgICAgICAgICAgICAidGFiSW5kZXgiICkNCiAgICAgICAgICAgICAgICAucmVtb3ZlVW5pcXVlSWQoKQ0KICAgICAgICAgICAgICAgIC5zaG93KCk7DQoNCiAgICAgICAgICAgIHN1Ym1lbnVzLmNoaWxkcmVuKCkuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIGVsZW0gPSAkKCB0aGlzICk7DQogICAgICAgICAgICAgICAgaWYgKCBlbGVtLmRhdGEoICJ1aS1tZW51LXN1Ym1lbnUtY2FyZXQiICkgKSB7DQogICAgICAgICAgICAgICAgICAgIGVsZW0ucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9rZXlkb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgbWF0Y2gsIHByZXYsIGNoYXJhY3Rlciwgc2tpcCwNCiAgICAgICAgICAgICAgICBwcmV2ZW50RGVmYXVsdCA9IHRydWU7DQoNCiAgICAgICAgICAgIHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7DQogICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuUEFHRV9VUDoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aW91c1BhZ2UoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLlBBR0VfRE9XTjoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXh0UGFnZSggZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuSE9NRToNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbW92ZSggImZpcnN0IiwgImZpcnN0IiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuRU5EOg0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb3ZlKCAibGFzdCIsICJsYXN0IiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuVVA6DQogICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlvdXMoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLkRPV046DQogICAgICAgICAgICAgICAgICAgIHRoaXMubmV4dCggZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuTEVGVDoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2xsYXBzZSggZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuUklHSFQ6DQogICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5hY3RpdmUgJiYgIXRoaXMuYWN0aXZlLmlzKCAiLnVpLXN0YXRlLWRpc2FibGVkIiApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5leHBhbmQoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuRU5URVI6DQogICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuU1BBQ0U6DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2FjdGl2YXRlKCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5FU0NBUEU6DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY29sbGFwc2UoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgIHByZXZlbnREZWZhdWx0ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHByZXYgPSB0aGlzLnByZXZpb3VzRmlsdGVyIHx8ICIiOw0KICAgICAgICAgICAgICAgICAgICBza2lwID0gZmFsc2U7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gU3VwcG9ydCBudW1iZXIgcGFkIHZhbHVlcw0KICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIgPSBldmVudC5rZXlDb2RlID49IDk2ICYmIGV2ZW50LmtleUNvZGUgPD0gMTA1ID8NCiAgICAgICAgICAgICAgICAgICAgICAgICggZXZlbnQua2V5Q29kZSAtIDk2ICkudG9TdHJpbmcoKSA6IFN0cmluZy5mcm9tQ2hhckNvZGUoIGV2ZW50LmtleUNvZGUgKTsNCg0KICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoIHRoaXMuZmlsdGVyVGltZXIgKTsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoIGNoYXJhY3RlciA9PT0gcHJldiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNraXAgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyID0gcHJldiArIGNoYXJhY3RlcjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIG1hdGNoID0gdGhpcy5fZmlsdGVyTWVudUl0ZW1zKCBjaGFyYWN0ZXIgKTsNCiAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSBza2lwICYmIG1hdGNoLmluZGV4KCB0aGlzLmFjdGl2ZS5uZXh0KCkgKSAhPT0gLTEgPw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUubmV4dEFsbCggIi51aS1tZW51LWl0ZW0iICkgOg0KICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2g7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gSWYgbm8gbWF0Y2hlcyBvbiB0aGUgY3VycmVudCBmaWx0ZXIsIHJlc2V0IHRvIHRoZSBsYXN0IGNoYXJhY3RlciBwcmVzc2VkDQogICAgICAgICAgICAgICAgICAgIC8vIHRvIG1vdmUgZG93biB0aGUgbWVudSB0byB0aGUgZmlyc3QgaXRlbSB0aGF0IHN0YXJ0cyB3aXRoIHRoYXQgY2hhcmFjdGVyDQogICAgICAgICAgICAgICAgICAgIGlmICggIW1hdGNoLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoIGV2ZW50LmtleUNvZGUgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoID0gdGhpcy5fZmlsdGVyTWVudUl0ZW1zKCBjaGFyYWN0ZXIgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGlmICggbWF0Y2gubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2N1cyggZXZlbnQsIG1hdGNoICk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpb3VzRmlsdGVyID0gY2hhcmFjdGVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJUaW1lciA9IHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5wcmV2aW91c0ZpbHRlcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMDAgKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnByZXZpb3VzRmlsdGVyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggcHJldmVudERlZmF1bHQgKSB7DQogICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfYWN0aXZhdGU6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIGlmICggdGhpcy5hY3RpdmUgJiYgIXRoaXMuYWN0aXZlLmlzKCAiLnVpLXN0YXRlLWRpc2FibGVkIiApICkgew0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5hY3RpdmUuY2hpbGRyZW4oICJbYXJpYS1oYXNwb3B1cD0ndHJ1ZSddIiApLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5leHBhbmQoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3QoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHJlZnJlc2g6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIG1lbnVzLCBpdGVtcywgbmV3U3VibWVudXMsIG5ld0l0ZW1zLCBuZXdXcmFwcGVycywNCiAgICAgICAgICAgICAgICB0aGF0ID0gdGhpcywNCiAgICAgICAgICAgICAgICBpY29uID0gdGhpcy5vcHRpb25zLmljb25zLnN1Ym1lbnUsDQogICAgICAgICAgICAgICAgc3VibWVudXMgPSB0aGlzLmVsZW1lbnQuZmluZCggdGhpcy5vcHRpb25zLm1lbnVzICk7DQoNCiAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUNsYXNzKCAidWktbWVudS1pY29ucyIsIG51bGwsICEhdGhpcy5lbGVtZW50LmZpbmQoICIudWktaWNvbiIgKS5sZW5ndGggKTsNCg0KICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBuZXN0ZWQgbWVudXMNCiAgICAgICAgICAgIG5ld1N1Ym1lbnVzID0gc3VibWVudXMuZmlsdGVyKCAiOm5vdCgudWktbWVudSkiICkNCiAgICAgICAgICAgICAgICAuaGlkZSgpDQogICAgICAgICAgICAgICAgLmF0dHIoIHsNCiAgICAgICAgICAgICAgICAgICAgcm9sZTogdGhpcy5vcHRpb25zLnJvbGUsDQogICAgICAgICAgICAgICAgICAgICJhcmlhLWhpZGRlbiI6ICJ0cnVlIiwNCiAgICAgICAgICAgICAgICAgICAgImFyaWEtZXhwYW5kZWQiOiAiZmFsc2UiDQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgbWVudSA9ICQoIHRoaXMgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBtZW51LnByZXYoKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1lbnVDYXJldCA9ICQoICI8c3Bhbj4iICkuZGF0YSggInVpLW1lbnUtc3VibWVudS1jYXJldCIsIHRydWUgKTsNCg0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll9hZGRDbGFzcyggc3VibWVudUNhcmV0LCAidWktbWVudS1pY29uIiwgInVpLWljb24gIiArIGljb24gKTsNCiAgICAgICAgICAgICAgICAgICAgaXRlbQ0KICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoICJhcmlhLWhhc3BvcHVwIiwgInRydWUiICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5wcmVwZW5kKCBzdWJtZW51Q2FyZXQgKTsNCiAgICAgICAgICAgICAgICAgICAgbWVudS5hdHRyKCAiYXJpYS1sYWJlbGxlZGJ5IiwgaXRlbS5hdHRyKCAiaWQiICkgKTsNCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCBuZXdTdWJtZW51cywgInVpLW1lbnUiLCAidWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWZyb250IiApOw0KDQogICAgICAgICAgICBtZW51cyA9IHN1Ym1lbnVzLmFkZCggdGhpcy5lbGVtZW50ICk7DQogICAgICAgICAgICBpdGVtcyA9IG1lbnVzLmZpbmQoIHRoaXMub3B0aW9ucy5pdGVtcyApOw0KDQogICAgICAgICAgICAvLyBJbml0aWFsaXplIG1lbnUtaXRlbXMgY29udGFpbmluZyBzcGFjZXMgYW5kL29yIGRhc2hlcyBvbmx5IGFzIGRpdmlkZXJzDQogICAgICAgICAgICBpdGVtcy5ub3QoICIudWktbWVudS1pdGVtIiApLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciBpdGVtID0gJCggdGhpcyApOw0KICAgICAgICAgICAgICAgIGlmICggdGhhdC5faXNEaXZpZGVyKCBpdGVtICkgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX2FkZENsYXNzKCBpdGVtLCAidWktbWVudS1kaXZpZGVyIiwgInVpLXdpZGdldC1jb250ZW50IiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgLy8gRG9uJ3QgcmVmcmVzaCBsaXN0IGl0ZW1zIHRoYXQgYXJlIGFscmVhZHkgYWRhcHRlZA0KICAgICAgICAgICAgbmV3SXRlbXMgPSBpdGVtcy5ub3QoICIudWktbWVudS1pdGVtLCAudWktbWVudS1kaXZpZGVyIiApOw0KICAgICAgICAgICAgbmV3V3JhcHBlcnMgPSBuZXdJdGVtcy5jaGlsZHJlbigpDQogICAgICAgICAgICAgICAgLm5vdCggIi51aS1tZW51IiApDQogICAgICAgICAgICAgICAgLnVuaXF1ZUlkKCkNCiAgICAgICAgICAgICAgICAuYXR0ciggew0KICAgICAgICAgICAgICAgICAgICB0YWJJbmRleDogLTEsDQogICAgICAgICAgICAgICAgICAgIHJvbGU6IHRoaXMuX2l0ZW1Sb2xlKCkNCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggbmV3SXRlbXMsICJ1aS1tZW51LWl0ZW0iICkNCiAgICAgICAgICAgICAgICAuX2FkZENsYXNzKCBuZXdXcmFwcGVycywgInVpLW1lbnUtaXRlbS13cmFwcGVyIiApOw0KDQogICAgICAgICAgICAvLyBBZGQgYXJpYS1kaXNhYmxlZCBhdHRyaWJ1dGUgdG8gYW55IGRpc2FibGVkIG1lbnUgaXRlbQ0KICAgICAgICAgICAgaXRlbXMuZmlsdGVyKCAiLnVpLXN0YXRlLWRpc2FibGVkIiApLmF0dHIoICJhcmlhLWRpc2FibGVkIiwgInRydWUiICk7DQoNCiAgICAgICAgICAgIC8vIElmIHRoZSBhY3RpdmUgaXRlbSBoYXMgYmVlbiByZW1vdmVkLCBibHVyIHRoZSBtZW51DQogICAgICAgICAgICBpZiAoIHRoaXMuYWN0aXZlICYmICEkLmNvbnRhaW5zKCB0aGlzLmVsZW1lbnRbIDAgXSwgdGhpcy5hY3RpdmVbIDAgXSApICkgew0KICAgICAgICAgICAgICAgIHRoaXMuYmx1cigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9pdGVtUm9sZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIG1lbnU6ICJtZW51aXRlbSIsDQogICAgICAgICAgICAgICAgbGlzdGJveDogIm9wdGlvbiINCiAgICAgICAgICAgIH1bIHRoaXMub3B0aW9ucy5yb2xlIF07DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7DQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImljb25zIiApIHsNCiAgICAgICAgICAgICAgICB2YXIgaWNvbnMgPSB0aGlzLmVsZW1lbnQuZmluZCggIi51aS1tZW51LWljb24iICk7DQogICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ2xhc3MoIGljb25zLCBudWxsLCB0aGlzLm9wdGlvbnMuaWNvbnMuc3VibWVudSApDQogICAgICAgICAgICAgICAgICAgIC5fYWRkQ2xhc3MoIGljb25zLCBudWxsLCB2YWx1ZS5zdWJtZW51ICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb25EaXNhYmxlZDogZnVuY3Rpb24oIHZhbHVlICkgew0KICAgICAgICAgICAgdGhpcy5fc3VwZXIoIHZhbHVlICk7DQoNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hdHRyKCAiYXJpYS1kaXNhYmxlZCIsIFN0cmluZyggdmFsdWUgKSApOw0KICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQ2xhc3MoIG51bGwsICJ1aS1zdGF0ZS1kaXNhYmxlZCIsICEhdmFsdWUgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBmb2N1czogZnVuY3Rpb24oIGV2ZW50LCBpdGVtICkgew0KICAgICAgICAgICAgdmFyIG5lc3RlZCwgZm9jdXNlZCwgYWN0aXZlUGFyZW50Ow0KICAgICAgICAgICAgdGhpcy5ibHVyKCBldmVudCwgZXZlbnQgJiYgZXZlbnQudHlwZSA9PT0gImZvY3VzIiApOw0KDQogICAgICAgICAgICB0aGlzLl9zY3JvbGxJbnRvVmlldyggaXRlbSApOw0KDQogICAgICAgICAgICB0aGlzLmFjdGl2ZSA9IGl0ZW0uZmlyc3QoKTsNCg0KICAgICAgICAgICAgZm9jdXNlZCA9IHRoaXMuYWN0aXZlLmNoaWxkcmVuKCAiLnVpLW1lbnUtaXRlbS13cmFwcGVyIiApOw0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIGZvY3VzZWQsIG51bGwsICJ1aS1zdGF0ZS1hY3RpdmUiICk7DQoNCiAgICAgICAgICAgIC8vIE9ubHkgdXBkYXRlIGFyaWEtYWN0aXZlZGVzY2VuZGFudCBpZiB0aGVyZSdzIGEgcm9sZQ0KICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIHdlIGFzc3VtZSBmb2N1cyBpcyBtYW5hZ2VkIGVsc2V3aGVyZQ0KICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMucm9sZSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuYXR0ciggImFyaWEtYWN0aXZlZGVzY2VuZGFudCIsIGZvY3VzZWQuYXR0ciggImlkIiApICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIEhpZ2hsaWdodCBhY3RpdmUgcGFyZW50IG1lbnUgaXRlbSwgaWYgYW55DQogICAgICAgICAgICBhY3RpdmVQYXJlbnQgPSB0aGlzLmFjdGl2ZQ0KICAgICAgICAgICAgICAgIC5wYXJlbnQoKQ0KICAgICAgICAgICAgICAgIC5jbG9zZXN0KCAiLnVpLW1lbnUtaXRlbSIgKQ0KICAgICAgICAgICAgICAgIC5jaGlsZHJlbiggIi51aS1tZW51LWl0ZW0td3JhcHBlciIgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCBhY3RpdmVQYXJlbnQsIG51bGwsICJ1aS1zdGF0ZS1hY3RpdmUiICk7DQoNCiAgICAgICAgICAgIGlmICggZXZlbnQgJiYgZXZlbnQudHlwZSA9PT0gImtleWRvd24iICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX2Nsb3NlKCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMudGltZXIgPSB0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2Nsb3NlKCk7DQogICAgICAgICAgICAgICAgfSwgdGhpcy5kZWxheSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBuZXN0ZWQgPSBpdGVtLmNoaWxkcmVuKCAiLnVpLW1lbnUiICk7DQogICAgICAgICAgICBpZiAoIG5lc3RlZC5sZW5ndGggJiYgZXZlbnQgJiYgKCAvXm1vdXNlLy50ZXN0KCBldmVudC50eXBlICkgKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9zdGFydE9wZW5pbmcoIG5lc3RlZCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5hY3RpdmVNZW51ID0gaXRlbS5wYXJlbnQoKTsNCg0KICAgICAgICAgICAgdGhpcy5fdHJpZ2dlciggImZvY3VzIiwgZXZlbnQsIHsgaXRlbTogaXRlbSB9ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3Njcm9sbEludG9WaWV3OiBmdW5jdGlvbiggaXRlbSApIHsNCiAgICAgICAgICAgIHZhciBib3JkZXJUb3AsIHBhZGRpbmdUb3AsIG9mZnNldCwgc2Nyb2xsLCBlbGVtZW50SGVpZ2h0LCBpdGVtSGVpZ2h0Ow0KICAgICAgICAgICAgaWYgKCB0aGlzLl9oYXNTY3JvbGwoKSApIHsNCiAgICAgICAgICAgICAgICBib3JkZXJUb3AgPSBwYXJzZUZsb2F0KCAkLmNzcyggdGhpcy5hY3RpdmVNZW51WyAwIF0sICJib3JkZXJUb3BXaWR0aCIgKSApIHx8IDA7DQogICAgICAgICAgICAgICAgcGFkZGluZ1RvcCA9IHBhcnNlRmxvYXQoICQuY3NzKCB0aGlzLmFjdGl2ZU1lbnVbIDAgXSwgInBhZGRpbmdUb3AiICkgKSB8fCAwOw0KICAgICAgICAgICAgICAgIG9mZnNldCA9IGl0ZW0ub2Zmc2V0KCkudG9wIC0gdGhpcy5hY3RpdmVNZW51Lm9mZnNldCgpLnRvcCAtIGJvcmRlclRvcCAtIHBhZGRpbmdUb3A7DQogICAgICAgICAgICAgICAgc2Nyb2xsID0gdGhpcy5hY3RpdmVNZW51LnNjcm9sbFRvcCgpOw0KICAgICAgICAgICAgICAgIGVsZW1lbnRIZWlnaHQgPSB0aGlzLmFjdGl2ZU1lbnUuaGVpZ2h0KCk7DQogICAgICAgICAgICAgICAgaXRlbUhlaWdodCA9IGl0ZW0ub3V0ZXJIZWlnaHQoKTsNCg0KICAgICAgICAgICAgICAgIGlmICggb2Zmc2V0IDwgMCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVNZW51LnNjcm9sbFRvcCggc2Nyb2xsICsgb2Zmc2V0ICk7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmICggb2Zmc2V0ICsgaXRlbUhlaWdodCA+IGVsZW1lbnRIZWlnaHQgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlTWVudS5zY3JvbGxUb3AoIHNjcm9sbCArIG9mZnNldCAtIGVsZW1lbnRIZWlnaHQgKyBpdGVtSGVpZ2h0ICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIGJsdXI6IGZ1bmN0aW9uKCBldmVudCwgZnJvbUZvY3VzICkgew0KICAgICAgICAgICAgaWYgKCAhZnJvbUZvY3VzICkgew0KICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCggdGhpcy50aW1lciApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoICF0aGlzLmFjdGl2ZSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLmFjdGl2ZS5jaGlsZHJlbiggIi51aS1tZW51LWl0ZW0td3JhcHBlciIgKSwNCiAgICAgICAgICAgICAgICBudWxsLCAidWktc3RhdGUtYWN0aXZlIiApOw0KDQogICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAiYmx1ciIsIGV2ZW50LCB7IGl0ZW06IHRoaXMuYWN0aXZlIH0gKTsNCiAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gbnVsbDsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc3RhcnRPcGVuaW5nOiBmdW5jdGlvbiggc3VibWVudSApIHsNCiAgICAgICAgICAgIGNsZWFyVGltZW91dCggdGhpcy50aW1lciApOw0KDQogICAgICAgICAgICAvLyBEb24ndCBvcGVuIGlmIGFscmVhZHkgb3BlbiBmaXhlcyBhIEZpcmVmb3ggYnVnIHRoYXQgY2F1c2VkIGEgLjUgcGl4ZWwNCiAgICAgICAgICAgIC8vIHNoaWZ0IGluIHRoZSBzdWJtZW51IHBvc2l0aW9uIHdoZW4gbW91c2luZyBvdmVyIHRoZSBjYXJldCBpY29uDQogICAgICAgICAgICBpZiAoIHN1Ym1lbnUuYXR0ciggImFyaWEtaGlkZGVuIiApICE9PSAidHJ1ZSIgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLnRpbWVyID0gdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHRoaXMuX2Nsb3NlKCk7DQogICAgICAgICAgICAgICAgdGhpcy5fb3Blbiggc3VibWVudSApOw0KICAgICAgICAgICAgfSwgdGhpcy5kZWxheSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9vcGVuOiBmdW5jdGlvbiggc3VibWVudSApIHsNCiAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9ICQuZXh0ZW5kKCB7DQogICAgICAgICAgICAgICAgb2Y6IHRoaXMuYWN0aXZlDQogICAgICAgICAgICB9LCB0aGlzLm9wdGlvbnMucG9zaXRpb24gKTsNCg0KICAgICAgICAgICAgY2xlYXJUaW1lb3V0KCB0aGlzLnRpbWVyICk7DQogICAgICAgICAgICB0aGlzLmVsZW1lbnQuZmluZCggIi51aS1tZW51IiApLm5vdCggc3VibWVudS5wYXJlbnRzKCAiLnVpLW1lbnUiICkgKQ0KICAgICAgICAgICAgICAgIC5oaWRlKCkNCiAgICAgICAgICAgICAgICAuYXR0ciggImFyaWEtaGlkZGVuIiwgInRydWUiICk7DQoNCiAgICAgICAgICAgIHN1Ym1lbnUNCiAgICAgICAgICAgICAgICAuc2hvdygpDQogICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoICJhcmlhLWhpZGRlbiIgKQ0KICAgICAgICAgICAgICAgIC5hdHRyKCAiYXJpYS1leHBhbmRlZCIsICJ0cnVlIiApDQogICAgICAgICAgICAgICAgLnBvc2l0aW9uKCBwb3NpdGlvbiApOw0KICAgICAgICB9LA0KDQogICAgICAgIGNvbGxhcHNlQWxsOiBmdW5jdGlvbiggZXZlbnQsIGFsbCApIHsNCiAgICAgICAgICAgIGNsZWFyVGltZW91dCggdGhpcy50aW1lciApOw0KICAgICAgICAgICAgdGhpcy50aW1lciA9IHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgICAgIC8vIElmIHdlIHdlcmUgcGFzc2VkIGFuIGV2ZW50LCBsb29rIGZvciB0aGUgc3VibWVudSB0aGF0IGNvbnRhaW5zIHRoZSBldmVudA0KICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TWVudSA9IGFsbCA/IHRoaXMuZWxlbWVudCA6DQogICAgICAgICAgICAgICAgICAgICQoIGV2ZW50ICYmIGV2ZW50LnRhcmdldCApLmNsb3Nlc3QoIHRoaXMuZWxlbWVudC5maW5kKCAiLnVpLW1lbnUiICkgKTsNCg0KICAgICAgICAgICAgICAgIC8vIElmIHdlIGZvdW5kIG5vIHZhbGlkIHN1Ym1lbnUgYW5jZXN0b3IsIHVzZSB0aGUgbWFpbiBtZW51IHRvIGNsb3NlIGFsbA0KICAgICAgICAgICAgICAgIC8vIHN1YiBtZW51cyBhbnl3YXkNCiAgICAgICAgICAgICAgICBpZiAoICFjdXJyZW50TWVudS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRNZW51ID0gdGhpcy5lbGVtZW50Ow0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHRoaXMuX2Nsb3NlKCBjdXJyZW50TWVudSApOw0KDQogICAgICAgICAgICAgICAgdGhpcy5ibHVyKCBldmVudCApOw0KDQogICAgICAgICAgICAgICAgLy8gV29yayBhcm91bmQgYWN0aXZlIGl0ZW0gc3RheWluZyBhY3RpdmUgYWZ0ZXIgbWVudSBpcyBibHVycmVkDQogICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ2xhc3MoIGN1cnJlbnRNZW51LmZpbmQoICIudWktc3RhdGUtYWN0aXZlIiApLCBudWxsLCAidWktc3RhdGUtYWN0aXZlIiApOw0KDQogICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVNZW51ID0gY3VycmVudE1lbnU7DQogICAgICAgICAgICB9LCB0aGlzLmRlbGF5ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLy8gV2l0aCBubyBhcmd1bWVudHMsIGNsb3NlcyB0aGUgY3VycmVudGx5IGFjdGl2ZSBtZW51IC0gaWYgbm90aGluZyBpcyBhY3RpdmUNCiAgICAgICAgLy8gaXQgY2xvc2VzIGFsbCBtZW51cy4gIElmIHBhc3NlZCBhbiBhcmd1bWVudCwgaXQgd2lsbCBzZWFyY2ggZm9yIG1lbnVzIEJFTE9XDQogICAgICAgIF9jbG9zZTogZnVuY3Rpb24oIHN0YXJ0TWVudSApIHsNCiAgICAgICAgICAgIGlmICggIXN0YXJ0TWVudSApIHsNCiAgICAgICAgICAgICAgICBzdGFydE1lbnUgPSB0aGlzLmFjdGl2ZSA/IHRoaXMuYWN0aXZlLnBhcmVudCgpIDogdGhpcy5lbGVtZW50Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBzdGFydE1lbnUuZmluZCggIi51aS1tZW51IiApDQogICAgICAgICAgICAgICAgLmhpZGUoKQ0KICAgICAgICAgICAgICAgIC5hdHRyKCAiYXJpYS1oaWRkZW4iLCAidHJ1ZSIgKQ0KICAgICAgICAgICAgICAgIC5hdHRyKCAiYXJpYS1leHBhbmRlZCIsICJmYWxzZSIgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfY2xvc2VPbkRvY3VtZW50Q2xpY2s6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHJldHVybiAhJCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggIi51aS1tZW51IiApLmxlbmd0aDsNCiAgICAgICAgfSwNCg0KICAgICAgICBfaXNEaXZpZGVyOiBmdW5jdGlvbiggaXRlbSApIHsNCg0KICAgICAgICAgICAgLy8gTWF0Y2ggaHlwaGVuLCBlbSBkYXNoLCBlbiBkYXNoDQogICAgICAgICAgICByZXR1cm4gIS9bXlwtXHUyMDE0XHUyMDEzXHNdLy50ZXN0KCBpdGVtLnRleHQoKSApOw0KICAgICAgICB9LA0KDQogICAgICAgIGNvbGxhcHNlOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgbmV3SXRlbSA9IHRoaXMuYWN0aXZlICYmDQogICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUucGFyZW50KCkuY2xvc2VzdCggIi51aS1tZW51LWl0ZW0iLCB0aGlzLmVsZW1lbnQgKTsNCiAgICAgICAgICAgIGlmICggbmV3SXRlbSAmJiBuZXdJdGVtLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9jbG9zZSgpOw0KICAgICAgICAgICAgICAgIHRoaXMuZm9jdXMoIGV2ZW50LCBuZXdJdGVtICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgZXhwYW5kOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgbmV3SXRlbSA9IHRoaXMuYWN0aXZlICYmDQogICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUNCiAgICAgICAgICAgICAgICAgICAgLmNoaWxkcmVuKCAiLnVpLW1lbnUgIiApDQogICAgICAgICAgICAgICAgICAgIC5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKQ0KICAgICAgICAgICAgICAgICAgICAuZmlyc3QoKTsNCg0KICAgICAgICAgICAgaWYgKCBuZXdJdGVtICYmIG5ld0l0ZW0ubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX29wZW4oIG5ld0l0ZW0ucGFyZW50KCkgKTsNCg0KICAgICAgICAgICAgICAgIC8vIERlbGF5IHNvIEZpcmVmb3ggd2lsbCBub3QgaGlkZSBhY3RpdmVkZXNjZW5kYW50IGNoYW5nZSBpbiBleHBhbmRpbmcgc3VibWVudSBmcm9tIEFUDQogICAgICAgICAgICAgICAgdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzKCBldmVudCwgbmV3SXRlbSApOw0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBuZXh0OiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB0aGlzLl9tb3ZlKCAibmV4dCIsICJmaXJzdCIsIGV2ZW50ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgcHJldmlvdXM6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHRoaXMuX21vdmUoICJwcmV2IiwgImxhc3QiLCBldmVudCApOw0KICAgICAgICB9LA0KDQogICAgICAgIGlzRmlyc3RJdGVtOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLmFjdGl2ZSAmJiAhdGhpcy5hY3RpdmUucHJldkFsbCggIi51aS1tZW51LWl0ZW0iICkubGVuZ3RoOw0KICAgICAgICB9LA0KDQogICAgICAgIGlzTGFzdEl0ZW06IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlICYmICF0aGlzLmFjdGl2ZS5uZXh0QWxsKCAiLnVpLW1lbnUtaXRlbSIgKS5sZW5ndGg7DQogICAgICAgIH0sDQoNCiAgICAgICAgX21vdmU6IGZ1bmN0aW9uKCBkaXJlY3Rpb24sIGZpbHRlciwgZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgbmV4dDsNCiAgICAgICAgICAgIGlmICggdGhpcy5hY3RpdmUgKSB7DQogICAgICAgICAgICAgICAgaWYgKCBkaXJlY3Rpb24gPT09ICJmaXJzdCIgfHwgZGlyZWN0aW9uID09PSAibGFzdCIgKSB7DQogICAgICAgICAgICAgICAgICAgIG5leHQgPSB0aGlzLmFjdGl2ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgWyBkaXJlY3Rpb24gPT09ICJmaXJzdCIgPyAicHJldkFsbCIgOiAibmV4dEFsbCIgXSggIi51aS1tZW51LWl0ZW0iICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5lcSggLTEgKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBuZXh0ID0gdGhpcy5hY3RpdmUNCiAgICAgICAgICAgICAgICAgICAgICAgIFsgZGlyZWN0aW9uICsgIkFsbCIgXSggIi51aS1tZW51LWl0ZW0iICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5lcSggMCApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggIW5leHQgfHwgIW5leHQubGVuZ3RoIHx8ICF0aGlzLmFjdGl2ZSApIHsNCiAgICAgICAgICAgICAgICBuZXh0ID0gdGhpcy5hY3RpdmVNZW51LmZpbmQoIHRoaXMub3B0aW9ucy5pdGVtcyApWyBmaWx0ZXIgXSgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLmZvY3VzKCBldmVudCwgbmV4dCApOw0KICAgICAgICB9LA0KDQogICAgICAgIG5leHRQYWdlOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgaXRlbSwgYmFzZSwgaGVpZ2h0Ow0KDQogICAgICAgICAgICBpZiAoICF0aGlzLmFjdGl2ZSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLm5leHQoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCB0aGlzLmlzTGFzdEl0ZW0oKSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIHRoaXMuX2hhc1Njcm9sbCgpICkgew0KICAgICAgICAgICAgICAgIGJhc2UgPSB0aGlzLmFjdGl2ZS5vZmZzZXQoKS50b3A7DQogICAgICAgICAgICAgICAgaGVpZ2h0ID0gdGhpcy5lbGVtZW50LmhlaWdodCgpOw0KICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlLm5leHRBbGwoICIudWktbWVudS1pdGVtIiApLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBpdGVtID0gJCggdGhpcyApOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5vZmZzZXQoKS50b3AgLSBiYXNlIC0gaGVpZ2h0IDwgMDsNCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzKCBldmVudCwgaXRlbSApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzKCBldmVudCwgdGhpcy5hY3RpdmVNZW51LmZpbmQoIHRoaXMub3B0aW9ucy5pdGVtcyApDQogICAgICAgICAgICAgICAgICAgIFsgIXRoaXMuYWN0aXZlID8gImZpcnN0IiA6ICJsYXN0IiBdKCkgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBwcmV2aW91c1BhZ2U6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciBpdGVtLCBiYXNlLCBoZWlnaHQ7DQogICAgICAgICAgICBpZiAoICF0aGlzLmFjdGl2ZSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLm5leHQoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCB0aGlzLmlzRmlyc3RJdGVtKCkgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCB0aGlzLl9oYXNTY3JvbGwoKSApIHsNCiAgICAgICAgICAgICAgICBiYXNlID0gdGhpcy5hY3RpdmUub2Zmc2V0KCkudG9wOw0KICAgICAgICAgICAgICAgIGhlaWdodCA9IHRoaXMuZWxlbWVudC5oZWlnaHQoKTsNCiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZS5wcmV2QWxsKCAiLnVpLW1lbnUtaXRlbSIgKS5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgaXRlbSA9ICQoIHRoaXMgKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ub2Zmc2V0KCkudG9wIC0gYmFzZSArIGhlaWdodCA+IDA7DQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgdGhpcy5mb2N1cyggZXZlbnQsIGl0ZW0gKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5mb2N1cyggZXZlbnQsIHRoaXMuYWN0aXZlTWVudS5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKS5maXJzdCgpICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2hhc1Njcm9sbDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50Lm91dGVySGVpZ2h0KCkgPCB0aGlzLmVsZW1lbnQucHJvcCggInNjcm9sbEhlaWdodCIgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBzZWxlY3Q6IGZ1bmN0aW9uKCBldmVudCApIHsNCg0KICAgICAgICAgICAgLy8gVE9ETzogSXQgc2hvdWxkIG5ldmVyIGJlIHBvc3NpYmxlIHRvIG5vdCBoYXZlIGFuIGFjdGl2ZSBpdGVtIGF0IHRoaXMNCiAgICAgICAgICAgIC8vIHBvaW50LCBidXQgdGhlIHRlc3RzIGRvbid0IHRyaWdnZXIgbW91c2VlbnRlciBiZWZvcmUgY2xpY2suDQogICAgICAgICAgICB0aGlzLmFjdGl2ZSA9IHRoaXMuYWN0aXZlIHx8ICQoIGV2ZW50LnRhcmdldCApLmNsb3Nlc3QoICIudWktbWVudS1pdGVtIiApOw0KICAgICAgICAgICAgdmFyIHVpID0geyBpdGVtOiB0aGlzLmFjdGl2ZSB9Ow0KICAgICAgICAgICAgaWYgKCAhdGhpcy5hY3RpdmUuaGFzKCAiLnVpLW1lbnUiICkubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIHRoaXMuY29sbGFwc2VBbGwoIGV2ZW50LCB0cnVlICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAic2VsZWN0IiwgZXZlbnQsIHVpICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2ZpbHRlck1lbnVJdGVtczogZnVuY3Rpb24oIGNoYXJhY3RlciApIHsNCiAgICAgICAgICAgIHZhciBlc2NhcGVkQ2hhcmFjdGVyID0gY2hhcmFjdGVyLnJlcGxhY2UoIC9bXC1cW1xde30oKSorPy4sXFxcXiR8I1xzXS9nLCAiXFwkJiIgKSwNCiAgICAgICAgICAgICAgICByZWdleCA9IG5ldyBSZWdFeHAoICJeIiArIGVzY2FwZWRDaGFyYWN0ZXIsICJpIiApOw0KDQogICAgICAgICAgICByZXR1cm4gdGhpcy5hY3RpdmVNZW51DQogICAgICAgICAgICAgICAgLmZpbmQoIHRoaXMub3B0aW9ucy5pdGVtcyApDQoNCiAgICAgICAgICAgICAgICAvLyBPbmx5IG1hdGNoIG9uIGl0ZW1zLCBub3QgZGl2aWRlcnMgb3Igb3RoZXIgY29udGVudCAoIzEwNTcxKQ0KICAgICAgICAgICAgICAgIC5maWx0ZXIoICIudWktbWVudS1pdGVtIiApDQogICAgICAgICAgICAgICAgLmZpbHRlciggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdleC50ZXN0KA0KICAgICAgICAgICAgICAgICAgICAgICAgJC50cmltKCAkKCB0aGlzICkuY2hpbGRyZW4oICIudWktbWVudS1pdGVtLXdyYXBwZXIiICkudGV4dCgpICkgKTsNCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgIH0NCiAgICB9ICk7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIEF1dG9jb21wbGV0ZSAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogQXV0b2NvbXBsZXRlDQovLz4+Z3JvdXA6IFdpZGdldHMNCi8vPj5kZXNjcmlwdGlvbjogTGlzdHMgc3VnZ2VzdGVkIHdvcmRzIGFzIHRoZSB1c2VyIGlzIHR5cGluZy4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9hdXRvY29tcGxldGUvDQovLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vYXV0b2NvbXBsZXRlLw0KLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2NvcmUuY3NzDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvYXV0b2NvbXBsZXRlLmNzcw0KLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzDQoNCg0KDQogICAgJC53aWRnZXQoICJ1aS5hdXRvY29tcGxldGUiLCB7DQogICAgICAgIHZlcnNpb246ICIxLjEyLjEiLA0KICAgICAgICBkZWZhdWx0RWxlbWVudDogIjxpbnB1dD4iLA0KICAgICAgICBvcHRpb25zOiB7DQogICAgICAgICAgICBhcHBlbmRUbzogbnVsbCwNCiAgICAgICAgICAgIGF1dG9Gb2N1czogZmFsc2UsDQogICAgICAgICAgICBkZWxheTogMzAwLA0KICAgICAgICAgICAgbWluTGVuZ3RoOiAxLA0KICAgICAgICAgICAgcG9zaXRpb246IHsNCiAgICAgICAgICAgICAgICBteTogImxlZnQgdG9wIiwNCiAgICAgICAgICAgICAgICBhdDogImxlZnQgYm90dG9tIiwNCiAgICAgICAgICAgICAgICBjb2xsaXNpb246ICJub25lIg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHNvdXJjZTogbnVsbCwNCg0KICAgICAgICAgICAgLy8gQ2FsbGJhY2tzDQogICAgICAgICAgICBjaGFuZ2U6IG51bGwsDQogICAgICAgICAgICBjbG9zZTogbnVsbCwNCiAgICAgICAgICAgIGZvY3VzOiBudWxsLA0KICAgICAgICAgICAgb3BlbjogbnVsbCwNCiAgICAgICAgICAgIHJlc3BvbnNlOiBudWxsLA0KICAgICAgICAgICAgc2VhcmNoOiBudWxsLA0KICAgICAgICAgICAgc2VsZWN0OiBudWxsDQogICAgICAgIH0sDQoNCiAgICAgICAgcmVxdWVzdEluZGV4OiAwLA0KICAgICAgICBwZW5kaW5nOiAwLA0KDQogICAgICAgIF9jcmVhdGU6IGZ1bmN0aW9uKCkgew0KDQogICAgICAgICAgICAvLyBTb21lIGJyb3dzZXJzIG9ubHkgcmVwZWF0IGtleWRvd24gZXZlbnRzLCBub3Qga2V5cHJlc3MgZXZlbnRzLA0KICAgICAgICAgICAgLy8gc28gd2UgdXNlIHRoZSBzdXBwcmVzc0tleVByZXNzIGZsYWcgdG8gZGV0ZXJtaW5lIGlmIHdlJ3ZlIGFscmVhZHkNCiAgICAgICAgICAgIC8vIGhhbmRsZWQgdGhlIGtleWRvd24gZXZlbnQuICM3MjY5DQogICAgICAgICAgICAvLyBVbmZvcnR1bmF0ZWx5IHRoZSBjb2RlIGZvciAmIGluIGtleXByZXNzIGlzIHRoZSBzYW1lIGFzIHRoZSB1cCBhcnJvdywNCiAgICAgICAgICAgIC8vIHNvIHdlIHVzZSB0aGUgc3VwcHJlc3NLZXlQcmVzc1JlcGVhdCBmbGFnIHRvIGF2b2lkIGhhbmRsaW5nIGtleXByZXNzDQogICAgICAgICAgICAvLyBldmVudHMgd2hlbiB3ZSBrbm93IHRoZSBrZXlkb3duIGV2ZW50IHdhcyB1c2VkIHRvIG1vZGlmeSB0aGUNCiAgICAgICAgICAgIC8vIHNlYXJjaCB0ZXJtLiAjNzc5OQ0KICAgICAgICAgICAgdmFyIHN1cHByZXNzS2V5UHJlc3MsIHN1cHByZXNzS2V5UHJlc3NSZXBlYXQsIHN1cHByZXNzSW5wdXQsDQogICAgICAgICAgICAgICAgbm9kZU5hbWUgPSB0aGlzLmVsZW1lbnRbIDAgXS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLA0KICAgICAgICAgICAgICAgIGlzVGV4dGFyZWEgPSBub2RlTmFtZSA9PT0gInRleHRhcmVhIiwNCiAgICAgICAgICAgICAgICBpc0lucHV0ID0gbm9kZU5hbWUgPT09ICJpbnB1dCI7DQoNCiAgICAgICAgICAgIC8vIFRleHRhcmVhcyBhcmUgYWx3YXlzIG11bHRpLWxpbmUNCiAgICAgICAgICAgIC8vIElucHV0cyBhcmUgYWx3YXlzIHNpbmdsZS1saW5lLCBldmVuIGlmIGluc2lkZSBhIGNvbnRlbnRFZGl0YWJsZSBlbGVtZW50DQogICAgICAgICAgICAvLyBJRSBhbHNvIHRyZWF0cyBpbnB1dHMgYXMgY29udGVudEVkaXRhYmxlDQogICAgICAgICAgICAvLyBBbGwgb3RoZXIgZWxlbWVudCB0eXBlcyBhcmUgZGV0ZXJtaW5lZCBieSB3aGV0aGVyIG9yIG5vdCB0aGV5J3JlIGNvbnRlbnRFZGl0YWJsZQ0KICAgICAgICAgICAgdGhpcy5pc011bHRpTGluZSA9IGlzVGV4dGFyZWEgfHwgIWlzSW5wdXQgJiYgdGhpcy5faXNDb250ZW50RWRpdGFibGUoIHRoaXMuZWxlbWVudCApOw0KDQogICAgICAgICAgICB0aGlzLnZhbHVlTWV0aG9kID0gdGhpcy5lbGVtZW50WyBpc1RleHRhcmVhIHx8IGlzSW5wdXQgPyAidmFsIiA6ICJ0ZXh0IiBdOw0KICAgICAgICAgICAgdGhpcy5pc05ld01lbnUgPSB0cnVlOw0KDQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggInVpLWF1dG9jb21wbGV0ZS1pbnB1dCIgKTsNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hdHRyKCAiYXV0b2NvbXBsZXRlIiwgIm9mZiIgKTsNCg0KICAgICAgICAgICAgdGhpcy5fb24oIHRoaXMuZWxlbWVudCwgew0KICAgICAgICAgICAgICAgIGtleWRvd246IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLmVsZW1lbnQucHJvcCggInJlYWRPbmx5IiApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgc3VwcHJlc3NLZXlQcmVzcyA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBzdXBwcmVzc0lucHV0ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHN1cHByZXNzS2V5UHJlc3NSZXBlYXQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgc3VwcHJlc3NLZXlQcmVzcyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICBzdXBwcmVzc0lucHV0ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHN1cHByZXNzS2V5UHJlc3NSZXBlYXQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGtleUNvZGUgPSAkLnVpLmtleUNvZGU7DQogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGtleUNvZGUuUEFHRV9VUDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdXBwcmVzc0tleVByZXNzID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb3ZlKCAicHJldmlvdXNQYWdlIiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Uga2V5Q29kZS5QQUdFX0RPV046DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VwcHJlc3NLZXlQcmVzcyA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbW92ZSggIm5leHRQYWdlIiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Uga2V5Q29kZS5VUDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdXBwcmVzc0tleVByZXNzID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9rZXlFdmVudCggInByZXZpb3VzIiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Uga2V5Q29kZS5ET1dOOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1cHByZXNzS2V5UHJlc3MgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2tleUV2ZW50KCAibmV4dCIsIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGtleUNvZGUuRU5URVI6DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3aGVuIG1lbnUgaXMgb3BlbiBhbmQgaGFzIGZvY3VzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLm1lbnUuYWN0aXZlICkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICM2MDU1IC0gT3BlcmEgc3RpbGwgYWxsb3dzIHRoZSBrZXlwcmVzcyB0byBvY2N1cg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3aGljaCBjYXVzZXMgZm9ybXMgdG8gc3VibWl0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1cHByZXNzS2V5UHJlc3MgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnUuc2VsZWN0KCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Uga2V5Q29kZS5UQUI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLm1lbnUuYWN0aXZlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnUuc2VsZWN0KCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Uga2V5Q29kZS5FU0NBUEU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLm1lbnUuZWxlbWVudC5pcyggIjp2aXNpYmxlIiApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoICF0aGlzLmlzTXVsdGlMaW5lICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmFsdWUoIHRoaXMudGVybSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoIGV2ZW50ICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGlmZmVyZW50IGJyb3dzZXJzIGhhdmUgZGlmZmVyZW50IGRlZmF1bHQgYmVoYXZpb3IgZm9yIGVzY2FwZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTaW5nbGUgcHJlc3MgY2FuIG1lYW4gdW5kbyBvciBjbGVhcg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEb3VibGUgcHJlc3MgaW4gSUUgbWVhbnMgY2xlYXIgdGhlIHdob2xlIGZvcm0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1cHByZXNzS2V5UHJlc3NSZXBlYXQgPSB0cnVlOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VhcmNoIHRpbWVvdXQgc2hvdWxkIGJlIHRyaWdnZXJlZCBiZWZvcmUgdGhlIGlucHV0IHZhbHVlIGlzIGNoYW5nZWQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZWFyY2hUaW1lb3V0KCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBrZXlwcmVzczogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIHN1cHByZXNzS2V5UHJlc3MgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzdXBwcmVzc0tleVByZXNzID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoICF0aGlzLmlzTXVsdGlMaW5lIHx8IHRoaXMubWVudS5lbGVtZW50LmlzKCAiOnZpc2libGUiICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIHN1cHByZXNzS2V5UHJlc3NSZXBlYXQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBSZXBsaWNhdGUgc29tZSBrZXkgaGFuZGxlcnMgdG8gYWxsb3cgdGhlbSB0byByZXBlYXQgaW4gRmlyZWZveCBhbmQgT3BlcmENCiAgICAgICAgICAgICAgICAgICAgdmFyIGtleUNvZGUgPSAkLnVpLmtleUNvZGU7DQogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGtleUNvZGUuUEFHRV9VUDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb3ZlKCAicHJldmlvdXNQYWdlIiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Uga2V5Q29kZS5QQUdFX0RPV046DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbW92ZSggIm5leHRQYWdlIiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Uga2V5Q29kZS5VUDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9rZXlFdmVudCggInByZXZpb3VzIiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Uga2V5Q29kZS5ET1dOOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2tleUV2ZW50KCAibmV4dCIsIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIGlucHV0OiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggc3VwcHJlc3NJbnB1dCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHN1cHByZXNzSW5wdXQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2VhcmNoVGltZW91dCggZXZlbnQgKTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIGZvY3VzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEl0ZW0gPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpb3VzID0gdGhpcy5fdmFsdWUoKTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIGJsdXI6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLmNhbmNlbEJsdXIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5jYW5jZWxCbHVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KCB0aGlzLnNlYXJjaGluZyApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGFuZ2UoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICB0aGlzLl9pbml0U291cmNlKCk7DQogICAgICAgICAgICB0aGlzLm1lbnUgPSAkKCAiPHVsPiIgKQ0KICAgICAgICAgICAgICAgIC5hcHBlbmRUbyggdGhpcy5fYXBwZW5kVG8oKSApDQogICAgICAgICAgICAgICAgLm1lbnUoIHsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBkaXNhYmxlIEFSSUEgc3VwcG9ydCwgdGhlIGxpdmUgcmVnaW9uIHRha2VzIGNhcmUgb2YgdGhhdA0KICAgICAgICAgICAgICAgICAgICByb2xlOiBudWxsDQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLmhpZGUoKQ0KICAgICAgICAgICAgICAgIC5tZW51KCAiaW5zdGFuY2UiICk7DQoNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLm1lbnUuZWxlbWVudCwgInVpLWF1dG9jb21wbGV0ZSIsICJ1aS1mcm9udCIgKTsNCiAgICAgICAgICAgIHRoaXMuX29uKCB0aGlzLm1lbnUuZWxlbWVudCwgew0KICAgICAgICAgICAgICAgIG1vdXNlZG93bjogZnVuY3Rpb24oIGV2ZW50ICkgew0KDQogICAgICAgICAgICAgICAgICAgIC8vIHByZXZlbnQgbW92aW5nIGZvY3VzIG91dCBvZiB0aGUgdGV4dCBmaWVsZA0KICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIElFIGRvZXNuJ3QgcHJldmVudCBtb3ZpbmcgZm9jdXMgZXZlbiB3aXRoIGV2ZW50LnByZXZlbnREZWZhdWx0KCkNCiAgICAgICAgICAgICAgICAgICAgLy8gc28gd2Ugc2V0IGEgZmxhZyB0byBrbm93IHdoZW4gd2Ugc2hvdWxkIGlnbm9yZSB0aGUgYmx1ciBldmVudA0KICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbEJsdXIgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5jYW5jZWxCbHVyOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBTdXBwb3J0OiBJRSA4IG9ubHkNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJpZ2h0IGNsaWNraW5nIGEgbWVudSBpdGVtIG9yIHNlbGVjdGluZyB0ZXh0IGZyb20gdGhlIG1lbnUgaXRlbXMgd2lsbA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVzdWx0IGluIGZvY3VzIG1vdmluZyBvdXQgb2YgdGhlIGlucHV0LiBIb3dldmVyLCB3ZSd2ZSBhbHJlYWR5IHJlY2VpdmVkDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgaWdub3JlZCB0aGUgYmx1ciBldmVudCBiZWNhdXNlIG9mIHRoZSBjYW5jZWxCbHVyIGZsYWcgc2V0IGFib3ZlLiBTbw0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgcmVzdG9yZSBmb2N1cyB0byBlbnN1cmUgdGhhdCB0aGUgbWVudSBjbG9zZXMgcHJvcGVybHkgYmFzZWQgb24gdGhlIHVzZXIncw0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gbmV4dCBhY3Rpb25zLg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLmVsZW1lbnRbIDAgXSAhPT0gJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnRyaWdnZXIoICJmb2N1cyIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgbWVudWZvY3VzOiBmdW5jdGlvbiggZXZlbnQsIHVpICkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWwsIGl0ZW07DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gc3VwcG9ydDogRmlyZWZveA0KICAgICAgICAgICAgICAgICAgICAvLyBQcmV2ZW50IGFjY2lkZW50YWwgYWN0aXZhdGlvbiBvZiBtZW51IGl0ZW1zIGluIEZpcmVmb3ggKCM3MDI0ICM5MTE4KQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMuaXNOZXdNZW51ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc05ld01lbnUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggZXZlbnQub3JpZ2luYWxFdmVudCAmJiAvXm1vdXNlLy50ZXN0KCBldmVudC5vcmlnaW5hbEV2ZW50LnR5cGUgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnUuYmx1cigpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudC5vbmUoICJtb3VzZW1vdmUiLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCggZXZlbnQudGFyZ2V0ICkudHJpZ2dlciggZXZlbnQub3JpZ2luYWxFdmVudCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGl0ZW0gPSB1aS5pdGVtLmRhdGEoICJ1aS1hdXRvY29tcGxldGUtaXRlbSIgKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBmYWxzZSAhPT0gdGhpcy5fdHJpZ2dlciggImZvY3VzIiwgZXZlbnQsIHsgaXRlbTogaXRlbSB9ICkgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVzZSB2YWx1ZSB0byBtYXRjaCB3aGF0IHdpbGwgZW5kIHVwIGluIHRoZSBpbnB1dCwgaWYgaXQgd2FzIGEga2V5IGV2ZW50DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGV2ZW50Lm9yaWdpbmFsRXZlbnQgJiYgL15rZXkvLnRlc3QoIGV2ZW50Lm9yaWdpbmFsRXZlbnQudHlwZSApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3ZhbHVlKCBpdGVtLnZhbHVlICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBBbm5vdW5jZSB0aGUgdmFsdWUgaW4gdGhlIGxpdmVSZWdpb24NCiAgICAgICAgICAgICAgICAgICAgbGFiZWwgPSB1aS5pdGVtLmF0dHIoICJhcmlhLWxhYmVsIiApIHx8IGl0ZW0udmFsdWU7DQogICAgICAgICAgICAgICAgICAgIGlmICggbGFiZWwgJiYgJC50cmltKCBsYWJlbCApLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGl2ZVJlZ2lvbi5jaGlsZHJlbigpLmhpZGUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICQoICI8ZGl2PiIgKS50ZXh0KCBsYWJlbCApLmFwcGVuZFRvKCB0aGlzLmxpdmVSZWdpb24gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgbWVudXNlbGVjdDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSB1aS5pdGVtLmRhdGEoICJ1aS1hdXRvY29tcGxldGUtaXRlbSIgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzID0gdGhpcy5wcmV2aW91czsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHRyaWdnZXIgd2hlbiBmb2N1cyB3YXMgbG9zdCAoY2xpY2sgb24gbWVudSkNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLmVsZW1lbnRbIDAgXSAhPT0gJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudHJpZ2dlciggImZvY3VzIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aW91cyA9IHByZXZpb3VzOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyAjNjEwOSAtIElFIHRyaWdnZXJzIHR3byBmb2N1cyBldmVudHMgYW5kIHRoZSBzZWNvbmQNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFzeW5jaHJvbm91cywgc28gd2UgbmVlZCB0byByZXNldCB0aGUgcHJldmlvdXMNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRlcm0gc3luY2hyb25vdXNseSBhbmQgYXN5bmNocm9ub3VzbHkgOi0oDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aW91cyA9IHByZXZpb3VzOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtID0gaXRlbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGlmICggZmFsc2UgIT09IHRoaXMuX3RyaWdnZXIoICJzZWxlY3QiLCBldmVudCwgeyBpdGVtOiBpdGVtIH0gKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3ZhbHVlKCBpdGVtLnZhbHVlICk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAvLyByZXNldCB0aGUgdGVybSBhZnRlciB0aGUgc2VsZWN0IGV2ZW50DQogICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgYWxsb3dzIGN1c3RvbSBzZWxlY3QgaGFuZGxpbmcgdG8gd29yayBwcm9wZXJseQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRlcm0gPSB0aGlzLl92YWx1ZSgpOw0KDQogICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtID0gaXRlbTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIHRoaXMubGl2ZVJlZ2lvbiA9ICQoICI8ZGl2PiIsIHsNCiAgICAgICAgICAgICAgICByb2xlOiAic3RhdHVzIiwNCiAgICAgICAgICAgICAgICAiYXJpYS1saXZlIjogImFzc2VydGl2ZSIsDQogICAgICAgICAgICAgICAgImFyaWEtcmVsZXZhbnQiOiAiYWRkaXRpb25zIg0KICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKCB0aGlzLmRvY3VtZW50WyAwIF0uYm9keSApOw0KDQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy5saXZlUmVnaW9uLCBudWxsLCAidWktaGVscGVyLWhpZGRlbi1hY2Nlc3NpYmxlIiApOw0KDQogICAgICAgICAgICAvLyBUdXJuaW5nIG9mZiBhdXRvY29tcGxldGUgcHJldmVudHMgdGhlIGJyb3dzZXIgZnJvbSByZW1lbWJlcmluZyB0aGUNCiAgICAgICAgICAgIC8vIHZhbHVlIHdoZW4gbmF2aWdhdGluZyB0aHJvdWdoIGhpc3RvcnksIHNvIHdlIHJlLWVuYWJsZSBhdXRvY29tcGxldGUNCiAgICAgICAgICAgIC8vIGlmIHRoZSBwYWdlIGlzIHVubG9hZGVkIGJlZm9yZSB0aGUgd2lkZ2V0IGlzIGRlc3Ryb3llZC4gIzc3OTANCiAgICAgICAgICAgIHRoaXMuX29uKCB0aGlzLndpbmRvdywgew0KICAgICAgICAgICAgICAgIGJlZm9yZXVubG9hZDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyKCAiYXV0b2NvbXBsZXRlIiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZGVzdHJveTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBjbGVhclRpbWVvdXQoIHRoaXMuc2VhcmNoaW5nICk7DQogICAgICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0ciggImF1dG9jb21wbGV0ZSIgKTsNCiAgICAgICAgICAgIHRoaXMubWVudS5lbGVtZW50LnJlbW92ZSgpOw0KICAgICAgICAgICAgdGhpcy5saXZlUmVnaW9uLnJlbW92ZSgpOw0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgew0KICAgICAgICAgICAgdGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTsNCiAgICAgICAgICAgIGlmICgga2V5ID09PSAic291cmNlIiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9pbml0U291cmNlKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImFwcGVuZFRvIiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLm1lbnUuZWxlbWVudC5hcHBlbmRUbyggdGhpcy5fYXBwZW5kVG8oKSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJkaXNhYmxlZCIgJiYgdmFsdWUgJiYgdGhpcy54aHIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy54aHIuYWJvcnQoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfaXNFdmVudFRhcmdldEluV2lkZ2V0OiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgbWVudUVsZW1lbnQgPSB0aGlzLm1lbnUuZWxlbWVudFsgMCBdOw0KDQogICAgICAgICAgICByZXR1cm4gZXZlbnQudGFyZ2V0ID09PSB0aGlzLmVsZW1lbnRbIDAgXSB8fA0KICAgICAgICAgICAgICAgIGV2ZW50LnRhcmdldCA9PT0gbWVudUVsZW1lbnQgfHwNCiAgICAgICAgICAgICAgICAkLmNvbnRhaW5zKCBtZW51RWxlbWVudCwgZXZlbnQudGFyZ2V0ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2Nsb3NlT25DbGlja091dHNpZGU6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIGlmICggIXRoaXMuX2lzRXZlbnRUYXJnZXRJbldpZGdldCggZXZlbnQgKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2FwcGVuZFRvOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5vcHRpb25zLmFwcGVuZFRvOw0KDQogICAgICAgICAgICBpZiAoIGVsZW1lbnQgKSB7DQogICAgICAgICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQuanF1ZXJ5IHx8IGVsZW1lbnQubm9kZVR5cGUgPw0KICAgICAgICAgICAgICAgICAgICAkKCBlbGVtZW50ICkgOg0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50LmZpbmQoIGVsZW1lbnQgKS5lcSggMCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoICFlbGVtZW50IHx8ICFlbGVtZW50WyAwIF0gKSB7DQogICAgICAgICAgICAgICAgZWxlbWVudCA9IHRoaXMuZWxlbWVudC5jbG9zZXN0KCAiLnVpLWZyb250LCBkaWFsb2ciICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggIWVsZW1lbnQubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIGVsZW1lbnQgPSB0aGlzLmRvY3VtZW50WyAwIF0uYm9keTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2luaXRTb3VyY2U6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGFycmF5LCB1cmwsDQogICAgICAgICAgICAgICAgdGhhdCA9IHRoaXM7DQogICAgICAgICAgICBpZiAoICQuaXNBcnJheSggdGhpcy5vcHRpb25zLnNvdXJjZSApICkgew0KICAgICAgICAgICAgICAgIGFycmF5ID0gdGhpcy5vcHRpb25zLnNvdXJjZTsNCiAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZSA9IGZ1bmN0aW9uKCByZXF1ZXN0LCByZXNwb25zZSApIHsNCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UoICQudWkuYXV0b2NvbXBsZXRlLmZpbHRlciggYXJyYXksIHJlcXVlc3QudGVybSApICk7DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHR5cGVvZiB0aGlzLm9wdGlvbnMuc291cmNlID09PSAic3RyaW5nIiApIHsNCiAgICAgICAgICAgICAgICB1cmwgPSB0aGlzLm9wdGlvbnMuc291cmNlOw0KICAgICAgICAgICAgICAgIHRoaXMuc291cmNlID0gZnVuY3Rpb24oIHJlcXVlc3QsIHJlc3BvbnNlICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIHRoYXQueGhyICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC54aHIuYWJvcnQoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGF0LnhociA9ICQuYWpheCggew0KICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsDQogICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiByZXF1ZXN0LA0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKCBkYXRhICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlKCBkYXRhICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlKCBbXSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5zb3VyY2UgPSB0aGlzLm9wdGlvbnMuc291cmNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9zZWFyY2hUaW1lb3V0OiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICBjbGVhclRpbWVvdXQoIHRoaXMuc2VhcmNoaW5nICk7DQogICAgICAgICAgICB0aGlzLnNlYXJjaGluZyA9IHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgICAgIC8vIFNlYXJjaCBpZiB0aGUgdmFsdWUgaGFzIGNoYW5nZWQsIG9yIGlmIHRoZSB1c2VyIHJldHlwZXMgdGhlIHNhbWUgdmFsdWUgKHNlZSAjNzQzNCkNCiAgICAgICAgICAgICAgICB2YXIgZXF1YWxWYWx1ZXMgPSB0aGlzLnRlcm0gPT09IHRoaXMuX3ZhbHVlKCksDQogICAgICAgICAgICAgICAgICAgIG1lbnVWaXNpYmxlID0gdGhpcy5tZW51LmVsZW1lbnQuaXMoICI6dmlzaWJsZSIgKSwNCiAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJLZXkgPSBldmVudC5hbHRLZXkgfHwgZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5IHx8IGV2ZW50LnNoaWZ0S2V5Ow0KDQogICAgICAgICAgICAgICAgaWYgKCAhZXF1YWxWYWx1ZXMgfHwgKCBlcXVhbFZhbHVlcyAmJiAhbWVudVZpc2libGUgJiYgIW1vZGlmaWVyS2V5ICkgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWFyY2goIG51bGwsIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgdGhpcy5vcHRpb25zLmRlbGF5ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgc2VhcmNoOiBmdW5jdGlvbiggdmFsdWUsIGV2ZW50ICkgew0KICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSAhPSBudWxsID8gdmFsdWUgOiB0aGlzLl92YWx1ZSgpOw0KDQogICAgICAgICAgICAvLyBBbHdheXMgc2F2ZSB0aGUgYWN0dWFsIHZhbHVlLCBub3QgdGhlIG9uZSBwYXNzZWQgYXMgYW4gYXJndW1lbnQNCiAgICAgICAgICAgIHRoaXMudGVybSA9IHRoaXMuX3ZhbHVlKCk7DQoNCiAgICAgICAgICAgIGlmICggdmFsdWUubGVuZ3RoIDwgdGhpcy5vcHRpb25zLm1pbkxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jbG9zZSggZXZlbnQgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCB0aGlzLl90cmlnZ2VyKCAic2VhcmNoIiwgZXZlbnQgKSA9PT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VhcmNoKCB2YWx1ZSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9zZWFyY2g6IGZ1bmN0aW9uKCB2YWx1ZSApIHsNCiAgICAgICAgICAgIHRoaXMucGVuZGluZysrOw0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoICJ1aS1hdXRvY29tcGxldGUtbG9hZGluZyIgKTsNCiAgICAgICAgICAgIHRoaXMuY2FuY2VsU2VhcmNoID0gZmFsc2U7DQoNCiAgICAgICAgICAgIHRoaXMuc291cmNlKCB7IHRlcm06IHZhbHVlIH0sIHRoaXMuX3Jlc3BvbnNlKCkgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcmVzcG9uc2U6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGluZGV4ID0gKyt0aGlzLnJlcXVlc3RJbmRleDsNCg0KICAgICAgICAgICAgcmV0dXJuICQucHJveHkoIGZ1bmN0aW9uKCBjb250ZW50ICkgew0KICAgICAgICAgICAgICAgIGlmICggaW5kZXggPT09IHRoaXMucmVxdWVzdEluZGV4ICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9fcmVzcG9uc2UoIGNvbnRlbnQgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGlzLnBlbmRpbmctLTsNCiAgICAgICAgICAgICAgICBpZiAoICF0aGlzLnBlbmRpbmcgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCAidWktYXV0b2NvbXBsZXRlLWxvYWRpbmciICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgdGhpcyApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9fcmVzcG9uc2U6IGZ1bmN0aW9uKCBjb250ZW50ICkgew0KICAgICAgICAgICAgaWYgKCBjb250ZW50ICkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnQgPSB0aGlzLl9ub3JtYWxpemUoIGNvbnRlbnQgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJyZXNwb25zZSIsIG51bGwsIHsgY29udGVudDogY29udGVudCB9ICk7DQogICAgICAgICAgICBpZiAoICF0aGlzLm9wdGlvbnMuZGlzYWJsZWQgJiYgY29udGVudCAmJiBjb250ZW50Lmxlbmd0aCAmJiAhdGhpcy5jYW5jZWxTZWFyY2ggKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fc3VnZ2VzdCggY29udGVudCApOw0KICAgICAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJvcGVuIiApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgIC8vIHVzZSAuX2Nsb3NlKCkgaW5zdGVhZCBvZiAuY2xvc2UoKSBzbyB3ZSBkb24ndCBjYW5jZWwgZnV0dXJlIHNlYXJjaGVzDQogICAgICAgICAgICAgICAgdGhpcy5fY2xvc2UoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBjbG9zZTogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgdGhpcy5jYW5jZWxTZWFyY2ggPSB0cnVlOw0KICAgICAgICAgICAgdGhpcy5fY2xvc2UoIGV2ZW50ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2Nsb3NlOiBmdW5jdGlvbiggZXZlbnQgKSB7DQoNCiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgaGFuZGxlciB0aGF0IGNsb3NlcyB0aGUgbWVudSBvbiBvdXRzaWRlIGNsaWNrcw0KICAgICAgICAgICAgdGhpcy5fb2ZmKCB0aGlzLmRvY3VtZW50LCAibW91c2Vkb3duIiApOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMubWVudS5lbGVtZW50LmlzKCAiOnZpc2libGUiICkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5tZW51LmVsZW1lbnQuaGlkZSgpOw0KICAgICAgICAgICAgICAgIHRoaXMubWVudS5ibHVyKCk7DQogICAgICAgICAgICAgICAgdGhpcy5pc05ld01lbnUgPSB0cnVlOw0KICAgICAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJjbG9zZSIsIGV2ZW50ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2NoYW5nZTogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgaWYgKCB0aGlzLnByZXZpb3VzICE9PSB0aGlzLl92YWx1ZSgpICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJjaGFuZ2UiLCBldmVudCwgeyBpdGVtOiB0aGlzLnNlbGVjdGVkSXRlbSB9ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX25vcm1hbGl6ZTogZnVuY3Rpb24oIGl0ZW1zICkgew0KDQogICAgICAgICAgICAvLyBhc3N1bWUgYWxsIGl0ZW1zIGhhdmUgdGhlIHJpZ2h0IGZvcm1hdCB3aGVuIHRoZSBmaXJzdCBpdGVtIGlzIGNvbXBsZXRlDQogICAgICAgICAgICBpZiAoIGl0ZW1zLmxlbmd0aCAmJiBpdGVtc1sgMCBdLmxhYmVsICYmIGl0ZW1zWyAwIF0udmFsdWUgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW1zOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuICQubWFwKCBpdGVtcywgZnVuY3Rpb24oIGl0ZW0gKSB7DQogICAgICAgICAgICAgICAgaWYgKCB0eXBlb2YgaXRlbSA9PT0gInN0cmluZyIgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogaXRlbSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiAkLmV4dGVuZCgge30sIGl0ZW0sIHsNCiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGl0ZW0ubGFiZWwgfHwgaXRlbS52YWx1ZSwNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUgfHwgaXRlbS5sYWJlbA0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc3VnZ2VzdDogZnVuY3Rpb24oIGl0ZW1zICkgew0KICAgICAgICAgICAgdmFyIHVsID0gdGhpcy5tZW51LmVsZW1lbnQuZW1wdHkoKTsNCiAgICAgICAgICAgIHRoaXMuX3JlbmRlck1lbnUoIHVsLCBpdGVtcyApOw0KICAgICAgICAgICAgdGhpcy5pc05ld01lbnUgPSB0cnVlOw0KICAgICAgICAgICAgdGhpcy5tZW51LnJlZnJlc2goKTsNCg0KICAgICAgICAgICAgLy8gU2l6ZSBhbmQgcG9zaXRpb24gbWVudQ0KICAgICAgICAgICAgdWwuc2hvdygpOw0KICAgICAgICAgICAgdGhpcy5fcmVzaXplTWVudSgpOw0KICAgICAgICAgICAgdWwucG9zaXRpb24oICQuZXh0ZW5kKCB7DQogICAgICAgICAgICAgICAgb2Y6IHRoaXMuZWxlbWVudA0KICAgICAgICAgICAgfSwgdGhpcy5vcHRpb25zLnBvc2l0aW9uICkgKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuYXV0b0ZvY3VzICkgew0KICAgICAgICAgICAgICAgIHRoaXMubWVudS5uZXh0KCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIExpc3RlbiBmb3IgaW50ZXJhY3Rpb25zIG91dHNpZGUgb2YgdGhlIHdpZGdldCAoIzY2NDIpDQogICAgICAgICAgICB0aGlzLl9vbiggdGhpcy5kb2N1bWVudCwgew0KICAgICAgICAgICAgICAgIG1vdXNlZG93bjogIl9jbG9zZU9uQ2xpY2tPdXRzaWRlIg0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9yZXNpemVNZW51OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciB1bCA9IHRoaXMubWVudS5lbGVtZW50Ow0KICAgICAgICAgICAgdWwub3V0ZXJXaWR0aCggTWF0aC5tYXgoDQoNCiAgICAgICAgICAgICAgICAvLyBGaXJlZm94IHdyYXBzIGxvbmcgdGV4dCAocG9zc2libHkgYSByb3VuZGluZyBidWcpDQogICAgICAgICAgICAgICAgLy8gc28gd2UgYWRkIDFweCB0byBhdm9pZCB0aGUgd3JhcHBpbmcgKCM3NTEzKQ0KICAgICAgICAgICAgICAgIHVsLndpZHRoKCAiIiApLm91dGVyV2lkdGgoKSArIDEsDQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50Lm91dGVyV2lkdGgoKQ0KICAgICAgICAgICAgKSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9yZW5kZXJNZW51OiBmdW5jdGlvbiggdWwsIGl0ZW1zICkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KICAgICAgICAgICAgJC5lYWNoKCBpdGVtcywgZnVuY3Rpb24oIGluZGV4LCBpdGVtICkgew0KICAgICAgICAgICAgICAgIHRoYXQuX3JlbmRlckl0ZW1EYXRhKCB1bCwgaXRlbSApOw0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9yZW5kZXJJdGVtRGF0YTogZnVuY3Rpb24oIHVsLCBpdGVtICkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlckl0ZW0oIHVsLCBpdGVtICkuZGF0YSggInVpLWF1dG9jb21wbGV0ZS1pdGVtIiwgaXRlbSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9yZW5kZXJJdGVtOiBmdW5jdGlvbiggdWwsIGl0ZW0gKSB7DQogICAgICAgICAgICByZXR1cm4gJCggIjxsaT4iICkNCiAgICAgICAgICAgICAgICAuYXBwZW5kKCAkKCAiPGRpdj4iICkudGV4dCggaXRlbS5sYWJlbCApICkNCiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oIHVsICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX21vdmU6IGZ1bmN0aW9uKCBkaXJlY3Rpb24sIGV2ZW50ICkgew0KICAgICAgICAgICAgaWYgKCAhdGhpcy5tZW51LmVsZW1lbnQuaXMoICI6dmlzaWJsZSIgKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaCggbnVsbCwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIHRoaXMubWVudS5pc0ZpcnN0SXRlbSgpICYmIC9ecHJldmlvdXMvLnRlc3QoIGRpcmVjdGlvbiApIHx8DQogICAgICAgICAgICAgICAgdGhpcy5tZW51LmlzTGFzdEl0ZW0oKSAmJiAvXm5leHQvLnRlc3QoIGRpcmVjdGlvbiApICkgew0KDQogICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5pc011bHRpTGluZSApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmFsdWUoIHRoaXMudGVybSApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHRoaXMubWVudS5ibHVyKCk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5tZW51WyBkaXJlY3Rpb24gXSggZXZlbnQgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICB3aWRnZXQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMubWVudS5lbGVtZW50Ow0KICAgICAgICB9LA0KDQogICAgICAgIF92YWx1ZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZU1ldGhvZC5hcHBseSggdGhpcy5lbGVtZW50LCBhcmd1bWVudHMgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfa2V5RXZlbnQ6IGZ1bmN0aW9uKCBrZXlFdmVudCwgZXZlbnQgKSB7DQogICAgICAgICAgICBpZiAoICF0aGlzLmlzTXVsdGlMaW5lIHx8IHRoaXMubWVudS5lbGVtZW50LmlzKCAiOnZpc2libGUiICkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fbW92ZSgga2V5RXZlbnQsIGV2ZW50ICk7DQoNCiAgICAgICAgICAgICAgICAvLyBQcmV2ZW50cyBtb3ZpbmcgY3Vyc29yIHRvIGJlZ2lubmluZy9lbmQgb2YgdGhlIHRleHQgZmllbGQgaW4gc29tZSBicm93c2Vycw0KICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgLy8gU3VwcG9ydDogQ2hyb21lIDw9NTANCiAgICAgICAgLy8gV2Ugc2hvdWxkIGJlIGFibGUgdG8ganVzdCB1c2UgdGhpcy5lbGVtZW50LnByb3AoICJpc0NvbnRlbnRFZGl0YWJsZSIgKQ0KICAgICAgICAvLyBidXQgaGlkZGVuIGVsZW1lbnRzIGFsd2F5cyByZXBvcnQgZmFsc2UgaW4gQ2hyb21lLg0KICAgICAgICAvLyBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MzEzMDgyDQogICAgICAgIF9pc0NvbnRlbnRFZGl0YWJsZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7DQogICAgICAgICAgICBpZiAoICFlbGVtZW50Lmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciBlZGl0YWJsZSA9IGVsZW1lbnQucHJvcCggImNvbnRlbnRFZGl0YWJsZSIgKTsNCg0KICAgICAgICAgICAgaWYgKCBlZGl0YWJsZSA9PT0gImluaGVyaXQiICkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc0NvbnRlbnRFZGl0YWJsZSggZWxlbWVudC5wYXJlbnQoKSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gZWRpdGFibGUgPT09ICJ0cnVlIjsNCiAgICAgICAgfQ0KICAgIH0gKTsNCg0KICAgICQuZXh0ZW5kKCAkLnVpLmF1dG9jb21wbGV0ZSwgew0KICAgICAgICBlc2NhcGVSZWdleDogZnVuY3Rpb24oIHZhbHVlICkgew0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoIC9bXC1cW1xde30oKSorPy4sXFxcXiR8I1xzXS9nLCAiXFwkJiIgKTsNCiAgICAgICAgfSwNCiAgICAgICAgZmlsdGVyOiBmdW5jdGlvbiggYXJyYXksIHRlcm0gKSB7DQogICAgICAgICAgICB2YXIgbWF0Y2hlciA9IG5ldyBSZWdFeHAoICQudWkuYXV0b2NvbXBsZXRlLmVzY2FwZVJlZ2V4KCB0ZXJtICksICJpIiApOw0KICAgICAgICAgICAgcmV0dXJuICQuZ3JlcCggYXJyYXksIGZ1bmN0aW9uKCB2YWx1ZSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hlci50ZXN0KCB2YWx1ZS5sYWJlbCB8fCB2YWx1ZS52YWx1ZSB8fCB2YWx1ZSApOw0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9DQogICAgfSApOw0KDQovLyBMaXZlIHJlZ2lvbiBleHRlbnNpb24sIGFkZGluZyBhIGBtZXNzYWdlc2Agb3B0aW9uDQovLyBOT1RFOiBUaGlzIGlzIGFuIGV4cGVyaW1lbnRhbCBBUEkuIFdlIGFyZSBzdGlsbCBpbnZlc3RpZ2F0aW5nDQovLyBhIGZ1bGwgc29sdXRpb24gZm9yIHN0cmluZyBtYW5pcHVsYXRpb24gYW5kIGludGVybmF0aW9uYWxpemF0aW9uLg0KICAgICQud2lkZ2V0KCAidWkuYXV0b2NvbXBsZXRlIiwgJC51aS5hdXRvY29tcGxldGUsIHsNCiAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgbWVzc2FnZXM6IHsNCiAgICAgICAgICAgICAgICBub1Jlc3VsdHM6ICJObyBzZWFyY2ggcmVzdWx0cy4iLA0KICAgICAgICAgICAgICAgIHJlc3VsdHM6IGZ1bmN0aW9uKCBhbW91bnQgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBhbW91bnQgKyAoIGFtb3VudCA+IDEgPyAiIHJlc3VsdHMgYXJlIiA6ICIgcmVzdWx0IGlzIiApICsNCiAgICAgICAgICAgICAgICAgICAgICAgICIgYXZhaWxhYmxlLCB1c2UgdXAgYW5kIGRvd24gYXJyb3cga2V5cyB0byBuYXZpZ2F0ZS4iOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfX3Jlc3BvbnNlOiBmdW5jdGlvbiggY29udGVudCApIHsNCiAgICAgICAgICAgIHZhciBtZXNzYWdlOw0KICAgICAgICAgICAgdGhpcy5fc3VwZXJBcHBseSggYXJndW1lbnRzICk7DQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCB8fCB0aGlzLmNhbmNlbFNlYXJjaCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIGNvbnRlbnQgJiYgY29udGVudC5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgbWVzc2FnZSA9IHRoaXMub3B0aW9ucy5tZXNzYWdlcy5yZXN1bHRzKCBjb250ZW50Lmxlbmd0aCApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBtZXNzYWdlID0gdGhpcy5vcHRpb25zLm1lc3NhZ2VzLm5vUmVzdWx0czsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMubGl2ZVJlZ2lvbi5jaGlsZHJlbigpLmhpZGUoKTsNCiAgICAgICAgICAgICQoICI8ZGl2PiIgKS50ZXh0KCBtZXNzYWdlICkuYXBwZW5kVG8oIHRoaXMubGl2ZVJlZ2lvbiApOw0KICAgICAgICB9DQogICAgfSApOw0KDQogICAgdmFyIHdpZGdldHNBdXRvY29tcGxldGUgPSAkLnVpLmF1dG9jb21wbGV0ZTsNCg0KDQogICAgLyohDQogKiBqUXVlcnkgVUkgQ29udHJvbGdyb3VwIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBDb250cm9sZ3JvdXANCi8vPj5ncm91cDogV2lkZ2V0cw0KLy8+PmRlc2NyaXB0aW9uOiBWaXN1YWxseSBncm91cHMgZm9ybSBjb250cm9sIHdpZGdldHMNCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9jb250cm9sZ3JvdXAvDQovLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vY29udHJvbGdyb3VwLw0KLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2NvcmUuY3NzDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29udHJvbGdyb3VwLmNzcw0KLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzDQoNCg0KICAgIHZhciBjb250cm9sZ3JvdXBDb3JuZXJSZWdleCA9IC91aS1jb3JuZXItKFthLXpdKXsyLDZ9L2c7DQoNCiAgICB2YXIgd2lkZ2V0c0NvbnRyb2xncm91cCA9ICQud2lkZ2V0KCAidWkuY29udHJvbGdyb3VwIiwgew0KICAgICAgICB2ZXJzaW9uOiAiMS4xMi4xIiwNCiAgICAgICAgZGVmYXVsdEVsZW1lbnQ6ICI8ZGl2PiIsDQogICAgICAgIG9wdGlvbnM6IHsNCiAgICAgICAgICAgIGRpcmVjdGlvbjogImhvcml6b250YWwiLA0KICAgICAgICAgICAgZGlzYWJsZWQ6IG51bGwsDQogICAgICAgICAgICBvbmx5VmlzaWJsZTogdHJ1ZSwNCiAgICAgICAgICAgIGl0ZW1zOiB7DQogICAgICAgICAgICAgICAgImJ1dHRvbiI6ICJpbnB1dFt0eXBlPWJ1dHRvbl0sIGlucHV0W3R5cGU9c3VibWl0XSwgaW5wdXRbdHlwZT1yZXNldF0sIGJ1dHRvbiwgYSIsDQogICAgICAgICAgICAgICAgImNvbnRyb2xncm91cExhYmVsIjogIi51aS1jb250cm9sZ3JvdXAtbGFiZWwiLA0KICAgICAgICAgICAgICAgICJjaGVja2JveHJhZGlvIjogImlucHV0W3R5cGU9J2NoZWNrYm94J10sIGlucHV0W3R5cGU9J3JhZGlvJ10iLA0KICAgICAgICAgICAgICAgICJzZWxlY3RtZW51IjogInNlbGVjdCIsDQogICAgICAgICAgICAgICAgInNwaW5uZXIiOiAiLnVpLXNwaW5uZXItaW5wdXQiDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2NyZWF0ZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLl9lbmhhbmNlKCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLy8gVG8gc3VwcG9ydCB0aGUgZW5oYW5jZWQgb3B0aW9uIGluIGpRdWVyeSBNb2JpbGUsIHdlIGlzb2xhdGUgRE9NIG1hbmlwdWxhdGlvbg0KICAgICAgICBfZW5oYW5jZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLmVsZW1lbnQuYXR0ciggInJvbGUiLCAidG9vbGJhciIgKTsNCiAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpOw0KICAgICAgICB9LA0KDQogICAgICAgIF9kZXN0cm95OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuX2NhbGxDaGlsZE1ldGhvZCggImRlc3Ryb3kiICk7DQogICAgICAgICAgICB0aGlzLmNoaWxkV2lkZ2V0cy5yZW1vdmVEYXRhKCAidWktY29udHJvbGdyb3VwLWRhdGEiICk7DQogICAgICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0ciggInJvbGUiICk7DQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5pdGVtcy5jb250cm9sZ3JvdXBMYWJlbCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQNCiAgICAgICAgICAgICAgICAgICAgLmZpbmQoIHRoaXMub3B0aW9ucy5pdGVtcy5jb250cm9sZ3JvdXBMYWJlbCApDQogICAgICAgICAgICAgICAgICAgIC5maW5kKCAiLnVpLWNvbnRyb2xncm91cC1sYWJlbC1jb250ZW50cyIgKQ0KICAgICAgICAgICAgICAgICAgICAuY29udGVudHMoKS51bndyYXAoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfaW5pdFdpZGdldHM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIGNoaWxkV2lkZ2V0cyA9IFtdOw0KDQogICAgICAgICAgICAvLyBGaXJzdCB3ZSBpdGVyYXRlIG92ZXIgZWFjaCBvZiB0aGUgaXRlbXMgb3B0aW9ucw0KICAgICAgICAgICAgJC5lYWNoKCB0aGlzLm9wdGlvbnMuaXRlbXMsIGZ1bmN0aW9uKCB3aWRnZXQsIHNlbGVjdG9yICkgew0KICAgICAgICAgICAgICAgIHZhciBsYWJlbHM7DQogICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7fTsNCg0KICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgd2lkZ2V0IGhhcyBhIHNlbGVjdG9yIHNldA0KICAgICAgICAgICAgICAgIGlmICggIXNlbGVjdG9yICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCB3aWRnZXQgPT09ICJjb250cm9sZ3JvdXBMYWJlbCIgKSB7DQogICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IHRoYXQuZWxlbWVudC5maW5kKCBzZWxlY3RvciApOw0KICAgICAgICAgICAgICAgICAgICBsYWJlbHMuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9ICQoIHRoaXMgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBlbGVtZW50LmNoaWxkcmVuKCAiLnVpLWNvbnRyb2xncm91cC1sYWJlbC1jb250ZW50cyIgKS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jb250ZW50cygpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLndyYXBBbGwoICI8c3BhbiBjbGFzcz0ndWktY29udHJvbGdyb3VwLWxhYmVsLWNvbnRlbnRzJz48L3NwYW4+IiApOw0KICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX2FkZENsYXNzKCBsYWJlbHMsIG51bGwsICJ1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQgdWktc3RhdGUtZGVmYXVsdCIgKTsNCiAgICAgICAgICAgICAgICAgICAgY2hpbGRXaWRnZXRzID0gY2hpbGRXaWRnZXRzLmNvbmNhdCggbGFiZWxzLmdldCgpICk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIHdpZGdldCBhY3R1YWxseSBleGlzdHMNCiAgICAgICAgICAgICAgICBpZiAoICEkLmZuWyB3aWRnZXQgXSApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIFdlIGFzc3VtZSBldmVyeXRoaW5nIGlzIGluIHRoZSBtaWRkbGUgdG8gc3RhcnQgYmVjYXVzZSB3ZSBjYW4ndCBkZXRlcm1pbmUNCiAgICAgICAgICAgICAgICAvLyBmaXJzdCAvIGxhc3QgZWxlbWVudHMgdW50aWwgYWxsIGVuaGFuY21lbnRzIGFyZSBkb25lLg0KICAgICAgICAgICAgICAgIGlmICggdGhhdFsgIl8iICsgd2lkZ2V0ICsgIk9wdGlvbnMiIF0gKSB7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGF0WyAiXyIgKyB3aWRnZXQgKyAiT3B0aW9ucyIgXSggIm1pZGRsZSIgKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBvcHRpb25zID0geyBjbGFzc2VzOiB7fSB9Ow0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIEZpbmQgaW5zdGFuY2VzIG9mIHRoaXMgd2lkZ2V0IGluc2lkZSBjb250cm9sZ3JvdXAgYW5kIGluaXQgdGhlbQ0KICAgICAgICAgICAgICAgIHRoYXQuZWxlbWVudA0KICAgICAgICAgICAgICAgICAgICAuZmluZCggc2VsZWN0b3IgKQ0KICAgICAgICAgICAgICAgICAgICAuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9ICQoIHRoaXMgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IGVsZW1lbnRbIHdpZGdldCBdKCAiaW5zdGFuY2UiICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gY2xvbmUgdGhlIGRlZmF1bHQgb3B0aW9ucyBmb3IgdGhpcyB0eXBlIG9mIHdpZGdldCB0byBhdm9pZA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9sbHV0aW5nIHRoZSB2YXJpYWJsZSBvcHRpb25zIHdoaWNoIGhhcyBhIHdpZGVyIHNjb3BlIHRoYW4gYSBzaW5nbGUgd2lkZ2V0Lg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlT3B0aW9ucyA9ICQud2lkZ2V0LmV4dGVuZCgge30sIG9wdGlvbnMgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIGJ1dHRvbiBpcyB0aGUgY2hpbGQgb2YgYSBzcGlubmVyIGlnbm9yZSBpdA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogRmluZCBhIG1vcmUgZ2VuZXJpYyBzb2x1dGlvbg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB3aWRnZXQgPT09ICJidXR0b24iICYmIGVsZW1lbnQucGFyZW50KCAiLnVpLXNwaW5uZXIiICkubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSB3aWRnZXQgaWYgaXQgZG9lc24ndCBleGlzdA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhaW5zdGFuY2UgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBlbGVtZW50WyB3aWRnZXQgXSgpWyB3aWRnZXQgXSggImluc3RhbmNlIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBpbnN0YW5jZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZU9wdGlvbnMuY2xhc3NlcyA9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3Jlc29sdmVDbGFzc2VzVmFsdWVzKCBpbnN0YW5jZU9wdGlvbnMuY2xhc3NlcywgaW5zdGFuY2UgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRbIHdpZGdldCBdKCBpbnN0YW5jZU9wdGlvbnMgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RvcmUgYW4gaW5zdGFuY2Ugb2YgdGhlIGNvbnRyb2xncm91cCB0byBiZSBhYmxlIHRvIHJlZmVyZW5jZQ0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZnJvbSB0aGUgb3V0ZXJtb3N0IGVsZW1lbnQgZm9yIGNoYW5naW5nIG9wdGlvbnMgYW5kIHJlZnJlc2gNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3aWRnZXRFbGVtZW50ID0gZWxlbWVudFsgd2lkZ2V0IF0oICJ3aWRnZXQiICk7DQogICAgICAgICAgICAgICAgICAgICAgICAkLmRhdGEoIHdpZGdldEVsZW1lbnRbIDAgXSwgInVpLWNvbnRyb2xncm91cC1kYXRhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZSA/IGluc3RhbmNlIDogZWxlbWVudFsgd2lkZ2V0IF0oICJpbnN0YW5jZSIgKSApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBjaGlsZFdpZGdldHMucHVzaCggd2lkZ2V0RWxlbWVudFsgMCBdICk7DQogICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgdGhpcy5jaGlsZFdpZGdldHMgPSAkKCAkLnVuaXF1ZSggY2hpbGRXaWRnZXRzICkgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLmNoaWxkV2lkZ2V0cywgInVpLWNvbnRyb2xncm91cC1pdGVtIiApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9jYWxsQ2hpbGRNZXRob2Q6IGZ1bmN0aW9uKCBtZXRob2QgKSB7DQogICAgICAgICAgICB0aGlzLmNoaWxkV2lkZ2V0cy5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9ICQoIHRoaXMgKSwNCiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGVsZW1lbnQuZGF0YSggInVpLWNvbnRyb2xncm91cC1kYXRhIiApOw0KICAgICAgICAgICAgICAgIGlmICggZGF0YSAmJiBkYXRhWyBtZXRob2QgXSApIHsNCiAgICAgICAgICAgICAgICAgICAgZGF0YVsgbWV0aG9kIF0oKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3VwZGF0ZUNvcm5lckNsYXNzOiBmdW5jdGlvbiggZWxlbWVudCwgcG9zaXRpb24gKSB7DQogICAgICAgICAgICB2YXIgcmVtb3ZlID0gInVpLWNvcm5lci10b3AgdWktY29ybmVyLWJvdHRvbSB1aS1jb3JuZXItbGVmdCB1aS1jb3JuZXItcmlnaHQgdWktY29ybmVyLWFsbCI7DQogICAgICAgICAgICB2YXIgYWRkID0gdGhpcy5fYnVpbGRTaW1wbGVPcHRpb25zKCBwb3NpdGlvbiwgImxhYmVsIiApLmNsYXNzZXMubGFiZWw7DQoNCiAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCBlbGVtZW50LCBudWxsLCByZW1vdmUgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCBlbGVtZW50LCBudWxsLCBhZGQgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfYnVpbGRTaW1wbGVPcHRpb25zOiBmdW5jdGlvbiggcG9zaXRpb24sIGtleSApIHsNCiAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSB0aGlzLm9wdGlvbnMuZGlyZWN0aW9uID09PSAidmVydGljYWwiOw0KICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHsNCiAgICAgICAgICAgICAgICBjbGFzc2VzOiB7fQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHJlc3VsdC5jbGFzc2VzWyBrZXkgXSA9IHsNCiAgICAgICAgICAgICAgICAibWlkZGxlIjogIiIsDQogICAgICAgICAgICAgICAgImZpcnN0IjogInVpLWNvcm5lci0iICsgKCBkaXJlY3Rpb24gPyAidG9wIiA6ICJsZWZ0IiApLA0KICAgICAgICAgICAgICAgICJsYXN0IjogInVpLWNvcm5lci0iICsgKCBkaXJlY3Rpb24gPyAiYm90dG9tIiA6ICJyaWdodCIgKSwNCiAgICAgICAgICAgICAgICAib25seSI6ICJ1aS1jb3JuZXItYWxsIg0KICAgICAgICAgICAgfVsgcG9zaXRpb24gXTsNCg0KICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc3Bpbm5lck9wdGlvbnM6IGZ1bmN0aW9uKCBwb3NpdGlvbiApIHsNCiAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5fYnVpbGRTaW1wbGVPcHRpb25zKCBwb3NpdGlvbiwgInVpLXNwaW5uZXIiICk7DQoNCiAgICAgICAgICAgIG9wdGlvbnMuY2xhc3Nlc1sgInVpLXNwaW5uZXItdXAiIF0gPSAiIjsNCiAgICAgICAgICAgIG9wdGlvbnMuY2xhc3Nlc1sgInVpLXNwaW5uZXItZG93biIgXSA9ICIiOw0KDQogICAgICAgICAgICByZXR1cm4gb3B0aW9uczsNCiAgICAgICAgfSwNCg0KICAgICAgICBfYnV0dG9uT3B0aW9uczogZnVuY3Rpb24oIHBvc2l0aW9uICkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2J1aWxkU2ltcGxlT3B0aW9ucyggcG9zaXRpb24sICJ1aS1idXR0b24iICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2NoZWNrYm94cmFkaW9PcHRpb25zOiBmdW5jdGlvbiggcG9zaXRpb24gKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5fYnVpbGRTaW1wbGVPcHRpb25zKCBwb3NpdGlvbiwgInVpLWNoZWNrYm94cmFkaW8tbGFiZWwiICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NlbGVjdG1lbnVPcHRpb25zOiBmdW5jdGlvbiggcG9zaXRpb24gKSB7DQogICAgICAgICAgICB2YXIgZGlyZWN0aW9uID0gdGhpcy5vcHRpb25zLmRpcmVjdGlvbiA9PT0gInZlcnRpY2FsIjsNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgd2lkdGg6IGRpcmVjdGlvbiA/ICJhdXRvIiA6IGZhbHNlLA0KICAgICAgICAgICAgICAgIGNsYXNzZXM6IHsNCiAgICAgICAgICAgICAgICAgICAgbWlkZGxlOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAidWktc2VsZWN0bWVudS1idXR0b24tb3BlbiI6ICIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgInVpLXNlbGVjdG1lbnUtYnV0dG9uLWNsb3NlZCI6ICIiDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIGZpcnN0OiB7DQogICAgICAgICAgICAgICAgICAgICAgICAidWktc2VsZWN0bWVudS1idXR0b24tb3BlbiI6ICJ1aS1jb3JuZXItIiArICggZGlyZWN0aW9uID8gInRvcCIgOiAidGwiICksDQogICAgICAgICAgICAgICAgICAgICAgICAidWktc2VsZWN0bWVudS1idXR0b24tY2xvc2VkIjogInVpLWNvcm5lci0iICsgKCBkaXJlY3Rpb24gPyAidG9wIiA6ICJsZWZ0IiApDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIGxhc3Q6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJ1aS1zZWxlY3RtZW51LWJ1dHRvbi1vcGVuIjogZGlyZWN0aW9uID8gIiIgOiAidWktY29ybmVyLXRyIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ1aS1zZWxlY3RtZW51LWJ1dHRvbi1jbG9zZWQiOiAidWktY29ybmVyLSIgKyAoIGRpcmVjdGlvbiA/ICJib3R0b20iIDogInJpZ2h0IiApDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIG9ubHk6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJ1aS1zZWxlY3RtZW51LWJ1dHRvbi1vcGVuIjogInVpLWNvcm5lci10b3AiLA0KICAgICAgICAgICAgICAgICAgICAgICAgInVpLXNlbGVjdG1lbnUtYnV0dG9uLWNsb3NlZCI6ICJ1aS1jb3JuZXItYWxsIg0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9WyBwb3NpdGlvbiBdDQogICAgICAgICAgICB9Ow0KICAgICAgICB9LA0KDQogICAgICAgIF9yZXNvbHZlQ2xhc3Nlc1ZhbHVlczogZnVuY3Rpb24oIGNsYXNzZXMsIGluc3RhbmNlICkgew0KICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9Ow0KICAgICAgICAgICAgJC5lYWNoKCBjbGFzc2VzLCBmdW5jdGlvbigga2V5ICkgew0KICAgICAgICAgICAgICAgIHZhciBjdXJyZW50ID0gaW5zdGFuY2Uub3B0aW9ucy5jbGFzc2VzWyBrZXkgXSB8fCAiIjsNCiAgICAgICAgICAgICAgICBjdXJyZW50ID0gJC50cmltKCBjdXJyZW50LnJlcGxhY2UoIGNvbnRyb2xncm91cENvcm5lclJlZ2V4LCAiIiApICk7DQogICAgICAgICAgICAgICAgcmVzdWx0WyBrZXkgXSA9ICggY3VycmVudCArICIgIiArIGNsYXNzZXNbIGtleSBdICkucmVwbGFjZSggL1xzKy9nLCAiICIgKTsNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7DQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImRpcmVjdGlvbiIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ2xhc3MoICJ1aS1jb250cm9sZ3JvdXAtIiArIHRoaXMub3B0aW9ucy5kaXJlY3Rpb24gKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTsNCiAgICAgICAgICAgIGlmICgga2V5ID09PSAiZGlzYWJsZWQiICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX2NhbGxDaGlsZE1ldGhvZCggdmFsdWUgPyAiZGlzYWJsZSIgOiAiZW5hYmxlIiApOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgcmVmcmVzaDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgY2hpbGRyZW4sDQogICAgICAgICAgICAgICAgdGhhdCA9IHRoaXM7DQoNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCAidWktY29udHJvbGdyb3VwIHVpLWNvbnRyb2xncm91cC0iICsgdGhpcy5vcHRpb25zLmRpcmVjdGlvbiApOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5kaXJlY3Rpb24gPT09ICJob3Jpem9udGFsIiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggbnVsbCwgInVpLWhlbHBlci1jbGVhcmZpeCIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX2luaXRXaWRnZXRzKCk7DQoNCiAgICAgICAgICAgIGNoaWxkcmVuID0gdGhpcy5jaGlsZFdpZGdldHM7DQoNCiAgICAgICAgICAgIC8vIFdlIGZpbHRlciBoZXJlIGJlY2F1c2Ugd2UgbmVlZCB0byB0cmFjayBhbGwgY2hpbGRXaWRnZXRzIG5vdCBqdXN0IHRoZSB2aXNpYmxlIG9uZXMNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLm9ubHlWaXNpYmxlICkgew0KICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gY2hpbGRyZW4uZmlsdGVyKCAiOnZpc2libGUiICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggY2hpbGRyZW4ubGVuZ3RoICkgew0KDQogICAgICAgICAgICAgICAgLy8gV2UgZG8gdGhpcyBsYXN0IGJlY2F1c2Ugd2UgbmVlZCB0byBtYWtlIHN1cmUgYWxsIGVuaGFuY21lbnQgaXMgZG9uZQ0KICAgICAgICAgICAgICAgIC8vIGJlZm9yZSBkZXRlcm1pbmluZyBmaXJzdCBhbmQgbGFzdA0KICAgICAgICAgICAgICAgICQuZWFjaCggWyAiZmlyc3QiLCAibGFzdCIgXSwgZnVuY3Rpb24oIGluZGV4LCB2YWx1ZSApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gY2hpbGRyZW5bIHZhbHVlIF0oKS5kYXRhKCAidWktY29udHJvbGdyb3VwLWRhdGEiICk7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBpbnN0YW5jZSAmJiB0aGF0WyAiXyIgKyBpbnN0YW5jZS53aWRnZXROYW1lICsgIk9wdGlvbnMiIF0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHRoYXRbICJfIiArIGluc3RhbmNlLndpZGdldE5hbWUgKyAiT3B0aW9ucyIgXSgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbi5sZW5ndGggPT09IDEgPyAib25seSIgOiB2YWx1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuY2xhc3NlcyA9IHRoYXQuX3Jlc29sdmVDbGFzc2VzVmFsdWVzKCBvcHRpb25zLmNsYXNzZXMsIGluc3RhbmNlICk7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5lbGVtZW50WyBpbnN0YW5jZS53aWRnZXROYW1lIF0oIG9wdGlvbnMgKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3VwZGF0ZUNvcm5lckNsYXNzKCBjaGlsZHJlblsgdmFsdWUgXSgpLCB2YWx1ZSApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgLy8gRmluYWxseSBjYWxsIHRoZSByZWZyZXNoIG1ldGhvZCBvbiBlYWNoIG9mIHRoZSBjaGlsZCB3aWRnZXRzLg0KICAgICAgICAgICAgICAgIHRoaXMuX2NhbGxDaGlsZE1ldGhvZCggInJlZnJlc2giICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9ICk7DQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBDaGVja2JveHJhZGlvIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBDaGVja2JveHJhZGlvDQovLz4+Z3JvdXA6IFdpZGdldHMNCi8vPj5kZXNjcmlwdGlvbjogRW5oYW5jZXMgYSBmb3JtIHdpdGggbXVsdGlwbGUgdGhlbWVhYmxlIGNoZWNrYm94ZXMgb3IgcmFkaW8gYnV0dG9ucy4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9jaGVja2JveHJhZGlvLw0KLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL2NoZWNrYm94cmFkaW8vDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29yZS5jc3MNCi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9idXR0b24uY3NzDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY2hlY2tib3hyYWRpby5jc3MNCi8vPj5jc3MudGhlbWU6IC4uLy4uL3RoZW1lcy9iYXNlL3RoZW1lLmNzcw0KDQoNCg0KICAgICQud2lkZ2V0KCAidWkuY2hlY2tib3hyYWRpbyIsIFsgJC51aS5mb3JtUmVzZXRNaXhpbiwgew0KICAgICAgICB2ZXJzaW9uOiAiMS4xMi4xIiwNCiAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgZGlzYWJsZWQ6IG51bGwsDQogICAgICAgICAgICBsYWJlbDogbnVsbCwNCiAgICAgICAgICAgIGljb246IHRydWUsDQogICAgICAgICAgICBjbGFzc2VzOiB7DQogICAgICAgICAgICAgICAgInVpLWNoZWNrYm94cmFkaW8tbGFiZWwiOiAidWktY29ybmVyLWFsbCIsDQogICAgICAgICAgICAgICAgInVpLWNoZWNrYm94cmFkaW8taWNvbiI6ICJ1aS1jb3JuZXItYWxsIg0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9nZXRDcmVhdGVPcHRpb25zOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBkaXNhYmxlZCwgbGFiZWxzOw0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLl9zdXBlcigpIHx8IHt9Ow0KDQogICAgICAgICAgICAvLyBXZSByZWFkIHRoZSB0eXBlIGhlcmUsIGJlY2F1c2UgaXQgbWFrZXMgbW9yZSBzZW5zZSB0byB0aHJvdyBhIGVsZW1lbnQgdHlwZSBlcnJvciBmaXJzdCwNCiAgICAgICAgICAgIC8vIHJhdGhlciB0aGVuIHRoZSBlcnJvciBmb3IgbGFjayBvZiBhIGxhYmVsLiBPZnRlbiBpZiBpdHMgdGhlIHdyb25nIHR5cGUsIGl0DQogICAgICAgICAgICAvLyB3b24ndCBoYXZlIGEgbGFiZWwgKGUuZy4gY2FsbGluZyBvbiBhIGRpdiwgYnRuLCBldGMpDQogICAgICAgICAgICB0aGlzLl9yZWFkVHlwZSgpOw0KDQogICAgICAgICAgICBsYWJlbHMgPSB0aGlzLmVsZW1lbnQubGFiZWxzKCk7DQoNCiAgICAgICAgICAgIC8vIElmIHRoZXJlIGFyZSBtdWx0aXBsZSBsYWJlbHMsIHVzZSB0aGUgbGFzdCBvbmUNCiAgICAgICAgICAgIHRoaXMubGFiZWwgPSAkKCBsYWJlbHNbIGxhYmVscy5sZW5ndGggLSAxIF0gKTsNCiAgICAgICAgICAgIGlmICggIXRoaXMubGFiZWwubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgICQuZXJyb3IoICJObyBsYWJlbCBmb3VuZCBmb3IgY2hlY2tib3hyYWRpbyB3aWRnZXQiICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxMYWJlbCA9ICIiOw0KDQogICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGdldCB0aGUgbGFiZWwgdGV4dCBidXQgdGhpcyBtYXkgYWxzbyBuZWVkIHRvIG1ha2Ugc3VyZSBpdCBkb2VzIG5vdCBjb250YWluIHRoZQ0KICAgICAgICAgICAgLy8gaW5wdXQgaXRzZWxmLg0KICAgICAgICAgICAgdGhpcy5sYWJlbC5jb250ZW50cygpLm5vdCggdGhpcy5lbGVtZW50WyAwIF0gKS5lYWNoKCBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgICAgIC8vIFRoZSBsYWJlbCBjb250ZW50cyBjb3VsZCBiZSB0ZXh0LCBodG1sLCBvciBhIG1peC4gV2UgY29uY2F0IGVhY2ggZWxlbWVudCB0byBnZXQgYQ0KICAgICAgICAgICAgICAgIC8vIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgbGFiZWwsIHdpdGhvdXQgdGhlIGlucHV0IGFzIHBhcnQgb2YgaXQuDQogICAgICAgICAgICAgICAgdGhhdC5vcmlnaW5hbExhYmVsICs9IHRoaXMubm9kZVR5cGUgPT09IDMgPyAkKCB0aGlzICkudGV4dCgpIDogdGhpcy5vdXRlckhUTUw7DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIC8vIFNldCB0aGUgbGFiZWwgb3B0aW9uIGlmIHdlIGZvdW5kIGxhYmVsIHRleHQNCiAgICAgICAgICAgIGlmICggdGhpcy5vcmlnaW5hbExhYmVsICkgew0KICAgICAgICAgICAgICAgIG9wdGlvbnMubGFiZWwgPSB0aGlzLm9yaWdpbmFsTGFiZWw7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGRpc2FibGVkID0gdGhpcy5lbGVtZW50WyAwIF0uZGlzYWJsZWQ7DQogICAgICAgICAgICBpZiAoIGRpc2FibGVkICE9IG51bGwgKSB7DQogICAgICAgICAgICAgICAgb3B0aW9ucy5kaXNhYmxlZCA9IGRpc2FibGVkOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnM7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2NyZWF0ZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgY2hlY2tlZCA9IHRoaXMuZWxlbWVudFsgMCBdLmNoZWNrZWQ7DQoNCiAgICAgICAgICAgIHRoaXMuX2JpbmRGb3JtUmVzZXRIYW5kbGVyKCk7DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmRpc2FibGVkID09IG51bGwgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmRpc2FibGVkID0gdGhpcy5lbGVtZW50WyAwIF0uZGlzYWJsZWQ7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX3NldE9wdGlvbiggImRpc2FibGVkIiwgdGhpcy5vcHRpb25zLmRpc2FibGVkICk7DQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggInVpLWNoZWNrYm94cmFkaW8iLCAidWktaGVscGVyLWhpZGRlbi1hY2Nlc3NpYmxlIiApOw0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMubGFiZWwsICJ1aS1jaGVja2JveHJhZGlvLWxhYmVsIiwgInVpLWJ1dHRvbiB1aS13aWRnZXQiICk7DQoNCiAgICAgICAgICAgIGlmICggdGhpcy50eXBlID09PSAicmFkaW8iICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLmxhYmVsLCAidWktY2hlY2tib3hyYWRpby1yYWRpby1sYWJlbCIgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMubGFiZWwgJiYgdGhpcy5vcHRpb25zLmxhYmVsICE9PSB0aGlzLm9yaWdpbmFsTGFiZWwgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlTGFiZWwoKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHRoaXMub3JpZ2luYWxMYWJlbCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMubGFiZWwgPSB0aGlzLm9yaWdpbmFsTGFiZWw7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX2VuaGFuY2UoKTsNCg0KICAgICAgICAgICAgaWYgKCBjaGVja2VkICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLmxhYmVsLCAidWktY2hlY2tib3hyYWRpby1jaGVja2VkIiwgInVpLXN0YXRlLWFjdGl2ZSIgKTsNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuaWNvbiApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMuaWNvbiwgbnVsbCwgInVpLXN0YXRlLWhvdmVyIiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fb24oIHsNCiAgICAgICAgICAgICAgICBjaGFuZ2U6ICJfdG9nZ2xlQ2xhc3NlcyIsDQogICAgICAgICAgICAgICAgZm9jdXM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy5sYWJlbCwgbnVsbCwgInVpLXN0YXRlLWZvY3VzIHVpLXZpc3VhbC1mb2N1cyIgKTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIGJsdXI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5sYWJlbCwgbnVsbCwgInVpLXN0YXRlLWZvY3VzIHVpLXZpc3VhbC1mb2N1cyIgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3JlYWRUeXBlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBub2RlTmFtZSA9IHRoaXMuZWxlbWVudFsgMCBdLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICB0aGlzLnR5cGUgPSB0aGlzLmVsZW1lbnRbIDAgXS50eXBlOw0KICAgICAgICAgICAgaWYgKCBub2RlTmFtZSAhPT0gImlucHV0IiB8fCAhL3JhZGlvfGNoZWNrYm94Ly50ZXN0KCB0aGlzLnR5cGUgKSApIHsNCiAgICAgICAgICAgICAgICAkLmVycm9yKCAiQ2FuJ3QgY3JlYXRlIGNoZWNrYm94cmFkaW8gb24gZWxlbWVudC5ub2RlTmFtZT0iICsgbm9kZU5hbWUgKw0KICAgICAgICAgICAgICAgICAgICAiIGFuZCBlbGVtZW50LnR5cGU9IiArIHRoaXMudHlwZSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIC8vIFN1cHBvcnQgalF1ZXJ5IE1vYmlsZSBlbmhhbmNlZCBvcHRpb24NCiAgICAgICAgX2VuaGFuY2U6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5fdXBkYXRlSWNvbiggdGhpcy5lbGVtZW50WyAwIF0uY2hlY2tlZCApOw0KICAgICAgICB9LA0KDQogICAgICAgIHdpZGdldDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5sYWJlbDsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZ2V0UmFkaW9Hcm91cDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgZ3JvdXA7DQogICAgICAgICAgICB2YXIgbmFtZSA9IHRoaXMuZWxlbWVudFsgMCBdLm5hbWU7DQogICAgICAgICAgICB2YXIgbmFtZVNlbGVjdG9yID0gImlucHV0W25hbWU9JyIgKyAkLnVpLmVzY2FwZVNlbGVjdG9yKCBuYW1lICkgKyAiJ10iOw0KDQogICAgICAgICAgICBpZiAoICFuYW1lICkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkKCBbXSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHRoaXMuZm9ybS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgZ3JvdXAgPSAkKCB0aGlzLmZvcm1bIDAgXS5lbGVtZW50cyApLmZpbHRlciggbmFtZVNlbGVjdG9yICk7DQogICAgICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgICAgICAgLy8gTm90IGluc2lkZSBhIGZvcm0sIGNoZWNrIGFsbCBpbnB1dHMgdGhhdCBhbHNvIGFyZSBub3QgaW5zaWRlIGEgZm9ybQ0KICAgICAgICAgICAgICAgIGdyb3VwID0gJCggbmFtZVNlbGVjdG9yICkuZmlsdGVyKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQoIHRoaXMgKS5mb3JtKCkubGVuZ3RoID09PSAwOw0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGdyb3VwLm5vdCggdGhpcy5lbGVtZW50ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3RvZ2dsZUNsYXNzZXM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGNoZWNrZWQgPSB0aGlzLmVsZW1lbnRbIDAgXS5jaGVja2VkOw0KICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQ2xhc3MoIHRoaXMubGFiZWwsICJ1aS1jaGVja2JveHJhZGlvLWNoZWNrZWQiLCAidWktc3RhdGUtYWN0aXZlIiwgY2hlY2tlZCApOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5pY29uICYmIHRoaXMudHlwZSA9PT0gImNoZWNrYm94IiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVDbGFzcyggdGhpcy5pY29uLCBudWxsLCAidWktaWNvbi1jaGVjayB1aS1zdGF0ZS1jaGVja2VkIiwgY2hlY2tlZCApDQogICAgICAgICAgICAgICAgICAgIC5fdG9nZ2xlQ2xhc3MoIHRoaXMuaWNvbiwgbnVsbCwgInVpLWljb24tYmxhbmsiLCAhY2hlY2tlZCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHRoaXMudHlwZSA9PT0gInJhZGlvIiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9nZXRSYWRpb0dyb3VwKCkNCiAgICAgICAgICAgICAgICAgICAgLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gJCggdGhpcyApLmNoZWNrYm94cmFkaW8oICJpbnN0YW5jZSIgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBpbnN0YW5jZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5fcmVtb3ZlQ2xhc3MoIGluc3RhbmNlLmxhYmVsLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidWktY2hlY2tib3hyYWRpby1jaGVja2VkIiwgInVpLXN0YXRlLWFjdGl2ZSIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9kZXN0cm95OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuX3VuYmluZEZvcm1SZXNldEhhbmRsZXIoKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLmljb24gKSB7DQogICAgICAgICAgICAgICAgdGhpcy5pY29uLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgIHRoaXMuaWNvblNwYWNlLnJlbW92ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgew0KDQogICAgICAgICAgICAvLyBXZSBkb24ndCBhbGxvdyB0aGUgdmFsdWUgdG8gYmUgc2V0IHRvIG5vdGhpbmcNCiAgICAgICAgICAgIGlmICgga2V5ID09PSAibGFiZWwiICYmICF2YWx1ZSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX3N1cGVyKCBrZXksIHZhbHVlICk7DQoNCiAgICAgICAgICAgIGlmICgga2V5ID09PSAiZGlzYWJsZWQiICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUNsYXNzKCB0aGlzLmxhYmVsLCBudWxsLCAidWktc3RhdGUtZGlzYWJsZWQiLCB2YWx1ZSApOw0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudFsgMCBdLmRpc2FibGVkID0gdmFsdWU7DQoNCiAgICAgICAgICAgICAgICAvLyBEb24ndCByZWZyZXNoIHdoZW4gc2V0dGluZyBkaXNhYmxlZA0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpOw0KICAgICAgICB9LA0KDQogICAgICAgIF91cGRhdGVJY29uOiBmdW5jdGlvbiggY2hlY2tlZCApIHsNCiAgICAgICAgICAgIHZhciB0b0FkZCA9ICJ1aS1pY29uIHVpLWljb24tYmFja2dyb3VuZCAiOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5pY29uICkgew0KICAgICAgICAgICAgICAgIGlmICggIXRoaXMuaWNvbiApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pY29uID0gJCggIjxzcGFuPiIgKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pY29uU3BhY2UgPSAkKCAiPHNwYW4+IDwvc3Bhbj4iICk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLmljb25TcGFjZSwgInVpLWNoZWNrYm94cmFkaW8taWNvbi1zcGFjZSIgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMudHlwZSA9PT0gImNoZWNrYm94IiApIHsNCiAgICAgICAgICAgICAgICAgICAgdG9BZGQgKz0gY2hlY2tlZCA/ICJ1aS1pY29uLWNoZWNrIHVpLXN0YXRlLWNoZWNrZWQiIDogInVpLWljb24tYmxhbmsiOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5pY29uLCBudWxsLCBjaGVja2VkID8gInVpLWljb24tYmxhbmsiIDogInVpLWljb24tY2hlY2siICk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdG9BZGQgKz0gInVpLWljb24tYmxhbmsiOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy5pY29uLCAidWktY2hlY2tib3hyYWRpby1pY29uIiwgdG9BZGQgKTsNCiAgICAgICAgICAgICAgICBpZiAoICFjaGVja2VkICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5pY29uLCBudWxsLCAidWktaWNvbi1jaGVjayB1aS1zdGF0ZS1jaGVja2VkIiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLmljb24ucHJlcGVuZFRvKCB0aGlzLmxhYmVsICkuYWZ0ZXIoIHRoaXMuaWNvblNwYWNlICk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKCB0aGlzLmljb24gIT09IHVuZGVmaW5lZCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLmljb24ucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgdGhpcy5pY29uU3BhY2UucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuaWNvbjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfdXBkYXRlTGFiZWw6IGZ1bmN0aW9uKCkgew0KDQogICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGNvbnRlbnRzIG9mIHRoZSBsYWJlbCAoIG1pbnVzIHRoZSBpY29uLCBpY29uIHNwYWNlLCBhbmQgaW5wdXQgKQ0KICAgICAgICAgICAgdmFyIGNvbnRlbnRzID0gdGhpcy5sYWJlbC5jb250ZW50cygpLm5vdCggdGhpcy5lbGVtZW50WyAwIF0gKTsNCiAgICAgICAgICAgIGlmICggdGhpcy5pY29uICkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnRzID0gY29udGVudHMubm90KCB0aGlzLmljb25bIDAgXSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCB0aGlzLmljb25TcGFjZSApIHsNCiAgICAgICAgICAgICAgICBjb250ZW50cyA9IGNvbnRlbnRzLm5vdCggdGhpcy5pY29uU3BhY2VbIDAgXSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY29udGVudHMucmVtb3ZlKCk7DQoNCiAgICAgICAgICAgIHRoaXMubGFiZWwuYXBwZW5kKCB0aGlzLm9wdGlvbnMubGFiZWwgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICByZWZyZXNoOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBjaGVja2VkID0gdGhpcy5lbGVtZW50WyAwIF0uY2hlY2tlZCwNCiAgICAgICAgICAgICAgICBpc0Rpc2FibGVkID0gdGhpcy5lbGVtZW50WyAwIF0uZGlzYWJsZWQ7DQoNCiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUljb24oIGNoZWNrZWQgKTsNCiAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUNsYXNzKCB0aGlzLmxhYmVsLCAidWktY2hlY2tib3hyYWRpby1jaGVja2VkIiwgInVpLXN0YXRlLWFjdGl2ZSIsIGNoZWNrZWQgKTsNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmxhYmVsICE9PSBudWxsICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUxhYmVsKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggaXNEaXNhYmxlZCAhPT0gdGhpcy5vcHRpb25zLmRpc2FibGVkICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3NldE9wdGlvbnMoIHsgImRpc2FibGVkIjogaXNEaXNhYmxlZCB9ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgIH0gXSApOw0KDQogICAgdmFyIHdpZGdldHNDaGVja2JveHJhZGlvID0gJC51aS5jaGVja2JveHJhZGlvOw0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBCdXR0b24gMS4xMi4xDQogKiBodHRwOi8vanF1ZXJ5dWkuY29tDQogKg0KICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMNCiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UNCiAqLw0KDQovLz4+bGFiZWw6IEJ1dHRvbg0KLy8+Pmdyb3VwOiBXaWRnZXRzDQovLz4+ZGVzY3JpcHRpb246IEVuaGFuY2VzIGEgZm9ybSB3aXRoIHRoZW1lYWJsZSBidXR0b25zLg0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2J1dHRvbi8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9idXR0b24vDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29yZS5jc3MNCi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9idXR0b24uY3NzDQovLz4+Y3NzLnRoZW1lOiAuLi8uLi90aGVtZXMvYmFzZS90aGVtZS5jc3MNCg0KDQoNCiAgICAkLndpZGdldCggInVpLmJ1dHRvbiIsIHsNCiAgICAgICAgdmVyc2lvbjogIjEuMTIuMSIsDQogICAgICAgIGRlZmF1bHRFbGVtZW50OiAiPGJ1dHRvbj4iLA0KICAgICAgICBvcHRpb25zOiB7DQogICAgICAgICAgICBjbGFzc2VzOiB7DQogICAgICAgICAgICAgICAgInVpLWJ1dHRvbiI6ICJ1aS1jb3JuZXItYWxsIg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGRpc2FibGVkOiBudWxsLA0KICAgICAgICAgICAgaWNvbjogbnVsbCwNCiAgICAgICAgICAgIGljb25Qb3NpdGlvbjogImJlZ2lubmluZyIsDQogICAgICAgICAgICBsYWJlbDogbnVsbCwNCiAgICAgICAgICAgIHNob3dMYWJlbDogdHJ1ZQ0KICAgICAgICB9LA0KDQogICAgICAgIF9nZXRDcmVhdGVPcHRpb25zOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBkaXNhYmxlZCwNCg0KICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdG8gc3VwcG9ydCBjYXNlcyBsaWtlIGluIGpRdWVyeSBNb2JpbGUgd2hlcmUgdGhlIGJhc2Ugd2lkZ2V0IGRvZXMgaGF2ZQ0KICAgICAgICAgICAgICAgIC8vIGFuIGltcGxlbWVudGF0aW9uIG9mIF9nZXRDcmVhdGVPcHRpb25zDQogICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMuX3N1cGVyKCkgfHwge307DQoNCiAgICAgICAgICAgIHRoaXMuaXNJbnB1dCA9IHRoaXMuZWxlbWVudC5pcyggImlucHV0IiApOw0KDQogICAgICAgICAgICBkaXNhYmxlZCA9IHRoaXMuZWxlbWVudFsgMCBdLmRpc2FibGVkOw0KICAgICAgICAgICAgaWYgKCBkaXNhYmxlZCAhPSBudWxsICkgew0KICAgICAgICAgICAgICAgIG9wdGlvbnMuZGlzYWJsZWQgPSBkaXNhYmxlZDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5vcmlnaW5hbExhYmVsID0gdGhpcy5pc0lucHV0ID8gdGhpcy5lbGVtZW50LnZhbCgpIDogdGhpcy5lbGVtZW50Lmh0bWwoKTsNCiAgICAgICAgICAgIGlmICggdGhpcy5vcmlnaW5hbExhYmVsICkgew0KICAgICAgICAgICAgICAgIG9wdGlvbnMubGFiZWwgPSB0aGlzLm9yaWdpbmFsTGFiZWw7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBvcHRpb25zOw0KICAgICAgICB9LA0KDQogICAgICAgIF9jcmVhdGU6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaWYgKCAhdGhpcy5vcHRpb24uc2hvd0xhYmVsICYgIXRoaXMub3B0aW9ucy5pY29uICkgew0KICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5zaG93TGFiZWwgPSB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBXZSBoYXZlIHRvIGNoZWNrIHRoZSBvcHRpb24gYWdhaW4gaGVyZSBldmVuIHRob3VnaCB3ZSBkaWQgaW4gX2dldENyZWF0ZU9wdGlvbnMsDQogICAgICAgICAgICAvLyBiZWNhdXNlIG51bGwgbWF5IGhhdmUgYmVlbiBwYXNzZWQgb24gaW5pdCB3aGljaCB3b3VsZCBvdmVycmlkZSB3aGF0IHdhcyBzZXQgaW4NCiAgICAgICAgICAgIC8vIF9nZXRDcmVhdGVPcHRpb25zDQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCA9PSBudWxsICkgew0KICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5kaXNhYmxlZCA9IHRoaXMuZWxlbWVudFsgMCBdLmRpc2FibGVkIHx8IGZhbHNlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLmhhc1RpdGxlID0gISF0aGlzLmVsZW1lbnQuYXR0ciggInRpdGxlIiApOw0KDQogICAgICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIGxhYmVsIG5lZWRzIHRvIGJlIHNldCBvciBpZiBpdHMgYWxyZWFkeSBjb3JyZWN0DQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5sYWJlbCAmJiB0aGlzLm9wdGlvbnMubGFiZWwgIT09IHRoaXMub3JpZ2luYWxMYWJlbCApIHsNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuaXNJbnB1dCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnZhbCggdGhpcy5vcHRpb25zLmxhYmVsICk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50Lmh0bWwoIHRoaXMub3B0aW9ucy5sYWJlbCApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCAidWktYnV0dG9uIiwgInVpLXdpZGdldCIgKTsNCiAgICAgICAgICAgIHRoaXMuX3NldE9wdGlvbiggImRpc2FibGVkIiwgdGhpcy5vcHRpb25zLmRpc2FibGVkICk7DQogICAgICAgICAgICB0aGlzLl9lbmhhbmNlKCk7DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5lbGVtZW50LmlzKCAiYSIgKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9vbiggew0KICAgICAgICAgICAgICAgICAgICAia2V5dXAiOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGV2ZW50LmtleUNvZGUgPT09ICQudWkua2V5Q29kZS5TUEFDRSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3VwcG9ydDogUGhhbnRvbUpTIDw9IDEuOSwgSUUgOCBPbmx5DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgYSBuYXRpdmUgY2xpY2sgaXMgYXZhaWxhYmxlIHVzZSBpdCBzbyB3ZSBhY3R1YWxseSBjYXVzZSBuYXZpZ2F0aW9uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGp1c3QgdHJpZ2dlciBhIGNsaWNrIGV2ZW50DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLmVsZW1lbnRbIDAgXS5jbGljayApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50WyAwIF0uY2xpY2soKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudHJpZ2dlciggImNsaWNrIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfZW5oYW5jZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBpZiAoICF0aGlzLmVsZW1lbnQuaXMoICJidXR0b24iICkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmF0dHIoICJyb2xlIiwgImJ1dHRvbiIgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuaWNvbiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVJY29uKCAiaWNvbiIsIHRoaXMub3B0aW9ucy5pY29uICk7DQogICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlVG9vbHRpcCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF91cGRhdGVUb29sdGlwOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMudGl0bGUgPSB0aGlzLmVsZW1lbnQuYXR0ciggInRpdGxlIiApOw0KDQogICAgICAgICAgICBpZiAoICF0aGlzLm9wdGlvbnMuc2hvd0xhYmVsICYmICF0aGlzLnRpdGxlICkgew0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hdHRyKCAidGl0bGUiLCB0aGlzLm9wdGlvbnMubGFiZWwgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfdXBkYXRlSWNvbjogZnVuY3Rpb24oIG9wdGlvbiwgdmFsdWUgKSB7DQogICAgICAgICAgICB2YXIgaWNvbiA9IG9wdGlvbiAhPT0gImljb25Qb3NpdGlvbiIsDQogICAgICAgICAgICAgICAgcG9zaXRpb24gPSBpY29uID8gdGhpcy5vcHRpb25zLmljb25Qb3NpdGlvbiA6IHZhbHVlLA0KICAgICAgICAgICAgICAgIGRpc3BsYXlCbG9jayA9IHBvc2l0aW9uID09PSAidG9wIiB8fCBwb3NpdGlvbiA9PT0gImJvdHRvbSI7DQoNCiAgICAgICAgICAgIC8vIENyZWF0ZSBpY29uDQogICAgICAgICAgICBpZiAoICF0aGlzLmljb24gKSB7DQogICAgICAgICAgICAgICAgdGhpcy5pY29uID0gJCggIjxzcGFuPiIgKTsNCg0KICAgICAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLmljb24sICJ1aS1idXR0b24taWNvbiIsICJ1aS1pY29uIiApOw0KDQogICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5vcHRpb25zLnNob3dMYWJlbCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoICJ1aS1idXR0b24taWNvbi1vbmx5IiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGljb24gKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBJZiB3ZSBhcmUgdXBkYXRpbmcgdGhlIGljb24gcmVtb3ZlIHRoZSBvbGQgaWNvbiBjbGFzcw0KICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLmljb24sIG51bGwsIHRoaXMub3B0aW9ucy5pY29uICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIElmIHdlIGFyZSB1cGRhdGluZyB0aGUgaWNvbiBhZGQgdGhlIG5ldyBpY29uIGNsYXNzDQogICAgICAgICAgICBpZiAoIGljb24gKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMuaWNvbiwgbnVsbCwgdmFsdWUgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fYXR0YWNoSWNvbiggcG9zaXRpb24gKTsNCg0KICAgICAgICAgICAgLy8gSWYgdGhlIGljb24gaXMgb24gdG9wIG9yIGJvdHRvbSB3ZSBuZWVkIHRvIGFkZCB0aGUgdWktd2lkZ2V0LWljb24tYmxvY2sgY2xhc3MgYW5kIHJlbW92ZQ0KICAgICAgICAgICAgLy8gdGhlIGljb25TcGFjZSBpZiB0aGVyZSBpcyBvbmUuDQogICAgICAgICAgICBpZiAoIGRpc3BsYXlCbG9jayApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy5pY29uLCBudWxsLCAidWktd2lkZ2V0LWljb24tYmxvY2siICk7DQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLmljb25TcGFjZSApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pY29uU3BhY2UucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgIC8vIFBvc2l0aW9uIGlzIGJlZ2lubmluZyBvciBlbmQgc28gcmVtb3ZlIHRoZSB1aS13aWRnZXQtaWNvbi1ibG9jayBjbGFzcyBhbmQgYWRkIHRoZQ0KICAgICAgICAgICAgICAgIC8vIHNwYWNlIGlmIGl0IGRvZXMgbm90IGV4aXN0DQogICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5pY29uU3BhY2UgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaWNvblNwYWNlID0gJCggIjxzcGFuPiA8L3NwYW4+IiApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy5pY29uU3BhY2UsICJ1aS1idXR0b24taWNvbi1zcGFjZSIgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMuaWNvbiwgbnVsbCwgInVpLXdpZ2V0LWljb24tYmxvY2siICk7DQogICAgICAgICAgICAgICAgdGhpcy5fYXR0YWNoSWNvblNwYWNlKCBwb3NpdGlvbiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9kZXN0cm95OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyKCAicm9sZSIgKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLmljb24gKSB7DQogICAgICAgICAgICAgICAgdGhpcy5pY29uLnJlbW92ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCB0aGlzLmljb25TcGFjZSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLmljb25TcGFjZS5yZW1vdmUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggIXRoaXMuaGFzVGl0bGUgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoICJ0aXRsZSIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfYXR0YWNoSWNvblNwYWNlOiBmdW5jdGlvbiggaWNvblBvc2l0aW9uICkgew0KICAgICAgICAgICAgdGhpcy5pY29uWyAvXig/OmVuZHxib3R0b20pLy50ZXN0KCBpY29uUG9zaXRpb24gKSA/ICJiZWZvcmUiIDogImFmdGVyIiBdKCB0aGlzLmljb25TcGFjZSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9hdHRhY2hJY29uOiBmdW5jdGlvbiggaWNvblBvc2l0aW9uICkgew0KICAgICAgICAgICAgdGhpcy5lbGVtZW50WyAvXig/OmVuZHxib3R0b20pLy50ZXN0KCBpY29uUG9zaXRpb24gKSA/ICJhcHBlbmQiIDogInByZXBlbmQiIF0oIHRoaXMuaWNvbiApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb25zOiBmdW5jdGlvbiggb3B0aW9ucyApIHsNCiAgICAgICAgICAgIHZhciBuZXdTaG93TGFiZWwgPSBvcHRpb25zLnNob3dMYWJlbCA9PT0gdW5kZWZpbmVkID8NCiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd0xhYmVsIDoNCiAgICAgICAgICAgICAgICBvcHRpb25zLnNob3dMYWJlbCwNCiAgICAgICAgICAgICAgICBuZXdJY29uID0gb3B0aW9ucy5pY29uID09PSB1bmRlZmluZWQgPyB0aGlzLm9wdGlvbnMuaWNvbiA6IG9wdGlvbnMuaWNvbjsNCg0KICAgICAgICAgICAgaWYgKCAhbmV3U2hvd0xhYmVsICYmICFuZXdJY29uICkgew0KICAgICAgICAgICAgICAgIG9wdGlvbnMuc2hvd0xhYmVsID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX3N1cGVyKCBvcHRpb25zICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7DQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImljb24iICkgew0KICAgICAgICAgICAgICAgIGlmICggdmFsdWUgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUljb24oIGtleSwgdmFsdWUgKTsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB0aGlzLmljb24gKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaWNvbi5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLmljb25TcGFjZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaWNvblNwYWNlLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImljb25Qb3NpdGlvbiIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlSWNvbigga2V5LCB2YWx1ZSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBNYWtlIHN1cmUgd2UgY2FuJ3QgZW5kIHVwIHdpdGggYSBidXR0b24gdGhhdCBoYXMgbmVpdGhlciB0ZXh0IG5vciBpY29uDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gInNob3dMYWJlbCIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQ2xhc3MoICJ1aS1idXR0b24taWNvbi1vbmx5IiwgbnVsbCwgIXZhbHVlICk7DQogICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlVG9vbHRpcCgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImxhYmVsIiApIHsNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuaXNJbnB1dCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnZhbCggdmFsdWUgKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlIGlzIGFuIGljb24sIGFwcGVuZCBpdCwgZWxzZSBub3RoaW5nIHRoZW4gYXBwZW5kIHRoZSB2YWx1ZQ0KICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGF2b2lkcyByZW1vdmFsIG9mIHRoZSBpY29uIHdoZW4gc2V0dGluZyBsYWJlbCB0ZXh0DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5odG1sKCB2YWx1ZSApOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMuaWNvbiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2F0dGFjaEljb24oIHRoaXMub3B0aW9ucy5pY29uUG9zaXRpb24gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2F0dGFjaEljb25TcGFjZSggdGhpcy5vcHRpb25zLmljb25Qb3NpdGlvbiApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApOw0KDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImRpc2FibGVkIiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVDbGFzcyggbnVsbCwgInVpLXN0YXRlLWRpc2FibGVkIiwgdmFsdWUgKTsNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRbIDAgXS5kaXNhYmxlZCA9IHZhbHVlOw0KICAgICAgICAgICAgICAgIGlmICggdmFsdWUgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5ibHVyKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHJlZnJlc2g6IGZ1bmN0aW9uKCkgew0KDQogICAgICAgICAgICAvLyBNYWtlIHN1cmUgdG8gb25seSBjaGVjayBkaXNhYmxlZCBpZiBpdHMgYW4gZWxlbWVudCB0aGF0IHN1cHBvcnRzIHRoaXMgb3RoZXJ3aXNlDQogICAgICAgICAgICAvLyBjaGVjayBmb3IgdGhlIGRpc2FibGVkIGNsYXNzIHRvIGRldGVybWluZSBzdGF0ZQ0KICAgICAgICAgICAgdmFyIGlzRGlzYWJsZWQgPSB0aGlzLmVsZW1lbnQuaXMoICJpbnB1dCwgYnV0dG9uIiApID8NCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRbIDAgXS5kaXNhYmxlZCA6IHRoaXMuZWxlbWVudC5oYXNDbGFzcyggInVpLWJ1dHRvbi1kaXNhYmxlZCIgKTsNCg0KICAgICAgICAgICAgaWYgKCBpc0Rpc2FibGVkICE9PSB0aGlzLm9wdGlvbnMuZGlzYWJsZWQgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fc2V0T3B0aW9ucyggeyBkaXNhYmxlZDogaXNEaXNhYmxlZCB9ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVRvb2x0aXAoKTsNCiAgICAgICAgfQ0KICAgIH0gKTsNCg0KLy8gREVQUkVDQVRFRA0KICAgIGlmICggJC51aUJhY2tDb21wYXQgIT09IGZhbHNlICkgew0KDQogICAgICAgIC8vIFRleHQgYW5kIEljb25zIG9wdGlvbnMNCiAgICAgICAgJC53aWRnZXQoICJ1aS5idXR0b24iLCAkLnVpLmJ1dHRvbiwgew0KICAgICAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgICAgIHRleHQ6IHRydWUsDQogICAgICAgICAgICAgICAgaWNvbnM6IHsNCiAgICAgICAgICAgICAgICAgICAgcHJpbWFyeTogbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgc2Vjb25kYXJ5OiBudWxsDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgX2NyZWF0ZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuc2hvd0xhYmVsICYmICF0aGlzLm9wdGlvbnMudGV4dCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnNob3dMYWJlbCA9IHRoaXMub3B0aW9ucy50ZXh0Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoICF0aGlzLm9wdGlvbnMuc2hvd0xhYmVsICYmIHRoaXMub3B0aW9ucy50ZXh0ICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMudGV4dCA9IHRoaXMub3B0aW9ucy5zaG93TGFiZWw7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICggIXRoaXMub3B0aW9ucy5pY29uICYmICggdGhpcy5vcHRpb25zLmljb25zLnByaW1hcnkgfHwNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmljb25zLnNlY29uZGFyeSApICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5pY29ucy5wcmltYXJ5ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmljb24gPSB0aGlzLm9wdGlvbnMuaWNvbnMucHJpbWFyeTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5pY29uID0gdGhpcy5vcHRpb25zLmljb25zLnNlY29uZGFyeTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5pY29uUG9zaXRpb24gPSAiZW5kIjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIHRoaXMub3B0aW9ucy5pY29uICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuaWNvbnMucHJpbWFyeSA9IHRoaXMub3B0aW9ucy5pY29uOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLl9zdXBlcigpOw0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgX3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7DQogICAgICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJ0ZXh0IiApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3VwZXIoICJzaG93TGFiZWwiLCB2YWx1ZSApOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICgga2V5ID09PSAic2hvd0xhYmVsIiApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnRleHQgPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJpY29uIiApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmljb25zLnByaW1hcnkgPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJpY29ucyIgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggdmFsdWUucHJpbWFyeSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N1cGVyKCAiaWNvbiIsIHZhbHVlLnByaW1hcnkgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N1cGVyKCAiaWNvblBvc2l0aW9uIiwgImJlZ2lubmluZyIgKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggdmFsdWUuc2Vjb25kYXJ5ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3VwZXIoICJpY29uIiwgdmFsdWUuc2Vjb25kYXJ5ICk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdXBlciggImljb25Qb3NpdGlvbiIsICJlbmQiICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5fc3VwZXJBcHBseSggYXJndW1lbnRzICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gKTsNCg0KICAgICAgICAkLmZuLmJ1dHRvbiA9ICggZnVuY3Rpb24oIG9yaWcgKSB7DQogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5sZW5ndGggfHwgKCB0aGlzLmxlbmd0aCAmJiB0aGlzWyAwIF0udGFnTmFtZSAhPT0gIklOUFVUIiApIHx8DQogICAgICAgICAgICAgICAgICAgICggdGhpcy5sZW5ndGggJiYgdGhpc1sgMCBdLnRhZ05hbWUgPT09ICJJTlBVVCIgJiYgKA0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hdHRyKCAidHlwZSIgKSAhPT0gImNoZWNrYm94IiAmJiB0aGlzLmF0dHIoICJ0eXBlIiApICE9PSAicmFkaW8iDQogICAgICAgICAgICAgICAgICAgICkgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9yaWcuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoICEkLnVpLmNoZWNrYm94cmFkaW8gKSB7DQogICAgICAgICAgICAgICAgICAgICQuZXJyb3IoICJDaGVja2JveHJhZGlvIHdpZGdldCBtaXNzaW5nIiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoIGFyZ3VtZW50cy5sZW5ndGggPT09IDAgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNoZWNrYm94cmFkaW8oIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJpY29uIjogZmFsc2UNCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jaGVja2JveHJhZGlvLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsNCiAgICAgICAgICAgIH07DQogICAgICAgIH0gKSggJC5mbi5idXR0b24gKTsNCg0KICAgICAgICAkLmZuLmJ1dHRvbnNldCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaWYgKCAhJC51aS5jb250cm9sZ3JvdXAgKSB7DQogICAgICAgICAgICAgICAgJC5lcnJvciggIkNvbnRyb2xncm91cCB3aWRnZXQgbWlzc2luZyIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggYXJndW1lbnRzWyAwIF0gPT09ICJvcHRpb24iICYmIGFyZ3VtZW50c1sgMSBdID09PSAiaXRlbXMiICYmIGFyZ3VtZW50c1sgMiBdICkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRyb2xncm91cC5hcHBseSggdGhpcywNCiAgICAgICAgICAgICAgICAgICAgWyBhcmd1bWVudHNbIDAgXSwgIml0ZW1zLmJ1dHRvbiIsIGFyZ3VtZW50c1sgMiBdIF0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggYXJndW1lbnRzWyAwIF0gPT09ICJvcHRpb24iICYmIGFyZ3VtZW50c1sgMSBdID09PSAiaXRlbXMiICkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRyb2xncm91cC5hcHBseSggdGhpcywgWyBhcmd1bWVudHNbIDAgXSwgIml0ZW1zLmJ1dHRvbiIgXSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCB0eXBlb2YgYXJndW1lbnRzWyAwIF0gPT09ICJvYmplY3QiICYmIGFyZ3VtZW50c1sgMCBdLml0ZW1zICkgew0KICAgICAgICAgICAgICAgIGFyZ3VtZW50c1sgMCBdLml0ZW1zID0gew0KICAgICAgICAgICAgICAgICAgICBidXR0b246IGFyZ3VtZW50c1sgMCBdLml0ZW1zDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRyb2xncm91cC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7DQogICAgICAgIH07DQogICAgfQ0KDQogICAgdmFyIHdpZGdldHNCdXR0b24gPSAkLnVpLmJ1dHRvbjsNCg0KDQovLyBqc2NzOmRpc2FibGUgbWF4aW11bUxpbmVMZW5ndGgNCiAgICAvKiBqc2NzOmRpc2FibGUgcmVxdWlyZUNhbWVsQ2FzZU9yVXBwZXJDYXNlSWRlbnRpZmllcnMgKi8NCiAgICAvKiENCiAqIGpRdWVyeSBVSSBEYXRlcGlja2VyIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBEYXRlcGlja2VyDQovLz4+Z3JvdXA6IFdpZGdldHMNCi8vPj5kZXNjcmlwdGlvbjogRGlzcGxheXMgYSBjYWxlbmRhciBmcm9tIGFuIGlucHV0IG9yIGlubGluZSBmb3Igc2VsZWN0aW5nIGRhdGVzLg0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2RhdGVwaWNrZXIvDQovLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vZGF0ZXBpY2tlci8NCi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9jb3JlLmNzcw0KLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2RhdGVwaWNrZXIuY3NzDQovLz4+Y3NzLnRoZW1lOiAuLi8uLi90aGVtZXMvYmFzZS90aGVtZS5jc3MNCg0KDQoNCiAgICAkLmV4dGVuZCggJC51aSwgeyBkYXRlcGlja2VyOiB7IHZlcnNpb246ICIxLjEyLjEiIH0gfSApOw0KDQogICAgdmFyIGRhdGVwaWNrZXJfaW5zdEFjdGl2ZTsNCg0KICAgIGZ1bmN0aW9uIGRhdGVwaWNrZXJfZ2V0WmluZGV4KCBlbGVtICkgew0KICAgICAgICB2YXIgcG9zaXRpb24sIHZhbHVlOw0KICAgICAgICB3aGlsZSAoIGVsZW0ubGVuZ3RoICYmIGVsZW1bIDAgXSAhPT0gZG9jdW1lbnQgKSB7DQoNCiAgICAgICAgICAgIC8vIElnbm9yZSB6LWluZGV4IGlmIHBvc2l0aW9uIGlzIHNldCB0byBhIHZhbHVlIHdoZXJlIHotaW5kZXggaXMgaWdub3JlZCBieSB0aGUgYnJvd3Nlcg0KICAgICAgICAgICAgLy8gVGhpcyBtYWtlcyBiZWhhdmlvciBvZiB0aGlzIGZ1bmN0aW9uIGNvbnNpc3RlbnQgYWNyb3NzIGJyb3dzZXJzDQogICAgICAgICAgICAvLyBXZWJLaXQgYWx3YXlzIHJldHVybnMgYXV0byBpZiB0aGUgZWxlbWVudCBpcyBwb3NpdGlvbmVkDQogICAgICAgICAgICBwb3NpdGlvbiA9IGVsZW0uY3NzKCAicG9zaXRpb24iICk7DQogICAgICAgICAgICBpZiAoIHBvc2l0aW9uID09PSAiYWJzb2x1dGUiIHx8IHBvc2l0aW9uID09PSAicmVsYXRpdmUiIHx8IHBvc2l0aW9uID09PSAiZml4ZWQiICkgew0KDQogICAgICAgICAgICAgICAgLy8gSUUgcmV0dXJucyAwIHdoZW4gekluZGV4IGlzIG5vdCBzcGVjaWZpZWQNCiAgICAgICAgICAgICAgICAvLyBvdGhlciBicm93c2VycyByZXR1cm4gYSBzdHJpbmcNCiAgICAgICAgICAgICAgICAvLyB3ZSBpZ25vcmUgdGhlIGNhc2Ugb2YgbmVzdGVkIGVsZW1lbnRzIHdpdGggYW4gZXhwbGljaXQgdmFsdWUgb2YgMA0KICAgICAgICAgICAgICAgIC8vIDxkaXYgc3R5bGU9InotaW5kZXg6IC0xMDsiPjxkaXYgc3R5bGU9InotaW5kZXg6IDA7Ij48L2Rpdj48L2Rpdj4NCiAgICAgICAgICAgICAgICB2YWx1ZSA9IHBhcnNlSW50KCBlbGVtLmNzcyggInpJbmRleCIgKSwgMTAgKTsNCiAgICAgICAgICAgICAgICBpZiAoICFpc05hTiggdmFsdWUgKSAmJiB2YWx1ZSAhPT0gMCApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsZW0gPSBlbGVtLnBhcmVudCgpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIDA7DQogICAgfQ0KICAgIC8qIERhdGUgcGlja2VyIG1hbmFnZXIuDQogICBVc2UgdGhlIHNpbmdsZXRvbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLCAkLmRhdGVwaWNrZXIsIHRvIGludGVyYWN0IHdpdGggdGhlIGRhdGUgcGlja2VyLg0KICAgU2V0dGluZ3MgZm9yIChncm91cHMgb2YpIGRhdGUgcGlja2VycyBhcmUgbWFpbnRhaW5lZCBpbiBhbiBpbnN0YW5jZSBvYmplY3QsDQogICBhbGxvd2luZyBtdWx0aXBsZSBkaWZmZXJlbnQgc2V0dGluZ3Mgb24gdGhlIHNhbWUgcGFnZS4gKi8NCg0KICAgIGZ1bmN0aW9uIERhdGVwaWNrZXIoKSB7DQogICAgICAgIHRoaXMuX2N1ckluc3QgPSBudWxsOyAvLyBUaGUgY3VycmVudCBpbnN0YW5jZSBpbiB1c2UNCiAgICAgICAgdGhpcy5fa2V5RXZlbnQgPSBmYWxzZTsgLy8gSWYgdGhlIGxhc3QgZXZlbnQgd2FzIGEga2V5IGV2ZW50DQogICAgICAgIHRoaXMuX2Rpc2FibGVkSW5wdXRzID0gW107IC8vIExpc3Qgb2YgZGF0ZSBwaWNrZXIgaW5wdXRzIHRoYXQgaGF2ZSBiZWVuIGRpc2FibGVkDQogICAgICAgIHRoaXMuX2RhdGVwaWNrZXJTaG93aW5nID0gZmFsc2U7IC8vIFRydWUgaWYgdGhlIHBvcHVwIHBpY2tlciBpcyBzaG93aW5nICwgZmFsc2UgaWYgbm90DQogICAgICAgIHRoaXMuX2luRGlhbG9nID0gZmFsc2U7IC8vIFRydWUgaWYgc2hvd2luZyB3aXRoaW4gYSAiZGlhbG9nIiwgZmFsc2UgaWYgbm90DQogICAgICAgIHRoaXMuX21haW5EaXZJZCA9ICJ1aS1kYXRlcGlja2VyLWRpdiI7IC8vIFRoZSBJRCBvZiB0aGUgbWFpbiBkYXRlcGlja2VyIGRpdmlzaW9uDQogICAgICAgIHRoaXMuX2lubGluZUNsYXNzID0gInVpLWRhdGVwaWNrZXItaW5saW5lIjsgLy8gVGhlIG5hbWUgb2YgdGhlIGlubGluZSBtYXJrZXIgY2xhc3MNCiAgICAgICAgdGhpcy5fYXBwZW5kQ2xhc3MgPSAidWktZGF0ZXBpY2tlci1hcHBlbmQiOyAvLyBUaGUgbmFtZSBvZiB0aGUgYXBwZW5kIG1hcmtlciBjbGFzcw0KICAgICAgICB0aGlzLl90cmlnZ2VyQ2xhc3MgPSAidWktZGF0ZXBpY2tlci10cmlnZ2VyIjsgLy8gVGhlIG5hbWUgb2YgdGhlIHRyaWdnZXIgbWFya2VyIGNsYXNzDQogICAgICAgIHRoaXMuX2RpYWxvZ0NsYXNzID0gInVpLWRhdGVwaWNrZXItZGlhbG9nIjsgLy8gVGhlIG5hbWUgb2YgdGhlIGRpYWxvZyBtYXJrZXIgY2xhc3MNCiAgICAgICAgdGhpcy5fZGlzYWJsZUNsYXNzID0gInVpLWRhdGVwaWNrZXItZGlzYWJsZWQiOyAvLyBUaGUgbmFtZSBvZiB0aGUgZGlzYWJsZWQgY292ZXJpbmcgbWFya2VyIGNsYXNzDQogICAgICAgIHRoaXMuX3Vuc2VsZWN0YWJsZUNsYXNzID0gInVpLWRhdGVwaWNrZXItdW5zZWxlY3RhYmxlIjsgLy8gVGhlIG5hbWUgb2YgdGhlIHVuc2VsZWN0YWJsZSBjZWxsIG1hcmtlciBjbGFzcw0KICAgICAgICB0aGlzLl9jdXJyZW50Q2xhc3MgPSAidWktZGF0ZXBpY2tlci1jdXJyZW50LWRheSI7IC8vIFRoZSBuYW1lIG9mIHRoZSBjdXJyZW50IGRheSBtYXJrZXIgY2xhc3MNCiAgICAgICAgdGhpcy5fZGF5T3ZlckNsYXNzID0gInVpLWRhdGVwaWNrZXItZGF5cy1jZWxsLW92ZXIiOyAvLyBUaGUgbmFtZSBvZiB0aGUgZGF5IGhvdmVyIG1hcmtlciBjbGFzcw0KICAgICAgICB0aGlzLnJlZ2lvbmFsID0gW107IC8vIEF2YWlsYWJsZSByZWdpb25hbCBzZXR0aW5ncywgaW5kZXhlZCBieSBsYW5ndWFnZSBjb2RlDQogICAgICAgIHRoaXMucmVnaW9uYWxbICIiIF0gPSB7IC8vIERlZmF1bHQgcmVnaW9uYWwgc2V0dGluZ3MNCiAgICAgICAgICAgIGNsb3NlVGV4dDogIkRvbmUiLCAvLyBEaXNwbGF5IHRleHQgZm9yIGNsb3NlIGxpbmsNCiAgICAgICAgICAgIHByZXZUZXh0OiAiUHJldiIsIC8vIERpc3BsYXkgdGV4dCBmb3IgcHJldmlvdXMgbW9udGggbGluaw0KICAgICAgICAgICAgbmV4dFRleHQ6ICJOZXh0IiwgLy8gRGlzcGxheSB0ZXh0IGZvciBuZXh0IG1vbnRoIGxpbmsNCiAgICAgICAgICAgIGN1cnJlbnRUZXh0OiAiVG9kYXkiLCAvLyBEaXNwbGF5IHRleHQgZm9yIGN1cnJlbnQgbW9udGggbGluaw0KICAgICAgICAgICAgbW9udGhOYW1lczogWyAiSmFudWFyeSIsIkZlYnJ1YXJ5IiwiTWFyY2giLCJBcHJpbCIsIk1heSIsIkp1bmUiLA0KICAgICAgICAgICAgICAgICJKdWx5IiwiQXVndXN0IiwiU2VwdGVtYmVyIiwiT2N0b2JlciIsIk5vdmVtYmVyIiwiRGVjZW1iZXIiIF0sIC8vIE5hbWVzIG9mIG1vbnRocyBmb3IgZHJvcC1kb3duIGFuZCBmb3JtYXR0aW5nDQogICAgICAgICAgICBtb250aE5hbWVzU2hvcnQ6IFsgIkphbiIsICJGZWIiLCAiTWFyIiwgIkFwciIsICJNYXkiLCAiSnVuIiwgIkp1bCIsICJBdWciLCAiU2VwIiwgIk9jdCIsICJOb3YiLCAiRGVjIiBdLCAvLyBGb3IgZm9ybWF0dGluZw0KICAgICAgICAgICAgZGF5TmFtZXM6IFsgIlN1bmRheSIsICJNb25kYXkiLCAiVHVlc2RheSIsICJXZWRuZXNkYXkiLCAiVGh1cnNkYXkiLCAiRnJpZGF5IiwgIlNhdHVyZGF5IiBdLCAvLyBGb3IgZm9ybWF0dGluZw0KICAgICAgICAgICAgZGF5TmFtZXNTaG9ydDogWyAiU3VuIiwgIk1vbiIsICJUdWUiLCAiV2VkIiwgIlRodSIsICJGcmkiLCAiU2F0IiBdLCAvLyBGb3IgZm9ybWF0dGluZw0KICAgICAgICAgICAgZGF5TmFtZXNNaW46IFsgIlN1IiwiTW8iLCJUdSIsIldlIiwiVGgiLCJGciIsIlNhIiBdLCAvLyBDb2x1bW4gaGVhZGluZ3MgZm9yIGRheXMgc3RhcnRpbmcgYXQgU3VuZGF5DQogICAgICAgICAgICB3ZWVrSGVhZGVyOiAiV2siLCAvLyBDb2x1bW4gaGVhZGVyIGZvciB3ZWVrIG9mIHRoZSB5ZWFyDQogICAgICAgICAgICBkYXRlRm9ybWF0OiAibW0vZGQveXkiLCAvLyBTZWUgZm9ybWF0IG9wdGlvbnMgb24gcGFyc2VEYXRlDQogICAgICAgICAgICBmaXJzdERheTogMCwgLy8gVGhlIGZpcnN0IGRheSBvZiB0aGUgd2VlaywgU3VuID0gMCwgTW9uID0gMSwgLi4uDQogICAgICAgICAgICBpc1JUTDogZmFsc2UsIC8vIFRydWUgaWYgcmlnaHQtdG8tbGVmdCBsYW5ndWFnZSwgZmFsc2UgaWYgbGVmdC10by1yaWdodA0KICAgICAgICAgICAgc2hvd01vbnRoQWZ0ZXJZZWFyOiBmYWxzZSwgLy8gVHJ1ZSBpZiB0aGUgeWVhciBzZWxlY3QgcHJlY2VkZXMgbW9udGgsIGZhbHNlIGZvciBtb250aCB0aGVuIHllYXINCiAgICAgICAgICAgIHllYXJTdWZmaXg6ICIiIC8vIEFkZGl0aW9uYWwgdGV4dCB0byBhcHBlbmQgdG8gdGhlIHllYXIgaW4gdGhlIG1vbnRoIGhlYWRlcnMNCiAgICAgICAgfTsNCiAgICAgICAgdGhpcy5fZGVmYXVsdHMgPSB7IC8vIEdsb2JhbCBkZWZhdWx0cyBmb3IgYWxsIHRoZSBkYXRlIHBpY2tlciBpbnN0YW5jZXMNCiAgICAgICAgICAgIHNob3dPbjogImZvY3VzIiwgLy8gImZvY3VzIiBmb3IgcG9wdXAgb24gZm9jdXMsDQogICAgICAgICAgICAvLyAiYnV0dG9uIiBmb3IgdHJpZ2dlciBidXR0b24sIG9yICJib3RoIiBmb3IgZWl0aGVyDQogICAgICAgICAgICBzaG93QW5pbTogImZhZGVJbiIsIC8vIE5hbWUgb2YgalF1ZXJ5IGFuaW1hdGlvbiBmb3IgcG9wdXANCiAgICAgICAgICAgIHNob3dPcHRpb25zOiB7fSwgLy8gT3B0aW9ucyBmb3IgZW5oYW5jZWQgYW5pbWF0aW9ucw0KICAgICAgICAgICAgZGVmYXVsdERhdGU6IG51bGwsIC8vIFVzZWQgd2hlbiBmaWVsZCBpcyBibGFuazogYWN0dWFsIGRhdGUsDQogICAgICAgICAgICAvLyArLy1udW1iZXIgZm9yIG9mZnNldCBmcm9tIHRvZGF5LCBudWxsIGZvciB0b2RheQ0KICAgICAgICAgICAgYXBwZW5kVGV4dDogIiIsIC8vIERpc3BsYXkgdGV4dCBmb2xsb3dpbmcgdGhlIGlucHV0IGJveCwgZS5nLiBzaG93aW5nIHRoZSBmb3JtYXQNCiAgICAgICAgICAgIGJ1dHRvblRleHQ6ICIuLi4iLCAvLyBUZXh0IGZvciB0cmlnZ2VyIGJ1dHRvbg0KICAgICAgICAgICAgYnV0dG9uSW1hZ2U6ICIiLCAvLyBVUkwgZm9yIHRyaWdnZXIgYnV0dG9uIGltYWdlDQogICAgICAgICAgICBidXR0b25JbWFnZU9ubHk6IGZhbHNlLCAvLyBUcnVlIGlmIHRoZSBpbWFnZSBhcHBlYXJzIGFsb25lLCBmYWxzZSBpZiBpdCBhcHBlYXJzIG9uIGEgYnV0dG9uDQogICAgICAgICAgICBoaWRlSWZOb1ByZXZOZXh0OiBmYWxzZSwgLy8gVHJ1ZSB0byBoaWRlIG5leHQvcHJldmlvdXMgbW9udGggbGlua3MNCiAgICAgICAgICAgIC8vIGlmIG5vdCBhcHBsaWNhYmxlLCBmYWxzZSB0byBqdXN0IGRpc2FibGUgdGhlbQ0KICAgICAgICAgICAgbmF2aWdhdGlvbkFzRGF0ZUZvcm1hdDogZmFsc2UsIC8vIFRydWUgaWYgZGF0ZSBmb3JtYXR0aW5nIGFwcGxpZWQgdG8gcHJldi90b2RheS9uZXh0IGxpbmtzDQogICAgICAgICAgICBnb3RvQ3VycmVudDogZmFsc2UsIC8vIFRydWUgaWYgdG9kYXkgbGluayBnb2VzIGJhY2sgdG8gY3VycmVudCBzZWxlY3Rpb24gaW5zdGVhZA0KICAgICAgICAgICAgY2hhbmdlTW9udGg6IGZhbHNlLCAvLyBUcnVlIGlmIG1vbnRoIGNhbiBiZSBzZWxlY3RlZCBkaXJlY3RseSwgZmFsc2UgaWYgb25seSBwcmV2L25leHQNCiAgICAgICAgICAgIGNoYW5nZVllYXI6IGZhbHNlLCAvLyBUcnVlIGlmIHllYXIgY2FuIGJlIHNlbGVjdGVkIGRpcmVjdGx5LCBmYWxzZSBpZiBvbmx5IHByZXYvbmV4dA0KICAgICAgICAgICAgeWVhclJhbmdlOiAiYy0xMDpjKzEwIiwgLy8gUmFuZ2Ugb2YgeWVhcnMgdG8gZGlzcGxheSBpbiBkcm9wLWRvd24sDQogICAgICAgICAgICAvLyBlaXRoZXIgcmVsYXRpdmUgdG8gdG9kYXkncyB5ZWFyICgtbm46K25uKSwgcmVsYXRpdmUgdG8gY3VycmVudGx5IGRpc3BsYXllZCB5ZWFyDQogICAgICAgICAgICAvLyAoYy1ubjpjK25uKSwgYWJzb2x1dGUgKG5ubm46bm5ubiksIG9yIGEgY29tYmluYXRpb24gb2YgdGhlIGFib3ZlIChubm5uOi1uKQ0KICAgICAgICAgICAgc2hvd090aGVyTW9udGhzOiBmYWxzZSwgLy8gVHJ1ZSB0byBzaG93IGRhdGVzIGluIG90aGVyIG1vbnRocywgZmFsc2UgdG8gbGVhdmUgYmxhbmsNCiAgICAgICAgICAgIHNlbGVjdE90aGVyTW9udGhzOiBmYWxzZSwgLy8gVHJ1ZSB0byBhbGxvdyBzZWxlY3Rpb24gb2YgZGF0ZXMgaW4gb3RoZXIgbW9udGhzLCBmYWxzZSBmb3IgdW5zZWxlY3RhYmxlDQogICAgICAgICAgICBzaG93V2VlazogZmFsc2UsIC8vIFRydWUgdG8gc2hvdyB3ZWVrIG9mIHRoZSB5ZWFyLCBmYWxzZSB0byBub3Qgc2hvdyBpdA0KICAgICAgICAgICAgY2FsY3VsYXRlV2VlazogdGhpcy5pc284NjAxV2VlaywgLy8gSG93IHRvIGNhbGN1bGF0ZSB0aGUgd2VlayBvZiB0aGUgeWVhciwNCiAgICAgICAgICAgIC8vIHRha2VzIGEgRGF0ZSBhbmQgcmV0dXJucyB0aGUgbnVtYmVyIG9mIHRoZSB3ZWVrIGZvciBpdA0KICAgICAgICAgICAgc2hvcnRZZWFyQ3V0b2ZmOiAiKzEwIiwgLy8gU2hvcnQgeWVhciB2YWx1ZXMgPCB0aGlzIGFyZSBpbiB0aGUgY3VycmVudCBjZW50dXJ5LA0KICAgICAgICAgICAgLy8gPiB0aGlzIGFyZSBpbiB0aGUgcHJldmlvdXMgY2VudHVyeSwNCiAgICAgICAgICAgIC8vIHN0cmluZyB2YWx1ZSBzdGFydGluZyB3aXRoICIrIiBmb3IgY3VycmVudCB5ZWFyICsgdmFsdWUNCiAgICAgICAgICAgIG1pbkRhdGU6IG51bGwsIC8vIFRoZSBlYXJsaWVzdCBzZWxlY3RhYmxlIGRhdGUsIG9yIG51bGwgZm9yIG5vIGxpbWl0DQogICAgICAgICAgICBtYXhEYXRlOiBudWxsLCAvLyBUaGUgbGF0ZXN0IHNlbGVjdGFibGUgZGF0ZSwgb3IgbnVsbCBmb3Igbm8gbGltaXQNCiAgICAgICAgICAgIGR1cmF0aW9uOiAiZmFzdCIsIC8vIER1cmF0aW9uIG9mIGRpc3BsYXkvY2xvc3VyZQ0KICAgICAgICAgICAgYmVmb3JlU2hvd0RheTogbnVsbCwgLy8gRnVuY3Rpb24gdGhhdCB0YWtlcyBhIGRhdGUgYW5kIHJldHVybnMgYW4gYXJyYXkgd2l0aA0KICAgICAgICAgICAgLy8gWzBdID0gdHJ1ZSBpZiBzZWxlY3RhYmxlLCBmYWxzZSBpZiBub3QsIFsxXSA9IGN1c3RvbSBDU1MgY2xhc3MgbmFtZShzKSBvciAiIiwNCiAgICAgICAgICAgIC8vIFsyXSA9IGNlbGwgdGl0bGUgKG9wdGlvbmFsKSwgZS5nLiAkLmRhdGVwaWNrZXIubm9XZWVrZW5kcw0KICAgICAgICAgICAgYmVmb3JlU2hvdzogbnVsbCwgLy8gRnVuY3Rpb24gdGhhdCB0YWtlcyBhbiBpbnB1dCBmaWVsZCBhbmQNCiAgICAgICAgICAgIC8vIHJldHVybnMgYSBzZXQgb2YgY3VzdG9tIHNldHRpbmdzIGZvciB0aGUgZGF0ZSBwaWNrZXINCiAgICAgICAgICAgIG9uU2VsZWN0OiBudWxsLCAvLyBEZWZpbmUgYSBjYWxsYmFjayBmdW5jdGlvbiB3aGVuIGEgZGF0ZSBpcyBzZWxlY3RlZA0KICAgICAgICAgICAgb25DaGFuZ2VNb250aFllYXI6IG51bGwsIC8vIERlZmluZSBhIGNhbGxiYWNrIGZ1bmN0aW9uIHdoZW4gdGhlIG1vbnRoIG9yIHllYXIgaXMgY2hhbmdlZA0KICAgICAgICAgICAgb25DbG9zZTogbnVsbCwgLy8gRGVmaW5lIGEgY2FsbGJhY2sgZnVuY3Rpb24gd2hlbiB0aGUgZGF0ZXBpY2tlciBpcyBjbG9zZWQNCiAgICAgICAgICAgIG51bWJlck9mTW9udGhzOiAxLCAvLyBOdW1iZXIgb2YgbW9udGhzIHRvIHNob3cgYXQgYSB0aW1lDQogICAgICAgICAgICBzaG93Q3VycmVudEF0UG9zOiAwLCAvLyBUaGUgcG9zaXRpb24gaW4gbXVsdGlwZSBtb250aHMgYXQgd2hpY2ggdG8gc2hvdyB0aGUgY3VycmVudCBtb250aCAoc3RhcnRpbmcgYXQgMCkNCiAgICAgICAgICAgIHN0ZXBNb250aHM6IDEsIC8vIE51bWJlciBvZiBtb250aHMgdG8gc3RlcCBiYWNrL2ZvcndhcmQNCiAgICAgICAgICAgIHN0ZXBCaWdNb250aHM6IDEyLCAvLyBOdW1iZXIgb2YgbW9udGhzIHRvIHN0ZXAgYmFjay9mb3J3YXJkIGZvciB0aGUgYmlnIGxpbmtzDQogICAgICAgICAgICBhbHRGaWVsZDogIiIsIC8vIFNlbGVjdG9yIGZvciBhbiBhbHRlcm5hdGUgZmllbGQgdG8gc3RvcmUgc2VsZWN0ZWQgZGF0ZXMgaW50bw0KICAgICAgICAgICAgYWx0Rm9ybWF0OiAiIiwgLy8gVGhlIGRhdGUgZm9ybWF0IHRvIHVzZSBmb3IgdGhlIGFsdGVybmF0ZSBmaWVsZA0KICAgICAgICAgICAgY29uc3RyYWluSW5wdXQ6IHRydWUsIC8vIFRoZSBpbnB1dCBpcyBjb25zdHJhaW5lZCBieSB0aGUgY3VycmVudCBkYXRlIGZvcm1hdA0KICAgICAgICAgICAgc2hvd0J1dHRvblBhbmVsOiBmYWxzZSwgLy8gVHJ1ZSB0byBzaG93IGJ1dHRvbiBwYW5lbCwgZmFsc2UgdG8gbm90IHNob3cgaXQNCiAgICAgICAgICAgIGF1dG9TaXplOiBmYWxzZSwgLy8gVHJ1ZSB0byBzaXplIHRoZSBpbnB1dCBmb3IgdGhlIGRhdGUgZm9ybWF0LCBmYWxzZSB0byBsZWF2ZSBhcyBpcw0KICAgICAgICAgICAgZGlzYWJsZWQ6IGZhbHNlIC8vIFRoZSBpbml0aWFsIGRpc2FibGVkIHN0YXRlDQogICAgICAgIH07DQogICAgICAgICQuZXh0ZW5kKCB0aGlzLl9kZWZhdWx0cywgdGhpcy5yZWdpb25hbFsgIiIgXSApOw0KICAgICAgICB0aGlzLnJlZ2lvbmFsLmVuID0gJC5leHRlbmQoIHRydWUsIHt9LCB0aGlzLnJlZ2lvbmFsWyAiIiBdICk7DQogICAgICAgIHRoaXMucmVnaW9uYWxbICJlbi1VUyIgXSA9ICQuZXh0ZW5kKCB0cnVlLCB7fSwgdGhpcy5yZWdpb25hbC5lbiApOw0KICAgICAgICB0aGlzLmRwRGl2ID0gZGF0ZXBpY2tlcl9iaW5kSG92ZXIoICQoICI8ZGl2IGlkPSciICsgdGhpcy5fbWFpbkRpdklkICsgIicgY2xhc3M9J3VpLWRhdGVwaWNrZXIgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWhlbHBlci1jbGVhcmZpeCB1aS1jb3JuZXItYWxsJz48L2Rpdj4iICkgKTsNCiAgICB9DQoNCiAgICAkLmV4dGVuZCggRGF0ZXBpY2tlci5wcm90b3R5cGUsIHsNCiAgICAgICAgLyogQ2xhc3MgbmFtZSBhZGRlZCB0byBlbGVtZW50cyB0byBpbmRpY2F0ZSBhbHJlYWR5IGNvbmZpZ3VyZWQgd2l0aCBhIGRhdGUgcGlja2VyLiAqLw0KICAgICAgICBtYXJrZXJDbGFzc05hbWU6ICJoYXNEYXRlcGlja2VyIiwNCg0KICAgICAgICAvL0tlZXAgdHJhY2sgb2YgdGhlIG1heGltdW0gbnVtYmVyIG9mIHJvd3MgZGlzcGxheWVkIChzZWUgIzcwNDMpDQogICAgICAgIG1heFJvd3M6IDQsDQoNCiAgICAgICAgLy8gVE9ETyByZW5hbWUgdG8gIndpZGdldCIgd2hlbiBzd2l0Y2hpbmcgdG8gd2lkZ2V0IGZhY3RvcnkNCiAgICAgICAgX3dpZGdldERhdGVwaWNrZXI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuZHBEaXY7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogT3ZlcnJpZGUgdGhlIGRlZmF1bHQgc2V0dGluZ3MgZm9yIGFsbCBpbnN0YW5jZXMgb2YgdGhlIGRhdGUgcGlja2VyLg0KCSAqIEBwYXJhbSAgc2V0dGluZ3MgIG9iamVjdCAtIHRoZSBuZXcgc2V0dGluZ3MgdG8gdXNlIGFzIGRlZmF1bHRzIChhbm9ueW1vdXMgb2JqZWN0KQ0KCSAqIEByZXR1cm4gdGhlIG1hbmFnZXIgb2JqZWN0DQoJICovDQogICAgICAgIHNldERlZmF1bHRzOiBmdW5jdGlvbiggc2V0dGluZ3MgKSB7DQogICAgICAgICAgICBkYXRlcGlja2VyX2V4dGVuZFJlbW92ZSggdGhpcy5fZGVmYXVsdHMsIHNldHRpbmdzIHx8IHt9ICk7DQogICAgICAgICAgICByZXR1cm4gdGhpczsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBBdHRhY2ggdGhlIGRhdGUgcGlja2VyIHRvIGEgalF1ZXJ5IHNlbGVjdGlvbi4NCgkgKiBAcGFyYW0gIHRhcmdldAllbGVtZW50IC0gdGhlIHRhcmdldCBpbnB1dCBmaWVsZCBvciBkaXZpc2lvbiBvciBzcGFuDQoJICogQHBhcmFtICBzZXR0aW5ncyAgb2JqZWN0IC0gdGhlIG5ldyBzZXR0aW5ncyB0byB1c2UgZm9yIHRoaXMgZGF0ZSBwaWNrZXIgaW5zdGFuY2UgKGFub255bW91cykNCgkgKi8NCiAgICAgICAgX2F0dGFjaERhdGVwaWNrZXI6IGZ1bmN0aW9uKCB0YXJnZXQsIHNldHRpbmdzICkgew0KICAgICAgICAgICAgdmFyIG5vZGVOYW1lLCBpbmxpbmUsIGluc3Q7DQogICAgICAgICAgICBub2RlTmFtZSA9IHRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgaW5saW5lID0gKCBub2RlTmFtZSA9PT0gImRpdiIgfHwgbm9kZU5hbWUgPT09ICJzcGFuIiApOw0KICAgICAgICAgICAgaWYgKCAhdGFyZ2V0LmlkICkgew0KICAgICAgICAgICAgICAgIHRoaXMudXVpZCArPSAxOw0KICAgICAgICAgICAgICAgIHRhcmdldC5pZCA9ICJkcCIgKyB0aGlzLnV1aWQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpbnN0ID0gdGhpcy5fbmV3SW5zdCggJCggdGFyZ2V0ICksIGlubGluZSApOw0KICAgICAgICAgICAgaW5zdC5zZXR0aW5ncyA9ICQuZXh0ZW5kKCB7fSwgc2V0dGluZ3MgfHwge30gKTsNCiAgICAgICAgICAgIGlmICggbm9kZU5hbWUgPT09ICJpbnB1dCIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fY29ubmVjdERhdGVwaWNrZXIoIHRhcmdldCwgaW5zdCApOw0KICAgICAgICAgICAgfSBlbHNlIGlmICggaW5saW5lICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX2lubGluZURhdGVwaWNrZXIoIHRhcmdldCwgaW5zdCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIC8qIENyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvYmplY3QuICovDQogICAgICAgIF9uZXdJbnN0OiBmdW5jdGlvbiggdGFyZ2V0LCBpbmxpbmUgKSB7DQogICAgICAgICAgICB2YXIgaWQgPSB0YXJnZXRbIDAgXS5pZC5yZXBsYWNlKCAvKFteQS1aYS16MC05X1wtXSkvZywgIlxcXFwkMSIgKTsgLy8gZXNjYXBlIGpRdWVyeSBtZXRhIGNoYXJzDQogICAgICAgICAgICByZXR1cm4geyBpZDogaWQsIGlucHV0OiB0YXJnZXQsIC8vIGFzc29jaWF0ZWQgdGFyZ2V0DQogICAgICAgICAgICAgICAgc2VsZWN0ZWREYXk6IDAsIHNlbGVjdGVkTW9udGg6IDAsIHNlbGVjdGVkWWVhcjogMCwgLy8gY3VycmVudCBzZWxlY3Rpb24NCiAgICAgICAgICAgICAgICBkcmF3TW9udGg6IDAsIGRyYXdZZWFyOiAwLCAvLyBtb250aCBiZWluZyBkcmF3bg0KICAgICAgICAgICAgICAgIGlubGluZTogaW5saW5lLCAvLyBpcyBkYXRlcGlja2VyIGlubGluZSBvciBub3QNCiAgICAgICAgICAgICAgICBkcERpdjogKCAhaW5saW5lID8gdGhpcy5kcERpdiA6IC8vIHByZXNlbnRhdGlvbiBkaXYNCiAgICAgICAgICAgICAgICAgICAgZGF0ZXBpY2tlcl9iaW5kSG92ZXIoICQoICI8ZGl2IGNsYXNzPSciICsgdGhpcy5faW5saW5lQ2xhc3MgKyAiIHVpLWRhdGVwaWNrZXIgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWhlbHBlci1jbGVhcmZpeCB1aS1jb3JuZXItYWxsJz48L2Rpdj4iICkgKSApIH07DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogQXR0YWNoIHRoZSBkYXRlIHBpY2tlciB0byBhbiBpbnB1dCBmaWVsZC4gKi8NCiAgICAgICAgX2Nvbm5lY3REYXRlcGlja2VyOiBmdW5jdGlvbiggdGFyZ2V0LCBpbnN0ICkgew0KICAgICAgICAgICAgdmFyIGlucHV0ID0gJCggdGFyZ2V0ICk7DQogICAgICAgICAgICBpbnN0LmFwcGVuZCA9ICQoIFtdICk7DQogICAgICAgICAgICBpbnN0LnRyaWdnZXIgPSAkKCBbXSApOw0KICAgICAgICAgICAgaWYgKCBpbnB1dC5oYXNDbGFzcyggdGhpcy5tYXJrZXJDbGFzc05hbWUgKSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLl9hdHRhY2htZW50cyggaW5wdXQsIGluc3QgKTsNCiAgICAgICAgICAgIGlucHV0LmFkZENsYXNzKCB0aGlzLm1hcmtlckNsYXNzTmFtZSApLm9uKCAia2V5ZG93biIsIHRoaXMuX2RvS2V5RG93biApLg0KICAgICAgICAgICAgb24oICJrZXlwcmVzcyIsIHRoaXMuX2RvS2V5UHJlc3MgKS5vbiggImtleXVwIiwgdGhpcy5fZG9LZXlVcCApOw0KICAgICAgICAgICAgdGhpcy5fYXV0b1NpemUoIGluc3QgKTsNCiAgICAgICAgICAgICQuZGF0YSggdGFyZ2V0LCAiZGF0ZXBpY2tlciIsIGluc3QgKTsNCg0KICAgICAgICAgICAgLy9JZiBkaXNhYmxlZCBvcHRpb24gaXMgdHJ1ZSwgZGlzYWJsZSB0aGUgZGF0ZXBpY2tlciBvbmNlIGl0IGhhcyBiZWVuIGF0dGFjaGVkIHRvIHRoZSBpbnB1dCAoc2VlIHRpY2tldCAjNTY2NSkNCiAgICAgICAgICAgIGlmICggaW5zdC5zZXR0aW5ncy5kaXNhYmxlZCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9kaXNhYmxlRGF0ZXBpY2tlciggdGFyZ2V0ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogTWFrZSBhdHRhY2htZW50cyBiYXNlZCBvbiBzZXR0aW5ncy4gKi8NCiAgICAgICAgX2F0dGFjaG1lbnRzOiBmdW5jdGlvbiggaW5wdXQsIGluc3QgKSB7DQogICAgICAgICAgICB2YXIgc2hvd09uLCBidXR0b25UZXh0LCBidXR0b25JbWFnZSwNCiAgICAgICAgICAgICAgICBhcHBlbmRUZXh0ID0gdGhpcy5fZ2V0KCBpbnN0LCAiYXBwZW5kVGV4dCIgKSwNCiAgICAgICAgICAgICAgICBpc1JUTCA9IHRoaXMuX2dldCggaW5zdCwgImlzUlRMIiApOw0KDQogICAgICAgICAgICBpZiAoIGluc3QuYXBwZW5kICkgew0KICAgICAgICAgICAgICAgIGluc3QuYXBwZW5kLnJlbW92ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCBhcHBlbmRUZXh0ICkgew0KICAgICAgICAgICAgICAgIGluc3QuYXBwZW5kID0gJCggIjxzcGFuIGNsYXNzPSciICsgdGhpcy5fYXBwZW5kQ2xhc3MgKyAiJz4iICsgYXBwZW5kVGV4dCArICI8L3NwYW4+IiApOw0KICAgICAgICAgICAgICAgIGlucHV0WyBpc1JUTCA/ICJiZWZvcmUiIDogImFmdGVyIiBdKCBpbnN0LmFwcGVuZCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpbnB1dC5vZmYoICJmb2N1cyIsIHRoaXMuX3Nob3dEYXRlcGlja2VyICk7DQoNCiAgICAgICAgICAgIGlmICggaW5zdC50cmlnZ2VyICkgew0KICAgICAgICAgICAgICAgIGluc3QudHJpZ2dlci5yZW1vdmUoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgc2hvd09uID0gdGhpcy5fZ2V0KCBpbnN0LCAic2hvd09uIiApOw0KICAgICAgICAgICAgaWYgKCBzaG93T24gPT09ICJmb2N1cyIgfHwgc2hvd09uID09PSAiYm90aCIgKSB7IC8vIHBvcC11cCBkYXRlIHBpY2tlciB3aGVuIGluIHRoZSBtYXJrZWQgZmllbGQNCiAgICAgICAgICAgICAgICBpbnB1dC5vbiggImZvY3VzIiwgdGhpcy5fc2hvd0RhdGVwaWNrZXIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggc2hvd09uID09PSAiYnV0dG9uIiB8fCBzaG93T24gPT09ICJib3RoIiApIHsgLy8gcG9wLXVwIGRhdGUgcGlja2VyIHdoZW4gYnV0dG9uIGNsaWNrZWQNCiAgICAgICAgICAgICAgICBidXR0b25UZXh0ID0gdGhpcy5fZ2V0KCBpbnN0LCAiYnV0dG9uVGV4dCIgKTsNCiAgICAgICAgICAgICAgICBidXR0b25JbWFnZSA9IHRoaXMuX2dldCggaW5zdCwgImJ1dHRvbkltYWdlIiApOw0KICAgICAgICAgICAgICAgIGluc3QudHJpZ2dlciA9ICQoIHRoaXMuX2dldCggaW5zdCwgImJ1dHRvbkltYWdlT25seSIgKSA/DQogICAgICAgICAgICAgICAgICAgICQoICI8aW1nLz4iICkuYWRkQ2xhc3MoIHRoaXMuX3RyaWdnZXJDbGFzcyApLg0KICAgICAgICAgICAgICAgICAgICBhdHRyKCB7IHNyYzogYnV0dG9uSW1hZ2UsIGFsdDogYnV0dG9uVGV4dCwgdGl0bGU6IGJ1dHRvblRleHQgfSApIDoNCiAgICAgICAgICAgICAgICAgICAgJCggIjxidXR0b24gdHlwZT0nYnV0dG9uJz48L2J1dHRvbj4iICkuYWRkQ2xhc3MoIHRoaXMuX3RyaWdnZXJDbGFzcyApLg0KICAgICAgICAgICAgICAgICAgICBodG1sKCAhYnV0dG9uSW1hZ2UgPyBidXR0b25UZXh0IDogJCggIjxpbWcvPiIgKS5hdHRyKA0KICAgICAgICAgICAgICAgICAgICAgICAgeyBzcmM6YnV0dG9uSW1hZ2UsIGFsdDpidXR0b25UZXh0LCB0aXRsZTpidXR0b25UZXh0IH0gKSApICk7DQogICAgICAgICAgICAgICAgaW5wdXRbIGlzUlRMID8gImJlZm9yZSIgOiAiYWZ0ZXIiIF0oIGluc3QudHJpZ2dlciApOw0KICAgICAgICAgICAgICAgIGluc3QudHJpZ2dlci5vbiggImNsaWNrIiwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggJC5kYXRlcGlja2VyLl9kYXRlcGlja2VyU2hvd2luZyAmJiAkLmRhdGVwaWNrZXIuX2xhc3RJbnB1dCA9PT0gaW5wdXRbIDAgXSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5faGlkZURhdGVwaWNrZXIoKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggJC5kYXRlcGlja2VyLl9kYXRlcGlja2VyU2hvd2luZyAmJiAkLmRhdGVwaWNrZXIuX2xhc3RJbnB1dCAhPT0gaW5wdXRbIDAgXSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5faGlkZURhdGVwaWNrZXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fc2hvd0RhdGVwaWNrZXIoIGlucHV0WyAwIF0gKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fc2hvd0RhdGVwaWNrZXIoIGlucHV0WyAwIF0gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIC8qIEFwcGx5IHRoZSBtYXhpbXVtIGxlbmd0aCBmb3IgdGhlIGRhdGUgZm9ybWF0LiAqLw0KICAgICAgICBfYXV0b1NpemU6IGZ1bmN0aW9uKCBpbnN0ICkgew0KICAgICAgICAgICAgaWYgKCB0aGlzLl9nZXQoIGluc3QsICJhdXRvU2l6ZSIgKSAmJiAhaW5zdC5pbmxpbmUgKSB7DQogICAgICAgICAgICAgICAgdmFyIGZpbmRNYXgsIG1heCwgbWF4SSwgaSwNCiAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKCAyMDA5LCAxMiAtIDEsIDIwICksIC8vIEVuc3VyZSBkb3VibGUgZGlnaXRzDQogICAgICAgICAgICAgICAgICAgIGRhdGVGb3JtYXQgPSB0aGlzLl9nZXQoIGluc3QsICJkYXRlRm9ybWF0IiApOw0KDQogICAgICAgICAgICAgICAgaWYgKCBkYXRlRm9ybWF0Lm1hdGNoKCAvW0RNXS8gKSApIHsNCiAgICAgICAgICAgICAgICAgICAgZmluZE1heCA9IGZ1bmN0aW9uKCBuYW1lcyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1heCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBtYXhJID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgbmFtZXMubGVuZ3RoOyBpKysgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBuYW1lc1sgaSBdLmxlbmd0aCA+IG1heCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gbmFtZXNbIGkgXS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heEkgPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXhJOw0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICBkYXRlLnNldE1vbnRoKCBmaW5kTWF4KCB0aGlzLl9nZXQoIGluc3QsICggZGF0ZUZvcm1hdC5tYXRjaCggL01NLyApID8NCiAgICAgICAgICAgICAgICAgICAgICAgICJtb250aE5hbWVzIiA6ICJtb250aE5hbWVzU2hvcnQiICkgKSApICk7DQogICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0RGF0ZSggZmluZE1heCggdGhpcy5fZ2V0KCBpbnN0LCAoIGRhdGVGb3JtYXQubWF0Y2goIC9ERC8gKSA/DQogICAgICAgICAgICAgICAgICAgICAgICAiZGF5TmFtZXMiIDogImRheU5hbWVzU2hvcnQiICkgKSApICsgMjAgLSBkYXRlLmdldERheSgpICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGluc3QuaW5wdXQuYXR0ciggInNpemUiLCB0aGlzLl9mb3JtYXREYXRlKCBpbnN0LCBkYXRlICkubGVuZ3RoICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogQXR0YWNoIGFuIGlubGluZSBkYXRlIHBpY2tlciB0byBhIGRpdi4gKi8NCiAgICAgICAgX2lubGluZURhdGVwaWNrZXI6IGZ1bmN0aW9uKCB0YXJnZXQsIGluc3QgKSB7DQogICAgICAgICAgICB2YXIgZGl2U3BhbiA9ICQoIHRhcmdldCApOw0KICAgICAgICAgICAgaWYgKCBkaXZTcGFuLmhhc0NsYXNzKCB0aGlzLm1hcmtlckNsYXNzTmFtZSApICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGRpdlNwYW4uYWRkQ2xhc3MoIHRoaXMubWFya2VyQ2xhc3NOYW1lICkuYXBwZW5kKCBpbnN0LmRwRGl2ICk7DQogICAgICAgICAgICAkLmRhdGEoIHRhcmdldCwgImRhdGVwaWNrZXIiLCBpbnN0ICk7DQogICAgICAgICAgICB0aGlzLl9zZXREYXRlKCBpbnN0LCB0aGlzLl9nZXREZWZhdWx0RGF0ZSggaW5zdCApLCB0cnVlICk7DQogICAgICAgICAgICB0aGlzLl91cGRhdGVEYXRlcGlja2VyKCBpbnN0ICk7DQogICAgICAgICAgICB0aGlzLl91cGRhdGVBbHRlcm5hdGUoIGluc3QgKTsNCg0KICAgICAgICAgICAgLy9JZiBkaXNhYmxlZCBvcHRpb24gaXMgdHJ1ZSwgZGlzYWJsZSB0aGUgZGF0ZXBpY2tlciBiZWZvcmUgc2hvd2luZyBpdCAoc2VlIHRpY2tldCAjNTY2NSkNCiAgICAgICAgICAgIGlmICggaW5zdC5zZXR0aW5ncy5kaXNhYmxlZCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9kaXNhYmxlRGF0ZXBpY2tlciggdGFyZ2V0ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFNldCBkaXNwbGF5OmJsb2NrIGluIHBsYWNlIG9mIGluc3QuZHBEaXYuc2hvdygpIHdoaWNoIHdvbid0IHdvcmsgb24gZGlzY29ubmVjdGVkIGVsZW1lbnRzDQogICAgICAgICAgICAvLyBodHRwOi8vYnVncy5qcXVlcnl1aS5jb20vdGlja2V0Lzc1NTIgLSBBIERhdGVwaWNrZXIgY3JlYXRlZCBvbiBhIGRldGFjaGVkIGRpdiBoYXMgemVybyBoZWlnaHQNCiAgICAgICAgICAgIGluc3QuZHBEaXYuY3NzKCAiZGlzcGxheSIsICJibG9jayIgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBQb3AtdXAgdGhlIGRhdGUgcGlja2VyIGluIGEgImRpYWxvZyIgYm94Lg0KCSAqIEBwYXJhbSAgaW5wdXQgZWxlbWVudCAtIGlnbm9yZWQNCgkgKiBAcGFyYW0gIGRhdGUJc3RyaW5nIG9yIERhdGUgLSB0aGUgaW5pdGlhbCBkYXRlIHRvIGRpc3BsYXkNCgkgKiBAcGFyYW0gIG9uU2VsZWN0ICBmdW5jdGlvbiAtIHRoZSBmdW5jdGlvbiB0byBjYWxsIHdoZW4gYSBkYXRlIGlzIHNlbGVjdGVkDQoJICogQHBhcmFtICBzZXR0aW5ncyAgb2JqZWN0IC0gdXBkYXRlIHRoZSBkaWFsb2cgZGF0ZSBwaWNrZXIgaW5zdGFuY2UncyBzZXR0aW5ncyAoYW5vbnltb3VzIG9iamVjdCkNCgkgKiBAcGFyYW0gIHBvcyBpbnRbMl0gLSBjb29yZGluYXRlcyBmb3IgdGhlIGRpYWxvZydzIHBvc2l0aW9uIHdpdGhpbiB0aGUgc2NyZWVuIG9yDQoJICoJCQkJCWV2ZW50IC0gd2l0aCB4L3kgY29vcmRpbmF0ZXMgb3INCgkgKgkJCQkJbGVhdmUgZW1wdHkgZm9yIGRlZmF1bHQgKHNjcmVlbiBjZW50cmUpDQoJICogQHJldHVybiB0aGUgbWFuYWdlciBvYmplY3QNCgkgKi8NCiAgICAgICAgX2RpYWxvZ0RhdGVwaWNrZXI6IGZ1bmN0aW9uKCBpbnB1dCwgZGF0ZSwgb25TZWxlY3QsIHNldHRpbmdzLCBwb3MgKSB7DQogICAgICAgICAgICB2YXIgaWQsIGJyb3dzZXJXaWR0aCwgYnJvd3NlckhlaWdodCwgc2Nyb2xsWCwgc2Nyb2xsWSwNCiAgICAgICAgICAgICAgICBpbnN0ID0gdGhpcy5fZGlhbG9nSW5zdDsgLy8gaW50ZXJuYWwgaW5zdGFuY2UNCg0KICAgICAgICAgICAgaWYgKCAhaW5zdCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLnV1aWQgKz0gMTsNCiAgICAgICAgICAgICAgICBpZCA9ICJkcCIgKyB0aGlzLnV1aWQ7DQogICAgICAgICAgICAgICAgdGhpcy5fZGlhbG9nSW5wdXQgPSAkKCAiPGlucHV0IHR5cGU9J3RleHQnIGlkPSciICsgaWQgKw0KICAgICAgICAgICAgICAgICAgICAiJyBzdHlsZT0ncG9zaXRpb246IGFic29sdXRlOyB0b3A6IC0xMDBweDsgd2lkdGg6IDBweDsnLz4iICk7DQogICAgICAgICAgICAgICAgdGhpcy5fZGlhbG9nSW5wdXQub24oICJrZXlkb3duIiwgdGhpcy5fZG9LZXlEb3duICk7DQogICAgICAgICAgICAgICAgJCggImJvZHkiICkuYXBwZW5kKCB0aGlzLl9kaWFsb2dJbnB1dCApOw0KICAgICAgICAgICAgICAgIGluc3QgPSB0aGlzLl9kaWFsb2dJbnN0ID0gdGhpcy5fbmV3SW5zdCggdGhpcy5fZGlhbG9nSW5wdXQsIGZhbHNlICk7DQogICAgICAgICAgICAgICAgaW5zdC5zZXR0aW5ncyA9IHt9Ow0KICAgICAgICAgICAgICAgICQuZGF0YSggdGhpcy5fZGlhbG9nSW5wdXRbIDAgXSwgImRhdGVwaWNrZXIiLCBpbnN0ICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBkYXRlcGlja2VyX2V4dGVuZFJlbW92ZSggaW5zdC5zZXR0aW5ncywgc2V0dGluZ3MgfHwge30gKTsNCiAgICAgICAgICAgIGRhdGUgPSAoIGRhdGUgJiYgZGF0ZS5jb25zdHJ1Y3RvciA9PT0gRGF0ZSA/IHRoaXMuX2Zvcm1hdERhdGUoIGluc3QsIGRhdGUgKSA6IGRhdGUgKTsNCiAgICAgICAgICAgIHRoaXMuX2RpYWxvZ0lucHV0LnZhbCggZGF0ZSApOw0KDQogICAgICAgICAgICB0aGlzLl9wb3MgPSAoIHBvcyA/ICggcG9zLmxlbmd0aCA/IHBvcyA6IFsgcG9zLnBhZ2VYLCBwb3MucGFnZVkgXSApIDogbnVsbCApOw0KICAgICAgICAgICAgaWYgKCAhdGhpcy5fcG9zICkgew0KICAgICAgICAgICAgICAgIGJyb3dzZXJXaWR0aCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDsNCiAgICAgICAgICAgICAgICBicm93c2VySGVpZ2h0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDsNCiAgICAgICAgICAgICAgICBzY3JvbGxYID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0Ow0KICAgICAgICAgICAgICAgIHNjcm9sbFkgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOw0KICAgICAgICAgICAgICAgIHRoaXMuX3BvcyA9IC8vIHNob3VsZCB1c2UgYWN0dWFsIHdpZHRoL2hlaWdodCBiZWxvdw0KICAgICAgICAgICAgICAgICAgICBbICggYnJvd3NlcldpZHRoIC8gMiApIC0gMTAwICsgc2Nyb2xsWCwgKCBicm93c2VySGVpZ2h0IC8gMiApIC0gMTUwICsgc2Nyb2xsWSBdOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBNb3ZlIGlucHV0IG9uIHNjcmVlbiBmb3IgZm9jdXMsIGJ1dCBoaWRkZW4gYmVoaW5kIGRpYWxvZw0KICAgICAgICAgICAgdGhpcy5fZGlhbG9nSW5wdXQuY3NzKCAibGVmdCIsICggdGhpcy5fcG9zWyAwIF0gKyAyMCApICsgInB4IiApLmNzcyggInRvcCIsIHRoaXMuX3Bvc1sgMSBdICsgInB4IiApOw0KICAgICAgICAgICAgaW5zdC5zZXR0aW5ncy5vblNlbGVjdCA9IG9uU2VsZWN0Ow0KICAgICAgICAgICAgdGhpcy5faW5EaWFsb2cgPSB0cnVlOw0KICAgICAgICAgICAgdGhpcy5kcERpdi5hZGRDbGFzcyggdGhpcy5fZGlhbG9nQ2xhc3MgKTsNCiAgICAgICAgICAgIHRoaXMuX3Nob3dEYXRlcGlja2VyKCB0aGlzLl9kaWFsb2dJbnB1dFsgMCBdICk7DQogICAgICAgICAgICBpZiAoICQuYmxvY2tVSSApIHsNCiAgICAgICAgICAgICAgICAkLmJsb2NrVUkoIHRoaXMuZHBEaXYgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICQuZGF0YSggdGhpcy5fZGlhbG9nSW5wdXRbIDAgXSwgImRhdGVwaWNrZXIiLCBpbnN0ICk7DQogICAgICAgICAgICByZXR1cm4gdGhpczsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBEZXRhY2ggYSBkYXRlcGlja2VyIGZyb20gaXRzIGNvbnRyb2wuDQoJICogQHBhcmFtICB0YXJnZXQJZWxlbWVudCAtIHRoZSB0YXJnZXQgaW5wdXQgZmllbGQgb3IgZGl2aXNpb24gb3Igc3Bhbg0KCSAqLw0KICAgICAgICBfZGVzdHJveURhdGVwaWNrZXI6IGZ1bmN0aW9uKCB0YXJnZXQgKSB7DQogICAgICAgICAgICB2YXIgbm9kZU5hbWUsDQogICAgICAgICAgICAgICAgJHRhcmdldCA9ICQoIHRhcmdldCApLA0KICAgICAgICAgICAgICAgIGluc3QgPSAkLmRhdGEoIHRhcmdldCwgImRhdGVwaWNrZXIiICk7DQoNCiAgICAgICAgICAgIGlmICggISR0YXJnZXQuaGFzQ2xhc3MoIHRoaXMubWFya2VyQ2xhc3NOYW1lICkgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBub2RlTmFtZSA9IHRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgJC5yZW1vdmVEYXRhKCB0YXJnZXQsICJkYXRlcGlja2VyIiApOw0KICAgICAgICAgICAgaWYgKCBub2RlTmFtZSA9PT0gImlucHV0IiApIHsNCiAgICAgICAgICAgICAgICBpbnN0LmFwcGVuZC5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICBpbnN0LnRyaWdnZXIucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgJHRhcmdldC5yZW1vdmVDbGFzcyggdGhpcy5tYXJrZXJDbGFzc05hbWUgKS4NCiAgICAgICAgICAgICAgICBvZmYoICJmb2N1cyIsIHRoaXMuX3Nob3dEYXRlcGlja2VyICkuDQogICAgICAgICAgICAgICAgb2ZmKCAia2V5ZG93biIsIHRoaXMuX2RvS2V5RG93biApLg0KICAgICAgICAgICAgICAgIG9mZiggImtleXByZXNzIiwgdGhpcy5fZG9LZXlQcmVzcyApLg0KICAgICAgICAgICAgICAgIG9mZiggImtleXVwIiwgdGhpcy5fZG9LZXlVcCApOw0KICAgICAgICAgICAgfSBlbHNlIGlmICggbm9kZU5hbWUgPT09ICJkaXYiIHx8IG5vZGVOYW1lID09PSAic3BhbiIgKSB7DQogICAgICAgICAgICAgICAgJHRhcmdldC5yZW1vdmVDbGFzcyggdGhpcy5tYXJrZXJDbGFzc05hbWUgKS5lbXB0eSgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGRhdGVwaWNrZXJfaW5zdEFjdGl2ZSA9PT0gaW5zdCApIHsNCiAgICAgICAgICAgICAgICBkYXRlcGlja2VyX2luc3RBY3RpdmUgPSBudWxsOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIC8qIEVuYWJsZSB0aGUgZGF0ZSBwaWNrZXIgdG8gYSBqUXVlcnkgc2VsZWN0aW9uLg0KCSAqIEBwYXJhbSAgdGFyZ2V0CWVsZW1lbnQgLSB0aGUgdGFyZ2V0IGlucHV0IGZpZWxkIG9yIGRpdmlzaW9uIG9yIHNwYW4NCgkgKi8NCiAgICAgICAgX2VuYWJsZURhdGVwaWNrZXI6IGZ1bmN0aW9uKCB0YXJnZXQgKSB7DQogICAgICAgICAgICB2YXIgbm9kZU5hbWUsIGlubGluZSwNCiAgICAgICAgICAgICAgICAkdGFyZ2V0ID0gJCggdGFyZ2V0ICksDQogICAgICAgICAgICAgICAgaW5zdCA9ICQuZGF0YSggdGFyZ2V0LCAiZGF0ZXBpY2tlciIgKTsNCg0KICAgICAgICAgICAgaWYgKCAhJHRhcmdldC5oYXNDbGFzcyggdGhpcy5tYXJrZXJDbGFzc05hbWUgKSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIG5vZGVOYW1lID0gdGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICBpZiAoIG5vZGVOYW1lID09PSAiaW5wdXQiICkgew0KICAgICAgICAgICAgICAgIHRhcmdldC5kaXNhYmxlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIGluc3QudHJpZ2dlci5maWx0ZXIoICJidXR0b24iICkuDQogICAgICAgICAgICAgICAgZWFjaCggZnVuY3Rpb24oKSB7IHRoaXMuZGlzYWJsZWQgPSBmYWxzZTsgfSApLmVuZCgpLg0KICAgICAgICAgICAgICAgIGZpbHRlciggImltZyIgKS5jc3MoIHsgb3BhY2l0eTogIjEuMCIsIGN1cnNvcjogIiIgfSApOw0KICAgICAgICAgICAgfSBlbHNlIGlmICggbm9kZU5hbWUgPT09ICJkaXYiIHx8IG5vZGVOYW1lID09PSAic3BhbiIgKSB7DQogICAgICAgICAgICAgICAgaW5saW5lID0gJHRhcmdldC5jaGlsZHJlbiggIi4iICsgdGhpcy5faW5saW5lQ2xhc3MgKTsNCiAgICAgICAgICAgICAgICBpbmxpbmUuY2hpbGRyZW4oKS5yZW1vdmVDbGFzcyggInVpLXN0YXRlLWRpc2FibGVkIiApOw0KICAgICAgICAgICAgICAgIGlubGluZS5maW5kKCAic2VsZWN0LnVpLWRhdGVwaWNrZXItbW9udGgsIHNlbGVjdC51aS1kYXRlcGlja2VyLXllYXIiICkuDQogICAgICAgICAgICAgICAgcHJvcCggImRpc2FibGVkIiwgZmFsc2UgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVkSW5wdXRzID0gJC5tYXAoIHRoaXMuX2Rpc2FibGVkSW5wdXRzLA0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCB2YWx1ZSApIHsgcmV0dXJuICggdmFsdWUgPT09IHRhcmdldCA/IG51bGwgOiB2YWx1ZSApOyB9ICk7IC8vIGRlbGV0ZSBlbnRyeQ0KICAgICAgICB9LA0KDQogICAgICAgIC8qIERpc2FibGUgdGhlIGRhdGUgcGlja2VyIHRvIGEgalF1ZXJ5IHNlbGVjdGlvbi4NCgkgKiBAcGFyYW0gIHRhcmdldAllbGVtZW50IC0gdGhlIHRhcmdldCBpbnB1dCBmaWVsZCBvciBkaXZpc2lvbiBvciBzcGFuDQoJICovDQogICAgICAgIF9kaXNhYmxlRGF0ZXBpY2tlcjogZnVuY3Rpb24oIHRhcmdldCApIHsNCiAgICAgICAgICAgIHZhciBub2RlTmFtZSwgaW5saW5lLA0KICAgICAgICAgICAgICAgICR0YXJnZXQgPSAkKCB0YXJnZXQgKSwNCiAgICAgICAgICAgICAgICBpbnN0ID0gJC5kYXRhKCB0YXJnZXQsICJkYXRlcGlja2VyIiApOw0KDQogICAgICAgICAgICBpZiAoICEkdGFyZ2V0Lmhhc0NsYXNzKCB0aGlzLm1hcmtlckNsYXNzTmFtZSApICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgbm9kZU5hbWUgPSB0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgICAgIGlmICggbm9kZU5hbWUgPT09ICJpbnB1dCIgKSB7DQogICAgICAgICAgICAgICAgdGFyZ2V0LmRpc2FibGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBpbnN0LnRyaWdnZXIuZmlsdGVyKCAiYnV0dG9uIiApLg0KICAgICAgICAgICAgICAgIGVhY2goIGZ1bmN0aW9uKCkgeyB0aGlzLmRpc2FibGVkID0gdHJ1ZTsgfSApLmVuZCgpLg0KICAgICAgICAgICAgICAgIGZpbHRlciggImltZyIgKS5jc3MoIHsgb3BhY2l0eTogIjAuNSIsIGN1cnNvcjogImRlZmF1bHQiIH0gKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSAiZGl2IiB8fCBub2RlTmFtZSA9PT0gInNwYW4iICkgew0KICAgICAgICAgICAgICAgIGlubGluZSA9ICR0YXJnZXQuY2hpbGRyZW4oICIuIiArIHRoaXMuX2lubGluZUNsYXNzICk7DQogICAgICAgICAgICAgICAgaW5saW5lLmNoaWxkcmVuKCkuYWRkQ2xhc3MoICJ1aS1zdGF0ZS1kaXNhYmxlZCIgKTsNCiAgICAgICAgICAgICAgICBpbmxpbmUuZmluZCggInNlbGVjdC51aS1kYXRlcGlja2VyLW1vbnRoLCBzZWxlY3QudWktZGF0ZXBpY2tlci15ZWFyIiApLg0KICAgICAgICAgICAgICAgIHByb3AoICJkaXNhYmxlZCIsIHRydWUgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVkSW5wdXRzID0gJC5tYXAoIHRoaXMuX2Rpc2FibGVkSW5wdXRzLA0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCB2YWx1ZSApIHsgcmV0dXJuICggdmFsdWUgPT09IHRhcmdldCA/IG51bGwgOiB2YWx1ZSApOyB9ICk7IC8vIGRlbGV0ZSBlbnRyeQ0KICAgICAgICAgICAgdGhpcy5fZGlzYWJsZWRJbnB1dHNbIHRoaXMuX2Rpc2FibGVkSW5wdXRzLmxlbmd0aCBdID0gdGFyZ2V0Ow0KICAgICAgICB9LA0KDQogICAgICAgIC8qIElzIHRoZSBmaXJzdCBmaWVsZCBpbiBhIGpRdWVyeSBjb2xsZWN0aW9uIGRpc2FibGVkIGFzIGEgZGF0ZXBpY2tlcj8NCgkgKiBAcGFyYW0gIHRhcmdldAllbGVtZW50IC0gdGhlIHRhcmdldCBpbnB1dCBmaWVsZCBvciBkaXZpc2lvbiBvciBzcGFuDQoJICogQHJldHVybiBib29sZWFuIC0gdHJ1ZSBpZiBkaXNhYmxlZCwgZmFsc2UgaWYgZW5hYmxlZA0KCSAqLw0KICAgICAgICBfaXNEaXNhYmxlZERhdGVwaWNrZXI6IGZ1bmN0aW9uKCB0YXJnZXQgKSB7DQogICAgICAgICAgICBpZiAoICF0YXJnZXQgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgdGhpcy5fZGlzYWJsZWRJbnB1dHMubGVuZ3RoOyBpKysgKSB7DQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLl9kaXNhYmxlZElucHV0c1sgaSBdID09PSB0YXJnZXQgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBSZXRyaWV2ZSB0aGUgaW5zdGFuY2UgZGF0YSBmb3IgdGhlIHRhcmdldCBjb250cm9sLg0KCSAqIEBwYXJhbSAgdGFyZ2V0ICBlbGVtZW50IC0gdGhlIHRhcmdldCBpbnB1dCBmaWVsZCBvciBkaXZpc2lvbiBvciBzcGFuDQoJICogQHJldHVybiAgb2JqZWN0IC0gdGhlIGFzc29jaWF0ZWQgaW5zdGFuY2UgZGF0YQ0KCSAqIEB0aHJvd3MgIGVycm9yIGlmIGEgalF1ZXJ5IHByb2JsZW0gZ2V0dGluZyBkYXRhDQoJICovDQogICAgICAgIF9nZXRJbnN0OiBmdW5jdGlvbiggdGFyZ2V0ICkgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJC5kYXRhKCB0YXJnZXQsICJkYXRlcGlja2VyIiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY2F0Y2ggKCBlcnIgKSB7DQogICAgICAgICAgICAgICAgdGhyb3cgIk1pc3NpbmcgaW5zdGFuY2UgZGF0YSBmb3IgdGhpcyBkYXRlcGlja2VyIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBVcGRhdGUgb3IgcmV0cmlldmUgdGhlIHNldHRpbmdzIGZvciBhIGRhdGUgcGlja2VyIGF0dGFjaGVkIHRvIGFuIGlucHV0IGZpZWxkIG9yIGRpdmlzaW9uLg0KCSAqIEBwYXJhbSAgdGFyZ2V0ICBlbGVtZW50IC0gdGhlIHRhcmdldCBpbnB1dCBmaWVsZCBvciBkaXZpc2lvbiBvciBzcGFuDQoJICogQHBhcmFtICBuYW1lCW9iamVjdCAtIHRoZSBuZXcgc2V0dGluZ3MgdG8gdXBkYXRlIG9yDQoJICoJCQkJc3RyaW5nIC0gdGhlIG5hbWUgb2YgdGhlIHNldHRpbmcgdG8gY2hhbmdlIG9yIHJldHJpZXZlLA0KCSAqCQkJCXdoZW4gcmV0cmlldmluZyBhbHNvICJhbGwiIGZvciBhbGwgaW5zdGFuY2Ugc2V0dGluZ3Mgb3INCgkgKgkJCQkiZGVmYXVsdHMiIGZvciBhbGwgZ2xvYmFsIGRlZmF1bHRzDQoJICogQHBhcmFtICB2YWx1ZSAgIGFueSAtIHRoZSBuZXcgdmFsdWUgZm9yIHRoZSBzZXR0aW5nDQoJICoJCQkJKG9taXQgaWYgYWJvdmUgaXMgYW4gb2JqZWN0IG9yIHRvIHJldHJpZXZlIGEgdmFsdWUpDQoJICovDQogICAgICAgIF9vcHRpb25EYXRlcGlja2VyOiBmdW5jdGlvbiggdGFyZ2V0LCBuYW1lLCB2YWx1ZSApIHsNCiAgICAgICAgICAgIHZhciBzZXR0aW5ncywgZGF0ZSwgbWluRGF0ZSwgbWF4RGF0ZSwNCiAgICAgICAgICAgICAgICBpbnN0ID0gdGhpcy5fZ2V0SW5zdCggdGFyZ2V0ICk7DQoNCiAgICAgICAgICAgIGlmICggYXJndW1lbnRzLmxlbmd0aCA9PT0gMiAmJiB0eXBlb2YgbmFtZSA9PT0gInN0cmluZyIgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICggbmFtZSA9PT0gImRlZmF1bHRzIiA/ICQuZXh0ZW5kKCB7fSwgJC5kYXRlcGlja2VyLl9kZWZhdWx0cyApIDoNCiAgICAgICAgICAgICAgICAgICAgKCBpbnN0ID8gKCBuYW1lID09PSAiYWxsIiA/ICQuZXh0ZW5kKCB7fSwgaW5zdC5zZXR0aW5ncyApIDoNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2dldCggaW5zdCwgbmFtZSApICkgOiBudWxsICkgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgc2V0dGluZ3MgPSBuYW1lIHx8IHt9Ow0KICAgICAgICAgICAgaWYgKCB0eXBlb2YgbmFtZSA9PT0gInN0cmluZyIgKSB7DQogICAgICAgICAgICAgICAgc2V0dGluZ3MgPSB7fTsNCiAgICAgICAgICAgICAgICBzZXR0aW5nc1sgbmFtZSBdID0gdmFsdWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggaW5zdCApIHsNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuX2N1ckluc3QgPT09IGluc3QgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2hpZGVEYXRlcGlja2VyKCk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgZGF0ZSA9IHRoaXMuX2dldERhdGVEYXRlcGlja2VyKCB0YXJnZXQsIHRydWUgKTsNCiAgICAgICAgICAgICAgICBtaW5EYXRlID0gdGhpcy5fZ2V0TWluTWF4RGF0ZSggaW5zdCwgIm1pbiIgKTsNCiAgICAgICAgICAgICAgICBtYXhEYXRlID0gdGhpcy5fZ2V0TWluTWF4RGF0ZSggaW5zdCwgIm1heCIgKTsNCiAgICAgICAgICAgICAgICBkYXRlcGlja2VyX2V4dGVuZFJlbW92ZSggaW5zdC5zZXR0aW5ncywgc2V0dGluZ3MgKTsNCg0KICAgICAgICAgICAgICAgIC8vIHJlZm9ybWF0IHRoZSBvbGQgbWluRGF0ZS9tYXhEYXRlIHZhbHVlcyBpZiBkYXRlRm9ybWF0IGNoYW5nZXMgYW5kIGEgbmV3IG1pbkRhdGUvbWF4RGF0ZSBpc24ndCBwcm92aWRlZA0KICAgICAgICAgICAgICAgIGlmICggbWluRGF0ZSAhPT0gbnVsbCAmJiBzZXR0aW5ncy5kYXRlRm9ybWF0ICE9PSB1bmRlZmluZWQgJiYgc2V0dGluZ3MubWluRGF0ZSA9PT0gdW5kZWZpbmVkICkgew0KICAgICAgICAgICAgICAgICAgICBpbnN0LnNldHRpbmdzLm1pbkRhdGUgPSB0aGlzLl9mb3JtYXREYXRlKCBpbnN0LCBtaW5EYXRlICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICggbWF4RGF0ZSAhPT0gbnVsbCAmJiBzZXR0aW5ncy5kYXRlRm9ybWF0ICE9PSB1bmRlZmluZWQgJiYgc2V0dGluZ3MubWF4RGF0ZSA9PT0gdW5kZWZpbmVkICkgew0KICAgICAgICAgICAgICAgICAgICBpbnN0LnNldHRpbmdzLm1heERhdGUgPSB0aGlzLl9mb3JtYXREYXRlKCBpbnN0LCBtYXhEYXRlICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICggImRpc2FibGVkIiBpbiBzZXR0aW5ncyApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBzZXR0aW5ncy5kaXNhYmxlZCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVEYXRlcGlja2VyKCB0YXJnZXQgKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2VuYWJsZURhdGVwaWNrZXIoIHRhcmdldCApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMuX2F0dGFjaG1lbnRzKCAkKCB0YXJnZXQgKSwgaW5zdCApOw0KICAgICAgICAgICAgICAgIHRoaXMuX2F1dG9TaXplKCBpbnN0ICk7DQogICAgICAgICAgICAgICAgdGhpcy5fc2V0RGF0ZSggaW5zdCwgZGF0ZSApOw0KICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUFsdGVybmF0ZSggaW5zdCApOw0KICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZURhdGVwaWNrZXIoIGluc3QgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICAvLyBDaGFuZ2UgbWV0aG9kIGRlcHJlY2F0ZWQNCiAgICAgICAgX2NoYW5nZURhdGVwaWNrZXI6IGZ1bmN0aW9uKCB0YXJnZXQsIG5hbWUsIHZhbHVlICkgew0KICAgICAgICAgICAgdGhpcy5fb3B0aW9uRGF0ZXBpY2tlciggdGFyZ2V0LCBuYW1lLCB2YWx1ZSApOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qIFJlZHJhdyB0aGUgZGF0ZSBwaWNrZXIgYXR0YWNoZWQgdG8gYW4gaW5wdXQgZmllbGQgb3IgZGl2aXNpb24uDQoJICogQHBhcmFtICB0YXJnZXQgIGVsZW1lbnQgLSB0aGUgdGFyZ2V0IGlucHV0IGZpZWxkIG9yIGRpdmlzaW9uIG9yIHNwYW4NCgkgKi8NCiAgICAgICAgX3JlZnJlc2hEYXRlcGlja2VyOiBmdW5jdGlvbiggdGFyZ2V0ICkgew0KICAgICAgICAgICAgdmFyIGluc3QgPSB0aGlzLl9nZXRJbnN0KCB0YXJnZXQgKTsNCiAgICAgICAgICAgIGlmICggaW5zdCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVEYXRlcGlja2VyKCBpbnN0ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogU2V0IHRoZSBkYXRlcyBmb3IgYSBqUXVlcnkgc2VsZWN0aW9uLg0KCSAqIEBwYXJhbSAgdGFyZ2V0IGVsZW1lbnQgLSB0aGUgdGFyZ2V0IGlucHV0IGZpZWxkIG9yIGRpdmlzaW9uIG9yIHNwYW4NCgkgKiBAcGFyYW0gIGRhdGUJRGF0ZSAtIHRoZSBuZXcgZGF0ZQ0KCSAqLw0KICAgICAgICBfc2V0RGF0ZURhdGVwaWNrZXI6IGZ1bmN0aW9uKCB0YXJnZXQsIGRhdGUgKSB7DQogICAgICAgICAgICB2YXIgaW5zdCA9IHRoaXMuX2dldEluc3QoIHRhcmdldCApOw0KICAgICAgICAgICAgaWYgKCBpbnN0ICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3NldERhdGUoIGluc3QsIGRhdGUgKTsNCiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVEYXRlcGlja2VyKCBpbnN0ICk7DQogICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlQWx0ZXJuYXRlKCBpbnN0ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogR2V0IHRoZSBkYXRlKHMpIGZvciB0aGUgZmlyc3QgZW50cnkgaW4gYSBqUXVlcnkgc2VsZWN0aW9uLg0KCSAqIEBwYXJhbSAgdGFyZ2V0IGVsZW1lbnQgLSB0aGUgdGFyZ2V0IGlucHV0IGZpZWxkIG9yIGRpdmlzaW9uIG9yIHNwYW4NCgkgKiBAcGFyYW0gIG5vRGVmYXVsdCBib29sZWFuIC0gdHJ1ZSBpZiBubyBkZWZhdWx0IGRhdGUgaXMgdG8gYmUgdXNlZA0KCSAqIEByZXR1cm4gRGF0ZSAtIHRoZSBjdXJyZW50IGRhdGUNCgkgKi8NCiAgICAgICAgX2dldERhdGVEYXRlcGlja2VyOiBmdW5jdGlvbiggdGFyZ2V0LCBub0RlZmF1bHQgKSB7DQogICAgICAgICAgICB2YXIgaW5zdCA9IHRoaXMuX2dldEluc3QoIHRhcmdldCApOw0KICAgICAgICAgICAgaWYgKCBpbnN0ICYmICFpbnN0LmlubGluZSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9zZXREYXRlRnJvbUZpZWxkKCBpbnN0LCBub0RlZmF1bHQgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiAoIGluc3QgPyB0aGlzLl9nZXREYXRlKCBpbnN0ICkgOiBudWxsICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogSGFuZGxlIGtleXN0cm9rZXMuICovDQogICAgICAgIF9kb0tleURvd246IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciBvblNlbGVjdCwgZGF0ZVN0ciwgc2VsLA0KICAgICAgICAgICAgICAgIGluc3QgPSAkLmRhdGVwaWNrZXIuX2dldEluc3QoIGV2ZW50LnRhcmdldCApLA0KICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlLA0KICAgICAgICAgICAgICAgIGlzUlRMID0gaW5zdC5kcERpdi5pcyggIi51aS1kYXRlcGlja2VyLXJ0bCIgKTsNCg0KICAgICAgICAgICAgaW5zdC5fa2V5RXZlbnQgPSB0cnVlOw0KICAgICAgICAgICAgaWYgKCAkLmRhdGVwaWNrZXIuX2RhdGVwaWNrZXJTaG93aW5nICkgew0KICAgICAgICAgICAgICAgIHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgOTogJC5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlcigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7IC8vIGhpZGUgb24gdGFiIG91dA0KICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOiBzZWwgPSAkKCAidGQuIiArICQuZGF0ZXBpY2tlci5fZGF5T3ZlckNsYXNzICsgIjpub3QoLiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9jdXJyZW50Q2xhc3MgKyAiKSIsIGluc3QuZHBEaXYgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggc2VsWyAwIF0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9zZWxlY3REYXkoIGV2ZW50LnRhcmdldCwgaW5zdC5zZWxlY3RlZE1vbnRoLCBpbnN0LnNlbGVjdGVkWWVhciwgc2VsWyAwIF0gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgb25TZWxlY3QgPSAkLmRhdGVwaWNrZXIuX2dldCggaW5zdCwgIm9uU2VsZWN0IiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBvblNlbGVjdCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlU3RyID0gJC5kYXRlcGlja2VyLl9mb3JtYXREYXRlKCBpbnN0ICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIGN1c3RvbSBjYWxsYmFjaw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0LmFwcGx5KCAoIGluc3QuaW5wdXQgPyBpbnN0LmlucHV0WyAwIF0gOiBudWxsICksIFsgZGF0ZVN0ciwgaW5zdCBdICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5faGlkZURhdGVwaWNrZXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBkb24ndCBzdWJtaXQgdGhlIGZvcm0NCiAgICAgICAgICAgICAgICAgICAgY2FzZSAyNzogJC5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlcigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7IC8vIGhpZGUgb24gZXNjYXBlDQogICAgICAgICAgICAgICAgICAgIGNhc2UgMzM6ICQuZGF0ZXBpY2tlci5fYWRqdXN0RGF0ZSggZXZlbnQudGFyZ2V0LCAoIGV2ZW50LmN0cmxLZXkgPw0KICAgICAgICAgICAgICAgICAgICAgICAgLSQuZGF0ZXBpY2tlci5fZ2V0KCBpbnN0LCAic3RlcEJpZ01vbnRocyIgKSA6DQogICAgICAgICAgICAgICAgICAgICAgICAtJC5kYXRlcGlja2VyLl9nZXQoIGluc3QsICJzdGVwTW9udGhzIiApICksICJNIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7IC8vIHByZXZpb3VzIG1vbnRoL3llYXIgb24gcGFnZSB1cC8rIGN0cmwNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAzNDogJC5kYXRlcGlja2VyLl9hZGp1c3REYXRlKCBldmVudC50YXJnZXQsICggZXZlbnQuY3RybEtleSA/DQogICAgICAgICAgICAgICAgICAgICAgICArJC5kYXRlcGlja2VyLl9nZXQoIGluc3QsICJzdGVwQmlnTW9udGhzIiApIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICskLmRhdGVwaWNrZXIuX2dldCggaW5zdCwgInN0ZXBNb250aHMiICkgKSwgIk0iICk7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8gbmV4dCBtb250aC95ZWFyIG9uIHBhZ2UgZG93bi8rIGN0cmwNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAzNTogaWYgKCBldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkLmRhdGVwaWNrZXIuX2NsZWFyRGF0ZSggZXZlbnQudGFyZ2V0ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSBldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXk7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8gY2xlYXIgb24gY3RybCBvciBjb21tYW5kICtlbmQNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAzNjogaWYgKCBldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkLmRhdGVwaWNrZXIuX2dvdG9Ub2RheSggZXZlbnQudGFyZ2V0ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSBldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXk7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8gY3VycmVudCBvbiBjdHJsIG9yIGNvbW1hbmQgK2hvbWUNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAzNzogaWYgKCBldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkLmRhdGVwaWNrZXIuX2FkanVzdERhdGUoIGV2ZW50LnRhcmdldCwgKCBpc1JUTCA/ICsxIDogLTEgKSwgIkQiICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSBldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIC0xIGRheSBvbiBjdHJsIG9yIGNvbW1hbmQgK2xlZnQNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggZXZlbnQub3JpZ2luYWxFdmVudC5hbHRLZXkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9hZGp1c3REYXRlKCBldmVudC50YXJnZXQsICggZXZlbnQuY3RybEtleSA/DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0kLmRhdGVwaWNrZXIuX2dldCggaW5zdCwgInN0ZXBCaWdNb250aHMiICkgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtJC5kYXRlcGlja2VyLl9nZXQoIGluc3QsICJzdGVwTW9udGhzIiApICksICJNIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBuZXh0IG1vbnRoL3llYXIgb24gYWx0ICtsZWZ0IG9uIE1hYw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgMzg6IGlmICggZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9hZGp1c3REYXRlKCBldmVudC50YXJnZXQsIC03LCAiRCIgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQubWV0YUtleTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOyAvLyAtMSB3ZWVrIG9uIGN0cmwgb3IgY29tbWFuZCArdXANCiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOTogaWYgKCBldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkLmRhdGVwaWNrZXIuX2FkanVzdERhdGUoIGV2ZW50LnRhcmdldCwgKCBpc1JUTCA/IC0xIDogKzEgKSwgIkQiICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSBldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vICsxIGRheSBvbiBjdHJsIG9yIGNvbW1hbmQgK3JpZ2h0DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGV2ZW50Lm9yaWdpbmFsRXZlbnQuYWx0S2V5ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fYWRqdXN0RGF0ZSggZXZlbnQudGFyZ2V0LCAoIGV2ZW50LmN0cmxLZXkgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArJC5kYXRlcGlja2VyLl9nZXQoIGluc3QsICJzdGVwQmlnTW9udGhzIiApIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyQuZGF0ZXBpY2tlci5fZ2V0KCBpbnN0LCAic3RlcE1vbnRocyIgKSApLCAiTSIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gbmV4dCBtb250aC95ZWFyIG9uIGFsdCArcmlnaHQNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlIDQwOiBpZiAoIGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQubWV0YUtleSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fYWRqdXN0RGF0ZSggZXZlbnQudGFyZ2V0LCArNywgIkQiICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSBldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXk7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8gKzEgd2VlayBvbiBjdHJsIG9yIGNvbW1hbmQgK2Rvd24NCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogaGFuZGxlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGV2ZW50LmtleUNvZGUgPT09IDM2ICYmIGV2ZW50LmN0cmxLZXkgKSB7IC8vIGRpc3BsYXkgdGhlIGRhdGUgcGlja2VyIG9uIGN0cmwraG9tZQ0KICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fc2hvd0RhdGVwaWNrZXIoIHRoaXMgKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaGFuZGxlZCA9IGZhbHNlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGhhbmRsZWQgKSB7DQogICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBGaWx0ZXIgZW50ZXJlZCBjaGFyYWN0ZXJzIC0gYmFzZWQgb24gZGF0ZSBmb3JtYXQuICovDQogICAgICAgIF9kb0tleVByZXNzOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgY2hhcnMsIGNociwNCiAgICAgICAgICAgICAgICBpbnN0ID0gJC5kYXRlcGlja2VyLl9nZXRJbnN0KCBldmVudC50YXJnZXQgKTsNCg0KICAgICAgICAgICAgaWYgKCAkLmRhdGVwaWNrZXIuX2dldCggaW5zdCwgImNvbnN0cmFpbklucHV0IiApICkgew0KICAgICAgICAgICAgICAgIGNoYXJzID0gJC5kYXRlcGlja2VyLl9wb3NzaWJsZUNoYXJzKCAkLmRhdGVwaWNrZXIuX2dldCggaW5zdCwgImRhdGVGb3JtYXQiICkgKTsNCiAgICAgICAgICAgICAgICBjaHIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCBldmVudC5jaGFyQ29kZSA9PSBudWxsID8gZXZlbnQua2V5Q29kZSA6IGV2ZW50LmNoYXJDb2RlICk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQubWV0YUtleSB8fCAoIGNociA8ICIgIiB8fCAhY2hhcnMgfHwgY2hhcnMuaW5kZXhPZiggY2hyICkgPiAtMSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIC8qIFN5bmNocm9uaXNlIG1hbnVhbCBlbnRyeSBhbmQgZmllbGQvYWx0ZXJuYXRlIGZpZWxkLiAqLw0KICAgICAgICBfZG9LZXlVcDogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgdmFyIGRhdGUsDQogICAgICAgICAgICAgICAgaW5zdCA9ICQuZGF0ZXBpY2tlci5fZ2V0SW5zdCggZXZlbnQudGFyZ2V0ICk7DQoNCiAgICAgICAgICAgIGlmICggaW5zdC5pbnB1dC52YWwoKSAhPT0gaW5zdC5sYXN0VmFsICkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIGRhdGUgPSAkLmRhdGVwaWNrZXIucGFyc2VEYXRlKCAkLmRhdGVwaWNrZXIuX2dldCggaW5zdCwgImRhdGVGb3JtYXQiICksDQogICAgICAgICAgICAgICAgICAgICAgICAoIGluc3QuaW5wdXQgPyBpbnN0LmlucHV0LnZhbCgpIDogbnVsbCApLA0KICAgICAgICAgICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9nZXRGb3JtYXRDb25maWcoIGluc3QgKSApOw0KDQogICAgICAgICAgICAgICAgICAgIGlmICggZGF0ZSApIHsgLy8gb25seSBpZiB2YWxpZA0KICAgICAgICAgICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9zZXREYXRlRnJvbUZpZWxkKCBpbnN0ICk7DQogICAgICAgICAgICAgICAgICAgICAgICAkLmRhdGVwaWNrZXIuX3VwZGF0ZUFsdGVybmF0ZSggaW5zdCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl91cGRhdGVEYXRlcGlja2VyKCBpbnN0ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY2F0Y2ggKCBlcnIgKSB7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogUG9wLXVwIHRoZSBkYXRlIHBpY2tlciBmb3IgYSBnaXZlbiBpbnB1dCBmaWVsZC4NCgkgKiBJZiBmYWxzZSByZXR1cm5lZCBmcm9tIGJlZm9yZVNob3cgZXZlbnQgaGFuZGxlciBkbyBub3Qgc2hvdy4NCgkgKiBAcGFyYW0gIGlucHV0ICBlbGVtZW50IC0gdGhlIGlucHV0IGZpZWxkIGF0dGFjaGVkIHRvIHRoZSBkYXRlIHBpY2tlciBvcg0KCSAqCQkJCQlldmVudCAtIGlmIHRyaWdnZXJlZCBieSBmb2N1cw0KCSAqLw0KICAgICAgICBfc2hvd0RhdGVwaWNrZXI6IGZ1bmN0aW9uKCBpbnB1dCApIHsNCiAgICAgICAgICAgIGlucHV0ID0gaW5wdXQudGFyZ2V0IHx8IGlucHV0Ow0KICAgICAgICAgICAgaWYgKCBpbnB1dC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSAiaW5wdXQiICkgeyAvLyBmaW5kIGZyb20gYnV0dG9uL2ltYWdlIHRyaWdnZXINCiAgICAgICAgICAgICAgICBpbnB1dCA9ICQoICJpbnB1dCIsIGlucHV0LnBhcmVudE5vZGUgKVsgMCBdOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoICQuZGF0ZXBpY2tlci5faXNEaXNhYmxlZERhdGVwaWNrZXIoIGlucHV0ICkgfHwgJC5kYXRlcGlja2VyLl9sYXN0SW5wdXQgPT09IGlucHV0ICkgeyAvLyBhbHJlYWR5IGhlcmUNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciBpbnN0LCBiZWZvcmVTaG93LCBiZWZvcmVTaG93U2V0dGluZ3MsIGlzRml4ZWQsDQogICAgICAgICAgICAgICAgb2Zmc2V0LCBzaG93QW5pbSwgZHVyYXRpb247DQoNCiAgICAgICAgICAgIGluc3QgPSAkLmRhdGVwaWNrZXIuX2dldEluc3QoIGlucHV0ICk7DQogICAgICAgICAgICBpZiAoICQuZGF0ZXBpY2tlci5fY3VySW5zdCAmJiAkLmRhdGVwaWNrZXIuX2N1ckluc3QgIT09IGluc3QgKSB7DQogICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9jdXJJbnN0LmRwRGl2LnN0b3AoIHRydWUsIHRydWUgKTsNCiAgICAgICAgICAgICAgICBpZiAoIGluc3QgJiYgJC5kYXRlcGlja2VyLl9kYXRlcGlja2VyU2hvd2luZyApIHsNCiAgICAgICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlciggJC5kYXRlcGlja2VyLl9jdXJJbnN0LmlucHV0WyAwIF0gKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGJlZm9yZVNob3cgPSAkLmRhdGVwaWNrZXIuX2dldCggaW5zdCwgImJlZm9yZVNob3ciICk7DQogICAgICAgICAgICBiZWZvcmVTaG93U2V0dGluZ3MgPSBiZWZvcmVTaG93ID8gYmVmb3JlU2hvdy5hcHBseSggaW5wdXQsIFsgaW5wdXQsIGluc3QgXSApIDoge307DQogICAgICAgICAgICBpZiAoIGJlZm9yZVNob3dTZXR0aW5ncyA9PT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZGF0ZXBpY2tlcl9leHRlbmRSZW1vdmUoIGluc3Quc2V0dGluZ3MsIGJlZm9yZVNob3dTZXR0aW5ncyApOw0KDQogICAgICAgICAgICBpbnN0Lmxhc3RWYWwgPSBudWxsOw0KICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9sYXN0SW5wdXQgPSBpbnB1dDsNCiAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fc2V0RGF0ZUZyb21GaWVsZCggaW5zdCApOw0KDQogICAgICAgICAgICBpZiAoICQuZGF0ZXBpY2tlci5faW5EaWFsb2cgKSB7IC8vIGhpZGUgY3Vyc29yDQogICAgICAgICAgICAgICAgaW5wdXQudmFsdWUgPSAiIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggISQuZGF0ZXBpY2tlci5fcG9zICkgeyAvLyBwb3NpdGlvbiBiZWxvdyBpbnB1dA0KICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fcG9zID0gJC5kYXRlcGlja2VyLl9maW5kUG9zKCBpbnB1dCApOw0KICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fcG9zWyAxIF0gKz0gaW5wdXQub2Zmc2V0SGVpZ2h0OyAvLyBhZGQgdGhlIGhlaWdodA0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpc0ZpeGVkID0gZmFsc2U7DQogICAgICAgICAgICAkKCBpbnB1dCApLnBhcmVudHMoKS5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBpc0ZpeGVkIHw9ICQoIHRoaXMgKS5jc3MoICJwb3NpdGlvbiIgKSA9PT0gImZpeGVkIjsNCiAgICAgICAgICAgICAgICByZXR1cm4gIWlzRml4ZWQ7DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIG9mZnNldCA9IHsgbGVmdDogJC5kYXRlcGlja2VyLl9wb3NbIDAgXSwgdG9wOiAkLmRhdGVwaWNrZXIuX3Bvc1sgMSBdIH07DQogICAgICAgICAgICAkLmRhdGVwaWNrZXIuX3BvcyA9IG51bGw7DQoNCiAgICAgICAgICAgIC8vdG8gYXZvaWQgZmxhc2hlcyBvbiBGaXJlZm94DQogICAgICAgICAgICBpbnN0LmRwRGl2LmVtcHR5KCk7DQoNCiAgICAgICAgICAgIC8vIGRldGVybWluZSBzaXppbmcgb2Zmc2NyZWVuDQogICAgICAgICAgICBpbnN0LmRwRGl2LmNzcyggeyBwb3NpdGlvbjogImFic29sdXRlIiwgZGlzcGxheTogImJsb2NrIiwgdG9wOiAiLTEwMDBweCIgfSApOw0KICAgICAgICAgICAgJC5kYXRlcGlja2VyLl91cGRhdGVEYXRlcGlja2VyKCBpbnN0ICk7DQoNCiAgICAgICAgICAgIC8vIGZpeCB3aWR0aCBmb3IgZHluYW1pYyBudW1iZXIgb2YgZGF0ZSBwaWNrZXJzDQogICAgICAgICAgICAvLyBhbmQgYWRqdXN0IHBvc2l0aW9uIGJlZm9yZSBzaG93aW5nDQogICAgICAgICAgICBvZmZzZXQgPSAkLmRhdGVwaWNrZXIuX2NoZWNrT2Zmc2V0KCBpbnN0LCBvZmZzZXQsIGlzRml4ZWQgKTsNCiAgICAgICAgICAgIGluc3QuZHBEaXYuY3NzKCB7IHBvc2l0aW9uOiAoICQuZGF0ZXBpY2tlci5faW5EaWFsb2cgJiYgJC5ibG9ja1VJID8NCiAgICAgICAgICAgICAgICAgICAgInN0YXRpYyIgOiAoIGlzRml4ZWQgPyAiZml4ZWQiIDogImFic29sdXRlIiApICksIGRpc3BsYXk6ICJub25lIiwNCiAgICAgICAgICAgICAgICBsZWZ0OiBvZmZzZXQubGVmdCArICJweCIsIHRvcDogb2Zmc2V0LnRvcCArICJweCIgfSApOw0KDQogICAgICAgICAgICBpZiAoICFpbnN0LmlubGluZSApIHsNCiAgICAgICAgICAgICAgICBzaG93QW5pbSA9ICQuZGF0ZXBpY2tlci5fZ2V0KCBpbnN0LCAic2hvd0FuaW0iICk7DQogICAgICAgICAgICAgICAgZHVyYXRpb24gPSAkLmRhdGVwaWNrZXIuX2dldCggaW5zdCwgImR1cmF0aW9uIiApOw0KICAgICAgICAgICAgICAgIGluc3QuZHBEaXYuY3NzKCAiei1pbmRleCIsIGRhdGVwaWNrZXJfZ2V0WmluZGV4KCAkKCBpbnB1dCApICkgKyAxICk7DQogICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9kYXRlcGlja2VyU2hvd2luZyA9IHRydWU7DQoNCiAgICAgICAgICAgICAgICBpZiAoICQuZWZmZWN0cyAmJiAkLmVmZmVjdHMuZWZmZWN0WyBzaG93QW5pbSBdICkgew0KICAgICAgICAgICAgICAgICAgICBpbnN0LmRwRGl2LnNob3coIHNob3dBbmltLCAkLmRhdGVwaWNrZXIuX2dldCggaW5zdCwgInNob3dPcHRpb25zIiApLCBkdXJhdGlvbiApOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGluc3QuZHBEaXZbIHNob3dBbmltIHx8ICJzaG93IiBdKCBzaG93QW5pbSA/IGR1cmF0aW9uIDogbnVsbCApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggJC5kYXRlcGlja2VyLl9zaG91bGRGb2N1c0lucHV0KCBpbnN0ICkgKSB7DQogICAgICAgICAgICAgICAgICAgIGluc3QuaW5wdXQudHJpZ2dlciggImZvY3VzIiApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fY3VySW5zdCA9IGluc3Q7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogR2VuZXJhdGUgdGhlIGRhdGUgcGlja2VyIGNvbnRlbnQuICovDQogICAgICAgIF91cGRhdGVEYXRlcGlja2VyOiBmdW5jdGlvbiggaW5zdCApIHsNCiAgICAgICAgICAgIHRoaXMubWF4Um93cyA9IDQ7IC8vUmVzZXQgdGhlIG1heCBudW1iZXIgb2Ygcm93cyBiZWluZyBkaXNwbGF5ZWQgKHNlZSAjNzA0MykNCiAgICAgICAgICAgIGRhdGVwaWNrZXJfaW5zdEFjdGl2ZSA9IGluc3Q7IC8vIGZvciBkZWxlZ2F0ZSBob3ZlciBldmVudHMNCiAgICAgICAgICAgIGluc3QuZHBEaXYuZW1wdHkoKS5hcHBlbmQoIHRoaXMuX2dlbmVyYXRlSFRNTCggaW5zdCApICk7DQogICAgICAgICAgICB0aGlzLl9hdHRhY2hIYW5kbGVycyggaW5zdCApOw0KDQogICAgICAgICAgICB2YXIgb3JpZ3llYXJzaHRtbCwNCiAgICAgICAgICAgICAgICBudW1Nb250aHMgPSB0aGlzLl9nZXROdW1iZXJPZk1vbnRocyggaW5zdCApLA0KICAgICAgICAgICAgICAgIGNvbHMgPSBudW1Nb250aHNbIDEgXSwNCiAgICAgICAgICAgICAgICB3aWR0aCA9IDE3LA0KICAgICAgICAgICAgICAgIGFjdGl2ZUNlbGwgPSBpbnN0LmRwRGl2LmZpbmQoICIuIiArIHRoaXMuX2RheU92ZXJDbGFzcyArICIgYSIgKTsNCg0KICAgICAgICAgICAgaWYgKCBhY3RpdmVDZWxsLmxlbmd0aCA+IDAgKSB7DQogICAgICAgICAgICAgICAgZGF0ZXBpY2tlcl9oYW5kbGVNb3VzZW92ZXIuYXBwbHkoIGFjdGl2ZUNlbGwuZ2V0KCAwICkgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaW5zdC5kcERpdi5yZW1vdmVDbGFzcyggInVpLWRhdGVwaWNrZXItbXVsdGktMiB1aS1kYXRlcGlja2VyLW11bHRpLTMgdWktZGF0ZXBpY2tlci1tdWx0aS00IiApLndpZHRoKCAiIiApOw0KICAgICAgICAgICAgaWYgKCBjb2xzID4gMSApIHsNCiAgICAgICAgICAgICAgICBpbnN0LmRwRGl2LmFkZENsYXNzKCAidWktZGF0ZXBpY2tlci1tdWx0aS0iICsgY29scyApLmNzcyggIndpZHRoIiwgKCB3aWR0aCAqIGNvbHMgKSArICJlbSIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGluc3QuZHBEaXZbICggbnVtTW9udGhzWyAwIF0gIT09IDEgfHwgbnVtTW9udGhzWyAxIF0gIT09IDEgPyAiYWRkIiA6ICJyZW1vdmUiICkgKw0KICAgICAgICAgICAgIkNsYXNzIiBdKCAidWktZGF0ZXBpY2tlci1tdWx0aSIgKTsNCiAgICAgICAgICAgIGluc3QuZHBEaXZbICggdGhpcy5fZ2V0KCBpbnN0LCAiaXNSVEwiICkgPyAiYWRkIiA6ICJyZW1vdmUiICkgKw0KICAgICAgICAgICAgIkNsYXNzIiBdKCAidWktZGF0ZXBpY2tlci1ydGwiICk7DQoNCiAgICAgICAgICAgIGlmICggaW5zdCA9PT0gJC5kYXRlcGlja2VyLl9jdXJJbnN0ICYmICQuZGF0ZXBpY2tlci5fZGF0ZXBpY2tlclNob3dpbmcgJiYgJC5kYXRlcGlja2VyLl9zaG91bGRGb2N1c0lucHV0KCBpbnN0ICkgKSB7DQogICAgICAgICAgICAgICAgaW5zdC5pbnB1dC50cmlnZ2VyKCAiZm9jdXMiICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIERlZmZlcmVkIHJlbmRlciBvZiB0aGUgeWVhcnMgc2VsZWN0ICh0byBhdm9pZCBmbGFzaGVzIG9uIEZpcmVmb3gpDQogICAgICAgICAgICBpZiAoIGluc3QueWVhcnNodG1sICkgew0KICAgICAgICAgICAgICAgIG9yaWd5ZWFyc2h0bWwgPSBpbnN0LnllYXJzaHRtbDsNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgICAgICAgICAvL2Fzc3VyZSB0aGF0IGluc3QueWVhcnNodG1sIGRpZG4ndCBjaGFuZ2UuDQogICAgICAgICAgICAgICAgICAgIGlmICggb3JpZ3llYXJzaHRtbCA9PT0gaW5zdC55ZWFyc2h0bWwgJiYgaW5zdC55ZWFyc2h0bWwgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnN0LmRwRGl2LmZpbmQoICJzZWxlY3QudWktZGF0ZXBpY2tlci15ZWFyOmZpcnN0IiApLnJlcGxhY2VXaXRoKCBpbnN0LnllYXJzaHRtbCApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIG9yaWd5ZWFyc2h0bWwgPSBpbnN0LnllYXJzaHRtbCA9IG51bGw7DQogICAgICAgICAgICAgICAgfSwgMCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIC8vICM2Njk0IC0gZG9uJ3QgZm9jdXMgdGhlIGlucHV0IGlmIGl0J3MgYWxyZWFkeSBmb2N1c2VkDQogICAgICAgIC8vIHRoaXMgYnJlYWtzIHRoZSBjaGFuZ2UgZXZlbnQgaW4gSUUNCiAgICAgICAgLy8gU3VwcG9ydDogSUUgYW5kIGpRdWVyeSA8MS45DQogICAgICAgIF9zaG91bGRGb2N1c0lucHV0OiBmdW5jdGlvbiggaW5zdCApIHsNCiAgICAgICAgICAgIHJldHVybiBpbnN0LmlucHV0ICYmIGluc3QuaW5wdXQuaXMoICI6dmlzaWJsZSIgKSAmJiAhaW5zdC5pbnB1dC5pcyggIjpkaXNhYmxlZCIgKSAmJiAhaW5zdC5pbnB1dC5pcyggIjpmb2N1cyIgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBDaGVjayBwb3NpdGlvbmluZyB0byByZW1haW4gb24gc2NyZWVuLiAqLw0KICAgICAgICBfY2hlY2tPZmZzZXQ6IGZ1bmN0aW9uKCBpbnN0LCBvZmZzZXQsIGlzRml4ZWQgKSB7DQogICAgICAgICAgICB2YXIgZHBXaWR0aCA9IGluc3QuZHBEaXYub3V0ZXJXaWR0aCgpLA0KICAgICAgICAgICAgICAgIGRwSGVpZ2h0ID0gaW5zdC5kcERpdi5vdXRlckhlaWdodCgpLA0KICAgICAgICAgICAgICAgIGlucHV0V2lkdGggPSBpbnN0LmlucHV0ID8gaW5zdC5pbnB1dC5vdXRlcldpZHRoKCkgOiAwLA0KICAgICAgICAgICAgICAgIGlucHV0SGVpZ2h0ID0gaW5zdC5pbnB1dCA/IGluc3QuaW5wdXQub3V0ZXJIZWlnaHQoKSA6IDAsDQogICAgICAgICAgICAgICAgdmlld1dpZHRoID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoICsgKCBpc0ZpeGVkID8gMCA6ICQoIGRvY3VtZW50ICkuc2Nyb2xsTGVmdCgpICksDQogICAgICAgICAgICAgICAgdmlld0hlaWdodCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgKyAoIGlzRml4ZWQgPyAwIDogJCggZG9jdW1lbnQgKS5zY3JvbGxUb3AoKSApOw0KDQogICAgICAgICAgICBvZmZzZXQubGVmdCAtPSAoIHRoaXMuX2dldCggaW5zdCwgImlzUlRMIiApID8gKCBkcFdpZHRoIC0gaW5wdXRXaWR0aCApIDogMCApOw0KICAgICAgICAgICAgb2Zmc2V0LmxlZnQgLT0gKCBpc0ZpeGVkICYmIG9mZnNldC5sZWZ0ID09PSBpbnN0LmlucHV0Lm9mZnNldCgpLmxlZnQgKSA/ICQoIGRvY3VtZW50ICkuc2Nyb2xsTGVmdCgpIDogMDsNCiAgICAgICAgICAgIG9mZnNldC50b3AgLT0gKCBpc0ZpeGVkICYmIG9mZnNldC50b3AgPT09ICggaW5zdC5pbnB1dC5vZmZzZXQoKS50b3AgKyBpbnB1dEhlaWdodCApICkgPyAkKCBkb2N1bWVudCApLnNjcm9sbFRvcCgpIDogMDsNCg0KICAgICAgICAgICAgLy8gTm93IGNoZWNrIGlmIGRhdGVwaWNrZXIgaXMgc2hvd2luZyBvdXRzaWRlIHdpbmRvdyB2aWV3cG9ydCAtIG1vdmUgdG8gYSBiZXR0ZXIgcGxhY2UgaWYgc28uDQogICAgICAgICAgICBvZmZzZXQubGVmdCAtPSBNYXRoLm1pbiggb2Zmc2V0LmxlZnQsICggb2Zmc2V0LmxlZnQgKyBkcFdpZHRoID4gdmlld1dpZHRoICYmIHZpZXdXaWR0aCA+IGRwV2lkdGggKSA/DQogICAgICAgICAgICAgICAgTWF0aC5hYnMoIG9mZnNldC5sZWZ0ICsgZHBXaWR0aCAtIHZpZXdXaWR0aCApIDogMCApOw0KICAgICAgICAgICAgb2Zmc2V0LnRvcCAtPSBNYXRoLm1pbiggb2Zmc2V0LnRvcCwgKCBvZmZzZXQudG9wICsgZHBIZWlnaHQgPiB2aWV3SGVpZ2h0ICYmIHZpZXdIZWlnaHQgPiBkcEhlaWdodCApID8NCiAgICAgICAgICAgICAgICBNYXRoLmFicyggZHBIZWlnaHQgKyBpbnB1dEhlaWdodCApIDogMCApOw0KDQogICAgICAgICAgICByZXR1cm4gb2Zmc2V0Ow0KICAgICAgICB9LA0KDQogICAgICAgIC8qIEZpbmQgYW4gb2JqZWN0J3MgcG9zaXRpb24gb24gdGhlIHNjcmVlbi4gKi8NCiAgICAgICAgX2ZpbmRQb3M6IGZ1bmN0aW9uKCBvYmogKSB7DQogICAgICAgICAgICB2YXIgcG9zaXRpb24sDQogICAgICAgICAgICAgICAgaW5zdCA9IHRoaXMuX2dldEluc3QoIG9iaiApLA0KICAgICAgICAgICAgICAgIGlzUlRMID0gdGhpcy5fZ2V0KCBpbnN0LCAiaXNSVEwiICk7DQoNCiAgICAgICAgICAgIHdoaWxlICggb2JqICYmICggb2JqLnR5cGUgPT09ICJoaWRkZW4iIHx8IG9iai5ub2RlVHlwZSAhPT0gMSB8fCAkLmV4cHIuZmlsdGVycy5oaWRkZW4oIG9iaiApICkgKSB7DQogICAgICAgICAgICAgICAgb2JqID0gb2JqWyBpc1JUTCA/ICJwcmV2aW91c1NpYmxpbmciIDogIm5leHRTaWJsaW5nIiBdOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBwb3NpdGlvbiA9ICQoIG9iaiApLm9mZnNldCgpOw0KICAgICAgICAgICAgcmV0dXJuIFsgcG9zaXRpb24ubGVmdCwgcG9zaXRpb24udG9wIF07DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogSGlkZSB0aGUgZGF0ZSBwaWNrZXIgZnJvbSB2aWV3Lg0KCSAqIEBwYXJhbSAgaW5wdXQgIGVsZW1lbnQgLSB0aGUgaW5wdXQgZmllbGQgYXR0YWNoZWQgdG8gdGhlIGRhdGUgcGlja2VyDQoJICovDQogICAgICAgIF9oaWRlRGF0ZXBpY2tlcjogZnVuY3Rpb24oIGlucHV0ICkgew0KICAgICAgICAgICAgdmFyIHNob3dBbmltLCBkdXJhdGlvbiwgcG9zdFByb2Nlc3MsIG9uQ2xvc2UsDQogICAgICAgICAgICAgICAgaW5zdCA9IHRoaXMuX2N1ckluc3Q7DQoNCiAgICAgICAgICAgIGlmICggIWluc3QgfHwgKCBpbnB1dCAmJiBpbnN0ICE9PSAkLmRhdGEoIGlucHV0LCAiZGF0ZXBpY2tlciIgKSApICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCB0aGlzLl9kYXRlcGlja2VyU2hvd2luZyApIHsNCiAgICAgICAgICAgICAgICBzaG93QW5pbSA9IHRoaXMuX2dldCggaW5zdCwgInNob3dBbmltIiApOw0KICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gdGhpcy5fZ2V0KCBpbnN0LCAiZHVyYXRpb24iICk7DQogICAgICAgICAgICAgICAgcG9zdFByb2Nlc3MgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl90aWR5RGlhbG9nKCBpbnN0ICk7DQogICAgICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgICAgIC8vIERFUFJFQ0FURUQ6IGFmdGVyIEJDIGZvciAxLjgueCAkLmVmZmVjdHNbIHNob3dBbmltIF0gaXMgbm90IG5lZWRlZA0KICAgICAgICAgICAgICAgIGlmICggJC5lZmZlY3RzICYmICggJC5lZmZlY3RzLmVmZmVjdFsgc2hvd0FuaW0gXSB8fCAkLmVmZmVjdHNbIHNob3dBbmltIF0gKSApIHsNCiAgICAgICAgICAgICAgICAgICAgaW5zdC5kcERpdi5oaWRlKCBzaG93QW5pbSwgJC5kYXRlcGlja2VyLl9nZXQoIGluc3QsICJzaG93T3B0aW9ucyIgKSwgZHVyYXRpb24sIHBvc3RQcm9jZXNzICk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgaW5zdC5kcERpdlsgKCBzaG93QW5pbSA9PT0gInNsaWRlRG93biIgPyAic2xpZGVVcCIgOg0KICAgICAgICAgICAgICAgICAgICAgICAgKCBzaG93QW5pbSA9PT0gImZhZGVJbiIgPyAiZmFkZU91dCIgOiAiaGlkZSIgKSApIF0oICggc2hvd0FuaW0gPyBkdXJhdGlvbiA6IG51bGwgKSwgcG9zdFByb2Nlc3MgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoICFzaG93QW5pbSApIHsNCiAgICAgICAgICAgICAgICAgICAgcG9zdFByb2Nlc3MoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5fZGF0ZXBpY2tlclNob3dpbmcgPSBmYWxzZTsNCg0KICAgICAgICAgICAgICAgIG9uQ2xvc2UgPSB0aGlzLl9nZXQoIGluc3QsICJvbkNsb3NlIiApOw0KICAgICAgICAgICAgICAgIGlmICggb25DbG9zZSApIHsNCiAgICAgICAgICAgICAgICAgICAgb25DbG9zZS5hcHBseSggKCBpbnN0LmlucHV0ID8gaW5zdC5pbnB1dFsgMCBdIDogbnVsbCApLCBbICggaW5zdC5pbnB1dCA/IGluc3QuaW5wdXQudmFsKCkgOiAiIiApLCBpbnN0IF0gKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0SW5wdXQgPSBudWxsOw0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5faW5EaWFsb2cgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2RpYWxvZ0lucHV0LmNzcyggeyBwb3NpdGlvbjogImFic29sdXRlIiwgbGVmdDogIjAiLCB0b3A6ICItMTAwcHgiIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAkLmJsb2NrVUkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkLnVuYmxvY2tVSSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgJCggImJvZHkiICkuYXBwZW5kKCB0aGlzLmRwRGl2ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5faW5EaWFsb2cgPSBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBUaWR5IHVwIGFmdGVyIGEgZGlhbG9nIGRpc3BsYXkuICovDQogICAgICAgIF90aWR5RGlhbG9nOiBmdW5jdGlvbiggaW5zdCApIHsNCiAgICAgICAgICAgIGluc3QuZHBEaXYucmVtb3ZlQ2xhc3MoIHRoaXMuX2RpYWxvZ0NsYXNzICkub2ZmKCAiLnVpLWRhdGVwaWNrZXItY2FsZW5kYXIiICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogQ2xvc2UgZGF0ZSBwaWNrZXIgaWYgY2xpY2tlZCBlbHNld2hlcmUuICovDQogICAgICAgIF9jaGVja0V4dGVybmFsQ2xpY2s6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIGlmICggISQuZGF0ZXBpY2tlci5fY3VySW5zdCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciAkdGFyZ2V0ID0gJCggZXZlbnQudGFyZ2V0ICksDQogICAgICAgICAgICAgICAgaW5zdCA9ICQuZGF0ZXBpY2tlci5fZ2V0SW5zdCggJHRhcmdldFsgMCBdICk7DQoNCiAgICAgICAgICAgIGlmICggKCAoICR0YXJnZXRbIDAgXS5pZCAhPT0gJC5kYXRlcGlja2VyLl9tYWluRGl2SWQgJiYNCiAgICAgICAgICAgICAgICAkdGFyZ2V0LnBhcmVudHMoICIjIiArICQuZGF0ZXBpY2tlci5fbWFpbkRpdklkICkubGVuZ3RoID09PSAwICYmDQogICAgICAgICAgICAgICAgISR0YXJnZXQuaGFzQ2xhc3MoICQuZGF0ZXBpY2tlci5tYXJrZXJDbGFzc05hbWUgKSAmJg0KICAgICAgICAgICAgICAgICEkdGFyZ2V0LmNsb3Nlc3QoICIuIiArICQuZGF0ZXBpY2tlci5fdHJpZ2dlckNsYXNzICkubGVuZ3RoICYmDQogICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9kYXRlcGlja2VyU2hvd2luZyAmJiAhKCAkLmRhdGVwaWNrZXIuX2luRGlhbG9nICYmICQuYmxvY2tVSSApICkgKSB8fA0KICAgICAgICAgICAgICAgICggJHRhcmdldC5oYXNDbGFzcyggJC5kYXRlcGlja2VyLm1hcmtlckNsYXNzTmFtZSApICYmICQuZGF0ZXBpY2tlci5fY3VySW5zdCAhPT0gaW5zdCApICkgew0KICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5faGlkZURhdGVwaWNrZXIoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBBZGp1c3Qgb25lIG9mIHRoZSBkYXRlIHN1Yi1maWVsZHMuICovDQogICAgICAgIF9hZGp1c3REYXRlOiBmdW5jdGlvbiggaWQsIG9mZnNldCwgcGVyaW9kICkgew0KICAgICAgICAgICAgdmFyIHRhcmdldCA9ICQoIGlkICksDQogICAgICAgICAgICAgICAgaW5zdCA9IHRoaXMuX2dldEluc3QoIHRhcmdldFsgMCBdICk7DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5faXNEaXNhYmxlZERhdGVwaWNrZXIoIHRhcmdldFsgMCBdICkgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5fYWRqdXN0SW5zdERhdGUoIGluc3QsIG9mZnNldCArDQogICAgICAgICAgICAgICAgKCBwZXJpb2QgPT09ICJNIiA/IHRoaXMuX2dldCggaW5zdCwgInNob3dDdXJyZW50QXRQb3MiICkgOiAwICksIC8vIHVuZG8gcG9zaXRpb25pbmcNCiAgICAgICAgICAgICAgICBwZXJpb2QgKTsNCiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZURhdGVwaWNrZXIoIGluc3QgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBBY3Rpb24gZm9yIGN1cnJlbnQgbGluay4gKi8NCiAgICAgICAgX2dvdG9Ub2RheTogZnVuY3Rpb24oIGlkICkgew0KICAgICAgICAgICAgdmFyIGRhdGUsDQogICAgICAgICAgICAgICAgdGFyZ2V0ID0gJCggaWQgKSwNCiAgICAgICAgICAgICAgICBpbnN0ID0gdGhpcy5fZ2V0SW5zdCggdGFyZ2V0WyAwIF0gKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLl9nZXQoIGluc3QsICJnb3RvQ3VycmVudCIgKSAmJiBpbnN0LmN1cnJlbnREYXkgKSB7DQogICAgICAgICAgICAgICAgaW5zdC5zZWxlY3RlZERheSA9IGluc3QuY3VycmVudERheTsNCiAgICAgICAgICAgICAgICBpbnN0LmRyYXdNb250aCA9IGluc3Quc2VsZWN0ZWRNb250aCA9IGluc3QuY3VycmVudE1vbnRoOw0KICAgICAgICAgICAgICAgIGluc3QuZHJhd1llYXIgPSBpbnN0LnNlbGVjdGVkWWVhciA9IGluc3QuY3VycmVudFllYXI7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGRhdGUgPSBuZXcgRGF0ZSgpOw0KICAgICAgICAgICAgICAgIGluc3Quc2VsZWN0ZWREYXkgPSBkYXRlLmdldERhdGUoKTsNCiAgICAgICAgICAgICAgICBpbnN0LmRyYXdNb250aCA9IGluc3Quc2VsZWN0ZWRNb250aCA9IGRhdGUuZ2V0TW9udGgoKTsNCiAgICAgICAgICAgICAgICBpbnN0LmRyYXdZZWFyID0gaW5zdC5zZWxlY3RlZFllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLl9ub3RpZnlDaGFuZ2UoIGluc3QgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkanVzdERhdGUoIHRhcmdldCApOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qIEFjdGlvbiBmb3Igc2VsZWN0aW5nIGEgbmV3IG1vbnRoL3llYXIuICovDQogICAgICAgIF9zZWxlY3RNb250aFllYXI6IGZ1bmN0aW9uKCBpZCwgc2VsZWN0LCBwZXJpb2QgKSB7DQogICAgICAgICAgICB2YXIgdGFyZ2V0ID0gJCggaWQgKSwNCiAgICAgICAgICAgICAgICBpbnN0ID0gdGhpcy5fZ2V0SW5zdCggdGFyZ2V0WyAwIF0gKTsNCg0KICAgICAgICAgICAgaW5zdFsgInNlbGVjdGVkIiArICggcGVyaW9kID09PSAiTSIgPyAiTW9udGgiIDogIlllYXIiICkgXSA9DQogICAgICAgICAgICAgICAgaW5zdFsgImRyYXciICsgKCBwZXJpb2QgPT09ICJNIiA/ICJNb250aCIgOiAiWWVhciIgKSBdID0NCiAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQoIHNlbGVjdC5vcHRpb25zWyBzZWxlY3Quc2VsZWN0ZWRJbmRleCBdLnZhbHVlLCAxMCApOw0KDQogICAgICAgICAgICB0aGlzLl9ub3RpZnlDaGFuZ2UoIGluc3QgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkanVzdERhdGUoIHRhcmdldCApOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qIEFjdGlvbiBmb3Igc2VsZWN0aW5nIGEgZGF5LiAqLw0KICAgICAgICBfc2VsZWN0RGF5OiBmdW5jdGlvbiggaWQsIG1vbnRoLCB5ZWFyLCB0ZCApIHsNCiAgICAgICAgICAgIHZhciBpbnN0LA0KICAgICAgICAgICAgICAgIHRhcmdldCA9ICQoIGlkICk7DQoNCiAgICAgICAgICAgIGlmICggJCggdGQgKS5oYXNDbGFzcyggdGhpcy5fdW5zZWxlY3RhYmxlQ2xhc3MgKSB8fCB0aGlzLl9pc0Rpc2FibGVkRGF0ZXBpY2tlciggdGFyZ2V0WyAwIF0gKSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGluc3QgPSB0aGlzLl9nZXRJbnN0KCB0YXJnZXRbIDAgXSApOw0KICAgICAgICAgICAgaW5zdC5zZWxlY3RlZERheSA9IGluc3QuY3VycmVudERheSA9ICQoICJhIiwgdGQgKS5odG1sKCk7DQogICAgICAgICAgICBpbnN0LnNlbGVjdGVkTW9udGggPSBpbnN0LmN1cnJlbnRNb250aCA9IG1vbnRoOw0KICAgICAgICAgICAgaW5zdC5zZWxlY3RlZFllYXIgPSBpbnN0LmN1cnJlbnRZZWFyID0geWVhcjsNCiAgICAgICAgICAgIHRoaXMuX3NlbGVjdERhdGUoIGlkLCB0aGlzLl9mb3JtYXREYXRlKCBpbnN0LA0KICAgICAgICAgICAgICAgIGluc3QuY3VycmVudERheSwgaW5zdC5jdXJyZW50TW9udGgsIGluc3QuY3VycmVudFllYXIgKSApOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qIEVyYXNlIHRoZSBpbnB1dCBmaWVsZCBhbmQgaGlkZSB0aGUgZGF0ZSBwaWNrZXIuICovDQogICAgICAgIF9jbGVhckRhdGU6IGZ1bmN0aW9uKCBpZCApIHsNCiAgICAgICAgICAgIHZhciB0YXJnZXQgPSAkKCBpZCApOw0KICAgICAgICAgICAgdGhpcy5fc2VsZWN0RGF0ZSggdGFyZ2V0LCAiIiApOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qIFVwZGF0ZSB0aGUgaW5wdXQgZmllbGQgd2l0aCB0aGUgc2VsZWN0ZWQgZGF0ZS4gKi8NCiAgICAgICAgX3NlbGVjdERhdGU6IGZ1bmN0aW9uKCBpZCwgZGF0ZVN0ciApIHsNCiAgICAgICAgICAgIHZhciBvblNlbGVjdCwNCiAgICAgICAgICAgICAgICB0YXJnZXQgPSAkKCBpZCApLA0KICAgICAgICAgICAgICAgIGluc3QgPSB0aGlzLl9nZXRJbnN0KCB0YXJnZXRbIDAgXSApOw0KDQogICAgICAgICAgICBkYXRlU3RyID0gKCBkYXRlU3RyICE9IG51bGwgPyBkYXRlU3RyIDogdGhpcy5fZm9ybWF0RGF0ZSggaW5zdCApICk7DQogICAgICAgICAgICBpZiAoIGluc3QuaW5wdXQgKSB7DQogICAgICAgICAgICAgICAgaW5zdC5pbnB1dC52YWwoIGRhdGVTdHIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUFsdGVybmF0ZSggaW5zdCApOw0KDQogICAgICAgICAgICBvblNlbGVjdCA9IHRoaXMuX2dldCggaW5zdCwgIm9uU2VsZWN0IiApOw0KICAgICAgICAgICAgaWYgKCBvblNlbGVjdCApIHsNCiAgICAgICAgICAgICAgICBvblNlbGVjdC5hcHBseSggKCBpbnN0LmlucHV0ID8gaW5zdC5pbnB1dFsgMCBdIDogbnVsbCApLCBbIGRhdGVTdHIsIGluc3QgXSApOyAgLy8gdHJpZ2dlciBjdXN0b20gY2FsbGJhY2sNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGluc3QuaW5wdXQgKSB7DQogICAgICAgICAgICAgICAgaW5zdC5pbnB1dC50cmlnZ2VyKCAiY2hhbmdlIiApOyAvLyBmaXJlIHRoZSBjaGFuZ2UgZXZlbnQNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCBpbnN0LmlubGluZSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVEYXRlcGlja2VyKCBpbnN0ICk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuX2hpZGVEYXRlcGlja2VyKCk7DQogICAgICAgICAgICAgICAgdGhpcy5fbGFzdElucHV0ID0gaW5zdC5pbnB1dFsgMCBdOw0KICAgICAgICAgICAgICAgIGlmICggdHlwZW9mKCBpbnN0LmlucHV0WyAwIF0gKSAhPT0gIm9iamVjdCIgKSB7DQogICAgICAgICAgICAgICAgICAgIGluc3QuaW5wdXQudHJpZ2dlciggImZvY3VzIiApOyAvLyByZXN0b3JlIGZvY3VzDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RJbnB1dCA9IG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogVXBkYXRlIGFueSBhbHRlcm5hdGUgZmllbGQgdG8gc3luY2hyb25pc2Ugd2l0aCB0aGUgbWFpbiBmaWVsZC4gKi8NCiAgICAgICAgX3VwZGF0ZUFsdGVybmF0ZTogZnVuY3Rpb24oIGluc3QgKSB7DQogICAgICAgICAgICB2YXIgYWx0Rm9ybWF0LCBkYXRlLCBkYXRlU3RyLA0KICAgICAgICAgICAgICAgIGFsdEZpZWxkID0gdGhpcy5fZ2V0KCBpbnN0LCAiYWx0RmllbGQiICk7DQoNCiAgICAgICAgICAgIGlmICggYWx0RmllbGQgKSB7IC8vIHVwZGF0ZSBhbHRlcm5hdGUgZmllbGQgdG9vDQogICAgICAgICAgICAgICAgYWx0Rm9ybWF0ID0gdGhpcy5fZ2V0KCBpbnN0LCAiYWx0Rm9ybWF0IiApIHx8IHRoaXMuX2dldCggaW5zdCwgImRhdGVGb3JtYXQiICk7DQogICAgICAgICAgICAgICAgZGF0ZSA9IHRoaXMuX2dldERhdGUoIGluc3QgKTsNCiAgICAgICAgICAgICAgICBkYXRlU3RyID0gdGhpcy5mb3JtYXREYXRlKCBhbHRGb3JtYXQsIGRhdGUsIHRoaXMuX2dldEZvcm1hdENvbmZpZyggaW5zdCApICk7DQogICAgICAgICAgICAgICAgJCggYWx0RmllbGQgKS52YWwoIGRhdGVTdHIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBTZXQgYXMgYmVmb3JlU2hvd0RheSBmdW5jdGlvbiB0byBwcmV2ZW50IHNlbGVjdGlvbiBvZiB3ZWVrZW5kcy4NCgkgKiBAcGFyYW0gIGRhdGUgIERhdGUgLSB0aGUgZGF0ZSB0byBjdXN0b21pc2UNCgkgKiBAcmV0dXJuIFtib29sZWFuLCBzdHJpbmddIC0gaXMgdGhpcyBkYXRlIHNlbGVjdGFibGU/LCB3aGF0IGlzIGl0cyBDU1MgY2xhc3M/DQoJICovDQogICAgICAgIG5vV2Vla2VuZHM6IGZ1bmN0aW9uKCBkYXRlICkgew0KICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7DQogICAgICAgICAgICByZXR1cm4gWyAoIGRheSA+IDAgJiYgZGF5IDwgNiApLCAiIiBdOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qIFNldCBhcyBjYWxjdWxhdGVXZWVrIHRvIGRldGVybWluZSB0aGUgd2VlayBvZiB0aGUgeWVhciBiYXNlZCBvbiB0aGUgSVNPIDg2MDEgZGVmaW5pdGlvbi4NCgkgKiBAcGFyYW0gIGRhdGUgIERhdGUgLSB0aGUgZGF0ZSB0byBnZXQgdGhlIHdlZWsgZm9yDQoJICogQHJldHVybiAgbnVtYmVyIC0gdGhlIG51bWJlciBvZiB0aGUgd2VlayB3aXRoaW4gdGhlIHllYXIgdGhhdCBjb250YWlucyB0aGlzIGRhdGUNCgkgKi8NCiAgICAgICAgaXNvODYwMVdlZWs6IGZ1bmN0aW9uKCBkYXRlICkgew0KICAgICAgICAgICAgdmFyIHRpbWUsDQogICAgICAgICAgICAgICAgY2hlY2tEYXRlID0gbmV3IERhdGUoIGRhdGUuZ2V0VGltZSgpICk7DQoNCiAgICAgICAgICAgIC8vIEZpbmQgVGh1cnNkYXkgb2YgdGhpcyB3ZWVrIHN0YXJ0aW5nIG9uIE1vbmRheQ0KICAgICAgICAgICAgY2hlY2tEYXRlLnNldERhdGUoIGNoZWNrRGF0ZS5nZXREYXRlKCkgKyA0IC0gKCBjaGVja0RhdGUuZ2V0RGF5KCkgfHwgNyApICk7DQoNCiAgICAgICAgICAgIHRpbWUgPSBjaGVja0RhdGUuZ2V0VGltZSgpOw0KICAgICAgICAgICAgY2hlY2tEYXRlLnNldE1vbnRoKCAwICk7IC8vIENvbXBhcmUgd2l0aCBKYW4gMQ0KICAgICAgICAgICAgY2hlY2tEYXRlLnNldERhdGUoIDEgKTsNCiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKCBNYXRoLnJvdW5kKCAoIHRpbWUgLSBjaGVja0RhdGUgKSAvIDg2NDAwMDAwICkgLyA3ICkgKyAxOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qIFBhcnNlIGEgc3RyaW5nIHZhbHVlIGludG8gYSBkYXRlIG9iamVjdC4NCgkgKiBTZWUgZm9ybWF0RGF0ZSBiZWxvdyBmb3IgdGhlIHBvc3NpYmxlIGZvcm1hdHMuDQoJICoNCgkgKiBAcGFyYW0gIGZvcm1hdCBzdHJpbmcgLSB0aGUgZXhwZWN0ZWQgZm9ybWF0IG9mIHRoZSBkYXRlDQoJICogQHBhcmFtICB2YWx1ZSBzdHJpbmcgLSB0aGUgZGF0ZSBpbiB0aGUgYWJvdmUgZm9ybWF0DQoJICogQHBhcmFtICBzZXR0aW5ncyBPYmplY3QgLSBhdHRyaWJ1dGVzIGluY2x1ZGU6DQoJICoJCQkJCXNob3J0WWVhckN1dG9mZiAgbnVtYmVyIC0gdGhlIGN1dG9mZiB5ZWFyIGZvciBkZXRlcm1pbmluZyB0aGUgY2VudHVyeSAob3B0aW9uYWwpDQoJICoJCQkJCWRheU5hbWVzU2hvcnQJc3RyaW5nWzddIC0gYWJicmV2aWF0ZWQgbmFtZXMgb2YgdGhlIGRheXMgZnJvbSBTdW5kYXkgKG9wdGlvbmFsKQ0KCSAqCQkJCQlkYXlOYW1lcwkJc3RyaW5nWzddIC0gbmFtZXMgb2YgdGhlIGRheXMgZnJvbSBTdW5kYXkgKG9wdGlvbmFsKQ0KCSAqCQkJCQltb250aE5hbWVzU2hvcnQgc3RyaW5nWzEyXSAtIGFiYnJldmlhdGVkIG5hbWVzIG9mIHRoZSBtb250aHMgKG9wdGlvbmFsKQ0KCSAqCQkJCQltb250aE5hbWVzCQlzdHJpbmdbMTJdIC0gbmFtZXMgb2YgdGhlIG1vbnRocyAob3B0aW9uYWwpDQoJICogQHJldHVybiAgRGF0ZSAtIHRoZSBleHRyYWN0ZWQgZGF0ZSB2YWx1ZSBvciBudWxsIGlmIHZhbHVlIGlzIGJsYW5rDQoJICovDQogICAgICAgIHBhcnNlRGF0ZTogZnVuY3Rpb24oIGZvcm1hdCwgdmFsdWUsIHNldHRpbmdzICkgew0KICAgICAgICAgICAgaWYgKCBmb3JtYXQgPT0gbnVsbCB8fCB2YWx1ZSA9PSBudWxsICkgew0KICAgICAgICAgICAgICAgIHRocm93ICJJbnZhbGlkIGFyZ3VtZW50cyI7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhbHVlID0gKCB0eXBlb2YgdmFsdWUgPT09ICJvYmplY3QiID8gdmFsdWUudG9TdHJpbmcoKSA6IHZhbHVlICsgIiIgKTsNCiAgICAgICAgICAgIGlmICggdmFsdWUgPT09ICIiICkgew0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgaUZvcm1hdCwgZGltLCBleHRyYSwNCiAgICAgICAgICAgICAgICBpVmFsdWUgPSAwLA0KICAgICAgICAgICAgICAgIHNob3J0WWVhckN1dG9mZlRlbXAgPSAoIHNldHRpbmdzID8gc2V0dGluZ3Muc2hvcnRZZWFyQ3V0b2ZmIDogbnVsbCApIHx8IHRoaXMuX2RlZmF1bHRzLnNob3J0WWVhckN1dG9mZiwNCiAgICAgICAgICAgICAgICBzaG9ydFllYXJDdXRvZmYgPSAoIHR5cGVvZiBzaG9ydFllYXJDdXRvZmZUZW1wICE9PSAic3RyaW5nIiA/IHNob3J0WWVhckN1dG9mZlRlbXAgOg0KICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkgJSAxMDAgKyBwYXJzZUludCggc2hvcnRZZWFyQ3V0b2ZmVGVtcCwgMTAgKSApLA0KICAgICAgICAgICAgICAgIGRheU5hbWVzU2hvcnQgPSAoIHNldHRpbmdzID8gc2V0dGluZ3MuZGF5TmFtZXNTaG9ydCA6IG51bGwgKSB8fCB0aGlzLl9kZWZhdWx0cy5kYXlOYW1lc1Nob3J0LA0KICAgICAgICAgICAgICAgIGRheU5hbWVzID0gKCBzZXR0aW5ncyA/IHNldHRpbmdzLmRheU5hbWVzIDogbnVsbCApIHx8IHRoaXMuX2RlZmF1bHRzLmRheU5hbWVzLA0KICAgICAgICAgICAgICAgIG1vbnRoTmFtZXNTaG9ydCA9ICggc2V0dGluZ3MgPyBzZXR0aW5ncy5tb250aE5hbWVzU2hvcnQgOiBudWxsICkgfHwgdGhpcy5fZGVmYXVsdHMubW9udGhOYW1lc1Nob3J0LA0KICAgICAgICAgICAgICAgIG1vbnRoTmFtZXMgPSAoIHNldHRpbmdzID8gc2V0dGluZ3MubW9udGhOYW1lcyA6IG51bGwgKSB8fCB0aGlzLl9kZWZhdWx0cy5tb250aE5hbWVzLA0KICAgICAgICAgICAgICAgIHllYXIgPSAtMSwNCiAgICAgICAgICAgICAgICBtb250aCA9IC0xLA0KICAgICAgICAgICAgICAgIGRheSA9IC0xLA0KICAgICAgICAgICAgICAgIGRveSA9IC0xLA0KICAgICAgICAgICAgICAgIGxpdGVyYWwgPSBmYWxzZSwNCiAgICAgICAgICAgICAgICBkYXRlLA0KDQogICAgICAgICAgICAgICAgLy8gQ2hlY2sgd2hldGhlciBhIGZvcm1hdCBjaGFyYWN0ZXIgaXMgZG91YmxlZA0KICAgICAgICAgICAgICAgIGxvb2tBaGVhZCA9IGZ1bmN0aW9uKCBtYXRjaCApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoZXMgPSAoIGlGb3JtYXQgKyAxIDwgZm9ybWF0Lmxlbmd0aCAmJiBmb3JtYXQuY2hhckF0KCBpRm9ybWF0ICsgMSApID09PSBtYXRjaCApOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIG1hdGNoZXMgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpRm9ybWF0Kys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXM7DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIC8vIEV4dHJhY3QgYSBudW1iZXIgZnJvbSB0aGUgc3RyaW5nIHZhbHVlDQogICAgICAgICAgICAgICAgZ2V0TnVtYmVyID0gZnVuY3Rpb24oIG1hdGNoICkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgaXNEb3VibGVkID0gbG9va0FoZWFkKCBtYXRjaCApLA0KICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSA9ICggbWF0Y2ggPT09ICJAIiA/IDE0IDogKCBtYXRjaCA9PT0gIiEiID8gMjAgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICggbWF0Y2ggPT09ICJ5IiAmJiBpc0RvdWJsZWQgPyA0IDogKCBtYXRjaCA9PT0gIm8iID8gMyA6IDIgKSApICkgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG1pblNpemUgPSAoIG1hdGNoID09PSAieSIgPyBzaXplIDogMSApLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGlnaXRzID0gbmV3IFJlZ0V4cCggIl5cXGR7IiArIG1pblNpemUgKyAiLCIgKyBzaXplICsgIn0iICksDQogICAgICAgICAgICAgICAgICAgICAgICBudW0gPSB2YWx1ZS5zdWJzdHJpbmcoIGlWYWx1ZSApLm1hdGNoKCBkaWdpdHMgKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAhbnVtICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgIk1pc3NpbmcgbnVtYmVyIGF0IHBvc2l0aW9uICIgKyBpVmFsdWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaVZhbHVlICs9IG51bVsgMCBdLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KCBudW1bIDAgXSwgMTAgKTsNCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgLy8gRXh0cmFjdCBhIG5hbWUgZnJvbSB0aGUgc3RyaW5nIHZhbHVlIGFuZCBjb252ZXJ0IHRvIGFuIGluZGV4DQogICAgICAgICAgICAgICAgZ2V0TmFtZSA9IGZ1bmN0aW9uKCBtYXRjaCwgc2hvcnROYW1lcywgbG9uZ05hbWVzICkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAtMSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzID0gJC5tYXAoIGxvb2tBaGVhZCggbWF0Y2ggKSA/IGxvbmdOYW1lcyA6IHNob3J0TmFtZXMsIGZ1bmN0aW9uKCB2LCBrICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbIFsgaywgdiBdIF07DQogICAgICAgICAgICAgICAgICAgICAgICB9ICkuc29ydCggZnVuY3Rpb24oIGEsIGIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0oIGFbIDEgXS5sZW5ndGggLSBiWyAxIF0ubGVuZ3RoICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKCBuYW1lcywgZnVuY3Rpb24oIGksIHBhaXIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IHBhaXJbIDEgXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggdmFsdWUuc3Vic3RyKCBpVmFsdWUsIG5hbWUubGVuZ3RoICkudG9Mb3dlckNhc2UoKSA9PT0gbmFtZS50b0xvd2VyQ2FzZSgpICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gcGFpclsgMCBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlWYWx1ZSArPSBuYW1lLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBpbmRleCAhPT0gLTEgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXggKyAxOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgIlVua25vd24gbmFtZSBhdCBwb3NpdGlvbiAiICsgaVZhbHVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIC8vIENvbmZpcm0gdGhhdCBhIGxpdGVyYWwgY2hhcmFjdGVyIG1hdGNoZXMgdGhlIHN0cmluZyB2YWx1ZQ0KICAgICAgICAgICAgICAgIGNoZWNrTGl0ZXJhbCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIHZhbHVlLmNoYXJBdCggaVZhbHVlICkgIT09IGZvcm1hdC5jaGFyQXQoIGlGb3JtYXQgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93ICJVbmV4cGVjdGVkIGxpdGVyYWwgYXQgcG9zaXRpb24gIiArIGlWYWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpVmFsdWUrKzsNCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICBmb3IgKCBpRm9ybWF0ID0gMDsgaUZvcm1hdCA8IGZvcm1hdC5sZW5ndGg7IGlGb3JtYXQrKyApIHsNCiAgICAgICAgICAgICAgICBpZiAoIGxpdGVyYWwgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggZm9ybWF0LmNoYXJBdCggaUZvcm1hdCApID09PSAiJyIgJiYgIWxvb2tBaGVhZCggIiciICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsaXRlcmFsID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjaGVja0xpdGVyYWwoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoIGZvcm1hdC5jaGFyQXQoIGlGb3JtYXQgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImQiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheSA9IGdldE51bWJlciggImQiICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJEIjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXROYW1lKCAiRCIsIGRheU5hbWVzU2hvcnQsIGRheU5hbWVzICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJvIjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb3kgPSBnZXROdW1iZXIoICJvIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAibSI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9udGggPSBnZXROdW1iZXIoICJtIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiTSI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9udGggPSBnZXROYW1lKCAiTSIsIG1vbnRoTmFtZXNTaG9ydCwgbW9udGhOYW1lcyApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAieSI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhciA9IGdldE51bWJlciggInkiICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJAIjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlID0gbmV3IERhdGUoIGdldE51bWJlciggIkAiICkgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXkgPSBkYXRlLmdldERhdGUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIiEiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUgPSBuZXcgRGF0ZSggKCBnZXROdW1iZXIoICIhIiApIC0gdGhpcy5fdGlja3NUbzE5NzAgKSAvIDEwMDAwICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5ID0gZGF0ZS5nZXREYXRlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICInIjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGxvb2tBaGVhZCggIiciICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrTGl0ZXJhbCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpdGVyYWwgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tMaXRlcmFsKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggaVZhbHVlIDwgdmFsdWUubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIGV4dHJhID0gdmFsdWUuc3Vic3RyKCBpVmFsdWUgKTsNCiAgICAgICAgICAgICAgICBpZiAoICEvXlxzKy8udGVzdCggZXh0cmEgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgIkV4dHJhL3VucGFyc2VkIGNoYXJhY3RlcnMgZm91bmQgaW4gZGF0ZTogIiArIGV4dHJhOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCB5ZWFyID09PSAtMSApIHsNCiAgICAgICAgICAgICAgICB5ZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgfSBlbHNlIGlmICggeWVhciA8IDEwMCApIHsNCiAgICAgICAgICAgICAgICB5ZWFyICs9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKSAtIG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKSAlIDEwMCArDQogICAgICAgICAgICAgICAgICAgICggeWVhciA8PSBzaG9ydFllYXJDdXRvZmYgPyAwIDogLTEwMCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGRveSA+IC0xICkgew0KICAgICAgICAgICAgICAgIG1vbnRoID0gMTsNCiAgICAgICAgICAgICAgICBkYXkgPSBkb3k7DQogICAgICAgICAgICAgICAgZG8gew0KICAgICAgICAgICAgICAgICAgICBkaW0gPSB0aGlzLl9nZXREYXlzSW5Nb250aCggeWVhciwgbW9udGggLSAxICk7DQogICAgICAgICAgICAgICAgICAgIGlmICggZGF5IDw9IGRpbSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIG1vbnRoKys7DQogICAgICAgICAgICAgICAgICAgIGRheSAtPSBkaW07DQogICAgICAgICAgICAgICAgfSB3aGlsZSAoIHRydWUgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZGF0ZSA9IHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KCBuZXcgRGF0ZSggeWVhciwgbW9udGggLSAxLCBkYXkgKSApOw0KICAgICAgICAgICAgaWYgKCBkYXRlLmdldEZ1bGxZZWFyKCkgIT09IHllYXIgfHwgZGF0ZS5nZXRNb250aCgpICsgMSAhPT0gbW9udGggfHwgZGF0ZS5nZXREYXRlKCkgIT09IGRheSApIHsNCiAgICAgICAgICAgICAgICB0aHJvdyAiSW52YWxpZCBkYXRlIjsgLy8gRS5nLiAzMS8wMi8wMA0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGRhdGU7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogU3RhbmRhcmQgZGF0ZSBmb3JtYXRzLiAqLw0KICAgICAgICBBVE9NOiAieXktbW0tZGQiLCAvLyBSRkMgMzMzOSAoSVNPIDg2MDEpDQogICAgICAgIENPT0tJRTogIkQsIGRkIE0geXkiLA0KICAgICAgICBJU09fODYwMTogInl5LW1tLWRkIiwNCiAgICAgICAgUkZDXzgyMjogIkQsIGQgTSB5IiwNCiAgICAgICAgUkZDXzg1MDogIkRELCBkZC1NLXkiLA0KICAgICAgICBSRkNfMTAzNjogIkQsIGQgTSB5IiwNCiAgICAgICAgUkZDXzExMjM6ICJELCBkIE0geXkiLA0KICAgICAgICBSRkNfMjgyMjogIkQsIGQgTSB5eSIsDQogICAgICAgIFJTUzogIkQsIGQgTSB5IiwgLy8gUkZDIDgyMg0KICAgICAgICBUSUNLUzogIiEiLA0KICAgICAgICBUSU1FU1RBTVA6ICJAIiwNCiAgICAgICAgVzNDOiAieXktbW0tZGQiLCAvLyBJU08gODYwMQ0KDQogICAgICAgIF90aWNrc1RvMTk3MDogKCAoICggMTk3MCAtIDEgKSAqIDM2NSArIE1hdGguZmxvb3IoIDE5NzAgLyA0ICkgLSBNYXRoLmZsb29yKCAxOTcwIC8gMTAwICkgKw0KICAgICAgICAgICAgTWF0aC5mbG9vciggMTk3MCAvIDQwMCApICkgKiAyNCAqIDYwICogNjAgKiAxMDAwMDAwMCApLA0KDQogICAgICAgIC8qIEZvcm1hdCBhIGRhdGUgb2JqZWN0IGludG8gYSBzdHJpbmcgdmFsdWUuDQoJICogVGhlIGZvcm1hdCBjYW4gYmUgY29tYmluYXRpb25zIG9mIHRoZSBmb2xsb3dpbmc6DQoJICogZCAgLSBkYXkgb2YgbW9udGggKG5vIGxlYWRpbmcgemVybykNCgkgKiBkZCAtIGRheSBvZiBtb250aCAodHdvIGRpZ2l0KQ0KCSAqIG8gIC0gZGF5IG9mIHllYXIgKG5vIGxlYWRpbmcgemVyb3MpDQoJICogb28gLSBkYXkgb2YgeWVhciAodGhyZWUgZGlnaXQpDQoJICogRCAgLSBkYXkgbmFtZSBzaG9ydA0KCSAqIEREIC0gZGF5IG5hbWUgbG9uZw0KCSAqIG0gIC0gbW9udGggb2YgeWVhciAobm8gbGVhZGluZyB6ZXJvKQ0KCSAqIG1tIC0gbW9udGggb2YgeWVhciAodHdvIGRpZ2l0KQ0KCSAqIE0gIC0gbW9udGggbmFtZSBzaG9ydA0KCSAqIE1NIC0gbW9udGggbmFtZSBsb25nDQoJICogeSAgLSB5ZWFyICh0d28gZGlnaXQpDQoJICogeXkgLSB5ZWFyIChmb3VyIGRpZ2l0KQ0KCSAqIEAgLSBVbml4IHRpbWVzdGFtcCAobXMgc2luY2UgMDEvMDEvMTk3MCkNCgkgKiAhIC0gV2luZG93cyB0aWNrcyAoMTAwbnMgc2luY2UgMDEvMDEvMDAwMSkNCgkgKiAiLi4uIiAtIGxpdGVyYWwgdGV4dA0KCSAqICcnIC0gc2luZ2xlIHF1b3RlDQoJICoNCgkgKiBAcGFyYW0gIGZvcm1hdCBzdHJpbmcgLSB0aGUgZGVzaXJlZCBmb3JtYXQgb2YgdGhlIGRhdGUNCgkgKiBAcGFyYW0gIGRhdGUgRGF0ZSAtIHRoZSBkYXRlIHZhbHVlIHRvIGZvcm1hdA0KCSAqIEBwYXJhbSAgc2V0dGluZ3MgT2JqZWN0IC0gYXR0cmlidXRlcyBpbmNsdWRlOg0KCSAqCQkJCQlkYXlOYW1lc1Nob3J0CXN0cmluZ1s3XSAtIGFiYnJldmlhdGVkIG5hbWVzIG9mIHRoZSBkYXlzIGZyb20gU3VuZGF5IChvcHRpb25hbCkNCgkgKgkJCQkJZGF5TmFtZXMJCXN0cmluZ1s3XSAtIG5hbWVzIG9mIHRoZSBkYXlzIGZyb20gU3VuZGF5IChvcHRpb25hbCkNCgkgKgkJCQkJbW9udGhOYW1lc1Nob3J0IHN0cmluZ1sxMl0gLSBhYmJyZXZpYXRlZCBuYW1lcyBvZiB0aGUgbW9udGhzIChvcHRpb25hbCkNCgkgKgkJCQkJbW9udGhOYW1lcwkJc3RyaW5nWzEyXSAtIG5hbWVzIG9mIHRoZSBtb250aHMgKG9wdGlvbmFsKQ0KCSAqIEByZXR1cm4gIHN0cmluZyAtIHRoZSBkYXRlIGluIHRoZSBhYm92ZSBmb3JtYXQNCgkgKi8NCiAgICAgICAgZm9ybWF0RGF0ZTogZnVuY3Rpb24oIGZvcm1hdCwgZGF0ZSwgc2V0dGluZ3MgKSB7DQogICAgICAgICAgICBpZiAoICFkYXRlICkgew0KICAgICAgICAgICAgICAgIHJldHVybiAiIjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdmFyIGlGb3JtYXQsDQogICAgICAgICAgICAgICAgZGF5TmFtZXNTaG9ydCA9ICggc2V0dGluZ3MgPyBzZXR0aW5ncy5kYXlOYW1lc1Nob3J0IDogbnVsbCApIHx8IHRoaXMuX2RlZmF1bHRzLmRheU5hbWVzU2hvcnQsDQogICAgICAgICAgICAgICAgZGF5TmFtZXMgPSAoIHNldHRpbmdzID8gc2V0dGluZ3MuZGF5TmFtZXMgOiBudWxsICkgfHwgdGhpcy5fZGVmYXVsdHMuZGF5TmFtZXMsDQogICAgICAgICAgICAgICAgbW9udGhOYW1lc1Nob3J0ID0gKCBzZXR0aW5ncyA/IHNldHRpbmdzLm1vbnRoTmFtZXNTaG9ydCA6IG51bGwgKSB8fCB0aGlzLl9kZWZhdWx0cy5tb250aE5hbWVzU2hvcnQsDQogICAgICAgICAgICAgICAgbW9udGhOYW1lcyA9ICggc2V0dGluZ3MgPyBzZXR0aW5ncy5tb250aE5hbWVzIDogbnVsbCApIHx8IHRoaXMuX2RlZmF1bHRzLm1vbnRoTmFtZXMsDQoNCiAgICAgICAgICAgICAgICAvLyBDaGVjayB3aGV0aGVyIGEgZm9ybWF0IGNoYXJhY3RlciBpcyBkb3VibGVkDQogICAgICAgICAgICAgICAgbG9va0FoZWFkID0gZnVuY3Rpb24oIG1hdGNoICkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hlcyA9ICggaUZvcm1hdCArIDEgPCBmb3JtYXQubGVuZ3RoICYmIGZvcm1hdC5jaGFyQXQoIGlGb3JtYXQgKyAxICkgPT09IG1hdGNoICk7DQogICAgICAgICAgICAgICAgICAgIGlmICggbWF0Y2hlcyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlGb3JtYXQrKzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hlczsNCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgLy8gRm9ybWF0IGEgbnVtYmVyLCB3aXRoIGxlYWRpbmcgemVybyBpZiBuZWNlc3NhcnkNCiAgICAgICAgICAgICAgICBmb3JtYXROdW1iZXIgPSBmdW5jdGlvbiggbWF0Y2gsIHZhbHVlLCBsZW4gKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBudW0gPSAiIiArIHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIGxvb2tBaGVhZCggbWF0Y2ggKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICggbnVtLmxlbmd0aCA8IGxlbiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW0gPSAiMCIgKyBudW07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bTsNCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgLy8gRm9ybWF0IGEgbmFtZSwgc2hvcnQgb3IgbG9uZyBhcyByZXF1ZXN0ZWQNCiAgICAgICAgICAgICAgICBmb3JtYXROYW1lID0gZnVuY3Rpb24oIG1hdGNoLCB2YWx1ZSwgc2hvcnROYW1lcywgbG9uZ05hbWVzICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCBsb29rQWhlYWQoIG1hdGNoICkgPyBsb25nTmFtZXNbIHZhbHVlIF0gOiBzaG9ydE5hbWVzWyB2YWx1ZSBdICk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBvdXRwdXQgPSAiIiwNCiAgICAgICAgICAgICAgICBsaXRlcmFsID0gZmFsc2U7DQoNCiAgICAgICAgICAgIGlmICggZGF0ZSApIHsNCiAgICAgICAgICAgICAgICBmb3IgKCBpRm9ybWF0ID0gMDsgaUZvcm1hdCA8IGZvcm1hdC5sZW5ndGg7IGlGb3JtYXQrKyApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBsaXRlcmFsICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBmb3JtYXQuY2hhckF0KCBpRm9ybWF0ICkgPT09ICInIiAmJiAhbG9va0FoZWFkKCAiJyIgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXRlcmFsID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSBmb3JtYXQuY2hhckF0KCBpRm9ybWF0ICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCBmb3JtYXQuY2hhckF0KCBpRm9ybWF0ICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZCI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSBmb3JtYXROdW1iZXIoICJkIiwgZGF0ZS5nZXREYXRlKCksIDIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiRCI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSBmb3JtYXROYW1lKCAiRCIsIGRhdGUuZ2V0RGF5KCksIGRheU5hbWVzU2hvcnQsIGRheU5hbWVzICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIm8iOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgKz0gZm9ybWF0TnVtYmVyKCAibyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKCAoIG5ldyBEYXRlKCBkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSwgZGF0ZS5nZXREYXRlKCkgKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZSggZGF0ZS5nZXRGdWxsWWVhcigpLCAwLCAwICkuZ2V0VGltZSgpICkgLyA4NjQwMDAwMCApLCAzICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIm0iOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgKz0gZm9ybWF0TnVtYmVyKCAibSIsIGRhdGUuZ2V0TW9udGgoKSArIDEsIDIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiTSI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSBmb3JtYXROYW1lKCAiTSIsIGRhdGUuZ2V0TW9udGgoKSwgbW9udGhOYW1lc1Nob3J0LCBtb250aE5hbWVzICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgInkiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgKz0gKCBsb29rQWhlYWQoICJ5IiApID8gZGF0ZS5nZXRGdWxsWWVhcigpIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICggZGF0ZS5nZXRGdWxsWWVhcigpICUgMTAwIDwgMTAgPyAiMCIgOiAiIiApICsgZGF0ZS5nZXRGdWxsWWVhcigpICUgMTAwICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIkAiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgKz0gZGF0ZS5nZXRUaW1lKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIiEiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgKz0gZGF0ZS5nZXRUaW1lKCkgKiAxMDAwMCArIHRoaXMuX3RpY2tzVG8xOTcwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICInIjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBsb29rQWhlYWQoICInIiApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ICs9ICInIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpdGVyYWwgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSBmb3JtYXQuY2hhckF0KCBpRm9ybWF0ICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gb3V0cHV0Ow0KICAgICAgICB9LA0KDQogICAgICAgIC8qIEV4dHJhY3QgYWxsIHBvc3NpYmxlIGNoYXJhY3RlcnMgZnJvbSB0aGUgZGF0ZSBmb3JtYXQuICovDQogICAgICAgIF9wb3NzaWJsZUNoYXJzOiBmdW5jdGlvbiggZm9ybWF0ICkgew0KICAgICAgICAgICAgdmFyIGlGb3JtYXQsDQogICAgICAgICAgICAgICAgY2hhcnMgPSAiIiwNCiAgICAgICAgICAgICAgICBsaXRlcmFsID0gZmFsc2UsDQoNCiAgICAgICAgICAgICAgICAvLyBDaGVjayB3aGV0aGVyIGEgZm9ybWF0IGNoYXJhY3RlciBpcyBkb3VibGVkDQogICAgICAgICAgICAgICAgbG9va0FoZWFkID0gZnVuY3Rpb24oIG1hdGNoICkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hlcyA9ICggaUZvcm1hdCArIDEgPCBmb3JtYXQubGVuZ3RoICYmIGZvcm1hdC5jaGFyQXQoIGlGb3JtYXQgKyAxICkgPT09IG1hdGNoICk7DQogICAgICAgICAgICAgICAgICAgIGlmICggbWF0Y2hlcyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlGb3JtYXQrKzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hlczsNCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICBmb3IgKCBpRm9ybWF0ID0gMDsgaUZvcm1hdCA8IGZvcm1hdC5sZW5ndGg7IGlGb3JtYXQrKyApIHsNCiAgICAgICAgICAgICAgICBpZiAoIGxpdGVyYWwgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggZm9ybWF0LmNoYXJBdCggaUZvcm1hdCApID09PSAiJyIgJiYgIWxvb2tBaGVhZCggIiciICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsaXRlcmFsID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjaGFycyArPSBmb3JtYXQuY2hhckF0KCBpRm9ybWF0ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCBmb3JtYXQuY2hhckF0KCBpRm9ybWF0ICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJkIjogY2FzZSAibSI6IGNhc2UgInkiOiBjYXNlICJAIjoNCiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJzICs9ICIwMTIzNDU2Nzg5IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiRCI6IGNhc2UgIk0iOg0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vIEFjY2VwdCBhbnl0aGluZw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiJyI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBsb29rQWhlYWQoICInIiApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFycyArPSAiJyI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGl0ZXJhbCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFycyArPSBmb3JtYXQuY2hhckF0KCBpRm9ybWF0ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gY2hhcnM7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogR2V0IGEgc2V0dGluZyB2YWx1ZSwgZGVmYXVsdGluZyBpZiBuZWNlc3NhcnkuICovDQogICAgICAgIF9nZXQ6IGZ1bmN0aW9uKCBpbnN0LCBuYW1lICkgew0KICAgICAgICAgICAgcmV0dXJuIGluc3Quc2V0dGluZ3NbIG5hbWUgXSAhPT0gdW5kZWZpbmVkID8NCiAgICAgICAgICAgICAgICBpbnN0LnNldHRpbmdzWyBuYW1lIF0gOiB0aGlzLl9kZWZhdWx0c1sgbmFtZSBdOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qIFBhcnNlIGV4aXN0aW5nIGRhdGUgYW5kIGluaXRpYWxpc2UgZGF0ZSBwaWNrZXIuICovDQogICAgICAgIF9zZXREYXRlRnJvbUZpZWxkOiBmdW5jdGlvbiggaW5zdCwgbm9EZWZhdWx0ICkgew0KICAgICAgICAgICAgaWYgKCBpbnN0LmlucHV0LnZhbCgpID09PSBpbnN0Lmxhc3RWYWwgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgZGF0ZUZvcm1hdCA9IHRoaXMuX2dldCggaW5zdCwgImRhdGVGb3JtYXQiICksDQogICAgICAgICAgICAgICAgZGF0ZXMgPSBpbnN0Lmxhc3RWYWwgPSBpbnN0LmlucHV0ID8gaW5zdC5pbnB1dC52YWwoKSA6IG51bGwsDQogICAgICAgICAgICAgICAgZGVmYXVsdERhdGUgPSB0aGlzLl9nZXREZWZhdWx0RGF0ZSggaW5zdCApLA0KICAgICAgICAgICAgICAgIGRhdGUgPSBkZWZhdWx0RGF0ZSwNCiAgICAgICAgICAgICAgICBzZXR0aW5ncyA9IHRoaXMuX2dldEZvcm1hdENvbmZpZyggaW5zdCApOw0KDQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIGRhdGUgPSB0aGlzLnBhcnNlRGF0ZSggZGF0ZUZvcm1hdCwgZGF0ZXMsIHNldHRpbmdzICkgfHwgZGVmYXVsdERhdGU7DQogICAgICAgICAgICB9IGNhdGNoICggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgZGF0ZXMgPSAoIG5vRGVmYXVsdCA/ICIiIDogZGF0ZXMgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGluc3Quc2VsZWN0ZWREYXkgPSBkYXRlLmdldERhdGUoKTsNCiAgICAgICAgICAgIGluc3QuZHJhd01vbnRoID0gaW5zdC5zZWxlY3RlZE1vbnRoID0gZGF0ZS5nZXRNb250aCgpOw0KICAgICAgICAgICAgaW5zdC5kcmF3WWVhciA9IGluc3Quc2VsZWN0ZWRZZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgaW5zdC5jdXJyZW50RGF5ID0gKCBkYXRlcyA/IGRhdGUuZ2V0RGF0ZSgpIDogMCApOw0KICAgICAgICAgICAgaW5zdC5jdXJyZW50TW9udGggPSAoIGRhdGVzID8gZGF0ZS5nZXRNb250aCgpIDogMCApOw0KICAgICAgICAgICAgaW5zdC5jdXJyZW50WWVhciA9ICggZGF0ZXMgPyBkYXRlLmdldEZ1bGxZZWFyKCkgOiAwICk7DQogICAgICAgICAgICB0aGlzLl9hZGp1c3RJbnN0RGF0ZSggaW5zdCApOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qIFJldHJpZXZlIHRoZSBkZWZhdWx0IGRhdGUgc2hvd24gb24gb3BlbmluZy4gKi8NCiAgICAgICAgX2dldERlZmF1bHREYXRlOiBmdW5jdGlvbiggaW5zdCApIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZXN0cmljdE1pbk1heCggaW5zdCwNCiAgICAgICAgICAgICAgICB0aGlzLl9kZXRlcm1pbmVEYXRlKCBpbnN0LCB0aGlzLl9nZXQoIGluc3QsICJkZWZhdWx0RGF0ZSIgKSwgbmV3IERhdGUoKSApICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogQSBkYXRlIG1heSBiZSBzcGVjaWZpZWQgYXMgYW4gZXhhY3QgdmFsdWUgb3IgYSByZWxhdGl2ZSBvbmUuICovDQogICAgICAgIF9kZXRlcm1pbmVEYXRlOiBmdW5jdGlvbiggaW5zdCwgZGF0ZSwgZGVmYXVsdERhdGUgKSB7DQogICAgICAgICAgICB2YXIgb2Zmc2V0TnVtZXJpYyA9IGZ1bmN0aW9uKCBvZmZzZXQgKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTsNCiAgICAgICAgICAgICAgICAgICAgZGF0ZS5zZXREYXRlKCBkYXRlLmdldERhdGUoKSArIG9mZnNldCApOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9mZnNldFN0cmluZyA9IGZ1bmN0aW9uKCBvZmZzZXQgKSB7DQogICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJC5kYXRlcGlja2VyLnBhcnNlRGF0ZSggJC5kYXRlcGlja2VyLl9nZXQoIGluc3QsICJkYXRlRm9ybWF0IiApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCwgJC5kYXRlcGlja2VyLl9nZXRGb3JtYXRDb25maWcoIGluc3QgKSApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGNhdGNoICggZSApIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlDQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICB2YXIgZGF0ZSA9ICggb2Zmc2V0LnRvTG93ZXJDYXNlKCkubWF0Y2goIC9eYy8gKSA/DQogICAgICAgICAgICAgICAgICAgICAgICAkLmRhdGVwaWNrZXIuX2dldERhdGUoIGluc3QgKSA6IG51bGwgKSB8fCBuZXcgRGF0ZSgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGF5ID0gZGF0ZS5nZXREYXRlKCksDQogICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gLyhbK1wtXT9bMC05XSspXHMqKGR8RHx3fFd8bXxNfHl8WSk/L2csDQogICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVzID0gcGF0dGVybi5leGVjKCBvZmZzZXQgKTsNCg0KICAgICAgICAgICAgICAgICAgICB3aGlsZSAoIG1hdGNoZXMgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCBtYXRjaGVzWyAyIF0gfHwgImQiICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImQiIDogY2FzZSAiRCIgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheSArPSBwYXJzZUludCggbWF0Y2hlc1sgMSBdLCAxMCApOyBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJ3IiA6IGNhc2UgIlciIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXkgKz0gcGFyc2VJbnQoIG1hdGNoZXNbIDEgXSwgMTAgKSAqIDc7IGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIm0iIDogY2FzZSAiTSIgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoICs9IHBhcnNlSW50KCBtYXRjaGVzWyAxIF0sIDEwICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5ID0gTWF0aC5taW4oIGRheSwgJC5kYXRlcGlja2VyLl9nZXREYXlzSW5Nb250aCggeWVhciwgbW9udGggKSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgInkiOiBjYXNlICJZIiA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhciArPSBwYXJzZUludCggbWF0Y2hlc1sgMSBdLCAxMCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheSA9IE1hdGgubWluKCBkYXksICQuZGF0ZXBpY2tlci5fZ2V0RGF5c0luTW9udGgoIHllYXIsIG1vbnRoICkgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXMgPSBwYXR0ZXJuLmV4ZWMoIG9mZnNldCApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSggeWVhciwgbW9udGgsIGRheSApOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgbmV3RGF0ZSA9ICggZGF0ZSA9PSBudWxsIHx8IGRhdGUgPT09ICIiID8gZGVmYXVsdERhdGUgOiAoIHR5cGVvZiBkYXRlID09PSAic3RyaW5nIiA/IG9mZnNldFN0cmluZyggZGF0ZSApIDoNCiAgICAgICAgICAgICAgICAgICAgKCB0eXBlb2YgZGF0ZSA9PT0gIm51bWJlciIgPyAoIGlzTmFOKCBkYXRlICkgPyBkZWZhdWx0RGF0ZSA6IG9mZnNldE51bWVyaWMoIGRhdGUgKSApIDogbmV3IERhdGUoIGRhdGUuZ2V0VGltZSgpICkgKSApICk7DQoNCiAgICAgICAgICAgIG5ld0RhdGUgPSAoIG5ld0RhdGUgJiYgbmV3RGF0ZS50b1N0cmluZygpID09PSAiSW52YWxpZCBEYXRlIiA/IGRlZmF1bHREYXRlIDogbmV3RGF0ZSApOw0KICAgICAgICAgICAgaWYgKCBuZXdEYXRlICkgew0KICAgICAgICAgICAgICAgIG5ld0RhdGUuc2V0SG91cnMoIDAgKTsNCiAgICAgICAgICAgICAgICBuZXdEYXRlLnNldE1pbnV0ZXMoIDAgKTsNCiAgICAgICAgICAgICAgICBuZXdEYXRlLnNldFNlY29uZHMoIDAgKTsNCiAgICAgICAgICAgICAgICBuZXdEYXRlLnNldE1pbGxpc2Vjb25kcyggMCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KCBuZXdEYXRlICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogSGFuZGxlIHN3aXRjaCB0by9mcm9tIGRheWxpZ2h0IHNhdmluZy4NCgkgKiBIb3VycyBtYXkgYmUgbm9uLXplcm8gb24gZGF5bGlnaHQgc2F2aW5nIGN1dC1vdmVyOg0KCSAqID4gMTIgd2hlbiBtaWRuaWdodCBjaGFuZ2VvdmVyLCBidXQgdGhlbiBjYW5ub3QgZ2VuZXJhdGUNCgkgKiBtaWRuaWdodCBkYXRldGltZSwgc28ganVtcCB0byAxQU0sIG90aGVyd2lzZSByZXNldC4NCgkgKiBAcGFyYW0gIGRhdGUgIChEYXRlKSB0aGUgZGF0ZSB0byBjaGVjaw0KCSAqIEByZXR1cm4gIChEYXRlKSB0aGUgY29ycmVjdGVkIGRhdGUNCgkgKi8NCiAgICAgICAgX2RheWxpZ2h0U2F2aW5nQWRqdXN0OiBmdW5jdGlvbiggZGF0ZSApIHsNCiAgICAgICAgICAgIGlmICggIWRhdGUgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBkYXRlLnNldEhvdXJzKCBkYXRlLmdldEhvdXJzKCkgPiAxMiA/IGRhdGUuZ2V0SG91cnMoKSArIDIgOiAwICk7DQogICAgICAgICAgICByZXR1cm4gZGF0ZTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBTZXQgdGhlIGRhdGUocykgZGlyZWN0bHkuICovDQogICAgICAgIF9zZXREYXRlOiBmdW5jdGlvbiggaW5zdCwgZGF0ZSwgbm9DaGFuZ2UgKSB7DQogICAgICAgICAgICB2YXIgY2xlYXIgPSAhZGF0ZSwNCiAgICAgICAgICAgICAgICBvcmlnTW9udGggPSBpbnN0LnNlbGVjdGVkTW9udGgsDQogICAgICAgICAgICAgICAgb3JpZ1llYXIgPSBpbnN0LnNlbGVjdGVkWWVhciwNCiAgICAgICAgICAgICAgICBuZXdEYXRlID0gdGhpcy5fcmVzdHJpY3RNaW5NYXgoIGluc3QsIHRoaXMuX2RldGVybWluZURhdGUoIGluc3QsIGRhdGUsIG5ldyBEYXRlKCkgKSApOw0KDQogICAgICAgICAgICBpbnN0LnNlbGVjdGVkRGF5ID0gaW5zdC5jdXJyZW50RGF5ID0gbmV3RGF0ZS5nZXREYXRlKCk7DQogICAgICAgICAgICBpbnN0LmRyYXdNb250aCA9IGluc3Quc2VsZWN0ZWRNb250aCA9IGluc3QuY3VycmVudE1vbnRoID0gbmV3RGF0ZS5nZXRNb250aCgpOw0KICAgICAgICAgICAgaW5zdC5kcmF3WWVhciA9IGluc3Quc2VsZWN0ZWRZZWFyID0gaW5zdC5jdXJyZW50WWVhciA9IG5ld0RhdGUuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgIGlmICggKCBvcmlnTW9udGggIT09IGluc3Quc2VsZWN0ZWRNb250aCB8fCBvcmlnWWVhciAhPT0gaW5zdC5zZWxlY3RlZFllYXIgKSAmJiAhbm9DaGFuZ2UgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fbm90aWZ5Q2hhbmdlKCBpbnN0ICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLl9hZGp1c3RJbnN0RGF0ZSggaW5zdCApOw0KICAgICAgICAgICAgaWYgKCBpbnN0LmlucHV0ICkgew0KICAgICAgICAgICAgICAgIGluc3QuaW5wdXQudmFsKCBjbGVhciA/ICIiIDogdGhpcy5fZm9ybWF0RGF0ZSggaW5zdCApICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogUmV0cmlldmUgdGhlIGRhdGUocykgZGlyZWN0bHkuICovDQogICAgICAgIF9nZXREYXRlOiBmdW5jdGlvbiggaW5zdCApIHsNCiAgICAgICAgICAgIHZhciBzdGFydERhdGUgPSAoICFpbnN0LmN1cnJlbnRZZWFyIHx8ICggaW5zdC5pbnB1dCAmJiBpbnN0LmlucHV0LnZhbCgpID09PSAiIiApID8gbnVsbCA6DQogICAgICAgICAgICAgICAgdGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QoIG5ldyBEYXRlKA0KICAgICAgICAgICAgICAgICAgICBpbnN0LmN1cnJlbnRZZWFyLCBpbnN0LmN1cnJlbnRNb250aCwgaW5zdC5jdXJyZW50RGF5ICkgKSApOw0KICAgICAgICAgICAgcmV0dXJuIHN0YXJ0RGF0ZTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBBdHRhY2ggdGhlIG9ueHh4IGhhbmRsZXJzLiAgVGhlc2UgYXJlIGRlY2xhcmVkIHN0YXRpY2FsbHkgc28NCgkgKiB0aGV5IHdvcmsgd2l0aCBzdGF0aWMgY29kZSB0cmFuc2Zvcm1lcnMgbGlrZSBDYWphLg0KCSAqLw0KICAgICAgICBfYXR0YWNoSGFuZGxlcnM6IGZ1bmN0aW9uKCBpbnN0ICkgew0KICAgICAgICAgICAgdmFyIHN0ZXBNb250aHMgPSB0aGlzLl9nZXQoIGluc3QsICJzdGVwTW9udGhzIiApLA0KICAgICAgICAgICAgICAgIGlkID0gIiMiICsgaW5zdC5pZC5yZXBsYWNlKCAvXFxcXC9nLCAiXFwiICk7DQogICAgICAgICAgICBpbnN0LmRwRGl2LmZpbmQoICJbZGF0YS1oYW5kbGVyXSIgKS5tYXAoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciBoYW5kbGVyID0gew0KICAgICAgICAgICAgICAgICAgICBwcmV2OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fYWRqdXN0RGF0ZSggaWQsIC1zdGVwTW9udGhzLCAiTSIgKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkLmRhdGVwaWNrZXIuX2FkanVzdERhdGUoIGlkLCArc3RlcE1vbnRocywgIk0iICk7DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIGhpZGU6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlcigpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICB0b2RheTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkLmRhdGVwaWNrZXIuX2dvdG9Ub2RheSggaWQgKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0RGF5OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fc2VsZWN0RGF5KCBpZCwgK3RoaXMuZ2V0QXR0cmlidXRlKCAiZGF0YS1tb250aCIgKSwgK3RoaXMuZ2V0QXR0cmlidXRlKCAiZGF0YS15ZWFyIiApLCB0aGlzICk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIHNlbGVjdE1vbnRoOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fc2VsZWN0TW9udGhZZWFyKCBpZCwgdGhpcywgIk0iICk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIHNlbGVjdFllYXI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgJC5kYXRlcGlja2VyLl9zZWxlY3RNb250aFllYXIoIGlkLCB0aGlzLCAiWSIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgJCggdGhpcyApLm9uKCB0aGlzLmdldEF0dHJpYnV0ZSggImRhdGEtZXZlbnQiICksIGhhbmRsZXJbIHRoaXMuZ2V0QXR0cmlidXRlKCAiZGF0YS1oYW5kbGVyIiApIF0gKTsNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBHZW5lcmF0ZSB0aGUgSFRNTCBmb3IgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIGRhdGUgcGlja2VyLiAqLw0KICAgICAgICBfZ2VuZXJhdGVIVE1MOiBmdW5jdGlvbiggaW5zdCApIHsNCiAgICAgICAgICAgIHZhciBtYXhEcmF3LCBwcmV2VGV4dCwgcHJldiwgbmV4dFRleHQsIG5leHQsIGN1cnJlbnRUZXh0LCBnb3RvRGF0ZSwNCiAgICAgICAgICAgICAgICBjb250cm9scywgYnV0dG9uUGFuZWwsIGZpcnN0RGF5LCBzaG93V2VlaywgZGF5TmFtZXMsIGRheU5hbWVzTWluLA0KICAgICAgICAgICAgICAgIG1vbnRoTmFtZXMsIG1vbnRoTmFtZXNTaG9ydCwgYmVmb3JlU2hvd0RheSwgc2hvd090aGVyTW9udGhzLA0KICAgICAgICAgICAgICAgIHNlbGVjdE90aGVyTW9udGhzLCBkZWZhdWx0RGF0ZSwgaHRtbCwgZG93LCByb3csIGdyb3VwLCBjb2wsIHNlbGVjdGVkRGF0ZSwNCiAgICAgICAgICAgICAgICBjb3JuZXJDbGFzcywgY2FsZW5kZXIsIHRoZWFkLCBkYXksIGRheXNJbk1vbnRoLCBsZWFkRGF5cywgY3VyUm93cywgbnVtUm93cywNCiAgICAgICAgICAgICAgICBwcmludERhdGUsIGRSb3csIHRib2R5LCBkYXlTZXR0aW5ncywgb3RoZXJNb250aCwgdW5zZWxlY3RhYmxlLA0KICAgICAgICAgICAgICAgIHRlbXBEYXRlID0gbmV3IERhdGUoKSwNCiAgICAgICAgICAgICAgICB0b2RheSA9IHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KA0KICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZSggdGVtcERhdGUuZ2V0RnVsbFllYXIoKSwgdGVtcERhdGUuZ2V0TW9udGgoKSwgdGVtcERhdGUuZ2V0RGF0ZSgpICkgKSwgLy8gY2xlYXIgdGltZQ0KICAgICAgICAgICAgICAgIGlzUlRMID0gdGhpcy5fZ2V0KCBpbnN0LCAiaXNSVEwiICksDQogICAgICAgICAgICAgICAgc2hvd0J1dHRvblBhbmVsID0gdGhpcy5fZ2V0KCBpbnN0LCAic2hvd0J1dHRvblBhbmVsIiApLA0KICAgICAgICAgICAgICAgIGhpZGVJZk5vUHJldk5leHQgPSB0aGlzLl9nZXQoIGluc3QsICJoaWRlSWZOb1ByZXZOZXh0IiApLA0KICAgICAgICAgICAgICAgIG5hdmlnYXRpb25Bc0RhdGVGb3JtYXQgPSB0aGlzLl9nZXQoIGluc3QsICJuYXZpZ2F0aW9uQXNEYXRlRm9ybWF0IiApLA0KICAgICAgICAgICAgICAgIG51bU1vbnRocyA9IHRoaXMuX2dldE51bWJlck9mTW9udGhzKCBpbnN0ICksDQogICAgICAgICAgICAgICAgc2hvd0N1cnJlbnRBdFBvcyA9IHRoaXMuX2dldCggaW5zdCwgInNob3dDdXJyZW50QXRQb3MiICksDQogICAgICAgICAgICAgICAgc3RlcE1vbnRocyA9IHRoaXMuX2dldCggaW5zdCwgInN0ZXBNb250aHMiICksDQogICAgICAgICAgICAgICAgaXNNdWx0aU1vbnRoID0gKCBudW1Nb250aHNbIDAgXSAhPT0gMSB8fCBudW1Nb250aHNbIDEgXSAhPT0gMSApLA0KICAgICAgICAgICAgICAgIGN1cnJlbnREYXRlID0gdGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QoICggIWluc3QuY3VycmVudERheSA/IG5ldyBEYXRlKCA5OTk5LCA5LCA5ICkgOg0KICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZSggaW5zdC5jdXJyZW50WWVhciwgaW5zdC5jdXJyZW50TW9udGgsIGluc3QuY3VycmVudERheSApICkgKSwNCiAgICAgICAgICAgICAgICBtaW5EYXRlID0gdGhpcy5fZ2V0TWluTWF4RGF0ZSggaW5zdCwgIm1pbiIgKSwNCiAgICAgICAgICAgICAgICBtYXhEYXRlID0gdGhpcy5fZ2V0TWluTWF4RGF0ZSggaW5zdCwgIm1heCIgKSwNCiAgICAgICAgICAgICAgICBkcmF3TW9udGggPSBpbnN0LmRyYXdNb250aCAtIHNob3dDdXJyZW50QXRQb3MsDQogICAgICAgICAgICAgICAgZHJhd1llYXIgPSBpbnN0LmRyYXdZZWFyOw0KDQogICAgICAgICAgICBpZiAoIGRyYXdNb250aCA8IDAgKSB7DQogICAgICAgICAgICAgICAgZHJhd01vbnRoICs9IDEyOw0KICAgICAgICAgICAgICAgIGRyYXdZZWFyLS07DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIG1heERhdGUgKSB7DQogICAgICAgICAgICAgICAgbWF4RHJhdyA9IHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KCBuZXcgRGF0ZSggbWF4RGF0ZS5nZXRGdWxsWWVhcigpLA0KICAgICAgICAgICAgICAgICAgICBtYXhEYXRlLmdldE1vbnRoKCkgLSAoIG51bU1vbnRoc1sgMCBdICogbnVtTW9udGhzWyAxIF0gKSArIDEsIG1heERhdGUuZ2V0RGF0ZSgpICkgKTsNCiAgICAgICAgICAgICAgICBtYXhEcmF3ID0gKCBtaW5EYXRlICYmIG1heERyYXcgPCBtaW5EYXRlID8gbWluRGF0ZSA6IG1heERyYXcgKTsNCiAgICAgICAgICAgICAgICB3aGlsZSAoIHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KCBuZXcgRGF0ZSggZHJhd1llYXIsIGRyYXdNb250aCwgMSApICkgPiBtYXhEcmF3ICkgew0KICAgICAgICAgICAgICAgICAgICBkcmF3TW9udGgtLTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBkcmF3TW9udGggPCAwICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZHJhd01vbnRoID0gMTE7DQogICAgICAgICAgICAgICAgICAgICAgICBkcmF3WWVhci0tOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaW5zdC5kcmF3TW9udGggPSBkcmF3TW9udGg7DQogICAgICAgICAgICBpbnN0LmRyYXdZZWFyID0gZHJhd1llYXI7DQoNCiAgICAgICAgICAgIHByZXZUZXh0ID0gdGhpcy5fZ2V0KCBpbnN0LCAicHJldlRleHQiICk7DQogICAgICAgICAgICBwcmV2VGV4dCA9ICggIW5hdmlnYXRpb25Bc0RhdGVGb3JtYXQgPyBwcmV2VGV4dCA6IHRoaXMuZm9ybWF0RGF0ZSggcHJldlRleHQsDQogICAgICAgICAgICAgICAgdGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QoIG5ldyBEYXRlKCBkcmF3WWVhciwgZHJhd01vbnRoIC0gc3RlcE1vbnRocywgMSApICksDQogICAgICAgICAgICAgICAgdGhpcy5fZ2V0Rm9ybWF0Q29uZmlnKCBpbnN0ICkgKSApOw0KDQogICAgICAgICAgICBwcmV2ID0gKCB0aGlzLl9jYW5BZGp1c3RNb250aCggaW5zdCwgLTEsIGRyYXdZZWFyLCBkcmF3TW9udGggKSA/DQogICAgICAgICAgICAgICAgIjxhIGNsYXNzPSd1aS1kYXRlcGlja2VyLXByZXYgdWktY29ybmVyLWFsbCcgZGF0YS1oYW5kbGVyPSdwcmV2JyBkYXRhLWV2ZW50PSdjbGljayciICsNCiAgICAgICAgICAgICAgICAiIHRpdGxlPSciICsgcHJldlRleHQgKyAiJz48c3BhbiBjbGFzcz0ndWktaWNvbiB1aS1pY29uLWNpcmNsZS10cmlhbmdsZS0iICsgKCBpc1JUTCA/ICJlIiA6ICJ3IiApICsgIic+IiArIHByZXZUZXh0ICsgIjwvc3Bhbj48L2E+IiA6DQogICAgICAgICAgICAgICAgKCBoaWRlSWZOb1ByZXZOZXh0ID8gIiIgOiAiPGEgY2xhc3M9J3VpLWRhdGVwaWNrZXItcHJldiB1aS1jb3JuZXItYWxsIHVpLXN0YXRlLWRpc2FibGVkJyB0aXRsZT0nIiArIHByZXZUZXh0ICsgIic+PHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtIiArICggaXNSVEwgPyAiZSIgOiAidyIgKSArICInPiIgKyBwcmV2VGV4dCArICI8L3NwYW4+PC9hPiIgKSApOw0KDQogICAgICAgICAgICBuZXh0VGV4dCA9IHRoaXMuX2dldCggaW5zdCwgIm5leHRUZXh0IiApOw0KICAgICAgICAgICAgbmV4dFRleHQgPSAoICFuYXZpZ2F0aW9uQXNEYXRlRm9ybWF0ID8gbmV4dFRleHQgOiB0aGlzLmZvcm1hdERhdGUoIG5leHRUZXh0LA0KICAgICAgICAgICAgICAgIHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KCBuZXcgRGF0ZSggZHJhd1llYXIsIGRyYXdNb250aCArIHN0ZXBNb250aHMsIDEgKSApLA0KICAgICAgICAgICAgICAgIHRoaXMuX2dldEZvcm1hdENvbmZpZyggaW5zdCApICkgKTsNCg0KICAgICAgICAgICAgbmV4dCA9ICggdGhpcy5fY2FuQWRqdXN0TW9udGgoIGluc3QsICsxLCBkcmF3WWVhciwgZHJhd01vbnRoICkgPw0KICAgICAgICAgICAgICAgICI8YSBjbGFzcz0ndWktZGF0ZXBpY2tlci1uZXh0IHVpLWNvcm5lci1hbGwnIGRhdGEtaGFuZGxlcj0nbmV4dCcgZGF0YS1ldmVudD0nY2xpY2snIiArDQogICAgICAgICAgICAgICAgIiB0aXRsZT0nIiArIG5leHRUZXh0ICsgIic+PHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtIiArICggaXNSVEwgPyAidyIgOiAiZSIgKSArICInPiIgKyBuZXh0VGV4dCArICI8L3NwYW4+PC9hPiIgOg0KICAgICAgICAgICAgICAgICggaGlkZUlmTm9QcmV2TmV4dCA/ICIiIDogIjxhIGNsYXNzPSd1aS1kYXRlcGlja2VyLW5leHQgdWktY29ybmVyLWFsbCB1aS1zdGF0ZS1kaXNhYmxlZCcgdGl0bGU9JyIgKyBuZXh0VGV4dCArICInPjxzcGFuIGNsYXNzPSd1aS1pY29uIHVpLWljb24tY2lyY2xlLXRyaWFuZ2xlLSIgKyAoIGlzUlRMID8gInciIDogImUiICkgKyAiJz4iICsgbmV4dFRleHQgKyAiPC9zcGFuPjwvYT4iICkgKTsNCg0KICAgICAgICAgICAgY3VycmVudFRleHQgPSB0aGlzLl9nZXQoIGluc3QsICJjdXJyZW50VGV4dCIgKTsNCiAgICAgICAgICAgIGdvdG9EYXRlID0gKCB0aGlzLl9nZXQoIGluc3QsICJnb3RvQ3VycmVudCIgKSAmJiBpbnN0LmN1cnJlbnREYXkgPyBjdXJyZW50RGF0ZSA6IHRvZGF5ICk7DQogICAgICAgICAgICBjdXJyZW50VGV4dCA9ICggIW5hdmlnYXRpb25Bc0RhdGVGb3JtYXQgPyBjdXJyZW50VGV4dCA6DQogICAgICAgICAgICAgICAgdGhpcy5mb3JtYXREYXRlKCBjdXJyZW50VGV4dCwgZ290b0RhdGUsIHRoaXMuX2dldEZvcm1hdENvbmZpZyggaW5zdCApICkgKTsNCg0KICAgICAgICAgICAgY29udHJvbHMgPSAoICFpbnN0LmlubGluZSA/ICI8YnV0dG9uIHR5cGU9J2J1dHRvbicgY2xhc3M9J3VpLWRhdGVwaWNrZXItY2xvc2UgdWktc3RhdGUtZGVmYXVsdCB1aS1wcmlvcml0eS1wcmltYXJ5IHVpLWNvcm5lci1hbGwnIGRhdGEtaGFuZGxlcj0naGlkZScgZGF0YS1ldmVudD0nY2xpY2snPiIgKw0KICAgICAgICAgICAgICAgIHRoaXMuX2dldCggaW5zdCwgImNsb3NlVGV4dCIgKSArICI8L2J1dHRvbj4iIDogIiIgKTsNCg0KICAgICAgICAgICAgYnV0dG9uUGFuZWwgPSAoIHNob3dCdXR0b25QYW5lbCApID8gIjxkaXYgY2xhc3M9J3VpLWRhdGVwaWNrZXItYnV0dG9ucGFuZSB1aS13aWRnZXQtY29udGVudCc+IiArICggaXNSVEwgPyBjb250cm9scyA6ICIiICkgKw0KICAgICAgICAgICAgICAgICggdGhpcy5faXNJblJhbmdlKCBpbnN0LCBnb3RvRGF0ZSApID8gIjxidXR0b24gdHlwZT0nYnV0dG9uJyBjbGFzcz0ndWktZGF0ZXBpY2tlci1jdXJyZW50IHVpLXN0YXRlLWRlZmF1bHQgdWktcHJpb3JpdHktc2Vjb25kYXJ5IHVpLWNvcm5lci1hbGwnIGRhdGEtaGFuZGxlcj0ndG9kYXknIGRhdGEtZXZlbnQ9J2NsaWNrJyIgKw0KICAgICAgICAgICAgICAgICAgICAiPiIgKyBjdXJyZW50VGV4dCArICI8L2J1dHRvbj4iIDogIiIgKSArICggaXNSVEwgPyAiIiA6IGNvbnRyb2xzICkgKyAiPC9kaXY+IiA6ICIiOw0KDQogICAgICAgICAgICBmaXJzdERheSA9IHBhcnNlSW50KCB0aGlzLl9nZXQoIGluc3QsICJmaXJzdERheSIgKSwgMTAgKTsNCiAgICAgICAgICAgIGZpcnN0RGF5ID0gKCBpc05hTiggZmlyc3REYXkgKSA/IDAgOiBmaXJzdERheSApOw0KDQogICAgICAgICAgICBzaG93V2VlayA9IHRoaXMuX2dldCggaW5zdCwgInNob3dXZWVrIiApOw0KICAgICAgICAgICAgZGF5TmFtZXMgPSB0aGlzLl9nZXQoIGluc3QsICJkYXlOYW1lcyIgKTsNCiAgICAgICAgICAgIGRheU5hbWVzTWluID0gdGhpcy5fZ2V0KCBpbnN0LCAiZGF5TmFtZXNNaW4iICk7DQogICAgICAgICAgICBtb250aE5hbWVzID0gdGhpcy5fZ2V0KCBpbnN0LCAibW9udGhOYW1lcyIgKTsNCiAgICAgICAgICAgIG1vbnRoTmFtZXNTaG9ydCA9IHRoaXMuX2dldCggaW5zdCwgIm1vbnRoTmFtZXNTaG9ydCIgKTsNCiAgICAgICAgICAgIGJlZm9yZVNob3dEYXkgPSB0aGlzLl9nZXQoIGluc3QsICJiZWZvcmVTaG93RGF5IiApOw0KICAgICAgICAgICAgc2hvd090aGVyTW9udGhzID0gdGhpcy5fZ2V0KCBpbnN0LCAic2hvd090aGVyTW9udGhzIiApOw0KICAgICAgICAgICAgc2VsZWN0T3RoZXJNb250aHMgPSB0aGlzLl9nZXQoIGluc3QsICJzZWxlY3RPdGhlck1vbnRocyIgKTsNCiAgICAgICAgICAgIGRlZmF1bHREYXRlID0gdGhpcy5fZ2V0RGVmYXVsdERhdGUoIGluc3QgKTsNCiAgICAgICAgICAgIGh0bWwgPSAiIjsNCg0KICAgICAgICAgICAgZm9yICggcm93ID0gMDsgcm93IDwgbnVtTW9udGhzWyAwIF07IHJvdysrICkgew0KICAgICAgICAgICAgICAgIGdyb3VwID0gIiI7DQogICAgICAgICAgICAgICAgdGhpcy5tYXhSb3dzID0gNDsNCiAgICAgICAgICAgICAgICBmb3IgKCBjb2wgPSAwOyBjb2wgPCBudW1Nb250aHNbIDEgXTsgY29sKysgKSB7DQogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkRGF0ZSA9IHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KCBuZXcgRGF0ZSggZHJhd1llYXIsIGRyYXdNb250aCwgaW5zdC5zZWxlY3RlZERheSApICk7DQogICAgICAgICAgICAgICAgICAgIGNvcm5lckNsYXNzID0gIiB1aS1jb3JuZXItYWxsIjsNCiAgICAgICAgICAgICAgICAgICAgY2FsZW5kZXIgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBpc011bHRpTW9udGggKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjYWxlbmRlciArPSAiPGRpdiBjbGFzcz0ndWktZGF0ZXBpY2tlci1ncm91cCI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG51bU1vbnRoc1sgMSBdID4gMSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCBjb2wgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDogY2FsZW5kZXIgKz0gIiB1aS1kYXRlcGlja2VyLWdyb3VwLWZpcnN0IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcm5lckNsYXNzID0gIiB1aS1jb3JuZXItIiArICggaXNSVEwgPyAicmlnaHQiIDogImxlZnQiICk7IGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIG51bU1vbnRoc1sgMSBdIC0gMTogY2FsZW5kZXIgKz0gIiB1aS1kYXRlcGlja2VyLWdyb3VwLWxhc3QiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ybmVyQ2xhc3MgPSAiIHVpLWNvcm5lci0iICsgKCBpc1JUTCA/ICJsZWZ0IiA6ICJyaWdodCIgKTsgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGNhbGVuZGVyICs9ICIgdWktZGF0ZXBpY2tlci1ncm91cC1taWRkbGUiOyBjb3JuZXJDbGFzcyA9ICIiOyBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBjYWxlbmRlciArPSAiJz4iOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGNhbGVuZGVyICs9ICI8ZGl2IGNsYXNzPSd1aS1kYXRlcGlja2VyLWhlYWRlciB1aS13aWRnZXQtaGVhZGVyIHVpLWhlbHBlci1jbGVhcmZpeCIgKyBjb3JuZXJDbGFzcyArICInPiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgKCAvYWxsfGxlZnQvLnRlc3QoIGNvcm5lckNsYXNzICkgJiYgcm93ID09PSAwID8gKCBpc1JUTCA/IG5leHQgOiBwcmV2ICkgOiAiIiApICsNCiAgICAgICAgICAgICAgICAgICAgICAgICggL2FsbHxyaWdodC8udGVzdCggY29ybmVyQ2xhc3MgKSAmJiByb3cgPT09IDAgPyAoIGlzUlRMID8gcHJldiA6IG5leHQgKSA6ICIiICkgKw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZ2VuZXJhdGVNb250aFllYXJIZWFkZXIoIGluc3QsIGRyYXdNb250aCwgZHJhd1llYXIsIG1pbkRhdGUsIG1heERhdGUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93ID4gMCB8fCBjb2wgPiAwLCBtb250aE5hbWVzLCBtb250aE5hbWVzU2hvcnQgKSArIC8vIGRyYXcgbW9udGggaGVhZGVycw0KICAgICAgICAgICAgICAgICAgICAgICAgIjwvZGl2Pjx0YWJsZSBjbGFzcz0ndWktZGF0ZXBpY2tlci1jYWxlbmRhcic+PHRoZWFkPiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgIjx0cj4iOw0KICAgICAgICAgICAgICAgICAgICB0aGVhZCA9ICggc2hvd1dlZWsgPyAiPHRoIGNsYXNzPSd1aS1kYXRlcGlja2VyLXdlZWstY29sJz4iICsgdGhpcy5fZ2V0KCBpbnN0LCAid2Vla0hlYWRlciIgKSArICI8L3RoPiIgOiAiIiApOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKCBkb3cgPSAwOyBkb3cgPCA3OyBkb3crKyApIHsgLy8gZGF5cyBvZiB0aGUgd2Vlaw0KICAgICAgICAgICAgICAgICAgICAgICAgZGF5ID0gKCBkb3cgKyBmaXJzdERheSApICUgNzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoZWFkICs9ICI8dGggc2NvcGU9J2NvbCciICsgKCAoIGRvdyArIGZpcnN0RGF5ICsgNiApICUgNyA+PSA1ID8gIiBjbGFzcz0ndWktZGF0ZXBpY2tlci13ZWVrLWVuZCciIDogIiIgKSArICI+IiArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIjxzcGFuIHRpdGxlPSciICsgZGF5TmFtZXNbIGRheSBdICsgIic+IiArIGRheU5hbWVzTWluWyBkYXkgXSArICI8L3NwYW4+PC90aD4iOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGNhbGVuZGVyICs9IHRoZWFkICsgIjwvdHI+PC90aGVhZD48dGJvZHk+IjsNCiAgICAgICAgICAgICAgICAgICAgZGF5c0luTW9udGggPSB0aGlzLl9nZXREYXlzSW5Nb250aCggZHJhd1llYXIsIGRyYXdNb250aCApOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIGRyYXdZZWFyID09PSBpbnN0LnNlbGVjdGVkWWVhciAmJiBkcmF3TW9udGggPT09IGluc3Quc2VsZWN0ZWRNb250aCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGluc3Quc2VsZWN0ZWREYXkgPSBNYXRoLm1pbiggaW5zdC5zZWxlY3RlZERheSwgZGF5c0luTW9udGggKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBsZWFkRGF5cyA9ICggdGhpcy5fZ2V0Rmlyc3REYXlPZk1vbnRoKCBkcmF3WWVhciwgZHJhd01vbnRoICkgLSBmaXJzdERheSArIDcgKSAlIDc7DQogICAgICAgICAgICAgICAgICAgIGN1clJvd3MgPSBNYXRoLmNlaWwoICggbGVhZERheXMgKyBkYXlzSW5Nb250aCApIC8gNyApOyAvLyBjYWxjdWxhdGUgdGhlIG51bWJlciBvZiByb3dzIHRvIGdlbmVyYXRlDQogICAgICAgICAgICAgICAgICAgIG51bVJvd3MgPSAoIGlzTXVsdGlNb250aCA/IHRoaXMubWF4Um93cyA+IGN1clJvd3MgPyB0aGlzLm1heFJvd3MgOiBjdXJSb3dzIDogY3VyUm93cyApOyAvL0lmIG11bHRpcGxlIG1vbnRocywgdXNlIHRoZSBoaWdoZXIgbnVtYmVyIG9mIHJvd3MgKHNlZSAjNzA0MykNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXhSb3dzID0gbnVtUm93czsNCiAgICAgICAgICAgICAgICAgICAgcHJpbnREYXRlID0gdGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QoIG5ldyBEYXRlKCBkcmF3WWVhciwgZHJhd01vbnRoLCAxIC0gbGVhZERheXMgKSApOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKCBkUm93ID0gMDsgZFJvdyA8IG51bVJvd3M7IGRSb3crKyApIHsgLy8gY3JlYXRlIGRhdGUgcGlja2VyIHJvd3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGVuZGVyICs9ICI8dHI+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRib2R5ID0gKCAhc2hvd1dlZWsgPyAiIiA6ICI8dGQgY2xhc3M9J3VpLWRhdGVwaWNrZXItd2Vlay1jb2wnPiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2dldCggaW5zdCwgImNhbGN1bGF0ZVdlZWsiICkoIHByaW50RGF0ZSApICsgIjwvdGQ+IiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICggZG93ID0gMDsgZG93IDwgNzsgZG93KysgKSB7IC8vIGNyZWF0ZSBkYXRlIHBpY2tlciBkYXlzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5U2V0dGluZ3MgPSAoIGJlZm9yZVNob3dEYXkgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWZvcmVTaG93RGF5LmFwcGx5KCAoIGluc3QuaW5wdXQgPyBpbnN0LmlucHV0WyAwIF0gOiBudWxsICksIFsgcHJpbnREYXRlIF0gKSA6IFsgdHJ1ZSwgIiIgXSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG90aGVyTW9udGggPSAoIHByaW50RGF0ZS5nZXRNb250aCgpICE9PSBkcmF3TW9udGggKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNlbGVjdGFibGUgPSAoIG90aGVyTW9udGggJiYgIXNlbGVjdE90aGVyTW9udGhzICkgfHwgIWRheVNldHRpbmdzWyAwIF0gfHwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCBtaW5EYXRlICYmIHByaW50RGF0ZSA8IG1pbkRhdGUgKSB8fCAoIG1heERhdGUgJiYgcHJpbnREYXRlID4gbWF4RGF0ZSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRib2R5ICs9ICI8dGQgY2xhc3M9JyIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoICggZG93ICsgZmlyc3REYXkgKyA2ICkgJSA3ID49IDUgPyAiIHVpLWRhdGVwaWNrZXItd2Vlay1lbmQiIDogIiIgKSArIC8vIGhpZ2hsaWdodCB3ZWVrZW5kcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIG90aGVyTW9udGggPyAiIHVpLWRhdGVwaWNrZXItb3RoZXItbW9udGgiIDogIiIgKSArIC8vIGhpZ2hsaWdodCBkYXlzIGZyb20gb3RoZXIgbW9udGhzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICggKCBwcmludERhdGUuZ2V0VGltZSgpID09PSBzZWxlY3RlZERhdGUuZ2V0VGltZSgpICYmIGRyYXdNb250aCA9PT0gaW5zdC5zZWxlY3RlZE1vbnRoICYmIGluc3QuX2tleUV2ZW50ICkgfHwgLy8gdXNlciBwcmVzc2VkIGtleQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIGRlZmF1bHREYXRlLmdldFRpbWUoKSA9PT0gcHJpbnREYXRlLmdldFRpbWUoKSAmJiBkZWZhdWx0RGF0ZS5nZXRUaW1lKCkgPT09IHNlbGVjdGVkRGF0ZS5nZXRUaW1lKCkgKSA/DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9yIGRlZmF1bHREYXRlIGlzIGN1cnJlbnQgcHJpbnRlZERhdGUgYW5kIGRlZmF1bHREYXRlIGlzIHNlbGVjdGVkRGF0ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAiICsgdGhpcy5fZGF5T3ZlckNsYXNzIDogIiIgKSArIC8vIGhpZ2hsaWdodCBzZWxlY3RlZCBkYXkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCB1bnNlbGVjdGFibGUgPyAiICIgKyB0aGlzLl91bnNlbGVjdGFibGVDbGFzcyArICIgdWktc3RhdGUtZGlzYWJsZWQiIDogIiIgKSArICAvLyBoaWdobGlnaHQgdW5zZWxlY3RhYmxlIGRheXMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCBvdGhlck1vbnRoICYmICFzaG93T3RoZXJNb250aHMgPyAiIiA6ICIgIiArIGRheVNldHRpbmdzWyAxIF0gKyAvLyBoaWdobGlnaHQgY3VzdG9tIGRhdGVzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIHByaW50RGF0ZS5nZXRUaW1lKCkgPT09IGN1cnJlbnREYXRlLmdldFRpbWUoKSA/ICIgIiArIHRoaXMuX2N1cnJlbnRDbGFzcyA6ICIiICkgKyAvLyBoaWdobGlnaHQgc2VsZWN0ZWQgZGF5DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIHByaW50RGF0ZS5nZXRUaW1lKCkgPT09IHRvZGF5LmdldFRpbWUoKSA/ICIgdWktZGF0ZXBpY2tlci10b2RheSIgOiAiIiApICkgKyAiJyIgKyAvLyBoaWdobGlnaHQgdG9kYXkgKGlmIGRpZmZlcmVudCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCAoICFvdGhlck1vbnRoIHx8IHNob3dPdGhlck1vbnRocyApICYmIGRheVNldHRpbmdzWyAyIF0gPyAiIHRpdGxlPSciICsgZGF5U2V0dGluZ3NbIDIgXS5yZXBsYWNlKCAvJy9nLCAiJiMzOTsiICkgKyAiJyIgOiAiIiApICsgLy8gY2VsbCB0aXRsZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIHVuc2VsZWN0YWJsZSA/ICIiIDogIiBkYXRhLWhhbmRsZXI9J3NlbGVjdERheScgZGF0YS1ldmVudD0nY2xpY2snIGRhdGEtbW9udGg9JyIgKyBwcmludERhdGUuZ2V0TW9udGgoKSArICInIGRhdGEteWVhcj0nIiArIHByaW50RGF0ZS5nZXRGdWxsWWVhcigpICsgIiciICkgKyAiPiIgKyAvLyBhY3Rpb25zDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICggb3RoZXJNb250aCAmJiAhc2hvd090aGVyTW9udGhzID8gIiYjeGEwOyIgOiAvLyBkaXNwbGF5IGZvciBvdGhlciBtb250aHMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICggdW5zZWxlY3RhYmxlID8gIjxzcGFuIGNsYXNzPSd1aS1zdGF0ZS1kZWZhdWx0Jz4iICsgcHJpbnREYXRlLmdldERhdGUoKSArICI8L3NwYW4+IiA6ICI8YSBjbGFzcz0ndWktc3RhdGUtZGVmYXVsdCIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICggcHJpbnREYXRlLmdldFRpbWUoKSA9PT0gdG9kYXkuZ2V0VGltZSgpID8gIiB1aS1zdGF0ZS1oaWdobGlnaHQiIDogIiIgKSArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCBwcmludERhdGUuZ2V0VGltZSgpID09PSBjdXJyZW50RGF0ZS5nZXRUaW1lKCkgPyAiIHVpLXN0YXRlLWFjdGl2ZSIgOiAiIiApICsgLy8gaGlnaGxpZ2h0IHNlbGVjdGVkIGRheQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICggb3RoZXJNb250aCA/ICIgdWktcHJpb3JpdHktc2Vjb25kYXJ5IiA6ICIiICkgKyAvLyBkaXN0aW5ndWlzaCBkYXRlcyBmcm9tIG90aGVyIG1vbnRocw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICInIGhyZWY9JyMnPiIgKyBwcmludERhdGUuZ2V0RGF0ZSgpICsgIjwvYT4iICkgKSArICI8L3RkPiI7IC8vIGRpc3BsYXkgc2VsZWN0YWJsZSBkYXRlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnREYXRlLnNldERhdGUoIHByaW50RGF0ZS5nZXREYXRlKCkgKyAxICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnREYXRlID0gdGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QoIHByaW50RGF0ZSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgY2FsZW5kZXIgKz0gdGJvZHkgKyAiPC90cj4iOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGRyYXdNb250aCsrOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIGRyYXdNb250aCA+IDExICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZHJhd01vbnRoID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRyYXdZZWFyKys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgY2FsZW5kZXIgKz0gIjwvdGJvZHk+PC90YWJsZT4iICsgKCBpc011bHRpTW9udGggPyAiPC9kaXY+IiArDQogICAgICAgICAgICAgICAgICAgICAgICAoICggbnVtTW9udGhzWyAwIF0gPiAwICYmIGNvbCA9PT0gbnVtTW9udGhzWyAxIF0gLSAxICkgPyAiPGRpdiBjbGFzcz0ndWktZGF0ZXBpY2tlci1yb3ctYnJlYWsnPjwvZGl2PiIgOiAiIiApIDogIiIgKTsNCiAgICAgICAgICAgICAgICAgICAgZ3JvdXAgKz0gY2FsZW5kZXI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGh0bWwgKz0gZ3JvdXA7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBodG1sICs9IGJ1dHRvblBhbmVsOw0KICAgICAgICAgICAgaW5zdC5fa2V5RXZlbnQgPSBmYWxzZTsNCiAgICAgICAgICAgIHJldHVybiBodG1sOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qIEdlbmVyYXRlIHRoZSBtb250aCBhbmQgeWVhciBoZWFkZXIuICovDQogICAgICAgIF9nZW5lcmF0ZU1vbnRoWWVhckhlYWRlcjogZnVuY3Rpb24oIGluc3QsIGRyYXdNb250aCwgZHJhd1llYXIsIG1pbkRhdGUsIG1heERhdGUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZGFyeSwgbW9udGhOYW1lcywgbW9udGhOYW1lc1Nob3J0ICkgew0KDQogICAgICAgICAgICB2YXIgaW5NaW5ZZWFyLCBpbk1heFllYXIsIG1vbnRoLCB5ZWFycywgdGhpc1llYXIsIGRldGVybWluZVllYXIsIHllYXIsIGVuZFllYXIsDQogICAgICAgICAgICAgICAgY2hhbmdlTW9udGggPSB0aGlzLl9nZXQoIGluc3QsICJjaGFuZ2VNb250aCIgKSwNCiAgICAgICAgICAgICAgICBjaGFuZ2VZZWFyID0gdGhpcy5fZ2V0KCBpbnN0LCAiY2hhbmdlWWVhciIgKSwNCiAgICAgICAgICAgICAgICBzaG93TW9udGhBZnRlclllYXIgPSB0aGlzLl9nZXQoIGluc3QsICJzaG93TW9udGhBZnRlclllYXIiICksDQogICAgICAgICAgICAgICAgaHRtbCA9ICI8ZGl2IGNsYXNzPSd1aS1kYXRlcGlja2VyLXRpdGxlJz4iLA0KICAgICAgICAgICAgICAgIG1vbnRoSHRtbCA9ICIiOw0KDQogICAgICAgICAgICAvLyBNb250aCBzZWxlY3Rpb24NCiAgICAgICAgICAgIGlmICggc2Vjb25kYXJ5IHx8ICFjaGFuZ2VNb250aCApIHsNCiAgICAgICAgICAgICAgICBtb250aEh0bWwgKz0gIjxzcGFuIGNsYXNzPSd1aS1kYXRlcGlja2VyLW1vbnRoJz4iICsgbW9udGhOYW1lc1sgZHJhd01vbnRoIF0gKyAiPC9zcGFuPiI7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGluTWluWWVhciA9ICggbWluRGF0ZSAmJiBtaW5EYXRlLmdldEZ1bGxZZWFyKCkgPT09IGRyYXdZZWFyICk7DQogICAgICAgICAgICAgICAgaW5NYXhZZWFyID0gKCBtYXhEYXRlICYmIG1heERhdGUuZ2V0RnVsbFllYXIoKSA9PT0gZHJhd1llYXIgKTsNCiAgICAgICAgICAgICAgICBtb250aEh0bWwgKz0gIjxzZWxlY3QgY2xhc3M9J3VpLWRhdGVwaWNrZXItbW9udGgnIGRhdGEtaGFuZGxlcj0nc2VsZWN0TW9udGgnIGRhdGEtZXZlbnQ9J2NoYW5nZSc+IjsNCiAgICAgICAgICAgICAgICBmb3IgKCBtb250aCA9IDA7IG1vbnRoIDwgMTI7IG1vbnRoKysgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggKCAhaW5NaW5ZZWFyIHx8IG1vbnRoID49IG1pbkRhdGUuZ2V0TW9udGgoKSApICYmICggIWluTWF4WWVhciB8fCBtb250aCA8PSBtYXhEYXRlLmdldE1vbnRoKCkgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoSHRtbCArPSAiPG9wdGlvbiB2YWx1ZT0nIiArIG1vbnRoICsgIiciICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIG1vbnRoID09PSBkcmF3TW9udGggPyAiIHNlbGVjdGVkPSdzZWxlY3RlZCciIDogIiIgKSArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIj4iICsgbW9udGhOYW1lc1Nob3J0WyBtb250aCBdICsgIjwvb3B0aW9uPiI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgbW9udGhIdG1sICs9ICI8L3NlbGVjdD4iOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoICFzaG93TW9udGhBZnRlclllYXIgKSB7DQogICAgICAgICAgICAgICAgaHRtbCArPSBtb250aEh0bWwgKyAoIHNlY29uZGFyeSB8fCAhKCBjaGFuZ2VNb250aCAmJiBjaGFuZ2VZZWFyICkgPyAiJiN4YTA7IiA6ICIiICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFllYXIgc2VsZWN0aW9uDQogICAgICAgICAgICBpZiAoICFpbnN0LnllYXJzaHRtbCApIHsNCiAgICAgICAgICAgICAgICBpbnN0LnllYXJzaHRtbCA9ICIiOw0KICAgICAgICAgICAgICAgIGlmICggc2Vjb25kYXJ5IHx8ICFjaGFuZ2VZZWFyICkgew0KICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8c3BhbiBjbGFzcz0ndWktZGF0ZXBpY2tlci15ZWFyJz4iICsgZHJhd1llYXIgKyAiPC9zcGFuPiI7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBkZXRlcm1pbmUgcmFuZ2Ugb2YgeWVhcnMgdG8gZGlzcGxheQ0KICAgICAgICAgICAgICAgICAgICB5ZWFycyA9IHRoaXMuX2dldCggaW5zdCwgInllYXJSYW5nZSIgKS5zcGxpdCggIjoiICk7DQogICAgICAgICAgICAgICAgICAgIHRoaXNZZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgICAgICAgICBkZXRlcm1pbmVZZWFyID0gZnVuY3Rpb24oIHZhbHVlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHllYXIgPSAoIHZhbHVlLm1hdGNoKCAvY1srXC1dLiovICkgPyBkcmF3WWVhciArIHBhcnNlSW50KCB2YWx1ZS5zdWJzdHJpbmcoIDEgKSwgMTAgKSA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKCB2YWx1ZS5tYXRjaCggL1srXC1dLiovICkgPyB0aGlzWWVhciArIHBhcnNlSW50KCB2YWx1ZSwgMTAgKSA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KCB2YWx1ZSwgMTAgKSApICk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCBpc05hTiggeWVhciApID8gdGhpc1llYXIgOiB5ZWFyICk7DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIHllYXIgPSBkZXRlcm1pbmVZZWFyKCB5ZWFyc1sgMCBdICk7DQogICAgICAgICAgICAgICAgICAgIGVuZFllYXIgPSBNYXRoLm1heCggeWVhciwgZGV0ZXJtaW5lWWVhciggeWVhcnNbIDEgXSB8fCAiIiApICk7DQogICAgICAgICAgICAgICAgICAgIHllYXIgPSAoIG1pbkRhdGUgPyBNYXRoLm1heCggeWVhciwgbWluRGF0ZS5nZXRGdWxsWWVhcigpICkgOiB5ZWFyICk7DQogICAgICAgICAgICAgICAgICAgIGVuZFllYXIgPSAoIG1heERhdGUgPyBNYXRoLm1pbiggZW5kWWVhciwgbWF4RGF0ZS5nZXRGdWxsWWVhcigpICkgOiBlbmRZZWFyICk7DQogICAgICAgICAgICAgICAgICAgIGluc3QueWVhcnNodG1sICs9ICI8c2VsZWN0IGNsYXNzPSd1aS1kYXRlcGlja2VyLXllYXInIGRhdGEtaGFuZGxlcj0nc2VsZWN0WWVhcicgZGF0YS1ldmVudD0nY2hhbmdlJz4iOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKCA7IHllYXIgPD0gZW5kWWVhcjsgeWVhcisrICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaW5zdC55ZWFyc2h0bWwgKz0gIjxvcHRpb24gdmFsdWU9JyIgKyB5ZWFyICsgIiciICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIHllYXIgPT09IGRyYXdZZWFyID8gIiBzZWxlY3RlZD0nc2VsZWN0ZWQnIiA6ICIiICkgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICI+IiArIHllYXIgKyAiPC9vcHRpb24+IjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpbnN0LnllYXJzaHRtbCArPSAiPC9zZWxlY3Q+IjsNCg0KICAgICAgICAgICAgICAgICAgICBodG1sICs9IGluc3QueWVhcnNodG1sOw0KICAgICAgICAgICAgICAgICAgICBpbnN0LnllYXJzaHRtbCA9IG51bGw7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBodG1sICs9IHRoaXMuX2dldCggaW5zdCwgInllYXJTdWZmaXgiICk7DQogICAgICAgICAgICBpZiAoIHNob3dNb250aEFmdGVyWWVhciApIHsNCiAgICAgICAgICAgICAgICBodG1sICs9ICggc2Vjb25kYXJ5IHx8ICEoIGNoYW5nZU1vbnRoICYmIGNoYW5nZVllYXIgKSA/ICImI3hhMDsiIDogIiIgKSArIG1vbnRoSHRtbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGh0bWwgKz0gIjwvZGl2PiI7IC8vIENsb3NlIGRhdGVwaWNrZXJfaGVhZGVyDQogICAgICAgICAgICByZXR1cm4gaHRtbDsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBBZGp1c3Qgb25lIG9mIHRoZSBkYXRlIHN1Yi1maWVsZHMuICovDQogICAgICAgIF9hZGp1c3RJbnN0RGF0ZTogZnVuY3Rpb24oIGluc3QsIG9mZnNldCwgcGVyaW9kICkgew0KICAgICAgICAgICAgdmFyIHllYXIgPSBpbnN0LnNlbGVjdGVkWWVhciArICggcGVyaW9kID09PSAiWSIgPyBvZmZzZXQgOiAwICksDQogICAgICAgICAgICAgICAgbW9udGggPSBpbnN0LnNlbGVjdGVkTW9udGggKyAoIHBlcmlvZCA9PT0gIk0iID8gb2Zmc2V0IDogMCApLA0KICAgICAgICAgICAgICAgIGRheSA9IE1hdGgubWluKCBpbnN0LnNlbGVjdGVkRGF5LCB0aGlzLl9nZXREYXlzSW5Nb250aCggeWVhciwgbW9udGggKSApICsgKCBwZXJpb2QgPT09ICJEIiA/IG9mZnNldCA6IDAgKSwNCiAgICAgICAgICAgICAgICBkYXRlID0gdGhpcy5fcmVzdHJpY3RNaW5NYXgoIGluc3QsIHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KCBuZXcgRGF0ZSggeWVhciwgbW9udGgsIGRheSApICkgKTsNCg0KICAgICAgICAgICAgaW5zdC5zZWxlY3RlZERheSA9IGRhdGUuZ2V0RGF0ZSgpOw0KICAgICAgICAgICAgaW5zdC5kcmF3TW9udGggPSBpbnN0LnNlbGVjdGVkTW9udGggPSBkYXRlLmdldE1vbnRoKCk7DQogICAgICAgICAgICBpbnN0LmRyYXdZZWFyID0gaW5zdC5zZWxlY3RlZFllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICBpZiAoIHBlcmlvZCA9PT0gIk0iIHx8IHBlcmlvZCA9PT0gIlkiICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX25vdGlmeUNoYW5nZSggaW5zdCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIC8qIEVuc3VyZSBhIGRhdGUgaXMgd2l0aGluIGFueSBtaW4vbWF4IGJvdW5kcy4gKi8NCiAgICAgICAgX3Jlc3RyaWN0TWluTWF4OiBmdW5jdGlvbiggaW5zdCwgZGF0ZSApIHsNCiAgICAgICAgICAgIHZhciBtaW5EYXRlID0gdGhpcy5fZ2V0TWluTWF4RGF0ZSggaW5zdCwgIm1pbiIgKSwNCiAgICAgICAgICAgICAgICBtYXhEYXRlID0gdGhpcy5fZ2V0TWluTWF4RGF0ZSggaW5zdCwgIm1heCIgKSwNCiAgICAgICAgICAgICAgICBuZXdEYXRlID0gKCBtaW5EYXRlICYmIGRhdGUgPCBtaW5EYXRlID8gbWluRGF0ZSA6IGRhdGUgKTsNCiAgICAgICAgICAgIHJldHVybiAoIG1heERhdGUgJiYgbmV3RGF0ZSA+IG1heERhdGUgPyBtYXhEYXRlIDogbmV3RGF0ZSApOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qIE5vdGlmeSBjaGFuZ2Ugb2YgbW9udGgveWVhci4gKi8NCiAgICAgICAgX25vdGlmeUNoYW5nZTogZnVuY3Rpb24oIGluc3QgKSB7DQogICAgICAgICAgICB2YXIgb25DaGFuZ2UgPSB0aGlzLl9nZXQoIGluc3QsICJvbkNoYW5nZU1vbnRoWWVhciIgKTsNCiAgICAgICAgICAgIGlmICggb25DaGFuZ2UgKSB7DQogICAgICAgICAgICAgICAgb25DaGFuZ2UuYXBwbHkoICggaW5zdC5pbnB1dCA/IGluc3QuaW5wdXRbIDAgXSA6IG51bGwgKSwNCiAgICAgICAgICAgICAgICAgICAgWyBpbnN0LnNlbGVjdGVkWWVhciwgaW5zdC5zZWxlY3RlZE1vbnRoICsgMSwgaW5zdCBdICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogRGV0ZXJtaW5lIHRoZSBudW1iZXIgb2YgbW9udGhzIHRvIHNob3cuICovDQogICAgICAgIF9nZXROdW1iZXJPZk1vbnRoczogZnVuY3Rpb24oIGluc3QgKSB7DQogICAgICAgICAgICB2YXIgbnVtTW9udGhzID0gdGhpcy5fZ2V0KCBpbnN0LCAibnVtYmVyT2ZNb250aHMiICk7DQogICAgICAgICAgICByZXR1cm4gKCBudW1Nb250aHMgPT0gbnVsbCA/IFsgMSwgMSBdIDogKCB0eXBlb2YgbnVtTW9udGhzID09PSAibnVtYmVyIiA/IFsgMSwgbnVtTW9udGhzIF0gOiBudW1Nb250aHMgKSApOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qIERldGVybWluZSB0aGUgY3VycmVudCBtYXhpbXVtIGRhdGUgLSBlbnN1cmUgbm8gdGltZSBjb21wb25lbnRzIGFyZSBzZXQuICovDQogICAgICAgIF9nZXRNaW5NYXhEYXRlOiBmdW5jdGlvbiggaW5zdCwgbWluTWF4ICkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RldGVybWluZURhdGUoIGluc3QsIHRoaXMuX2dldCggaW5zdCwgbWluTWF4ICsgIkRhdGUiICksIG51bGwgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBGaW5kIHRoZSBudW1iZXIgb2YgZGF5cyBpbiBhIGdpdmVuIG1vbnRoLiAqLw0KICAgICAgICBfZ2V0RGF5c0luTW9udGg6IGZ1bmN0aW9uKCB5ZWFyLCBtb250aCApIHsNCiAgICAgICAgICAgIHJldHVybiAzMiAtIHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KCBuZXcgRGF0ZSggeWVhciwgbW9udGgsIDMyICkgKS5nZXREYXRlKCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogRmluZCB0aGUgZGF5IG9mIHRoZSB3ZWVrIG9mIHRoZSBmaXJzdCBvZiBhIG1vbnRoLiAqLw0KICAgICAgICBfZ2V0Rmlyc3REYXlPZk1vbnRoOiBmdW5jdGlvbiggeWVhciwgbW9udGggKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoIHllYXIsIG1vbnRoLCAxICkuZ2V0RGF5KCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogRGV0ZXJtaW5lcyBpZiB3ZSBzaG91bGQgYWxsb3cgYSAibmV4dC9wcmV2IiBtb250aCBkaXNwbGF5IGNoYW5nZS4gKi8NCiAgICAgICAgX2NhbkFkanVzdE1vbnRoOiBmdW5jdGlvbiggaW5zdCwgb2Zmc2V0LCBjdXJZZWFyLCBjdXJNb250aCApIHsNCiAgICAgICAgICAgIHZhciBudW1Nb250aHMgPSB0aGlzLl9nZXROdW1iZXJPZk1vbnRocyggaW5zdCApLA0KICAgICAgICAgICAgICAgIGRhdGUgPSB0aGlzLl9kYXlsaWdodFNhdmluZ0FkanVzdCggbmV3IERhdGUoIGN1clllYXIsDQogICAgICAgICAgICAgICAgICAgIGN1ck1vbnRoICsgKCBvZmZzZXQgPCAwID8gb2Zmc2V0IDogbnVtTW9udGhzWyAwIF0gKiBudW1Nb250aHNbIDEgXSApLCAxICkgKTsNCg0KICAgICAgICAgICAgaWYgKCBvZmZzZXQgPCAwICkgew0KICAgICAgICAgICAgICAgIGRhdGUuc2V0RGF0ZSggdGhpcy5fZ2V0RGF5c0luTW9udGgoIGRhdGUuZ2V0RnVsbFllYXIoKSwgZGF0ZS5nZXRNb250aCgpICkgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc0luUmFuZ2UoIGluc3QsIGRhdGUgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBJcyB0aGUgZ2l2ZW4gZGF0ZSBpbiB0aGUgYWNjZXB0ZWQgcmFuZ2U/ICovDQogICAgICAgIF9pc0luUmFuZ2U6IGZ1bmN0aW9uKCBpbnN0LCBkYXRlICkgew0KICAgICAgICAgICAgdmFyIHllYXJTcGxpdCwgY3VycmVudFllYXIsDQogICAgICAgICAgICAgICAgbWluRGF0ZSA9IHRoaXMuX2dldE1pbk1heERhdGUoIGluc3QsICJtaW4iICksDQogICAgICAgICAgICAgICAgbWF4RGF0ZSA9IHRoaXMuX2dldE1pbk1heERhdGUoIGluc3QsICJtYXgiICksDQogICAgICAgICAgICAgICAgbWluWWVhciA9IG51bGwsDQogICAgICAgICAgICAgICAgbWF4WWVhciA9IG51bGwsDQogICAgICAgICAgICAgICAgeWVhcnMgPSB0aGlzLl9nZXQoIGluc3QsICJ5ZWFyUmFuZ2UiICk7DQogICAgICAgICAgICBpZiAoIHllYXJzICkgew0KICAgICAgICAgICAgICAgIHllYXJTcGxpdCA9IHllYXJzLnNwbGl0KCAiOiIgKTsNCiAgICAgICAgICAgICAgICBjdXJyZW50WWVhciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICBtaW5ZZWFyID0gcGFyc2VJbnQoIHllYXJTcGxpdFsgMCBdLCAxMCApOw0KICAgICAgICAgICAgICAgIG1heFllYXIgPSBwYXJzZUludCggeWVhclNwbGl0WyAxIF0sIDEwICk7DQogICAgICAgICAgICAgICAgaWYgKCB5ZWFyU3BsaXRbIDAgXS5tYXRjaCggL1srXC1dLiovICkgKSB7DQogICAgICAgICAgICAgICAgICAgIG1pblllYXIgKz0gY3VycmVudFllYXI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICggeWVhclNwbGl0WyAxIF0ubWF0Y2goIC9bK1wtXS4qLyApICkgew0KICAgICAgICAgICAgICAgICAgICBtYXhZZWFyICs9IGN1cnJlbnRZZWFyOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICggKCAhbWluRGF0ZSB8fCBkYXRlLmdldFRpbWUoKSA+PSBtaW5EYXRlLmdldFRpbWUoKSApICYmDQogICAgICAgICAgICAgICAgKCAhbWF4RGF0ZSB8fCBkYXRlLmdldFRpbWUoKSA8PSBtYXhEYXRlLmdldFRpbWUoKSApICYmDQogICAgICAgICAgICAgICAgKCAhbWluWWVhciB8fCBkYXRlLmdldEZ1bGxZZWFyKCkgPj0gbWluWWVhciApICYmDQogICAgICAgICAgICAgICAgKCAhbWF4WWVhciB8fCBkYXRlLmdldEZ1bGxZZWFyKCkgPD0gbWF4WWVhciApICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyogUHJvdmlkZSB0aGUgY29uZmlndXJhdGlvbiBzZXR0aW5ncyBmb3IgZm9ybWF0dGluZy9wYXJzaW5nLiAqLw0KICAgICAgICBfZ2V0Rm9ybWF0Q29uZmlnOiBmdW5jdGlvbiggaW5zdCApIHsNCiAgICAgICAgICAgIHZhciBzaG9ydFllYXJDdXRvZmYgPSB0aGlzLl9nZXQoIGluc3QsICJzaG9ydFllYXJDdXRvZmYiICk7DQogICAgICAgICAgICBzaG9ydFllYXJDdXRvZmYgPSAoIHR5cGVvZiBzaG9ydFllYXJDdXRvZmYgIT09ICJzdHJpbmciID8gc2hvcnRZZWFyQ3V0b2ZmIDoNCiAgICAgICAgICAgICAgICBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkgJSAxMDAgKyBwYXJzZUludCggc2hvcnRZZWFyQ3V0b2ZmLCAxMCApICk7DQogICAgICAgICAgICByZXR1cm4geyBzaG9ydFllYXJDdXRvZmY6IHNob3J0WWVhckN1dG9mZiwNCiAgICAgICAgICAgICAgICBkYXlOYW1lc1Nob3J0OiB0aGlzLl9nZXQoIGluc3QsICJkYXlOYW1lc1Nob3J0IiApLCBkYXlOYW1lczogdGhpcy5fZ2V0KCBpbnN0LCAiZGF5TmFtZXMiICksDQogICAgICAgICAgICAgICAgbW9udGhOYW1lc1Nob3J0OiB0aGlzLl9nZXQoIGluc3QsICJtb250aE5hbWVzU2hvcnQiICksIG1vbnRoTmFtZXM6IHRoaXMuX2dldCggaW5zdCwgIm1vbnRoTmFtZXMiICkgfTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKiBGb3JtYXQgdGhlIGdpdmVuIGRhdGUgZm9yIGRpc3BsYXkuICovDQogICAgICAgIF9mb3JtYXREYXRlOiBmdW5jdGlvbiggaW5zdCwgZGF5LCBtb250aCwgeWVhciApIHsNCiAgICAgICAgICAgIGlmICggIWRheSApIHsNCiAgICAgICAgICAgICAgICBpbnN0LmN1cnJlbnREYXkgPSBpbnN0LnNlbGVjdGVkRGF5Ow0KICAgICAgICAgICAgICAgIGluc3QuY3VycmVudE1vbnRoID0gaW5zdC5zZWxlY3RlZE1vbnRoOw0KICAgICAgICAgICAgICAgIGluc3QuY3VycmVudFllYXIgPSBpbnN0LnNlbGVjdGVkWWVhcjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBkYXRlID0gKCBkYXkgPyAoIHR5cGVvZiBkYXkgPT09ICJvYmplY3QiID8gZGF5IDoNCiAgICAgICAgICAgICAgICB0aGlzLl9kYXlsaWdodFNhdmluZ0FkanVzdCggbmV3IERhdGUoIHllYXIsIG1vbnRoLCBkYXkgKSApICkgOg0KICAgICAgICAgICAgICAgIHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KCBuZXcgRGF0ZSggaW5zdC5jdXJyZW50WWVhciwgaW5zdC5jdXJyZW50TW9udGgsIGluc3QuY3VycmVudERheSApICkgKTsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLmZvcm1hdERhdGUoIHRoaXMuX2dldCggaW5zdCwgImRhdGVGb3JtYXQiICksIGRhdGUsIHRoaXMuX2dldEZvcm1hdENvbmZpZyggaW5zdCApICk7DQogICAgICAgIH0NCiAgICB9ICk7DQoNCiAgICAvKg0KICogQmluZCBob3ZlciBldmVudHMgZm9yIGRhdGVwaWNrZXIgZWxlbWVudHMuDQogKiBEb25lIHZpYSBkZWxlZ2F0ZSBzbyB0aGUgYmluZGluZyBvbmx5IG9jY3VycyBvbmNlIGluIHRoZSBsaWZldGltZSBvZiB0aGUgcGFyZW50IGRpdi4NCiAqIEdsb2JhbCBkYXRlcGlja2VyX2luc3RBY3RpdmUsIHNldCBieSBfdXBkYXRlRGF0ZXBpY2tlciBhbGxvd3MgdGhlIGhhbmRsZXJzIHRvIGZpbmQgdGhlaXIgd2F5IGJhY2sgdG8gdGhlIGFjdGl2ZSBwaWNrZXIuDQogKi8NCiAgICBmdW5jdGlvbiBkYXRlcGlja2VyX2JpbmRIb3ZlciggZHBEaXYgKSB7DQogICAgICAgIHZhciBzZWxlY3RvciA9ICJidXR0b24sIC51aS1kYXRlcGlja2VyLXByZXYsIC51aS1kYXRlcGlja2VyLW5leHQsIC51aS1kYXRlcGlja2VyLWNhbGVuZGFyIHRkIGEiOw0KICAgICAgICByZXR1cm4gZHBEaXYub24oICJtb3VzZW91dCIsIHNlbGVjdG9yLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICQoIHRoaXMgKS5yZW1vdmVDbGFzcyggInVpLXN0YXRlLWhvdmVyIiApOw0KICAgICAgICAgICAgaWYgKCB0aGlzLmNsYXNzTmFtZS5pbmRleE9mKCAidWktZGF0ZXBpY2tlci1wcmV2IiApICE9PSAtMSApIHsNCiAgICAgICAgICAgICAgICAkKCB0aGlzICkucmVtb3ZlQ2xhc3MoICJ1aS1kYXRlcGlja2VyLXByZXYtaG92ZXIiICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIHRoaXMuY2xhc3NOYW1lLmluZGV4T2YoICJ1aS1kYXRlcGlja2VyLW5leHQiICkgIT09IC0xICkgew0KICAgICAgICAgICAgICAgICQoIHRoaXMgKS5yZW1vdmVDbGFzcyggInVpLWRhdGVwaWNrZXItbmV4dC1ob3ZlciIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSApDQogICAgICAgICAgICAub24oICJtb3VzZW92ZXIiLCBzZWxlY3RvciwgZGF0ZXBpY2tlcl9oYW5kbGVNb3VzZW92ZXIgKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBkYXRlcGlja2VyX2hhbmRsZU1vdXNlb3ZlcigpIHsNCiAgICAgICAgaWYgKCAhJC5kYXRlcGlja2VyLl9pc0Rpc2FibGVkRGF0ZXBpY2tlciggZGF0ZXBpY2tlcl9pbnN0QWN0aXZlLmlubGluZSA/IGRhdGVwaWNrZXJfaW5zdEFjdGl2ZS5kcERpdi5wYXJlbnQoKVsgMCBdIDogZGF0ZXBpY2tlcl9pbnN0QWN0aXZlLmlucHV0WyAwIF0gKSApIHsNCiAgICAgICAgICAgICQoIHRoaXMgKS5wYXJlbnRzKCAiLnVpLWRhdGVwaWNrZXItY2FsZW5kYXIiICkuZmluZCggImEiICkucmVtb3ZlQ2xhc3MoICJ1aS1zdGF0ZS1ob3ZlciIgKTsNCiAgICAgICAgICAgICQoIHRoaXMgKS5hZGRDbGFzcyggInVpLXN0YXRlLWhvdmVyIiApOw0KICAgICAgICAgICAgaWYgKCB0aGlzLmNsYXNzTmFtZS5pbmRleE9mKCAidWktZGF0ZXBpY2tlci1wcmV2IiApICE9PSAtMSApIHsNCiAgICAgICAgICAgICAgICAkKCB0aGlzICkuYWRkQ2xhc3MoICJ1aS1kYXRlcGlja2VyLXByZXYtaG92ZXIiICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIHRoaXMuY2xhc3NOYW1lLmluZGV4T2YoICJ1aS1kYXRlcGlja2VyLW5leHQiICkgIT09IC0xICkgew0KICAgICAgICAgICAgICAgICQoIHRoaXMgKS5hZGRDbGFzcyggInVpLWRhdGVwaWNrZXItbmV4dC1ob3ZlciIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qIGpRdWVyeSBleHRlbmQgbm93IGlnbm9yZXMgbnVsbHMhICovDQogICAgZnVuY3Rpb24gZGF0ZXBpY2tlcl9leHRlbmRSZW1vdmUoIHRhcmdldCwgcHJvcHMgKSB7DQogICAgICAgICQuZXh0ZW5kKCB0YXJnZXQsIHByb3BzICk7DQogICAgICAgIGZvciAoIHZhciBuYW1lIGluIHByb3BzICkgew0KICAgICAgICAgICAgaWYgKCBwcm9wc1sgbmFtZSBdID09IG51bGwgKSB7DQogICAgICAgICAgICAgICAgdGFyZ2V0WyBuYW1lIF0gPSBwcm9wc1sgbmFtZSBdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0YXJnZXQ7DQogICAgfQ0KDQogICAgLyogSW52b2tlIHRoZSBkYXRlcGlja2VyIGZ1bmN0aW9uYWxpdHkuDQogICBAcGFyYW0gIG9wdGlvbnMgIHN0cmluZyAtIGEgY29tbWFuZCwgb3B0aW9uYWxseSBmb2xsb3dlZCBieSBhZGRpdGlvbmFsIHBhcmFtZXRlcnMgb3INCgkJCQkJT2JqZWN0IC0gc2V0dGluZ3MgZm9yIGF0dGFjaGluZyBuZXcgZGF0ZXBpY2tlciBmdW5jdGlvbmFsaXR5DQogICBAcmV0dXJuICBqUXVlcnkgb2JqZWN0ICovDQogICAgJC5mbi5kYXRlcGlja2VyID0gZnVuY3Rpb24oIG9wdGlvbnMgKSB7DQoNCiAgICAgICAgLyogVmVyaWZ5IGFuIGVtcHR5IGNvbGxlY3Rpb24gd2Fzbid0IHBhc3NlZCAtIEZpeGVzICM2OTc2ICovDQogICAgICAgIGlmICggIXRoaXMubGVuZ3RoICkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgIH0NCg0KICAgICAgICAvKiBJbml0aWFsaXNlIHRoZSBkYXRlIHBpY2tlci4gKi8NCiAgICAgICAgaWYgKCAhJC5kYXRlcGlja2VyLmluaXRpYWxpemVkICkgew0KICAgICAgICAgICAgJCggZG9jdW1lbnQgKS5vbiggIm1vdXNlZG93biIsICQuZGF0ZXBpY2tlci5fY2hlY2tFeHRlcm5hbENsaWNrICk7DQogICAgICAgICAgICAkLmRhdGVwaWNrZXIuaW5pdGlhbGl6ZWQgPSB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgLyogQXBwZW5kIGRhdGVwaWNrZXIgbWFpbiBjb250YWluZXIgdG8gYm9keSBpZiBub3QgZXhpc3QuICovDQogICAgICAgIGlmICggJCggIiMiICsgJC5kYXRlcGlja2VyLl9tYWluRGl2SWQgKS5sZW5ndGggPT09IDAgKSB7DQogICAgICAgICAgICAkKCAiYm9keSIgKS5hcHBlbmQoICQuZGF0ZXBpY2tlci5kcERpdiApOw0KICAgICAgICB9DQoNCiAgICAgICAgdmFyIG90aGVyQXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKCBhcmd1bWVudHMsIDEgKTsNCiAgICAgICAgaWYgKCB0eXBlb2Ygb3B0aW9ucyA9PT0gInN0cmluZyIgJiYgKCBvcHRpb25zID09PSAiaXNEaXNhYmxlZCIgfHwgb3B0aW9ucyA9PT0gImdldERhdGUiIHx8IG9wdGlvbnMgPT09ICJ3aWRnZXQiICkgKSB7DQogICAgICAgICAgICByZXR1cm4gJC5kYXRlcGlja2VyWyAiXyIgKyBvcHRpb25zICsgIkRhdGVwaWNrZXIiIF0uDQogICAgICAgICAgICBhcHBseSggJC5kYXRlcGlja2VyLCBbIHRoaXNbIDAgXSBdLmNvbmNhdCggb3RoZXJBcmdzICkgKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIG9wdGlvbnMgPT09ICJvcHRpb24iICYmIGFyZ3VtZW50cy5sZW5ndGggPT09IDIgJiYgdHlwZW9mIGFyZ3VtZW50c1sgMSBdID09PSAic3RyaW5nIiApIHsNCiAgICAgICAgICAgIHJldHVybiAkLmRhdGVwaWNrZXJbICJfIiArIG9wdGlvbnMgKyAiRGF0ZXBpY2tlciIgXS4NCiAgICAgICAgICAgIGFwcGx5KCAkLmRhdGVwaWNrZXIsIFsgdGhpc1sgMCBdIF0uY29uY2F0KCBvdGhlckFyZ3MgKSApOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdHlwZW9mIG9wdGlvbnMgPT09ICJzdHJpbmciID8NCiAgICAgICAgICAgICAgICAkLmRhdGVwaWNrZXJbICJfIiArIG9wdGlvbnMgKyAiRGF0ZXBpY2tlciIgXS4NCiAgICAgICAgICAgICAgICBhcHBseSggJC5kYXRlcGlja2VyLCBbIHRoaXMgXS5jb25jYXQoIG90aGVyQXJncyApICkgOg0KICAgICAgICAgICAgICAgICQuZGF0ZXBpY2tlci5fYXR0YWNoRGF0ZXBpY2tlciggdGhpcywgb3B0aW9ucyApOw0KICAgICAgICB9ICk7DQogICAgfTsNCg0KICAgICQuZGF0ZXBpY2tlciA9IG5ldyBEYXRlcGlja2VyKCk7IC8vIHNpbmdsZXRvbiBpbnN0YW5jZQ0KICAgICQuZGF0ZXBpY2tlci5pbml0aWFsaXplZCA9IGZhbHNlOw0KICAgICQuZGF0ZXBpY2tlci51dWlkID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7DQogICAgJC5kYXRlcGlja2VyLnZlcnNpb24gPSAiMS4xMi4xIjsNCg0KICAgIHZhciB3aWRnZXRzRGF0ZXBpY2tlciA9ICQuZGF0ZXBpY2tlcjsNCg0KDQoNCg0KLy8gVGhpcyBmaWxlIGlzIGRlcHJlY2F0ZWQNCiAgICB2YXIgaWUgPSAkLnVpLmllID0gISEvbXNpZSBbXHcuXSsvLmV4ZWMoIG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSApOw0KDQogICAgLyohDQogKiBqUXVlcnkgVUkgTW91c2UgMS4xMi4xDQogKiBodHRwOi8vanF1ZXJ5dWkuY29tDQogKg0KICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMNCiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UNCiAqLw0KDQovLz4+bGFiZWw6IE1vdXNlDQovLz4+Z3JvdXA6IFdpZGdldHMNCi8vPj5kZXNjcmlwdGlvbjogQWJzdHJhY3RzIG1vdXNlLWJhc2VkIGludGVyYWN0aW9ucyB0byBhc3Npc3QgaW4gY3JlYXRpbmcgY2VydGFpbiB3aWRnZXRzLg0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL21vdXNlLw0KDQoNCg0KICAgIHZhciBtb3VzZUhhbmRsZWQgPSBmYWxzZTsNCiAgICAkKCBkb2N1bWVudCApLm9uKCAibW91c2V1cCIsIGZ1bmN0aW9uKCkgew0KICAgICAgICBtb3VzZUhhbmRsZWQgPSBmYWxzZTsNCiAgICB9ICk7DQoNCiAgICB2YXIgd2lkZ2V0c01vdXNlID0gJC53aWRnZXQoICJ1aS5tb3VzZSIsIHsNCiAgICAgICAgdmVyc2lvbjogIjEuMTIuMSIsDQogICAgICAgIG9wdGlvbnM6IHsNCiAgICAgICAgICAgIGNhbmNlbDogImlucHV0LCB0ZXh0YXJlYSwgYnV0dG9uLCBzZWxlY3QsIG9wdGlvbiIsDQogICAgICAgICAgICBkaXN0YW5jZTogMSwNCiAgICAgICAgICAgIGRlbGF5OiAwDQogICAgICAgIH0sDQogICAgICAgIF9tb3VzZUluaXQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KDQogICAgICAgICAgICB0aGlzLmVsZW1lbnQNCiAgICAgICAgICAgICAgICAub24oICJtb3VzZWRvd24uIiArIHRoaXMud2lkZ2V0TmFtZSwgZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhhdC5fbW91c2VEb3duKCBldmVudCApOw0KICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgIC5vbiggImNsaWNrLiIgKyB0aGlzLndpZGdldE5hbWUsIGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0cnVlID09PSAkLmRhdGEoIGV2ZW50LnRhcmdldCwgdGhhdC53aWRnZXROYW1lICsgIi5wcmV2ZW50Q2xpY2tFdmVudCIgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQucmVtb3ZlRGF0YSggZXZlbnQudGFyZ2V0LCB0aGF0LndpZGdldE5hbWUgKyAiLnByZXZlbnRDbGlja0V2ZW50IiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlOw0KICAgICAgICB9LA0KDQogICAgICAgIC8vIFRPRE86IG1ha2Ugc3VyZSBkZXN0cm95aW5nIG9uZSBpbnN0YW5jZSBvZiBtb3VzZSBkb2Vzbid0IG1lc3Mgd2l0aA0KICAgICAgICAvLyBvdGhlciBpbnN0YW5jZXMgb2YgbW91c2UNCiAgICAgICAgX21vdXNlRGVzdHJveTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLmVsZW1lbnQub2ZmKCAiLiIgKyB0aGlzLndpZGdldE5hbWUgKTsNCiAgICAgICAgICAgIGlmICggdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudA0KICAgICAgICAgICAgICAgICAgICAub2ZmKCAibW91c2Vtb3ZlLiIgKyB0aGlzLndpZGdldE5hbWUsIHRoaXMuX21vdXNlTW92ZURlbGVnYXRlICkNCiAgICAgICAgICAgICAgICAgICAgLm9mZiggIm1vdXNldXAuIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VVcERlbGVnYXRlICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX21vdXNlRG93bjogZnVuY3Rpb24oIGV2ZW50ICkgew0KDQogICAgICAgICAgICAvLyBkb24ndCBsZXQgbW9yZSB0aGFuIG9uZSB3aWRnZXQgaGFuZGxlIG1vdXNlU3RhcnQNCiAgICAgICAgICAgIGlmICggbW91c2VIYW5kbGVkICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fbW91c2VNb3ZlZCA9IGZhbHNlOw0KDQogICAgICAgICAgICAvLyBXZSBtYXkgaGF2ZSBtaXNzZWQgbW91c2V1cCAob3V0IG9mIHdpbmRvdykNCiAgICAgICAgICAgICggdGhpcy5fbW91c2VTdGFydGVkICYmIHRoaXMuX21vdXNlVXAoIGV2ZW50ICkgKTsNCg0KICAgICAgICAgICAgdGhpcy5fbW91c2VEb3duRXZlbnQgPSBldmVudDsNCg0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIGJ0bklzTGVmdCA9ICggZXZlbnQud2hpY2ggPT09IDEgKSwNCg0KICAgICAgICAgICAgICAgIC8vIGV2ZW50LnRhcmdldC5ub2RlTmFtZSB3b3JrcyBhcm91bmQgYSBidWcgaW4gSUUgOCB3aXRoDQogICAgICAgICAgICAgICAgLy8gZGlzYWJsZWQgaW5wdXRzICgjNzYyMCkNCiAgICAgICAgICAgICAgICBlbElzQ2FuY2VsID0gKCB0eXBlb2YgdGhpcy5vcHRpb25zLmNhbmNlbCA9PT0gInN0cmluZyIgJiYgZXZlbnQudGFyZ2V0Lm5vZGVOYW1lID8NCiAgICAgICAgICAgICAgICAgICAgJCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggdGhpcy5vcHRpb25zLmNhbmNlbCApLmxlbmd0aCA6IGZhbHNlICk7DQogICAgICAgICAgICBpZiAoICFidG5Jc0xlZnQgfHwgZWxJc0NhbmNlbCB8fCAhdGhpcy5fbW91c2VDYXB0dXJlKCBldmVudCApICkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLm1vdXNlRGVsYXlNZXQgPSAhdGhpcy5vcHRpb25zLmRlbGF5Ow0KICAgICAgICAgICAgaWYgKCAhdGhpcy5tb3VzZURlbGF5TWV0ICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX21vdXNlRGVsYXlUaW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGF0Lm1vdXNlRGVsYXlNZXQgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0sIHRoaXMub3B0aW9ucy5kZWxheSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHRoaXMuX21vdXNlRGlzdGFuY2VNZXQoIGV2ZW50ICkgJiYgdGhpcy5fbW91c2VEZWxheU1ldCggZXZlbnQgKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9tb3VzZVN0YXJ0ZWQgPSAoIHRoaXMuX21vdXNlU3RhcnQoIGV2ZW50ICkgIT09IGZhbHNlICk7DQogICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5fbW91c2VTdGFydGVkICkgew0KICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIENsaWNrIGV2ZW50IG1heSBuZXZlciBoYXZlIGZpcmVkIChHZWNrbyAmIE9wZXJhKQ0KICAgICAgICAgICAgaWYgKCB0cnVlID09PSAkLmRhdGEoIGV2ZW50LnRhcmdldCwgdGhpcy53aWRnZXROYW1lICsgIi5wcmV2ZW50Q2xpY2tFdmVudCIgKSApIHsNCiAgICAgICAgICAgICAgICAkLnJlbW92ZURhdGEoIGV2ZW50LnRhcmdldCwgdGhpcy53aWRnZXROYW1lICsgIi5wcmV2ZW50Q2xpY2tFdmVudCIgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gVGhlc2UgZGVsZWdhdGVzIGFyZSByZXF1aXJlZCB0byBrZWVwIGNvbnRleHQNCiAgICAgICAgICAgIHRoaXMuX21vdXNlTW92ZURlbGVnYXRlID0gZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGF0Ll9tb3VzZU1vdmUoIGV2ZW50ICk7DQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgdGhpcy5fbW91c2VVcERlbGVnYXRlID0gZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGF0Ll9tb3VzZVVwKCBldmVudCApOw0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgdGhpcy5kb2N1bWVudA0KICAgICAgICAgICAgICAgIC5vbiggIm1vdXNlbW92ZS4iICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZU1vdmVEZWxlZ2F0ZSApDQogICAgICAgICAgICAgICAgLm9uKCAibW91c2V1cC4iICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZVVwRGVsZWdhdGUgKTsNCg0KICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCg0KICAgICAgICAgICAgbW91c2VIYW5kbGVkID0gdHJ1ZTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9LA0KDQogICAgICAgIF9tb3VzZU1vdmU6IGZ1bmN0aW9uKCBldmVudCApIHsNCg0KICAgICAgICAgICAgLy8gT25seSBjaGVjayBmb3IgbW91c2V1cHMgb3V0c2lkZSB0aGUgZG9jdW1lbnQgaWYgeW91J3ZlIG1vdmVkIGluc2lkZSB0aGUgZG9jdW1lbnQNCiAgICAgICAgICAgIC8vIGF0IGxlYXN0IG9uY2UuIFRoaXMgcHJldmVudHMgdGhlIGZpcmluZyBvZiBtb3VzZXVwIGluIHRoZSBjYXNlIG9mIElFPDksIHdoaWNoIHdpbGwNCiAgICAgICAgICAgIC8vIGZpcmUgYSBtb3VzZW1vdmUgZXZlbnQgaWYgY29udGVudCBpcyBwbGFjZWQgdW5kZXIgdGhlIGN1cnNvci4gU2VlICM3Nzc4DQogICAgICAgICAgICAvLyBTdXBwb3J0OiBJRSA8OQ0KICAgICAgICAgICAgaWYgKCB0aGlzLl9tb3VzZU1vdmVkICkgew0KDQogICAgICAgICAgICAgICAgLy8gSUUgbW91c2V1cCBjaGVjayAtIG1vdXNldXAgaGFwcGVuZWQgd2hlbiBtb3VzZSB3YXMgb3V0IG9mIHdpbmRvdw0KICAgICAgICAgICAgICAgIGlmICggJC51aS5pZSAmJiAoICFkb2N1bWVudC5kb2N1bWVudE1vZGUgfHwgZG9jdW1lbnQuZG9jdW1lbnRNb2RlIDwgOSApICYmDQogICAgICAgICAgICAgICAgICAgICFldmVudC5idXR0b24gKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb3VzZVVwKCBldmVudCApOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIElmcmFtZSBtb3VzZXVwIGNoZWNrIC0gbW91c2V1cCBvY2N1cnJlZCBpbiBhbm90aGVyIGRvY3VtZW50DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmICggIWV2ZW50LndoaWNoICkgew0KDQogICAgICAgICAgICAgICAgICAgIC8vIFN1cHBvcnQ6IFNhZmFyaSA8PTggLSA5DQogICAgICAgICAgICAgICAgICAgIC8vIFNhZmFyaSBzZXRzIHdoaWNoIHRvIDAgaWYgeW91IHByZXNzIGFueSBvZiB0aGUgZm9sbG93aW5nIGtleXMNCiAgICAgICAgICAgICAgICAgICAgLy8gZHVyaW5nIGEgZHJhZyAoIzE0NDYxKQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIGV2ZW50Lm9yaWdpbmFsRXZlbnQuYWx0S2V5IHx8IGV2ZW50Lm9yaWdpbmFsRXZlbnQuY3RybEtleSB8fA0KICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQub3JpZ2luYWxFdmVudC5tZXRhS2V5IHx8IGV2ZW50Lm9yaWdpbmFsRXZlbnQuc2hpZnRLZXkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlnbm9yZU1pc3NpbmdXaGljaCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoICF0aGlzLmlnbm9yZU1pc3NpbmdXaGljaCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb3VzZVVwKCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGV2ZW50LndoaWNoIHx8IGV2ZW50LmJ1dHRvbiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9tb3VzZU1vdmVkID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCB0aGlzLl9tb3VzZVN0YXJ0ZWQgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fbW91c2VEcmFnKCBldmVudCApOw0KICAgICAgICAgICAgICAgIHJldHVybiBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHRoaXMuX21vdXNlRGlzdGFuY2VNZXQoIGV2ZW50ICkgJiYgdGhpcy5fbW91c2VEZWxheU1ldCggZXZlbnQgKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9tb3VzZVN0YXJ0ZWQgPQ0KICAgICAgICAgICAgICAgICAgICAoIHRoaXMuX21vdXNlU3RhcnQoIHRoaXMuX21vdXNlRG93bkV2ZW50LCBldmVudCApICE9PSBmYWxzZSApOw0KICAgICAgICAgICAgICAgICggdGhpcy5fbW91c2VTdGFydGVkID8gdGhpcy5fbW91c2VEcmFnKCBldmVudCApIDogdGhpcy5fbW91c2VVcCggZXZlbnQgKSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gIXRoaXMuX21vdXNlU3RhcnRlZDsNCiAgICAgICAgfSwNCg0KICAgICAgICBfbW91c2VVcDogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgdGhpcy5kb2N1bWVudA0KICAgICAgICAgICAgICAgIC5vZmYoICJtb3VzZW1vdmUuIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUgKQ0KICAgICAgICAgICAgICAgIC5vZmYoICJtb3VzZXVwLiIgKyB0aGlzLndpZGdldE5hbWUsIHRoaXMuX21vdXNlVXBEZWxlZ2F0ZSApOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMuX21vdXNlU3RhcnRlZCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9tb3VzZVN0YXJ0ZWQgPSBmYWxzZTsNCg0KICAgICAgICAgICAgICAgIGlmICggZXZlbnQudGFyZ2V0ID09PSB0aGlzLl9tb3VzZURvd25FdmVudC50YXJnZXQgKSB7DQogICAgICAgICAgICAgICAgICAgICQuZGF0YSggZXZlbnQudGFyZ2V0LCB0aGlzLndpZGdldE5hbWUgKyAiLnByZXZlbnRDbGlja0V2ZW50IiwgdHJ1ZSApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHRoaXMuX21vdXNlU3RvcCggZXZlbnQgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCB0aGlzLl9tb3VzZURlbGF5VGltZXIgKSB7DQogICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KCB0aGlzLl9tb3VzZURlbGF5VGltZXIgKTsNCiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fbW91c2VEZWxheVRpbWVyOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLmlnbm9yZU1pc3NpbmdXaGljaCA9IGZhbHNlOw0KICAgICAgICAgICAgbW91c2VIYW5kbGVkID0gZmFsc2U7DQogICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICB9LA0KDQogICAgICAgIF9tb3VzZURpc3RhbmNlTWV0OiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICByZXR1cm4gKCBNYXRoLm1heCgNCiAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoIHRoaXMuX21vdXNlRG93bkV2ZW50LnBhZ2VYIC0gZXZlbnQucGFnZVggKSwNCiAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoIHRoaXMuX21vdXNlRG93bkV2ZW50LnBhZ2VZIC0gZXZlbnQucGFnZVkgKQ0KICAgICAgICAgICAgICAgICkgPj0gdGhpcy5vcHRpb25zLmRpc3RhbmNlDQogICAgICAgICAgICApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9tb3VzZURlbGF5TWV0OiBmdW5jdGlvbiggLyogZXZlbnQgKi8gKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5tb3VzZURlbGF5TWV0Ow0KICAgICAgICB9LA0KDQogICAgICAgIC8vIFRoZXNlIGFyZSBwbGFjZWhvbGRlciBtZXRob2RzLCB0byBiZSBvdmVycmlkZW4gYnkgZXh0ZW5kaW5nIHBsdWdpbg0KICAgICAgICBfbW91c2VTdGFydDogZnVuY3Rpb24oIC8qIGV2ZW50ICovICkge30sDQogICAgICAgIF9tb3VzZURyYWc6IGZ1bmN0aW9uKCAvKiBldmVudCAqLyApIHt9LA0KICAgICAgICBfbW91c2VTdG9wOiBmdW5jdGlvbiggLyogZXZlbnQgKi8gKSB7fSwNCiAgICAgICAgX21vdXNlQ2FwdHVyZTogZnVuY3Rpb24oIC8qIGV2ZW50ICovICkgeyByZXR1cm4gdHJ1ZTsgfQ0KICAgIH0gKTsNCg0KDQoNCg0KLy8gJC51aS5wbHVnaW4gaXMgZGVwcmVjYXRlZC4gVXNlICQud2lkZ2V0KCkgZXh0ZW5zaW9ucyBpbnN0ZWFkLg0KICAgIHZhciBwbHVnaW4gPSAkLnVpLnBsdWdpbiA9IHsNCiAgICAgICAgYWRkOiBmdW5jdGlvbiggbW9kdWxlLCBvcHRpb24sIHNldCApIHsNCiAgICAgICAgICAgIHZhciBpLA0KICAgICAgICAgICAgICAgIHByb3RvID0gJC51aVsgbW9kdWxlIF0ucHJvdG90eXBlOw0KICAgICAgICAgICAgZm9yICggaSBpbiBzZXQgKSB7DQogICAgICAgICAgICAgICAgcHJvdG8ucGx1Z2luc1sgaSBdID0gcHJvdG8ucGx1Z2luc1sgaSBdIHx8IFtdOw0KICAgICAgICAgICAgICAgIHByb3RvLnBsdWdpbnNbIGkgXS5wdXNoKCBbIG9wdGlvbiwgc2V0WyBpIF0gXSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBjYWxsOiBmdW5jdGlvbiggaW5zdGFuY2UsIG5hbWUsIGFyZ3MsIGFsbG93RGlzY29ubmVjdGVkICkgew0KICAgICAgICAgICAgdmFyIGksDQogICAgICAgICAgICAgICAgc2V0ID0gaW5zdGFuY2UucGx1Z2luc1sgbmFtZSBdOw0KDQogICAgICAgICAgICBpZiAoICFzZXQgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoICFhbGxvd0Rpc2Nvbm5lY3RlZCAmJiAoICFpbnN0YW5jZS5lbGVtZW50WyAwIF0ucGFyZW50Tm9kZSB8fA0KICAgICAgICAgICAgICAgIGluc3RhbmNlLmVsZW1lbnRbIDAgXS5wYXJlbnROb2RlLm5vZGVUeXBlID09PSAxMSApICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZm9yICggaSA9IDA7IGkgPCBzZXQubGVuZ3RoOyBpKysgKSB7DQogICAgICAgICAgICAgICAgaWYgKCBpbnN0YW5jZS5vcHRpb25zWyBzZXRbIGkgXVsgMCBdIF0gKSB7DQogICAgICAgICAgICAgICAgICAgIHNldFsgaSBdWyAxIF0uYXBwbHkoIGluc3RhbmNlLmVsZW1lbnQsIGFyZ3MgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9Ow0KDQoNCg0KICAgIHZhciBzYWZlQmx1ciA9ICQudWkuc2FmZUJsdXIgPSBmdW5jdGlvbiggZWxlbWVudCApIHsNCg0KICAgICAgICAvLyBTdXBwb3J0OiBJRTkgLSAxMCBvbmx5DQogICAgICAgIC8vIElmIHRoZSA8Ym9keT4gaXMgYmx1cnJlZCwgSUUgd2lsbCBzd2l0Y2ggd2luZG93cywgc2VlICM5NDIwDQogICAgICAgIGlmICggZWxlbWVudCAmJiBlbGVtZW50Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICJib2R5IiApIHsNCiAgICAgICAgICAgICQoIGVsZW1lbnQgKS50cmlnZ2VyKCAiYmx1ciIgKTsNCiAgICAgICAgfQ0KICAgIH07DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIERyYWdnYWJsZSAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogRHJhZ2dhYmxlDQovLz4+Z3JvdXA6IEludGVyYWN0aW9ucw0KLy8+PmRlc2NyaXB0aW9uOiBFbmFibGVzIGRyYWdnaW5nIGZ1bmN0aW9uYWxpdHkgZm9yIGFueSBlbGVtZW50Lg0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2RyYWdnYWJsZS8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9kcmFnZ2FibGUvDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvZHJhZ2dhYmxlLmNzcw0KDQoNCg0KICAgICQud2lkZ2V0KCAidWkuZHJhZ2dhYmxlIiwgJC51aS5tb3VzZSwgew0KICAgICAgICB2ZXJzaW9uOiAiMS4xMi4xIiwNCiAgICAgICAgd2lkZ2V0RXZlbnRQcmVmaXg6ICJkcmFnIiwNCiAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgYWRkQ2xhc3NlczogdHJ1ZSwNCiAgICAgICAgICAgIGFwcGVuZFRvOiAicGFyZW50IiwNCiAgICAgICAgICAgIGF4aXM6IGZhbHNlLA0KICAgICAgICAgICAgY29ubmVjdFRvU29ydGFibGU6IGZhbHNlLA0KICAgICAgICAgICAgY29udGFpbm1lbnQ6IGZhbHNlLA0KICAgICAgICAgICAgY3Vyc29yOiAiYXV0byIsDQogICAgICAgICAgICBjdXJzb3JBdDogZmFsc2UsDQogICAgICAgICAgICBncmlkOiBmYWxzZSwNCiAgICAgICAgICAgIGhhbmRsZTogZmFsc2UsDQogICAgICAgICAgICBoZWxwZXI6ICJvcmlnaW5hbCIsDQogICAgICAgICAgICBpZnJhbWVGaXg6IGZhbHNlLA0KICAgICAgICAgICAgb3BhY2l0eTogZmFsc2UsDQogICAgICAgICAgICByZWZyZXNoUG9zaXRpb25zOiBmYWxzZSwNCiAgICAgICAgICAgIHJldmVydDogZmFsc2UsDQogICAgICAgICAgICByZXZlcnREdXJhdGlvbjogNTAwLA0KICAgICAgICAgICAgc2NvcGU6ICJkZWZhdWx0IiwNCiAgICAgICAgICAgIHNjcm9sbDogdHJ1ZSwNCiAgICAgICAgICAgIHNjcm9sbFNlbnNpdGl2aXR5OiAyMCwNCiAgICAgICAgICAgIHNjcm9sbFNwZWVkOiAyMCwNCiAgICAgICAgICAgIHNuYXA6IGZhbHNlLA0KICAgICAgICAgICAgc25hcE1vZGU6ICJib3RoIiwNCiAgICAgICAgICAgIHNuYXBUb2xlcmFuY2U6IDIwLA0KICAgICAgICAgICAgc3RhY2s6IGZhbHNlLA0KICAgICAgICAgICAgekluZGV4OiBmYWxzZSwNCg0KICAgICAgICAgICAgLy8gQ2FsbGJhY2tzDQogICAgICAgICAgICBkcmFnOiBudWxsLA0KICAgICAgICAgICAgc3RhcnQ6IG51bGwsDQogICAgICAgICAgICBzdG9wOiBudWxsDQogICAgICAgIH0sDQogICAgICAgIF9jcmVhdGU6IGZ1bmN0aW9uKCkgew0KDQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5oZWxwZXIgPT09ICJvcmlnaW5hbCIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fc2V0UG9zaXRpb25SZWxhdGl2ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuYWRkQ2xhc3NlcyApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggInVpLWRyYWdnYWJsZSIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX3NldEhhbmRsZUNsYXNzTmFtZSgpOw0KDQogICAgICAgICAgICB0aGlzLl9tb3VzZUluaXQoKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHsNCiAgICAgICAgICAgIHRoaXMuX3N1cGVyKCBrZXksIHZhbHVlICk7DQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImhhbmRsZSIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlSGFuZGxlQ2xhc3NOYW1lKCk7DQogICAgICAgICAgICAgICAgdGhpcy5fc2V0SGFuZGxlQ2xhc3NOYW1lKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2Rlc3Ryb3k6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaWYgKCAoIHRoaXMuaGVscGVyIHx8IHRoaXMuZWxlbWVudCApLmlzKCAiLnVpLWRyYWdnYWJsZS1kcmFnZ2luZyIgKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3lPbkNsZWFyID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLl9yZW1vdmVIYW5kbGVDbGFzc05hbWUoKTsNCiAgICAgICAgICAgIHRoaXMuX21vdXNlRGVzdHJveSgpOw0KICAgICAgICB9LA0KDQogICAgICAgIF9tb3VzZUNhcHR1cmU6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciBvID0gdGhpcy5vcHRpb25zOw0KDQogICAgICAgICAgICAvLyBBbW9uZyBvdGhlcnMsIHByZXZlbnQgYSBkcmFnIG9uIGEgcmVzaXphYmxlLWhhbmRsZQ0KICAgICAgICAgICAgaWYgKCB0aGlzLmhlbHBlciB8fCBvLmRpc2FibGVkIHx8DQogICAgICAgICAgICAgICAgJCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggIi51aS1yZXNpemFibGUtaGFuZGxlIiApLmxlbmd0aCA+IDAgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvL1F1aXQgaWYgd2UncmUgbm90IG9uIGEgdmFsaWQgaGFuZGxlDQogICAgICAgICAgICB0aGlzLmhhbmRsZSA9IHRoaXMuX2dldEhhbmRsZSggZXZlbnQgKTsNCiAgICAgICAgICAgIGlmICggIXRoaXMuaGFuZGxlICkgew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fYmx1ckFjdGl2ZUVsZW1lbnQoIGV2ZW50ICk7DQoNCiAgICAgICAgICAgIHRoaXMuX2Jsb2NrRnJhbWVzKCBvLmlmcmFtZUZpeCA9PT0gdHJ1ZSA/ICJpZnJhbWUiIDogby5pZnJhbWVGaXggKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBfYmxvY2tGcmFtZXM6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsNCiAgICAgICAgICAgIHRoaXMuaWZyYW1lQmxvY2tzID0gdGhpcy5kb2N1bWVudC5maW5kKCBzZWxlY3RvciApLm1hcCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIGlmcmFtZSA9ICQoIHRoaXMgKTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkKCAiPGRpdj4iICkNCiAgICAgICAgICAgICAgICAgICAgLmNzcyggInBvc2l0aW9uIiwgImFic29sdXRlIiApDQogICAgICAgICAgICAgICAgICAgIC5hcHBlbmRUbyggaWZyYW1lLnBhcmVudCgpICkNCiAgICAgICAgICAgICAgICAgICAgLm91dGVyV2lkdGgoIGlmcmFtZS5vdXRlcldpZHRoKCkgKQ0KICAgICAgICAgICAgICAgICAgICAub3V0ZXJIZWlnaHQoIGlmcmFtZS5vdXRlckhlaWdodCgpICkNCiAgICAgICAgICAgICAgICAgICAgLm9mZnNldCggaWZyYW1lLm9mZnNldCgpIClbIDAgXTsNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfdW5ibG9ja0ZyYW1lczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBpZiAoIHRoaXMuaWZyYW1lQmxvY2tzICkgew0KICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lQmxvY2tzLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmlmcmFtZUJsb2NrczsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfYmx1ckFjdGl2ZUVsZW1lbnQ6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciBhY3RpdmVFbGVtZW50ID0gJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICksDQogICAgICAgICAgICAgICAgdGFyZ2V0ID0gJCggZXZlbnQudGFyZ2V0ICk7DQoNCiAgICAgICAgICAgIC8vIERvbid0IGJsdXIgaWYgdGhlIGV2ZW50IG9jY3VycmVkIG9uIGFuIGVsZW1lbnQgdGhhdCBpcyB3aXRoaW4NCiAgICAgICAgICAgIC8vIHRoZSBjdXJyZW50bHkgZm9jdXNlZCBlbGVtZW50DQogICAgICAgICAgICAvLyBTZWUgIzEwNTI3LCAjMTI0NzINCiAgICAgICAgICAgIGlmICggdGFyZ2V0LmNsb3Nlc3QoIGFjdGl2ZUVsZW1lbnQgKS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBCbHVyIGFueSBlbGVtZW50IHRoYXQgY3VycmVudGx5IGhhcyBmb2N1cywgc2VlICM0MjYxDQogICAgICAgICAgICAkLnVpLnNhZmVCbHVyKCBhY3RpdmVFbGVtZW50ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX21vdXNlU3RhcnQ6IGZ1bmN0aW9uKCBldmVudCApIHsNCg0KICAgICAgICAgICAgdmFyIG8gPSB0aGlzLm9wdGlvbnM7DQoNCiAgICAgICAgICAgIC8vQ3JlYXRlIGFuZCBhcHBlbmQgdGhlIHZpc2libGUgaGVscGVyDQogICAgICAgICAgICB0aGlzLmhlbHBlciA9IHRoaXMuX2NyZWF0ZUhlbHBlciggZXZlbnQgKTsNCg0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMuaGVscGVyLCAidWktZHJhZ2dhYmxlLWRyYWdnaW5nIiApOw0KDQogICAgICAgICAgICAvL0NhY2hlIHRoZSBoZWxwZXIgc2l6ZQ0KICAgICAgICAgICAgdGhpcy5fY2FjaGVIZWxwZXJQcm9wb3J0aW9ucygpOw0KDQogICAgICAgICAgICAvL0lmIGRkbWFuYWdlciBpcyB1c2VkIGZvciBkcm9wcGFibGVzLCBzZXQgdGhlIGdsb2JhbCBkcmFnZ2FibGUNCiAgICAgICAgICAgIGlmICggJC51aS5kZG1hbmFnZXIgKSB7DQogICAgICAgICAgICAgICAgJC51aS5kZG1hbmFnZXIuY3VycmVudCA9IHRoaXM7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qDQoJCSAqIC0gUG9zaXRpb24gZ2VuZXJhdGlvbiAtDQoJCSAqIFRoaXMgYmxvY2sgZ2VuZXJhdGVzIGV2ZXJ5dGhpbmcgcG9zaXRpb24gcmVsYXRlZCAtIGl0J3MgdGhlIGNvcmUgb2YgZHJhZ2dhYmxlcy4NCgkJICovDQoNCiAgICAgICAgICAgIC8vQ2FjaGUgdGhlIG1hcmdpbnMgb2YgdGhlIG9yaWdpbmFsIGVsZW1lbnQNCiAgICAgICAgICAgIHRoaXMuX2NhY2hlTWFyZ2lucygpOw0KDQogICAgICAgICAgICAvL1N0b3JlIHRoZSBoZWxwZXIncyBjc3MgcG9zaXRpb24NCiAgICAgICAgICAgIHRoaXMuY3NzUG9zaXRpb24gPSB0aGlzLmhlbHBlci5jc3MoICJwb3NpdGlvbiIgKTsNCiAgICAgICAgICAgIHRoaXMuc2Nyb2xsUGFyZW50ID0gdGhpcy5oZWxwZXIuc2Nyb2xsUGFyZW50KCB0cnVlICk7DQogICAgICAgICAgICB0aGlzLm9mZnNldFBhcmVudCA9IHRoaXMuaGVscGVyLm9mZnNldFBhcmVudCgpOw0KICAgICAgICAgICAgdGhpcy5oYXNGaXhlZEFuY2VzdG9yID0gdGhpcy5oZWxwZXIucGFyZW50cygpLmZpbHRlciggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICQoIHRoaXMgKS5jc3MoICJwb3NpdGlvbiIgKSA9PT0gImZpeGVkIjsNCiAgICAgICAgICAgIH0gKS5sZW5ndGggPiAwOw0KDQogICAgICAgICAgICAvL1RoZSBlbGVtZW50J3MgYWJzb2x1dGUgcG9zaXRpb24gb24gdGhlIHBhZ2UgbWludXMgbWFyZ2lucw0KICAgICAgICAgICAgdGhpcy5wb3NpdGlvbkFicyA9IHRoaXMuZWxlbWVudC5vZmZzZXQoKTsNCiAgICAgICAgICAgIHRoaXMuX3JlZnJlc2hPZmZzZXRzKCBldmVudCApOw0KDQogICAgICAgICAgICAvL0dlbmVyYXRlIHRoZSBvcmlnaW5hbCBwb3NpdGlvbg0KICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFBvc2l0aW9uID0gdGhpcy5wb3NpdGlvbiA9IHRoaXMuX2dlbmVyYXRlUG9zaXRpb24oIGV2ZW50LCBmYWxzZSApOw0KICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFBhZ2VYID0gZXZlbnQucGFnZVg7DQogICAgICAgICAgICB0aGlzLm9yaWdpbmFsUGFnZVkgPSBldmVudC5wYWdlWTsNCg0KICAgICAgICAgICAgLy9BZGp1c3QgdGhlIG1vdXNlIG9mZnNldCByZWxhdGl2ZSB0byB0aGUgaGVscGVyIGlmICJjdXJzb3JBdCIgaXMgc3VwcGxpZWQNCiAgICAgICAgICAgICggby5jdXJzb3JBdCAmJiB0aGlzLl9hZGp1c3RPZmZzZXRGcm9tSGVscGVyKCBvLmN1cnNvckF0ICkgKTsNCg0KICAgICAgICAgICAgLy9TZXQgYSBjb250YWlubWVudCBpZiBnaXZlbiBpbiB0aGUgb3B0aW9ucw0KICAgICAgICAgICAgdGhpcy5fc2V0Q29udGFpbm1lbnQoKTsNCg0KICAgICAgICAgICAgLy9UcmlnZ2VyIGV2ZW50ICsgY2FsbGJhY2tzDQogICAgICAgICAgICBpZiAoIHRoaXMuX3RyaWdnZXIoICJzdGFydCIsIGV2ZW50ICkgPT09IGZhbHNlICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX2NsZWFyKCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvL1JlY2FjaGUgdGhlIGhlbHBlciBzaXplDQogICAgICAgICAgICB0aGlzLl9jYWNoZUhlbHBlclByb3BvcnRpb25zKCk7DQoNCiAgICAgICAgICAgIC8vUHJlcGFyZSB0aGUgZHJvcHBhYmxlIG9mZnNldHMNCiAgICAgICAgICAgIGlmICggJC51aS5kZG1hbmFnZXIgJiYgIW8uZHJvcEJlaGF2aW91ciApIHsNCiAgICAgICAgICAgICAgICAkLnVpLmRkbWFuYWdlci5wcmVwYXJlT2Zmc2V0cyggdGhpcywgZXZlbnQgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gRXhlY3V0ZSB0aGUgZHJhZyBvbmNlIC0gdGhpcyBjYXVzZXMgdGhlIGhlbHBlciBub3QgdG8gYmUgdmlzaWJsZSBiZWZvcmUgZ2V0dGluZyBpdHMNCiAgICAgICAgICAgIC8vIGNvcnJlY3QgcG9zaXRpb24NCiAgICAgICAgICAgIHRoaXMuX21vdXNlRHJhZyggZXZlbnQsIHRydWUgKTsNCg0KICAgICAgICAgICAgLy8gSWYgdGhlIGRkbWFuYWdlciBpcyB1c2VkIGZvciBkcm9wcGFibGVzLCBpbmZvcm0gdGhlIG1hbmFnZXIgdGhhdCBkcmFnZ2luZyBoYXMgc3RhcnRlZA0KICAgICAgICAgICAgLy8gKHNlZSAjNTAwMykNCiAgICAgICAgICAgIGlmICggJC51aS5kZG1hbmFnZXIgKSB7DQogICAgICAgICAgICAgICAgJC51aS5kZG1hbmFnZXIuZHJhZ1N0YXJ0KCB0aGlzLCBldmVudCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcmVmcmVzaE9mZnNldHM6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHRoaXMub2Zmc2V0ID0gew0KICAgICAgICAgICAgICAgIHRvcDogdGhpcy5wb3NpdGlvbkFicy50b3AgLSB0aGlzLm1hcmdpbnMudG9wLA0KICAgICAgICAgICAgICAgIGxlZnQ6IHRoaXMucG9zaXRpb25BYnMubGVmdCAtIHRoaXMubWFyZ2lucy5sZWZ0LA0KICAgICAgICAgICAgICAgIHNjcm9sbDogZmFsc2UsDQogICAgICAgICAgICAgICAgcGFyZW50OiB0aGlzLl9nZXRQYXJlbnRPZmZzZXQoKSwNCiAgICAgICAgICAgICAgICByZWxhdGl2ZTogdGhpcy5fZ2V0UmVsYXRpdmVPZmZzZXQoKQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgdGhpcy5vZmZzZXQuY2xpY2sgPSB7DQogICAgICAgICAgICAgICAgbGVmdDogZXZlbnQucGFnZVggLSB0aGlzLm9mZnNldC5sZWZ0LA0KICAgICAgICAgICAgICAgIHRvcDogZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC50b3ANCiAgICAgICAgICAgIH07DQogICAgICAgIH0sDQoNCiAgICAgICAgX21vdXNlRHJhZzogZnVuY3Rpb24oIGV2ZW50LCBub1Byb3BhZ2F0aW9uICkgew0KDQogICAgICAgICAgICAvLyByZXNldCBhbnkgbmVjZXNzYXJ5IGNhY2hlZCBwcm9wZXJ0aWVzIChzZWUgIzUwMDkpDQogICAgICAgICAgICBpZiAoIHRoaXMuaGFzRml4ZWRBbmNlc3RvciApIHsNCiAgICAgICAgICAgICAgICB0aGlzLm9mZnNldC5wYXJlbnQgPSB0aGlzLl9nZXRQYXJlbnRPZmZzZXQoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy9Db21wdXRlIHRoZSBoZWxwZXJzIHBvc2l0aW9uDQogICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gdGhpcy5fZ2VuZXJhdGVQb3NpdGlvbiggZXZlbnQsIHRydWUgKTsNCiAgICAgICAgICAgIHRoaXMucG9zaXRpb25BYnMgPSB0aGlzLl9jb252ZXJ0UG9zaXRpb25UbyggImFic29sdXRlIiApOw0KDQogICAgICAgICAgICAvL0NhbGwgcGx1Z2lucyBhbmQgY2FsbGJhY2tzIGFuZCB1c2UgdGhlIHJlc3VsdGluZyBwb3NpdGlvbiBpZiBzb21ldGhpbmcgaXMgcmV0dXJuZWQNCiAgICAgICAgICAgIGlmICggIW5vUHJvcGFnYXRpb24gKSB7DQogICAgICAgICAgICAgICAgdmFyIHVpID0gdGhpcy5fdWlIYXNoKCk7DQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLl90cmlnZ2VyKCAiZHJhZyIsIGV2ZW50LCB1aSApID09PSBmYWxzZSApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbW91c2VVcCggbmV3ICQuRXZlbnQoICJtb3VzZXVwIiwgZXZlbnQgKSApOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSB1aS5wb3NpdGlvbjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5oZWxwZXJbIDAgXS5zdHlsZS5sZWZ0ID0gdGhpcy5wb3NpdGlvbi5sZWZ0ICsgInB4IjsNCiAgICAgICAgICAgIHRoaXMuaGVscGVyWyAwIF0uc3R5bGUudG9wID0gdGhpcy5wb3NpdGlvbi50b3AgKyAicHgiOw0KDQogICAgICAgICAgICBpZiAoICQudWkuZGRtYW5hZ2VyICkgew0KICAgICAgICAgICAgICAgICQudWkuZGRtYW5hZ2VyLmRyYWcoIHRoaXMsIGV2ZW50ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfbW91c2VTdG9wOiBmdW5jdGlvbiggZXZlbnQgKSB7DQoNCiAgICAgICAgICAgIC8vSWYgd2UgYXJlIHVzaW5nIGRyb3BwYWJsZXMsIGluZm9ybSB0aGUgbWFuYWdlciBhYm91dCB0aGUgZHJvcA0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIGRyb3BwZWQgPSBmYWxzZTsNCiAgICAgICAgICAgIGlmICggJC51aS5kZG1hbmFnZXIgJiYgIXRoaXMub3B0aW9ucy5kcm9wQmVoYXZpb3VyICkgew0KICAgICAgICAgICAgICAgIGRyb3BwZWQgPSAkLnVpLmRkbWFuYWdlci5kcm9wKCB0aGlzLCBldmVudCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvL2lmIGEgZHJvcCBjb21lcyBmcm9tIG91dHNpZGUgKGEgc29ydGFibGUpDQogICAgICAgICAgICBpZiAoIHRoaXMuZHJvcHBlZCApIHsNCiAgICAgICAgICAgICAgICBkcm9wcGVkID0gdGhpcy5kcm9wcGVkOw0KICAgICAgICAgICAgICAgIHRoaXMuZHJvcHBlZCA9IGZhbHNlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoICggdGhpcy5vcHRpb25zLnJldmVydCA9PT0gImludmFsaWQiICYmICFkcm9wcGVkICkgfHwNCiAgICAgICAgICAgICAgICAoIHRoaXMub3B0aW9ucy5yZXZlcnQgPT09ICJ2YWxpZCIgJiYgZHJvcHBlZCApIHx8DQogICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnJldmVydCA9PT0gdHJ1ZSB8fCAoICQuaXNGdW5jdGlvbiggdGhpcy5vcHRpb25zLnJldmVydCApICYmDQogICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5yZXZlcnQuY2FsbCggdGhpcy5lbGVtZW50LCBkcm9wcGVkICkgKQ0KICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgJCggdGhpcy5oZWxwZXIgKS5hbmltYXRlKA0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsUG9zaXRpb24sDQogICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KCB0aGlzLm9wdGlvbnMucmV2ZXJ0RHVyYXRpb24sIDEwICksDQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGF0Ll90cmlnZ2VyKCAic3RvcCIsIGV2ZW50ICkgIT09IGZhbHNlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX2NsZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuX3RyaWdnZXIoICJzdG9wIiwgZXZlbnQgKSAhPT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2NsZWFyKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0sDQoNCiAgICAgICAgX21vdXNlVXA6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHRoaXMuX3VuYmxvY2tGcmFtZXMoKTsNCg0KICAgICAgICAgICAgLy8gSWYgdGhlIGRkbWFuYWdlciBpcyB1c2VkIGZvciBkcm9wcGFibGVzLCBpbmZvcm0gdGhlIG1hbmFnZXIgdGhhdCBkcmFnZ2luZyBoYXMgc3RvcHBlZA0KICAgICAgICAgICAgLy8gKHNlZSAjNTAwMykNCiAgICAgICAgICAgIGlmICggJC51aS5kZG1hbmFnZXIgKSB7DQogICAgICAgICAgICAgICAgJC51aS5kZG1hbmFnZXIuZHJhZ1N0b3AoIHRoaXMsIGV2ZW50ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIE9ubHkgbmVlZCB0byBmb2N1cyBpZiB0aGUgZXZlbnQgb2NjdXJyZWQgb24gdGhlIGRyYWdnYWJsZSBpdHNlbGYsIHNlZSAjMTA1MjcNCiAgICAgICAgICAgIGlmICggdGhpcy5oYW5kbGVFbGVtZW50LmlzKCBldmVudC50YXJnZXQgKSApIHsNCg0KICAgICAgICAgICAgICAgIC8vIFRoZSBpbnRlcmFjdGlvbiBpcyBvdmVyOyB3aGV0aGVyIG9yIG5vdCB0aGUgY2xpY2sgcmVzdWx0ZWQgaW4gYSBkcmFnLA0KICAgICAgICAgICAgICAgIC8vIGZvY3VzIHRoZSBlbGVtZW50DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnRyaWdnZXIoICJmb2N1cyIgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICQudWkubW91c2UucHJvdG90eXBlLl9tb3VzZVVwLmNhbGwoIHRoaXMsIGV2ZW50ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgY2FuY2VsOiBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLmhlbHBlci5pcyggIi51aS1kcmFnZ2FibGUtZHJhZ2dpbmciICkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fbW91c2VVcCggbmV3ICQuRXZlbnQoICJtb3VzZXVwIiwgeyB0YXJnZXQ6IHRoaXMuZWxlbWVudFsgMCBdIH0gKSApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9jbGVhcigpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gdGhpczsNCg0KICAgICAgICB9LA0KDQogICAgICAgIF9nZXRIYW5kbGU6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuaGFuZGxlID8NCiAgICAgICAgICAgICAgICAhISQoIGV2ZW50LnRhcmdldCApLmNsb3Nlc3QoIHRoaXMuZWxlbWVudC5maW5kKCB0aGlzLm9wdGlvbnMuaGFuZGxlICkgKS5sZW5ndGggOg0KICAgICAgICAgICAgICAgIHRydWU7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldEhhbmRsZUNsYXNzTmFtZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLmhhbmRsZUVsZW1lbnQgPSB0aGlzLm9wdGlvbnMuaGFuZGxlID8NCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZmluZCggdGhpcy5vcHRpb25zLmhhbmRsZSApIDogdGhpcy5lbGVtZW50Ow0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMuaGFuZGxlRWxlbWVudCwgInVpLWRyYWdnYWJsZS1oYW5kbGUiICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3JlbW92ZUhhbmRsZUNsYXNzTmFtZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5oYW5kbGVFbGVtZW50LCAidWktZHJhZ2dhYmxlLWhhbmRsZSIgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfY3JlYXRlSGVscGVyOiBmdW5jdGlvbiggZXZlbnQgKSB7DQoNCiAgICAgICAgICAgIHZhciBvID0gdGhpcy5vcHRpb25zLA0KICAgICAgICAgICAgICAgIGhlbHBlcklzRnVuY3Rpb24gPSAkLmlzRnVuY3Rpb24oIG8uaGVscGVyICksDQogICAgICAgICAgICAgICAgaGVscGVyID0gaGVscGVySXNGdW5jdGlvbiA/DQogICAgICAgICAgICAgICAgICAgICQoIG8uaGVscGVyLmFwcGx5KCB0aGlzLmVsZW1lbnRbIDAgXSwgWyBldmVudCBdICkgKSA6DQogICAgICAgICAgICAgICAgICAgICggby5oZWxwZXIgPT09ICJjbG9uZSIgPw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsb25lKCkucmVtb3ZlQXR0ciggImlkIiApIDoNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudCApOw0KDQogICAgICAgICAgICBpZiAoICFoZWxwZXIucGFyZW50cyggImJvZHkiICkubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIGhlbHBlci5hcHBlbmRUbyggKCBvLmFwcGVuZFRvID09PSAicGFyZW50IiA/DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudFsgMCBdLnBhcmVudE5vZGUgOg0KICAgICAgICAgICAgICAgICAgICBvLmFwcGVuZFRvICkgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gSHR0cDovL2J1Z3MuanF1ZXJ5dWkuY29tL3RpY2tldC85NDQ2DQogICAgICAgICAgICAvLyBhIGhlbHBlciBmdW5jdGlvbiBjYW4gcmV0dXJuIHRoZSBvcmlnaW5hbCBlbGVtZW50DQogICAgICAgICAgICAvLyB3aGljaCB3b3VsZG4ndCBoYXZlIGJlZW4gc2V0IHRvIHJlbGF0aXZlIGluIF9jcmVhdGUNCiAgICAgICAgICAgIGlmICggaGVscGVySXNGdW5jdGlvbiAmJiBoZWxwZXJbIDAgXSA9PT0gdGhpcy5lbGVtZW50WyAwIF0gKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fc2V0UG9zaXRpb25SZWxhdGl2ZSgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGhlbHBlclsgMCBdICE9PSB0aGlzLmVsZW1lbnRbIDAgXSAmJg0KICAgICAgICAgICAgICAgICEoIC8oZml4ZWR8YWJzb2x1dGUpLyApLnRlc3QoIGhlbHBlci5jc3MoICJwb3NpdGlvbiIgKSApICkgew0KICAgICAgICAgICAgICAgIGhlbHBlci5jc3MoICJwb3NpdGlvbiIsICJhYnNvbHV0ZSIgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGhlbHBlcjsNCg0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRQb3NpdGlvblJlbGF0aXZlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGlmICggISggL14oPzpyfGF8ZikvICkudGVzdCggdGhpcy5lbGVtZW50LmNzcyggInBvc2l0aW9uIiApICkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50WyAwIF0uc3R5bGUucG9zaXRpb24gPSAicmVsYXRpdmUiOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9hZGp1c3RPZmZzZXRGcm9tSGVscGVyOiBmdW5jdGlvbiggb2JqICkgew0KICAgICAgICAgICAgaWYgKCB0eXBlb2Ygb2JqID09PSAic3RyaW5nIiApIHsNCiAgICAgICAgICAgICAgICBvYmogPSBvYmouc3BsaXQoICIgIiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCAkLmlzQXJyYXkoIG9iaiApICkgew0KICAgICAgICAgICAgICAgIG9iaiA9IHsgbGVmdDogK29ialsgMCBdLCB0b3A6ICtvYmpbIDEgXSB8fCAwIH07DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoICJsZWZ0IiBpbiBvYmogKSB7DQogICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQuY2xpY2subGVmdCA9IG9iai5sZWZ0ICsgdGhpcy5tYXJnaW5zLmxlZnQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoICJyaWdodCIgaW4gb2JqICkgew0KICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPSB0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC0gb2JqLnJpZ2h0ICsgdGhpcy5tYXJnaW5zLmxlZnQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoICJ0b3AiIGluIG9iaiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLm9mZnNldC5jbGljay50b3AgPSBvYmoudG9wICsgdGhpcy5tYXJnaW5zLnRvcDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggImJvdHRvbSIgaW4gb2JqICkgew0KICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA9IHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC0gb2JqLmJvdHRvbSArIHRoaXMubWFyZ2lucy50b3A7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2lzUm9vdE5vZGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkgew0KICAgICAgICAgICAgcmV0dXJuICggLyhodG1sfGJvZHkpL2kgKS50ZXN0KCBlbGVtZW50LnRhZ05hbWUgKSB8fCBlbGVtZW50ID09PSB0aGlzLmRvY3VtZW50WyAwIF07DQogICAgICAgIH0sDQoNCiAgICAgICAgX2dldFBhcmVudE9mZnNldDogZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgIC8vR2V0IHRoZSBvZmZzZXRQYXJlbnQgYW5kIGNhY2hlIGl0cyBwb3NpdGlvbg0KICAgICAgICAgICAgdmFyIHBvID0gdGhpcy5vZmZzZXRQYXJlbnQub2Zmc2V0KCksDQogICAgICAgICAgICAgICAgZG9jdW1lbnQgPSB0aGlzLmRvY3VtZW50WyAwIF07DQoNCiAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBzcGVjaWFsIGNhc2Ugd2hlcmUgd2UgbmVlZCB0byBtb2RpZnkgYSBvZmZzZXQgY2FsY3VsYXRlZCBvbiBzdGFydCwgc2luY2UgdGhlDQogICAgICAgICAgICAvLyBmb2xsb3dpbmcgaGFwcGVuZWQ6DQogICAgICAgICAgICAvLyAxLiBUaGUgcG9zaXRpb24gb2YgdGhlIGhlbHBlciBpcyBhYnNvbHV0ZSwgc28gaXQncyBwb3NpdGlvbiBpcyBjYWxjdWxhdGVkIGJhc2VkIG9uIHRoZQ0KICAgICAgICAgICAgLy8gbmV4dCBwb3NpdGlvbmVkIHBhcmVudA0KICAgICAgICAgICAgLy8gMi4gVGhlIGFjdHVhbCBvZmZzZXQgcGFyZW50IGlzIGEgY2hpbGQgb2YgdGhlIHNjcm9sbCBwYXJlbnQsIGFuZCB0aGUgc2Nyb2xsIHBhcmVudCBpc24ndA0KICAgICAgICAgICAgLy8gdGhlIGRvY3VtZW50LCB3aGljaCBtZWFucyB0aGF0IHRoZSBzY3JvbGwgaXMgaW5jbHVkZWQgaW4gdGhlIGluaXRpYWwgY2FsY3VsYXRpb24gb2YgdGhlDQogICAgICAgICAgICAvLyBvZmZzZXQgb2YgdGhlIHBhcmVudCwgYW5kIG5ldmVyIHJlY2FsY3VsYXRlZCB1cG9uIGRyYWcNCiAgICAgICAgICAgIGlmICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gImFic29sdXRlIiAmJiB0aGlzLnNjcm9sbFBhcmVudFsgMCBdICE9PSBkb2N1bWVudCAmJg0KICAgICAgICAgICAgICAgICQuY29udGFpbnMoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0sIHRoaXMub2Zmc2V0UGFyZW50WyAwIF0gKSApIHsNCiAgICAgICAgICAgICAgICBwby5sZWZ0ICs9IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKTsNCiAgICAgICAgICAgICAgICBwby50b3AgKz0gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5faXNSb290Tm9kZSggdGhpcy5vZmZzZXRQYXJlbnRbIDAgXSApICkgew0KICAgICAgICAgICAgICAgIHBvID0geyB0b3A6IDAsIGxlZnQ6IDAgfTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICB0b3A6IHBvLnRvcCArICggcGFyc2VJbnQoIHRoaXMub2Zmc2V0UGFyZW50LmNzcyggImJvcmRlclRvcFdpZHRoIiApLCAxMCApIHx8IDAgKSwNCiAgICAgICAgICAgICAgICBsZWZ0OiBwby5sZWZ0ICsgKCBwYXJzZUludCggdGhpcy5vZmZzZXRQYXJlbnQuY3NzKCAiYm9yZGVyTGVmdFdpZHRoIiApLCAxMCApIHx8IDAgKQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICB9LA0KDQogICAgICAgIF9nZXRSZWxhdGl2ZU9mZnNldDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBpZiAoIHRoaXMuY3NzUG9zaXRpb24gIT09ICJyZWxhdGl2ZSIgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsgdG9wOiAwLCBsZWZ0OiAwIH07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciBwID0gdGhpcy5lbGVtZW50LnBvc2l0aW9uKCksDQogICAgICAgICAgICAgICAgc2Nyb2xsSXNSb290Tm9kZSA9IHRoaXMuX2lzUm9vdE5vZGUoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICB0b3A6IHAudG9wIC0gKCBwYXJzZUludCggdGhpcy5oZWxwZXIuY3NzKCAidG9wIiApLCAxMCApIHx8IDAgKSArDQogICAgICAgICAgICAgICAgICAgICggIXNjcm9sbElzUm9vdE5vZGUgPyB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSA6IDAgKSwNCiAgICAgICAgICAgICAgICBsZWZ0OiBwLmxlZnQgLSAoIHBhcnNlSW50KCB0aGlzLmhlbHBlci5jc3MoICJsZWZ0IiApLCAxMCApIHx8IDAgKSArDQogICAgICAgICAgICAgICAgICAgICggIXNjcm9sbElzUm9vdE5vZGUgPyB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCkgOiAwICkNCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBfY2FjaGVNYXJnaW5zOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMubWFyZ2lucyA9IHsNCiAgICAgICAgICAgICAgICBsZWZ0OiAoIHBhcnNlSW50KCB0aGlzLmVsZW1lbnQuY3NzKCAibWFyZ2luTGVmdCIgKSwgMTAgKSB8fCAwICksDQogICAgICAgICAgICAgICAgdG9wOiAoIHBhcnNlSW50KCB0aGlzLmVsZW1lbnQuY3NzKCAibWFyZ2luVG9wIiApLCAxMCApIHx8IDAgKSwNCiAgICAgICAgICAgICAgICByaWdodDogKCBwYXJzZUludCggdGhpcy5lbGVtZW50LmNzcyggIm1hcmdpblJpZ2h0IiApLCAxMCApIHx8IDAgKSwNCiAgICAgICAgICAgICAgICBib3R0b206ICggcGFyc2VJbnQoIHRoaXMuZWxlbWVudC5jc3MoICJtYXJnaW5Cb3R0b20iICksIDEwICkgfHwgMCApDQogICAgICAgICAgICB9Ow0KICAgICAgICB9LA0KDQogICAgICAgIF9jYWNoZUhlbHBlclByb3BvcnRpb25zOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMgPSB7DQogICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMuaGVscGVyLm91dGVyV2lkdGgoKSwNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVscGVyLm91dGVySGVpZ2h0KCkNCiAgICAgICAgICAgIH07DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldENvbnRhaW5tZW50OiBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgdmFyIGlzVXNlclNjcm9sbGFibGUsIGMsIGNlLA0KICAgICAgICAgICAgICAgIG8gPSB0aGlzLm9wdGlvbnMsDQogICAgICAgICAgICAgICAgZG9jdW1lbnQgPSB0aGlzLmRvY3VtZW50WyAwIF07DQoNCiAgICAgICAgICAgIHRoaXMucmVsYXRpdmVDb250YWluZXIgPSBudWxsOw0KDQogICAgICAgICAgICBpZiAoICFvLmNvbnRhaW5tZW50ICkgew0KICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbm1lbnQgPSBudWxsOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCBvLmNvbnRhaW5tZW50ID09PSAid2luZG93IiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5tZW50ID0gWw0KICAgICAgICAgICAgICAgICAgICAkKCB3aW5kb3cgKS5zY3JvbGxMZWZ0KCkgLSB0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0IC0gdGhpcy5vZmZzZXQucGFyZW50LmxlZnQsDQogICAgICAgICAgICAgICAgICAgICQoIHdpbmRvdyApLnNjcm9sbFRvcCgpIC0gdGhpcy5vZmZzZXQucmVsYXRpdmUudG9wIC0gdGhpcy5vZmZzZXQucGFyZW50LnRvcCwNCiAgICAgICAgICAgICAgICAgICAgJCggd2luZG93ICkuc2Nyb2xsTGVmdCgpICsgJCggd2luZG93ICkud2lkdGgoKSAtDQogICAgICAgICAgICAgICAgICAgIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggLSB0aGlzLm1hcmdpbnMubGVmdCwNCiAgICAgICAgICAgICAgICAgICAgJCggd2luZG93ICkuc2Nyb2xsVG9wKCkgKw0KICAgICAgICAgICAgICAgICAgICAoICQoIHdpbmRvdyApLmhlaWdodCgpIHx8IGRvY3VtZW50LmJvZHkucGFyZW50Tm9kZS5zY3JvbGxIZWlnaHQgKSAtDQogICAgICAgICAgICAgICAgICAgIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC0gdGhpcy5tYXJnaW5zLnRvcA0KICAgICAgICAgICAgICAgIF07DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIG8uY29udGFpbm1lbnQgPT09ICJkb2N1bWVudCIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5jb250YWlubWVudCA9IFsNCiAgICAgICAgICAgICAgICAgICAgMCwNCiAgICAgICAgICAgICAgICAgICAgMCwNCiAgICAgICAgICAgICAgICAgICAgJCggZG9jdW1lbnQgKS53aWR0aCgpIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIHRoaXMubWFyZ2lucy5sZWZ0LA0KICAgICAgICAgICAgICAgICAgICAoICQoIGRvY3VtZW50ICkuaGVpZ2h0KCkgfHwgZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodCApIC0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLSB0aGlzLm1hcmdpbnMudG9wDQogICAgICAgICAgICAgICAgXTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggby5jb250YWlubWVudC5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5jb250YWlubWVudCA9IG8uY29udGFpbm1lbnQ7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIG8uY29udGFpbm1lbnQgPT09ICJwYXJlbnQiICkgew0KICAgICAgICAgICAgICAgIG8uY29udGFpbm1lbnQgPSB0aGlzLmhlbHBlclsgMCBdLnBhcmVudE5vZGU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGMgPSAkKCBvLmNvbnRhaW5tZW50ICk7DQogICAgICAgICAgICBjZSA9IGNbIDAgXTsNCg0KICAgICAgICAgICAgaWYgKCAhY2UgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpc1VzZXJTY3JvbGxhYmxlID0gLyhzY3JvbGx8YXV0bykvLnRlc3QoIGMuY3NzKCAib3ZlcmZsb3ciICkgKTsNCg0KICAgICAgICAgICAgdGhpcy5jb250YWlubWVudCA9IFsNCiAgICAgICAgICAgICAgICAoIHBhcnNlSW50KCBjLmNzcyggImJvcmRlckxlZnRXaWR0aCIgKSwgMTAgKSB8fCAwICkgKw0KICAgICAgICAgICAgICAgICggcGFyc2VJbnQoIGMuY3NzKCAicGFkZGluZ0xlZnQiICksIDEwICkgfHwgMCApLA0KICAgICAgICAgICAgICAgICggcGFyc2VJbnQoIGMuY3NzKCAiYm9yZGVyVG9wV2lkdGgiICksIDEwICkgfHwgMCApICsNCiAgICAgICAgICAgICAgICAoIHBhcnNlSW50KCBjLmNzcyggInBhZGRpbmdUb3AiICksIDEwICkgfHwgMCApLA0KICAgICAgICAgICAgICAgICggaXNVc2VyU2Nyb2xsYWJsZSA/IE1hdGgubWF4KCBjZS5zY3JvbGxXaWR0aCwgY2Uub2Zmc2V0V2lkdGggKSA6IGNlLm9mZnNldFdpZHRoICkgLQ0KICAgICAgICAgICAgICAgICggcGFyc2VJbnQoIGMuY3NzKCAiYm9yZGVyUmlnaHRXaWR0aCIgKSwgMTAgKSB8fCAwICkgLQ0KICAgICAgICAgICAgICAgICggcGFyc2VJbnQoIGMuY3NzKCAicGFkZGluZ1JpZ2h0IiApLCAxMCApIHx8IDAgKSAtDQogICAgICAgICAgICAgICAgdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtDQogICAgICAgICAgICAgICAgdGhpcy5tYXJnaW5zLmxlZnQgLQ0KICAgICAgICAgICAgICAgIHRoaXMubWFyZ2lucy5yaWdodCwNCiAgICAgICAgICAgICAgICAoIGlzVXNlclNjcm9sbGFibGUgPyBNYXRoLm1heCggY2Uuc2Nyb2xsSGVpZ2h0LCBjZS5vZmZzZXRIZWlnaHQgKSA6IGNlLm9mZnNldEhlaWdodCApIC0NCiAgICAgICAgICAgICAgICAoIHBhcnNlSW50KCBjLmNzcyggImJvcmRlckJvdHRvbVdpZHRoIiApLCAxMCApIHx8IDAgKSAtDQogICAgICAgICAgICAgICAgKCBwYXJzZUludCggYy5jc3MoICJwYWRkaW5nQm90dG9tIiApLCAxMCApIHx8IDAgKSAtDQogICAgICAgICAgICAgICAgdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLQ0KICAgICAgICAgICAgICAgIHRoaXMubWFyZ2lucy50b3AgLQ0KICAgICAgICAgICAgICAgIHRoaXMubWFyZ2lucy5ib3R0b20NCiAgICAgICAgICAgIF07DQogICAgICAgICAgICB0aGlzLnJlbGF0aXZlQ29udGFpbmVyID0gYzsNCiAgICAgICAgfSwNCg0KICAgICAgICBfY29udmVydFBvc2l0aW9uVG86IGZ1bmN0aW9uKCBkLCBwb3MgKSB7DQoNCiAgICAgICAgICAgIGlmICggIXBvcyApIHsNCiAgICAgICAgICAgICAgICBwb3MgPSB0aGlzLnBvc2l0aW9uOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgbW9kID0gZCA9PT0gImFic29sdXRlIiA/IDEgOiAtMSwNCiAgICAgICAgICAgICAgICBzY3JvbGxJc1Jvb3ROb2RlID0gdGhpcy5faXNSb290Tm9kZSggdGhpcy5zY3JvbGxQYXJlbnRbIDAgXSApOw0KDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIHRvcDogKA0KDQogICAgICAgICAgICAgICAgICAgIC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvbg0KICAgICAgICAgICAgICAgICAgICBwb3MudG9wCSsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnQNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQucmVsYXRpdmUudG9wICogbW9kICsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9mZnNldC5wYXJlbnQudG9wICogbW9kIC0NCiAgICAgICAgICAgICAgICAgICAgKCAoIHRoaXMuY3NzUG9zaXRpb24gPT09ICJmaXhlZCIgPw0KICAgICAgICAgICAgICAgICAgICAgICAgLXRoaXMub2Zmc2V0LnNjcm9sbC50b3AgOg0KICAgICAgICAgICAgICAgICAgICAgICAgKCBzY3JvbGxJc1Jvb3ROb2RlID8gMCA6IHRoaXMub2Zmc2V0LnNjcm9sbC50b3AgKSApICogbW9kICkNCiAgICAgICAgICAgICAgICApLA0KICAgICAgICAgICAgICAgIGxlZnQ6ICgNCg0KICAgICAgICAgICAgICAgICAgICAvLyBUaGUgYWJzb2x1dGUgbW91c2UgcG9zaXRpb24NCiAgICAgICAgICAgICAgICAgICAgcG9zLmxlZnQgKw0KDQogICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudA0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0ICogbW9kICsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9mZnNldC5wYXJlbnQubGVmdCAqIG1vZAktDQogICAgICAgICAgICAgICAgICAgICggKCB0aGlzLmNzc1Bvc2l0aW9uID09PSAiZml4ZWQiID8NCiAgICAgICAgICAgICAgICAgICAgICAgIC10aGlzLm9mZnNldC5zY3JvbGwubGVmdCA6DQogICAgICAgICAgICAgICAgICAgICAgICAoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogdGhpcy5vZmZzZXQuc2Nyb2xsLmxlZnQgKSApICogbW9kICkNCiAgICAgICAgICAgICAgICApDQogICAgICAgICAgICB9Ow0KDQogICAgICAgIH0sDQoNCiAgICAgICAgX2dlbmVyYXRlUG9zaXRpb246IGZ1bmN0aW9uKCBldmVudCwgY29uc3RyYWluUG9zaXRpb24gKSB7DQoNCiAgICAgICAgICAgIHZhciBjb250YWlubWVudCwgY28sIHRvcCwgbGVmdCwNCiAgICAgICAgICAgICAgICBvID0gdGhpcy5vcHRpb25zLA0KICAgICAgICAgICAgICAgIHNjcm9sbElzUm9vdE5vZGUgPSB0aGlzLl9pc1Jvb3ROb2RlKCB0aGlzLnNjcm9sbFBhcmVudFsgMCBdICksDQogICAgICAgICAgICAgICAgcGFnZVggPSBldmVudC5wYWdlWCwNCiAgICAgICAgICAgICAgICBwYWdlWSA9IGV2ZW50LnBhZ2VZOw0KDQogICAgICAgICAgICAvLyBDYWNoZSB0aGUgc2Nyb2xsDQogICAgICAgICAgICBpZiAoICFzY3JvbGxJc1Jvb3ROb2RlIHx8ICF0aGlzLm9mZnNldC5zY3JvbGwgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQuc2Nyb2xsID0gew0KICAgICAgICAgICAgICAgICAgICB0b3A6IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpLA0KICAgICAgICAgICAgICAgICAgICBsZWZ0OiB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCkNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvKg0KCQkgKiAtIFBvc2l0aW9uIGNvbnN0cmFpbmluZyAtDQoJCSAqIENvbnN0cmFpbiB0aGUgcG9zaXRpb24gdG8gYSBtaXggb2YgZ3JpZCwgY29udGFpbm1lbnQuDQoJCSAqLw0KDQogICAgICAgICAgICAvLyBJZiB3ZSBhcmUgbm90IGRyYWdnaW5nIHlldCwgd2Ugd29uJ3QgY2hlY2sgZm9yIG9wdGlvbnMNCiAgICAgICAgICAgIGlmICggY29uc3RyYWluUG9zaXRpb24gKSB7DQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLmNvbnRhaW5tZW50ICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMucmVsYXRpdmVDb250YWluZXIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjbyA9IHRoaXMucmVsYXRpdmVDb250YWluZXIub2Zmc2V0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250YWlubWVudCA9IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5tZW50WyAwIF0gKyBjby5sZWZ0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbm1lbnRbIDEgXSArIGNvLnRvcCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5tZW50WyAyIF0gKyBjby5sZWZ0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbm1lbnRbIDMgXSArIGNvLnRvcA0KICAgICAgICAgICAgICAgICAgICAgICAgXTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5tZW50ID0gdGhpcy5jb250YWlubWVudDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGlmICggZXZlbnQucGFnZVggLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0IDwgY29udGFpbm1lbnRbIDAgXSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VYID0gY29udGFpbm1lbnRbIDAgXSArIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCBldmVudC5wYWdlWSAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA8IGNvbnRhaW5tZW50WyAxIF0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYWdlWSA9IGNvbnRhaW5tZW50WyAxIF0gKyB0aGlzLm9mZnNldC5jbGljay50b3A7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCBldmVudC5wYWdlWCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPiBjb250YWlubWVudFsgMiBdICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcGFnZVggPSBjb250YWlubWVudFsgMiBdICsgdGhpcy5vZmZzZXQuY2xpY2subGVmdDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIGV2ZW50LnBhZ2VZIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wID4gY29udGFpbm1lbnRbIDMgXSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VZID0gY29udGFpbm1lbnRbIDMgXSArIHRoaXMub2Zmc2V0LmNsaWNrLnRvcDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggby5ncmlkICkgew0KDQogICAgICAgICAgICAgICAgICAgIC8vQ2hlY2sgZm9yIGdyaWQgZWxlbWVudHMgc2V0IHRvIDAgdG8gcHJldmVudCBkaXZpZGUgYnkgMCBlcnJvciBjYXVzaW5nIGludmFsaWQNCiAgICAgICAgICAgICAgICAgICAgLy8gYXJndW1lbnQgZXJyb3JzIGluIElFIChzZWUgdGlja2V0ICM2OTUwKQ0KICAgICAgICAgICAgICAgICAgICB0b3AgPSBvLmdyaWRbIDEgXSA/IHRoaXMub3JpZ2luYWxQYWdlWSArIE1hdGgucm91bmQoICggcGFnZVkgLQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFBhZ2VZICkgLyBvLmdyaWRbIDEgXSApICogby5ncmlkWyAxIF0gOiB0aGlzLm9yaWdpbmFsUGFnZVk7DQogICAgICAgICAgICAgICAgICAgIHBhZ2VZID0gY29udGFpbm1lbnQgPyAoICggdG9wIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wID49IGNvbnRhaW5tZW50WyAxIF0gfHwNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+IGNvbnRhaW5tZW50WyAzIF0gKSA/DQogICAgICAgICAgICAgICAgICAgICAgICB0b3AgOg0KICAgICAgICAgICAgICAgICAgICAgICAgKCAoIHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+PSBjb250YWlubWVudFsgMSBdICkgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcCAtIG8uZ3JpZFsgMSBdIDogdG9wICsgby5ncmlkWyAxIF0gKSApIDogdG9wOw0KDQogICAgICAgICAgICAgICAgICAgIGxlZnQgPSBvLmdyaWRbIDAgXSA/IHRoaXMub3JpZ2luYWxQYWdlWCArDQogICAgICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKCAoIHBhZ2VYIC0gdGhpcy5vcmlnaW5hbFBhZ2VYICkgLyBvLmdyaWRbIDAgXSApICogby5ncmlkWyAwIF0gOg0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFBhZ2VYOw0KICAgICAgICAgICAgICAgICAgICBwYWdlWCA9IGNvbnRhaW5tZW50ID8gKCAoIGxlZnQgLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID49IGNvbnRhaW5tZW50WyAwIF0gfHwNCiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQgLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID4gY29udGFpbm1lbnRbIDIgXSApID8NCiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQgOg0KICAgICAgICAgICAgICAgICAgICAgICAgKCAoIGxlZnQgLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID49IGNvbnRhaW5tZW50WyAwIF0gKSA/DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCAtIG8uZ3JpZFsgMCBdIDogbGVmdCArIG8uZ3JpZFsgMCBdICkgKSA6IGxlZnQ7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCBvLmF4aXMgPT09ICJ5IiApIHsNCiAgICAgICAgICAgICAgICAgICAgcGFnZVggPSB0aGlzLm9yaWdpbmFsUGFnZVg7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCBvLmF4aXMgPT09ICJ4IiApIHsNCiAgICAgICAgICAgICAgICAgICAgcGFnZVkgPSB0aGlzLm9yaWdpbmFsUGFnZVk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIHRvcDogKA0KDQogICAgICAgICAgICAgICAgICAgIC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvbg0KICAgICAgICAgICAgICAgICAgICBwYWdlWSAtDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gQ2xpY2sgb2Zmc2V0IChyZWxhdGl2ZSB0byB0aGUgZWxlbWVudCkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQuY2xpY2sudG9wIC0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnQNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQucmVsYXRpdmUudG9wIC0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9mZnNldC5wYXJlbnQudG9wICsNCiAgICAgICAgICAgICAgICAgICAgKCB0aGlzLmNzc1Bvc2l0aW9uID09PSAiZml4ZWQiID8NCiAgICAgICAgICAgICAgICAgICAgICAgIC10aGlzLm9mZnNldC5zY3JvbGwudG9wIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiB0aGlzLm9mZnNldC5zY3JvbGwudG9wICkgKQ0KICAgICAgICAgICAgICAgICksDQogICAgICAgICAgICAgICAgbGVmdDogKA0KDQogICAgICAgICAgICAgICAgICAgIC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvbg0KICAgICAgICAgICAgICAgICAgICBwYWdlWCAtDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gQ2xpY2sgb2Zmc2V0IChyZWxhdGl2ZSB0byB0aGUgZWxlbWVudCkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQuY2xpY2subGVmdCAtDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gT25seSBmb3IgcmVsYXRpdmUgcG9zaXRpb25lZCBub2RlczogUmVsYXRpdmUgb2Zmc2V0IGZyb20gZWxlbWVudCB0byBvZmZzZXQgcGFyZW50DQogICAgICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQgLQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpDQogICAgICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0LnBhcmVudC5sZWZ0ICsNCiAgICAgICAgICAgICAgICAgICAgKCB0aGlzLmNzc1Bvc2l0aW9uID09PSAiZml4ZWQiID8NCiAgICAgICAgICAgICAgICAgICAgICAgIC10aGlzLm9mZnNldC5zY3JvbGwubGVmdCA6DQogICAgICAgICAgICAgICAgICAgICAgICAoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogdGhpcy5vZmZzZXQuc2Nyb2xsLmxlZnQgKSApDQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICB9LA0KDQogICAgICAgIF9jbGVhcjogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5oZWxwZXIsICJ1aS1kcmFnZ2FibGUtZHJhZ2dpbmciICk7DQogICAgICAgICAgICBpZiAoIHRoaXMuaGVscGVyWyAwIF0gIT09IHRoaXMuZWxlbWVudFsgMCBdICYmICF0aGlzLmNhbmNlbEhlbHBlclJlbW92YWwgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5oZWxwZXIucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLmhlbHBlciA9IG51bGw7DQogICAgICAgICAgICB0aGlzLmNhbmNlbEhlbHBlclJlbW92YWwgPSBmYWxzZTsNCiAgICAgICAgICAgIGlmICggdGhpcy5kZXN0cm95T25DbGVhciApIHsNCiAgICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3koKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICAvLyBGcm9tIG5vdyBvbiBidWxrIHN0dWZmIC0gbWFpbmx5IGhlbHBlcnMNCg0KICAgICAgICBfdHJpZ2dlcjogZnVuY3Rpb24oIHR5cGUsIGV2ZW50LCB1aSApIHsNCiAgICAgICAgICAgIHVpID0gdWkgfHwgdGhpcy5fdWlIYXNoKCk7DQogICAgICAgICAgICAkLnVpLnBsdWdpbi5jYWxsKCB0aGlzLCB0eXBlLCBbIGV2ZW50LCB1aSwgdGhpcyBdLCB0cnVlICk7DQoNCiAgICAgICAgICAgIC8vIEFic29sdXRlIHBvc2l0aW9uIGFuZCBvZmZzZXQgKHNlZSAjNjg4NCApIGhhdmUgdG8gYmUgcmVjYWxjdWxhdGVkIGFmdGVyIHBsdWdpbnMNCiAgICAgICAgICAgIGlmICggL14oZHJhZ3xzdGFydHxzdG9wKS8udGVzdCggdHlwZSApICkgew0KICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb25BYnMgPSB0aGlzLl9jb252ZXJ0UG9zaXRpb25UbyggImFic29sdXRlIiApOw0KICAgICAgICAgICAgICAgIHVpLm9mZnNldCA9IHRoaXMucG9zaXRpb25BYnM7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gJC5XaWRnZXQucHJvdG90eXBlLl90cmlnZ2VyLmNhbGwoIHRoaXMsIHR5cGUsIGV2ZW50LCB1aSApOw0KICAgICAgICB9LA0KDQogICAgICAgIHBsdWdpbnM6IHt9LA0KDQogICAgICAgIF91aUhhc2g6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBoZWxwZXI6IHRoaXMuaGVscGVyLA0KICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0aGlzLnBvc2l0aW9uLA0KICAgICAgICAgICAgICAgIG9yaWdpbmFsUG9zaXRpb246IHRoaXMub3JpZ2luYWxQb3NpdGlvbiwNCiAgICAgICAgICAgICAgICBvZmZzZXQ6IHRoaXMucG9zaXRpb25BYnMNCiAgICAgICAgICAgIH07DQogICAgICAgIH0NCg0KICAgIH0gKTsNCg0KICAgICQudWkucGx1Z2luLmFkZCggImRyYWdnYWJsZSIsICJjb25uZWN0VG9Tb3J0YWJsZSIsIHsNCiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGRyYWdnYWJsZSApIHsNCiAgICAgICAgICAgIHZhciB1aVNvcnRhYmxlID0gJC5leHRlbmQoIHt9LCB1aSwgew0KICAgICAgICAgICAgICAgIGl0ZW06IGRyYWdnYWJsZS5lbGVtZW50DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIGRyYWdnYWJsZS5zb3J0YWJsZXMgPSBbXTsNCiAgICAgICAgICAgICQoIGRyYWdnYWJsZS5vcHRpb25zLmNvbm5lY3RUb1NvcnRhYmxlICkuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIHNvcnRhYmxlID0gJCggdGhpcyApLnNvcnRhYmxlKCAiaW5zdGFuY2UiICk7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHNvcnRhYmxlICYmICFzb3J0YWJsZS5vcHRpb25zLmRpc2FibGVkICkgew0KICAgICAgICAgICAgICAgICAgICBkcmFnZ2FibGUuc29ydGFibGVzLnB1c2goIHNvcnRhYmxlICk7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gUmVmcmVzaFBvc2l0aW9ucyBpcyBjYWxsZWQgYXQgZHJhZyBzdGFydCB0byByZWZyZXNoIHRoZSBjb250YWluZXJDYWNoZQ0KICAgICAgICAgICAgICAgICAgICAvLyB3aGljaCBpcyB1c2VkIGluIGRyYWcuIFRoaXMgZW5zdXJlcyBpdCdzIGluaXRpYWxpemVkIGFuZCBzeW5jaHJvbml6ZWQNCiAgICAgICAgICAgICAgICAgICAgLy8gd2l0aCBhbnkgY2hhbmdlcyB0aGF0IG1pZ2h0IGhhdmUgaGFwcGVuZWQgb24gdGhlIHBhZ2Ugc2luY2UgaW5pdGlhbGl6YXRpb24uDQogICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLnJlZnJlc2hQb3NpdGlvbnMoKTsNCiAgICAgICAgICAgICAgICAgICAgc29ydGFibGUuX3RyaWdnZXIoICJhY3RpdmF0ZSIsIGV2ZW50LCB1aVNvcnRhYmxlICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KICAgICAgICBzdG9wOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBkcmFnZ2FibGUgKSB7DQogICAgICAgICAgICB2YXIgdWlTb3J0YWJsZSA9ICQuZXh0ZW5kKCB7fSwgdWksIHsNCiAgICAgICAgICAgICAgICBpdGVtOiBkcmFnZ2FibGUuZWxlbWVudA0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICBkcmFnZ2FibGUuY2FuY2VsSGVscGVyUmVtb3ZhbCA9IGZhbHNlOw0KDQogICAgICAgICAgICAkLmVhY2goIGRyYWdnYWJsZS5zb3J0YWJsZXMsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciBzb3J0YWJsZSA9IHRoaXM7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHNvcnRhYmxlLmlzT3ZlciApIHsNCiAgICAgICAgICAgICAgICAgICAgc29ydGFibGUuaXNPdmVyID0gMDsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBBbGxvdyB0aGlzIHNvcnRhYmxlIHRvIGhhbmRsZSByZW1vdmluZyB0aGUgaGVscGVyDQogICAgICAgICAgICAgICAgICAgIGRyYWdnYWJsZS5jYW5jZWxIZWxwZXJSZW1vdmFsID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgc29ydGFibGUuY2FuY2VsSGVscGVyUmVtb3ZhbCA9IGZhbHNlOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIFVzZSBfc3RvcmVkQ1NTIFRvIHJlc3RvcmUgcHJvcGVydGllcyBpbiB0aGUgc29ydGFibGUsDQogICAgICAgICAgICAgICAgICAgIC8vIGFzIHRoaXMgYWxzbyBoYW5kbGVzIHJldmVydCAoIzk2NzUpIHNpbmNlIHRoZSBkcmFnZ2FibGUNCiAgICAgICAgICAgICAgICAgICAgLy8gbWF5IGhhdmUgbW9kaWZpZWQgdGhlbSBpbiB1bmV4cGVjdGVkIHdheXMgKCM4ODA5KQ0KICAgICAgICAgICAgICAgICAgICBzb3J0YWJsZS5fc3RvcmVkQ1NTID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHNvcnRhYmxlLnBsYWNlaG9sZGVyLmNzcyggInBvc2l0aW9uIiApLA0KICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiBzb3J0YWJsZS5wbGFjZWhvbGRlci5jc3MoICJ0b3AiICksDQogICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBzb3J0YWJsZS5wbGFjZWhvbGRlci5jc3MoICJsZWZ0IiApDQogICAgICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICAgICAgc29ydGFibGUuX21vdXNlU3RvcCggZXZlbnQgKTsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBPbmNlIGRyYWcgaGFzIGVuZGVkLCB0aGUgc29ydGFibGUgc2hvdWxkIHJldHVybiB0byB1c2luZw0KICAgICAgICAgICAgICAgICAgICAvLyBpdHMgb3JpZ2luYWwgaGVscGVyLCBub3QgdGhlIHNoYXJlZCBoZWxwZXIgZnJvbSBkcmFnZ2FibGUNCiAgICAgICAgICAgICAgICAgICAgc29ydGFibGUub3B0aW9ucy5oZWxwZXIgPSBzb3J0YWJsZS5vcHRpb25zLl9oZWxwZXI7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBQcmV2ZW50IHRoaXMgU29ydGFibGUgZnJvbSByZW1vdmluZyB0aGUgaGVscGVyLg0KICAgICAgICAgICAgICAgICAgICAvLyBIb3dldmVyLCBkb24ndCBzZXQgdGhlIGRyYWdnYWJsZSB0byByZW1vdmUgdGhlIGhlbHBlcg0KICAgICAgICAgICAgICAgICAgICAvLyBlaXRoZXIgYXMgYW5vdGhlciBjb25uZWN0ZWQgU29ydGFibGUgbWF5IHlldCBoYW5kbGUgdGhlIHJlbW92YWwuDQogICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLmNhbmNlbEhlbHBlclJlbW92YWwgPSB0cnVlOw0KDQogICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLl90cmlnZ2VyKCAiZGVhY3RpdmF0ZSIsIGV2ZW50LCB1aVNvcnRhYmxlICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KICAgICAgICBkcmFnOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBkcmFnZ2FibGUgKSB7DQogICAgICAgICAgICAkLmVhY2goIGRyYWdnYWJsZS5zb3J0YWJsZXMsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciBpbm5lcm1vc3RJbnRlcnNlY3RpbmcgPSBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgc29ydGFibGUgPSB0aGlzOw0KDQogICAgICAgICAgICAgICAgLy8gQ29weSBvdmVyIHZhcmlhYmxlcyB0aGF0IHNvcnRhYmxlJ3MgX2ludGVyc2VjdHNXaXRoIHVzZXMNCiAgICAgICAgICAgICAgICBzb3J0YWJsZS5wb3NpdGlvbkFicyA9IGRyYWdnYWJsZS5wb3NpdGlvbkFiczsNCiAgICAgICAgICAgICAgICBzb3J0YWJsZS5oZWxwZXJQcm9wb3J0aW9ucyA9IGRyYWdnYWJsZS5oZWxwZXJQcm9wb3J0aW9uczsNCiAgICAgICAgICAgICAgICBzb3J0YWJsZS5vZmZzZXQuY2xpY2sgPSBkcmFnZ2FibGUub2Zmc2V0LmNsaWNrOw0KDQogICAgICAgICAgICAgICAgaWYgKCBzb3J0YWJsZS5faW50ZXJzZWN0c1dpdGgoIHNvcnRhYmxlLmNvbnRhaW5lckNhY2hlICkgKSB7DQogICAgICAgICAgICAgICAgICAgIGlubmVybW9zdEludGVyc2VjdGluZyA9IHRydWU7DQoNCiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKCBkcmFnZ2FibGUuc29ydGFibGVzLCBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29weSBvdmVyIHZhcmlhYmxlcyB0aGF0IHNvcnRhYmxlJ3MgX2ludGVyc2VjdHNXaXRoIHVzZXMNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb25BYnMgPSBkcmFnZ2FibGUucG9zaXRpb25BYnM7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhlbHBlclByb3BvcnRpb25zID0gZHJhZ2dhYmxlLmhlbHBlclByb3BvcnRpb25zOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQuY2xpY2sgPSBkcmFnZ2FibGUub2Zmc2V0LmNsaWNrOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMgIT09IHNvcnRhYmxlICYmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW50ZXJzZWN0c1dpdGgoIHRoaXMuY29udGFpbmVyQ2FjaGUgKSAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuY29udGFpbnMoIHNvcnRhYmxlLmVsZW1lbnRbIDAgXSwgdGhpcy5lbGVtZW50WyAwIF0gKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lcm1vc3RJbnRlcnNlY3RpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlubmVybW9zdEludGVyc2VjdGluZzsNCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggaW5uZXJtb3N0SW50ZXJzZWN0aW5nICkgew0KDQogICAgICAgICAgICAgICAgICAgIC8vIElmIGl0IGludGVyc2VjdHMsIHdlIHVzZSBhIGxpdHRsZSBpc092ZXIgdmFyaWFibGUgYW5kIHNldCBpdCBvbmNlLA0KICAgICAgICAgICAgICAgICAgICAvLyBzbyB0aGF0IHRoZSBtb3ZlLWluIHN0dWZmIGdldHMgZmlyZWQgb25seSBvbmNlLg0KICAgICAgICAgICAgICAgICAgICBpZiAoICFzb3J0YWJsZS5pc092ZXIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzb3J0YWJsZS5pc092ZXIgPSAxOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBTdG9yZSBkcmFnZ2FibGUncyBwYXJlbnQgaW4gY2FzZSB3ZSBuZWVkIHRvIHJlYXBwZW5kIHRvIGl0IGxhdGVyLg0KICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ2dhYmxlLl9wYXJlbnQgPSB1aS5oZWxwZXIucGFyZW50KCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLmN1cnJlbnRJdGVtID0gdWkuaGVscGVyDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZFRvKCBzb3J0YWJsZS5lbGVtZW50ICkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGF0YSggInVpLXNvcnRhYmxlLWl0ZW0iLCB0cnVlICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0b3JlIGhlbHBlciBvcHRpb24gdG8gbGF0ZXIgcmVzdG9yZSBpdA0KICAgICAgICAgICAgICAgICAgICAgICAgc29ydGFibGUub3B0aW9ucy5faGVscGVyID0gc29ydGFibGUub3B0aW9ucy5oZWxwZXI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLm9wdGlvbnMuaGVscGVyID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVpLmhlbHBlclsgMCBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlyZSB0aGUgc3RhcnQgZXZlbnRzIG9mIHRoZSBzb3J0YWJsZSB3aXRoIG91ciBwYXNzZWQgYnJvd3NlciBldmVudCwNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuZCBvdXIgb3duIGhlbHBlciAoc28gaXQgZG9lc24ndCBjcmVhdGUgYSBuZXcgb25lKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0ID0gc29ydGFibGUuY3VycmVudEl0ZW1bIDAgXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLl9tb3VzZUNhcHR1cmUoIGV2ZW50LCB0cnVlICk7DQogICAgICAgICAgICAgICAgICAgICAgICBzb3J0YWJsZS5fbW91c2VTdGFydCggZXZlbnQsIHRydWUsIHRydWUgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQmVjYXVzZSB0aGUgYnJvd3NlciBldmVudCBpcyB3YXkgb2ZmIHRoZSBuZXcgYXBwZW5kZWQgcG9ydGxldCwNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1vZGlmeSBuZWNlc3NhcnkgdmFyaWFibGVzIHRvIHJlZmxlY3QgdGhlIGNoYW5nZXMNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLm9mZnNldC5jbGljay50b3AgPSBkcmFnZ2FibGUub2Zmc2V0LmNsaWNrLnRvcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLm9mZnNldC5jbGljay5sZWZ0ID0gZHJhZ2dhYmxlLm9mZnNldC5jbGljay5sZWZ0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgc29ydGFibGUub2Zmc2V0LnBhcmVudC5sZWZ0IC09IGRyYWdnYWJsZS5vZmZzZXQucGFyZW50LmxlZnQgLQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLm9mZnNldC5wYXJlbnQubGVmdDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLm9mZnNldC5wYXJlbnQudG9wIC09IGRyYWdnYWJsZS5vZmZzZXQucGFyZW50LnRvcCAtDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydGFibGUub2Zmc2V0LnBhcmVudC50b3A7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdnYWJsZS5fdHJpZ2dlciggInRvU29ydGFibGUiLCBldmVudCApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBJbmZvcm0gZHJhZ2dhYmxlIHRoYXQgdGhlIGhlbHBlciBpcyBpbiBhIHZhbGlkIGRyb3Agem9uZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVzZWQgc29sZWx5IGluIHRoZSByZXZlcnQgb3B0aW9uIHRvIGhhbmRsZSAidmFsaWQvaW52YWxpZCIuDQogICAgICAgICAgICAgICAgICAgICAgICBkcmFnZ2FibGUuZHJvcHBlZCA9IHNvcnRhYmxlLmVsZW1lbnQ7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5lZWQgdG8gcmVmcmVzaFBvc2l0aW9ucyBvZiBhbGwgc29ydGFibGVzIGluIHRoZSBjYXNlIHRoYXQNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZGluZyB0byBvbmUgc29ydGFibGUgY2hhbmdlcyB0aGUgbG9jYXRpb24gb2YgdGhlIG90aGVyIHNvcnRhYmxlcyAoIzk2NzUpDQogICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2goIGRyYWdnYWJsZS5zb3J0YWJsZXMsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFBvc2l0aW9ucygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBIYWNrIHNvIHJlY2VpdmUvdXBkYXRlIGNhbGxiYWNrcyB3b3JrIChtb3N0bHkpDQogICAgICAgICAgICAgICAgICAgICAgICBkcmFnZ2FibGUuY3VycmVudEl0ZW0gPSBkcmFnZ2FibGUuZWxlbWVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLmZyb21PdXRzaWRlID0gZHJhZ2dhYmxlOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBzb3J0YWJsZS5jdXJyZW50SXRlbSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLl9tb3VzZURyYWcoIGV2ZW50ICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIHNvcnRhYmxlJ3MgcG9zaXRpb24gYmVjYXVzZSB0aGUgZHJhZ2dhYmxlJ3MgY2FuIHBvdGVudGlhbGx5IHJlZmxlY3QNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGEgcmVsYXRpdmUgcG9zaXRpb24sIHdoaWxlIHNvcnRhYmxlIGlzIGFsd2F5cyBhYnNvbHV0ZSwgd2hpY2ggdGhlIGRyYWdnZWQNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVsZW1lbnQgaGFzIG5vdyBiZWNvbWUuICgjODgwOSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnBvc2l0aW9uID0gc29ydGFibGUucG9zaXRpb247DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgICAgICAgICAgIC8vIElmIGl0IGRvZXNuJ3QgaW50ZXJzZWN0IHdpdGggdGhlIHNvcnRhYmxlLCBhbmQgaXQgaW50ZXJzZWN0ZWQgYmVmb3JlLA0KICAgICAgICAgICAgICAgICAgICAvLyB3ZSBmYWtlIHRoZSBkcmFnIHN0b3Agb2YgdGhlIHNvcnRhYmxlLCBidXQgbWFrZSBzdXJlIGl0IGRvZXNuJ3QgcmVtb3ZlDQogICAgICAgICAgICAgICAgICAgIC8vIHRoZSBoZWxwZXIgYnkgdXNpbmcgY2FuY2VsSGVscGVyUmVtb3ZhbC4NCiAgICAgICAgICAgICAgICAgICAgaWYgKCBzb3J0YWJsZS5pc092ZXIgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLmlzT3ZlciA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBzb3J0YWJsZS5jYW5jZWxIZWxwZXJSZW1vdmFsID0gdHJ1ZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FsbGluZyBzb3J0YWJsZSdzIG1vdXNlU3RvcCB3b3VsZCB0cmlnZ2VyIGEgcmV2ZXJ0LA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gcmV2ZXJ0IG11c3QgYmUgdGVtcG9yYXJpbHkgZmFsc2UgdW50aWwgYWZ0ZXIgbW91c2VTdG9wIGlzIGNhbGxlZC4NCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLm9wdGlvbnMuX3JldmVydCA9IHNvcnRhYmxlLm9wdGlvbnMucmV2ZXJ0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgc29ydGFibGUub3B0aW9ucy5yZXZlcnQgPSBmYWxzZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgc29ydGFibGUuX3RyaWdnZXIoICJvdXQiLCBldmVudCwgc29ydGFibGUuX3VpSGFzaCggc29ydGFibGUgKSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgc29ydGFibGUuX21vdXNlU3RvcCggZXZlbnQsIHRydWUgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVzdG9yZSBzb3J0YWJsZSBiZWhhdmlvcnMgdGhhdCB3ZXJlIG1vZGZpZWQNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGRyYWdnYWJsZSBlbnRlcmVkIHRoZSBzb3J0YWJsZSBhcmVhICgjOTQ4MSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlLm9wdGlvbnMucmV2ZXJ0ID0gc29ydGFibGUub3B0aW9ucy5fcmV2ZXJ0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgc29ydGFibGUub3B0aW9ucy5oZWxwZXIgPSBzb3J0YWJsZS5vcHRpb25zLl9oZWxwZXI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggc29ydGFibGUucGxhY2Vob2xkZXIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydGFibGUucGxhY2Vob2xkZXIucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlc3RvcmUgYW5kIHJlY2FsY3VsYXRlIHRoZSBkcmFnZ2FibGUncyBvZmZzZXQgY29uc2lkZXJpbmcgdGhlIHNvcnRhYmxlDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBtYXkgaGF2ZSBtb2RpZmllZCB0aGVtIGluIHVuZXhwZWN0ZWQgd2F5cy4gKCM4ODA5LCAjMTA2NjkpDQogICAgICAgICAgICAgICAgICAgICAgICB1aS5oZWxwZXIuYXBwZW5kVG8oIGRyYWdnYWJsZS5fcGFyZW50ICk7DQogICAgICAgICAgICAgICAgICAgICAgICBkcmFnZ2FibGUuX3JlZnJlc2hPZmZzZXRzKCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdWkucG9zaXRpb24gPSBkcmFnZ2FibGUuX2dlbmVyYXRlUG9zaXRpb24oIGV2ZW50LCB0cnVlICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdnYWJsZS5fdHJpZ2dlciggImZyb21Tb3J0YWJsZSIsIGV2ZW50ICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluZm9ybSBkcmFnZ2FibGUgdGhhdCB0aGUgaGVscGVyIGlzIG5vIGxvbmdlciBpbiBhIHZhbGlkIGRyb3Agem9uZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ2dhYmxlLmRyb3BwZWQgPSBmYWxzZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmVlZCB0byByZWZyZXNoUG9zaXRpb25zIG9mIGFsbCBzb3J0YWJsZXMganVzdCBpbiBjYXNlIHJlbW92aW5nDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBmcm9tIG9uZSBzb3J0YWJsZSBjaGFuZ2VzIHRoZSBsb2NhdGlvbiBvZiBvdGhlciBzb3J0YWJsZXMgKCM5Njc1KQ0KICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKCBkcmFnZ2FibGUuc29ydGFibGVzLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfQ0KICAgIH0gKTsNCg0KICAgICQudWkucGx1Z2luLmFkZCggImRyYWdnYWJsZSIsICJjdXJzb3IiLCB7DQogICAgICAgIHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHsNCiAgICAgICAgICAgIHZhciB0ID0gJCggImJvZHkiICksDQogICAgICAgICAgICAgICAgbyA9IGluc3RhbmNlLm9wdGlvbnM7DQoNCiAgICAgICAgICAgIGlmICggdC5jc3MoICJjdXJzb3IiICkgKSB7DQogICAgICAgICAgICAgICAgby5fY3Vyc29yID0gdC5jc3MoICJjdXJzb3IiICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0LmNzcyggImN1cnNvciIsIG8uY3Vyc29yICk7DQogICAgICAgIH0sDQogICAgICAgIHN0b3A6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkgew0KICAgICAgICAgICAgdmFyIG8gPSBpbnN0YW5jZS5vcHRpb25zOw0KICAgICAgICAgICAgaWYgKCBvLl9jdXJzb3IgKSB7DQogICAgICAgICAgICAgICAgJCggImJvZHkiICkuY3NzKCAiY3Vyc29yIiwgby5fY3Vyc29yICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9ICk7DQoNCiAgICAkLnVpLnBsdWdpbi5hZGQoICJkcmFnZ2FibGUiLCAib3BhY2l0eSIsIHsNCiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkgew0KICAgICAgICAgICAgdmFyIHQgPSAkKCB1aS5oZWxwZXIgKSwNCiAgICAgICAgICAgICAgICBvID0gaW5zdGFuY2Uub3B0aW9uczsNCiAgICAgICAgICAgIGlmICggdC5jc3MoICJvcGFjaXR5IiApICkgew0KICAgICAgICAgICAgICAgIG8uX29wYWNpdHkgPSB0LmNzcyggIm9wYWNpdHkiICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0LmNzcyggIm9wYWNpdHkiLCBvLm9wYWNpdHkgKTsNCiAgICAgICAgfSwNCiAgICAgICAgc3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdGFuY2UgKSB7DQogICAgICAgICAgICB2YXIgbyA9IGluc3RhbmNlLm9wdGlvbnM7DQogICAgICAgICAgICBpZiAoIG8uX29wYWNpdHkgKSB7DQogICAgICAgICAgICAgICAgJCggdWkuaGVscGVyICkuY3NzKCAib3BhY2l0eSIsIG8uX29wYWNpdHkgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gKTsNCg0KICAgICQudWkucGx1Z2luLmFkZCggImRyYWdnYWJsZSIsICJzY3JvbGwiLCB7DQogICAgICAgIHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpICkgew0KICAgICAgICAgICAgaWYgKCAhaS5zY3JvbGxQYXJlbnROb3RIaWRkZW4gKSB7DQogICAgICAgICAgICAgICAgaS5zY3JvbGxQYXJlbnROb3RIaWRkZW4gPSBpLmhlbHBlci5zY3JvbGxQYXJlbnQoIGZhbHNlICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggaS5zY3JvbGxQYXJlbnROb3RIaWRkZW5bIDAgXSAhPT0gaS5kb2N1bWVudFsgMCBdICYmDQogICAgICAgICAgICAgICAgaS5zY3JvbGxQYXJlbnROb3RIaWRkZW5bIDAgXS50YWdOYW1lICE9PSAiSFRNTCIgKSB7DQogICAgICAgICAgICAgICAgaS5vdmVyZmxvd09mZnNldCA9IGkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuLm9mZnNldCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBkcmFnOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpICApIHsNCg0KICAgICAgICAgICAgdmFyIG8gPSBpLm9wdGlvbnMsDQogICAgICAgICAgICAgICAgc2Nyb2xsZWQgPSBmYWxzZSwNCiAgICAgICAgICAgICAgICBzY3JvbGxQYXJlbnQgPSBpLnNjcm9sbFBhcmVudE5vdEhpZGRlblsgMCBdLA0KICAgICAgICAgICAgICAgIGRvY3VtZW50ID0gaS5kb2N1bWVudFsgMCBdOw0KDQogICAgICAgICAgICBpZiAoIHNjcm9sbFBhcmVudCAhPT0gZG9jdW1lbnQgJiYgc2Nyb2xsUGFyZW50LnRhZ05hbWUgIT09ICJIVE1MIiApIHsNCiAgICAgICAgICAgICAgICBpZiAoICFvLmF4aXMgfHwgby5heGlzICE9PSAieCIgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggKCBpLm92ZXJmbG93T2Zmc2V0LnRvcCArIHNjcm9sbFBhcmVudC5vZmZzZXRIZWlnaHQgKSAtIGV2ZW50LnBhZ2VZIDwNCiAgICAgICAgICAgICAgICAgICAgICAgIG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxQYXJlbnQuc2Nyb2xsVG9wID0gc2Nyb2xsZWQgPSBzY3JvbGxQYXJlbnQuc2Nyb2xsVG9wICsgby5zY3JvbGxTcGVlZDsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggZXZlbnQucGFnZVkgLSBpLm92ZXJmbG93T2Zmc2V0LnRvcCA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxQYXJlbnQuc2Nyb2xsVG9wID0gc2Nyb2xsZWQgPSBzY3JvbGxQYXJlbnQuc2Nyb2xsVG9wIC0gby5zY3JvbGxTcGVlZDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggIW8uYXhpcyB8fCBvLmF4aXMgIT09ICJ5IiApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAoIGkub3ZlcmZsb3dPZmZzZXQubGVmdCArIHNjcm9sbFBhcmVudC5vZmZzZXRXaWR0aCApIC0gZXZlbnQucGFnZVggPA0KICAgICAgICAgICAgICAgICAgICAgICAgby5zY3JvbGxTZW5zaXRpdml0eSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0ID0gc2Nyb2xsZWQgPSBzY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCArIG8uc2Nyb2xsU3BlZWQ7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIGV2ZW50LnBhZ2VYIC0gaS5vdmVyZmxvd09mZnNldC5sZWZ0IDwgby5zY3JvbGxTZW5zaXRpdml0eSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0ID0gc2Nyb2xsZWQgPSBzY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCAtIG8uc2Nyb2xsU3BlZWQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICBpZiAoICFvLmF4aXMgfHwgby5heGlzICE9PSAieCIgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggZXZlbnQucGFnZVkgLSAkKCBkb2N1bWVudCApLnNjcm9sbFRvcCgpIDwgby5zY3JvbGxTZW5zaXRpdml0eSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbGVkID0gJCggZG9jdW1lbnQgKS5zY3JvbGxUb3AoICQoIGRvY3VtZW50ICkuc2Nyb2xsVG9wKCkgLSBvLnNjcm9sbFNwZWVkICk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoICQoIHdpbmRvdyApLmhlaWdodCgpIC0gKCBldmVudC5wYWdlWSAtICQoIGRvY3VtZW50ICkuc2Nyb2xsVG9wKCkgKSA8DQogICAgICAgICAgICAgICAgICAgICAgICBvLnNjcm9sbFNlbnNpdGl2aXR5ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsZWQgPSAkKCBkb2N1bWVudCApLnNjcm9sbFRvcCggJCggZG9jdW1lbnQgKS5zY3JvbGxUb3AoKSArIG8uc2Nyb2xsU3BlZWQgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggIW8uYXhpcyB8fCBvLmF4aXMgIT09ICJ5IiApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBldmVudC5wYWdlWCAtICQoIGRvY3VtZW50ICkuc2Nyb2xsTGVmdCgpIDwgby5zY3JvbGxTZW5zaXRpdml0eSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbGVkID0gJCggZG9jdW1lbnQgKS5zY3JvbGxMZWZ0KA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIGRvY3VtZW50ICkuc2Nyb2xsTGVmdCgpIC0gby5zY3JvbGxTcGVlZA0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggJCggd2luZG93ICkud2lkdGgoKSAtICggZXZlbnQucGFnZVggLSAkKCBkb2N1bWVudCApLnNjcm9sbExlZnQoKSApIDwNCiAgICAgICAgICAgICAgICAgICAgICAgIG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxlZCA9ICQoIGRvY3VtZW50ICkuc2Nyb2xsTGVmdCgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCBkb2N1bWVudCApLnNjcm9sbExlZnQoKSArIG8uc2Nyb2xsU3BlZWQNCiAgICAgICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCBzY3JvbGxlZCAhPT0gZmFsc2UgJiYgJC51aS5kZG1hbmFnZXIgJiYgIW8uZHJvcEJlaGF2aW91ciApIHsNCiAgICAgICAgICAgICAgICAkLnVpLmRkbWFuYWdlci5wcmVwYXJlT2Zmc2V0cyggaSwgZXZlbnQgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQogICAgfSApOw0KDQogICAgJC51aS5wbHVnaW4uYWRkKCAiZHJhZ2dhYmxlIiwgInNuYXAiLCB7DQogICAgICAgIHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpICkgew0KDQogICAgICAgICAgICB2YXIgbyA9IGkub3B0aW9uczsNCg0KICAgICAgICAgICAgaS5zbmFwRWxlbWVudHMgPSBbXTsNCg0KICAgICAgICAgICAgJCggby5zbmFwLmNvbnN0cnVjdG9yICE9PSBTdHJpbmcgPyAoIG8uc25hcC5pdGVtcyB8fCAiOmRhdGEodWktZHJhZ2dhYmxlKSIgKSA6IG8uc25hcCApDQogICAgICAgICAgICAgICAgLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgJHQgPSAkKCB0aGlzICksDQogICAgICAgICAgICAgICAgICAgICAgICAkbyA9ICR0Lm9mZnNldCgpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMgIT09IGkuZWxlbWVudFsgMCBdICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaS5zbmFwRWxlbWVudHMucHVzaCggew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW06IHRoaXMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICR0Lm91dGVyV2lkdGgoKSwgaGVpZ2h0OiAkdC5vdXRlckhlaWdodCgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogJG8udG9wLCBsZWZ0OiAkby5sZWZ0DQogICAgICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgfSwNCiAgICAgICAgZHJhZzogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdCApIHsNCg0KICAgICAgICAgICAgdmFyIHRzLCBicywgbHMsIHJzLCBsLCByLCB0LCBiLCBpLCBmaXJzdCwNCiAgICAgICAgICAgICAgICBvID0gaW5zdC5vcHRpb25zLA0KICAgICAgICAgICAgICAgIGQgPSBvLnNuYXBUb2xlcmFuY2UsDQogICAgICAgICAgICAgICAgeDEgPSB1aS5vZmZzZXQubGVmdCwgeDIgPSB4MSArIGluc3QuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgsDQogICAgICAgICAgICAgICAgeTEgPSB1aS5vZmZzZXQudG9wLCB5MiA9IHkxICsgaW5zdC5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQ7DQoNCiAgICAgICAgICAgIGZvciAoIGkgPSBpbnN0LnNuYXBFbGVtZW50cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSApIHsNCg0KICAgICAgICAgICAgICAgIGwgPSBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLmxlZnQgLSBpbnN0Lm1hcmdpbnMubGVmdDsNCiAgICAgICAgICAgICAgICByID0gbCArIGluc3Quc25hcEVsZW1lbnRzWyBpIF0ud2lkdGg7DQogICAgICAgICAgICAgICAgdCA9IGluc3Quc25hcEVsZW1lbnRzWyBpIF0udG9wIC0gaW5zdC5tYXJnaW5zLnRvcDsNCiAgICAgICAgICAgICAgICBiID0gdCArIGluc3Quc25hcEVsZW1lbnRzWyBpIF0uaGVpZ2h0Ow0KDQogICAgICAgICAgICAgICAgaWYgKCB4MiA8IGwgLSBkIHx8IHgxID4gciArIGQgfHwgeTIgPCB0IC0gZCB8fCB5MSA+IGIgKyBkIHx8DQogICAgICAgICAgICAgICAgICAgICEkLmNvbnRhaW5zKCBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLml0ZW0ub3duZXJEb2N1bWVudCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGluc3Quc25hcEVsZW1lbnRzWyBpIF0uaXRlbSApICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIGluc3Quc25hcEVsZW1lbnRzWyBpIF0uc25hcHBpbmcgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAoIGluc3Qub3B0aW9ucy5zbmFwLnJlbGVhc2UgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0Lm9wdGlvbnMuc25hcC5yZWxlYXNlLmNhbGwoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3QuZWxlbWVudCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuZXh0ZW5kKCBpbnN0Ll91aUhhc2goKSwgeyBzbmFwSXRlbTogaW5zdC5zbmFwRWxlbWVudHNbIGkgXS5pdGVtIH0gKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLnNuYXBwaW5nID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggby5zbmFwTW9kZSAhPT0gImlubmVyIiApIHsNCiAgICAgICAgICAgICAgICAgICAgdHMgPSBNYXRoLmFicyggdCAtIHkyICkgPD0gZDsNCiAgICAgICAgICAgICAgICAgICAgYnMgPSBNYXRoLmFicyggYiAtIHkxICkgPD0gZDsNCiAgICAgICAgICAgICAgICAgICAgbHMgPSBNYXRoLmFicyggbCAtIHgyICkgPD0gZDsNCiAgICAgICAgICAgICAgICAgICAgcnMgPSBNYXRoLmFicyggciAtIHgxICkgPD0gZDsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0cyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnBvc2l0aW9uLnRvcCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKCAicmVsYXRpdmUiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiB0IC0gaW5zdC5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogMA0KICAgICAgICAgICAgICAgICAgICAgICAgfSApLnRvcDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIGJzICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdWkucG9zaXRpb24udG9wID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oICJyZWxhdGl2ZSIsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6IGIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogMA0KICAgICAgICAgICAgICAgICAgICAgICAgfSApLnRvcDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIGxzICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdWkucG9zaXRpb24ubGVmdCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKCAicmVsYXRpdmUiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IGwgLSBpbnN0LmhlbHBlclByb3BvcnRpb25zLndpZHRoDQogICAgICAgICAgICAgICAgICAgICAgICB9ICkubGVmdDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIHJzICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdWkucG9zaXRpb24ubGVmdCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKCAicmVsYXRpdmUiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IHINCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKS5sZWZ0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgZmlyc3QgPSAoIHRzIHx8IGJzIHx8IGxzIHx8IHJzICk7DQoNCiAgICAgICAgICAgICAgICBpZiAoIG8uc25hcE1vZGUgIT09ICJvdXRlciIgKSB7DQogICAgICAgICAgICAgICAgICAgIHRzID0gTWF0aC5hYnMoIHQgLSB5MSApIDw9IGQ7DQogICAgICAgICAgICAgICAgICAgIGJzID0gTWF0aC5hYnMoIGIgLSB5MiApIDw9IGQ7DQogICAgICAgICAgICAgICAgICAgIGxzID0gTWF0aC5hYnMoIGwgLSB4MSApIDw9IGQ7DQogICAgICAgICAgICAgICAgICAgIHJzID0gTWF0aC5hYnMoIHIgLSB4MiApIDw9IGQ7DQogICAgICAgICAgICAgICAgICAgIGlmICggdHMgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB1aS5wb3NpdGlvbi50b3AgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyggInJlbGF0aXZlIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogdCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwDQogICAgICAgICAgICAgICAgICAgICAgICB9ICkudG9wOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICggYnMgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB1aS5wb3NpdGlvbi50b3AgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyggInJlbGF0aXZlIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogYiAtIGluc3QuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IDANCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKS50b3A7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCBscyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnBvc2l0aW9uLmxlZnQgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyggInJlbGF0aXZlIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBsDQogICAgICAgICAgICAgICAgICAgICAgICB9ICkubGVmdDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIHJzICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdWkucG9zaXRpb24ubGVmdCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKCAicmVsYXRpdmUiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IHIgLSBpbnN0LmhlbHBlclByb3BvcnRpb25zLndpZHRoDQogICAgICAgICAgICAgICAgICAgICAgICB9ICkubGVmdDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggIWluc3Quc25hcEVsZW1lbnRzWyBpIF0uc25hcHBpbmcgJiYgKCB0cyB8fCBicyB8fCBscyB8fCBycyB8fCBmaXJzdCApICkgew0KICAgICAgICAgICAgICAgICAgICAoIGluc3Qub3B0aW9ucy5zbmFwLnNuYXAgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgIGluc3Qub3B0aW9ucy5zbmFwLnNuYXAuY2FsbCgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0LmVsZW1lbnQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5leHRlbmQoIGluc3QuX3VpSGFzaCgpLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNuYXBJdGVtOiBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLml0ZW0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICkgKSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLnNuYXBwaW5nID0gKCB0cyB8fCBicyB8fCBscyB8fCBycyB8fCBmaXJzdCApOw0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgIH0gKTsNCg0KICAgICQudWkucGx1Z2luLmFkZCggImRyYWdnYWJsZSIsICJzdGFjayIsIHsNCiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkgew0KICAgICAgICAgICAgdmFyIG1pbiwNCiAgICAgICAgICAgICAgICBvID0gaW5zdGFuY2Uub3B0aW9ucywNCiAgICAgICAgICAgICAgICBncm91cCA9ICQubWFrZUFycmF5KCAkKCBvLnN0YWNrICkgKS5zb3J0KCBmdW5jdGlvbiggYSwgYiApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICggcGFyc2VJbnQoICQoIGEgKS5jc3MoICJ6SW5kZXgiICksIDEwICkgfHwgMCApIC0NCiAgICAgICAgICAgICAgICAgICAgICAgICggcGFyc2VJbnQoICQoIGIgKS5jc3MoICJ6SW5kZXgiICksIDEwICkgfHwgMCApOw0KICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgaWYgKCAhZ3JvdXAubGVuZ3RoICkgeyByZXR1cm47IH0NCg0KICAgICAgICAgICAgbWluID0gcGFyc2VJbnQoICQoIGdyb3VwWyAwIF0gKS5jc3MoICJ6SW5kZXgiICksIDEwICkgfHwgMDsNCiAgICAgICAgICAgICQoIGdyb3VwICkuZWFjaCggZnVuY3Rpb24oIGkgKSB7DQogICAgICAgICAgICAgICAgJCggdGhpcyApLmNzcyggInpJbmRleCIsIG1pbiArIGkgKTsNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIHRoaXMuY3NzKCAiekluZGV4IiwgKCBtaW4gKyBncm91cC5sZW5ndGggKSApOw0KICAgICAgICB9DQogICAgfSApOw0KDQogICAgJC51aS5wbHVnaW4uYWRkKCAiZHJhZ2dhYmxlIiwgInpJbmRleCIsIHsNCiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkgew0KICAgICAgICAgICAgdmFyIHQgPSAkKCB1aS5oZWxwZXIgKSwNCiAgICAgICAgICAgICAgICBvID0gaW5zdGFuY2Uub3B0aW9uczsNCg0KICAgICAgICAgICAgaWYgKCB0LmNzcyggInpJbmRleCIgKSApIHsNCiAgICAgICAgICAgICAgICBvLl96SW5kZXggPSB0LmNzcyggInpJbmRleCIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHQuY3NzKCAiekluZGV4Iiwgby56SW5kZXggKTsNCiAgICAgICAgfSwNCiAgICAgICAgc3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdGFuY2UgKSB7DQogICAgICAgICAgICB2YXIgbyA9IGluc3RhbmNlLm9wdGlvbnM7DQoNCiAgICAgICAgICAgIGlmICggby5fekluZGV4ICkgew0KICAgICAgICAgICAgICAgICQoIHVpLmhlbHBlciApLmNzcyggInpJbmRleCIsIG8uX3pJbmRleCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSApOw0KDQogICAgdmFyIHdpZGdldHNEcmFnZ2FibGUgPSAkLnVpLmRyYWdnYWJsZTsNCg0KDQogICAgLyohDQogKiBqUXVlcnkgVUkgUmVzaXphYmxlIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBSZXNpemFibGUNCi8vPj5ncm91cDogSW50ZXJhY3Rpb25zDQovLz4+ZGVzY3JpcHRpb246IEVuYWJsZXMgcmVzaXplIGZ1bmN0aW9uYWxpdHkgZm9yIGFueSBlbGVtZW50Lg0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL3Jlc2l6YWJsZS8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9yZXNpemFibGUvDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29yZS5jc3MNCi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9yZXNpemFibGUuY3NzDQovLz4+Y3NzLnRoZW1lOiAuLi8uLi90aGVtZXMvYmFzZS90aGVtZS5jc3MNCg0KDQoNCiAgICAkLndpZGdldCggInVpLnJlc2l6YWJsZSIsICQudWkubW91c2UsIHsNCiAgICAgICAgdmVyc2lvbjogIjEuMTIuMSIsDQogICAgICAgIHdpZGdldEV2ZW50UHJlZml4OiAicmVzaXplIiwNCiAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgYWxzb1Jlc2l6ZTogZmFsc2UsDQogICAgICAgICAgICBhbmltYXRlOiBmYWxzZSwNCiAgICAgICAgICAgIGFuaW1hdGVEdXJhdGlvbjogInNsb3ciLA0KICAgICAgICAgICAgYW5pbWF0ZUVhc2luZzogInN3aW5nIiwNCiAgICAgICAgICAgIGFzcGVjdFJhdGlvOiBmYWxzZSwNCiAgICAgICAgICAgIGF1dG9IaWRlOiBmYWxzZSwNCiAgICAgICAgICAgIGNsYXNzZXM6IHsNCiAgICAgICAgICAgICAgICAidWktcmVzaXphYmxlLXNlIjogInVpLWljb24gdWktaWNvbi1ncmlwc21hbGwtZGlhZ29uYWwtc2UiDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgY29udGFpbm1lbnQ6IGZhbHNlLA0KICAgICAgICAgICAgZ2hvc3Q6IGZhbHNlLA0KICAgICAgICAgICAgZ3JpZDogZmFsc2UsDQogICAgICAgICAgICBoYW5kbGVzOiAiZSxzLHNlIiwNCiAgICAgICAgICAgIGhlbHBlcjogZmFsc2UsDQogICAgICAgICAgICBtYXhIZWlnaHQ6IG51bGwsDQogICAgICAgICAgICBtYXhXaWR0aDogbnVsbCwNCiAgICAgICAgICAgIG1pbkhlaWdodDogMTAsDQogICAgICAgICAgICBtaW5XaWR0aDogMTAsDQoNCiAgICAgICAgICAgIC8vIFNlZSAjNzk2MA0KICAgICAgICAgICAgekluZGV4OiA5MCwNCg0KICAgICAgICAgICAgLy8gQ2FsbGJhY2tzDQogICAgICAgICAgICByZXNpemU6IG51bGwsDQogICAgICAgICAgICBzdGFydDogbnVsbCwNCiAgICAgICAgICAgIHN0b3A6IG51bGwNCiAgICAgICAgfSwNCg0KICAgICAgICBfbnVtOiBmdW5jdGlvbiggdmFsdWUgKSB7DQogICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCggdmFsdWUgKSB8fCAwOw0KICAgICAgICB9LA0KDQogICAgICAgIF9pc051bWJlcjogZnVuY3Rpb24oIHZhbHVlICkgew0KICAgICAgICAgICAgcmV0dXJuICFpc05hTiggcGFyc2VGbG9hdCggdmFsdWUgKSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9oYXNTY3JvbGw6IGZ1bmN0aW9uKCBlbCwgYSApIHsNCg0KICAgICAgICAgICAgaWYgKCAkKCBlbCApLmNzcyggIm92ZXJmbG93IiApID09PSAiaGlkZGVuIiApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciBzY3JvbGwgPSAoIGEgJiYgYSA9PT0gImxlZnQiICkgPyAic2Nyb2xsTGVmdCIgOiAic2Nyb2xsVG9wIiwNCiAgICAgICAgICAgICAgICBoYXMgPSBmYWxzZTsNCg0KICAgICAgICAgICAgaWYgKCBlbFsgc2Nyb2xsIF0gPiAwICkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBUT0RPOiBkZXRlcm1pbmUgd2hpY2ggY2FzZXMgYWN0dWFsbHkgY2F1c2UgdGhpcyB0byBoYXBwZW4NCiAgICAgICAgICAgIC8vIGlmIHRoZSBlbGVtZW50IGRvZXNuJ3QgaGF2ZSB0aGUgc2Nyb2xsIHNldCwgc2VlIGlmIGl0J3MgcG9zc2libGUgdG8NCiAgICAgICAgICAgIC8vIHNldCB0aGUgc2Nyb2xsDQogICAgICAgICAgICBlbFsgc2Nyb2xsIF0gPSAxOw0KICAgICAgICAgICAgaGFzID0gKCBlbFsgc2Nyb2xsIF0gPiAwICk7DQogICAgICAgICAgICBlbFsgc2Nyb2xsIF0gPSAwOw0KICAgICAgICAgICAgcmV0dXJuIGhhczsNCiAgICAgICAgfSwNCg0KICAgICAgICBfY3JlYXRlOiBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgdmFyIG1hcmdpbnMsDQogICAgICAgICAgICAgICAgbyA9IHRoaXMub3B0aW9ucywNCiAgICAgICAgICAgICAgICB0aGF0ID0gdGhpczsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCAidWktcmVzaXphYmxlIiApOw0KDQogICAgICAgICAgICAkLmV4dGVuZCggdGhpcywgew0KICAgICAgICAgICAgICAgIF9hc3BlY3RSYXRpbzogISEoIG8uYXNwZWN0UmF0aW8gKSwNCiAgICAgICAgICAgICAgICBhc3BlY3RSYXRpbzogby5hc3BlY3RSYXRpbywNCiAgICAgICAgICAgICAgICBvcmlnaW5hbEVsZW1lbnQ6IHRoaXMuZWxlbWVudCwNCiAgICAgICAgICAgICAgICBfcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50czogW10sDQogICAgICAgICAgICAgICAgX2hlbHBlcjogby5oZWxwZXIgfHwgby5naG9zdCB8fCBvLmFuaW1hdGUgPyBvLmhlbHBlciB8fCAidWktcmVzaXphYmxlLWhlbHBlciIgOiBudWxsDQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIC8vIFdyYXAgdGhlIGVsZW1lbnQgaWYgaXQgY2Fubm90IGhvbGQgY2hpbGQgbm9kZXMNCiAgICAgICAgICAgIGlmICggdGhpcy5lbGVtZW50WyAwIF0ubm9kZU5hbWUubWF0Y2goIC9eKGNhbnZhc3x0ZXh0YXJlYXxpbnB1dHxzZWxlY3R8YnV0dG9ufGltZykkL2kgKSApIHsNCg0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC53cmFwKA0KICAgICAgICAgICAgICAgICAgICAkKCAiPGRpdiBjbGFzcz0ndWktd3JhcHBlcicgc3R5bGU9J292ZXJmbG93OiBoaWRkZW47Jz48L2Rpdj4iICkuY3NzKCB7DQogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogdGhpcy5lbGVtZW50LmNzcyggInBvc2l0aW9uIiApLA0KICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMuZWxlbWVudC5vdXRlcldpZHRoKCksDQogICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuZWxlbWVudC5vdXRlckhlaWdodCgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiB0aGlzLmVsZW1lbnQuY3NzKCAidG9wIiApLA0KICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogdGhpcy5lbGVtZW50LmNzcyggImxlZnQiICkNCiAgICAgICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgKTsNCg0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IHRoaXMuZWxlbWVudC5wYXJlbnQoKS5kYXRhKA0KICAgICAgICAgICAgICAgICAgICAidWktcmVzaXphYmxlIiwgdGhpcy5lbGVtZW50LnJlc2l6YWJsZSggImluc3RhbmNlIiApDQogICAgICAgICAgICAgICAgKTsNCg0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudElzV3JhcHBlciA9IHRydWU7DQoNCiAgICAgICAgICAgICAgICBtYXJnaW5zID0gew0KICAgICAgICAgICAgICAgICAgICBtYXJnaW5Ub3A6IHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggIm1hcmdpblRvcCIgKSwNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luUmlnaHQ6IHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggIm1hcmdpblJpZ2h0IiApLA0KICAgICAgICAgICAgICAgICAgICBtYXJnaW5Cb3R0b206IHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggIm1hcmdpbkJvdHRvbSIgKSwNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luTGVmdDogdGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCAibWFyZ2luTGVmdCIgKQ0KICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuY3NzKCBtYXJnaW5zICk7DQogICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCAibWFyZ2luIiwgMCApOw0KDQogICAgICAgICAgICAgICAgLy8gc3VwcG9ydDogU2FmYXJpDQogICAgICAgICAgICAgICAgLy8gUHJldmVudCBTYWZhcmkgdGV4dGFyZWEgcmVzaXplDQogICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFJlc2l6ZVN0eWxlID0gdGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCAicmVzaXplIiApOw0KICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggInJlc2l6ZSIsICJub25lIiApOw0KDQogICAgICAgICAgICAgICAgdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5wdXNoKCB0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIHsNCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJzdGF0aWMiLA0KICAgICAgICAgICAgICAgICAgICB6b29tOiAxLA0KICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiAiYmxvY2siDQogICAgICAgICAgICAgICAgfSApICk7DQoNCiAgICAgICAgICAgICAgICAvLyBTdXBwb3J0OiBJRTkNCiAgICAgICAgICAgICAgICAvLyBhdm9pZCBJRSBqdW1wIChoYXJkIHNldCB0aGUgbWFyZ2luKQ0KICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggbWFyZ2lucyApOw0KDQogICAgICAgICAgICAgICAgdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemUoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fc2V0dXBIYW5kbGVzKCk7DQoNCiAgICAgICAgICAgIGlmICggby5hdXRvSGlkZSApIHsNCiAgICAgICAgICAgICAgICAkKCB0aGlzLmVsZW1lbnQgKQ0KICAgICAgICAgICAgICAgICAgICAub24oICJtb3VzZWVudGVyIiwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG8uZGlzYWJsZWQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5fcmVtb3ZlQ2xhc3MoICJ1aS1yZXNpemFibGUtYXV0b2hpZGUiICk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9oYW5kbGVzLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgICAgIC5vbiggIm1vdXNlbGVhdmUiLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggby5kaXNhYmxlZCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoICF0aGF0LnJlc2l6aW5nICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX2FkZENsYXNzKCAidWktcmVzaXphYmxlLWF1dG9oaWRlIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX2hhbmRsZXMuaGlkZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX21vdXNlSW5pdCgpOw0KICAgICAgICB9LA0KDQogICAgICAgIF9kZXN0cm95OiBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgdGhpcy5fbW91c2VEZXN0cm95KCk7DQoNCiAgICAgICAgICAgIHZhciB3cmFwcGVyLA0KICAgICAgICAgICAgICAgIF9kZXN0cm95ID0gZnVuY3Rpb24oIGV4cCApIHsNCiAgICAgICAgICAgICAgICAgICAgJCggZXhwICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVEYXRhKCAicmVzaXphYmxlIiApDQogICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlRGF0YSggInVpLXJlc2l6YWJsZSIgKQ0KICAgICAgICAgICAgICAgICAgICAgICAgLm9mZiggIi5yZXNpemFibGUiICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCAiLnVpLXJlc2l6YWJsZS1oYW5kbGUiICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAvLyBUT0RPOiBVbndyYXAgYXQgc2FtZSBET00gcG9zaXRpb24NCiAgICAgICAgICAgIGlmICggdGhpcy5lbGVtZW50SXNXcmFwcGVyICkgew0KICAgICAgICAgICAgICAgIF9kZXN0cm95KCB0aGlzLmVsZW1lbnQgKTsNCiAgICAgICAgICAgICAgICB3cmFwcGVyID0gdGhpcy5lbGVtZW50Ow0KICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggew0KICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogd3JhcHBlci5jc3MoICJwb3NpdGlvbiIgKSwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHdyYXBwZXIub3V0ZXJXaWR0aCgpLA0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHdyYXBwZXIub3V0ZXJIZWlnaHQoKSwNCiAgICAgICAgICAgICAgICAgICAgdG9wOiB3cmFwcGVyLmNzcyggInRvcCIgKSwNCiAgICAgICAgICAgICAgICAgICAgbGVmdDogd3JhcHBlci5jc3MoICJsZWZ0IiApDQogICAgICAgICAgICAgICAgfSApLmluc2VydEFmdGVyKCB3cmFwcGVyICk7DQogICAgICAgICAgICAgICAgd3JhcHBlci5yZW1vdmUoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCAicmVzaXplIiwgdGhpcy5vcmlnaW5hbFJlc2l6ZVN0eWxlICk7DQogICAgICAgICAgICBfZGVzdHJveSggdGhpcy5vcmlnaW5hbEVsZW1lbnQgKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7DQogICAgICAgICAgICB0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApOw0KDQogICAgICAgICAgICBzd2l0Y2ggKCBrZXkgKSB7DQogICAgICAgICAgICAgICAgY2FzZSAiaGFuZGxlcyI6DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUhhbmRsZXMoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0dXBIYW5kbGVzKCk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXR1cEhhbmRsZXM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIG8gPSB0aGlzLm9wdGlvbnMsIGhhbmRsZSwgaSwgbiwgaG5hbWUsIGF4aXMsIHRoYXQgPSB0aGlzOw0KICAgICAgICAgICAgdGhpcy5oYW5kbGVzID0gby5oYW5kbGVzIHx8DQogICAgICAgICAgICAgICAgKCAhJCggIi51aS1yZXNpemFibGUtaGFuZGxlIiwgdGhpcy5lbGVtZW50ICkubGVuZ3RoID8NCiAgICAgICAgICAgICAgICAgICAgImUscyxzZSIgOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBuOiAiLnVpLXJlc2l6YWJsZS1uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIGU6ICIudWktcmVzaXphYmxlLWUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgczogIi51aS1yZXNpemFibGUtcyIsDQogICAgICAgICAgICAgICAgICAgICAgICB3OiAiLnVpLXJlc2l6YWJsZS13IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlOiAiLnVpLXJlc2l6YWJsZS1zZSIsDQogICAgICAgICAgICAgICAgICAgICAgICBzdzogIi51aS1yZXNpemFibGUtc3ciLA0KICAgICAgICAgICAgICAgICAgICAgICAgbmU6ICIudWktcmVzaXphYmxlLW5lIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIG53OiAiLnVpLXJlc2l6YWJsZS1udyINCiAgICAgICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICB0aGlzLl9oYW5kbGVzID0gJCgpOw0KICAgICAgICAgICAgaWYgKCB0aGlzLmhhbmRsZXMuY29uc3RydWN0b3IgPT09IFN0cmluZyApIHsNCg0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5oYW5kbGVzID09PSAiYWxsIiApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVzID0gIm4sZSxzLHcsc2Usc3csbmUsbnciOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIG4gPSB0aGlzLmhhbmRsZXMuc3BsaXQoICIsIiApOw0KICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlcyA9IHt9Ow0KDQogICAgICAgICAgICAgICAgZm9yICggaSA9IDA7IGkgPCBuLmxlbmd0aDsgaSsrICkgew0KDQogICAgICAgICAgICAgICAgICAgIGhhbmRsZSA9ICQudHJpbSggblsgaSBdICk7DQogICAgICAgICAgICAgICAgICAgIGhuYW1lID0gInVpLXJlc2l6YWJsZS0iICsgaGFuZGxlOw0KICAgICAgICAgICAgICAgICAgICBheGlzID0gJCggIjxkaXY+IiApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggYXhpcywgInVpLXJlc2l6YWJsZS1oYW5kbGUgIiArIGhuYW1lICk7DQoNCiAgICAgICAgICAgICAgICAgICAgYXhpcy5jc3MoIHsgekluZGV4OiBvLnpJbmRleCB9ICk7DQoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVzWyBoYW5kbGUgXSA9ICIudWktcmVzaXphYmxlLSIgKyBoYW5kbGU7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmQoIGF4aXMgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fcmVuZGVyQXhpcyA9IGZ1bmN0aW9uKCB0YXJnZXQgKSB7DQoNCiAgICAgICAgICAgICAgICB2YXIgaSwgYXhpcywgcGFkUG9zLCBwYWRXcmFwcGVyOw0KDQogICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0IHx8IHRoaXMuZWxlbWVudDsNCg0KICAgICAgICAgICAgICAgIGZvciAoIGkgaW4gdGhpcy5oYW5kbGVzICkgew0KDQogICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5oYW5kbGVzWyBpIF0uY29uc3RydWN0b3IgPT09IFN0cmluZyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlc1sgaSBdID0gdGhpcy5lbGVtZW50LmNoaWxkcmVuKCB0aGlzLmhhbmRsZXNbIGkgXSApLmZpcnN0KCkuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB0aGlzLmhhbmRsZXNbIGkgXS5qcXVlcnkgfHwgdGhpcy5oYW5kbGVzWyBpIF0ubm9kZVR5cGUgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXNbIGkgXSA9ICQoIHRoaXMuaGFuZGxlc1sgaSBdICk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbiggdGhpcy5oYW5kbGVzWyBpIF0sIHsgIm1vdXNlZG93biI6IHRoYXQuX21vdXNlRG93biB9ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMuZWxlbWVudElzV3JhcHBlciAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbEVsZW1lbnRbIDAgXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5ub2RlTmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXRjaCggL14odGV4dGFyZWF8aW5wdXR8c2VsZWN0fGJ1dHRvbikkL2kgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF4aXMgPSAkKCB0aGlzLmhhbmRsZXNbIGkgXSwgdGhpcy5lbGVtZW50ICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZFdyYXBwZXIgPSAvc3d8bmV8bnd8c2V8bnxzLy50ZXN0KCBpICkgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF4aXMub3V0ZXJIZWlnaHQoKSA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXhpcy5vdXRlcldpZHRoKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZFBvcyA9IFsgInBhZGRpbmciLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9uZXxud3xuLy50ZXN0KCBpICkgPyAiVG9wIiA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9zZXxzd3xzLy50ZXN0KCBpICkgPyAiQm90dG9tIiA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXmUkLy50ZXN0KCBpICkgPyAiUmlnaHQiIDogIkxlZnQiIF0uam9pbiggIiIgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmNzcyggcGFkUG9zLCBwYWRXcmFwcGVyICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVzID0gdGhpcy5faGFuZGxlcy5hZGQoIHRoaXMuaGFuZGxlc1sgaSBdICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgLy8gVE9ETzogbWFrZSByZW5kZXJBeGlzIGEgcHJvdG90eXBlIGZ1bmN0aW9uDQogICAgICAgICAgICB0aGlzLl9yZW5kZXJBeGlzKCB0aGlzLmVsZW1lbnQgKTsNCg0KICAgICAgICAgICAgdGhpcy5faGFuZGxlcyA9IHRoaXMuX2hhbmRsZXMuYWRkKCB0aGlzLmVsZW1lbnQuZmluZCggIi51aS1yZXNpemFibGUtaGFuZGxlIiApICk7DQogICAgICAgICAgICB0aGlzLl9oYW5kbGVzLmRpc2FibGVTZWxlY3Rpb24oKTsNCg0KICAgICAgICAgICAgdGhpcy5faGFuZGxlcy5vbiggIm1vdXNlb3ZlciIsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGlmICggIXRoYXQucmVzaXppbmcgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5jbGFzc05hbWUgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBheGlzID0gdGhpcy5jbGFzc05hbWUubWF0Y2goIC91aS1yZXNpemFibGUtKHNlfHN3fG5lfG53fG58ZXxzfHcpL2kgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGF0LmF4aXMgPSBheGlzICYmIGF4aXNbIDEgXSA/IGF4aXNbIDEgXSA6ICJzZSI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICBpZiAoIG8uYXV0b0hpZGUgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlcy5oaWRlKCk7DQogICAgICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoICJ1aS1yZXNpemFibGUtYXV0b2hpZGUiICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX3JlbW92ZUhhbmRsZXM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5faGFuZGxlcy5yZW1vdmUoKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfbW91c2VDYXB0dXJlOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgaSwgaGFuZGxlLA0KICAgICAgICAgICAgICAgIGNhcHR1cmUgPSBmYWxzZTsNCg0KICAgICAgICAgICAgZm9yICggaSBpbiB0aGlzLmhhbmRsZXMgKSB7DQogICAgICAgICAgICAgICAgaGFuZGxlID0gJCggdGhpcy5oYW5kbGVzWyBpIF0gKVsgMCBdOw0KICAgICAgICAgICAgICAgIGlmICggaGFuZGxlID09PSBldmVudC50YXJnZXQgfHwgJC5jb250YWlucyggaGFuZGxlLCBldmVudC50YXJnZXQgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgY2FwdHVyZSA9IHRydWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gIXRoaXMub3B0aW9ucy5kaXNhYmxlZCAmJiBjYXB0dXJlOw0KICAgICAgICB9LA0KDQogICAgICAgIF9tb3VzZVN0YXJ0OiBmdW5jdGlvbiggZXZlbnQgKSB7DQoNCiAgICAgICAgICAgIHZhciBjdXJsZWZ0LCBjdXJ0b3AsIGN1cnNvciwNCiAgICAgICAgICAgICAgICBvID0gdGhpcy5vcHRpb25zLA0KICAgICAgICAgICAgICAgIGVsID0gdGhpcy5lbGVtZW50Ow0KDQogICAgICAgICAgICB0aGlzLnJlc2l6aW5nID0gdHJ1ZTsNCg0KICAgICAgICAgICAgdGhpcy5fcmVuZGVyUHJveHkoKTsNCg0KICAgICAgICAgICAgY3VybGVmdCA9IHRoaXMuX251bSggdGhpcy5oZWxwZXIuY3NzKCAibGVmdCIgKSApOw0KICAgICAgICAgICAgY3VydG9wID0gdGhpcy5fbnVtKCB0aGlzLmhlbHBlci5jc3MoICJ0b3AiICkgKTsNCg0KICAgICAgICAgICAgaWYgKCBvLmNvbnRhaW5tZW50ICkgew0KICAgICAgICAgICAgICAgIGN1cmxlZnQgKz0gJCggby5jb250YWlubWVudCApLnNjcm9sbExlZnQoKSB8fCAwOw0KICAgICAgICAgICAgICAgIGN1cnRvcCArPSAkKCBvLmNvbnRhaW5tZW50ICkuc2Nyb2xsVG9wKCkgfHwgMDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5vZmZzZXQgPSB0aGlzLmhlbHBlci5vZmZzZXQoKTsNCiAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSB7IGxlZnQ6IGN1cmxlZnQsIHRvcDogY3VydG9wIH07DQoNCiAgICAgICAgICAgIHRoaXMuc2l6ZSA9IHRoaXMuX2hlbHBlciA/IHsNCiAgICAgICAgICAgICAgICB3aWR0aDogdGhpcy5oZWxwZXIud2lkdGgoKSwNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVscGVyLmhlaWdodCgpDQogICAgICAgICAgICB9IDogew0KICAgICAgICAgICAgICAgIHdpZHRoOiBlbC53aWR0aCgpLA0KICAgICAgICAgICAgICAgIGhlaWdodDogZWwuaGVpZ2h0KCkNCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxTaXplID0gdGhpcy5faGVscGVyID8gew0KICAgICAgICAgICAgICAgIHdpZHRoOiBlbC5vdXRlcldpZHRoKCksDQogICAgICAgICAgICAgICAgaGVpZ2h0OiBlbC5vdXRlckhlaWdodCgpDQogICAgICAgICAgICB9IDogew0KICAgICAgICAgICAgICAgIHdpZHRoOiBlbC53aWR0aCgpLA0KICAgICAgICAgICAgICAgIGhlaWdodDogZWwuaGVpZ2h0KCkNCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIHRoaXMuc2l6ZURpZmYgPSB7DQogICAgICAgICAgICAgICAgd2lkdGg6IGVsLm91dGVyV2lkdGgoKSAtIGVsLndpZHRoKCksDQogICAgICAgICAgICAgICAgaGVpZ2h0OiBlbC5vdXRlckhlaWdodCgpIC0gZWwuaGVpZ2h0KCkNCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxQb3NpdGlvbiA9IHsgbGVmdDogY3VybGVmdCwgdG9wOiBjdXJ0b3AgfTsNCiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxNb3VzZVBvc2l0aW9uID0geyBsZWZ0OiBldmVudC5wYWdlWCwgdG9wOiBldmVudC5wYWdlWSB9Ow0KDQogICAgICAgICAgICB0aGlzLmFzcGVjdFJhdGlvID0gKCB0eXBlb2Ygby5hc3BlY3RSYXRpbyA9PT0gIm51bWJlciIgKSA/DQogICAgICAgICAgICAgICAgby5hc3BlY3RSYXRpbyA6DQogICAgICAgICAgICAgICAgKCAoIHRoaXMub3JpZ2luYWxTaXplLndpZHRoIC8gdGhpcy5vcmlnaW5hbFNpemUuaGVpZ2h0ICkgfHwgMSApOw0KDQogICAgICAgICAgICBjdXJzb3IgPSAkKCAiLnVpLXJlc2l6YWJsZS0iICsgdGhpcy5heGlzICkuY3NzKCAiY3Vyc29yIiApOw0KICAgICAgICAgICAgJCggImJvZHkiICkuY3NzKCAiY3Vyc29yIiwgY3Vyc29yID09PSAiYXV0byIgPyB0aGlzLmF4aXMgKyAiLXJlc2l6ZSIgOiBjdXJzb3IgKTsNCg0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoICJ1aS1yZXNpemFibGUtcmVzaXppbmciICk7DQogICAgICAgICAgICB0aGlzLl9wcm9wYWdhdGUoICJzdGFydCIsIGV2ZW50ICk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfbW91c2VEcmFnOiBmdW5jdGlvbiggZXZlbnQgKSB7DQoNCiAgICAgICAgICAgIHZhciBkYXRhLCBwcm9wcywNCiAgICAgICAgICAgICAgICBzbXAgPSB0aGlzLm9yaWdpbmFsTW91c2VQb3NpdGlvbiwNCiAgICAgICAgICAgICAgICBhID0gdGhpcy5heGlzLA0KICAgICAgICAgICAgICAgIGR4ID0gKCBldmVudC5wYWdlWCAtIHNtcC5sZWZ0ICkgfHwgMCwNCiAgICAgICAgICAgICAgICBkeSA9ICggZXZlbnQucGFnZVkgLSBzbXAudG9wICkgfHwgMCwNCiAgICAgICAgICAgICAgICB0cmlnZ2VyID0gdGhpcy5fY2hhbmdlWyBhIF07DQoNCiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVByZXZQcm9wZXJ0aWVzKCk7DQoNCiAgICAgICAgICAgIGlmICggIXRyaWdnZXIgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBkYXRhID0gdHJpZ2dlci5hcHBseSggdGhpcywgWyBldmVudCwgZHgsIGR5IF0gKTsNCg0KICAgICAgICAgICAgdGhpcy5fdXBkYXRlVmlydHVhbEJvdW5kYXJpZXMoIGV2ZW50LnNoaWZ0S2V5ICk7DQogICAgICAgICAgICBpZiAoIHRoaXMuX2FzcGVjdFJhdGlvIHx8IGV2ZW50LnNoaWZ0S2V5ICkgew0KICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLl91cGRhdGVSYXRpbyggZGF0YSwgZXZlbnQgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZGF0YSA9IHRoaXMuX3Jlc3BlY3RTaXplKCBkYXRhLCBldmVudCApOw0KDQogICAgICAgICAgICB0aGlzLl91cGRhdGVDYWNoZSggZGF0YSApOw0KDQogICAgICAgICAgICB0aGlzLl9wcm9wYWdhdGUoICJyZXNpemUiLCBldmVudCApOw0KDQogICAgICAgICAgICBwcm9wcyA9IHRoaXMuX2FwcGx5Q2hhbmdlcygpOw0KDQogICAgICAgICAgICBpZiAoICF0aGlzLl9oZWxwZXIgJiYgdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemUoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCAhJC5pc0VtcHR5T2JqZWN0KCBwcm9wcyApICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVByZXZQcm9wZXJ0aWVzKCk7DQogICAgICAgICAgICAgICAgdGhpcy5fdHJpZ2dlciggInJlc2l6ZSIsIGV2ZW50LCB0aGlzLnVpKCkgKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9hcHBseUNoYW5nZXMoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9LA0KDQogICAgICAgIF9tb3VzZVN0b3A6IGZ1bmN0aW9uKCBldmVudCApIHsNCg0KICAgICAgICAgICAgdGhpcy5yZXNpemluZyA9IGZhbHNlOw0KICAgICAgICAgICAgdmFyIHByLCBpc3RhLCBzb2Zmc2V0aCwgc29mZnNldHcsIHMsIGxlZnQsIHRvcCwNCiAgICAgICAgICAgICAgICBvID0gdGhpcy5vcHRpb25zLCB0aGF0ID0gdGhpczsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLl9oZWxwZXIgKSB7DQoNCiAgICAgICAgICAgICAgICBwciA9IHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplRWxlbWVudHM7DQogICAgICAgICAgICAgICAgaXN0YSA9IHByLmxlbmd0aCAmJiAoIC90ZXh0YXJlYS9pICkudGVzdCggcHJbIDAgXS5ub2RlTmFtZSApOw0KICAgICAgICAgICAgICAgIHNvZmZzZXRoID0gaXN0YSAmJiB0aGlzLl9oYXNTY3JvbGwoIHByWyAwIF0sICJsZWZ0IiApID8gMCA6IHRoYXQuc2l6ZURpZmYuaGVpZ2h0Ow0KICAgICAgICAgICAgICAgIHNvZmZzZXR3ID0gaXN0YSA/IDAgOiB0aGF0LnNpemVEaWZmLndpZHRoOw0KDQogICAgICAgICAgICAgICAgcyA9IHsNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICggdGhhdC5oZWxwZXIud2lkdGgoKSAgLSBzb2Zmc2V0dyApLA0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6ICggdGhhdC5oZWxwZXIuaGVpZ2h0KCkgLSBzb2Zmc2V0aCApDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBsZWZ0ID0gKCBwYXJzZUZsb2F0KCB0aGF0LmVsZW1lbnQuY3NzKCAibGVmdCIgKSApICsNCiAgICAgICAgICAgICAgICAgICAgKCB0aGF0LnBvc2l0aW9uLmxlZnQgLSB0aGF0Lm9yaWdpbmFsUG9zaXRpb24ubGVmdCApICkgfHwgbnVsbDsNCiAgICAgICAgICAgICAgICB0b3AgPSAoIHBhcnNlRmxvYXQoIHRoYXQuZWxlbWVudC5jc3MoICJ0b3AiICkgKSArDQogICAgICAgICAgICAgICAgICAgICggdGhhdC5wb3NpdGlvbi50b3AgLSB0aGF0Lm9yaWdpbmFsUG9zaXRpb24udG9wICkgKSB8fCBudWxsOw0KDQogICAgICAgICAgICAgICAgaWYgKCAhby5hbmltYXRlICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuY3NzKCAkLmV4dGVuZCggcywgeyB0b3A6IHRvcCwgbGVmdDogbGVmdCB9ICkgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGF0LmhlbHBlci5oZWlnaHQoIHRoYXQuc2l6ZS5oZWlnaHQgKTsNCiAgICAgICAgICAgICAgICB0aGF0LmhlbHBlci53aWR0aCggdGhhdC5zaXplLndpZHRoICk7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuX2hlbHBlciAmJiAhby5hbmltYXRlICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJCggImJvZHkiICkuY3NzKCAiY3Vyc29yIiwgImF1dG8iICk7DQoNCiAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCAidWktcmVzaXphYmxlLXJlc2l6aW5nIiApOw0KDQogICAgICAgICAgICB0aGlzLl9wcm9wYWdhdGUoICJzdG9wIiwgZXZlbnQgKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLl9oZWxwZXIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5oZWxwZXIucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCg0KICAgICAgICB9LA0KDQogICAgICAgIF91cGRhdGVQcmV2UHJvcGVydGllczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLnByZXZQb3NpdGlvbiA9IHsNCiAgICAgICAgICAgICAgICB0b3A6IHRoaXMucG9zaXRpb24udG9wLA0KICAgICAgICAgICAgICAgIGxlZnQ6IHRoaXMucG9zaXRpb24ubGVmdA0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHRoaXMucHJldlNpemUgPSB7DQogICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMuc2l6ZS53aWR0aCwNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuc2l6ZS5oZWlnaHQNCiAgICAgICAgICAgIH07DQogICAgICAgIH0sDQoNCiAgICAgICAgX2FwcGx5Q2hhbmdlczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgcHJvcHMgPSB7fTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLnBvc2l0aW9uLnRvcCAhPT0gdGhpcy5wcmV2UG9zaXRpb24udG9wICkgew0KICAgICAgICAgICAgICAgIHByb3BzLnRvcCA9IHRoaXMucG9zaXRpb24udG9wICsgInB4IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggdGhpcy5wb3NpdGlvbi5sZWZ0ICE9PSB0aGlzLnByZXZQb3NpdGlvbi5sZWZ0ICkgew0KICAgICAgICAgICAgICAgIHByb3BzLmxlZnQgPSB0aGlzLnBvc2l0aW9uLmxlZnQgKyAicHgiOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCB0aGlzLnNpemUud2lkdGggIT09IHRoaXMucHJldlNpemUud2lkdGggKSB7DQogICAgICAgICAgICAgICAgcHJvcHMud2lkdGggPSB0aGlzLnNpemUud2lkdGggKyAicHgiOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCB0aGlzLnNpemUuaGVpZ2h0ICE9PSB0aGlzLnByZXZTaXplLmhlaWdodCApIHsNCiAgICAgICAgICAgICAgICBwcm9wcy5oZWlnaHQgPSB0aGlzLnNpemUuaGVpZ2h0ICsgInB4IjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5oZWxwZXIuY3NzKCBwcm9wcyApOw0KDQogICAgICAgICAgICByZXR1cm4gcHJvcHM7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3VwZGF0ZVZpcnR1YWxCb3VuZGFyaWVzOiBmdW5jdGlvbiggZm9yY2VBc3BlY3RSYXRpbyApIHsNCiAgICAgICAgICAgIHZhciBwTWluV2lkdGgsIHBNYXhXaWR0aCwgcE1pbkhlaWdodCwgcE1heEhlaWdodCwgYiwNCiAgICAgICAgICAgICAgICBvID0gdGhpcy5vcHRpb25zOw0KDQogICAgICAgICAgICBiID0gew0KICAgICAgICAgICAgICAgIG1pbldpZHRoOiB0aGlzLl9pc051bWJlciggby5taW5XaWR0aCApID8gby5taW5XaWR0aCA6IDAsDQogICAgICAgICAgICAgICAgbWF4V2lkdGg6IHRoaXMuX2lzTnVtYmVyKCBvLm1heFdpZHRoICkgPyBvLm1heFdpZHRoIDogSW5maW5pdHksDQogICAgICAgICAgICAgICAgbWluSGVpZ2h0OiB0aGlzLl9pc051bWJlciggby5taW5IZWlnaHQgKSA/IG8ubWluSGVpZ2h0IDogMCwNCiAgICAgICAgICAgICAgICBtYXhIZWlnaHQ6IHRoaXMuX2lzTnVtYmVyKCBvLm1heEhlaWdodCApID8gby5tYXhIZWlnaHQgOiBJbmZpbml0eQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLl9hc3BlY3RSYXRpbyB8fCBmb3JjZUFzcGVjdFJhdGlvICkgew0KICAgICAgICAgICAgICAgIHBNaW5XaWR0aCA9IGIubWluSGVpZ2h0ICogdGhpcy5hc3BlY3RSYXRpbzsNCiAgICAgICAgICAgICAgICBwTWluSGVpZ2h0ID0gYi5taW5XaWR0aCAvIHRoaXMuYXNwZWN0UmF0aW87DQogICAgICAgICAgICAgICAgcE1heFdpZHRoID0gYi5tYXhIZWlnaHQgKiB0aGlzLmFzcGVjdFJhdGlvOw0KICAgICAgICAgICAgICAgIHBNYXhIZWlnaHQgPSBiLm1heFdpZHRoIC8gdGhpcy5hc3BlY3RSYXRpbzsNCg0KICAgICAgICAgICAgICAgIGlmICggcE1pbldpZHRoID4gYi5taW5XaWR0aCApIHsNCiAgICAgICAgICAgICAgICAgICAgYi5taW5XaWR0aCA9IHBNaW5XaWR0aDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCBwTWluSGVpZ2h0ID4gYi5taW5IZWlnaHQgKSB7DQogICAgICAgICAgICAgICAgICAgIGIubWluSGVpZ2h0ID0gcE1pbkhlaWdodDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCBwTWF4V2lkdGggPCBiLm1heFdpZHRoICkgew0KICAgICAgICAgICAgICAgICAgICBiLm1heFdpZHRoID0gcE1heFdpZHRoOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoIHBNYXhIZWlnaHQgPCBiLm1heEhlaWdodCApIHsNCiAgICAgICAgICAgICAgICAgICAgYi5tYXhIZWlnaHQgPSBwTWF4SGVpZ2h0Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX3ZCb3VuZGFyaWVzID0gYjsNCiAgICAgICAgfSwNCg0KICAgICAgICBfdXBkYXRlQ2FjaGU6IGZ1bmN0aW9uKCBkYXRhICkgew0KICAgICAgICAgICAgdGhpcy5vZmZzZXQgPSB0aGlzLmhlbHBlci5vZmZzZXQoKTsNCiAgICAgICAgICAgIGlmICggdGhpcy5faXNOdW1iZXIoIGRhdGEubGVmdCApICkgew0KICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24ubGVmdCA9IGRhdGEubGVmdDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggdGhpcy5faXNOdW1iZXIoIGRhdGEudG9wICkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbi50b3AgPSBkYXRhLnRvcDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggdGhpcy5faXNOdW1iZXIoIGRhdGEuaGVpZ2h0ICkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5zaXplLmhlaWdodCA9IGRhdGEuaGVpZ2h0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCB0aGlzLl9pc051bWJlciggZGF0YS53aWR0aCApICkgew0KICAgICAgICAgICAgICAgIHRoaXMuc2l6ZS53aWR0aCA9IGRhdGEud2lkdGg7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX3VwZGF0ZVJhdGlvOiBmdW5jdGlvbiggZGF0YSApIHsNCg0KICAgICAgICAgICAgdmFyIGNwb3MgPSB0aGlzLnBvc2l0aW9uLA0KICAgICAgICAgICAgICAgIGNzaXplID0gdGhpcy5zaXplLA0KICAgICAgICAgICAgICAgIGEgPSB0aGlzLmF4aXM7DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5faXNOdW1iZXIoIGRhdGEuaGVpZ2h0ICkgKSB7DQogICAgICAgICAgICAgICAgZGF0YS53aWR0aCA9ICggZGF0YS5oZWlnaHQgKiB0aGlzLmFzcGVjdFJhdGlvICk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKCB0aGlzLl9pc051bWJlciggZGF0YS53aWR0aCApICkgew0KICAgICAgICAgICAgICAgIGRhdGEuaGVpZ2h0ID0gKCBkYXRhLndpZHRoIC8gdGhpcy5hc3BlY3RSYXRpbyApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGEgPT09ICJzdyIgKSB7DQogICAgICAgICAgICAgICAgZGF0YS5sZWZ0ID0gY3Bvcy5sZWZ0ICsgKCBjc2l6ZS53aWR0aCAtIGRhdGEud2lkdGggKTsNCiAgICAgICAgICAgICAgICBkYXRhLnRvcCA9IG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIGEgPT09ICJudyIgKSB7DQogICAgICAgICAgICAgICAgZGF0YS50b3AgPSBjcG9zLnRvcCArICggY3NpemUuaGVpZ2h0IC0gZGF0YS5oZWlnaHQgKTsNCiAgICAgICAgICAgICAgICBkYXRhLmxlZnQgPSBjcG9zLmxlZnQgKyAoIGNzaXplLndpZHRoIC0gZGF0YS53aWR0aCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gZGF0YTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcmVzcGVjdFNpemU6IGZ1bmN0aW9uKCBkYXRhICkgew0KDQogICAgICAgICAgICB2YXIgbyA9IHRoaXMuX3ZCb3VuZGFyaWVzLA0KICAgICAgICAgICAgICAgIGEgPSB0aGlzLmF4aXMsDQogICAgICAgICAgICAgICAgaXNtYXh3ID0gdGhpcy5faXNOdW1iZXIoIGRhdGEud2lkdGggKSAmJiBvLm1heFdpZHRoICYmICggby5tYXhXaWR0aCA8IGRhdGEud2lkdGggKSwNCiAgICAgICAgICAgICAgICBpc21heGggPSB0aGlzLl9pc051bWJlciggZGF0YS5oZWlnaHQgKSAmJiBvLm1heEhlaWdodCAmJiAoIG8ubWF4SGVpZ2h0IDwgZGF0YS5oZWlnaHQgKSwNCiAgICAgICAgICAgICAgICBpc21pbncgPSB0aGlzLl9pc051bWJlciggZGF0YS53aWR0aCApICYmIG8ubWluV2lkdGggJiYgKCBvLm1pbldpZHRoID4gZGF0YS53aWR0aCApLA0KICAgICAgICAgICAgICAgIGlzbWluaCA9IHRoaXMuX2lzTnVtYmVyKCBkYXRhLmhlaWdodCApICYmIG8ubWluSGVpZ2h0ICYmICggby5taW5IZWlnaHQgPiBkYXRhLmhlaWdodCApLA0KICAgICAgICAgICAgICAgIGR3ID0gdGhpcy5vcmlnaW5hbFBvc2l0aW9uLmxlZnQgKyB0aGlzLm9yaWdpbmFsU2l6ZS53aWR0aCwNCiAgICAgICAgICAgICAgICBkaCA9IHRoaXMub3JpZ2luYWxQb3NpdGlvbi50b3AgKyB0aGlzLm9yaWdpbmFsU2l6ZS5oZWlnaHQsDQogICAgICAgICAgICAgICAgY3cgPSAvc3d8bnd8dy8udGVzdCggYSApLCBjaCA9IC9ud3xuZXxuLy50ZXN0KCBhICk7DQogICAgICAgICAgICBpZiAoIGlzbWludyApIHsNCiAgICAgICAgICAgICAgICBkYXRhLndpZHRoID0gby5taW5XaWR0aDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggaXNtaW5oICkgew0KICAgICAgICAgICAgICAgIGRhdGEuaGVpZ2h0ID0gby5taW5IZWlnaHQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIGlzbWF4dyApIHsNCiAgICAgICAgICAgICAgICBkYXRhLndpZHRoID0gby5tYXhXaWR0aDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggaXNtYXhoICkgew0KICAgICAgICAgICAgICAgIGRhdGEuaGVpZ2h0ID0gby5tYXhIZWlnaHQ7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggaXNtaW53ICYmIGN3ICkgew0KICAgICAgICAgICAgICAgIGRhdGEubGVmdCA9IGR3IC0gby5taW5XaWR0aDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggaXNtYXh3ICYmIGN3ICkgew0KICAgICAgICAgICAgICAgIGRhdGEubGVmdCA9IGR3IC0gby5tYXhXaWR0aDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggaXNtaW5oICYmIGNoICkgew0KICAgICAgICAgICAgICAgIGRhdGEudG9wID0gZGggLSBvLm1pbkhlaWdodDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggaXNtYXhoICYmIGNoICkgew0KICAgICAgICAgICAgICAgIGRhdGEudG9wID0gZGggLSBvLm1heEhlaWdodDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gRml4aW5nIGp1bXAgZXJyb3Igb24gdG9wL2xlZnQgLSBidWcgIzIzMzANCiAgICAgICAgICAgIGlmICggIWRhdGEud2lkdGggJiYgIWRhdGEuaGVpZ2h0ICYmICFkYXRhLmxlZnQgJiYgZGF0YS50b3AgKSB7DQogICAgICAgICAgICAgICAgZGF0YS50b3AgPSBudWxsOw0KICAgICAgICAgICAgfSBlbHNlIGlmICggIWRhdGEud2lkdGggJiYgIWRhdGEuaGVpZ2h0ICYmICFkYXRhLnRvcCAmJiBkYXRhLmxlZnQgKSB7DQogICAgICAgICAgICAgICAgZGF0YS5sZWZ0ID0gbnVsbDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGRhdGE7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2dldFBhZGRpbmdQbHVzQm9yZGVyRGltZW5zaW9uczogZnVuY3Rpb24oIGVsZW1lbnQgKSB7DQogICAgICAgICAgICB2YXIgaSA9IDAsDQogICAgICAgICAgICAgICAgd2lkdGhzID0gW10sDQogICAgICAgICAgICAgICAgYm9yZGVycyA9IFsNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jc3MoICJib3JkZXJUb3BXaWR0aCIgKSwNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jc3MoICJib3JkZXJSaWdodFdpZHRoIiApLA0KICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNzcyggImJvcmRlckJvdHRvbVdpZHRoIiApLA0KICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNzcyggImJvcmRlckxlZnRXaWR0aCIgKQ0KICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgcGFkZGluZ3MgPSBbDQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY3NzKCAicGFkZGluZ1RvcCIgKSwNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jc3MoICJwYWRkaW5nUmlnaHQiICksDQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY3NzKCAicGFkZGluZ0JvdHRvbSIgKSwNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jc3MoICJwYWRkaW5nTGVmdCIgKQ0KICAgICAgICAgICAgICAgIF07DQoNCiAgICAgICAgICAgIGZvciAoIDsgaSA8IDQ7IGkrKyApIHsNCiAgICAgICAgICAgICAgICB3aWR0aHNbIGkgXSA9ICggcGFyc2VGbG9hdCggYm9yZGVyc1sgaSBdICkgfHwgMCApOw0KICAgICAgICAgICAgICAgIHdpZHRoc1sgaSBdICs9ICggcGFyc2VGbG9hdCggcGFkZGluZ3NbIGkgXSApIHx8IDAgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IHdpZHRoc1sgMCBdICsgd2lkdGhzWyAyIF0sDQogICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoc1sgMSBdICsgd2lkdGhzWyAzIF0NCiAgICAgICAgICAgIH07DQogICAgICAgIH0sDQoNCiAgICAgICAgX3Byb3BvcnRpb25hbGx5UmVzaXplOiBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgaWYgKCAhdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgcHJlbCwNCiAgICAgICAgICAgICAgICBpID0gMCwNCiAgICAgICAgICAgICAgICBlbGVtZW50ID0gdGhpcy5oZWxwZXIgfHwgdGhpcy5lbGVtZW50Ow0KDQogICAgICAgICAgICBmb3IgKCA7IGkgPCB0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzLmxlbmd0aDsgaSsrICkgew0KDQogICAgICAgICAgICAgICAgcHJlbCA9IHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplRWxlbWVudHNbIGkgXTsNCg0KICAgICAgICAgICAgICAgIC8vIFRPRE86IFNlZW1zIGxpa2UgYSBidWcgdG8gY2FjaGUgdGhpcy5vdXRlckRpbWVuc2lvbnMNCiAgICAgICAgICAgICAgICAvLyBjb25zaWRlcmluZyB0aGF0IHdlIGFyZSBpbiBhIGxvb3AuDQogICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5vdXRlckRpbWVuc2lvbnMgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub3V0ZXJEaW1lbnNpb25zID0gdGhpcy5fZ2V0UGFkZGluZ1BsdXNCb3JkZXJEaW1lbnNpb25zKCBwcmVsICk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcHJlbC5jc3MoIHsNCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAoIGVsZW1lbnQuaGVpZ2h0KCkgLSB0aGlzLm91dGVyRGltZW5zaW9ucy5oZWlnaHQgKSB8fCAwLA0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogKCBlbGVtZW50LndpZHRoKCkgLSB0aGlzLm91dGVyRGltZW5zaW9ucy53aWR0aCApIHx8IDANCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9LA0KDQogICAgICAgIF9yZW5kZXJQcm94eTogZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgIHZhciBlbCA9IHRoaXMuZWxlbWVudCwgbyA9IHRoaXMub3B0aW9uczsNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudE9mZnNldCA9IGVsLm9mZnNldCgpOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMuX2hlbHBlciApIHsNCg0KICAgICAgICAgICAgICAgIHRoaXMuaGVscGVyID0gdGhpcy5oZWxwZXIgfHwgJCggIjxkaXYgc3R5bGU9J292ZXJmbG93OmhpZGRlbjsnPjwvZGl2PiIgKTsNCg0KICAgICAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLmhlbHBlciwgdGhpcy5faGVscGVyICk7DQogICAgICAgICAgICAgICAgdGhpcy5oZWxwZXIuY3NzKCB7DQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiB0aGlzLmVsZW1lbnQub3V0ZXJXaWR0aCgpLA0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuZWxlbWVudC5vdXRlckhlaWdodCgpLA0KICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogImFic29sdXRlIiwNCiAgICAgICAgICAgICAgICAgICAgbGVmdDogdGhpcy5lbGVtZW50T2Zmc2V0LmxlZnQgKyAicHgiLA0KICAgICAgICAgICAgICAgICAgICB0b3A6IHRoaXMuZWxlbWVudE9mZnNldC50b3AgKyAicHgiLA0KICAgICAgICAgICAgICAgICAgICB6SW5kZXg6ICsrby56SW5kZXggLy9UT0RPOiBEb24ndCBtb2RpZnkgb3B0aW9uDQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgdGhpcy5oZWxwZXINCiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZFRvKCAiYm9keSIgKQ0KICAgICAgICAgICAgICAgICAgICAuZGlzYWJsZVNlbGVjdGlvbigpOw0KDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuaGVscGVyID0gdGhpcy5lbGVtZW50Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0sDQoNCiAgICAgICAgX2NoYW5nZTogew0KICAgICAgICAgICAgZTogZnVuY3Rpb24oIGV2ZW50LCBkeCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4geyB3aWR0aDogdGhpcy5vcmlnaW5hbFNpemUud2lkdGggKyBkeCB9Ow0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHc6IGZ1bmN0aW9uKCBldmVudCwgZHggKSB7DQogICAgICAgICAgICAgICAgdmFyIGNzID0gdGhpcy5vcmlnaW5hbFNpemUsIHNwID0gdGhpcy5vcmlnaW5hbFBvc2l0aW9uOw0KICAgICAgICAgICAgICAgIHJldHVybiB7IGxlZnQ6IHNwLmxlZnQgKyBkeCwgd2lkdGg6IGNzLndpZHRoIC0gZHggfTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBuOiBmdW5jdGlvbiggZXZlbnQsIGR4LCBkeSApIHsNCiAgICAgICAgICAgICAgICB2YXIgY3MgPSB0aGlzLm9yaWdpbmFsU2l6ZSwgc3AgPSB0aGlzLm9yaWdpbmFsUG9zaXRpb247DQogICAgICAgICAgICAgICAgcmV0dXJuIHsgdG9wOiBzcC50b3AgKyBkeSwgaGVpZ2h0OiBjcy5oZWlnaHQgLSBkeSB9Ow0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHM6IGZ1bmN0aW9uKCBldmVudCwgZHgsIGR5ICkgew0KICAgICAgICAgICAgICAgIHJldHVybiB7IGhlaWdodDogdGhpcy5vcmlnaW5hbFNpemUuaGVpZ2h0ICsgZHkgfTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBzZTogZnVuY3Rpb24oIGV2ZW50LCBkeCwgZHkgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICQuZXh0ZW5kKCB0aGlzLl9jaGFuZ2Uucy5hcHBseSggdGhpcywgYXJndW1lbnRzICksDQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2NoYW5nZS5lLmFwcGx5KCB0aGlzLCBbIGV2ZW50LCBkeCwgZHkgXSApICk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgc3c6IGZ1bmN0aW9uKCBldmVudCwgZHgsIGR5ICkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkLmV4dGVuZCggdGhpcy5fY2hhbmdlLnMuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApLA0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGFuZ2Uudy5hcHBseSggdGhpcywgWyBldmVudCwgZHgsIGR5IF0gKSApOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG5lOiBmdW5jdGlvbiggZXZlbnQsIGR4LCBkeSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJC5leHRlbmQoIHRoaXMuX2NoYW5nZS5uLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSwNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hhbmdlLmUuYXBwbHkoIHRoaXMsIFsgZXZlbnQsIGR4LCBkeSBdICkgKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBudzogZnVuY3Rpb24oIGV2ZW50LCBkeCwgZHkgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICQuZXh0ZW5kKCB0aGlzLl9jaGFuZ2Uubi5hcHBseSggdGhpcywgYXJndW1lbnRzICksDQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2NoYW5nZS53LmFwcGx5KCB0aGlzLCBbIGV2ZW50LCBkeCwgZHkgXSApICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX3Byb3BhZ2F0ZTogZnVuY3Rpb24oIG4sIGV2ZW50ICkgew0KICAgICAgICAgICAgJC51aS5wbHVnaW4uY2FsbCggdGhpcywgbiwgWyBldmVudCwgdGhpcy51aSgpIF0gKTsNCiAgICAgICAgICAgICggbiAhPT0gInJlc2l6ZSIgJiYgdGhpcy5fdHJpZ2dlciggbiwgZXZlbnQsIHRoaXMudWkoKSApICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgcGx1Z2luczoge30sDQoNCiAgICAgICAgdWk6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBvcmlnaW5hbEVsZW1lbnQ6IHRoaXMub3JpZ2luYWxFbGVtZW50LA0KICAgICAgICAgICAgICAgIGVsZW1lbnQ6IHRoaXMuZWxlbWVudCwNCiAgICAgICAgICAgICAgICBoZWxwZXI6IHRoaXMuaGVscGVyLA0KICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0aGlzLnBvc2l0aW9uLA0KICAgICAgICAgICAgICAgIHNpemU6IHRoaXMuc2l6ZSwNCiAgICAgICAgICAgICAgICBvcmlnaW5hbFNpemU6IHRoaXMub3JpZ2luYWxTaXplLA0KICAgICAgICAgICAgICAgIG9yaWdpbmFsUG9zaXRpb246IHRoaXMub3JpZ2luYWxQb3NpdGlvbg0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KDQogICAgfSApOw0KDQogICAgLyoNCiAqIFJlc2l6YWJsZSBFeHRlbnNpb25zDQogKi8NCg0KICAgICQudWkucGx1Z2luLmFkZCggInJlc2l6YWJsZSIsICJhbmltYXRlIiwgew0KDQogICAgICAgIHN0b3A6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciB0aGF0ID0gJCggdGhpcyApLnJlc2l6YWJsZSggImluc3RhbmNlIiApLA0KICAgICAgICAgICAgICAgIG8gPSB0aGF0Lm9wdGlvbnMsDQogICAgICAgICAgICAgICAgcHIgPSB0aGF0Ll9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzLA0KICAgICAgICAgICAgICAgIGlzdGEgPSBwci5sZW5ndGggJiYgKCAvdGV4dGFyZWEvaSApLnRlc3QoIHByWyAwIF0ubm9kZU5hbWUgKSwNCiAgICAgICAgICAgICAgICBzb2Zmc2V0aCA9IGlzdGEgJiYgdGhhdC5faGFzU2Nyb2xsKCBwclsgMCBdLCAibGVmdCIgKSA/IDAgOiB0aGF0LnNpemVEaWZmLmhlaWdodCwNCiAgICAgICAgICAgICAgICBzb2Zmc2V0dyA9IGlzdGEgPyAwIDogdGhhdC5zaXplRGlmZi53aWR0aCwNCiAgICAgICAgICAgICAgICBzdHlsZSA9IHsNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICggdGhhdC5zaXplLndpZHRoIC0gc29mZnNldHcgKSwNCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAoIHRoYXQuc2l6ZS5oZWlnaHQgLSBzb2Zmc2V0aCApDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBsZWZ0ID0gKCBwYXJzZUZsb2F0KCB0aGF0LmVsZW1lbnQuY3NzKCAibGVmdCIgKSApICsNCiAgICAgICAgICAgICAgICAgICAgKCB0aGF0LnBvc2l0aW9uLmxlZnQgLSB0aGF0Lm9yaWdpbmFsUG9zaXRpb24ubGVmdCApICkgfHwgbnVsbCwNCiAgICAgICAgICAgICAgICB0b3AgPSAoIHBhcnNlRmxvYXQoIHRoYXQuZWxlbWVudC5jc3MoICJ0b3AiICkgKSArDQogICAgICAgICAgICAgICAgICAgICggdGhhdC5wb3NpdGlvbi50b3AgLSB0aGF0Lm9yaWdpbmFsUG9zaXRpb24udG9wICkgKSB8fCBudWxsOw0KDQogICAgICAgICAgICB0aGF0LmVsZW1lbnQuYW5pbWF0ZSgNCiAgICAgICAgICAgICAgICAkLmV4dGVuZCggc3R5bGUsIHRvcCAmJiBsZWZ0ID8geyB0b3A6IHRvcCwgbGVmdDogbGVmdCB9IDoge30gKSwgew0KICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogby5hbmltYXRlRHVyYXRpb24sDQogICAgICAgICAgICAgICAgICAgIGVhc2luZzogby5hbmltYXRlRWFzaW5nLA0KICAgICAgICAgICAgICAgICAgICBzdGVwOiBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHBhcnNlRmxvYXQoIHRoYXQuZWxlbWVudC5jc3MoICJ3aWR0aCIgKSApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogcGFyc2VGbG9hdCggdGhhdC5lbGVtZW50LmNzcyggImhlaWdodCIgKSApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogcGFyc2VGbG9hdCggdGhhdC5lbGVtZW50LmNzcyggInRvcCIgKSApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IHBhcnNlRmxvYXQoIHRoYXQuZWxlbWVudC5jc3MoICJsZWZ0IiApICkNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggcHIgJiYgcHIubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIHByWyAwIF0gKS5jc3MoIHsgd2lkdGg6IGRhdGEud2lkdGgsIGhlaWdodDogZGF0YS5oZWlnaHQgfSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBQcm9wYWdhdGluZyByZXNpemUsIGFuZCB1cGRhdGluZyB2YWx1ZXMgZm9yIGVhY2ggYW5pbWF0aW9uIHN0ZXANCiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3VwZGF0ZUNhY2hlKCBkYXRhICk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9wcm9wYWdhdGUoICJyZXNpemUiLCBldmVudCApOw0KDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICApOw0KICAgICAgICB9DQoNCiAgICB9ICk7DQoNCiAgICAkLnVpLnBsdWdpbi5hZGQoICJyZXNpemFibGUiLCAiY29udGFpbm1lbnQiLCB7DQoNCiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGVsZW1lbnQsIHAsIGNvLCBjaCwgY3csIHdpZHRoLCBoZWlnaHQsDQogICAgICAgICAgICAgICAgdGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoICJpbnN0YW5jZSIgKSwNCiAgICAgICAgICAgICAgICBvID0gdGhhdC5vcHRpb25zLA0KICAgICAgICAgICAgICAgIGVsID0gdGhhdC5lbGVtZW50LA0KICAgICAgICAgICAgICAgIG9jID0gby5jb250YWlubWVudCwNCiAgICAgICAgICAgICAgICBjZSA9ICggb2MgaW5zdGFuY2VvZiAkICkgPw0KICAgICAgICAgICAgICAgICAgICBvYy5nZXQoIDAgKSA6DQogICAgICAgICAgICAgICAgICAgICggL3BhcmVudC8udGVzdCggb2MgKSApID8gZWwucGFyZW50KCkuZ2V0KCAwICkgOiBvYzsNCg0KICAgICAgICAgICAgaWYgKCAhY2UgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGF0LmNvbnRhaW5lckVsZW1lbnQgPSAkKCBjZSApOw0KDQogICAgICAgICAgICBpZiAoIC9kb2N1bWVudC8udGVzdCggb2MgKSB8fCBvYyA9PT0gZG9jdW1lbnQgKSB7DQogICAgICAgICAgICAgICAgdGhhdC5jb250YWluZXJPZmZzZXQgPSB7DQogICAgICAgICAgICAgICAgICAgIGxlZnQ6IDAsDQogICAgICAgICAgICAgICAgICAgIHRvcDogMA0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgdGhhdC5jb250YWluZXJQb3NpdGlvbiA9IHsNCiAgICAgICAgICAgICAgICAgICAgbGVmdDogMCwNCiAgICAgICAgICAgICAgICAgICAgdG9wOiAwDQogICAgICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgICAgIHRoYXQucGFyZW50RGF0YSA9IHsNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogJCggZG9jdW1lbnQgKSwNCiAgICAgICAgICAgICAgICAgICAgbGVmdDogMCwNCiAgICAgICAgICAgICAgICAgICAgdG9wOiAwLA0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogJCggZG9jdW1lbnQgKS53aWR0aCgpLA0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6ICQoIGRvY3VtZW50ICkuaGVpZ2h0KCkgfHwgZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodA0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGVsZW1lbnQgPSAkKCBjZSApOw0KICAgICAgICAgICAgICAgIHAgPSBbXTsNCiAgICAgICAgICAgICAgICAkKCBbICJUb3AiLCAiUmlnaHQiLCAiTGVmdCIsICJCb3R0b20iIF0gKS5lYWNoKCBmdW5jdGlvbiggaSwgbmFtZSApIHsNCiAgICAgICAgICAgICAgICAgICAgcFsgaSBdID0gdGhhdC5fbnVtKCBlbGVtZW50LmNzcyggInBhZGRpbmciICsgbmFtZSApICk7DQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgdGhhdC5jb250YWluZXJPZmZzZXQgPSBlbGVtZW50Lm9mZnNldCgpOw0KICAgICAgICAgICAgICAgIHRoYXQuY29udGFpbmVyUG9zaXRpb24gPSBlbGVtZW50LnBvc2l0aW9uKCk7DQogICAgICAgICAgICAgICAgdGhhdC5jb250YWluZXJTaXplID0gew0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6ICggZWxlbWVudC5pbm5lckhlaWdodCgpIC0gcFsgMyBdICksDQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiAoIGVsZW1lbnQuaW5uZXJXaWR0aCgpIC0gcFsgMSBdICkNCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAgICAgY28gPSB0aGF0LmNvbnRhaW5lck9mZnNldDsNCiAgICAgICAgICAgICAgICBjaCA9IHRoYXQuY29udGFpbmVyU2l6ZS5oZWlnaHQ7DQogICAgICAgICAgICAgICAgY3cgPSB0aGF0LmNvbnRhaW5lclNpemUud2lkdGg7DQogICAgICAgICAgICAgICAgd2lkdGggPSAoIHRoYXQuX2hhc1Njcm9sbCAoIGNlLCAibGVmdCIgKSA/IGNlLnNjcm9sbFdpZHRoIDogY3cgKTsNCiAgICAgICAgICAgICAgICBoZWlnaHQgPSAoIHRoYXQuX2hhc1Njcm9sbCAoIGNlICkgPyBjZS5zY3JvbGxIZWlnaHQgOiBjaCApIDsNCg0KICAgICAgICAgICAgICAgIHRoYXQucGFyZW50RGF0YSA9IHsNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogY2UsDQogICAgICAgICAgICAgICAgICAgIGxlZnQ6IGNvLmxlZnQsDQogICAgICAgICAgICAgICAgICAgIHRvcDogY28udG9wLA0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICByZXNpemU6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciB3b3NldCwgaG9zZXQsIGlzUGFyZW50LCBpc09mZnNldFJlbGF0aXZlLA0KICAgICAgICAgICAgICAgIHRoYXQgPSAkKCB0aGlzICkucmVzaXphYmxlKCAiaW5zdGFuY2UiICksDQogICAgICAgICAgICAgICAgbyA9IHRoYXQub3B0aW9ucywNCiAgICAgICAgICAgICAgICBjbyA9IHRoYXQuY29udGFpbmVyT2Zmc2V0LA0KICAgICAgICAgICAgICAgIGNwID0gdGhhdC5wb3NpdGlvbiwNCiAgICAgICAgICAgICAgICBwUmF0aW8gPSB0aGF0Ll9hc3BlY3RSYXRpbyB8fCBldmVudC5zaGlmdEtleSwNCiAgICAgICAgICAgICAgICBjb3AgPSB7DQogICAgICAgICAgICAgICAgICAgIHRvcDogMCwNCiAgICAgICAgICAgICAgICAgICAgbGVmdDogMA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgY2UgPSB0aGF0LmNvbnRhaW5lckVsZW1lbnQsDQogICAgICAgICAgICAgICAgY29udGludWVSZXNpemUgPSB0cnVlOw0KDQogICAgICAgICAgICBpZiAoIGNlWyAwIF0gIT09IGRvY3VtZW50ICYmICggL3N0YXRpYy8gKS50ZXN0KCBjZS5jc3MoICJwb3NpdGlvbiIgKSApICkgew0KICAgICAgICAgICAgICAgIGNvcCA9IGNvOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGNwLmxlZnQgPCAoIHRoYXQuX2hlbHBlciA/IGNvLmxlZnQgOiAwICkgKSB7DQogICAgICAgICAgICAgICAgdGhhdC5zaXplLndpZHRoID0gdGhhdC5zaXplLndpZHRoICsNCiAgICAgICAgICAgICAgICAgICAgKCB0aGF0Ll9oZWxwZXIgPw0KICAgICAgICAgICAgICAgICAgICAgICAgKCB0aGF0LnBvc2l0aW9uLmxlZnQgLSBjby5sZWZ0ICkgOg0KICAgICAgICAgICAgICAgICAgICAgICAgKCB0aGF0LnBvc2l0aW9uLmxlZnQgLSBjb3AubGVmdCApICk7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHBSYXRpbyApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5zaXplLmhlaWdodCA9IHRoYXQuc2l6ZS53aWR0aCAvIHRoYXQuYXNwZWN0UmF0aW87DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlUmVzaXplID0gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoYXQucG9zaXRpb24ubGVmdCA9IG8uaGVscGVyID8gY28ubGVmdCA6IDA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggY3AudG9wIDwgKCB0aGF0Ll9oZWxwZXIgPyBjby50b3AgOiAwICkgKSB7DQogICAgICAgICAgICAgICAgdGhhdC5zaXplLmhlaWdodCA9IHRoYXQuc2l6ZS5oZWlnaHQgKw0KICAgICAgICAgICAgICAgICAgICAoIHRoYXQuX2hlbHBlciA/DQogICAgICAgICAgICAgICAgICAgICAgICAoIHRoYXQucG9zaXRpb24udG9wIC0gY28udG9wICkgOg0KICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5wb3NpdGlvbi50b3AgKTsNCg0KICAgICAgICAgICAgICAgIGlmICggcFJhdGlvICkgew0KICAgICAgICAgICAgICAgICAgICB0aGF0LnNpemUud2lkdGggPSB0aGF0LnNpemUuaGVpZ2h0ICogdGhhdC5hc3BlY3RSYXRpbzsNCiAgICAgICAgICAgICAgICAgICAgY29udGludWVSZXNpemUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhhdC5wb3NpdGlvbi50b3AgPSB0aGF0Ll9oZWxwZXIgPyBjby50b3AgOiAwOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpc1BhcmVudCA9IHRoYXQuY29udGFpbmVyRWxlbWVudC5nZXQoIDAgKSA9PT0gdGhhdC5lbGVtZW50LnBhcmVudCgpLmdldCggMCApOw0KICAgICAgICAgICAgaXNPZmZzZXRSZWxhdGl2ZSA9IC9yZWxhdGl2ZXxhYnNvbHV0ZS8udGVzdCggdGhhdC5jb250YWluZXJFbGVtZW50LmNzcyggInBvc2l0aW9uIiApICk7DQoNCiAgICAgICAgICAgIGlmICggaXNQYXJlbnQgJiYgaXNPZmZzZXRSZWxhdGl2ZSApIHsNCiAgICAgICAgICAgICAgICB0aGF0Lm9mZnNldC5sZWZ0ID0gdGhhdC5wYXJlbnREYXRhLmxlZnQgKyB0aGF0LnBvc2l0aW9uLmxlZnQ7DQogICAgICAgICAgICAgICAgdGhhdC5vZmZzZXQudG9wID0gdGhhdC5wYXJlbnREYXRhLnRvcCArIHRoYXQucG9zaXRpb24udG9wOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGF0Lm9mZnNldC5sZWZ0ID0gdGhhdC5lbGVtZW50Lm9mZnNldCgpLmxlZnQ7DQogICAgICAgICAgICAgICAgdGhhdC5vZmZzZXQudG9wID0gdGhhdC5lbGVtZW50Lm9mZnNldCgpLnRvcDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd29zZXQgPSBNYXRoLmFicyggdGhhdC5zaXplRGlmZi53aWR0aCArDQogICAgICAgICAgICAgICAgKCB0aGF0Ll9oZWxwZXIgPw0KICAgICAgICAgICAgICAgICAgICB0aGF0Lm9mZnNldC5sZWZ0IC0gY29wLmxlZnQgOg0KICAgICAgICAgICAgICAgICAgICAoIHRoYXQub2Zmc2V0LmxlZnQgLSBjby5sZWZ0ICkgKSApOw0KDQogICAgICAgICAgICBob3NldCA9IE1hdGguYWJzKCB0aGF0LnNpemVEaWZmLmhlaWdodCArDQogICAgICAgICAgICAgICAgKCB0aGF0Ll9oZWxwZXIgPw0KICAgICAgICAgICAgICAgICAgICB0aGF0Lm9mZnNldC50b3AgLSBjb3AudG9wIDoNCiAgICAgICAgICAgICAgICAgICAgKCB0aGF0Lm9mZnNldC50b3AgLSBjby50b3AgKSApICk7DQoNCiAgICAgICAgICAgIGlmICggd29zZXQgKyB0aGF0LnNpemUud2lkdGggPj0gdGhhdC5wYXJlbnREYXRhLndpZHRoICkgew0KICAgICAgICAgICAgICAgIHRoYXQuc2l6ZS53aWR0aCA9IHRoYXQucGFyZW50RGF0YS53aWR0aCAtIHdvc2V0Ow0KICAgICAgICAgICAgICAgIGlmICggcFJhdGlvICkgew0KICAgICAgICAgICAgICAgICAgICB0aGF0LnNpemUuaGVpZ2h0ID0gdGhhdC5zaXplLndpZHRoIC8gdGhhdC5hc3BlY3RSYXRpbzsNCiAgICAgICAgICAgICAgICAgICAgY29udGludWVSZXNpemUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggaG9zZXQgKyB0aGF0LnNpemUuaGVpZ2h0ID49IHRoYXQucGFyZW50RGF0YS5oZWlnaHQgKSB7DQogICAgICAgICAgICAgICAgdGhhdC5zaXplLmhlaWdodCA9IHRoYXQucGFyZW50RGF0YS5oZWlnaHQgLSBob3NldDsNCiAgICAgICAgICAgICAgICBpZiAoIHBSYXRpbyApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5zaXplLndpZHRoID0gdGhhdC5zaXplLmhlaWdodCAqIHRoYXQuYXNwZWN0UmF0aW87DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlUmVzaXplID0gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoICFjb250aW51ZVJlc2l6ZSApIHsNCiAgICAgICAgICAgICAgICB0aGF0LnBvc2l0aW9uLmxlZnQgPSB0aGF0LnByZXZQb3NpdGlvbi5sZWZ0Ow0KICAgICAgICAgICAgICAgIHRoYXQucG9zaXRpb24udG9wID0gdGhhdC5wcmV2UG9zaXRpb24udG9wOw0KICAgICAgICAgICAgICAgIHRoYXQuc2l6ZS53aWR0aCA9IHRoYXQucHJldlNpemUud2lkdGg7DQogICAgICAgICAgICAgICAgdGhhdC5zaXplLmhlaWdodCA9IHRoYXQucHJldlNpemUuaGVpZ2h0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHN0b3A6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSAkKCB0aGlzICkucmVzaXphYmxlKCAiaW5zdGFuY2UiICksDQogICAgICAgICAgICAgICAgbyA9IHRoYXQub3B0aW9ucywNCiAgICAgICAgICAgICAgICBjbyA9IHRoYXQuY29udGFpbmVyT2Zmc2V0LA0KICAgICAgICAgICAgICAgIGNvcCA9IHRoYXQuY29udGFpbmVyUG9zaXRpb24sDQogICAgICAgICAgICAgICAgY2UgPSB0aGF0LmNvbnRhaW5lckVsZW1lbnQsDQogICAgICAgICAgICAgICAgaGVscGVyID0gJCggdGhhdC5oZWxwZXIgKSwNCiAgICAgICAgICAgICAgICBobyA9IGhlbHBlci5vZmZzZXQoKSwNCiAgICAgICAgICAgICAgICB3ID0gaGVscGVyLm91dGVyV2lkdGgoKSAtIHRoYXQuc2l6ZURpZmYud2lkdGgsDQogICAgICAgICAgICAgICAgaCA9IGhlbHBlci5vdXRlckhlaWdodCgpIC0gdGhhdC5zaXplRGlmZi5oZWlnaHQ7DQoNCiAgICAgICAgICAgIGlmICggdGhhdC5faGVscGVyICYmICFvLmFuaW1hdGUgJiYgKCAvcmVsYXRpdmUvICkudGVzdCggY2UuY3NzKCAicG9zaXRpb24iICkgKSApIHsNCiAgICAgICAgICAgICAgICAkKCB0aGlzICkuY3NzKCB7DQogICAgICAgICAgICAgICAgICAgIGxlZnQ6IGhvLmxlZnQgLSBjb3AubGVmdCAtIGNvLmxlZnQsDQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiB3LA0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGgNCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGhhdC5faGVscGVyICYmICFvLmFuaW1hdGUgJiYgKCAvc3RhdGljLyApLnRlc3QoIGNlLmNzcyggInBvc2l0aW9uIiApICkgKSB7DQogICAgICAgICAgICAgICAgJCggdGhpcyApLmNzcyggew0KICAgICAgICAgICAgICAgICAgICBsZWZ0OiBoby5sZWZ0IC0gY29wLmxlZnQgLSBjby5sZWZ0LA0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogdywNCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBoDQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSApOw0KDQogICAgJC51aS5wbHVnaW4uYWRkKCAicmVzaXphYmxlIiwgImFsc29SZXNpemUiLCB7DQoNCiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSAkKCB0aGlzICkucmVzaXphYmxlKCAiaW5zdGFuY2UiICksDQogICAgICAgICAgICAgICAgbyA9IHRoYXQub3B0aW9uczsNCg0KICAgICAgICAgICAgJCggby5hbHNvUmVzaXplICkuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIGVsID0gJCggdGhpcyApOw0KICAgICAgICAgICAgICAgIGVsLmRhdGEoICJ1aS1yZXNpemFibGUtYWxzb3Jlc2l6ZSIsIHsNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHBhcnNlRmxvYXQoIGVsLndpZHRoKCkgKSwgaGVpZ2h0OiBwYXJzZUZsb2F0KCBlbC5oZWlnaHQoKSApLA0KICAgICAgICAgICAgICAgICAgICBsZWZ0OiBwYXJzZUZsb2F0KCBlbC5jc3MoICJsZWZ0IiApICksIHRvcDogcGFyc2VGbG9hdCggZWwuY3NzKCAidG9wIiApICkNCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgcmVzaXplOiBmdW5jdGlvbiggZXZlbnQsIHVpICkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSAkKCB0aGlzICkucmVzaXphYmxlKCAiaW5zdGFuY2UiICksDQogICAgICAgICAgICAgICAgbyA9IHRoYXQub3B0aW9ucywNCiAgICAgICAgICAgICAgICBvcyA9IHRoYXQub3JpZ2luYWxTaXplLA0KICAgICAgICAgICAgICAgIG9wID0gdGhhdC5vcmlnaW5hbFBvc2l0aW9uLA0KICAgICAgICAgICAgICAgIGRlbHRhID0gew0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6ICggdGhhdC5zaXplLmhlaWdodCAtIG9zLmhlaWdodCApIHx8IDAsDQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiAoIHRoYXQuc2l6ZS53aWR0aCAtIG9zLndpZHRoICkgfHwgMCwNCiAgICAgICAgICAgICAgICAgICAgdG9wOiAoIHRoYXQucG9zaXRpb24udG9wIC0gb3AudG9wICkgfHwgMCwNCiAgICAgICAgICAgICAgICAgICAgbGVmdDogKCB0aGF0LnBvc2l0aW9uLmxlZnQgLSBvcC5sZWZ0ICkgfHwgMA0KICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICQoIG8uYWxzb1Jlc2l6ZSApLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciBlbCA9ICQoIHRoaXMgKSwgc3RhcnQgPSAkKCB0aGlzICkuZGF0YSggInVpLXJlc2l6YWJsZS1hbHNvcmVzaXplIiApLCBzdHlsZSA9IHt9LA0KICAgICAgICAgICAgICAgICAgICBjc3MgPSBlbC5wYXJlbnRzKCB1aS5vcmlnaW5hbEVsZW1lbnRbIDAgXSApLmxlbmd0aCA/DQogICAgICAgICAgICAgICAgICAgICAgICBbICJ3aWR0aCIsICJoZWlnaHQiIF0gOg0KICAgICAgICAgICAgICAgICAgICAgICAgWyAid2lkdGgiLCAiaGVpZ2h0IiwgInRvcCIsICJsZWZ0IiBdOw0KDQogICAgICAgICAgICAgICAgJC5lYWNoKCBjc3MsIGZ1bmN0aW9uKCBpLCBwcm9wICkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgc3VtID0gKCBzdGFydFsgcHJvcCBdIHx8IDAgKSArICggZGVsdGFbIHByb3AgXSB8fCAwICk7DQogICAgICAgICAgICAgICAgICAgIGlmICggc3VtICYmIHN1bSA+PSAwICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGVbIHByb3AgXSA9IHN1bSB8fCBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgZWwuY3NzKCBzdHlsZSApOw0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIHN0b3A6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgJCggdGhpcyApLnJlbW92ZURhdGEoICJ1aS1yZXNpemFibGUtYWxzb3Jlc2l6ZSIgKTsNCiAgICAgICAgfQ0KICAgIH0gKTsNCg0KICAgICQudWkucGx1Z2luLmFkZCggInJlc2l6YWJsZSIsICJnaG9zdCIsIHsNCg0KICAgICAgICBzdGFydDogZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgIHZhciB0aGF0ID0gJCggdGhpcyApLnJlc2l6YWJsZSggImluc3RhbmNlIiApLCBjcyA9IHRoYXQuc2l6ZTsNCg0KICAgICAgICAgICAgdGhhdC5naG9zdCA9IHRoYXQub3JpZ2luYWxFbGVtZW50LmNsb25lKCk7DQogICAgICAgICAgICB0aGF0Lmdob3N0LmNzcyggew0KICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAuMjUsDQogICAgICAgICAgICAgICAgZGlzcGxheTogImJsb2NrIiwNCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInJlbGF0aXZlIiwNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IGNzLmhlaWdodCwNCiAgICAgICAgICAgICAgICB3aWR0aDogY3Mud2lkdGgsDQogICAgICAgICAgICAgICAgbWFyZ2luOiAwLA0KICAgICAgICAgICAgICAgIGxlZnQ6IDAsDQogICAgICAgICAgICAgICAgdG9wOiAwDQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIHRoYXQuX2FkZENsYXNzKCB0aGF0Lmdob3N0LCAidWktcmVzaXphYmxlLWdob3N0IiApOw0KDQogICAgICAgICAgICAvLyBERVBSRUNBVEVEDQogICAgICAgICAgICAvLyBUT0RPOiByZW1vdmUgYWZ0ZXIgMS4xMg0KICAgICAgICAgICAgaWYgKCAkLnVpQmFja0NvbXBhdCAhPT0gZmFsc2UgJiYgdHlwZW9mIHRoYXQub3B0aW9ucy5naG9zdCA9PT0gInN0cmluZyIgKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBHaG9zdCBvcHRpb24NCiAgICAgICAgICAgICAgICB0aGF0Lmdob3N0LmFkZENsYXNzKCB0aGlzLm9wdGlvbnMuZ2hvc3QgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhhdC5naG9zdC5hcHBlbmRUbyggdGhhdC5oZWxwZXIgKTsNCg0KICAgICAgICB9LA0KDQogICAgICAgIHJlc2l6ZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgdGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoICJpbnN0YW5jZSIgKTsNCiAgICAgICAgICAgIGlmICggdGhhdC5naG9zdCApIHsNCiAgICAgICAgICAgICAgICB0aGF0Lmdob3N0LmNzcyggew0KICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInJlbGF0aXZlIiwNCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiB0aGF0LnNpemUuaGVpZ2h0LA0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogdGhhdC5zaXplLndpZHRoDQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHN0b3A6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSAkKCB0aGlzICkucmVzaXphYmxlKCAiaW5zdGFuY2UiICk7DQogICAgICAgICAgICBpZiAoIHRoYXQuZ2hvc3QgJiYgdGhhdC5oZWxwZXIgKSB7DQogICAgICAgICAgICAgICAgdGhhdC5oZWxwZXIuZ2V0KCAwICkucmVtb3ZlQ2hpbGQoIHRoYXQuZ2hvc3QuZ2V0KCAwICkgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgfSApOw0KDQogICAgJC51aS5wbHVnaW4uYWRkKCAicmVzaXphYmxlIiwgImdyaWQiLCB7DQoNCiAgICAgICAgcmVzaXplOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBvdXRlckRpbWVuc2lvbnMsDQogICAgICAgICAgICAgICAgdGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoICJpbnN0YW5jZSIgKSwNCiAgICAgICAgICAgICAgICBvID0gdGhhdC5vcHRpb25zLA0KICAgICAgICAgICAgICAgIGNzID0gdGhhdC5zaXplLA0KICAgICAgICAgICAgICAgIG9zID0gdGhhdC5vcmlnaW5hbFNpemUsDQogICAgICAgICAgICAgICAgb3AgPSB0aGF0Lm9yaWdpbmFsUG9zaXRpb24sDQogICAgICAgICAgICAgICAgYSA9IHRoYXQuYXhpcywNCiAgICAgICAgICAgICAgICBncmlkID0gdHlwZW9mIG8uZ3JpZCA9PT0gIm51bWJlciIgPyBbIG8uZ3JpZCwgby5ncmlkIF0gOiBvLmdyaWQsDQogICAgICAgICAgICAgICAgZ3JpZFggPSAoIGdyaWRbIDAgXSB8fCAxICksDQogICAgICAgICAgICAgICAgZ3JpZFkgPSAoIGdyaWRbIDEgXSB8fCAxICksDQogICAgICAgICAgICAgICAgb3ggPSBNYXRoLnJvdW5kKCAoIGNzLndpZHRoIC0gb3Mud2lkdGggKSAvIGdyaWRYICkgKiBncmlkWCwNCiAgICAgICAgICAgICAgICBveSA9IE1hdGgucm91bmQoICggY3MuaGVpZ2h0IC0gb3MuaGVpZ2h0ICkgLyBncmlkWSApICogZ3JpZFksDQogICAgICAgICAgICAgICAgbmV3V2lkdGggPSBvcy53aWR0aCArIG94LA0KICAgICAgICAgICAgICAgIG5ld0hlaWdodCA9IG9zLmhlaWdodCArIG95LA0KICAgICAgICAgICAgICAgIGlzTWF4V2lkdGggPSBvLm1heFdpZHRoICYmICggby5tYXhXaWR0aCA8IG5ld1dpZHRoICksDQogICAgICAgICAgICAgICAgaXNNYXhIZWlnaHQgPSBvLm1heEhlaWdodCAmJiAoIG8ubWF4SGVpZ2h0IDwgbmV3SGVpZ2h0ICksDQogICAgICAgICAgICAgICAgaXNNaW5XaWR0aCA9IG8ubWluV2lkdGggJiYgKCBvLm1pbldpZHRoID4gbmV3V2lkdGggKSwNCiAgICAgICAgICAgICAgICBpc01pbkhlaWdodCA9IG8ubWluSGVpZ2h0ICYmICggby5taW5IZWlnaHQgPiBuZXdIZWlnaHQgKTsNCg0KICAgICAgICAgICAgby5ncmlkID0gZ3JpZDsNCg0KICAgICAgICAgICAgaWYgKCBpc01pbldpZHRoICkgew0KICAgICAgICAgICAgICAgIG5ld1dpZHRoICs9IGdyaWRYOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCBpc01pbkhlaWdodCApIHsNCiAgICAgICAgICAgICAgICBuZXdIZWlnaHQgKz0gZ3JpZFk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIGlzTWF4V2lkdGggKSB7DQogICAgICAgICAgICAgICAgbmV3V2lkdGggLT0gZ3JpZFg7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIGlzTWF4SGVpZ2h0ICkgew0KICAgICAgICAgICAgICAgIG5ld0hlaWdodCAtPSBncmlkWTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCAvXihzZXxzfGUpJC8udGVzdCggYSApICkgew0KICAgICAgICAgICAgICAgIHRoYXQuc2l6ZS53aWR0aCA9IG5ld1dpZHRoOw0KICAgICAgICAgICAgICAgIHRoYXQuc2l6ZS5oZWlnaHQgPSBuZXdIZWlnaHQ7DQogICAgICAgICAgICB9IGVsc2UgaWYgKCAvXihuZSkkLy50ZXN0KCBhICkgKSB7DQogICAgICAgICAgICAgICAgdGhhdC5zaXplLndpZHRoID0gbmV3V2lkdGg7DQogICAgICAgICAgICAgICAgdGhhdC5zaXplLmhlaWdodCA9IG5ld0hlaWdodDsNCiAgICAgICAgICAgICAgICB0aGF0LnBvc2l0aW9uLnRvcCA9IG9wLnRvcCAtIG95Ow0KICAgICAgICAgICAgfSBlbHNlIGlmICggL14oc3cpJC8udGVzdCggYSApICkgew0KICAgICAgICAgICAgICAgIHRoYXQuc2l6ZS53aWR0aCA9IG5ld1dpZHRoOw0KICAgICAgICAgICAgICAgIHRoYXQuc2l6ZS5oZWlnaHQgPSBuZXdIZWlnaHQ7DQogICAgICAgICAgICAgICAgdGhhdC5wb3NpdGlvbi5sZWZ0ID0gb3AubGVmdCAtIG94Ow0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAoIG5ld0hlaWdodCAtIGdyaWRZIDw9IDAgfHwgbmV3V2lkdGggLSBncmlkWCA8PSAwICkgew0KICAgICAgICAgICAgICAgICAgICBvdXRlckRpbWVuc2lvbnMgPSB0aGF0Ll9nZXRQYWRkaW5nUGx1c0JvcmRlckRpbWVuc2lvbnMoIHRoaXMgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoIG5ld0hlaWdodCAtIGdyaWRZID4gMCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5zaXplLmhlaWdodCA9IG5ld0hlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5wb3NpdGlvbi50b3AgPSBvcC50b3AgLSBveTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBuZXdIZWlnaHQgPSBncmlkWSAtIG91dGVyRGltZW5zaW9ucy5oZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuc2l6ZS5oZWlnaHQgPSBuZXdIZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgIHRoYXQucG9zaXRpb24udG9wID0gb3AudG9wICsgb3MuaGVpZ2h0IC0gbmV3SGVpZ2h0Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoIG5ld1dpZHRoIC0gZ3JpZFggPiAwICkgew0KICAgICAgICAgICAgICAgICAgICB0aGF0LnNpemUud2lkdGggPSBuZXdXaWR0aDsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5wb3NpdGlvbi5sZWZ0ID0gb3AubGVmdCAtIG94Ow0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIG5ld1dpZHRoID0gZ3JpZFggLSBvdXRlckRpbWVuc2lvbnMud2lkdGg7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuc2l6ZS53aWR0aCA9IG5ld1dpZHRoOw0KICAgICAgICAgICAgICAgICAgICB0aGF0LnBvc2l0aW9uLmxlZnQgPSBvcC5sZWZ0ICsgb3Mud2lkdGggLSBuZXdXaWR0aDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgIH0gKTsNCg0KICAgIHZhciB3aWRnZXRzUmVzaXphYmxlID0gJC51aS5yZXNpemFibGU7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIERpYWxvZyAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogRGlhbG9nDQovLz4+Z3JvdXA6IFdpZGdldHMNCi8vPj5kZXNjcmlwdGlvbjogRGlzcGxheXMgY3VzdG9taXphYmxlIGRpYWxvZyB3aW5kb3dzLg0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2RpYWxvZy8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9kaWFsb2cvDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29yZS5jc3MNCi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9kaWFsb2cuY3NzDQovLz4+Y3NzLnRoZW1lOiAuLi8uLi90aGVtZXMvYmFzZS90aGVtZS5jc3MNCg0KDQoNCiAgICAkLndpZGdldCggInVpLmRpYWxvZyIsIHsNCiAgICAgICAgdmVyc2lvbjogIjEuMTIuMSIsDQogICAgICAgIG9wdGlvbnM6IHsNCiAgICAgICAgICAgIGFwcGVuZFRvOiAiYm9keSIsDQogICAgICAgICAgICBhdXRvT3BlbjogdHJ1ZSwNCiAgICAgICAgICAgIGJ1dHRvbnM6IFtdLA0KICAgICAgICAgICAgY2xhc3Nlczogew0KICAgICAgICAgICAgICAgICJ1aS1kaWFsb2ciOiAidWktY29ybmVyLWFsbCIsDQogICAgICAgICAgICAgICAgInVpLWRpYWxvZy10aXRsZWJhciI6ICJ1aS1jb3JuZXItYWxsIg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGNsb3NlT25Fc2NhcGU6IHRydWUsDQogICAgICAgICAgICBjbG9zZVRleHQ6ICJDbG9zZSIsDQogICAgICAgICAgICBkcmFnZ2FibGU6IHRydWUsDQogICAgICAgICAgICBoaWRlOiBudWxsLA0KICAgICAgICAgICAgaGVpZ2h0OiAiYXV0byIsDQogICAgICAgICAgICBtYXhIZWlnaHQ6IG51bGwsDQogICAgICAgICAgICBtYXhXaWR0aDogbnVsbCwNCiAgICAgICAgICAgIG1pbkhlaWdodDogMTUwLA0KICAgICAgICAgICAgbWluV2lkdGg6IDE1MCwNCiAgICAgICAgICAgIG1vZGFsOiBmYWxzZSwNCiAgICAgICAgICAgIHBvc2l0aW9uOiB7DQogICAgICAgICAgICAgICAgbXk6ICJjZW50ZXIiLA0KICAgICAgICAgICAgICAgIGF0OiAiY2VudGVyIiwNCiAgICAgICAgICAgICAgICBvZjogd2luZG93LA0KICAgICAgICAgICAgICAgIGNvbGxpc2lvbjogImZpdCIsDQoNCiAgICAgICAgICAgICAgICAvLyBFbnN1cmUgdGhlIHRpdGxlYmFyIGlzIGFsd2F5cyB2aXNpYmxlDQogICAgICAgICAgICAgICAgdXNpbmc6IGZ1bmN0aW9uKCBwb3MgKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciB0b3BPZmZzZXQgPSAkKCB0aGlzICkuY3NzKCBwb3MgKS5vZmZzZXQoKS50b3A7DQogICAgICAgICAgICAgICAgICAgIGlmICggdG9wT2Zmc2V0IDwgMCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQoIHRoaXMgKS5jc3MoICJ0b3AiLCBwb3MudG9wIC0gdG9wT2Zmc2V0ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgcmVzaXphYmxlOiB0cnVlLA0KICAgICAgICAgICAgc2hvdzogbnVsbCwNCiAgICAgICAgICAgIHRpdGxlOiBudWxsLA0KICAgICAgICAgICAgd2lkdGg6IDMwMCwNCg0KICAgICAgICAgICAgLy8gQ2FsbGJhY2tzDQogICAgICAgICAgICBiZWZvcmVDbG9zZTogbnVsbCwNCiAgICAgICAgICAgIGNsb3NlOiBudWxsLA0KICAgICAgICAgICAgZHJhZzogbnVsbCwNCiAgICAgICAgICAgIGRyYWdTdGFydDogbnVsbCwNCiAgICAgICAgICAgIGRyYWdTdG9wOiBudWxsLA0KICAgICAgICAgICAgZm9jdXM6IG51bGwsDQogICAgICAgICAgICBvcGVuOiBudWxsLA0KICAgICAgICAgICAgcmVzaXplOiBudWxsLA0KICAgICAgICAgICAgcmVzaXplU3RhcnQ6IG51bGwsDQogICAgICAgICAgICByZXNpemVTdG9wOiBudWxsDQogICAgICAgIH0sDQoNCiAgICAgICAgc2l6ZVJlbGF0ZWRPcHRpb25zOiB7DQogICAgICAgICAgICBidXR0b25zOiB0cnVlLA0KICAgICAgICAgICAgaGVpZ2h0OiB0cnVlLA0KICAgICAgICAgICAgbWF4SGVpZ2h0OiB0cnVlLA0KICAgICAgICAgICAgbWF4V2lkdGg6IHRydWUsDQogICAgICAgICAgICBtaW5IZWlnaHQ6IHRydWUsDQogICAgICAgICAgICBtaW5XaWR0aDogdHJ1ZSwNCiAgICAgICAgICAgIHdpZHRoOiB0cnVlDQogICAgICAgIH0sDQoNCiAgICAgICAgcmVzaXphYmxlUmVsYXRlZE9wdGlvbnM6IHsNCiAgICAgICAgICAgIG1heEhlaWdodDogdHJ1ZSwNCiAgICAgICAgICAgIG1heFdpZHRoOiB0cnVlLA0KICAgICAgICAgICAgbWluSGVpZ2h0OiB0cnVlLA0KICAgICAgICAgICAgbWluV2lkdGg6IHRydWUNCiAgICAgICAgfSwNCg0KICAgICAgICBfY3JlYXRlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxDc3MgPSB7DQogICAgICAgICAgICAgICAgZGlzcGxheTogdGhpcy5lbGVtZW50WyAwIF0uc3R5bGUuZGlzcGxheSwNCiAgICAgICAgICAgICAgICB3aWR0aDogdGhpcy5lbGVtZW50WyAwIF0uc3R5bGUud2lkdGgsDQogICAgICAgICAgICAgICAgbWluSGVpZ2h0OiB0aGlzLmVsZW1lbnRbIDAgXS5zdHlsZS5taW5IZWlnaHQsDQogICAgICAgICAgICAgICAgbWF4SGVpZ2h0OiB0aGlzLmVsZW1lbnRbIDAgXS5zdHlsZS5tYXhIZWlnaHQsDQogICAgICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmVsZW1lbnRbIDAgXS5zdHlsZS5oZWlnaHQNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICB0aGlzLm9yaWdpbmFsUG9zaXRpb24gPSB7DQogICAgICAgICAgICAgICAgcGFyZW50OiB0aGlzLmVsZW1lbnQucGFyZW50KCksDQogICAgICAgICAgICAgICAgaW5kZXg6IHRoaXMuZWxlbWVudC5wYXJlbnQoKS5jaGlsZHJlbigpLmluZGV4KCB0aGlzLmVsZW1lbnQgKQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxUaXRsZSA9IHRoaXMuZWxlbWVudC5hdHRyKCAidGl0bGUiICk7DQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy50aXRsZSA9PSBudWxsICYmIHRoaXMub3JpZ2luYWxUaXRsZSAhPSBudWxsICkgew0KICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy50aXRsZSA9IHRoaXMub3JpZ2luYWxUaXRsZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gRGlhbG9ncyBjYW4ndCBiZSBkaXNhYmxlZA0KICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuZGlzYWJsZWQgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmRpc2FibGVkID0gZmFsc2U7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZVdyYXBwZXIoKTsNCg0KICAgICAgICAgICAgdGhpcy5lbGVtZW50DQogICAgICAgICAgICAgICAgLnNob3coKQ0KICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKCAidGl0bGUiICkNCiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oIHRoaXMudWlEaWFsb2cgKTsNCg0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoICJ1aS1kaWFsb2ctY29udGVudCIsICJ1aS13aWRnZXQtY29udGVudCIgKTsNCg0KICAgICAgICAgICAgdGhpcy5fY3JlYXRlVGl0bGViYXIoKTsNCiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZUJ1dHRvblBhbmUoKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuZHJhZ2dhYmxlICYmICQuZm4uZHJhZ2dhYmxlICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX21ha2VEcmFnZ2FibGUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLnJlc2l6YWJsZSAmJiAkLmZuLnJlc2l6YWJsZSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9tYWtlUmVzaXphYmxlKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX2lzT3BlbiA9IGZhbHNlOw0KDQogICAgICAgICAgICB0aGlzLl90cmFja0ZvY3VzKCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2luaXQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuYXV0b09wZW4gKSB7DQogICAgICAgICAgICAgICAgdGhpcy5vcGVuKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2FwcGVuZFRvOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5vcHRpb25zLmFwcGVuZFRvOw0KICAgICAgICAgICAgaWYgKCBlbGVtZW50ICYmICggZWxlbWVudC5qcXVlcnkgfHwgZWxlbWVudC5ub2RlVHlwZSApICkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkKCBlbGVtZW50ICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudC5maW5kKCBlbGVtZW50IHx8ICJib2R5IiApLmVxKCAwICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2Rlc3Ryb3k6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIG5leHQsDQogICAgICAgICAgICAgICAgb3JpZ2luYWxQb3NpdGlvbiA9IHRoaXMub3JpZ2luYWxQb3NpdGlvbjsNCg0KICAgICAgICAgICAgdGhpcy5fdW50cmFja0luc3RhbmNlKCk7DQogICAgICAgICAgICB0aGlzLl9kZXN0cm95T3ZlcmxheSgpOw0KDQogICAgICAgICAgICB0aGlzLmVsZW1lbnQNCiAgICAgICAgICAgICAgICAucmVtb3ZlVW5pcXVlSWQoKQ0KICAgICAgICAgICAgICAgIC5jc3MoIHRoaXMub3JpZ2luYWxDc3MgKQ0KDQogICAgICAgICAgICAgICAgLy8gV2l0aG91dCBkZXRhY2hpbmcgZmlyc3QsIHRoZSBmb2xsb3dpbmcgYmVjb21lcyByZWFsbHkgc2xvdw0KICAgICAgICAgICAgICAgIC5kZXRhY2goKTsNCg0KICAgICAgICAgICAgdGhpcy51aURpYWxvZy5yZW1vdmUoKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLm9yaWdpbmFsVGl0bGUgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmF0dHIoICJ0aXRsZSIsIHRoaXMub3JpZ2luYWxUaXRsZSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBuZXh0ID0gb3JpZ2luYWxQb3NpdGlvbi5wYXJlbnQuY2hpbGRyZW4oKS5lcSggb3JpZ2luYWxQb3NpdGlvbi5pbmRleCApOw0KDQogICAgICAgICAgICAvLyBEb24ndCB0cnkgdG8gcGxhY2UgdGhlIGRpYWxvZyBuZXh0IHRvIGl0c2VsZiAoIzg2MTMpDQogICAgICAgICAgICBpZiAoIG5leHQubGVuZ3RoICYmIG5leHRbIDAgXSAhPT0gdGhpcy5lbGVtZW50WyAwIF0gKSB7DQogICAgICAgICAgICAgICAgbmV4dC5iZWZvcmUoIHRoaXMuZWxlbWVudCApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBvcmlnaW5hbFBvc2l0aW9uLnBhcmVudC5hcHBlbmQoIHRoaXMuZWxlbWVudCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHdpZGdldDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy51aURpYWxvZzsNCiAgICAgICAgfSwNCg0KICAgICAgICBkaXNhYmxlOiAkLm5vb3AsDQogICAgICAgIGVuYWJsZTogJC5ub29wLA0KDQogICAgICAgIGNsb3NlOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7DQoNCiAgICAgICAgICAgIGlmICggIXRoaXMuX2lzT3BlbiB8fCB0aGlzLl90cmlnZ2VyKCAiYmVmb3JlQ2xvc2UiLCBldmVudCApID09PSBmYWxzZSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX2lzT3BlbiA9IGZhbHNlOw0KICAgICAgICAgICAgdGhpcy5fZm9jdXNlZEVsZW1lbnQgPSBudWxsOw0KICAgICAgICAgICAgdGhpcy5fZGVzdHJveU92ZXJsYXkoKTsNCiAgICAgICAgICAgIHRoaXMuX3VudHJhY2tJbnN0YW5jZSgpOw0KDQogICAgICAgICAgICBpZiAoICF0aGlzLm9wZW5lci5maWx0ZXIoICI6Zm9jdXNhYmxlIiApLnRyaWdnZXIoICJmb2N1cyIgKS5sZW5ndGggKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBIaWRpbmcgYSBmb2N1c2VkIGVsZW1lbnQgZG9lc24ndCB0cmlnZ2VyIGJsdXIgaW4gV2ViS2l0DQogICAgICAgICAgICAgICAgLy8gc28gaW4gY2FzZSB3ZSBoYXZlIG5vdGhpbmcgdG8gZm9jdXMgb24sIGV4cGxpY2l0bHkgYmx1ciB0aGUgYWN0aXZlIGVsZW1lbnQNCiAgICAgICAgICAgICAgICAvLyBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NDcxODINCiAgICAgICAgICAgICAgICAkLnVpLnNhZmVCbHVyKCAkLnVpLnNhZmVBY3RpdmVFbGVtZW50KCB0aGlzLmRvY3VtZW50WyAwIF0gKSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLl9oaWRlKCB0aGlzLnVpRGlhbG9nLCB0aGlzLm9wdGlvbnMuaGlkZSwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdGhhdC5fdHJpZ2dlciggImNsb3NlIiwgZXZlbnQgKTsNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBpc09wZW46IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lzT3BlbjsNCiAgICAgICAgfSwNCg0KICAgICAgICBtb3ZlVG9Ub3A6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5fbW92ZVRvVG9wKCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX21vdmVUb1RvcDogZnVuY3Rpb24oIGV2ZW50LCBzaWxlbnQgKSB7DQogICAgICAgICAgICB2YXIgbW92ZWQgPSBmYWxzZSwNCiAgICAgICAgICAgICAgICB6SW5kaWNlcyA9IHRoaXMudWlEaWFsb2cuc2libGluZ3MoICIudWktZnJvbnQ6dmlzaWJsZSIgKS5tYXAoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gKyQoIHRoaXMgKS5jc3MoICJ6LWluZGV4IiApOw0KICAgICAgICAgICAgICAgIH0gKS5nZXQoKSwNCiAgICAgICAgICAgICAgICB6SW5kZXhNYXggPSBNYXRoLm1heC5hcHBseSggbnVsbCwgekluZGljZXMgKTsNCg0KICAgICAgICAgICAgaWYgKCB6SW5kZXhNYXggPj0gK3RoaXMudWlEaWFsb2cuY3NzKCAiei1pbmRleCIgKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLnVpRGlhbG9nLmNzcyggInotaW5kZXgiLCB6SW5kZXhNYXggKyAxICk7DQogICAgICAgICAgICAgICAgbW92ZWQgPSB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIG1vdmVkICYmICFzaWxlbnQgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fdHJpZ2dlciggImZvY3VzIiwgZXZlbnQgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBtb3ZlZDsNCiAgICAgICAgfSwNCg0KICAgICAgICBvcGVuOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpczsNCiAgICAgICAgICAgIGlmICggdGhpcy5faXNPcGVuICkgew0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5fbW92ZVRvVG9wKCkgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzVGFiYmFibGUoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLl9pc09wZW4gPSB0cnVlOw0KICAgICAgICAgICAgdGhpcy5vcGVuZXIgPSAkKCAkLnVpLnNhZmVBY3RpdmVFbGVtZW50KCB0aGlzLmRvY3VtZW50WyAwIF0gKSApOw0KDQogICAgICAgICAgICB0aGlzLl9zaXplKCk7DQogICAgICAgICAgICB0aGlzLl9wb3NpdGlvbigpOw0KICAgICAgICAgICAgdGhpcy5fY3JlYXRlT3ZlcmxheSgpOw0KICAgICAgICAgICAgdGhpcy5fbW92ZVRvVG9wKCBudWxsLCB0cnVlICk7DQoNCiAgICAgICAgICAgIC8vIEVuc3VyZSB0aGUgb3ZlcmxheSBpcyBtb3ZlZCB0byB0aGUgdG9wIHdpdGggdGhlIGRpYWxvZywgYnV0IG9ubHkgd2hlbg0KICAgICAgICAgICAgLy8gb3BlbmluZy4gVGhlIG92ZXJsYXkgc2hvdWxkbid0IG1vdmUgYWZ0ZXIgdGhlIGRpYWxvZyBpcyBvcGVuIHNvIHRoYXQNCiAgICAgICAgICAgIC8vIG1vZGVsZXNzIGRpYWxvZ3Mgb3BlbmVkIGFmdGVyIHRoZSBtb2RhbCBkaWFsb2cgc3RhY2sgcHJvcGVybHkuDQogICAgICAgICAgICBpZiAoIHRoaXMub3ZlcmxheSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLm92ZXJsYXkuY3NzKCAiei1pbmRleCIsIHRoaXMudWlEaWFsb2cuY3NzKCAiei1pbmRleCIgKSAtIDEgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fc2hvdyggdGhpcy51aURpYWxvZywgdGhpcy5vcHRpb25zLnNob3csIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHRoYXQuX2ZvY3VzVGFiYmFibGUoKTsNCiAgICAgICAgICAgICAgICB0aGF0Ll90cmlnZ2VyKCAiZm9jdXMiICk7DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIC8vIFRyYWNrIHRoZSBkaWFsb2cgaW1tZWRpYXRlbHkgdXBvbiBvcGVuZW5pbmcgaW4gY2FzZSBhIGZvY3VzIGV2ZW50DQogICAgICAgICAgICAvLyBzb21laG93IG9jY3VycyBvdXRzaWRlIG9mIHRoZSBkaWFsb2cgYmVmb3JlIGFuIGVsZW1lbnQgaW5zaWRlIHRoZQ0KICAgICAgICAgICAgLy8gZGlhbG9nIGlzIGZvY3VzZWQgKCMxMDE1MikNCiAgICAgICAgICAgIHRoaXMuX21ha2VGb2N1c1RhcmdldCgpOw0KDQogICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAib3BlbiIgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZm9jdXNUYWJiYWJsZTogZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgIC8vIFNldCBmb2N1cyB0byB0aGUgZmlyc3QgbWF0Y2g6DQogICAgICAgICAgICAvLyAxLiBBbiBlbGVtZW50IHRoYXQgd2FzIGZvY3VzZWQgcHJldmlvdXNseQ0KICAgICAgICAgICAgLy8gMi4gRmlyc3QgZWxlbWVudCBpbnNpZGUgdGhlIGRpYWxvZyBtYXRjaGluZyBbYXV0b2ZvY3VzXQ0KICAgICAgICAgICAgLy8gMy4gVGFiYmFibGUgZWxlbWVudCBpbnNpZGUgdGhlIGNvbnRlbnQgZWxlbWVudA0KICAgICAgICAgICAgLy8gNC4gVGFiYmFibGUgZWxlbWVudCBpbnNpZGUgdGhlIGJ1dHRvbnBhbmUNCiAgICAgICAgICAgIC8vIDUuIFRoZSBjbG9zZSBidXR0b24NCiAgICAgICAgICAgIC8vIDYuIFRoZSBkaWFsb2cgaXRzZWxmDQogICAgICAgICAgICB2YXIgaGFzRm9jdXMgPSB0aGlzLl9mb2N1c2VkRWxlbWVudDsNCiAgICAgICAgICAgIGlmICggIWhhc0ZvY3VzICkgew0KICAgICAgICAgICAgICAgIGhhc0ZvY3VzID0gdGhpcy5lbGVtZW50LmZpbmQoICJbYXV0b2ZvY3VzXSIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggIWhhc0ZvY3VzLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICBoYXNGb2N1cyA9IHRoaXMuZWxlbWVudC5maW5kKCAiOnRhYmJhYmxlIiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCAhaGFzRm9jdXMubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIGhhc0ZvY3VzID0gdGhpcy51aURpYWxvZ0J1dHRvblBhbmUuZmluZCggIjp0YWJiYWJsZSIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggIWhhc0ZvY3VzLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICBoYXNGb2N1cyA9IHRoaXMudWlEaWFsb2dUaXRsZWJhckNsb3NlLmZpbHRlciggIjp0YWJiYWJsZSIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggIWhhc0ZvY3VzLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICBoYXNGb2N1cyA9IHRoaXMudWlEaWFsb2c7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBoYXNGb2N1cy5lcSggMCApLnRyaWdnZXIoICJmb2N1cyIgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfa2VlcEZvY3VzOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICBmdW5jdGlvbiBjaGVja0ZvY3VzKCkgew0KICAgICAgICAgICAgICAgIHZhciBhY3RpdmVFbGVtZW50ID0gJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICksDQogICAgICAgICAgICAgICAgICAgIGlzQWN0aXZlID0gdGhpcy51aURpYWxvZ1sgMCBdID09PSBhY3RpdmVFbGVtZW50IHx8DQogICAgICAgICAgICAgICAgICAgICAgICAkLmNvbnRhaW5zKCB0aGlzLnVpRGlhbG9nWyAwIF0sIGFjdGl2ZUVsZW1lbnQgKTsNCiAgICAgICAgICAgICAgICBpZiAoICFpc0FjdGl2ZSApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZm9jdXNUYWJiYWJsZSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICBjaGVja0ZvY3VzLmNhbGwoIHRoaXMgKTsNCg0KICAgICAgICAgICAgLy8gc3VwcG9ydDogSUUNCiAgICAgICAgICAgIC8vIElFIDw9IDggZG9lc24ndCBwcmV2ZW50IG1vdmluZyBmb2N1cyBldmVuIHdpdGggZXZlbnQucHJldmVudERlZmF1bHQoKQ0KICAgICAgICAgICAgLy8gc28gd2UgY2hlY2sgYWdhaW4gbGF0ZXINCiAgICAgICAgICAgIHRoaXMuX2RlbGF5KCBjaGVja0ZvY3VzICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2NyZWF0ZVdyYXBwZXI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy51aURpYWxvZyA9ICQoICI8ZGl2PiIgKQ0KICAgICAgICAgICAgICAgIC5oaWRlKCkNCiAgICAgICAgICAgICAgICAuYXR0ciggew0KDQogICAgICAgICAgICAgICAgICAgIC8vIFNldHRpbmcgdGFiSW5kZXggbWFrZXMgdGhlIGRpdiBmb2N1c2FibGUNCiAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg6IC0xLA0KICAgICAgICAgICAgICAgICAgICByb2xlOiAiZGlhbG9nIg0KICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgIC5hcHBlbmRUbyggdGhpcy5fYXBwZW5kVG8oKSApOw0KDQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy51aURpYWxvZywgInVpLWRpYWxvZyIsICJ1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQgdWktZnJvbnQiICk7DQogICAgICAgICAgICB0aGlzLl9vbiggdGhpcy51aURpYWxvZywgew0KICAgICAgICAgICAgICAgIGtleWRvd246IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuY2xvc2VPbkVzY2FwZSAmJiAhZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkgJiYgZXZlbnQua2V5Q29kZSAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQua2V5Q29kZSA9PT0gJC51aS5rZXlDb2RlLkVTQ0FQRSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gUHJldmVudCB0YWJiaW5nIG91dCBvZiBkaWFsb2dzDQogICAgICAgICAgICAgICAgICAgIGlmICggZXZlbnQua2V5Q29kZSAhPT0gJC51aS5rZXlDb2RlLlRBQiB8fCBldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB2YXIgdGFiYmFibGVzID0gdGhpcy51aURpYWxvZy5maW5kKCAiOnRhYmJhYmxlIiApLA0KICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3QgPSB0YWJiYWJsZXMuZmlsdGVyKCAiOmZpcnN0IiApLA0KICAgICAgICAgICAgICAgICAgICAgICAgbGFzdCA9IHRhYmJhYmxlcy5maWx0ZXIoICI6bGFzdCIgKTsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoICggZXZlbnQudGFyZ2V0ID09PSBsYXN0WyAwIF0gfHwgZXZlbnQudGFyZ2V0ID09PSB0aGlzLnVpRGlhbG9nWyAwIF0gKSAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgIWV2ZW50LnNoaWZ0S2V5ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0LnRyaWdnZXIoICJmb2N1cyIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoICggZXZlbnQudGFyZ2V0ID09PSBmaXJzdFsgMCBdIHx8DQogICAgICAgICAgICAgICAgICAgICAgICBldmVudC50YXJnZXQgPT09IHRoaXMudWlEaWFsb2dbIDAgXSApICYmIGV2ZW50LnNoaWZ0S2V5ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3QudHJpZ2dlciggImZvY3VzIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgbW91c2Vkb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5fbW92ZVRvVG9wKCBldmVudCApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZm9jdXNUYWJiYWJsZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAvLyBXZSBhc3N1bWUgdGhhdCBhbnkgZXhpc3RpbmcgYXJpYS1kZXNjcmliZWRieSBhdHRyaWJ1dGUgbWVhbnMNCiAgICAgICAgICAgIC8vIHRoYXQgdGhlIGRpYWxvZyBjb250ZW50IGlzIG1hcmtlZCB1cCBwcm9wZXJseQ0KICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIHdlIGJydXRlIGZvcmNlIHRoZSBjb250ZW50IGFzIHRoZSBkZXNjcmlwdGlvbg0KICAgICAgICAgICAgaWYgKCAhdGhpcy5lbGVtZW50LmZpbmQoICJbYXJpYS1kZXNjcmliZWRieV0iICkubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIHRoaXMudWlEaWFsb2cuYXR0ciggew0KICAgICAgICAgICAgICAgICAgICAiYXJpYS1kZXNjcmliZWRieSI6IHRoaXMuZWxlbWVudC51bmlxdWVJZCgpLmF0dHIoICJpZCIgKQ0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfY3JlYXRlVGl0bGViYXI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHVpRGlhbG9nVGl0bGU7DQoNCiAgICAgICAgICAgIHRoaXMudWlEaWFsb2dUaXRsZWJhciA9ICQoICI8ZGl2PiIgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLnVpRGlhbG9nVGl0bGViYXIsDQogICAgICAgICAgICAgICAgInVpLWRpYWxvZy10aXRsZWJhciIsICJ1aS13aWRnZXQtaGVhZGVyIHVpLWhlbHBlci1jbGVhcmZpeCIgKTsNCiAgICAgICAgICAgIHRoaXMuX29uKCB0aGlzLnVpRGlhbG9nVGl0bGViYXIsIHsNCiAgICAgICAgICAgICAgICBtb3VzZWRvd246IGZ1bmN0aW9uKCBldmVudCApIHsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBEb24ndCBwcmV2ZW50IGNsaWNrIG9uIGNsb3NlIGJ1dHRvbiAoIzg4MzgpDQogICAgICAgICAgICAgICAgICAgIC8vIEZvY3VzaW5nIGEgZGlhbG9nIHRoYXQgaXMgcGFydGlhbGx5IHNjcm9sbGVkIG91dCBvZiB2aWV3DQogICAgICAgICAgICAgICAgICAgIC8vIGNhdXNlcyB0aGUgYnJvd3NlciB0byBzY3JvbGwgaXQgaW50byB2aWV3LCBwcmV2ZW50aW5nIHRoZSBjbGljayBldmVudA0KICAgICAgICAgICAgICAgICAgICBpZiAoICEkKCBldmVudC50YXJnZXQgKS5jbG9zZXN0KCAiLnVpLWRpYWxvZy10aXRsZWJhci1jbG9zZSIgKSApIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGlhbG9nIGlzbid0IGdldHRpbmcgZm9jdXMgd2hlbiBkcmFnZ2luZyAoIzgwNjMpDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVpRGlhbG9nLnRyaWdnZXIoICJmb2N1cyIgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgLy8gU3VwcG9ydDogSUUNCiAgICAgICAgICAgIC8vIFVzZSB0eXBlPSJidXR0b24iIHRvIHByZXZlbnQgZW50ZXIga2V5cHJlc3NlcyBpbiB0ZXh0Ym94ZXMgZnJvbSBjbG9zaW5nIHRoZQ0KICAgICAgICAgICAgLy8gZGlhbG9nIGluIElFICgjOTMxMikNCiAgICAgICAgICAgIHRoaXMudWlEaWFsb2dUaXRsZWJhckNsb3NlID0gJCggIjxidXR0b24gdHlwZT0nYnV0dG9uJz48L2J1dHRvbj4iICkNCiAgICAgICAgICAgICAgICAuYnV0dG9uKCB7DQogICAgICAgICAgICAgICAgICAgIGxhYmVsOiAkKCAiPGE+IiApLnRleHQoIHRoaXMub3B0aW9ucy5jbG9zZVRleHQgKS5odG1sKCksDQogICAgICAgICAgICAgICAgICAgIGljb246ICJ1aS1pY29uLWNsb3NldGhpY2siLA0KICAgICAgICAgICAgICAgICAgICBzaG93TGFiZWw6IGZhbHNlDQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKCB0aGlzLnVpRGlhbG9nVGl0bGViYXIgKTsNCg0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMudWlEaWFsb2dUaXRsZWJhckNsb3NlLCAidWktZGlhbG9nLXRpdGxlYmFyLWNsb3NlIiApOw0KICAgICAgICAgICAgdGhpcy5fb24oIHRoaXMudWlEaWFsb2dUaXRsZWJhckNsb3NlLCB7DQogICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSggZXZlbnQgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIHVpRGlhbG9nVGl0bGUgPSAkKCAiPHNwYW4+IiApLnVuaXF1ZUlkKCkucHJlcGVuZFRvKCB0aGlzLnVpRGlhbG9nVGl0bGViYXIgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB1aURpYWxvZ1RpdGxlLCAidWktZGlhbG9nLXRpdGxlIiApOw0KICAgICAgICAgICAgdGhpcy5fdGl0bGUoIHVpRGlhbG9nVGl0bGUgKTsNCg0KICAgICAgICAgICAgdGhpcy51aURpYWxvZ1RpdGxlYmFyLnByZXBlbmRUbyggdGhpcy51aURpYWxvZyApOw0KDQogICAgICAgICAgICB0aGlzLnVpRGlhbG9nLmF0dHIoIHsNCiAgICAgICAgICAgICAgICAiYXJpYS1sYWJlbGxlZGJ5IjogdWlEaWFsb2dUaXRsZS5hdHRyKCAiaWQiICkNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfdGl0bGU6IGZ1bmN0aW9uKCB0aXRsZSApIHsNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLnRpdGxlICkgew0KICAgICAgICAgICAgICAgIHRpdGxlLnRleHQoIHRoaXMub3B0aW9ucy50aXRsZSApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aXRsZS5odG1sKCAiJiMxNjA7IiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9jcmVhdGVCdXR0b25QYW5lOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMudWlEaWFsb2dCdXR0b25QYW5lID0gJCggIjxkaXY+IiApOw0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMudWlEaWFsb2dCdXR0b25QYW5lLCAidWktZGlhbG9nLWJ1dHRvbnBhbmUiLA0KICAgICAgICAgICAgICAgICJ1aS13aWRnZXQtY29udGVudCB1aS1oZWxwZXItY2xlYXJmaXgiICk7DQoNCiAgICAgICAgICAgIHRoaXMudWlCdXR0b25TZXQgPSAkKCAiPGRpdj4iICkNCiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oIHRoaXMudWlEaWFsb2dCdXR0b25QYW5lICk7DQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy51aUJ1dHRvblNldCwgInVpLWRpYWxvZy1idXR0b25zZXQiICk7DQoNCiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZUJ1dHRvbnMoKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfY3JlYXRlQnV0dG9uczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgYnV0dG9ucyA9IHRoaXMub3B0aW9ucy5idXR0b25zOw0KDQogICAgICAgICAgICAvLyBJZiB3ZSBhbHJlYWR5IGhhdmUgYSBidXR0b24gcGFuZSwgcmVtb3ZlIGl0DQogICAgICAgICAgICB0aGlzLnVpRGlhbG9nQnV0dG9uUGFuZS5yZW1vdmUoKTsNCiAgICAgICAgICAgIHRoaXMudWlCdXR0b25TZXQuZW1wdHkoKTsNCg0KICAgICAgICAgICAgaWYgKCAkLmlzRW1wdHlPYmplY3QoIGJ1dHRvbnMgKSB8fCAoICQuaXNBcnJheSggYnV0dG9ucyApICYmICFidXR0b25zLmxlbmd0aCApICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLnVpRGlhbG9nLCAidWktZGlhbG9nLWJ1dHRvbnMiICk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkLmVhY2goIGJ1dHRvbnMsIGZ1bmN0aW9uKCBuYW1lLCBwcm9wcyApIHsNCiAgICAgICAgICAgICAgICB2YXIgY2xpY2ssIGJ1dHRvbk9wdGlvbnM7DQogICAgICAgICAgICAgICAgcHJvcHMgPSAkLmlzRnVuY3Rpb24oIHByb3BzICkgPw0KICAgICAgICAgICAgICAgICAgICB7IGNsaWNrOiBwcm9wcywgdGV4dDogbmFtZSB9IDoNCiAgICAgICAgICAgICAgICAgICAgcHJvcHM7DQoNCiAgICAgICAgICAgICAgICAvLyBEZWZhdWx0IHRvIGEgbm9uLXN1Ym1pdHRpbmcgYnV0dG9uDQogICAgICAgICAgICAgICAgcHJvcHMgPSAkLmV4dGVuZCggeyB0eXBlOiAiYnV0dG9uIiB9LCBwcm9wcyApOw0KDQogICAgICAgICAgICAgICAgLy8gQ2hhbmdlIHRoZSBjb250ZXh0IGZvciB0aGUgY2xpY2sgY2FsbGJhY2sgdG8gYmUgdGhlIG1haW4gZWxlbWVudA0KICAgICAgICAgICAgICAgIGNsaWNrID0gcHJvcHMuY2xpY2s7DQogICAgICAgICAgICAgICAgYnV0dG9uT3B0aW9ucyA9IHsNCiAgICAgICAgICAgICAgICAgICAgaWNvbjogcHJvcHMuaWNvbiwNCiAgICAgICAgICAgICAgICAgICAgaWNvblBvc2l0aW9uOiBwcm9wcy5pY29uUG9zaXRpb24sDQogICAgICAgICAgICAgICAgICAgIHNob3dMYWJlbDogcHJvcHMuc2hvd0xhYmVsLA0KDQogICAgICAgICAgICAgICAgICAgIC8vIERlcHJlY2F0ZWQgb3B0aW9ucw0KICAgICAgICAgICAgICAgICAgICBpY29uczogcHJvcHMuaWNvbnMsDQogICAgICAgICAgICAgICAgICAgIHRleHQ6IHByb3BzLnRleHQNCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAgICAgZGVsZXRlIHByb3BzLmNsaWNrOw0KICAgICAgICAgICAgICAgIGRlbGV0ZSBwcm9wcy5pY29uOw0KICAgICAgICAgICAgICAgIGRlbGV0ZSBwcm9wcy5pY29uUG9zaXRpb247DQogICAgICAgICAgICAgICAgZGVsZXRlIHByb3BzLnNob3dMYWJlbDsNCg0KICAgICAgICAgICAgICAgIC8vIERlcHJlY2F0ZWQgb3B0aW9ucw0KICAgICAgICAgICAgICAgIGRlbGV0ZSBwcm9wcy5pY29uczsNCiAgICAgICAgICAgICAgICBpZiAoIHR5cGVvZiBwcm9wcy50ZXh0ID09PSAiYm9vbGVhbiIgKSB7DQogICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBwcm9wcy50ZXh0Ow0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICQoICI8YnV0dG9uPjwvYnV0dG9uPiIsIHByb3BzICkNCiAgICAgICAgICAgICAgICAgICAgLmJ1dHRvbiggYnV0dG9uT3B0aW9ucyApDQogICAgICAgICAgICAgICAgICAgIC5hcHBlbmRUbyggdGhhdC51aUJ1dHRvblNldCApDQogICAgICAgICAgICAgICAgICAgIC5vbiggImNsaWNrIiwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjbGljay5hcHBseSggdGhhdC5lbGVtZW50WyAwIF0sIGFyZ3VtZW50cyApOw0KICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy51aURpYWxvZywgInVpLWRpYWxvZy1idXR0b25zIiApOw0KICAgICAgICAgICAgdGhpcy51aURpYWxvZ0J1dHRvblBhbmUuYXBwZW5kVG8oIHRoaXMudWlEaWFsb2cgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfbWFrZURyYWdnYWJsZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9uczsNCg0KICAgICAgICAgICAgZnVuY3Rpb24gZmlsdGVyZWRVaSggdWkgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHVpLnBvc2l0aW9uLA0KICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IHVpLm9mZnNldA0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMudWlEaWFsb2cuZHJhZ2dhYmxlKCB7DQogICAgICAgICAgICAgICAgY2FuY2VsOiAiLnVpLWRpYWxvZy1jb250ZW50LCAudWktZGlhbG9nLXRpdGxlYmFyLWNsb3NlIiwNCiAgICAgICAgICAgICAgICBoYW5kbGU6ICIudWktZGlhbG9nLXRpdGxlYmFyIiwNCiAgICAgICAgICAgICAgICBjb250YWlubWVudDogImRvY3VtZW50IiwNCiAgICAgICAgICAgICAgICBzdGFydDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fYWRkQ2xhc3MoICQoIHRoaXMgKSwgInVpLWRpYWxvZy1kcmFnZ2luZyIgKTsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fYmxvY2tGcmFtZXMoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fdHJpZ2dlciggImRyYWdTdGFydCIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBkcmFnOiBmdW5jdGlvbiggZXZlbnQsIHVpICkgew0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll90cmlnZ2VyKCAiZHJhZyIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBzdG9wOiBmdW5jdGlvbiggZXZlbnQsIHVpICkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgbGVmdCA9IHVpLm9mZnNldC5sZWZ0IC0gdGhhdC5kb2N1bWVudC5zY3JvbGxMZWZ0KCksDQogICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSB1aS5vZmZzZXQudG9wIC0gdGhhdC5kb2N1bWVudC5zY3JvbGxUb3AoKTsNCg0KICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnBvc2l0aW9uID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgbXk6ICJsZWZ0IHRvcCIsDQogICAgICAgICAgICAgICAgICAgICAgICBhdDogImxlZnQiICsgKCBsZWZ0ID49IDAgPyAiKyIgOiAiIiApICsgbGVmdCArICIgIiArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInRvcCIgKyAoIHRvcCA+PSAwID8gIisiIDogIiIgKSArIHRvcCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG9mOiB0aGF0LndpbmRvdw0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll9yZW1vdmVDbGFzcyggJCggdGhpcyApLCAidWktZGlhbG9nLWRyYWdnaW5nIiApOw0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll91bmJsb2NrRnJhbWVzKCk7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX3RyaWdnZXIoICJkcmFnU3RvcCIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9tYWtlUmVzaXphYmxlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcywNCiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLA0KICAgICAgICAgICAgICAgIGhhbmRsZXMgPSBvcHRpb25zLnJlc2l6YWJsZSwNCg0KICAgICAgICAgICAgICAgIC8vIC51aS1yZXNpemFibGUgaGFzIHBvc2l0aW9uOiByZWxhdGl2ZSBkZWZpbmVkIGluIHRoZSBzdHlsZXNoZWV0DQogICAgICAgICAgICAgICAgLy8gYnV0IGRpYWxvZ3MgaGF2ZSB0byB1c2UgYWJzb2x1dGUgb3IgZml4ZWQgcG9zaXRpb25pbmcNCiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHRoaXMudWlEaWFsb2cuY3NzKCAicG9zaXRpb24iICksDQogICAgICAgICAgICAgICAgcmVzaXplSGFuZGxlcyA9IHR5cGVvZiBoYW5kbGVzID09PSAic3RyaW5nIiA/DQogICAgICAgICAgICAgICAgICAgIGhhbmRsZXMgOg0KICAgICAgICAgICAgICAgICAgICAibixlLHMsdyxzZSxzdyxuZSxudyI7DQoNCiAgICAgICAgICAgIGZ1bmN0aW9uIGZpbHRlcmVkVWkoIHVpICkgew0KICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsUG9zaXRpb246IHVpLm9yaWdpbmFsUG9zaXRpb24sDQogICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsU2l6ZTogdWkub3JpZ2luYWxTaXplLA0KICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogdWkucG9zaXRpb24sDQogICAgICAgICAgICAgICAgICAgIHNpemU6IHVpLnNpemUNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLnVpRGlhbG9nLnJlc2l6YWJsZSggew0KICAgICAgICAgICAgICAgIGNhbmNlbDogIi51aS1kaWFsb2ctY29udGVudCIsDQogICAgICAgICAgICAgICAgY29udGFpbm1lbnQ6ICJkb2N1bWVudCIsDQogICAgICAgICAgICAgICAgYWxzb1Jlc2l6ZTogdGhpcy5lbGVtZW50LA0KICAgICAgICAgICAgICAgIG1heFdpZHRoOiBvcHRpb25zLm1heFdpZHRoLA0KICAgICAgICAgICAgICAgIG1heEhlaWdodDogb3B0aW9ucy5tYXhIZWlnaHQsDQogICAgICAgICAgICAgICAgbWluV2lkdGg6IG9wdGlvbnMubWluV2lkdGgsDQogICAgICAgICAgICAgICAgbWluSGVpZ2h0OiB0aGlzLl9taW5IZWlnaHQoKSwNCiAgICAgICAgICAgICAgICBoYW5kbGVzOiByZXNpemVIYW5kbGVzLA0KICAgICAgICAgICAgICAgIHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpICkgew0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll9hZGRDbGFzcyggJCggdGhpcyApLCAidWktZGlhbG9nLXJlc2l6aW5nIiApOw0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll9ibG9ja0ZyYW1lcygpOw0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll90cmlnZ2VyKCAicmVzaXplU3RhcnQiLCBldmVudCwgZmlsdGVyZWRVaSggdWkgKSApOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbiggZXZlbnQsIHVpICkgew0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll90cmlnZ2VyKCAicmVzaXplIiwgZXZlbnQsIGZpbHRlcmVkVWkoIHVpICkgKTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uKCBldmVudCwgdWkgKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSB0aGF0LnVpRGlhbG9nLm9mZnNldCgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IG9mZnNldC5sZWZ0IC0gdGhhdC5kb2N1bWVudC5zY3JvbGxMZWZ0KCksDQogICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSBvZmZzZXQudG9wIC0gdGhhdC5kb2N1bWVudC5zY3JvbGxUb3AoKTsNCg0KICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmhlaWdodCA9IHRoYXQudWlEaWFsb2cuaGVpZ2h0KCk7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMud2lkdGggPSB0aGF0LnVpRGlhbG9nLndpZHRoKCk7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMucG9zaXRpb24gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICBteTogImxlZnQgdG9wIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIGF0OiAibGVmdCIgKyAoIGxlZnQgPj0gMCA/ICIrIiA6ICIiICkgKyBsZWZ0ICsgIiAiICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidG9wIiArICggdG9wID49IDAgPyAiKyIgOiAiIiApICsgdG9wLA0KICAgICAgICAgICAgICAgICAgICAgICAgb2Y6IHRoYXQud2luZG93DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX3JlbW92ZUNsYXNzKCAkKCB0aGlzICksICJ1aS1kaWFsb2ctcmVzaXppbmciICk7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX3VuYmxvY2tGcmFtZXMoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fdHJpZ2dlciggInJlc2l6ZVN0b3AiLCBldmVudCwgZmlsdGVyZWRVaSggdWkgKSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgIC5jc3MoICJwb3NpdGlvbiIsIHBvc2l0aW9uICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3RyYWNrRm9jdXM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5fb24oIHRoaXMud2lkZ2V0KCksIHsNCiAgICAgICAgICAgICAgICBmb2N1c2luOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX21ha2VGb2N1c1RhcmdldCgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9mb2N1c2VkRWxlbWVudCA9ICQoIGV2ZW50LnRhcmdldCApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfbWFrZUZvY3VzVGFyZ2V0OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuX3VudHJhY2tJbnN0YW5jZSgpOw0KICAgICAgICAgICAgdGhpcy5fdHJhY2tpbmdJbnN0YW5jZXMoKS51bnNoaWZ0KCB0aGlzICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3VudHJhY2tJbnN0YW5jZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgaW5zdGFuY2VzID0gdGhpcy5fdHJhY2tpbmdJbnN0YW5jZXMoKSwNCiAgICAgICAgICAgICAgICBleGlzdHMgPSAkLmluQXJyYXkoIHRoaXMsIGluc3RhbmNlcyApOw0KICAgICAgICAgICAgaWYgKCBleGlzdHMgIT09IC0xICkgew0KICAgICAgICAgICAgICAgIGluc3RhbmNlcy5zcGxpY2UoIGV4aXN0cywgMSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF90cmFja2luZ0luc3RhbmNlczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgaW5zdGFuY2VzID0gdGhpcy5kb2N1bWVudC5kYXRhKCAidWktZGlhbG9nLWluc3RhbmNlcyIgKTsNCiAgICAgICAgICAgIGlmICggIWluc3RhbmNlcyApIHsNCiAgICAgICAgICAgICAgICBpbnN0YW5jZXMgPSBbXTsNCiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50LmRhdGEoICJ1aS1kaWFsb2ctaW5zdGFuY2VzIiwgaW5zdGFuY2VzICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gaW5zdGFuY2VzOw0KICAgICAgICB9LA0KDQogICAgICAgIF9taW5IZWlnaHQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7DQoNCiAgICAgICAgICAgIHJldHVybiBvcHRpb25zLmhlaWdodCA9PT0gImF1dG8iID8NCiAgICAgICAgICAgICAgICBvcHRpb25zLm1pbkhlaWdodCA6DQogICAgICAgICAgICAgICAgTWF0aC5taW4oIG9wdGlvbnMubWluSGVpZ2h0LCBvcHRpb25zLmhlaWdodCApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9wb3NpdGlvbjogZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgIC8vIE5lZWQgdG8gc2hvdyB0aGUgZGlhbG9nIHRvIGdldCB0aGUgYWN0dWFsIG9mZnNldCBpbiB0aGUgcG9zaXRpb24gcGx1Z2luDQogICAgICAgICAgICB2YXIgaXNWaXNpYmxlID0gdGhpcy51aURpYWxvZy5pcyggIjp2aXNpYmxlIiApOw0KICAgICAgICAgICAgaWYgKCAhaXNWaXNpYmxlICkgew0KICAgICAgICAgICAgICAgIHRoaXMudWlEaWFsb2cuc2hvdygpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy51aURpYWxvZy5wb3NpdGlvbiggdGhpcy5vcHRpb25zLnBvc2l0aW9uICk7DQogICAgICAgICAgICBpZiAoICFpc1Zpc2libGUgKSB7DQogICAgICAgICAgICAgICAgdGhpcy51aURpYWxvZy5oaWRlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldE9wdGlvbnM6IGZ1bmN0aW9uKCBvcHRpb25zICkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIHJlc2l6ZSA9IGZhbHNlLA0KICAgICAgICAgICAgICAgIHJlc2l6YWJsZU9wdGlvbnMgPSB7fTsNCg0KICAgICAgICAgICAgJC5lYWNoKCBvcHRpb25zLCBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHsNCiAgICAgICAgICAgICAgICB0aGF0Ll9zZXRPcHRpb24oIGtleSwgdmFsdWUgKTsNCg0KICAgICAgICAgICAgICAgIGlmICgga2V5IGluIHRoYXQuc2l6ZVJlbGF0ZWRPcHRpb25zICkgew0KICAgICAgICAgICAgICAgICAgICByZXNpemUgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoIGtleSBpbiB0aGF0LnJlc2l6YWJsZVJlbGF0ZWRPcHRpb25zICkgew0KICAgICAgICAgICAgICAgICAgICByZXNpemFibGVPcHRpb25zWyBrZXkgXSA9IHZhbHVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgaWYgKCByZXNpemUgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fc2l6ZSgpOw0KICAgICAgICAgICAgICAgIHRoaXMuX3Bvc2l0aW9uKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIHRoaXMudWlEaWFsb2cuaXMoICI6ZGF0YSh1aS1yZXNpemFibGUpIiApICkgew0KICAgICAgICAgICAgICAgIHRoaXMudWlEaWFsb2cucmVzaXphYmxlKCAib3B0aW9uIiwgcmVzaXphYmxlT3B0aW9ucyApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgew0KICAgICAgICAgICAgdmFyIGlzRHJhZ2dhYmxlLCBpc1Jlc2l6YWJsZSwNCiAgICAgICAgICAgICAgICB1aURpYWxvZyA9IHRoaXMudWlEaWFsb2c7DQoNCiAgICAgICAgICAgIGlmICgga2V5ID09PSAiZGlzYWJsZWQiICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTsNCg0KICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJhcHBlbmRUbyIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy51aURpYWxvZy5hcHBlbmRUbyggdGhpcy5fYXBwZW5kVG8oKSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImJ1dHRvbnMiICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX2NyZWF0ZUJ1dHRvbnMoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJjbG9zZVRleHQiICkgew0KICAgICAgICAgICAgICAgIHRoaXMudWlEaWFsb2dUaXRsZWJhckNsb3NlLmJ1dHRvbiggew0KDQogICAgICAgICAgICAgICAgICAgIC8vIEVuc3VyZSB0aGF0IHdlIGFsd2F5cyBwYXNzIGEgc3RyaW5nDQogICAgICAgICAgICAgICAgICAgIGxhYmVsOiAkKCAiPGE+IiApLnRleHQoICIiICsgdGhpcy5vcHRpb25zLmNsb3NlVGV4dCApLmh0bWwoKQ0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJkcmFnZ2FibGUiICkgew0KICAgICAgICAgICAgICAgIGlzRHJhZ2dhYmxlID0gdWlEaWFsb2cuaXMoICI6ZGF0YSh1aS1kcmFnZ2FibGUpIiApOw0KICAgICAgICAgICAgICAgIGlmICggaXNEcmFnZ2FibGUgJiYgIXZhbHVlICkgew0KICAgICAgICAgICAgICAgICAgICB1aURpYWxvZy5kcmFnZ2FibGUoICJkZXN0cm95IiApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggIWlzRHJhZ2dhYmxlICYmIHZhbHVlICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYWtlRHJhZ2dhYmxlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gInBvc2l0aW9uIiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9wb3NpdGlvbigpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gInJlc2l6YWJsZSIgKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBjdXJyZW50bHkgcmVzaXphYmxlLCBiZWNvbWluZyBub24tcmVzaXphYmxlDQogICAgICAgICAgICAgICAgaXNSZXNpemFibGUgPSB1aURpYWxvZy5pcyggIjpkYXRhKHVpLXJlc2l6YWJsZSkiICk7DQogICAgICAgICAgICAgICAgaWYgKCBpc1Jlc2l6YWJsZSAmJiAhdmFsdWUgKSB7DQogICAgICAgICAgICAgICAgICAgIHVpRGlhbG9nLnJlc2l6YWJsZSggImRlc3Ryb3kiICk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8gQ3VycmVudGx5IHJlc2l6YWJsZSwgY2hhbmdpbmcgaGFuZGxlcw0KICAgICAgICAgICAgICAgIGlmICggaXNSZXNpemFibGUgJiYgdHlwZW9mIHZhbHVlID09PSAic3RyaW5nIiApIHsNCiAgICAgICAgICAgICAgICAgICAgdWlEaWFsb2cucmVzaXphYmxlKCAib3B0aW9uIiwgImhhbmRsZXMiLCB2YWx1ZSApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIEN1cnJlbnRseSBub24tcmVzaXphYmxlLCBiZWNvbWluZyByZXNpemFibGUNCiAgICAgICAgICAgICAgICBpZiAoICFpc1Jlc2l6YWJsZSAmJiB2YWx1ZSAhPT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX21ha2VSZXNpemFibGUoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICgga2V5ID09PSAidGl0bGUiICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3RpdGxlKCB0aGlzLnVpRGlhbG9nVGl0bGViYXIuZmluZCggIi51aS1kaWFsb2ctdGl0bGUiICkgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfc2l6ZTogZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgIC8vIElmIHRoZSB1c2VyIGhhcyByZXNpemVkIHRoZSBkaWFsb2csIHRoZSAudWktZGlhbG9nIGFuZCAudWktZGlhbG9nLWNvbnRlbnQNCiAgICAgICAgICAgIC8vIGRpdnMgd2lsbCBib3RoIGhhdmUgd2lkdGggYW5kIGhlaWdodCBzZXQsIHNvIHdlIG5lZWQgdG8gcmVzZXQgdGhlbQ0KICAgICAgICAgICAgdmFyIG5vbkNvbnRlbnRIZWlnaHQsIG1pbkNvbnRlbnRIZWlnaHQsIG1heENvbnRlbnRIZWlnaHQsDQogICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9uczsNCg0KICAgICAgICAgICAgLy8gUmVzZXQgY29udGVudCBzaXppbmcNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zaG93KCkuY3NzKCB7DQogICAgICAgICAgICAgICAgd2lkdGg6ICJhdXRvIiwNCiAgICAgICAgICAgICAgICBtaW5IZWlnaHQ6IDAsDQogICAgICAgICAgICAgICAgbWF4SGVpZ2h0OiAibm9uZSIsDQogICAgICAgICAgICAgICAgaGVpZ2h0OiAwDQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIGlmICggb3B0aW9ucy5taW5XaWR0aCA+IG9wdGlvbnMud2lkdGggKSB7DQogICAgICAgICAgICAgICAgb3B0aW9ucy53aWR0aCA9IG9wdGlvbnMubWluV2lkdGg7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFJlc2V0IHdyYXBwZXIgc2l6aW5nDQogICAgICAgICAgICAvLyBkZXRlcm1pbmUgdGhlIGhlaWdodCBvZiBhbGwgdGhlIG5vbi1jb250ZW50IGVsZW1lbnRzDQogICAgICAgICAgICBub25Db250ZW50SGVpZ2h0ID0gdGhpcy51aURpYWxvZy5jc3MoIHsNCiAgICAgICAgICAgICAgICBoZWlnaHQ6ICJhdXRvIiwNCiAgICAgICAgICAgICAgICB3aWR0aDogb3B0aW9ucy53aWR0aA0KICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLm91dGVySGVpZ2h0KCk7DQogICAgICAgICAgICBtaW5Db250ZW50SGVpZ2h0ID0gTWF0aC5tYXgoIDAsIG9wdGlvbnMubWluSGVpZ2h0IC0gbm9uQ29udGVudEhlaWdodCApOw0KICAgICAgICAgICAgbWF4Q29udGVudEhlaWdodCA9IHR5cGVvZiBvcHRpb25zLm1heEhlaWdodCA9PT0gIm51bWJlciIgPw0KICAgICAgICAgICAgICAgIE1hdGgubWF4KCAwLCBvcHRpb25zLm1heEhlaWdodCAtIG5vbkNvbnRlbnRIZWlnaHQgKSA6DQogICAgICAgICAgICAgICAgIm5vbmUiOw0KDQogICAgICAgICAgICBpZiAoIG9wdGlvbnMuaGVpZ2h0ID09PSAiYXV0byIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNzcyggew0KICAgICAgICAgICAgICAgICAgICBtaW5IZWlnaHQ6IG1pbkNvbnRlbnRIZWlnaHQsDQogICAgICAgICAgICAgICAgICAgIG1heEhlaWdodDogbWF4Q29udGVudEhlaWdodCwNCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAiYXV0byINCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5oZWlnaHQoIE1hdGgubWF4KCAwLCBvcHRpb25zLmhlaWdodCAtIG5vbkNvbnRlbnRIZWlnaHQgKSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHRoaXMudWlEaWFsb2cuaXMoICI6ZGF0YSh1aS1yZXNpemFibGUpIiApICkgew0KICAgICAgICAgICAgICAgIHRoaXMudWlEaWFsb2cucmVzaXphYmxlKCAib3B0aW9uIiwgIm1pbkhlaWdodCIsIHRoaXMuX21pbkhlaWdodCgpICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2Jsb2NrRnJhbWVzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuaWZyYW1lQmxvY2tzID0gdGhpcy5kb2N1bWVudC5maW5kKCAiaWZyYW1lIiApLm1hcCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIGlmcmFtZSA9ICQoIHRoaXMgKTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkKCAiPGRpdj4iICkNCiAgICAgICAgICAgICAgICAgICAgLmNzcyggew0KICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJhYnNvbHV0ZSIsDQogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogaWZyYW1lLm91dGVyV2lkdGgoKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogaWZyYW1lLm91dGVySGVpZ2h0KCkNCiAgICAgICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgICAgIC5hcHBlbmRUbyggaWZyYW1lLnBhcmVudCgpICkNCiAgICAgICAgICAgICAgICAgICAgLm9mZnNldCggaWZyYW1lLm9mZnNldCgpIClbIDAgXTsNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfdW5ibG9ja0ZyYW1lczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBpZiAoIHRoaXMuaWZyYW1lQmxvY2tzICkgew0KICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lQmxvY2tzLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmlmcmFtZUJsb2NrczsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfYWxsb3dJbnRlcmFjdGlvbjogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgaWYgKCAkKCBldmVudC50YXJnZXQgKS5jbG9zZXN0KCAiLnVpLWRpYWxvZyIgKS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFRPRE86IFJlbW92ZSBoYWNrIHdoZW4gZGF0ZXBpY2tlciBpbXBsZW1lbnRzDQogICAgICAgICAgICAvLyB0aGUgLnVpLWZyb250IGxvZ2ljICgjODk4OSkNCiAgICAgICAgICAgIHJldHVybiAhISQoIGV2ZW50LnRhcmdldCApLmNsb3Nlc3QoICIudWktZGF0ZXBpY2tlciIgKS5sZW5ndGg7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2NyZWF0ZU92ZXJsYXk6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaWYgKCAhdGhpcy5vcHRpb25zLm1vZGFsICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gV2UgdXNlIGEgZGVsYXkgaW4gY2FzZSB0aGUgb3ZlcmxheSBpcyBjcmVhdGVkIGZyb20gYW4NCiAgICAgICAgICAgIC8vIGV2ZW50IHRoYXQgd2UncmUgZ29pbmcgdG8gYmUgY2FuY2VsbGluZyAoIzI4MDQpDQogICAgICAgICAgICB2YXIgaXNPcGVuaW5nID0gdHJ1ZTsNCiAgICAgICAgICAgIHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBpc09wZW5pbmcgPSBmYWxzZTsNCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgaWYgKCAhdGhpcy5kb2N1bWVudC5kYXRhKCAidWktZGlhbG9nLW92ZXJsYXlzIiApICkgew0KDQogICAgICAgICAgICAgICAgLy8gUHJldmVudCB1c2Ugb2YgYW5jaG9ycyBhbmQgaW5wdXRzDQogICAgICAgICAgICAgICAgLy8gVXNpbmcgX29uKCkgZm9yIGFuIGV2ZW50IGhhbmRsZXIgc2hhcmVkIGFjcm9zcyBtYW55IGluc3RhbmNlcyBpcw0KICAgICAgICAgICAgICAgIC8vIHNhZmUgYmVjYXVzZSB0aGUgZGlhbG9ncyBzdGFjayBhbmQgbXVzdCBiZSBjbG9zZWQgaW4gcmV2ZXJzZSBvcmRlcg0KICAgICAgICAgICAgICAgIHRoaXMuX29uKCB0aGlzLmRvY3VtZW50LCB7DQogICAgICAgICAgICAgICAgICAgIGZvY3VzaW46IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggaXNPcGVuaW5nICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5fYWxsb3dJbnRlcmFjdGlvbiggZXZlbnQgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RyYWNraW5nSW5zdGFuY2VzKClbIDAgXS5fZm9jdXNUYWJiYWJsZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLm92ZXJsYXkgPSAkKCAiPGRpdj4iICkNCiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oIHRoaXMuX2FwcGVuZFRvKCkgKTsNCg0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMub3ZlcmxheSwgbnVsbCwgInVpLXdpZGdldC1vdmVybGF5IHVpLWZyb250IiApOw0KICAgICAgICAgICAgdGhpcy5fb24oIHRoaXMub3ZlcmxheSwgew0KICAgICAgICAgICAgICAgIG1vdXNlZG93bjogIl9rZWVwRm9jdXMiDQogICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB0aGlzLmRvY3VtZW50LmRhdGEoICJ1aS1kaWFsb2ctb3ZlcmxheXMiLA0KICAgICAgICAgICAgICAgICggdGhpcy5kb2N1bWVudC5kYXRhKCAidWktZGlhbG9nLW92ZXJsYXlzIiApIHx8IDAgKSArIDEgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZGVzdHJveU92ZXJsYXk6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaWYgKCAhdGhpcy5vcHRpb25zLm1vZGFsICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCB0aGlzLm92ZXJsYXkgKSB7DQogICAgICAgICAgICAgICAgdmFyIG92ZXJsYXlzID0gdGhpcy5kb2N1bWVudC5kYXRhKCAidWktZGlhbG9nLW92ZXJsYXlzIiApIC0gMTsNCg0KICAgICAgICAgICAgICAgIGlmICggIW92ZXJsYXlzICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9vZmYoIHRoaXMuZG9jdW1lbnQsICJmb2N1c2luIiApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50LnJlbW92ZURhdGEoICJ1aS1kaWFsb2ctb3ZlcmxheXMiICk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudC5kYXRhKCAidWktZGlhbG9nLW92ZXJsYXlzIiwgb3ZlcmxheXMgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGlzLm92ZXJsYXkucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgdGhpcy5vdmVybGF5ID0gbnVsbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gKTsNCg0KLy8gREVQUkVDQVRFRA0KLy8gVE9ETzogc3dpdGNoIHJldHVybiBiYWNrIHRvIHdpZGdldCBkZWNsYXJhdGlvbiBhdCB0b3Agb2YgZmlsZSB3aGVuIHRoaXMgaXMgcmVtb3ZlZA0KICAgIGlmICggJC51aUJhY2tDb21wYXQgIT09IGZhbHNlICkgew0KDQogICAgICAgIC8vIEJhY2tjb21wYXQgZm9yIGRpYWxvZ0NsYXNzIG9wdGlvbg0KICAgICAgICAkLndpZGdldCggInVpLmRpYWxvZyIsICQudWkuZGlhbG9nLCB7DQogICAgICAgICAgICBvcHRpb25zOiB7DQogICAgICAgICAgICAgICAgZGlhbG9nQ2xhc3M6ICIiDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgX2NyZWF0ZVdyYXBwZXI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3N1cGVyKCk7DQogICAgICAgICAgICAgICAgdGhpcy51aURpYWxvZy5hZGRDbGFzcyggdGhpcy5vcHRpb25zLmRpYWxvZ0NsYXNzICk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgX3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7DQogICAgICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJkaWFsb2dDbGFzcyIgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudWlEaWFsb2cNCiAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyggdGhpcy5vcHRpb25zLmRpYWxvZ0NsYXNzICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyggdmFsdWUgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5fc3VwZXJBcHBseSggYXJndW1lbnRzICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gKTsNCiAgICB9DQoNCiAgICB2YXIgd2lkZ2V0c0RpYWxvZyA9ICQudWkuZGlhbG9nOw0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBEcm9wcGFibGUgMS4xMi4xDQogKiBodHRwOi8vanF1ZXJ5dWkuY29tDQogKg0KICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMNCiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UNCiAqLw0KDQovLz4+bGFiZWw6IERyb3BwYWJsZQ0KLy8+Pmdyb3VwOiBJbnRlcmFjdGlvbnMNCi8vPj5kZXNjcmlwdGlvbjogRW5hYmxlcyBkcm9wIHRhcmdldHMgZm9yIGRyYWdnYWJsZSBlbGVtZW50cy4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9kcm9wcGFibGUvDQovLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vZHJvcHBhYmxlLw0KDQoNCg0KICAgICQud2lkZ2V0KCAidWkuZHJvcHBhYmxlIiwgew0KICAgICAgICB2ZXJzaW9uOiAiMS4xMi4xIiwNCiAgICAgICAgd2lkZ2V0RXZlbnRQcmVmaXg6ICJkcm9wIiwNCiAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgYWNjZXB0OiAiKiIsDQogICAgICAgICAgICBhZGRDbGFzc2VzOiB0cnVlLA0KICAgICAgICAgICAgZ3JlZWR5OiBmYWxzZSwNCiAgICAgICAgICAgIHNjb3BlOiAiZGVmYXVsdCIsDQogICAgICAgICAgICB0b2xlcmFuY2U6ICJpbnRlcnNlY3QiLA0KDQogICAgICAgICAgICAvLyBDYWxsYmFja3MNCiAgICAgICAgICAgIGFjdGl2YXRlOiBudWxsLA0KICAgICAgICAgICAgZGVhY3RpdmF0ZTogbnVsbCwNCiAgICAgICAgICAgIGRyb3A6IG51bGwsDQogICAgICAgICAgICBvdXQ6IG51bGwsDQogICAgICAgICAgICBvdmVyOiBudWxsDQogICAgICAgIH0sDQogICAgICAgIF9jcmVhdGU6IGZ1bmN0aW9uKCkgew0KDQogICAgICAgICAgICB2YXIgcHJvcG9ydGlvbnMsDQogICAgICAgICAgICAgICAgbyA9IHRoaXMub3B0aW9ucywNCiAgICAgICAgICAgICAgICBhY2NlcHQgPSBvLmFjY2VwdDsNCg0KICAgICAgICAgICAgdGhpcy5pc292ZXIgPSBmYWxzZTsNCiAgICAgICAgICAgIHRoaXMuaXNvdXQgPSB0cnVlOw0KDQogICAgICAgICAgICB0aGlzLmFjY2VwdCA9ICQuaXNGdW5jdGlvbiggYWNjZXB0ICkgPyBhY2NlcHQgOiBmdW5jdGlvbiggZCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZC5pcyggYWNjZXB0ICk7DQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICB0aGlzLnByb3BvcnRpb25zID0gZnVuY3Rpb24oIC8qIHZhbHVlVG9Xcml0ZSAqLyApIHsNCiAgICAgICAgICAgICAgICBpZiAoIGFyZ3VtZW50cy5sZW5ndGggKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gU3RvcmUgdGhlIGRyb3BwYWJsZSdzIHByb3BvcnRpb25zDQogICAgICAgICAgICAgICAgICAgIHByb3BvcnRpb25zID0gYXJndW1lbnRzWyAwIF07DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBSZXRyaWV2ZSBvciBkZXJpdmUgdGhlIGRyb3BwYWJsZSdzIHByb3BvcnRpb25zDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9wb3J0aW9ucyA/DQogICAgICAgICAgICAgICAgICAgICAgICBwcm9wb3J0aW9ucyA6DQogICAgICAgICAgICAgICAgICAgICAgICBwcm9wb3J0aW9ucyA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogdGhpcy5lbGVtZW50WyAwIF0ub2Zmc2V0V2lkdGgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmVsZW1lbnRbIDAgXS5vZmZzZXRIZWlnaHQNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgdGhpcy5fYWRkVG9NYW5hZ2VyKCBvLnNjb3BlICk7DQoNCiAgICAgICAgICAgIG8uYWRkQ2xhc3NlcyAmJiB0aGlzLl9hZGRDbGFzcyggInVpLWRyb3BwYWJsZSIgKTsNCg0KICAgICAgICB9LA0KDQogICAgICAgIF9hZGRUb01hbmFnZXI6IGZ1bmN0aW9uKCBzY29wZSApIHsNCg0KICAgICAgICAgICAgLy8gQWRkIHRoZSByZWZlcmVuY2UgYW5kIHBvc2l0aW9ucyB0byB0aGUgbWFuYWdlcg0KICAgICAgICAgICAgJC51aS5kZG1hbmFnZXIuZHJvcHBhYmxlc1sgc2NvcGUgXSA9ICQudWkuZGRtYW5hZ2VyLmRyb3BwYWJsZXNbIHNjb3BlIF0gfHwgW107DQogICAgICAgICAgICAkLnVpLmRkbWFuYWdlci5kcm9wcGFibGVzWyBzY29wZSBdLnB1c2goIHRoaXMgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc3BsaWNlOiBmdW5jdGlvbiggZHJvcCApIHsNCiAgICAgICAgICAgIHZhciBpID0gMDsNCiAgICAgICAgICAgIGZvciAoIDsgaSA8IGRyb3AubGVuZ3RoOyBpKysgKSB7DQogICAgICAgICAgICAgICAgaWYgKCBkcm9wWyBpIF0gPT09IHRoaXMgKSB7DQogICAgICAgICAgICAgICAgICAgIGRyb3Auc3BsaWNlKCBpLCAxICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9kZXN0cm95OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBkcm9wID0gJC51aS5kZG1hbmFnZXIuZHJvcHBhYmxlc1sgdGhpcy5vcHRpb25zLnNjb3BlIF07DQoNCiAgICAgICAgICAgIHRoaXMuX3NwbGljZSggZHJvcCApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgew0KDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImFjY2VwdCIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5hY2NlcHQgPSAkLmlzRnVuY3Rpb24oIHZhbHVlICkgPyB2YWx1ZSA6IGZ1bmN0aW9uKCBkICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5pcyggdmFsdWUgKTsNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfSBlbHNlIGlmICgga2V5ID09PSAic2NvcGUiICkgew0KICAgICAgICAgICAgICAgIHZhciBkcm9wID0gJC51aS5kZG1hbmFnZXIuZHJvcHBhYmxlc1sgdGhpcy5vcHRpb25zLnNjb3BlIF07DQoNCiAgICAgICAgICAgICAgICB0aGlzLl9zcGxpY2UoIGRyb3AgKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9hZGRUb01hbmFnZXIoIHZhbHVlICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX3N1cGVyKCBrZXksIHZhbHVlICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2FjdGl2YXRlOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgZHJhZ2dhYmxlID0gJC51aS5kZG1hbmFnZXIuY3VycmVudDsNCg0KICAgICAgICAgICAgdGhpcy5fYWRkQWN0aXZlQ2xhc3MoKTsNCiAgICAgICAgICAgIGlmICggZHJhZ2dhYmxlICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJhY3RpdmF0ZSIsIGV2ZW50LCB0aGlzLnVpKCBkcmFnZ2FibGUgKSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9kZWFjdGl2YXRlOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgZHJhZ2dhYmxlID0gJC51aS5kZG1hbmFnZXIuY3VycmVudDsNCg0KICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQWN0aXZlQ2xhc3MoKTsNCiAgICAgICAgICAgIGlmICggZHJhZ2dhYmxlICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJkZWFjdGl2YXRlIiwgZXZlbnQsIHRoaXMudWkoIGRyYWdnYWJsZSApICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX292ZXI6IGZ1bmN0aW9uKCBldmVudCApIHsNCg0KICAgICAgICAgICAgdmFyIGRyYWdnYWJsZSA9ICQudWkuZGRtYW5hZ2VyLmN1cnJlbnQ7DQoNCiAgICAgICAgICAgIC8vIEJhaWwgaWYgZHJhZ2dhYmxlIGFuZCBkcm9wcGFibGUgYXJlIHNhbWUgZWxlbWVudA0KICAgICAgICAgICAgaWYgKCAhZHJhZ2dhYmxlIHx8ICggZHJhZ2dhYmxlLmN1cnJlbnRJdGVtIHx8DQogICAgICAgICAgICAgICAgZHJhZ2dhYmxlLmVsZW1lbnQgKVsgMCBdID09PSB0aGlzLmVsZW1lbnRbIDAgXSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5hY2NlcHQuY2FsbCggdGhpcy5lbGVtZW50WyAwIF0sICggZHJhZ2dhYmxlLmN1cnJlbnRJdGVtIHx8DQogICAgICAgICAgICAgICAgZHJhZ2dhYmxlLmVsZW1lbnQgKSApICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX2FkZEhvdmVyQ2xhc3MoKTsNCiAgICAgICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAib3ZlciIsIGV2ZW50LCB0aGlzLnVpKCBkcmFnZ2FibGUgKSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0sDQoNCiAgICAgICAgX291dDogZnVuY3Rpb24oIGV2ZW50ICkgew0KDQogICAgICAgICAgICB2YXIgZHJhZ2dhYmxlID0gJC51aS5kZG1hbmFnZXIuY3VycmVudDsNCg0KICAgICAgICAgICAgLy8gQmFpbCBpZiBkcmFnZ2FibGUgYW5kIGRyb3BwYWJsZSBhcmUgc2FtZSBlbGVtZW50DQogICAgICAgICAgICBpZiAoICFkcmFnZ2FibGUgfHwgKCBkcmFnZ2FibGUuY3VycmVudEl0ZW0gfHwNCiAgICAgICAgICAgICAgICBkcmFnZ2FibGUuZWxlbWVudCApWyAwIF0gPT09IHRoaXMuZWxlbWVudFsgMCBdICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCB0aGlzLmFjY2VwdC5jYWxsKCB0aGlzLmVsZW1lbnRbIDAgXSwgKCBkcmFnZ2FibGUuY3VycmVudEl0ZW0gfHwNCiAgICAgICAgICAgICAgICBkcmFnZ2FibGUuZWxlbWVudCApICkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlSG92ZXJDbGFzcygpOw0KICAgICAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJvdXQiLCBldmVudCwgdGhpcy51aSggZHJhZ2dhYmxlICkgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9LA0KDQogICAgICAgIF9kcm9wOiBmdW5jdGlvbiggZXZlbnQsIGN1c3RvbSApIHsNCg0KICAgICAgICAgICAgdmFyIGRyYWdnYWJsZSA9IGN1c3RvbSB8fCAkLnVpLmRkbWFuYWdlci5jdXJyZW50LA0KICAgICAgICAgICAgICAgIGNoaWxkcmVuSW50ZXJzZWN0aW9uID0gZmFsc2U7DQoNCiAgICAgICAgICAgIC8vIEJhaWwgaWYgZHJhZ2dhYmxlIGFuZCBkcm9wcGFibGUgYXJlIHNhbWUgZWxlbWVudA0KICAgICAgICAgICAgaWYgKCAhZHJhZ2dhYmxlIHx8ICggZHJhZ2dhYmxlLmN1cnJlbnRJdGVtIHx8DQogICAgICAgICAgICAgICAgZHJhZ2dhYmxlLmVsZW1lbnQgKVsgMCBdID09PSB0aGlzLmVsZW1lbnRbIDAgXSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudA0KICAgICAgICAgICAgICAgIC5maW5kKCAiOmRhdGEodWktZHJvcHBhYmxlKSIgKQ0KICAgICAgICAgICAgICAgIC5ub3QoICIudWktZHJhZ2dhYmxlLWRyYWdnaW5nIiApDQogICAgICAgICAgICAgICAgLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgaW5zdCA9ICQoIHRoaXMgKS5kcm9wcGFibGUoICJpbnN0YW5jZSIgKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKA0KICAgICAgICAgICAgICAgICAgICAgICAgaW5zdC5vcHRpb25zLmdyZWVkeSAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgIWluc3Qub3B0aW9ucy5kaXNhYmxlZCAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgaW5zdC5vcHRpb25zLnNjb3BlID09PSBkcmFnZ2FibGUub3B0aW9ucy5zY29wZSAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgaW5zdC5hY2NlcHQuY2FsbCgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0LmVsZW1lbnRbIDAgXSwgKCBkcmFnZ2FibGUuY3VycmVudEl0ZW0gfHwgZHJhZ2dhYmxlLmVsZW1lbnQgKQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJzZWN0KA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdnYWJsZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmV4dGVuZCggaW5zdCwgeyBvZmZzZXQ6IGluc3QuZWxlbWVudC5vZmZzZXQoKSB9ICksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdC5vcHRpb25zLnRvbGVyYW5jZSwgZXZlbnQNCiAgICAgICAgICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbkludGVyc2VjdGlvbiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IH0NCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICBpZiAoIGNoaWxkcmVuSW50ZXJzZWN0aW9uICkgew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCB0aGlzLmFjY2VwdC5jYWxsKCB0aGlzLmVsZW1lbnRbIDAgXSwNCiAgICAgICAgICAgICAgICAoIGRyYWdnYWJsZS5jdXJyZW50SXRlbSB8fCBkcmFnZ2FibGUuZWxlbWVudCApICkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQWN0aXZlQ2xhc3MoKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVIb3ZlckNsYXNzKCk7DQoNCiAgICAgICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAiZHJvcCIsIGV2ZW50LCB0aGlzLnVpKCBkcmFnZ2FibGUgKSApOw0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQ7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCg0KICAgICAgICB9LA0KDQogICAgICAgIHVpOiBmdW5jdGlvbiggYyApIHsNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgZHJhZ2dhYmxlOiAoIGMuY3VycmVudEl0ZW0gfHwgYy5lbGVtZW50ICksDQogICAgICAgICAgICAgICAgaGVscGVyOiBjLmhlbHBlciwNCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogYy5wb3NpdGlvbiwNCiAgICAgICAgICAgICAgICBvZmZzZXQ6IGMucG9zaXRpb25BYnMNCiAgICAgICAgICAgIH07DQogICAgICAgIH0sDQoNCiAgICAgICAgLy8gRXh0ZW5zaW9uIHBvaW50cyBqdXN0IHRvIG1ha2UgYmFja2NvbXBhdCBzYW5lIGFuZCBhdm9pZCBkdXBsaWNhdGluZyBsb2dpYw0KICAgICAgICAvLyBUT0RPOiBSZW1vdmUgaW4gMS4xMyBhbG9uZyB3aXRoIGNhbGwgdG8gaXQgYmVsb3cNCiAgICAgICAgX2FkZEhvdmVyQ2xhc3M6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoICJ1aS1kcm9wcGFibGUtaG92ZXIiICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3JlbW92ZUhvdmVyQ2xhc3M6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ2xhc3MoICJ1aS1kcm9wcGFibGUtaG92ZXIiICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2FkZEFjdGl2ZUNsYXNzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCAidWktZHJvcHBhYmxlLWFjdGl2ZSIgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcmVtb3ZlQWN0aXZlQ2xhc3M6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ2xhc3MoICJ1aS1kcm9wcGFibGUtYWN0aXZlIiApOw0KICAgICAgICB9DQogICAgfSApOw0KDQogICAgdmFyIGludGVyc2VjdCA9ICQudWkuaW50ZXJzZWN0ID0gKCBmdW5jdGlvbigpIHsNCiAgICAgICAgZnVuY3Rpb24gaXNPdmVyQXhpcyggeCwgcmVmZXJlbmNlLCBzaXplICkgew0KICAgICAgICAgICAgcmV0dXJuICggeCA+PSByZWZlcmVuY2UgKSAmJiAoIHggPCAoIHJlZmVyZW5jZSArIHNpemUgKSApOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCBkcmFnZ2FibGUsIGRyb3BwYWJsZSwgdG9sZXJhbmNlTW9kZSwgZXZlbnQgKSB7DQoNCiAgICAgICAgICAgIGlmICggIWRyb3BwYWJsZS5vZmZzZXQgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgeDEgPSAoIGRyYWdnYWJsZS5wb3NpdGlvbkFicyB8fA0KICAgICAgICAgICAgICAgIGRyYWdnYWJsZS5wb3NpdGlvbi5hYnNvbHV0ZSApLmxlZnQgKyBkcmFnZ2FibGUubWFyZ2lucy5sZWZ0LA0KICAgICAgICAgICAgICAgIHkxID0gKCBkcmFnZ2FibGUucG9zaXRpb25BYnMgfHwNCiAgICAgICAgICAgICAgICAgICAgZHJhZ2dhYmxlLnBvc2l0aW9uLmFic29sdXRlICkudG9wICsgZHJhZ2dhYmxlLm1hcmdpbnMudG9wLA0KICAgICAgICAgICAgICAgIHgyID0geDEgKyBkcmFnZ2FibGUuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgsDQogICAgICAgICAgICAgICAgeTIgPSB5MSArIGRyYWdnYWJsZS5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQsDQogICAgICAgICAgICAgICAgbCA9IGRyb3BwYWJsZS5vZmZzZXQubGVmdCwNCiAgICAgICAgICAgICAgICB0ID0gZHJvcHBhYmxlLm9mZnNldC50b3AsDQogICAgICAgICAgICAgICAgciA9IGwgKyBkcm9wcGFibGUucHJvcG9ydGlvbnMoKS53aWR0aCwNCiAgICAgICAgICAgICAgICBiID0gdCArIGRyb3BwYWJsZS5wcm9wb3J0aW9ucygpLmhlaWdodDsNCg0KICAgICAgICAgICAgc3dpdGNoICggdG9sZXJhbmNlTW9kZSApIHsNCiAgICAgICAgICAgICAgICBjYXNlICJmaXQiOg0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCBsIDw9IHgxICYmIHgyIDw9IHIgJiYgdCA8PSB5MSAmJiB5MiA8PSBiICk7DQogICAgICAgICAgICAgICAgY2FzZSAiaW50ZXJzZWN0IjoNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICggbCA8IHgxICsgKCBkcmFnZ2FibGUuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggLyAyICkgJiYgLy8gUmlnaHQgSGFsZg0KICAgICAgICAgICAgICAgICAgICAgICAgeDIgLSAoIGRyYWdnYWJsZS5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAvIDIgKSA8IHIgJiYgLy8gTGVmdCBIYWxmDQogICAgICAgICAgICAgICAgICAgICAgICB0IDwgeTEgKyAoIGRyYWdnYWJsZS5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLyAyICkgJiYgLy8gQm90dG9tIEhhbGYNCiAgICAgICAgICAgICAgICAgICAgICAgIHkyIC0gKCBkcmFnZ2FibGUuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC8gMiApIDwgYiApOyAvLyBUb3AgSGFsZg0KICAgICAgICAgICAgICAgIGNhc2UgInBvaW50ZXIiOg0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNPdmVyQXhpcyggZXZlbnQucGFnZVksIHQsIGRyb3BwYWJsZS5wcm9wb3J0aW9ucygpLmhlaWdodCApICYmDQogICAgICAgICAgICAgICAgICAgICAgICBpc092ZXJBeGlzKCBldmVudC5wYWdlWCwgbCwgZHJvcHBhYmxlLnByb3BvcnRpb25zKCkud2lkdGggKTsNCiAgICAgICAgICAgICAgICBjYXNlICJ0b3VjaCI6DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAoDQogICAgICAgICAgICAgICAgICAgICAgICAoIHkxID49IHQgJiYgeTEgPD0gYiApIHx8IC8vIFRvcCBlZGdlIHRvdWNoaW5nDQogICAgICAgICAgICAgICAgICAgICAgICAoIHkyID49IHQgJiYgeTIgPD0gYiApIHx8IC8vIEJvdHRvbSBlZGdlIHRvdWNoaW5nDQogICAgICAgICAgICAgICAgICAgICAgICAoIHkxIDwgdCAmJiB5MiA+IGIgKSAvLyBTdXJyb3VuZGVkIHZlcnRpY2FsbHkNCiAgICAgICAgICAgICAgICAgICAgKSAmJiAoDQogICAgICAgICAgICAgICAgICAgICAgICAoIHgxID49IGwgJiYgeDEgPD0gciApIHx8IC8vIExlZnQgZWRnZSB0b3VjaGluZw0KICAgICAgICAgICAgICAgICAgICAgICAgKCB4MiA+PSBsICYmIHgyIDw9IHIgKSB8fCAvLyBSaWdodCBlZGdlIHRvdWNoaW5nDQogICAgICAgICAgICAgICAgICAgICAgICAoIHgxIDwgbCAmJiB4MiA+IHIgKSAvLyBTdXJyb3VuZGVkIGhvcml6b250YWxseQ0KICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCiAgICB9ICkoKTsNCg0KICAgIC8qDQoJVGhpcyBtYW5hZ2VyIHRyYWNrcyBvZmZzZXRzIG9mIGRyYWdnYWJsZXMgYW5kIGRyb3BwYWJsZXMNCiovDQogICAgJC51aS5kZG1hbmFnZXIgPSB7DQogICAgICAgIGN1cnJlbnQ6IG51bGwsDQogICAgICAgIGRyb3BwYWJsZXM6IHsgImRlZmF1bHQiOiBbXSB9LA0KICAgICAgICBwcmVwYXJlT2Zmc2V0czogZnVuY3Rpb24oIHQsIGV2ZW50ICkgew0KDQogICAgICAgICAgICB2YXIgaSwgaiwNCiAgICAgICAgICAgICAgICBtID0gJC51aS5kZG1hbmFnZXIuZHJvcHBhYmxlc1sgdC5vcHRpb25zLnNjb3BlIF0gfHwgW10sDQogICAgICAgICAgICAgICAgdHlwZSA9IGV2ZW50ID8gZXZlbnQudHlwZSA6IG51bGwsIC8vIHdvcmthcm91bmQgZm9yICMyMzE3DQogICAgICAgICAgICAgICAgbGlzdCA9ICggdC5jdXJyZW50SXRlbSB8fCB0LmVsZW1lbnQgKS5maW5kKCAiOmRhdGEodWktZHJvcHBhYmxlKSIgKS5hZGRCYWNrKCk7DQoNCiAgICAgICAgICAgIGRyb3BwYWJsZXNMb29wOiBmb3IgKCBpID0gMDsgaSA8IG0ubGVuZ3RoOyBpKysgKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBObyBkaXNhYmxlZCBhbmQgbm9uLWFjY2VwdGVkDQogICAgICAgICAgICAgICAgaWYgKCBtWyBpIF0ub3B0aW9ucy5kaXNhYmxlZCB8fCAoIHQgJiYgIW1bIGkgXS5hY2NlcHQuY2FsbCggbVsgaSBdLmVsZW1lbnRbIDAgXSwNCiAgICAgICAgICAgICAgICAgICAgKCB0LmN1cnJlbnRJdGVtIHx8IHQuZWxlbWVudCApICkgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8gRmlsdGVyIG91dCBlbGVtZW50cyBpbiB0aGUgY3VycmVudCBkcmFnZ2VkIGl0ZW0NCiAgICAgICAgICAgICAgICBmb3IgKCBqID0gMDsgaiA8IGxpc3QubGVuZ3RoOyBqKysgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggbGlzdFsgaiBdID09PSBtWyBpIF0uZWxlbWVudFsgMCBdICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbVsgaSBdLnByb3BvcnRpb25zKCkuaGVpZ2h0ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIGRyb3BwYWJsZXNMb29wOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgbVsgaSBdLnZpc2libGUgPSBtWyBpIF0uZWxlbWVudC5jc3MoICJkaXNwbGF5IiApICE9PSAibm9uZSI7DQogICAgICAgICAgICAgICAgaWYgKCAhbVsgaSBdLnZpc2libGUgKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIEFjdGl2YXRlIHRoZSBkcm9wcGFibGUgaWYgdXNlZCBkaXJlY3RseSBmcm9tIGRyYWdnYWJsZXMNCiAgICAgICAgICAgICAgICBpZiAoIHR5cGUgPT09ICJtb3VzZWRvd24iICkgew0KICAgICAgICAgICAgICAgICAgICBtWyBpIF0uX2FjdGl2YXRlLmNhbGwoIG1bIGkgXSwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBtWyBpIF0ub2Zmc2V0ID0gbVsgaSBdLmVsZW1lbnQub2Zmc2V0KCk7DQogICAgICAgICAgICAgICAgbVsgaSBdLnByb3BvcnRpb25zKCB7DQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiBtWyBpIF0uZWxlbWVudFsgMCBdLm9mZnNldFdpZHRoLA0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IG1bIGkgXS5lbGVtZW50WyAwIF0ub2Zmc2V0SGVpZ2h0DQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSwNCiAgICAgICAgZHJvcDogZnVuY3Rpb24oIGRyYWdnYWJsZSwgZXZlbnQgKSB7DQoNCiAgICAgICAgICAgIHZhciBkcm9wcGVkID0gZmFsc2U7DQoNCiAgICAgICAgICAgIC8vIENyZWF0ZSBhIGNvcHkgb2YgdGhlIGRyb3BwYWJsZXMgaW4gY2FzZSB0aGUgbGlzdCBjaGFuZ2VzIGR1cmluZyB0aGUgZHJvcCAoIzkxMTYpDQogICAgICAgICAgICAkLmVhY2goICggJC51aS5kZG1hbmFnZXIuZHJvcHBhYmxlc1sgZHJhZ2dhYmxlLm9wdGlvbnMuc2NvcGUgXSB8fCBbXSApLnNsaWNlKCksIGZ1bmN0aW9uKCkgew0KDQogICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5vcHRpb25zICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICggIXRoaXMub3B0aW9ucy5kaXNhYmxlZCAmJiB0aGlzLnZpc2libGUgJiYNCiAgICAgICAgICAgICAgICAgICAgaW50ZXJzZWN0KCBkcmFnZ2FibGUsIHRoaXMsIHRoaXMub3B0aW9ucy50b2xlcmFuY2UsIGV2ZW50ICkgKSB7DQogICAgICAgICAgICAgICAgICAgIGRyb3BwZWQgPSB0aGlzLl9kcm9wLmNhbGwoIHRoaXMsIGV2ZW50ICkgfHwgZHJvcHBlZDsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoICF0aGlzLm9wdGlvbnMuZGlzYWJsZWQgJiYgdGhpcy52aXNpYmxlICYmIHRoaXMuYWNjZXB0LmNhbGwoIHRoaXMuZWxlbWVudFsgMCBdLA0KICAgICAgICAgICAgICAgICAgICAoIGRyYWdnYWJsZS5jdXJyZW50SXRlbSB8fCBkcmFnZ2FibGUuZWxlbWVudCApICkgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXNvdXQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlzb3ZlciA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZWFjdGl2YXRlLmNhbGwoIHRoaXMsIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9ICk7DQogICAgICAgICAgICByZXR1cm4gZHJvcHBlZDsNCg0KICAgICAgICB9LA0KICAgICAgICBkcmFnU3RhcnQ6IGZ1bmN0aW9uKCBkcmFnZ2FibGUsIGV2ZW50ICkgew0KDQogICAgICAgICAgICAvLyBMaXN0ZW4gZm9yIHNjcm9sbGluZyBzbyB0aGF0IGlmIHRoZSBkcmFnZ2luZyBjYXVzZXMgc2Nyb2xsaW5nIHRoZSBwb3NpdGlvbiBvZiB0aGUNCiAgICAgICAgICAgIC8vIGRyb3BwYWJsZXMgY2FuIGJlIHJlY2FsY3VsYXRlZCAoc2VlICM1MDAzKQ0KICAgICAgICAgICAgZHJhZ2dhYmxlLmVsZW1lbnQucGFyZW50c1VudGlsKCAiYm9keSIgKS5vbiggInNjcm9sbC5kcm9wcGFibGUiLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBpZiAoICFkcmFnZ2FibGUub3B0aW9ucy5yZWZyZXNoUG9zaXRpb25zICkgew0KICAgICAgICAgICAgICAgICAgICAkLnVpLmRkbWFuYWdlci5wcmVwYXJlT2Zmc2V0cyggZHJhZ2dhYmxlLCBldmVudCApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCiAgICAgICAgZHJhZzogZnVuY3Rpb24oIGRyYWdnYWJsZSwgZXZlbnQgKSB7DQoNCiAgICAgICAgICAgIC8vIElmIHlvdSBoYXZlIGEgaGlnaGx5IGR5bmFtaWMgcGFnZSwgeW91IG1pZ2h0IHRyeSB0aGlzIG9wdGlvbi4gSXQgcmVuZGVycyBwb3NpdGlvbnMNCiAgICAgICAgICAgIC8vIGV2ZXJ5IHRpbWUgeW91IG1vdmUgdGhlIG1vdXNlLg0KICAgICAgICAgICAgaWYgKCBkcmFnZ2FibGUub3B0aW9ucy5yZWZyZXNoUG9zaXRpb25zICkgew0KICAgICAgICAgICAgICAgICQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKCBkcmFnZ2FibGUsIGV2ZW50ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFJ1biB0aHJvdWdoIGFsbCBkcm9wcGFibGVzIGFuZCBjaGVjayB0aGVpciBwb3NpdGlvbnMgYmFzZWQgb24gc3BlY2lmaWMgdG9sZXJhbmNlIG9wdGlvbnMNCiAgICAgICAgICAgICQuZWFjaCggJC51aS5kZG1hbmFnZXIuZHJvcHBhYmxlc1sgZHJhZ2dhYmxlLm9wdGlvbnMuc2NvcGUgXSB8fCBbXSwgZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCB8fCB0aGlzLmdyZWVkeUNoaWxkIHx8ICF0aGlzLnZpc2libGUgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB2YXIgcGFyZW50SW5zdGFuY2UsIHNjb3BlLCBwYXJlbnQsDQogICAgICAgICAgICAgICAgICAgIGludGVyc2VjdHMgPSBpbnRlcnNlY3QoIGRyYWdnYWJsZSwgdGhpcywgdGhpcy5vcHRpb25zLnRvbGVyYW5jZSwgZXZlbnQgKSwNCiAgICAgICAgICAgICAgICAgICAgYyA9ICFpbnRlcnNlY3RzICYmIHRoaXMuaXNvdmVyID8NCiAgICAgICAgICAgICAgICAgICAgICAgICJpc291dCIgOg0KICAgICAgICAgICAgICAgICAgICAgICAgKCBpbnRlcnNlY3RzICYmICF0aGlzLmlzb3ZlciA/ICJpc292ZXIiIDogbnVsbCApOw0KICAgICAgICAgICAgICAgIGlmICggIWMgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5ncmVlZHkgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gZmluZCBkcm9wcGFibGUgcGFyZW50cyB3aXRoIHNhbWUgc2NvcGUNCiAgICAgICAgICAgICAgICAgICAgc2NvcGUgPSB0aGlzLm9wdGlvbnMuc2NvcGU7DQogICAgICAgICAgICAgICAgICAgIHBhcmVudCA9IHRoaXMuZWxlbWVudC5wYXJlbnRzKCAiOmRhdGEodWktZHJvcHBhYmxlKSIgKS5maWx0ZXIoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQoIHRoaXMgKS5kcm9wcGFibGUoICJpbnN0YW5jZSIgKS5vcHRpb25zLnNjb3BlID09PSBzY29wZTsNCiAgICAgICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgICAgIGlmICggcGFyZW50Lmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudEluc3RhbmNlID0gJCggcGFyZW50WyAwIF0gKS5kcm9wcGFibGUoICJpbnN0YW5jZSIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudEluc3RhbmNlLmdyZWVkeUNoaWxkID0gKCBjID09PSAiaXNvdmVyIiApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8gV2UganVzdCBtb3ZlZCBpbnRvIGEgZ3JlZWR5IGNoaWxkDQogICAgICAgICAgICAgICAgaWYgKCBwYXJlbnRJbnN0YW5jZSAmJiBjID09PSAiaXNvdmVyIiApIHsNCiAgICAgICAgICAgICAgICAgICAgcGFyZW50SW5zdGFuY2UuaXNvdmVyID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHBhcmVudEluc3RhbmNlLmlzb3V0ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgcGFyZW50SW5zdGFuY2UuX291dC5jYWxsKCBwYXJlbnRJbnN0YW5jZSwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGlzWyBjIF0gPSB0cnVlOw0KICAgICAgICAgICAgICAgIHRoaXNbIGMgPT09ICJpc291dCIgPyAiaXNvdmVyIiA6ICJpc291dCIgXSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIHRoaXNbIGMgPT09ICJpc292ZXIiID8gIl9vdmVyIiA6ICJfb3V0IiBdLmNhbGwoIHRoaXMsIGV2ZW50ICk7DQoNCiAgICAgICAgICAgICAgICAvLyBXZSBqdXN0IG1vdmVkIG91dCBvZiBhIGdyZWVkeSBjaGlsZA0KICAgICAgICAgICAgICAgIGlmICggcGFyZW50SW5zdGFuY2UgJiYgYyA9PT0gImlzb3V0IiApIHsNCiAgICAgICAgICAgICAgICAgICAgcGFyZW50SW5zdGFuY2UuaXNvdXQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgcGFyZW50SW5zdGFuY2UuaXNvdmVyID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgcGFyZW50SW5zdGFuY2UuX292ZXIuY2FsbCggcGFyZW50SW5zdGFuY2UsIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgIH0sDQogICAgICAgIGRyYWdTdG9wOiBmdW5jdGlvbiggZHJhZ2dhYmxlLCBldmVudCApIHsNCiAgICAgICAgICAgIGRyYWdnYWJsZS5lbGVtZW50LnBhcmVudHNVbnRpbCggImJvZHkiICkub2ZmKCAic2Nyb2xsLmRyb3BwYWJsZSIgKTsNCg0KICAgICAgICAgICAgLy8gQ2FsbCBwcmVwYXJlT2Zmc2V0cyBvbmUgZmluYWwgdGltZSBzaW5jZSBJRSBkb2VzIG5vdCBmaXJlIHJldHVybiBzY3JvbGwgZXZlbnRzIHdoZW4NCiAgICAgICAgICAgIC8vIG92ZXJmbG93IHdhcyBjYXVzZWQgYnkgZHJhZyAoc2VlICM1MDAzKQ0KICAgICAgICAgICAgaWYgKCAhZHJhZ2dhYmxlLm9wdGlvbnMucmVmcmVzaFBvc2l0aW9ucyApIHsNCiAgICAgICAgICAgICAgICAkLnVpLmRkbWFuYWdlci5wcmVwYXJlT2Zmc2V0cyggZHJhZ2dhYmxlLCBldmVudCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfTsNCg0KLy8gREVQUkVDQVRFRA0KLy8gVE9ETzogc3dpdGNoIHJldHVybiBiYWNrIHRvIHdpZGdldCBkZWNsYXJhdGlvbiBhdCB0b3Agb2YgZmlsZSB3aGVuIHRoaXMgaXMgcmVtb3ZlZA0KICAgIGlmICggJC51aUJhY2tDb21wYXQgIT09IGZhbHNlICkgew0KDQogICAgICAgIC8vIEJhY2tjb21wYXQgZm9yIGFjdGl2ZUNsYXNzIGFuZCBob3ZlckNsYXNzIG9wdGlvbnMNCiAgICAgICAgJC53aWRnZXQoICJ1aS5kcm9wcGFibGUiLCAkLnVpLmRyb3BwYWJsZSwgew0KICAgICAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgICAgIGhvdmVyQ2xhc3M6IGZhbHNlLA0KICAgICAgICAgICAgICAgIGFjdGl2ZUNsYXNzOiBmYWxzZQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIF9hZGRBY3RpdmVDbGFzczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fc3VwZXIoKTsNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5hY3RpdmVDbGFzcyApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZENsYXNzKCB0aGlzLm9wdGlvbnMuYWN0aXZlQ2xhc3MgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgX3JlbW92ZUFjdGl2ZUNsYXNzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9zdXBlcigpOw0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmFjdGl2ZUNsYXNzICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoIHRoaXMub3B0aW9ucy5hY3RpdmVDbGFzcyApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBfYWRkSG92ZXJDbGFzczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fc3VwZXIoKTsNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5ob3ZlckNsYXNzICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoIHRoaXMub3B0aW9ucy5ob3ZlckNsYXNzICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIF9yZW1vdmVIb3ZlckNsYXNzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9zdXBlcigpOw0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmhvdmVyQ2xhc3MgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVDbGFzcyggdGhpcy5vcHRpb25zLmhvdmVyQ2xhc3MgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0gKTsNCiAgICB9DQoNCiAgICB2YXIgd2lkZ2V0c0Ryb3BwYWJsZSA9ICQudWkuZHJvcHBhYmxlOw0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBQcm9ncmVzc2JhciAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogUHJvZ3Jlc3NiYXINCi8vPj5ncm91cDogV2lkZ2V0cw0KLy8ganNjczpkaXNhYmxlIG1heGltdW1MaW5lTGVuZ3RoDQovLz4+ZGVzY3JpcHRpb246IERpc3BsYXlzIGEgc3RhdHVzIGluZGljYXRvciBmb3IgbG9hZGluZyBzdGF0ZSwgc3RhbmRhcmQgcGVyY2VudGFnZSwgYW5kIG90aGVyIHByb2dyZXNzIGluZGljYXRvcnMuDQovLyBqc2NzOmVuYWJsZSBtYXhpbXVtTGluZUxlbmd0aA0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL3Byb2dyZXNzYmFyLw0KLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL3Byb2dyZXNzYmFyLw0KLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2NvcmUuY3NzDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvcHJvZ3Jlc3NiYXIuY3NzDQovLz4+Y3NzLnRoZW1lOiAuLi8uLi90aGVtZXMvYmFzZS90aGVtZS5jc3MNCg0KDQoNCiAgICB2YXIgd2lkZ2V0c1Byb2dyZXNzYmFyID0gJC53aWRnZXQoICJ1aS5wcm9ncmVzc2JhciIsIHsNCiAgICAgICAgdmVyc2lvbjogIjEuMTIuMSIsDQogICAgICAgIG9wdGlvbnM6IHsNCiAgICAgICAgICAgIGNsYXNzZXM6IHsNCiAgICAgICAgICAgICAgICAidWktcHJvZ3Jlc3NiYXIiOiAidWktY29ybmVyLWFsbCIsDQogICAgICAgICAgICAgICAgInVpLXByb2dyZXNzYmFyLXZhbHVlIjogInVpLWNvcm5lci1sZWZ0IiwNCiAgICAgICAgICAgICAgICAidWktcHJvZ3Jlc3NiYXItY29tcGxldGUiOiAidWktY29ybmVyLXJpZ2h0Ig0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG1heDogMTAwLA0KICAgICAgICAgICAgdmFsdWU6IDAsDQoNCiAgICAgICAgICAgIGNoYW5nZTogbnVsbCwNCiAgICAgICAgICAgIGNvbXBsZXRlOiBudWxsDQogICAgICAgIH0sDQoNCiAgICAgICAgbWluOiAwLA0KDQogICAgICAgIF9jcmVhdGU6IGZ1bmN0aW9uKCkgew0KDQogICAgICAgICAgICAvLyBDb25zdHJhaW4gaW5pdGlhbCB2YWx1ZQ0KICAgICAgICAgICAgdGhpcy5vbGRWYWx1ZSA9IHRoaXMub3B0aW9ucy52YWx1ZSA9IHRoaXMuX2NvbnN0cmFpbmVkVmFsdWUoKTsNCg0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LmF0dHIoIHsNCg0KICAgICAgICAgICAgICAgIC8vIE9ubHkgc2V0IHN0YXRpYyB2YWx1ZXM7IGFyaWEtdmFsdWVub3cgYW5kIGFyaWEtdmFsdWVtYXggYXJlDQogICAgICAgICAgICAgICAgLy8gc2V0IGluc2lkZSBfcmVmcmVzaFZhbHVlKCkNCiAgICAgICAgICAgICAgICByb2xlOiAicHJvZ3Jlc3NiYXIiLA0KICAgICAgICAgICAgICAgICJhcmlhLXZhbHVlbWluIjogdGhpcy5taW4NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCAidWktcHJvZ3Jlc3NiYXIiLCAidWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IiApOw0KDQogICAgICAgICAgICB0aGlzLnZhbHVlRGl2ID0gJCggIjxkaXY+IiApLmFwcGVuZFRvKCB0aGlzLmVsZW1lbnQgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLnZhbHVlRGl2LCAidWktcHJvZ3Jlc3NiYXItdmFsdWUiLCAidWktd2lkZ2V0LWhlYWRlciIgKTsNCiAgICAgICAgICAgIHRoaXMuX3JlZnJlc2hWYWx1ZSgpOw0KICAgICAgICB9LA0KDQogICAgICAgIF9kZXN0cm95OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyKCAicm9sZSBhcmlhLXZhbHVlbWluIGFyaWEtdmFsdWVtYXggYXJpYS12YWx1ZW5vdyIgKTsNCg0KICAgICAgICAgICAgdGhpcy52YWx1ZURpdi5yZW1vdmUoKTsNCiAgICAgICAgfSwNCg0KICAgICAgICB2YWx1ZTogZnVuY3Rpb24oIG5ld1ZhbHVlICkgew0KICAgICAgICAgICAgaWYgKCBuZXdWYWx1ZSA9PT0gdW5kZWZpbmVkICkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMudmFsdWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMub3B0aW9ucy52YWx1ZSA9IHRoaXMuX2NvbnN0cmFpbmVkVmFsdWUoIG5ld1ZhbHVlICk7DQogICAgICAgICAgICB0aGlzLl9yZWZyZXNoVmFsdWUoKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfY29uc3RyYWluZWRWYWx1ZTogZnVuY3Rpb24oIG5ld1ZhbHVlICkgew0KICAgICAgICAgICAgaWYgKCBuZXdWYWx1ZSA9PT0gdW5kZWZpbmVkICkgew0KICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gdGhpcy5vcHRpb25zLnZhbHVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLmluZGV0ZXJtaW5hdGUgPSBuZXdWYWx1ZSA9PT0gZmFsc2U7DQoNCiAgICAgICAgICAgIC8vIFNhbml0aXplIHZhbHVlDQogICAgICAgICAgICBpZiAoIHR5cGVvZiBuZXdWYWx1ZSAhPT0gIm51bWJlciIgKSB7DQogICAgICAgICAgICAgICAgbmV3VmFsdWUgPSAwOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gdGhpcy5pbmRldGVybWluYXRlID8gZmFsc2UgOg0KICAgICAgICAgICAgICAgIE1hdGgubWluKCB0aGlzLm9wdGlvbnMubWF4LCBNYXRoLm1heCggdGhpcy5taW4sIG5ld1ZhbHVlICkgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0T3B0aW9uczogZnVuY3Rpb24oIG9wdGlvbnMgKSB7DQoNCiAgICAgICAgICAgIC8vIEVuc3VyZSAidmFsdWUiIG9wdGlvbiBpcyBzZXQgYWZ0ZXIgb3RoZXIgdmFsdWVzIChsaWtlIG1heCkNCiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG9wdGlvbnMudmFsdWU7DQogICAgICAgICAgICBkZWxldGUgb3B0aW9ucy52YWx1ZTsNCg0KICAgICAgICAgICAgdGhpcy5fc3VwZXIoIG9wdGlvbnMgKTsNCg0KICAgICAgICAgICAgdGhpcy5vcHRpb25zLnZhbHVlID0gdGhpcy5fY29uc3RyYWluZWRWYWx1ZSggdmFsdWUgKTsNCiAgICAgICAgICAgIHRoaXMuX3JlZnJlc2hWYWx1ZSgpOw0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgew0KICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJtYXgiICkgew0KDQogICAgICAgICAgICAgICAgLy8gRG9uJ3QgYWxsb3cgYSBtYXggbGVzcyB0aGFuIG1pbg0KICAgICAgICAgICAgICAgIHZhbHVlID0gTWF0aC5tYXgoIHRoaXMubWluLCB2YWx1ZSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0T3B0aW9uRGlzYWJsZWQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHsNCiAgICAgICAgICAgIHRoaXMuX3N1cGVyKCB2YWx1ZSApOw0KDQogICAgICAgICAgICB0aGlzLmVsZW1lbnQuYXR0ciggImFyaWEtZGlzYWJsZWQiLCB2YWx1ZSApOw0KICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQ2xhc3MoIG51bGwsICJ1aS1zdGF0ZS1kaXNhYmxlZCIsICEhdmFsdWUgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcGVyY2VudGFnZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5pbmRldGVybWluYXRlID8NCiAgICAgICAgICAgICAgICAxMDAgOg0KICAgICAgICAgICAgICAgIDEwMCAqICggdGhpcy5vcHRpb25zLnZhbHVlIC0gdGhpcy5taW4gKSAvICggdGhpcy5vcHRpb25zLm1heCAtIHRoaXMubWluICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3JlZnJlc2hWYWx1ZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLm9wdGlvbnMudmFsdWUsDQogICAgICAgICAgICAgICAgcGVyY2VudGFnZSA9IHRoaXMuX3BlcmNlbnRhZ2UoKTsNCg0KICAgICAgICAgICAgdGhpcy52YWx1ZURpdg0KICAgICAgICAgICAgICAgIC50b2dnbGUoIHRoaXMuaW5kZXRlcm1pbmF0ZSB8fCB2YWx1ZSA+IHRoaXMubWluICkNCiAgICAgICAgICAgICAgICAud2lkdGgoIHBlcmNlbnRhZ2UudG9GaXhlZCggMCApICsgIiUiICk7DQoNCiAgICAgICAgICAgIHRoaXMNCiAgICAgICAgICAgICAgICAuX3RvZ2dsZUNsYXNzKCB0aGlzLnZhbHVlRGl2LCAidWktcHJvZ3Jlc3NiYXItY29tcGxldGUiLCBudWxsLA0KICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9PT0gdGhpcy5vcHRpb25zLm1heCApDQogICAgICAgICAgICAgICAgLl90b2dnbGVDbGFzcyggInVpLXByb2dyZXNzYmFyLWluZGV0ZXJtaW5hdGUiLCBudWxsLCB0aGlzLmluZGV0ZXJtaW5hdGUgKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLmluZGV0ZXJtaW5hdGUgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoICJhcmlhLXZhbHVlbm93IiApOw0KICAgICAgICAgICAgICAgIGlmICggIXRoaXMub3ZlcmxheURpdiApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdmVybGF5RGl2ID0gJCggIjxkaXY+IiApLmFwcGVuZFRvKCB0aGlzLnZhbHVlRGl2ICk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLm92ZXJsYXlEaXYsICJ1aS1wcm9ncmVzc2Jhci1vdmVybGF5IiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmF0dHIoIHsNCiAgICAgICAgICAgICAgICAgICAgImFyaWEtdmFsdWVtYXgiOiB0aGlzLm9wdGlvbnMubWF4LA0KICAgICAgICAgICAgICAgICAgICAiYXJpYS12YWx1ZW5vdyI6IHZhbHVlDQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5vdmVybGF5RGl2ICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLm92ZXJsYXlEaXYucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub3ZlcmxheURpdiA9IG51bGw7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHRoaXMub2xkVmFsdWUgIT09IHZhbHVlICkgew0KICAgICAgICAgICAgICAgIHRoaXMub2xkVmFsdWUgPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAiY2hhbmdlIiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCB2YWx1ZSA9PT0gdGhpcy5vcHRpb25zLm1heCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAiY29tcGxldGUiICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9ICk7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIFNlbGVjdGFibGUgMS4xMi4xDQogKiBodHRwOi8vanF1ZXJ5dWkuY29tDQogKg0KICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMNCiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UNCiAqLw0KDQovLz4+bGFiZWw6IFNlbGVjdGFibGUNCi8vPj5ncm91cDogSW50ZXJhY3Rpb25zDQovLz4+ZGVzY3JpcHRpb246IEFsbG93cyBncm91cHMgb2YgZWxlbWVudHMgdG8gYmUgc2VsZWN0ZWQgd2l0aCB0aGUgbW91c2UuDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vc2VsZWN0YWJsZS8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9zZWxlY3RhYmxlLw0KLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL3NlbGVjdGFibGUuY3NzDQoNCg0KDQogICAgdmFyIHdpZGdldHNTZWxlY3RhYmxlID0gJC53aWRnZXQoICJ1aS5zZWxlY3RhYmxlIiwgJC51aS5tb3VzZSwgew0KICAgICAgICB2ZXJzaW9uOiAiMS4xMi4xIiwNCiAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgYXBwZW5kVG86ICJib2R5IiwNCiAgICAgICAgICAgIGF1dG9SZWZyZXNoOiB0cnVlLA0KICAgICAgICAgICAgZGlzdGFuY2U6IDAsDQogICAgICAgICAgICBmaWx0ZXI6ICIqIiwNCiAgICAgICAgICAgIHRvbGVyYW5jZTogInRvdWNoIiwNCg0KICAgICAgICAgICAgLy8gQ2FsbGJhY2tzDQogICAgICAgICAgICBzZWxlY3RlZDogbnVsbCwNCiAgICAgICAgICAgIHNlbGVjdGluZzogbnVsbCwNCiAgICAgICAgICAgIHN0YXJ0OiBudWxsLA0KICAgICAgICAgICAgc3RvcDogbnVsbCwNCiAgICAgICAgICAgIHVuc2VsZWN0ZWQ6IG51bGwsDQogICAgICAgICAgICB1bnNlbGVjdGluZzogbnVsbA0KICAgICAgICB9LA0KICAgICAgICBfY3JlYXRlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpczsNCg0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoICJ1aS1zZWxlY3RhYmxlIiApOw0KDQogICAgICAgICAgICB0aGlzLmRyYWdnZWQgPSBmYWxzZTsNCg0KICAgICAgICAgICAgLy8gQ2FjaGUgc2VsZWN0ZWUgY2hpbGRyZW4gYmFzZWQgb24gZmlsdGVyDQogICAgICAgICAgICB0aGlzLnJlZnJlc2ggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB0aGF0LmVsZW1lbnRQb3MgPSAkKCB0aGF0LmVsZW1lbnRbIDAgXSApLm9mZnNldCgpOw0KICAgICAgICAgICAgICAgIHRoYXQuc2VsZWN0ZWVzID0gJCggdGhhdC5vcHRpb25zLmZpbHRlciwgdGhhdC5lbGVtZW50WyAwIF0gKTsNCiAgICAgICAgICAgICAgICB0aGF0Ll9hZGRDbGFzcyggdGhhdC5zZWxlY3RlZXMsICJ1aS1zZWxlY3RlZSIgKTsNCiAgICAgICAgICAgICAgICB0aGF0LnNlbGVjdGVlcy5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCggdGhpcyApLA0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWVPZmZzZXQgPSAkdGhpcy5vZmZzZXQoKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBzZWxlY3RlZU9mZnNldC5sZWZ0IC0gdGhhdC5lbGVtZW50UG9zLmxlZnQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiBzZWxlY3RlZU9mZnNldC50b3AgLSB0aGF0LmVsZW1lbnRQb3MudG9wDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAkLmRhdGEoIHRoaXMsICJzZWxlY3RhYmxlLWl0ZW0iLCB7DQogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiB0aGlzLA0KICAgICAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnQ6ICR0aGlzLA0KICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogcG9zLmxlZnQsDQogICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHBvcy50b3AsDQogICAgICAgICAgICAgICAgICAgICAgICByaWdodDogcG9zLmxlZnQgKyAkdGhpcy5vdXRlcldpZHRoKCksDQogICAgICAgICAgICAgICAgICAgICAgICBib3R0b206IHBvcy50b3AgKyAkdGhpcy5vdXRlckhlaWdodCgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRzZWxlY3RlZDogZmFsc2UsDQogICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogJHRoaXMuaGFzQ2xhc3MoICJ1aS1zZWxlY3RlZCIgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGluZzogJHRoaXMuaGFzQ2xhc3MoICJ1aS1zZWxlY3RpbmciICksDQogICAgICAgICAgICAgICAgICAgICAgICB1bnNlbGVjdGluZzogJHRoaXMuaGFzQ2xhc3MoICJ1aS11bnNlbGVjdGluZyIgKQ0KICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpOw0KDQogICAgICAgICAgICB0aGlzLl9tb3VzZUluaXQoKTsNCg0KICAgICAgICAgICAgdGhpcy5oZWxwZXIgPSAkKCAiPGRpdj4iICk7DQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy5oZWxwZXIsICJ1aS1zZWxlY3RhYmxlLWhlbHBlciIgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZGVzdHJveTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLnNlbGVjdGVlcy5yZW1vdmVEYXRhKCAic2VsZWN0YWJsZS1pdGVtIiApOw0KICAgICAgICAgICAgdGhpcy5fbW91c2VEZXN0cm95KCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX21vdXNlU3RhcnQ6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcywNCiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zOw0KDQogICAgICAgICAgICB0aGlzLm9wb3MgPSBbIGV2ZW50LnBhZ2VYLCBldmVudC5wYWdlWSBdOw0KICAgICAgICAgICAgdGhpcy5lbGVtZW50UG9zID0gJCggdGhpcy5lbGVtZW50WyAwIF0gKS5vZmZzZXQoKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuZGlzYWJsZWQgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLnNlbGVjdGVlcyA9ICQoIG9wdGlvbnMuZmlsdGVyLCB0aGlzLmVsZW1lbnRbIDAgXSApOw0KDQogICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAic3RhcnQiLCBldmVudCApOw0KDQogICAgICAgICAgICAkKCBvcHRpb25zLmFwcGVuZFRvICkuYXBwZW5kKCB0aGlzLmhlbHBlciApOw0KDQogICAgICAgICAgICAvLyBwb3NpdGlvbiBoZWxwZXIgKGxhc3NvKQ0KICAgICAgICAgICAgdGhpcy5oZWxwZXIuY3NzKCB7DQogICAgICAgICAgICAgICAgImxlZnQiOiBldmVudC5wYWdlWCwNCiAgICAgICAgICAgICAgICAidG9wIjogZXZlbnQucGFnZVksDQogICAgICAgICAgICAgICAgIndpZHRoIjogMCwNCiAgICAgICAgICAgICAgICAiaGVpZ2h0IjogMA0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICBpZiAoIG9wdGlvbnMuYXV0b1JlZnJlc2ggKSB7DQogICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWVzLmZpbHRlciggIi51aS1zZWxlY3RlZCIgKS5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWUgPSAkLmRhdGEoIHRoaXMsICJzZWxlY3RhYmxlLWl0ZW0iICk7DQogICAgICAgICAgICAgICAgc2VsZWN0ZWUuc3RhcnRzZWxlY3RlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgaWYgKCAhZXZlbnQubWV0YUtleSAmJiAhZXZlbnQuY3RybEtleSApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fcmVtb3ZlQ2xhc3MoIHNlbGVjdGVlLiRlbGVtZW50LCAidWktc2VsZWN0ZWQiICk7DQogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVlLnNlbGVjdGVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX2FkZENsYXNzKCBzZWxlY3RlZS4kZWxlbWVudCwgInVpLXVuc2VsZWN0aW5nIiApOw0KICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZS51bnNlbGVjdGluZyA9IHRydWU7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gc2VsZWN0YWJsZSBVTlNFTEVDVElORyBjYWxsYmFjaw0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll90cmlnZ2VyKCAidW5zZWxlY3RpbmciLCBldmVudCwgew0KICAgICAgICAgICAgICAgICAgICAgICAgdW5zZWxlY3Rpbmc6IHNlbGVjdGVlLmVsZW1lbnQNCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgJCggZXZlbnQudGFyZ2V0ICkucGFyZW50cygpLmFkZEJhY2soKS5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB2YXIgZG9TZWxlY3QsDQogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVlID0gJC5kYXRhKCB0aGlzLCAic2VsZWN0YWJsZS1pdGVtIiApOw0KICAgICAgICAgICAgICAgIGlmICggc2VsZWN0ZWUgKSB7DQogICAgICAgICAgICAgICAgICAgIGRvU2VsZWN0ID0gKCAhZXZlbnQubWV0YUtleSAmJiAhZXZlbnQuY3RybEtleSApIHx8DQogICAgICAgICAgICAgICAgICAgICAgICAhc2VsZWN0ZWUuJGVsZW1lbnQuaGFzQ2xhc3MoICJ1aS1zZWxlY3RlZCIgKTsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fcmVtb3ZlQ2xhc3MoIHNlbGVjdGVlLiRlbGVtZW50LCBkb1NlbGVjdCA/ICJ1aS11bnNlbGVjdGluZyIgOiAidWktc2VsZWN0ZWQiICkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5fYWRkQ2xhc3MoIHNlbGVjdGVlLiRlbGVtZW50LCBkb1NlbGVjdCA/ICJ1aS1zZWxlY3RpbmciIDogInVpLXVuc2VsZWN0aW5nIiApOw0KICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZS51bnNlbGVjdGluZyA9ICFkb1NlbGVjdDsNCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWUuc2VsZWN0aW5nID0gZG9TZWxlY3Q7DQogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVlLnNlbGVjdGVkID0gZG9TZWxlY3Q7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gc2VsZWN0YWJsZSAoVU4pU0VMRUNUSU5HIGNhbGxiYWNrDQogICAgICAgICAgICAgICAgICAgIGlmICggZG9TZWxlY3QgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll90cmlnZ2VyKCAic2VsZWN0aW5nIiwgZXZlbnQsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpbmc6IHNlbGVjdGVlLmVsZW1lbnQNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3RyaWdnZXIoICJ1bnNlbGVjdGluZyIsIGV2ZW50LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zZWxlY3Rpbmc6IHNlbGVjdGVlLmVsZW1lbnQNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgIH0sDQoNCiAgICAgICAgX21vdXNlRHJhZzogZnVuY3Rpb24oIGV2ZW50ICkgew0KDQogICAgICAgICAgICB0aGlzLmRyYWdnZWQgPSB0cnVlOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciB0bXAsDQogICAgICAgICAgICAgICAgdGhhdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucywNCiAgICAgICAgICAgICAgICB4MSA9IHRoaXMub3Bvc1sgMCBdLA0KICAgICAgICAgICAgICAgIHkxID0gdGhpcy5vcG9zWyAxIF0sDQogICAgICAgICAgICAgICAgeDIgPSBldmVudC5wYWdlWCwNCiAgICAgICAgICAgICAgICB5MiA9IGV2ZW50LnBhZ2VZOw0KDQogICAgICAgICAgICBpZiAoIHgxID4geDIgKSB7IHRtcCA9IHgyOyB4MiA9IHgxOyB4MSA9IHRtcDsgfQ0KICAgICAgICAgICAgaWYgKCB5MSA+IHkyICkgeyB0bXAgPSB5MjsgeTIgPSB5MTsgeTEgPSB0bXA7IH0NCiAgICAgICAgICAgIHRoaXMuaGVscGVyLmNzcyggeyBsZWZ0OiB4MSwgdG9wOiB5MSwgd2lkdGg6IHgyIC0geDEsIGhlaWdodDogeTIgLSB5MSB9ICk7DQoNCiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWVzLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZSA9ICQuZGF0YSggdGhpcywgInNlbGVjdGFibGUtaXRlbSIgKSwNCiAgICAgICAgICAgICAgICAgICAgaGl0ID0gZmFsc2UsDQogICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IHt9Ow0KDQogICAgICAgICAgICAgICAgLy9wcmV2ZW50IGhlbHBlciBmcm9tIGJlaW5nIHNlbGVjdGVkIGlmIGFwcGVuZFRvOiBzZWxlY3RhYmxlDQogICAgICAgICAgICAgICAgaWYgKCAhc2VsZWN0ZWUgfHwgc2VsZWN0ZWUuZWxlbWVudCA9PT0gdGhhdC5lbGVtZW50WyAwIF0gKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBvZmZzZXQubGVmdCAgID0gc2VsZWN0ZWUubGVmdCAgICsgdGhhdC5lbGVtZW50UG9zLmxlZnQ7DQogICAgICAgICAgICAgICAgb2Zmc2V0LnJpZ2h0ICA9IHNlbGVjdGVlLnJpZ2h0ICArIHRoYXQuZWxlbWVudFBvcy5sZWZ0Ow0KICAgICAgICAgICAgICAgIG9mZnNldC50b3AgICAgPSBzZWxlY3RlZS50b3AgICAgKyB0aGF0LmVsZW1lbnRQb3MudG9wOw0KICAgICAgICAgICAgICAgIG9mZnNldC5ib3R0b20gPSBzZWxlY3RlZS5ib3R0b20gKyB0aGF0LmVsZW1lbnRQb3MudG9wOw0KDQogICAgICAgICAgICAgICAgaWYgKCBvcHRpb25zLnRvbGVyYW5jZSA9PT0gInRvdWNoIiApIHsNCiAgICAgICAgICAgICAgICAgICAgaGl0ID0gKCAhKCBvZmZzZXQubGVmdCA+IHgyIHx8IG9mZnNldC5yaWdodCA8IHgxIHx8IG9mZnNldC50b3AgPiB5MiB8fA0KICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0LmJvdHRvbSA8IHkxICkgKTsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBvcHRpb25zLnRvbGVyYW5jZSA9PT0gImZpdCIgKSB7DQogICAgICAgICAgICAgICAgICAgIGhpdCA9ICggb2Zmc2V0LmxlZnQgPiB4MSAmJiBvZmZzZXQucmlnaHQgPCB4MiAmJiBvZmZzZXQudG9wID4geTEgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldC5ib3R0b20gPCB5MiApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggaGl0ICkgew0KDQogICAgICAgICAgICAgICAgICAgIC8vIFNFTEVDVA0KICAgICAgICAgICAgICAgICAgICBpZiAoIHNlbGVjdGVlLnNlbGVjdGVkICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5fcmVtb3ZlQ2xhc3MoIHNlbGVjdGVlLiRlbGVtZW50LCAidWktc2VsZWN0ZWQiICk7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZS5zZWxlY3RlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICggc2VsZWN0ZWUudW5zZWxlY3RpbmcgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9yZW1vdmVDbGFzcyggc2VsZWN0ZWUuJGVsZW1lbnQsICJ1aS11bnNlbGVjdGluZyIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVlLnVuc2VsZWN0aW5nID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCAhc2VsZWN0ZWUuc2VsZWN0aW5nICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5fYWRkQ2xhc3MoIHNlbGVjdGVlLiRlbGVtZW50LCAidWktc2VsZWN0aW5nIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWUuc2VsZWN0aW5nID0gdHJ1ZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZWN0YWJsZSBTRUxFQ1RJTkcgY2FsbGJhY2sNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3RyaWdnZXIoICJzZWxlY3RpbmciLCBldmVudCwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGluZzogc2VsZWN0ZWUuZWxlbWVudA0KICAgICAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBVTlNFTEVDVA0KICAgICAgICAgICAgICAgICAgICBpZiAoIHNlbGVjdGVlLnNlbGVjdGluZyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggKCBldmVudC5tZXRhS2V5IHx8IGV2ZW50LmN0cmxLZXkgKSAmJiBzZWxlY3RlZS5zdGFydHNlbGVjdGVkICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3JlbW92ZUNsYXNzKCBzZWxlY3RlZS4kZWxlbWVudCwgInVpLXNlbGVjdGluZyIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZS5zZWxlY3RpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9hZGRDbGFzcyggc2VsZWN0ZWUuJGVsZW1lbnQsICJ1aS1zZWxlY3RlZCIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZS5zZWxlY3RlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3JlbW92ZUNsYXNzKCBzZWxlY3RlZS4kZWxlbWVudCwgInVpLXNlbGVjdGluZyIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZS5zZWxlY3RpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHNlbGVjdGVlLnN0YXJ0c2VsZWN0ZWQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX2FkZENsYXNzKCBzZWxlY3RlZS4kZWxlbWVudCwgInVpLXVuc2VsZWN0aW5nIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZS51bnNlbGVjdGluZyA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZWN0YWJsZSBVTlNFTEVDVElORyBjYWxsYmFjaw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3RyaWdnZXIoICJ1bnNlbGVjdGluZyIsIGV2ZW50LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2VsZWN0aW5nOiBzZWxlY3RlZS5lbGVtZW50DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICggc2VsZWN0ZWUuc2VsZWN0ZWQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoICFldmVudC5tZXRhS2V5ICYmICFldmVudC5jdHJsS2V5ICYmICFzZWxlY3RlZS5zdGFydHNlbGVjdGVkICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3JlbW92ZUNsYXNzKCBzZWxlY3RlZS4kZWxlbWVudCwgInVpLXNlbGVjdGVkIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVlLnNlbGVjdGVkID0gZmFsc2U7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9hZGRDbGFzcyggc2VsZWN0ZWUuJGVsZW1lbnQsICJ1aS11bnNlbGVjdGluZyIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZS51bnNlbGVjdGluZyA9IHRydWU7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxlY3RhYmxlIFVOU0VMRUNUSU5HIGNhbGxiYWNrDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5fdHJpZ2dlciggInVuc2VsZWN0aW5nIiwgZXZlbnQsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zZWxlY3Rpbmc6IHNlbGVjdGVlLmVsZW1lbnQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfbW91c2VTdG9wOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7DQoNCiAgICAgICAgICAgIHRoaXMuZHJhZ2dlZCA9IGZhbHNlOw0KDQogICAgICAgICAgICAkKCAiLnVpLXVuc2VsZWN0aW5nIiwgdGhpcy5lbGVtZW50WyAwIF0gKS5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWUgPSAkLmRhdGEoIHRoaXMsICJzZWxlY3RhYmxlLWl0ZW0iICk7DQogICAgICAgICAgICAgICAgdGhhdC5fcmVtb3ZlQ2xhc3MoIHNlbGVjdGVlLiRlbGVtZW50LCAidWktdW5zZWxlY3RpbmciICk7DQogICAgICAgICAgICAgICAgc2VsZWN0ZWUudW5zZWxlY3RpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICBzZWxlY3RlZS5zdGFydHNlbGVjdGVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgdGhhdC5fdHJpZ2dlciggInVuc2VsZWN0ZWQiLCBldmVudCwgew0KICAgICAgICAgICAgICAgICAgICB1bnNlbGVjdGVkOiBzZWxlY3RlZS5lbGVtZW50DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgJCggIi51aS1zZWxlY3RpbmciLCB0aGlzLmVsZW1lbnRbIDAgXSApLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZSA9ICQuZGF0YSggdGhpcywgInNlbGVjdGFibGUtaXRlbSIgKTsNCiAgICAgICAgICAgICAgICB0aGF0Ll9yZW1vdmVDbGFzcyggc2VsZWN0ZWUuJGVsZW1lbnQsICJ1aS1zZWxlY3RpbmciICkNCiAgICAgICAgICAgICAgICAgICAgLl9hZGRDbGFzcyggc2VsZWN0ZWUuJGVsZW1lbnQsICJ1aS1zZWxlY3RlZCIgKTsNCiAgICAgICAgICAgICAgICBzZWxlY3RlZS5zZWxlY3RpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICBzZWxlY3RlZS5zZWxlY3RlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgc2VsZWN0ZWUuc3RhcnRzZWxlY3RlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgdGhhdC5fdHJpZ2dlciggInNlbGVjdGVkIiwgZXZlbnQsIHsNCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHNlbGVjdGVlLmVsZW1lbnQNCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAic3RvcCIsIGV2ZW50ICk7DQoNCiAgICAgICAgICAgIHRoaXMuaGVscGVyLnJlbW92ZSgpOw0KDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgIH0gKTsNCg0KDQogICAgLyohDQogKiBqUXVlcnkgVUkgU2VsZWN0bWVudSAxLjEyLjENCiAqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiAqDQogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycw0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICovDQoNCi8vPj5sYWJlbDogU2VsZWN0bWVudQ0KLy8+Pmdyb3VwOiBXaWRnZXRzDQovLyBqc2NzOmRpc2FibGUgbWF4aW11bUxpbmVMZW5ndGgNCi8vPj5kZXNjcmlwdGlvbjogRHVwbGljYXRlcyBhbmQgZXh0ZW5kcyB0aGUgZnVuY3Rpb25hbGl0eSBvZiBhIG5hdGl2ZSBIVE1MIHNlbGVjdCBlbGVtZW50LCBhbGxvd2luZyBpdCB0byBiZSBjdXN0b21pemFibGUgaW4gYmVoYXZpb3IgYW5kIGFwcGVhcmFuY2UgZmFyIGJleW9uZCB0aGUgbGltaXRhdGlvbnMgb2YgYSBuYXRpdmUgc2VsZWN0Lg0KLy8ganNjczplbmFibGUgbWF4aW11bUxpbmVMZW5ndGgNCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9zZWxlY3RtZW51Lw0KLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL3NlbGVjdG1lbnUvDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29yZS5jc3MNCi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9zZWxlY3RtZW51LmNzcywgLi4vLi4vdGhlbWVzL2Jhc2UvYnV0dG9uLmNzcw0KLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzDQoNCg0KDQogICAgdmFyIHdpZGdldHNTZWxlY3RtZW51ID0gJC53aWRnZXQoICJ1aS5zZWxlY3RtZW51IiwgWyAkLnVpLmZvcm1SZXNldE1peGluLCB7DQogICAgICAgIHZlcnNpb246ICIxLjEyLjEiLA0KICAgICAgICBkZWZhdWx0RWxlbWVudDogIjxzZWxlY3Q+IiwNCiAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgYXBwZW5kVG86IG51bGwsDQogICAgICAgICAgICBjbGFzc2VzOiB7DQogICAgICAgICAgICAgICAgInVpLXNlbGVjdG1lbnUtYnV0dG9uLW9wZW4iOiAidWktY29ybmVyLXRvcCIsDQogICAgICAgICAgICAgICAgInVpLXNlbGVjdG1lbnUtYnV0dG9uLWNsb3NlZCI6ICJ1aS1jb3JuZXItYWxsIg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGRpc2FibGVkOiBudWxsLA0KICAgICAgICAgICAgaWNvbnM6IHsNCiAgICAgICAgICAgICAgICBidXR0b246ICJ1aS1pY29uLXRyaWFuZ2xlLTEtcyINCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBwb3NpdGlvbjogew0KICAgICAgICAgICAgICAgIG15OiAibGVmdCB0b3AiLA0KICAgICAgICAgICAgICAgIGF0OiAibGVmdCBib3R0b20iLA0KICAgICAgICAgICAgICAgIGNvbGxpc2lvbjogIm5vbmUiDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgd2lkdGg6IGZhbHNlLA0KDQogICAgICAgICAgICAvLyBDYWxsYmFja3MNCiAgICAgICAgICAgIGNoYW5nZTogbnVsbCwNCiAgICAgICAgICAgIGNsb3NlOiBudWxsLA0KICAgICAgICAgICAgZm9jdXM6IG51bGwsDQogICAgICAgICAgICBvcGVuOiBudWxsLA0KICAgICAgICAgICAgc2VsZWN0OiBudWxsDQogICAgICAgIH0sDQoNCiAgICAgICAgX2NyZWF0ZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgc2VsZWN0bWVudUlkID0gdGhpcy5lbGVtZW50LnVuaXF1ZUlkKCkuYXR0ciggImlkIiApOw0KICAgICAgICAgICAgdGhpcy5pZHMgPSB7DQogICAgICAgICAgICAgICAgZWxlbWVudDogc2VsZWN0bWVudUlkLA0KICAgICAgICAgICAgICAgIGJ1dHRvbjogc2VsZWN0bWVudUlkICsgIi1idXR0b24iLA0KICAgICAgICAgICAgICAgIG1lbnU6IHNlbGVjdG1lbnVJZCArICItbWVudSINCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIHRoaXMuX2RyYXdCdXR0b24oKTsNCiAgICAgICAgICAgIHRoaXMuX2RyYXdNZW51KCk7DQogICAgICAgICAgICB0aGlzLl9iaW5kRm9ybVJlc2V0SGFuZGxlcigpOw0KDQogICAgICAgICAgICB0aGlzLl9yZW5kZXJlZCA9IGZhbHNlOw0KICAgICAgICAgICAgdGhpcy5tZW51SXRlbXMgPSAkKCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2RyYXdCdXR0b246IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGljb24sDQogICAgICAgICAgICAgICAgdGhhdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgaXRlbSA9IHRoaXMuX3BhcnNlT3B0aW9uKA0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZmluZCggIm9wdGlvbjpzZWxlY3RlZCIgKSwNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50WyAwIF0uc2VsZWN0ZWRJbmRleA0KICAgICAgICAgICAgICAgICk7DQoNCiAgICAgICAgICAgIC8vIEFzc29jaWF0ZSBleGlzdGluZyBsYWJlbCB3aXRoIHRoZSBuZXcgYnV0dG9uDQogICAgICAgICAgICB0aGlzLmxhYmVscyA9IHRoaXMuZWxlbWVudC5sYWJlbHMoKS5hdHRyKCAiZm9yIiwgdGhpcy5pZHMuYnV0dG9uICk7DQogICAgICAgICAgICB0aGlzLl9vbiggdGhpcy5sYWJlbHMsIHsNCiAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1dHRvbi5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgLy8gSGlkZSBvcmlnaW5hbCBzZWxlY3QgZWxlbWVudA0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LmhpZGUoKTsNCg0KICAgICAgICAgICAgLy8gQ3JlYXRlIGJ1dHRvbg0KICAgICAgICAgICAgdGhpcy5idXR0b24gPSAkKCAiPHNwYW4+Iiwgew0KICAgICAgICAgICAgICAgIHRhYmluZGV4OiB0aGlzLm9wdGlvbnMuZGlzYWJsZWQgPyAtMSA6IDAsDQogICAgICAgICAgICAgICAgaWQ6IHRoaXMuaWRzLmJ1dHRvbiwNCiAgICAgICAgICAgICAgICByb2xlOiAiY29tYm9ib3giLA0KICAgICAgICAgICAgICAgICJhcmlhLWV4cGFuZGVkIjogImZhbHNlIiwNCiAgICAgICAgICAgICAgICAiYXJpYS1hdXRvY29tcGxldGUiOiAibGlzdCIsDQogICAgICAgICAgICAgICAgImFyaWEtb3ducyI6IHRoaXMuaWRzLm1lbnUsDQogICAgICAgICAgICAgICAgImFyaWEtaGFzcG9wdXAiOiAidHJ1ZSIsDQogICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMuZWxlbWVudC5hdHRyKCAidGl0bGUiICkNCiAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgIC5pbnNlcnRBZnRlciggdGhpcy5lbGVtZW50ICk7DQoNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLmJ1dHRvbiwgInVpLXNlbGVjdG1lbnUtYnV0dG9uIHVpLXNlbGVjdG1lbnUtYnV0dG9uLWNsb3NlZCIsDQogICAgICAgICAgICAgICAgInVpLWJ1dHRvbiB1aS13aWRnZXQiICk7DQoNCiAgICAgICAgICAgIGljb24gPSAkKCAiPHNwYW4+IiApLmFwcGVuZFRvKCB0aGlzLmJ1dHRvbiApOw0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIGljb24sICJ1aS1zZWxlY3RtZW51LWljb24iLCAidWktaWNvbiAiICsgdGhpcy5vcHRpb25zLmljb25zLmJ1dHRvbiApOw0KICAgICAgICAgICAgdGhpcy5idXR0b25JdGVtID0gdGhpcy5fcmVuZGVyQnV0dG9uSXRlbSggaXRlbSApDQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKCB0aGlzLmJ1dHRvbiApOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy53aWR0aCAhPT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fcmVzaXplQnV0dG9uKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX29uKCB0aGlzLmJ1dHRvbiwgdGhpcy5fYnV0dG9uRXZlbnRzICk7DQogICAgICAgICAgICB0aGlzLmJ1dHRvbi5vbmUoICJmb2N1c2luIiwgZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBEZWxheSByZW5kZXJpbmcgdGhlIG1lbnUgaXRlbXMgdW50aWwgdGhlIGJ1dHRvbiByZWNlaXZlcyBmb2N1cy4NCiAgICAgICAgICAgICAgICAvLyBUaGUgbWVudSBtYXkgaGF2ZSBhbHJlYWR5IGJlZW4gcmVuZGVyZWQgdmlhIGEgcHJvZ3JhbW1hdGljIG9wZW4uDQogICAgICAgICAgICAgICAgaWYgKCAhdGhhdC5fcmVuZGVyZWQgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX3JlZnJlc2hNZW51KCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9kcmF3TWVudTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7DQoNCiAgICAgICAgICAgIC8vIENyZWF0ZSBtZW51DQogICAgICAgICAgICB0aGlzLm1lbnUgPSAkKCAiPHVsPiIsIHsNCiAgICAgICAgICAgICAgICAiYXJpYS1oaWRkZW4iOiAidHJ1ZSIsDQogICAgICAgICAgICAgICAgImFyaWEtbGFiZWxsZWRieSI6IHRoaXMuaWRzLmJ1dHRvbiwNCiAgICAgICAgICAgICAgICBpZDogdGhpcy5pZHMubWVudQ0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAvLyBXcmFwIG1lbnUNCiAgICAgICAgICAgIHRoaXMubWVudVdyYXAgPSAkKCAiPGRpdj4iICkuYXBwZW5kKCB0aGlzLm1lbnUgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLm1lbnVXcmFwLCAidWktc2VsZWN0bWVudS1tZW51IiwgInVpLWZyb250IiApOw0KICAgICAgICAgICAgdGhpcy5tZW51V3JhcC5hcHBlbmRUbyggdGhpcy5fYXBwZW5kVG8oKSApOw0KDQogICAgICAgICAgICAvLyBJbml0aWFsaXplIG1lbnUgd2lkZ2V0DQogICAgICAgICAgICB0aGlzLm1lbnVJbnN0YW5jZSA9IHRoaXMubWVudQ0KICAgICAgICAgICAgICAgIC5tZW51KCB7DQogICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJ1aS1tZW51IjogInVpLWNvcm5lci1ib3R0b20iDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIHJvbGU6ICJsaXN0Ym94IiwNCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiBmdW5jdGlvbiggZXZlbnQsIHVpICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3VwcG9ydDogSUU4DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgaXRlbSB3YXMgc2VsZWN0ZWQgdmlhIGEgY2xpY2ssIHRoZSB0ZXh0IHNlbGVjdGlvbg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2lsbCBiZSBkZXN0cm95ZWQgaW4gSUUNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3NldFNlbGVjdGlvbigpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9zZWxlY3QoIHVpLml0ZW0uZGF0YSggInVpLXNlbGVjdG1lbnUtaXRlbSIgKSwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgZm9jdXM6IGZ1bmN0aW9uKCBldmVudCwgdWkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IHVpLml0ZW0uZGF0YSggInVpLXNlbGVjdG1lbnUtaXRlbSIgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHJldmVudCBpbml0YWwgZm9jdXMgZnJvbSBmaXJpbmcgYW5kIGNoZWNrIGlmIGl0cyBhIG5ld2x5IGZvY3VzZWQgaXRlbQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGF0LmZvY3VzSW5kZXggIT0gbnVsbCAmJiBpdGVtLmluZGV4ICE9PSB0aGF0LmZvY3VzSW5kZXggKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5fdHJpZ2dlciggImZvY3VzIiwgZXZlbnQsIHsgaXRlbTogaXRlbSB9ICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhdGhhdC5pc09wZW4gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3NlbGVjdCggaXRlbSwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmZvY3VzSW5kZXggPSBpdGVtLmluZGV4Ow0KDQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmJ1dHRvbi5hdHRyKCAiYXJpYS1hY3RpdmVkZXNjZW5kYW50IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0Lm1lbnVJdGVtcy5lcSggaXRlbS5pbmRleCApLmF0dHIoICJpZCIgKSApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLm1lbnUoICJpbnN0YW5jZSIgKTsNCg0KICAgICAgICAgICAgLy8gRG9uJ3QgY2xvc2UgdGhlIG1lbnUgb24gbW91c2VsZWF2ZQ0KICAgICAgICAgICAgdGhpcy5tZW51SW5zdGFuY2UuX29mZiggdGhpcy5tZW51LCAibW91c2VsZWF2ZSIgKTsNCg0KICAgICAgICAgICAgLy8gQ2FuY2VsIHRoZSBtZW51J3MgY29sbGFwc2VBbGwgb24gZG9jdW1lbnQgY2xpY2sNCiAgICAgICAgICAgIHRoaXMubWVudUluc3RhbmNlLl9jbG9zZU9uRG9jdW1lbnRDbGljayA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIC8vIFNlbGVjdHMgb2Z0ZW4gY29udGFpbiBlbXB0eSBpdGVtcywgYnV0IG5ldmVyIGNvbnRhaW4gZGl2aWRlcnMNCiAgICAgICAgICAgIHRoaXMubWVudUluc3RhbmNlLl9pc0RpdmlkZXIgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9LA0KDQogICAgICAgIHJlZnJlc2g6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5fcmVmcmVzaE1lbnUoKTsNCiAgICAgICAgICAgIHRoaXMuYnV0dG9uSXRlbS5yZXBsYWNlV2l0aCgNCiAgICAgICAgICAgICAgICB0aGlzLmJ1dHRvbkl0ZW0gPSB0aGlzLl9yZW5kZXJCdXR0b25JdGVtKA0KDQogICAgICAgICAgICAgICAgICAgIC8vIEZhbGwgYmFjayB0byBhbiBlbXB0eSBvYmplY3QgaW4gY2FzZSB0aGVyZSBhcmUgbm8gb3B0aW9ucw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9nZXRTZWxlY3RlZEl0ZW0oKS5kYXRhKCAidWktc2VsZWN0bWVudS1pdGVtIiApIHx8IHt9DQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLndpZHRoID09PSBudWxsICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZUJ1dHRvbigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9yZWZyZXNoTWVudTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgaXRlbSwNCiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5lbGVtZW50LmZpbmQoICJvcHRpb24iICk7DQoNCiAgICAgICAgICAgIHRoaXMubWVudS5lbXB0eSgpOw0KDQogICAgICAgICAgICB0aGlzLl9wYXJzZU9wdGlvbnMoIG9wdGlvbnMgKTsNCiAgICAgICAgICAgIHRoaXMuX3JlbmRlck1lbnUoIHRoaXMubWVudSwgdGhpcy5pdGVtcyApOw0KDQogICAgICAgICAgICB0aGlzLm1lbnVJbnN0YW5jZS5yZWZyZXNoKCk7DQogICAgICAgICAgICB0aGlzLm1lbnVJdGVtcyA9IHRoaXMubWVudS5maW5kKCAibGkiICkNCiAgICAgICAgICAgICAgICAubm90KCAiLnVpLXNlbGVjdG1lbnUtb3B0Z3JvdXAiICkNCiAgICAgICAgICAgICAgICAuZmluZCggIi51aS1tZW51LWl0ZW0td3JhcHBlciIgKTsNCg0KICAgICAgICAgICAgdGhpcy5fcmVuZGVyZWQgPSB0cnVlOw0KDQogICAgICAgICAgICBpZiAoICFvcHRpb25zLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGl0ZW0gPSB0aGlzLl9nZXRTZWxlY3RlZEl0ZW0oKTsNCg0KICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBtZW51IHRvIGhhdmUgdGhlIGNvcnJlY3QgaXRlbSBmb2N1c2VkDQogICAgICAgICAgICB0aGlzLm1lbnVJbnN0YW5jZS5mb2N1cyggbnVsbCwgaXRlbSApOw0KICAgICAgICAgICAgdGhpcy5fc2V0QXJpYSggaXRlbS5kYXRhKCAidWktc2VsZWN0bWVudS1pdGVtIiApICk7DQoNCiAgICAgICAgICAgIC8vIFNldCBkaXNhYmxlZCBzdGF0ZQ0KICAgICAgICAgICAgdGhpcy5fc2V0T3B0aW9uKCAiZGlzYWJsZWQiLCB0aGlzLmVsZW1lbnQucHJvcCggImRpc2FibGVkIiApICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgb3BlbjogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuZGlzYWJsZWQgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBJZiB0aGlzIGlzIHRoZSBmaXJzdCB0aW1lIHRoZSBtZW51IGlzIGJlaW5nIG9wZW5lZCwgcmVuZGVyIHRoZSBpdGVtcw0KICAgICAgICAgICAgaWYgKCAhdGhpcy5fcmVuZGVyZWQgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fcmVmcmVzaE1lbnUoKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICAvLyBNZW51IGNsZWFycyBmb2N1cyBvbiBjbG9zZSwgcmVzZXQgZm9jdXMgdG8gc2VsZWN0ZWQgaXRlbQ0KICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLm1lbnUuZmluZCggIi51aS1zdGF0ZS1hY3RpdmUiICksIG51bGwsICJ1aS1zdGF0ZS1hY3RpdmUiICk7DQogICAgICAgICAgICAgICAgdGhpcy5tZW51SW5zdGFuY2UuZm9jdXMoIG51bGwsIHRoaXMuX2dldFNlbGVjdGVkSXRlbSgpICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIElmIHRoZXJlIGFyZSBubyBvcHRpb25zLCBkb24ndCBvcGVuIHRoZSBtZW51DQogICAgICAgICAgICBpZiAoICF0aGlzLm1lbnVJdGVtcy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLmlzT3BlbiA9IHRydWU7DQogICAgICAgICAgICB0aGlzLl90b2dnbGVBdHRyKCk7DQogICAgICAgICAgICB0aGlzLl9yZXNpemVNZW51KCk7DQogICAgICAgICAgICB0aGlzLl9wb3NpdGlvbigpOw0KDQogICAgICAgICAgICB0aGlzLl9vbiggdGhpcy5kb2N1bWVudCwgdGhpcy5fZG9jdW1lbnRDbGljayApOw0KDQogICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAib3BlbiIsIGV2ZW50ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3Bvc2l0aW9uOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMubWVudVdyYXAucG9zaXRpb24oICQuZXh0ZW5kKCB7IG9mOiB0aGlzLmJ1dHRvbiB9LCB0aGlzLm9wdGlvbnMucG9zaXRpb24gKSApOw0KICAgICAgICB9LA0KDQogICAgICAgIGNsb3NlOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICBpZiAoICF0aGlzLmlzT3BlbiApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuaXNPcGVuID0gZmFsc2U7DQogICAgICAgICAgICB0aGlzLl90b2dnbGVBdHRyKCk7DQoNCiAgICAgICAgICAgIHRoaXMucmFuZ2UgPSBudWxsOw0KICAgICAgICAgICAgdGhpcy5fb2ZmKCB0aGlzLmRvY3VtZW50ICk7DQoNCiAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJjbG9zZSIsIGV2ZW50ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgd2lkZ2V0OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1dHRvbjsNCiAgICAgICAgfSwNCg0KICAgICAgICBtZW51V2lkZ2V0OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLm1lbnU7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3JlbmRlckJ1dHRvbkl0ZW06IGZ1bmN0aW9uKCBpdGVtICkgew0KICAgICAgICAgICAgdmFyIGJ1dHRvbkl0ZW0gPSAkKCAiPHNwYW4+IiApOw0KDQogICAgICAgICAgICB0aGlzLl9zZXRUZXh0KCBidXR0b25JdGVtLCBpdGVtLmxhYmVsICk7DQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggYnV0dG9uSXRlbSwgInVpLXNlbGVjdG1lbnUtdGV4dCIgKTsNCg0KICAgICAgICAgICAgcmV0dXJuIGJ1dHRvbkl0ZW07DQogICAgICAgIH0sDQoNCiAgICAgICAgX3JlbmRlck1lbnU6IGZ1bmN0aW9uKCB1bCwgaXRlbXMgKSB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgY3VycmVudE9wdGdyb3VwID0gIiI7DQoNCiAgICAgICAgICAgICQuZWFjaCggaXRlbXMsIGZ1bmN0aW9uKCBpbmRleCwgaXRlbSApIHsNCiAgICAgICAgICAgICAgICB2YXIgbGk7DQoNCiAgICAgICAgICAgICAgICBpZiAoIGl0ZW0ub3B0Z3JvdXAgIT09IGN1cnJlbnRPcHRncm91cCApIHsNCiAgICAgICAgICAgICAgICAgICAgbGkgPSAkKCAiPGxpPiIsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGl0ZW0ub3B0Z3JvdXANCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll9hZGRDbGFzcyggbGksICJ1aS1zZWxlY3RtZW51LW9wdGdyb3VwIiwgInVpLW1lbnUtZGl2aWRlciIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgKCBpdGVtLmVsZW1lbnQucGFyZW50KCAib3B0Z3JvdXAiICkucHJvcCggImRpc2FibGVkIiApID8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIHVpLXN0YXRlLWRpc2FibGVkIiA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiIgKSApOw0KDQogICAgICAgICAgICAgICAgICAgIGxpLmFwcGVuZFRvKCB1bCApOw0KDQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRPcHRncm91cCA9IGl0ZW0ub3B0Z3JvdXA7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdGhhdC5fcmVuZGVySXRlbURhdGEoIHVsLCBpdGVtICk7DQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3JlbmRlckl0ZW1EYXRhOiBmdW5jdGlvbiggdWwsIGl0ZW0gKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVuZGVySXRlbSggdWwsIGl0ZW0gKS5kYXRhKCAidWktc2VsZWN0bWVudS1pdGVtIiwgaXRlbSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9yZW5kZXJJdGVtOiBmdW5jdGlvbiggdWwsIGl0ZW0gKSB7DQogICAgICAgICAgICB2YXIgbGkgPSAkKCAiPGxpPiIgKSwNCiAgICAgICAgICAgICAgICB3cmFwcGVyID0gJCggIjxkaXY+Iiwgew0KICAgICAgICAgICAgICAgICAgICB0aXRsZTogaXRlbS5lbGVtZW50LmF0dHIoICJ0aXRsZSIgKQ0KICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgaWYgKCBpdGVtLmRpc2FibGVkICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCBsaSwgbnVsbCwgInVpLXN0YXRlLWRpc2FibGVkIiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5fc2V0VGV4dCggd3JhcHBlciwgaXRlbS5sYWJlbCApOw0KDQogICAgICAgICAgICByZXR1cm4gbGkuYXBwZW5kKCB3cmFwcGVyICkuYXBwZW5kVG8oIHVsICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldFRleHQ6IGZ1bmN0aW9uKCBlbGVtZW50LCB2YWx1ZSApIHsNCiAgICAgICAgICAgIGlmICggdmFsdWUgKSB7DQogICAgICAgICAgICAgICAgZWxlbWVudC50ZXh0KCB2YWx1ZSApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50Lmh0bWwoICImIzE2MDsiICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX21vdmU6IGZ1bmN0aW9uKCBkaXJlY3Rpb24sIGV2ZW50ICkgew0KICAgICAgICAgICAgdmFyIGl0ZW0sIG5leHQsDQogICAgICAgICAgICAgICAgZmlsdGVyID0gIi51aS1tZW51LWl0ZW0iOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMuaXNPcGVuICkgew0KICAgICAgICAgICAgICAgIGl0ZW0gPSB0aGlzLm1lbnVJdGVtcy5lcSggdGhpcy5mb2N1c0luZGV4ICkucGFyZW50KCAibGkiICk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGl0ZW0gPSB0aGlzLm1lbnVJdGVtcy5lcSggdGhpcy5lbGVtZW50WyAwIF0uc2VsZWN0ZWRJbmRleCApLnBhcmVudCggImxpIiApOw0KICAgICAgICAgICAgICAgIGZpbHRlciArPSAiOm5vdCgudWktc3RhdGUtZGlzYWJsZWQpIjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCBkaXJlY3Rpb24gPT09ICJmaXJzdCIgfHwgZGlyZWN0aW9uID09PSAibGFzdCIgKSB7DQogICAgICAgICAgICAgICAgbmV4dCA9IGl0ZW1bIGRpcmVjdGlvbiA9PT0gImZpcnN0IiA/ICJwcmV2QWxsIiA6ICJuZXh0QWxsIiBdKCBmaWx0ZXIgKS5lcSggLTEgKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgbmV4dCA9IGl0ZW1bIGRpcmVjdGlvbiArICJBbGwiIF0oIGZpbHRlciApLmVxKCAwICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggbmV4dC5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgdGhpcy5tZW51SW5zdGFuY2UuZm9jdXMoIGV2ZW50LCBuZXh0ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2dldFNlbGVjdGVkSXRlbTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5tZW51SXRlbXMuZXEoIHRoaXMuZWxlbWVudFsgMCBdLnNlbGVjdGVkSW5kZXggKS5wYXJlbnQoICJsaSIgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfdG9nZ2xlOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB0aGlzWyB0aGlzLmlzT3BlbiA/ICJjbG9zZSIgOiAib3BlbiIgXSggZXZlbnQgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0U2VsZWN0aW9uOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBzZWxlY3Rpb247DQoNCiAgICAgICAgICAgIGlmICggIXRoaXMucmFuZ2UgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHdpbmRvdy5nZXRTZWxlY3Rpb24gKSB7DQogICAgICAgICAgICAgICAgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpOw0KICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5yZW1vdmVBbGxSYW5nZXMoKTsNCiAgICAgICAgICAgICAgICBzZWxlY3Rpb24uYWRkUmFuZ2UoIHRoaXMucmFuZ2UgKTsNCg0KICAgICAgICAgICAgICAgIC8vIFN1cHBvcnQ6IElFOA0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLnJhbmdlLnNlbGVjdCgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBTdXBwb3J0OiBJRQ0KICAgICAgICAgICAgLy8gU2V0dGluZyB0aGUgdGV4dCBzZWxlY3Rpb24ga2lsbHMgdGhlIGJ1dHRvbiBmb2N1cyBpbiBJRSwgYnV0DQogICAgICAgICAgICAvLyByZXN0b3JpbmcgdGhlIGZvY3VzIGRvZXNuJ3Qga2lsbCB0aGUgc2VsZWN0aW9uLg0KICAgICAgICAgICAgdGhpcy5idXR0b24uZm9jdXMoKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZG9jdW1lbnRDbGljazogew0KICAgICAgICAgICAgbW91c2Vkb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5pc09wZW4gKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoICEkKCBldmVudC50YXJnZXQgKS5jbG9zZXN0KCAiLnVpLXNlbGVjdG1lbnUtbWVudSwgIyIgKw0KICAgICAgICAgICAgICAgICAgICAkLnVpLmVzY2FwZVNlbGVjdG9yKCB0aGlzLmlkcy5idXR0b24gKSApLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSggZXZlbnQgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2J1dHRvbkV2ZW50czogew0KDQogICAgICAgICAgICAvLyBQcmV2ZW50IHRleHQgc2VsZWN0aW9uIGZyb20gYmVpbmcgcmVzZXQgd2hlbiBpbnRlcmFjdGluZyB3aXRoIHRoZSBzZWxlY3RtZW51ICgjMTAxNDQpDQogICAgICAgICAgICBtb3VzZWRvd246IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciBzZWxlY3Rpb247DQoNCiAgICAgICAgICAgICAgICBpZiAoIHdpbmRvdy5nZXRTZWxlY3Rpb24gKSB7DQogICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBzZWxlY3Rpb24ucmFuZ2VDb3VudCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmFuZ2UgPSBzZWxlY3Rpb24uZ2V0UmFuZ2VBdCggMCApOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gU3VwcG9ydDogSUU4DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5nZSA9IGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fc2V0U2VsZWN0aW9uKCk7DQogICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlKCBldmVudCApOw0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAga2V5ZG93bjogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgIHZhciBwcmV2ZW50RGVmYXVsdCA9IHRydWU7DQogICAgICAgICAgICAgICAgc3dpdGNoICggZXZlbnQua2V5Q29kZSApIHsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuVEFCOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5FU0NBUEU6DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcHJldmVudERlZmF1bHQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5FTlRFUjoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5pc09wZW4gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0Rm9jdXNlZEl0ZW0oIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuVVA6DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGV2ZW50LmFsdEtleSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGUoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21vdmUoICJwcmV2IiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5ET1dOOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBldmVudC5hbHRLZXkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlKCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb3ZlKCAibmV4dCIsIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuU1BBQ0U6DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMuaXNPcGVuICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdEZvY3VzZWRJdGVtKCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGUoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuTEVGVDoNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21vdmUoICJwcmV2IiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5SSUdIVDoNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21vdmUoICJuZXh0IiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5IT01FOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5QQUdFX1VQOg0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbW92ZSggImZpcnN0IiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5FTkQ6DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLlBBR0VfRE9XTjoNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21vdmUoICJsYXN0IiwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51LnRyaWdnZXIoIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgICAgICBwcmV2ZW50RGVmYXVsdCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggcHJldmVudERlZmF1bHQgKSB7DQogICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9zZWxlY3RGb2N1c2VkSXRlbTogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLm1lbnVJdGVtcy5lcSggdGhpcy5mb2N1c0luZGV4ICkucGFyZW50KCAibGkiICk7DQogICAgICAgICAgICBpZiAoICFpdGVtLmhhc0NsYXNzKCAidWktc3RhdGUtZGlzYWJsZWQiICkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0KCBpdGVtLmRhdGEoICJ1aS1zZWxlY3RtZW51LWl0ZW0iICksIGV2ZW50ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NlbGVjdDogZnVuY3Rpb24oIGl0ZW0sIGV2ZW50ICkgew0KICAgICAgICAgICAgdmFyIG9sZEluZGV4ID0gdGhpcy5lbGVtZW50WyAwIF0uc2VsZWN0ZWRJbmRleDsNCg0KICAgICAgICAgICAgLy8gQ2hhbmdlIG5hdGl2ZSBzZWxlY3QgZWxlbWVudA0KICAgICAgICAgICAgdGhpcy5lbGVtZW50WyAwIF0uc2VsZWN0ZWRJbmRleCA9IGl0ZW0uaW5kZXg7DQogICAgICAgICAgICB0aGlzLmJ1dHRvbkl0ZW0ucmVwbGFjZVdpdGgoIHRoaXMuYnV0dG9uSXRlbSA9IHRoaXMuX3JlbmRlckJ1dHRvbkl0ZW0oIGl0ZW0gKSApOw0KICAgICAgICAgICAgdGhpcy5fc2V0QXJpYSggaXRlbSApOw0KICAgICAgICAgICAgdGhpcy5fdHJpZ2dlciggInNlbGVjdCIsIGV2ZW50LCB7IGl0ZW06IGl0ZW0gfSApOw0KDQogICAgICAgICAgICBpZiAoIGl0ZW0uaW5kZXggIT09IG9sZEluZGV4ICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJjaGFuZ2UiLCBldmVudCwgeyBpdGVtOiBpdGVtIH0gKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5jbG9zZSggZXZlbnQgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0QXJpYTogZnVuY3Rpb24oIGl0ZW0gKSB7DQogICAgICAgICAgICB2YXIgaWQgPSB0aGlzLm1lbnVJdGVtcy5lcSggaXRlbS5pbmRleCApLmF0dHIoICJpZCIgKTsNCg0KICAgICAgICAgICAgdGhpcy5idXR0b24uYXR0ciggew0KICAgICAgICAgICAgICAgICJhcmlhLWxhYmVsbGVkYnkiOiBpZCwNCiAgICAgICAgICAgICAgICAiYXJpYS1hY3RpdmVkZXNjZW5kYW50IjogaWQNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIHRoaXMubWVudS5hdHRyKCAiYXJpYS1hY3RpdmVkZXNjZW5kYW50IiwgaWQgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHsNCiAgICAgICAgICAgIGlmICgga2V5ID09PSAiaWNvbnMiICkgew0KICAgICAgICAgICAgICAgIHZhciBpY29uID0gdGhpcy5idXR0b24uZmluZCggInNwYW4udWktaWNvbiIgKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggaWNvbiwgbnVsbCwgdGhpcy5vcHRpb25zLmljb25zLmJ1dHRvbiApDQogICAgICAgICAgICAgICAgICAgIC5fYWRkQ2xhc3MoIGljb24sIG51bGwsIHZhbHVlLmJ1dHRvbiApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApOw0KDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImFwcGVuZFRvIiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLm1lbnVXcmFwLmFwcGVuZFRvKCB0aGlzLl9hcHBlbmRUbygpICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICgga2V5ID09PSAid2lkdGgiICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZUJ1dHRvbigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb25EaXNhYmxlZDogZnVuY3Rpb24oIHZhbHVlICkgew0KICAgICAgICAgICAgdGhpcy5fc3VwZXIoIHZhbHVlICk7DQoNCiAgICAgICAgICAgIHRoaXMubWVudUluc3RhbmNlLm9wdGlvbiggImRpc2FibGVkIiwgdmFsdWUgKTsNCiAgICAgICAgICAgIHRoaXMuYnV0dG9uLmF0dHIoICJhcmlhLWRpc2FibGVkIiwgdmFsdWUgKTsNCiAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUNsYXNzKCB0aGlzLmJ1dHRvbiwgbnVsbCwgInVpLXN0YXRlLWRpc2FibGVkIiwgdmFsdWUgKTsNCg0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LnByb3AoICJkaXNhYmxlZCIsIHZhbHVlICk7DQogICAgICAgICAgICBpZiAoIHZhbHVlICkgew0KICAgICAgICAgICAgICAgIHRoaXMuYnV0dG9uLmF0dHIoICJ0YWJpbmRleCIsIC0xICk7DQogICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLmJ1dHRvbi5hdHRyKCAidGFiaW5kZXgiLCAwICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2FwcGVuZFRvOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5vcHRpb25zLmFwcGVuZFRvOw0KDQogICAgICAgICAgICBpZiAoIGVsZW1lbnQgKSB7DQogICAgICAgICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQuanF1ZXJ5IHx8IGVsZW1lbnQubm9kZVR5cGUgPw0KICAgICAgICAgICAgICAgICAgICAkKCBlbGVtZW50ICkgOg0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50LmZpbmQoIGVsZW1lbnQgKS5lcSggMCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoICFlbGVtZW50IHx8ICFlbGVtZW50WyAwIF0gKSB7DQogICAgICAgICAgICAgICAgZWxlbWVudCA9IHRoaXMuZWxlbWVudC5jbG9zZXN0KCAiLnVpLWZyb250LCBkaWFsb2ciICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggIWVsZW1lbnQubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIGVsZW1lbnQgPSB0aGlzLmRvY3VtZW50WyAwIF0uYm9keTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3RvZ2dsZUF0dHI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5idXR0b24uYXR0ciggImFyaWEtZXhwYW5kZWQiLCB0aGlzLmlzT3BlbiApOw0KDQogICAgICAgICAgICAvLyBXZSBjYW4ndCB1c2UgdHdvIF90b2dnbGVDbGFzcygpIGNhbGxzIGhlcmUsIGJlY2F1c2Ugd2UgbmVlZCB0byBtYWtlIHN1cmUNCiAgICAgICAgICAgIC8vIHdlIGFsd2F5cyByZW1vdmUgY2xhc3NlcyBmaXJzdCBhbmQgYWRkIHRoZW0gc2Vjb25kLCBvdGhlcndpc2UgaWYgYm90aCBjbGFzc2VzIGhhdmUgdGhlDQogICAgICAgICAgICAvLyBzYW1lIHRoZW1lIGNsYXNzLCBpdCB3aWxsIGJlIHJlbW92ZWQgYWZ0ZXIgd2UgYWRkIGl0Lg0KICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMuYnV0dG9uLCAidWktc2VsZWN0bWVudS1idXR0b24tIiArDQogICAgICAgICAgICAgICAgKCB0aGlzLmlzT3BlbiA/ICJjbG9zZWQiIDogIm9wZW4iICkgKQ0KICAgICAgICAgICAgICAgIC5fYWRkQ2xhc3MoIHRoaXMuYnV0dG9uLCAidWktc2VsZWN0bWVudS1idXR0b24tIiArDQogICAgICAgICAgICAgICAgICAgICggdGhpcy5pc09wZW4gPyAib3BlbiIgOiAiY2xvc2VkIiApICkNCiAgICAgICAgICAgICAgICAuX3RvZ2dsZUNsYXNzKCB0aGlzLm1lbnVXcmFwLCAidWktc2VsZWN0bWVudS1vcGVuIiwgbnVsbCwgdGhpcy5pc09wZW4gKTsNCg0KICAgICAgICAgICAgdGhpcy5tZW51LmF0dHIoICJhcmlhLWhpZGRlbiIsICF0aGlzLmlzT3BlbiApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9yZXNpemVCdXR0b246IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHdpZHRoID0gdGhpcy5vcHRpb25zLndpZHRoOw0KDQogICAgICAgICAgICAvLyBGb3IgYHdpZHRoOiBmYWxzZWAsIGp1c3QgcmVtb3ZlIGlubGluZSBzdHlsZSBhbmQgc3RvcA0KICAgICAgICAgICAgaWYgKCB3aWR0aCA9PT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5idXR0b24uY3NzKCAid2lkdGgiLCAiIiApOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gRm9yIGB3aWR0aDogbnVsbGAsIG1hdGNoIHRoZSB3aWR0aCBvZiB0aGUgb3JpZ2luYWwgZWxlbWVudA0KICAgICAgICAgICAgaWYgKCB3aWR0aCA9PT0gbnVsbCApIHsNCiAgICAgICAgICAgICAgICB3aWR0aCA9IHRoaXMuZWxlbWVudC5zaG93KCkub3V0ZXJXaWR0aCgpOw0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5oaWRlKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuYnV0dG9uLm91dGVyV2lkdGgoIHdpZHRoICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3Jlc2l6ZU1lbnU6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5tZW51Lm91dGVyV2lkdGgoIE1hdGgubWF4KA0KICAgICAgICAgICAgICAgIHRoaXMuYnV0dG9uLm91dGVyV2lkdGgoKSwNCg0KICAgICAgICAgICAgICAgIC8vIFN1cHBvcnQ6IElFMTANCiAgICAgICAgICAgICAgICAvLyBJRTEwIHdyYXBzIGxvbmcgdGV4dCAocG9zc2libHkgYSByb3VuZGluZyBidWcpDQogICAgICAgICAgICAgICAgLy8gc28gd2UgYWRkIDFweCB0byBhdm9pZCB0aGUgd3JhcHBpbmcNCiAgICAgICAgICAgICAgICB0aGlzLm1lbnUud2lkdGgoICIiICkub3V0ZXJXaWR0aCgpICsgMQ0KICAgICAgICAgICAgKSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9nZXRDcmVhdGVPcHRpb25zOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5fc3VwZXIoKTsNCg0KICAgICAgICAgICAgb3B0aW9ucy5kaXNhYmxlZCA9IHRoaXMuZWxlbWVudC5wcm9wKCAiZGlzYWJsZWQiICk7DQoNCiAgICAgICAgICAgIHJldHVybiBvcHRpb25zOw0KICAgICAgICB9LA0KDQogICAgICAgIF9wYXJzZU9wdGlvbnM6IGZ1bmN0aW9uKCBvcHRpb25zICkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIGRhdGEgPSBbXTsNCiAgICAgICAgICAgIG9wdGlvbnMuZWFjaCggZnVuY3Rpb24oIGluZGV4LCBpdGVtICkgew0KICAgICAgICAgICAgICAgIGRhdGEucHVzaCggdGhhdC5fcGFyc2VPcHRpb24oICQoIGl0ZW0gKSwgaW5kZXggKSApOw0KICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgdGhpcy5pdGVtcyA9IGRhdGE7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3BhcnNlT3B0aW9uOiBmdW5jdGlvbiggb3B0aW9uLCBpbmRleCApIHsNCiAgICAgICAgICAgIHZhciBvcHRncm91cCA9IG9wdGlvbi5wYXJlbnQoICJvcHRncm91cCIgKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50OiBvcHRpb24sDQogICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4LA0KICAgICAgICAgICAgICAgIHZhbHVlOiBvcHRpb24udmFsKCksDQogICAgICAgICAgICAgICAgbGFiZWw6IG9wdGlvbi50ZXh0KCksDQogICAgICAgICAgICAgICAgb3B0Z3JvdXA6IG9wdGdyb3VwLmF0dHIoICJsYWJlbCIgKSB8fCAiIiwNCiAgICAgICAgICAgICAgICBkaXNhYmxlZDogb3B0Z3JvdXAucHJvcCggImRpc2FibGVkIiApIHx8IG9wdGlvbi5wcm9wKCAiZGlzYWJsZWQiICkNCiAgICAgICAgICAgIH07DQogICAgICAgIH0sDQoNCiAgICAgICAgX2Rlc3Ryb3k6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5fdW5iaW5kRm9ybVJlc2V0SGFuZGxlcigpOw0KICAgICAgICAgICAgdGhpcy5tZW51V3JhcC5yZW1vdmUoKTsNCiAgICAgICAgICAgIHRoaXMuYnV0dG9uLnJlbW92ZSgpOw0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LnNob3coKTsNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVVbmlxdWVJZCgpOw0KICAgICAgICAgICAgdGhpcy5sYWJlbHMuYXR0ciggImZvciIsIHRoaXMuaWRzLmVsZW1lbnQgKTsNCiAgICAgICAgfQ0KICAgIH0gXSApOw0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBTbGlkZXIgMS4xMi4xDQogKiBodHRwOi8vanF1ZXJ5dWkuY29tDQogKg0KICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMNCiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UNCiAqLw0KDQovLz4+bGFiZWw6IFNsaWRlcg0KLy8+Pmdyb3VwOiBXaWRnZXRzDQovLz4+ZGVzY3JpcHRpb246IERpc3BsYXlzIGEgZmxleGlibGUgc2xpZGVyIHdpdGggcmFuZ2VzIGFuZCBhY2Nlc3NpYmlsaXR5IHZpYSBrZXlib2FyZC4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9zbGlkZXIvDQovLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vc2xpZGVyLw0KLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2NvcmUuY3NzDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2Uvc2xpZGVyLmNzcw0KLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzDQoNCg0KDQogICAgdmFyIHdpZGdldHNTbGlkZXIgPSAkLndpZGdldCggInVpLnNsaWRlciIsICQudWkubW91c2UsIHsNCiAgICAgICAgdmVyc2lvbjogIjEuMTIuMSIsDQogICAgICAgIHdpZGdldEV2ZW50UHJlZml4OiAic2xpZGUiLA0KDQogICAgICAgIG9wdGlvbnM6IHsNCiAgICAgICAgICAgIGFuaW1hdGU6IGZhbHNlLA0KICAgICAgICAgICAgY2xhc3Nlczogew0KICAgICAgICAgICAgICAgICJ1aS1zbGlkZXIiOiAidWktY29ybmVyLWFsbCIsDQogICAgICAgICAgICAgICAgInVpLXNsaWRlci1oYW5kbGUiOiAidWktY29ybmVyLWFsbCIsDQoNCiAgICAgICAgICAgICAgICAvLyBOb3RlOiB1aS13aWRnZXQtaGVhZGVyIGlzbid0IHRoZSBtb3N0IGZpdHRpbmdseSBzZW1hbnRpYyBmcmFtZXdvcmsgY2xhc3MgZm9yIHRoaXMNCiAgICAgICAgICAgICAgICAvLyBlbGVtZW50LCBidXQgd29ya2VkIGJlc3QgdmlzdWFsbHkgd2l0aCBhIHZhcmlldHkgb2YgdGhlbWVzDQogICAgICAgICAgICAgICAgInVpLXNsaWRlci1yYW5nZSI6ICJ1aS1jb3JuZXItYWxsIHVpLXdpZGdldC1oZWFkZXIiDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgZGlzdGFuY2U6IDAsDQogICAgICAgICAgICBtYXg6IDEwMCwNCiAgICAgICAgICAgIG1pbjogMCwNCiAgICAgICAgICAgIG9yaWVudGF0aW9uOiAiaG9yaXpvbnRhbCIsDQogICAgICAgICAgICByYW5nZTogZmFsc2UsDQogICAgICAgICAgICBzdGVwOiAxLA0KICAgICAgICAgICAgdmFsdWU6IDAsDQogICAgICAgICAgICB2YWx1ZXM6IG51bGwsDQoNCiAgICAgICAgICAgIC8vIENhbGxiYWNrcw0KICAgICAgICAgICAgY2hhbmdlOiBudWxsLA0KICAgICAgICAgICAgc2xpZGU6IG51bGwsDQogICAgICAgICAgICBzdGFydDogbnVsbCwNCiAgICAgICAgICAgIHN0b3A6IG51bGwNCiAgICAgICAgfSwNCg0KICAgICAgICAvLyBOdW1iZXIgb2YgcGFnZXMgaW4gYSBzbGlkZXINCiAgICAgICAgLy8gKGhvdyBtYW55IHRpbWVzIGNhbiB5b3UgcGFnZSB1cC9kb3duIHRvIGdvIHRocm91Z2ggdGhlIHdob2xlIHJhbmdlKQ0KICAgICAgICBudW1QYWdlczogNSwNCg0KICAgICAgICBfY3JlYXRlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuX2tleVNsaWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgIHRoaXMuX21vdXNlU2xpZGluZyA9IGZhbHNlOw0KICAgICAgICAgICAgdGhpcy5fYW5pbWF0ZU9mZiA9IHRydWU7DQogICAgICAgICAgICB0aGlzLl9oYW5kbGVJbmRleCA9IG51bGw7DQogICAgICAgICAgICB0aGlzLl9kZXRlY3RPcmllbnRhdGlvbigpOw0KICAgICAgICAgICAgdGhpcy5fbW91c2VJbml0KCk7DQogICAgICAgICAgICB0aGlzLl9jYWxjdWxhdGVOZXdNYXgoKTsNCg0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoICJ1aS1zbGlkZXIgdWktc2xpZGVyLSIgKyB0aGlzLm9yaWVudGF0aW9uLA0KICAgICAgICAgICAgICAgICJ1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQiICk7DQoNCiAgICAgICAgICAgIHRoaXMuX3JlZnJlc2goKTsNCg0KICAgICAgICAgICAgdGhpcy5fYW5pbWF0ZU9mZiA9IGZhbHNlOw0KICAgICAgICB9LA0KDQogICAgICAgIF9yZWZyZXNoOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZVJhbmdlKCk7DQogICAgICAgICAgICB0aGlzLl9jcmVhdGVIYW5kbGVzKCk7DQogICAgICAgICAgICB0aGlzLl9zZXR1cEV2ZW50cygpOw0KICAgICAgICAgICAgdGhpcy5fcmVmcmVzaFZhbHVlKCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2NyZWF0ZUhhbmRsZXM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGksIGhhbmRsZUNvdW50LA0KICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsDQogICAgICAgICAgICAgICAgZXhpc3RpbmdIYW5kbGVzID0gdGhpcy5lbGVtZW50LmZpbmQoICIudWktc2xpZGVyLWhhbmRsZSIgKSwNCiAgICAgICAgICAgICAgICBoYW5kbGUgPSAiPHNwYW4gdGFiaW5kZXg9JzAnPjwvc3Bhbj4iLA0KICAgICAgICAgICAgICAgIGhhbmRsZXMgPSBbXTsNCg0KICAgICAgICAgICAgaGFuZGxlQ291bnQgPSAoIG9wdGlvbnMudmFsdWVzICYmIG9wdGlvbnMudmFsdWVzLmxlbmd0aCApIHx8IDE7DQoNCiAgICAgICAgICAgIGlmICggZXhpc3RpbmdIYW5kbGVzLmxlbmd0aCA+IGhhbmRsZUNvdW50ICkgew0KICAgICAgICAgICAgICAgIGV4aXN0aW5nSGFuZGxlcy5zbGljZSggaGFuZGxlQ291bnQgKS5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICBleGlzdGluZ0hhbmRsZXMgPSBleGlzdGluZ0hhbmRsZXMuc2xpY2UoIDAsIGhhbmRsZUNvdW50ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGZvciAoIGkgPSBleGlzdGluZ0hhbmRsZXMubGVuZ3RoOyBpIDwgaGFuZGxlQ291bnQ7IGkrKyApIHsNCiAgICAgICAgICAgICAgICBoYW5kbGVzLnB1c2goIGhhbmRsZSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLmhhbmRsZXMgPSBleGlzdGluZ0hhbmRsZXMuYWRkKCAkKCBoYW5kbGVzLmpvaW4oICIiICkgKS5hcHBlbmRUbyggdGhpcy5lbGVtZW50ICkgKTsNCg0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMuaGFuZGxlcywgInVpLXNsaWRlci1oYW5kbGUiLCAidWktc3RhdGUtZGVmYXVsdCIgKTsNCg0KICAgICAgICAgICAgdGhpcy5oYW5kbGUgPSB0aGlzLmhhbmRsZXMuZXEoIDAgKTsNCg0KICAgICAgICAgICAgdGhpcy5oYW5kbGVzLmVhY2goIGZ1bmN0aW9uKCBpICkgew0KICAgICAgICAgICAgICAgICQoIHRoaXMgKQ0KICAgICAgICAgICAgICAgICAgICAuZGF0YSggInVpLXNsaWRlci1oYW5kbGUtaW5kZXgiLCBpICkNCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoICJ0YWJJbmRleCIsIDAgKTsNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfY3JlYXRlUmFuZ2U6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7DQoNCiAgICAgICAgICAgIGlmICggb3B0aW9ucy5yYW5nZSApIHsNCiAgICAgICAgICAgICAgICBpZiAoIG9wdGlvbnMucmFuZ2UgPT09IHRydWUgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggIW9wdGlvbnMudmFsdWVzICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy52YWx1ZXMgPSBbIHRoaXMuX3ZhbHVlTWluKCksIHRoaXMuX3ZhbHVlTWluKCkgXTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggb3B0aW9ucy52YWx1ZXMubGVuZ3RoICYmIG9wdGlvbnMudmFsdWVzLmxlbmd0aCAhPT0gMiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudmFsdWVzID0gWyBvcHRpb25zLnZhbHVlc1sgMCBdLCBvcHRpb25zLnZhbHVlc1sgMCBdIF07DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoICQuaXNBcnJheSggb3B0aW9ucy52YWx1ZXMgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudmFsdWVzID0gb3B0aW9ucy52YWx1ZXMuc2xpY2UoIDAgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggIXRoaXMucmFuZ2UgfHwgIXRoaXMucmFuZ2UubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmdlID0gJCggIjxkaXY+IiApDQogICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kVG8oIHRoaXMuZWxlbWVudCApOw0KDQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLnJhbmdlLCAidWktc2xpZGVyLXJhbmdlIiApOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLnJhbmdlLCAidWktc2xpZGVyLXJhbmdlLW1pbiB1aS1zbGlkZXItcmFuZ2UtbWF4IiApOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZSByYW5nZSBzd2l0Y2hpbmcgZnJvbSB0cnVlIHRvIG1pbi9tYXgNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5nZS5jc3MoIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJsZWZ0IjogIiIsDQogICAgICAgICAgICAgICAgICAgICAgICAiYm90dG9tIjogIiINCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoIG9wdGlvbnMucmFuZ2UgPT09ICJtaW4iIHx8IG9wdGlvbnMucmFuZ2UgPT09ICJtYXgiICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy5yYW5nZSwgInVpLXNsaWRlci1yYW5nZS0iICsgb3B0aW9ucy5yYW5nZSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLnJhbmdlICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmdlLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLnJhbmdlID0gbnVsbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0dXBFdmVudHM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5fb2ZmKCB0aGlzLmhhbmRsZXMgKTsNCiAgICAgICAgICAgIHRoaXMuX29uKCB0aGlzLmhhbmRsZXMsIHRoaXMuX2hhbmRsZUV2ZW50cyApOw0KICAgICAgICAgICAgdGhpcy5faG92ZXJhYmxlKCB0aGlzLmhhbmRsZXMgKTsNCiAgICAgICAgICAgIHRoaXMuX2ZvY3VzYWJsZSggdGhpcy5oYW5kbGVzICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2Rlc3Ryb3k6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5oYW5kbGVzLnJlbW92ZSgpOw0KICAgICAgICAgICAgaWYgKCB0aGlzLnJhbmdlICkgew0KICAgICAgICAgICAgICAgIHRoaXMucmFuZ2UucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX21vdXNlRGVzdHJveSgpOw0KICAgICAgICB9LA0KDQogICAgICAgIF9tb3VzZUNhcHR1cmU6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciBwb3NpdGlvbiwgbm9ybVZhbHVlLCBkaXN0YW5jZSwgY2xvc2VzdEhhbmRsZSwgaW5kZXgsIGFsbG93ZWQsIG9mZnNldCwgbW91c2VPdmVySGFuZGxlLA0KICAgICAgICAgICAgICAgIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIG8gPSB0aGlzLm9wdGlvbnM7DQoNCiAgICAgICAgICAgIGlmICggby5kaXNhYmxlZCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudFNpemUgPSB7DQogICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMuZWxlbWVudC5vdXRlcldpZHRoKCksDQogICAgICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmVsZW1lbnQub3V0ZXJIZWlnaHQoKQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudE9mZnNldCA9IHRoaXMuZWxlbWVudC5vZmZzZXQoKTsNCg0KICAgICAgICAgICAgcG9zaXRpb24gPSB7IHg6IGV2ZW50LnBhZ2VYLCB5OiBldmVudC5wYWdlWSB9Ow0KICAgICAgICAgICAgbm9ybVZhbHVlID0gdGhpcy5fbm9ybVZhbHVlRnJvbU1vdXNlKCBwb3NpdGlvbiApOw0KICAgICAgICAgICAgZGlzdGFuY2UgPSB0aGlzLl92YWx1ZU1heCgpIC0gdGhpcy5fdmFsdWVNaW4oKSArIDE7DQogICAgICAgICAgICB0aGlzLmhhbmRsZXMuZWFjaCggZnVuY3Rpb24oIGkgKSB7DQogICAgICAgICAgICAgICAgdmFyIHRoaXNEaXN0YW5jZSA9IE1hdGguYWJzKCBub3JtVmFsdWUgLSB0aGF0LnZhbHVlcyggaSApICk7DQogICAgICAgICAgICAgICAgaWYgKCAoIGRpc3RhbmNlID4gdGhpc0Rpc3RhbmNlICkgfHwNCiAgICAgICAgICAgICAgICAgICAgKCBkaXN0YW5jZSA9PT0gdGhpc0Rpc3RhbmNlICYmDQogICAgICAgICAgICAgICAgICAgICAgICAoIGkgPT09IHRoYXQuX2xhc3RDaGFuZ2VkVmFsdWUgfHwgdGhhdC52YWx1ZXMoIGkgKSA9PT0gby5taW4gKSApICkgew0KICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZSA9IHRoaXNEaXN0YW5jZTsNCiAgICAgICAgICAgICAgICAgICAgY2xvc2VzdEhhbmRsZSA9ICQoIHRoaXMgKTsNCiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgYWxsb3dlZCA9IHRoaXMuX3N0YXJ0KCBldmVudCwgaW5kZXggKTsNCiAgICAgICAgICAgIGlmICggYWxsb3dlZCA9PT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5fbW91c2VTbGlkaW5nID0gdHJ1ZTsNCg0KICAgICAgICAgICAgdGhpcy5faGFuZGxlSW5kZXggPSBpbmRleDsNCg0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIGNsb3Nlc3RIYW5kbGUsIG51bGwsICJ1aS1zdGF0ZS1hY3RpdmUiICk7DQogICAgICAgICAgICBjbG9zZXN0SGFuZGxlLnRyaWdnZXIoICJmb2N1cyIgKTsNCg0KICAgICAgICAgICAgb2Zmc2V0ID0gY2xvc2VzdEhhbmRsZS5vZmZzZXQoKTsNCiAgICAgICAgICAgIG1vdXNlT3ZlckhhbmRsZSA9ICEkKCBldmVudC50YXJnZXQgKS5wYXJlbnRzKCkuYWRkQmFjaygpLmlzKCAiLnVpLXNsaWRlci1oYW5kbGUiICk7DQogICAgICAgICAgICB0aGlzLl9jbGlja09mZnNldCA9IG1vdXNlT3ZlckhhbmRsZSA/IHsgbGVmdDogMCwgdG9wOiAwIH0gOiB7DQogICAgICAgICAgICAgICAgbGVmdDogZXZlbnQucGFnZVggLSBvZmZzZXQubGVmdCAtICggY2xvc2VzdEhhbmRsZS53aWR0aCgpIC8gMiApLA0KICAgICAgICAgICAgICAgIHRvcDogZXZlbnQucGFnZVkgLSBvZmZzZXQudG9wIC0NCiAgICAgICAgICAgICAgICAgICAgKCBjbG9zZXN0SGFuZGxlLmhlaWdodCgpIC8gMiApIC0NCiAgICAgICAgICAgICAgICAgICAgKCBwYXJzZUludCggY2xvc2VzdEhhbmRsZS5jc3MoICJib3JkZXJUb3BXaWR0aCIgKSwgMTAgKSB8fCAwICkgLQ0KICAgICAgICAgICAgICAgICAgICAoIHBhcnNlSW50KCBjbG9zZXN0SGFuZGxlLmNzcyggImJvcmRlckJvdHRvbVdpZHRoIiApLCAxMCApIHx8IDAgKSArDQogICAgICAgICAgICAgICAgICAgICggcGFyc2VJbnQoIGNsb3Nlc3RIYW5kbGUuY3NzKCAibWFyZ2luVG9wIiApLCAxMCApIHx8IDAgKQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgaWYgKCAhdGhpcy5oYW5kbGVzLmhhc0NsYXNzKCAidWktc3RhdGUtaG92ZXIiICkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fc2xpZGUoIGV2ZW50LCBpbmRleCwgbm9ybVZhbHVlICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLl9hbmltYXRlT2ZmID0gdHJ1ZTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9LA0KDQogICAgICAgIF9tb3VzZVN0YXJ0OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9LA0KDQogICAgICAgIF9tb3VzZURyYWc6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHsgeDogZXZlbnQucGFnZVgsIHk6IGV2ZW50LnBhZ2VZIH0sDQogICAgICAgICAgICAgICAgbm9ybVZhbHVlID0gdGhpcy5fbm9ybVZhbHVlRnJvbU1vdXNlKCBwb3NpdGlvbiApOw0KDQogICAgICAgICAgICB0aGlzLl9zbGlkZSggZXZlbnQsIHRoaXMuX2hhbmRsZUluZGV4LCBub3JtVmFsdWUgKTsNCg0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9LA0KDQogICAgICAgIF9tb3VzZVN0b3A6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLmhhbmRsZXMsIG51bGwsICJ1aS1zdGF0ZS1hY3RpdmUiICk7DQogICAgICAgICAgICB0aGlzLl9tb3VzZVNsaWRpbmcgPSBmYWxzZTsNCg0KICAgICAgICAgICAgdGhpcy5fc3RvcCggZXZlbnQsIHRoaXMuX2hhbmRsZUluZGV4ICk7DQogICAgICAgICAgICB0aGlzLl9jaGFuZ2UoIGV2ZW50LCB0aGlzLl9oYW5kbGVJbmRleCApOw0KDQogICAgICAgICAgICB0aGlzLl9oYW5kbGVJbmRleCA9IG51bGw7DQogICAgICAgICAgICB0aGlzLl9jbGlja09mZnNldCA9IG51bGw7DQogICAgICAgICAgICB0aGlzLl9hbmltYXRlT2ZmID0gZmFsc2U7DQoNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZGV0ZWN0T3JpZW50YXRpb246IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5vcmllbnRhdGlvbiA9ICggdGhpcy5vcHRpb25zLm9yaWVudGF0aW9uID09PSAidmVydGljYWwiICkgPyAidmVydGljYWwiIDogImhvcml6b250YWwiOw0KICAgICAgICB9LA0KDQogICAgICAgIF9ub3JtVmFsdWVGcm9tTW91c2U6IGZ1bmN0aW9uKCBwb3NpdGlvbiApIHsNCiAgICAgICAgICAgIHZhciBwaXhlbFRvdGFsLA0KICAgICAgICAgICAgICAgIHBpeGVsTW91c2UsDQogICAgICAgICAgICAgICAgcGVyY2VudE1vdXNlLA0KICAgICAgICAgICAgICAgIHZhbHVlVG90YWwsDQogICAgICAgICAgICAgICAgdmFsdWVNb3VzZTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLm9yaWVudGF0aW9uID09PSAiaG9yaXpvbnRhbCIgKSB7DQogICAgICAgICAgICAgICAgcGl4ZWxUb3RhbCA9IHRoaXMuZWxlbWVudFNpemUud2lkdGg7DQogICAgICAgICAgICAgICAgcGl4ZWxNb3VzZSA9IHBvc2l0aW9uLnggLSB0aGlzLmVsZW1lbnRPZmZzZXQubGVmdCAtDQogICAgICAgICAgICAgICAgICAgICggdGhpcy5fY2xpY2tPZmZzZXQgPyB0aGlzLl9jbGlja09mZnNldC5sZWZ0IDogMCApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBwaXhlbFRvdGFsID0gdGhpcy5lbGVtZW50U2l6ZS5oZWlnaHQ7DQogICAgICAgICAgICAgICAgcGl4ZWxNb3VzZSA9IHBvc2l0aW9uLnkgLSB0aGlzLmVsZW1lbnRPZmZzZXQudG9wIC0NCiAgICAgICAgICAgICAgICAgICAgKCB0aGlzLl9jbGlja09mZnNldCA/IHRoaXMuX2NsaWNrT2Zmc2V0LnRvcCA6IDAgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcGVyY2VudE1vdXNlID0gKCBwaXhlbE1vdXNlIC8gcGl4ZWxUb3RhbCApOw0KICAgICAgICAgICAgaWYgKCBwZXJjZW50TW91c2UgPiAxICkgew0KICAgICAgICAgICAgICAgIHBlcmNlbnRNb3VzZSA9IDE7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIHBlcmNlbnRNb3VzZSA8IDAgKSB7DQogICAgICAgICAgICAgICAgcGVyY2VudE1vdXNlID0gMDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggdGhpcy5vcmllbnRhdGlvbiA9PT0gInZlcnRpY2FsIiApIHsNCiAgICAgICAgICAgICAgICBwZXJjZW50TW91c2UgPSAxIC0gcGVyY2VudE1vdXNlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YWx1ZVRvdGFsID0gdGhpcy5fdmFsdWVNYXgoKSAtIHRoaXMuX3ZhbHVlTWluKCk7DQogICAgICAgICAgICB2YWx1ZU1vdXNlID0gdGhpcy5fdmFsdWVNaW4oKSArIHBlcmNlbnRNb3VzZSAqIHZhbHVlVG90YWw7DQoNCiAgICAgICAgICAgIHJldHVybiB0aGlzLl90cmltQWxpZ25WYWx1ZSggdmFsdWVNb3VzZSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF91aUhhc2g6IGZ1bmN0aW9uKCBpbmRleCwgdmFsdWUsIHZhbHVlcyApIHsNCiAgICAgICAgICAgIHZhciB1aUhhc2ggPSB7DQogICAgICAgICAgICAgICAgaGFuZGxlOiB0aGlzLmhhbmRsZXNbIGluZGV4IF0sDQogICAgICAgICAgICAgICAgaGFuZGxlSW5kZXg6IGluZGV4LA0KICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiB0aGlzLnZhbHVlKCkNCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5faGFzTXVsdGlwbGVWYWx1ZXMoKSApIHsNCiAgICAgICAgICAgICAgICB1aUhhc2gudmFsdWUgPSB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiB0aGlzLnZhbHVlcyggaW5kZXggKTsNCiAgICAgICAgICAgICAgICB1aUhhc2gudmFsdWVzID0gdmFsdWVzIHx8IHRoaXMudmFsdWVzKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiB1aUhhc2g7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2hhc011bHRpcGxlVmFsdWVzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMudmFsdWVzICYmIHRoaXMub3B0aW9ucy52YWx1ZXMubGVuZ3RoOw0KICAgICAgICB9LA0KDQogICAgICAgIF9zdGFydDogZnVuY3Rpb24oIGV2ZW50LCBpbmRleCApIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLl90cmlnZ2VyKCAic3RhcnQiLCBldmVudCwgdGhpcy5fdWlIYXNoKCBpbmRleCApICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NsaWRlOiBmdW5jdGlvbiggZXZlbnQsIGluZGV4LCBuZXdWYWwgKSB7DQogICAgICAgICAgICB2YXIgYWxsb3dlZCwgb3RoZXJWYWwsDQogICAgICAgICAgICAgICAgY3VycmVudFZhbHVlID0gdGhpcy52YWx1ZSgpLA0KICAgICAgICAgICAgICAgIG5ld1ZhbHVlcyA9IHRoaXMudmFsdWVzKCk7DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5faGFzTXVsdGlwbGVWYWx1ZXMoKSApIHsNCiAgICAgICAgICAgICAgICBvdGhlclZhbCA9IHRoaXMudmFsdWVzKCBpbmRleCA/IDAgOiAxICk7DQogICAgICAgICAgICAgICAgY3VycmVudFZhbHVlID0gdGhpcy52YWx1ZXMoIGluZGV4ICk7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy52YWx1ZXMubGVuZ3RoID09PSAyICYmIHRoaXMub3B0aW9ucy5yYW5nZSA9PT0gdHJ1ZSApIHsNCiAgICAgICAgICAgICAgICAgICAgbmV3VmFsID0gIGluZGV4ID09PSAwID8gTWF0aC5taW4oIG90aGVyVmFsLCBuZXdWYWwgKSA6IE1hdGgubWF4KCBvdGhlclZhbCwgbmV3VmFsICk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgbmV3VmFsdWVzWyBpbmRleCBdID0gbmV3VmFsOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIG5ld1ZhbCA9PT0gY3VycmVudFZhbHVlICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgYWxsb3dlZCA9IHRoaXMuX3RyaWdnZXIoICJzbGlkZSIsIGV2ZW50LCB0aGlzLl91aUhhc2goIGluZGV4LCBuZXdWYWwsIG5ld1ZhbHVlcyApICk7DQoNCiAgICAgICAgICAgIC8vIEEgc2xpZGUgY2FuIGJlIGNhbmNlbGVkIGJ5IHJldHVybmluZyBmYWxzZSBmcm9tIHRoZSBzbGlkZSBjYWxsYmFjaw0KICAgICAgICAgICAgaWYgKCBhbGxvd2VkID09PSBmYWxzZSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5faGFzTXVsdGlwbGVWYWx1ZXMoKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlcyggaW5kZXgsIG5ld1ZhbCApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlKCBuZXdWYWwgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfc3RvcDogZnVuY3Rpb24oIGV2ZW50LCBpbmRleCApIHsNCiAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJzdG9wIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCggaW5kZXggKSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9jaGFuZ2U6IGZ1bmN0aW9uKCBldmVudCwgaW5kZXggKSB7DQogICAgICAgICAgICBpZiAoICF0aGlzLl9rZXlTbGlkaW5nICYmICF0aGlzLl9tb3VzZVNsaWRpbmcgKSB7DQoNCiAgICAgICAgICAgICAgICAvL3N0b3JlIHRoZSBsYXN0IGNoYW5nZWQgdmFsdWUgaW5kZXggZm9yIHJlZmVyZW5jZSB3aGVuIGhhbmRsZXMgb3ZlcmxhcA0KICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RDaGFuZ2VkVmFsdWUgPSBpbmRleDsNCiAgICAgICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAiY2hhbmdlIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCggaW5kZXggKSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHZhbHVlOiBmdW5jdGlvbiggbmV3VmFsdWUgKSB7DQogICAgICAgICAgICBpZiAoIGFyZ3VtZW50cy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnZhbHVlID0gdGhpcy5fdHJpbUFsaWduVmFsdWUoIG5ld1ZhbHVlICk7DQogICAgICAgICAgICAgICAgdGhpcy5fcmVmcmVzaFZhbHVlKCk7DQogICAgICAgICAgICAgICAgdGhpcy5fY2hhbmdlKCBudWxsLCAwICk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWUoKTsNCiAgICAgICAgfSwNCg0KICAgICAgICB2YWx1ZXM6IGZ1bmN0aW9uKCBpbmRleCwgbmV3VmFsdWUgKSB7DQogICAgICAgICAgICB2YXIgdmFscywNCiAgICAgICAgICAgICAgICBuZXdWYWx1ZXMsDQogICAgICAgICAgICAgICAgaTsNCg0KICAgICAgICAgICAgaWYgKCBhcmd1bWVudHMubGVuZ3RoID4gMSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMudmFsdWVzWyBpbmRleCBdID0gdGhpcy5fdHJpbUFsaWduVmFsdWUoIG5ld1ZhbHVlICk7DQogICAgICAgICAgICAgICAgdGhpcy5fcmVmcmVzaFZhbHVlKCk7DQogICAgICAgICAgICAgICAgdGhpcy5fY2hhbmdlKCBudWxsLCBpbmRleCApOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCBhcmd1bWVudHMubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIGlmICggJC5pc0FycmF5KCBhcmd1bWVudHNbIDAgXSApICkgew0KICAgICAgICAgICAgICAgICAgICB2YWxzID0gdGhpcy5vcHRpb25zLnZhbHVlczsNCiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWVzID0gYXJndW1lbnRzWyAwIF07DQogICAgICAgICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgdmFscy5sZW5ndGg7IGkgKz0gMSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHNbIGkgXSA9IHRoaXMuX3RyaW1BbGlnblZhbHVlKCBuZXdWYWx1ZXNbIGkgXSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hhbmdlKCBudWxsLCBpICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVmcmVzaFZhbHVlKCk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLl9oYXNNdWx0aXBsZVZhbHVlcygpICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlcyggaW5kZXggKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl92YWx1ZXMoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHsNCiAgICAgICAgICAgIHZhciBpLA0KICAgICAgICAgICAgICAgIHZhbHNMZW5ndGggPSAwOw0KDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gInJhbmdlIiAmJiB0aGlzLm9wdGlvbnMucmFuZ2UgPT09IHRydWUgKSB7DQogICAgICAgICAgICAgICAgaWYgKCB2YWx1ZSA9PT0gIm1pbiIgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy52YWx1ZSA9IHRoaXMuX3ZhbHVlcyggMCApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMudmFsdWVzID0gbnVsbDsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB2YWx1ZSA9PT0gIm1heCIgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy52YWx1ZSA9IHRoaXMuX3ZhbHVlcyggdGhpcy5vcHRpb25zLnZhbHVlcy5sZW5ndGggLSAxICk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy52YWx1ZXMgPSBudWxsOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCAkLmlzQXJyYXkoIHRoaXMub3B0aW9ucy52YWx1ZXMgKSApIHsNCiAgICAgICAgICAgICAgICB2YWxzTGVuZ3RoID0gdGhpcy5vcHRpb25zLnZhbHVlcy5sZW5ndGg7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX3N1cGVyKCBrZXksIHZhbHVlICk7DQoNCiAgICAgICAgICAgIHN3aXRjaCAoIGtleSApIHsNCiAgICAgICAgICAgICAgICBjYXNlICJvcmllbnRhdGlvbiI6DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2RldGVjdE9yaWVudGF0aW9uKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCAidWktc2xpZGVyLWhvcml6b250YWwgdWktc2xpZGVyLXZlcnRpY2FsIiApDQogICAgICAgICAgICAgICAgICAgICAgICAuX2FkZENsYXNzKCAidWktc2xpZGVyLSIgKyB0aGlzLm9yaWVudGF0aW9uICk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlZnJlc2hWYWx1ZSgpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5yYW5nZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlZnJlc2hSYW5nZSggdmFsdWUgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIFJlc2V0IHBvc2l0aW9uaW5nIGZyb20gcHJldmlvdXMgb3JpZW50YXRpb24NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVzLmNzcyggdmFsdWUgPT09ICJob3Jpem9udGFsIiA/ICJib3R0b20iIDogImxlZnQiLCAiIiApOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICJ2YWx1ZSI6DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2FuaW1hdGVPZmYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWZyZXNoVmFsdWUoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hhbmdlKCBudWxsLCAwICk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2FuaW1hdGVPZmYgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAidmFsdWVzIjoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYW5pbWF0ZU9mZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlZnJlc2hWYWx1ZSgpOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIFN0YXJ0IGZyb20gdGhlIGxhc3QgaGFuZGxlIHRvIHByZXZlbnQgdW5yZWFjaGFibGUgaGFuZGxlcyAoIzkwNDYpDQogICAgICAgICAgICAgICAgICAgIGZvciAoIGkgPSB2YWxzTGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGFuZ2UoIG51bGwsIGkgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9hbmltYXRlT2ZmID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2UgInN0ZXAiOg0KICAgICAgICAgICAgICAgIGNhc2UgIm1pbiI6DQogICAgICAgICAgICAgICAgY2FzZSAibWF4IjoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYW5pbWF0ZU9mZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2NhbGN1bGF0ZU5ld01heCgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWZyZXNoVmFsdWUoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYW5pbWF0ZU9mZiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICJyYW5nZSI6DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2FuaW1hdGVPZmYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWZyZXNoKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2FuaW1hdGVPZmYgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldE9wdGlvbkRpc2FibGVkOiBmdW5jdGlvbiggdmFsdWUgKSB7DQogICAgICAgICAgICB0aGlzLl9zdXBlciggdmFsdWUgKTsNCg0KICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQ2xhc3MoIG51bGwsICJ1aS1zdGF0ZS1kaXNhYmxlZCIsICEhdmFsdWUgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvL2ludGVybmFsIHZhbHVlIGdldHRlcg0KICAgICAgICAvLyBfdmFsdWUoKSByZXR1cm5zIHZhbHVlIHRyaW1tZWQgYnkgbWluIGFuZCBtYXgsIGFsaWduZWQgYnkgc3RlcA0KICAgICAgICBfdmFsdWU6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHZhbCA9IHRoaXMub3B0aW9ucy52YWx1ZTsNCiAgICAgICAgICAgIHZhbCA9IHRoaXMuX3RyaW1BbGlnblZhbHVlKCB2YWwgKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHZhbDsNCiAgICAgICAgfSwNCg0KICAgICAgICAvL2ludGVybmFsIHZhbHVlcyBnZXR0ZXINCiAgICAgICAgLy8gX3ZhbHVlcygpIHJldHVybnMgYXJyYXkgb2YgdmFsdWVzIHRyaW1tZWQgYnkgbWluIGFuZCBtYXgsIGFsaWduZWQgYnkgc3RlcA0KICAgICAgICAvLyBfdmFsdWVzKCBpbmRleCApIHJldHVybnMgc2luZ2xlIHZhbHVlIHRyaW1tZWQgYnkgbWluIGFuZCBtYXgsIGFsaWduZWQgYnkgc3RlcA0KICAgICAgICBfdmFsdWVzOiBmdW5jdGlvbiggaW5kZXggKSB7DQogICAgICAgICAgICB2YXIgdmFsLA0KICAgICAgICAgICAgICAgIHZhbHMsDQogICAgICAgICAgICAgICAgaTsNCg0KICAgICAgICAgICAgaWYgKCBhcmd1bWVudHMubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIHZhbCA9IHRoaXMub3B0aW9ucy52YWx1ZXNbIGluZGV4IF07DQogICAgICAgICAgICAgICAgdmFsID0gdGhpcy5fdHJpbUFsaWduVmFsdWUoIHZhbCApOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHRoaXMuX2hhc011bHRpcGxlVmFsdWVzKCkgKSB7DQoNCiAgICAgICAgICAgICAgICAvLyAuc2xpY2UoKSBjcmVhdGVzIGEgY29weSBvZiB0aGUgYXJyYXkNCiAgICAgICAgICAgICAgICAvLyB0aGlzIGNvcHkgZ2V0cyB0cmltbWVkIGJ5IG1pbiBhbmQgbWF4IGFuZCB0aGVuIHJldHVybmVkDQogICAgICAgICAgICAgICAgdmFscyA9IHRoaXMub3B0aW9ucy52YWx1ZXMuc2xpY2UoKTsNCiAgICAgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IHZhbHMubGVuZ3RoOyBpICs9IDEgKSB7DQogICAgICAgICAgICAgICAgICAgIHZhbHNbIGkgXSA9IHRoaXMuX3RyaW1BbGlnblZhbHVlKCB2YWxzWyBpIF0gKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gdmFsczsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIFtdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIC8vIFJldHVybnMgdGhlIHN0ZXAtYWxpZ25lZCB2YWx1ZSB0aGF0IHZhbCBpcyBjbG9zZXN0IHRvLCBiZXR3ZWVuIChpbmNsdXNpdmUpIG1pbiBhbmQgbWF4DQogICAgICAgIF90cmltQWxpZ25WYWx1ZTogZnVuY3Rpb24oIHZhbCApIHsNCiAgICAgICAgICAgIGlmICggdmFsIDw9IHRoaXMuX3ZhbHVlTWluKCkgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlTWluKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIHZhbCA+PSB0aGlzLl92YWx1ZU1heCgpICkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl92YWx1ZU1heCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIHN0ZXAgPSAoIHRoaXMub3B0aW9ucy5zdGVwID4gMCApID8gdGhpcy5vcHRpb25zLnN0ZXAgOiAxLA0KICAgICAgICAgICAgICAgIHZhbE1vZFN0ZXAgPSAoIHZhbCAtIHRoaXMuX3ZhbHVlTWluKCkgKSAlIHN0ZXAsDQogICAgICAgICAgICAgICAgYWxpZ25WYWx1ZSA9IHZhbCAtIHZhbE1vZFN0ZXA7DQoNCiAgICAgICAgICAgIGlmICggTWF0aC5hYnMoIHZhbE1vZFN0ZXAgKSAqIDIgPj0gc3RlcCApIHsNCiAgICAgICAgICAgICAgICBhbGlnblZhbHVlICs9ICggdmFsTW9kU3RlcCA+IDAgKSA/IHN0ZXAgOiAoIC1zdGVwICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFNpbmNlIEphdmFTY3JpcHQgaGFzIHByb2JsZW1zIHdpdGggbGFyZ2UgZmxvYXRzLCByb3VuZA0KICAgICAgICAgICAgLy8gdGhlIGZpbmFsIHZhbHVlIHRvIDUgZGlnaXRzIGFmdGVyIHRoZSBkZWNpbWFsIHBvaW50IChzZWUgIzQxMjQpDQogICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCggYWxpZ25WYWx1ZS50b0ZpeGVkKCA1ICkgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfY2FsY3VsYXRlTmV3TWF4OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBtYXggPSB0aGlzLm9wdGlvbnMubWF4LA0KICAgICAgICAgICAgICAgIG1pbiA9IHRoaXMuX3ZhbHVlTWluKCksDQogICAgICAgICAgICAgICAgc3RlcCA9IHRoaXMub3B0aW9ucy5zdGVwLA0KICAgICAgICAgICAgICAgIGFib3ZlTWluID0gTWF0aC5yb3VuZCggKCBtYXggLSBtaW4gKSAvIHN0ZXAgKSAqIHN0ZXA7DQogICAgICAgICAgICBtYXggPSBhYm92ZU1pbiArIG1pbjsNCiAgICAgICAgICAgIGlmICggbWF4ID4gdGhpcy5vcHRpb25zLm1heCApIHsNCg0KICAgICAgICAgICAgICAgIC8vSWYgbWF4IGlzIG5vdCBkaXZpc2libGUgYnkgc3RlcCwgcm91bmRpbmcgb2ZmIG1heSBpbmNyZWFzZSBpdHMgdmFsdWUNCiAgICAgICAgICAgICAgICBtYXggLT0gc3RlcDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMubWF4ID0gcGFyc2VGbG9hdCggbWF4LnRvRml4ZWQoIHRoaXMuX3ByZWNpc2lvbigpICkgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcHJlY2lzaW9uOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBwcmVjaXNpb24gPSB0aGlzLl9wcmVjaXNpb25PZiggdGhpcy5vcHRpb25zLnN0ZXAgKTsNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLm1pbiAhPT0gbnVsbCApIHsNCiAgICAgICAgICAgICAgICBwcmVjaXNpb24gPSBNYXRoLm1heCggcHJlY2lzaW9uLCB0aGlzLl9wcmVjaXNpb25PZiggdGhpcy5vcHRpb25zLm1pbiApICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gcHJlY2lzaW9uOw0KICAgICAgICB9LA0KDQogICAgICAgIF9wcmVjaXNpb25PZjogZnVuY3Rpb24oIG51bSApIHsNCiAgICAgICAgICAgIHZhciBzdHIgPSBudW0udG9TdHJpbmcoKSwNCiAgICAgICAgICAgICAgICBkZWNpbWFsID0gc3RyLmluZGV4T2YoICIuIiApOw0KICAgICAgICAgICAgcmV0dXJuIGRlY2ltYWwgPT09IC0xID8gMCA6IHN0ci5sZW5ndGggLSBkZWNpbWFsIC0gMTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfdmFsdWVNaW46IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5taW47DQogICAgICAgIH0sDQoNCiAgICAgICAgX3ZhbHVlTWF4OiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLm1heDsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcmVmcmVzaFJhbmdlOiBmdW5jdGlvbiggb3JpZW50YXRpb24gKSB7DQogICAgICAgICAgICBpZiAoIG9yaWVudGF0aW9uID09PSAidmVydGljYWwiICkgew0KICAgICAgICAgICAgICAgIHRoaXMucmFuZ2UuY3NzKCB7ICJ3aWR0aCI6ICIiLCAibGVmdCI6ICIiIH0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggb3JpZW50YXRpb24gPT09ICJob3Jpem9udGFsIiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLnJhbmdlLmNzcyggeyAiaGVpZ2h0IjogIiIsICJib3R0b20iOiAiIiB9ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX3JlZnJlc2hWYWx1ZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgbGFzdFZhbFBlcmNlbnQsIHZhbFBlcmNlbnQsIHZhbHVlLCB2YWx1ZU1pbiwgdmFsdWVNYXgsDQogICAgICAgICAgICAgICAgb1JhbmdlID0gdGhpcy5vcHRpb25zLnJhbmdlLA0KICAgICAgICAgICAgICAgIG8gPSB0aGlzLm9wdGlvbnMsDQogICAgICAgICAgICAgICAgdGhhdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgYW5pbWF0ZSA9ICggIXRoaXMuX2FuaW1hdGVPZmYgKSA/IG8uYW5pbWF0ZSA6IGZhbHNlLA0KICAgICAgICAgICAgICAgIF9zZXQgPSB7fTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLl9oYXNNdWx0aXBsZVZhbHVlcygpICkgew0KICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlcy5lYWNoKCBmdW5jdGlvbiggaSApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFsUGVyY2VudCA9ICggdGhhdC52YWx1ZXMoIGkgKSAtIHRoYXQuX3ZhbHVlTWluKCkgKSAvICggdGhhdC5fdmFsdWVNYXgoKSAtDQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll92YWx1ZU1pbigpICkgKiAxMDA7DQogICAgICAgICAgICAgICAgICAgIF9zZXRbIHRoYXQub3JpZW50YXRpb24gPT09ICJob3Jpem9udGFsIiA/ICJsZWZ0IiA6ICJib3R0b20iIF0gPSB2YWxQZXJjZW50ICsgIiUiOw0KICAgICAgICAgICAgICAgICAgICAkKCB0aGlzICkuc3RvcCggMSwgMSApWyBhbmltYXRlID8gImFuaW1hdGUiIDogImNzcyIgXSggX3NldCwgby5hbmltYXRlICk7DQogICAgICAgICAgICAgICAgICAgIGlmICggdGhhdC5vcHRpb25zLnJhbmdlID09PSB0cnVlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGF0Lm9yaWVudGF0aW9uID09PSAiaG9yaXpvbnRhbCIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBpID09PSAwICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LnJhbmdlLnN0b3AoIDEsIDEgKVsgYW5pbWF0ZSA/ICJhbmltYXRlIiA6ICJjc3MiIF0oIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IHZhbFBlcmNlbnQgKyAiJSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgby5hbmltYXRlICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggaSA9PT0gMSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5yYW5nZVsgYW5pbWF0ZSA/ICJhbmltYXRlIiA6ICJjc3MiIF0oIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAoIHZhbFBlcmNlbnQgLSBsYXN0VmFsUGVyY2VudCApICsgIiUiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXVlOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBvLmFuaW1hdGUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBpID09PSAwICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LnJhbmdlLnN0b3AoIDEsIDEgKVsgYW5pbWF0ZSA/ICJhbmltYXRlIiA6ICJjc3MiIF0oIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvdHRvbTogKCB2YWxQZXJjZW50ICkgKyAiJSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgby5hbmltYXRlICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggaSA9PT0gMSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5yYW5nZVsgYW5pbWF0ZSA/ICJhbmltYXRlIiA6ICJjc3MiIF0oIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogKCB2YWxQZXJjZW50IC0gbGFzdFZhbFBlcmNlbnQgKSArICIlIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWV1ZTogZmFsc2UsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogby5hbmltYXRlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgbGFzdFZhbFBlcmNlbnQgPSB2YWxQZXJjZW50Ow0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLnZhbHVlKCk7DQogICAgICAgICAgICAgICAgdmFsdWVNaW4gPSB0aGlzLl92YWx1ZU1pbigpOw0KICAgICAgICAgICAgICAgIHZhbHVlTWF4ID0gdGhpcy5fdmFsdWVNYXgoKTsNCiAgICAgICAgICAgICAgICB2YWxQZXJjZW50ID0gKCB2YWx1ZU1heCAhPT0gdmFsdWVNaW4gKSA/DQogICAgICAgICAgICAgICAgICAgICggdmFsdWUgLSB2YWx1ZU1pbiApIC8gKCB2YWx1ZU1heCAtIHZhbHVlTWluICkgKiAxMDAgOg0KICAgICAgICAgICAgICAgICAgICAwOw0KICAgICAgICAgICAgICAgIF9zZXRbIHRoaXMub3JpZW50YXRpb24gPT09ICJob3Jpem9udGFsIiA/ICJsZWZ0IiA6ICJib3R0b20iIF0gPSB2YWxQZXJjZW50ICsgIiUiOw0KICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlLnN0b3AoIDEsIDEgKVsgYW5pbWF0ZSA/ICJhbmltYXRlIiA6ICJjc3MiIF0oIF9zZXQsIG8uYW5pbWF0ZSApOw0KDQogICAgICAgICAgICAgICAgaWYgKCBvUmFuZ2UgPT09ICJtaW4iICYmIHRoaXMub3JpZW50YXRpb24gPT09ICJob3Jpem9udGFsIiApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5nZS5zdG9wKCAxLCAxIClbIGFuaW1hdGUgPyAiYW5pbWF0ZSIgOiAiY3NzIiBdKCB7DQogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogdmFsUGVyY2VudCArICIlIg0KICAgICAgICAgICAgICAgICAgICB9LCBvLmFuaW1hdGUgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCBvUmFuZ2UgPT09ICJtYXgiICYmIHRoaXMub3JpZW50YXRpb24gPT09ICJob3Jpem9udGFsIiApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5nZS5zdG9wKCAxLCAxIClbIGFuaW1hdGUgPyAiYW5pbWF0ZSIgOiAiY3NzIiBdKCB7DQogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogKCAxMDAgLSB2YWxQZXJjZW50ICkgKyAiJSINCiAgICAgICAgICAgICAgICAgICAgfSwgby5hbmltYXRlICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICggb1JhbmdlID09PSAibWluIiAmJiB0aGlzLm9yaWVudGF0aW9uID09PSAidmVydGljYWwiICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmdlLnN0b3AoIDEsIDEgKVsgYW5pbWF0ZSA/ICJhbmltYXRlIiA6ICJjc3MiIF0oIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogdmFsUGVyY2VudCArICIlIg0KICAgICAgICAgICAgICAgICAgICB9LCBvLmFuaW1hdGUgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCBvUmFuZ2UgPT09ICJtYXgiICYmIHRoaXMub3JpZW50YXRpb24gPT09ICJ2ZXJ0aWNhbCIgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmFuZ2Uuc3RvcCggMSwgMSApWyBhbmltYXRlID8gImFuaW1hdGUiIDogImNzcyIgXSggew0KICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAoIDEwMCAtIHZhbFBlcmNlbnQgKSArICIlIg0KICAgICAgICAgICAgICAgICAgICB9LCBvLmFuaW1hdGUgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2hhbmRsZUV2ZW50czogew0KICAgICAgICAgICAga2V5ZG93bjogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgIHZhciBhbGxvd2VkLCBjdXJWYWwsIG5ld1ZhbCwgc3RlcCwNCiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSAkKCBldmVudC50YXJnZXQgKS5kYXRhKCAidWktc2xpZGVyLWhhbmRsZS1pbmRleCIgKTsNCg0KICAgICAgICAgICAgICAgIHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLkhPTUU6DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLkVORDoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuUEFHRV9VUDoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuUEFHRV9ET1dOOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5VUDoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuUklHSFQ6DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLkRPV046DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLkxFRlQ6DQogICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5fa2V5U2xpZGluZyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9rZXlTbGlkaW5nID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggJCggZXZlbnQudGFyZ2V0ICksIG51bGwsICJ1aS1zdGF0ZS1hY3RpdmUiICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsb3dlZCA9IHRoaXMuX3N0YXJ0KCBldmVudCwgaW5kZXggKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGFsbG93ZWQgPT09IGZhbHNlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgc3RlcCA9IHRoaXMub3B0aW9ucy5zdGVwOw0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5faGFzTXVsdGlwbGVWYWx1ZXMoKSApIHsNCiAgICAgICAgICAgICAgICAgICAgY3VyVmFsID0gbmV3VmFsID0gdGhpcy52YWx1ZXMoIGluZGV4ICk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgY3VyVmFsID0gbmV3VmFsID0gdGhpcy52YWx1ZSgpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLkhPTUU6DQogICAgICAgICAgICAgICAgICAgICAgICBuZXdWYWwgPSB0aGlzLl92YWx1ZU1pbigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLkVORDoNCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbCA9IHRoaXMuX3ZhbHVlTWF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuUEFHRV9VUDoNCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbCA9IHRoaXMuX3RyaW1BbGlnblZhbHVlKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1clZhbCArICggKCB0aGlzLl92YWx1ZU1heCgpIC0gdGhpcy5fdmFsdWVNaW4oKSApIC8gdGhpcy5udW1QYWdlcyApDQogICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLlBBR0VfRE9XTjoNCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbCA9IHRoaXMuX3RyaW1BbGlnblZhbHVlKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1clZhbCAtICggKCB0aGlzLl92YWx1ZU1heCgpIC0gdGhpcy5fdmFsdWVNaW4oKSApIC8gdGhpcy5udW1QYWdlcyApICk7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuVVA6DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLlJJR0hUOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJWYWwgPT09IHRoaXMuX3ZhbHVlTWF4KCkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsID0gdGhpcy5fdHJpbUFsaWduVmFsdWUoIGN1clZhbCArIHN0ZXAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5ET1dOOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5MRUZUOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJWYWwgPT09IHRoaXMuX3ZhbHVlTWluKCkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsID0gdGhpcy5fdHJpbUFsaWduVmFsdWUoIGN1clZhbCAtIHN0ZXAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHRoaXMuX3NsaWRlKCBldmVudCwgaW5kZXgsIG5ld1ZhbCApOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGtleXVwOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gJCggZXZlbnQudGFyZ2V0ICkuZGF0YSggInVpLXNsaWRlci1oYW5kbGUtaW5kZXgiICk7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuX2tleVNsaWRpbmcgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2tleVNsaWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RvcCggZXZlbnQsIGluZGV4ICk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2NoYW5nZSggZXZlbnQsIGluZGV4ICk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCAkKCBldmVudC50YXJnZXQgKSwgbnVsbCwgInVpLXN0YXRlLWFjdGl2ZSIgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9ICk7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIFNvcnRhYmxlIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBTb3J0YWJsZQ0KLy8+Pmdyb3VwOiBJbnRlcmFjdGlvbnMNCi8vPj5kZXNjcmlwdGlvbjogRW5hYmxlcyBpdGVtcyBpbiBhIGxpc3QgdG8gYmUgc29ydGVkIHVzaW5nIHRoZSBtb3VzZS4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9zb3J0YWJsZS8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9zb3J0YWJsZS8NCi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9zb3J0YWJsZS5jc3MNCg0KDQoNCiAgICB2YXIgd2lkZ2V0c1NvcnRhYmxlID0gJC53aWRnZXQoICJ1aS5zb3J0YWJsZSIsICQudWkubW91c2UsIHsNCiAgICAgICAgdmVyc2lvbjogIjEuMTIuMSIsDQogICAgICAgIHdpZGdldEV2ZW50UHJlZml4OiAic29ydCIsDQogICAgICAgIHJlYWR5OiBmYWxzZSwNCiAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgYXBwZW5kVG86ICJwYXJlbnQiLA0KICAgICAgICAgICAgYXhpczogZmFsc2UsDQogICAgICAgICAgICBjb25uZWN0V2l0aDogZmFsc2UsDQogICAgICAgICAgICBjb250YWlubWVudDogZmFsc2UsDQogICAgICAgICAgICBjdXJzb3I6ICJhdXRvIiwNCiAgICAgICAgICAgIGN1cnNvckF0OiBmYWxzZSwNCiAgICAgICAgICAgIGRyb3BPbkVtcHR5OiB0cnVlLA0KICAgICAgICAgICAgZm9yY2VQbGFjZWhvbGRlclNpemU6IGZhbHNlLA0KICAgICAgICAgICAgZm9yY2VIZWxwZXJTaXplOiBmYWxzZSwNCiAgICAgICAgICAgIGdyaWQ6IGZhbHNlLA0KICAgICAgICAgICAgaGFuZGxlOiBmYWxzZSwNCiAgICAgICAgICAgIGhlbHBlcjogIm9yaWdpbmFsIiwNCiAgICAgICAgICAgIGl0ZW1zOiAiPiAqIiwNCiAgICAgICAgICAgIG9wYWNpdHk6IGZhbHNlLA0KICAgICAgICAgICAgcGxhY2Vob2xkZXI6IGZhbHNlLA0KICAgICAgICAgICAgcmV2ZXJ0OiBmYWxzZSwNCiAgICAgICAgICAgIHNjcm9sbDogdHJ1ZSwNCiAgICAgICAgICAgIHNjcm9sbFNlbnNpdGl2aXR5OiAyMCwNCiAgICAgICAgICAgIHNjcm9sbFNwZWVkOiAyMCwNCiAgICAgICAgICAgIHNjb3BlOiAiZGVmYXVsdCIsDQogICAgICAgICAgICB0b2xlcmFuY2U6ICJpbnRlcnNlY3QiLA0KICAgICAgICAgICAgekluZGV4OiAxMDAwLA0KDQogICAgICAgICAgICAvLyBDYWxsYmFja3MNCiAgICAgICAgICAgIGFjdGl2YXRlOiBudWxsLA0KICAgICAgICAgICAgYmVmb3JlU3RvcDogbnVsbCwNCiAgICAgICAgICAgIGNoYW5nZTogbnVsbCwNCiAgICAgICAgICAgIGRlYWN0aXZhdGU6IG51bGwsDQogICAgICAgICAgICBvdXQ6IG51bGwsDQogICAgICAgICAgICBvdmVyOiBudWxsLA0KICAgICAgICAgICAgcmVjZWl2ZTogbnVsbCwNCiAgICAgICAgICAgIHJlbW92ZTogbnVsbCwNCiAgICAgICAgICAgIHNvcnQ6IG51bGwsDQogICAgICAgICAgICBzdGFydDogbnVsbCwNCiAgICAgICAgICAgIHN0b3A6IG51bGwsDQogICAgICAgICAgICB1cGRhdGU6IG51bGwNCiAgICAgICAgfSwNCg0KICAgICAgICBfaXNPdmVyQXhpczogZnVuY3Rpb24oIHgsIHJlZmVyZW5jZSwgc2l6ZSApIHsNCiAgICAgICAgICAgIHJldHVybiAoIHggPj0gcmVmZXJlbmNlICkgJiYgKCB4IDwgKCByZWZlcmVuY2UgKyBzaXplICkgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfaXNGbG9hdGluZzogZnVuY3Rpb24oIGl0ZW0gKSB7DQogICAgICAgICAgICByZXR1cm4gKCAvbGVmdHxyaWdodC8gKS50ZXN0KCBpdGVtLmNzcyggImZsb2F0IiApICkgfHwNCiAgICAgICAgICAgICAgICAoIC9pbmxpbmV8dGFibGUtY2VsbC8gKS50ZXN0KCBpdGVtLmNzcyggImRpc3BsYXkiICkgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfY3JlYXRlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyQ2FjaGUgPSB7fTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCAidWktc29ydGFibGUiICk7DQoNCiAgICAgICAgICAgIC8vR2V0IHRoZSBpdGVtcw0KICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7DQoNCiAgICAgICAgICAgIC8vTGV0J3MgZGV0ZXJtaW5lIHRoZSBwYXJlbnQncyBvZmZzZXQNCiAgICAgICAgICAgIHRoaXMub2Zmc2V0ID0gdGhpcy5lbGVtZW50Lm9mZnNldCgpOw0KDQogICAgICAgICAgICAvL0luaXRpYWxpemUgbW91c2UgZXZlbnRzIGZvciBpbnRlcmFjdGlvbg0KICAgICAgICAgICAgdGhpcy5fbW91c2VJbml0KCk7DQoNCiAgICAgICAgICAgIHRoaXMuX3NldEhhbmRsZUNsYXNzTmFtZSgpOw0KDQogICAgICAgICAgICAvL1dlJ3JlIHJlYWR5IHRvIGdvDQogICAgICAgICAgICB0aGlzLnJlYWR5ID0gdHJ1ZTsNCg0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgew0KICAgICAgICAgICAgdGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTsNCg0KICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJoYW5kbGUiICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3NldEhhbmRsZUNsYXNzTmFtZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRIYW5kbGVDbGFzc05hbWU6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMuZWxlbWVudC5maW5kKCAiLnVpLXNvcnRhYmxlLWhhbmRsZSIgKSwgInVpLXNvcnRhYmxlLWhhbmRsZSIgKTsNCiAgICAgICAgICAgICQuZWFjaCggdGhpcy5pdGVtcywgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdGhhdC5fYWRkQ2xhc3MoDQogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5zdGFuY2Uub3B0aW9ucy5oYW5kbGUgPw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtLmZpbmQoIHRoaXMuaW5zdGFuY2Uub3B0aW9ucy5oYW5kbGUgKSA6DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW0sDQogICAgICAgICAgICAgICAgICAgICJ1aS1zb3J0YWJsZS1oYW5kbGUiDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZGVzdHJveTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLl9tb3VzZURlc3Ryb3koKTsNCg0KICAgICAgICAgICAgZm9yICggdmFyIGkgPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tICkgew0KICAgICAgICAgICAgICAgIHRoaXMuaXRlbXNbIGkgXS5pdGVtLnJlbW92ZURhdGEoIHRoaXMud2lkZ2V0TmFtZSArICItaXRlbSIgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgIH0sDQoNCiAgICAgICAgX21vdXNlQ2FwdHVyZTogZnVuY3Rpb24oIGV2ZW50LCBvdmVycmlkZUhhbmRsZSApIHsNCiAgICAgICAgICAgIHZhciBjdXJyZW50SXRlbSA9IG51bGwsDQogICAgICAgICAgICAgICAgdmFsaWRIYW5kbGUgPSBmYWxzZSwNCiAgICAgICAgICAgICAgICB0aGF0ID0gdGhpczsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLnJldmVydGluZyApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmRpc2FibGVkIHx8IHRoaXMub3B0aW9ucy50eXBlID09PSAic3RhdGljIiApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vV2UgaGF2ZSB0byByZWZyZXNoIHRoZSBpdGVtcyBkYXRhIG9uY2UgZmlyc3QNCiAgICAgICAgICAgIHRoaXMuX3JlZnJlc2hJdGVtcyggZXZlbnQgKTsNCg0KICAgICAgICAgICAgLy9GaW5kIG91dCBpZiB0aGUgY2xpY2tlZCBub2RlIChvciBvbmUgb2YgaXRzIHBhcmVudHMpIGlzIGEgYWN0dWFsIGl0ZW0gaW4gdGhpcy5pdGVtcw0KICAgICAgICAgICAgJCggZXZlbnQudGFyZ2V0ICkucGFyZW50cygpLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGlmICggJC5kYXRhKCB0aGlzLCB0aGF0LndpZGdldE5hbWUgKyAiLWl0ZW0iICkgPT09IHRoYXQgKSB7DQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVtID0gJCggdGhpcyApOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgaWYgKCAkLmRhdGEoIGV2ZW50LnRhcmdldCwgdGhhdC53aWRnZXROYW1lICsgIi1pdGVtIiApID09PSB0aGF0ICkgew0KICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVtID0gJCggZXZlbnQudGFyZ2V0ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggIWN1cnJlbnRJdGVtICkgew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmhhbmRsZSAmJiAhb3ZlcnJpZGVIYW5kbGUgKSB7DQogICAgICAgICAgICAgICAgJCggdGhpcy5vcHRpb25zLmhhbmRsZSwgY3VycmVudEl0ZW0gKS5maW5kKCAiKiIgKS5hZGRCYWNrKCkuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggdGhpcyA9PT0gZXZlbnQudGFyZ2V0ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRIYW5kbGUgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIGlmICggIXZhbGlkSGFuZGxlICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLmN1cnJlbnRJdGVtID0gY3VycmVudEl0ZW07DQogICAgICAgICAgICB0aGlzLl9yZW1vdmVDdXJyZW50c0Zyb21JdGVtcygpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBfbW91c2VTdGFydDogZnVuY3Rpb24oIGV2ZW50LCBvdmVycmlkZUhhbmRsZSwgbm9BY3RpdmF0aW9uICkgew0KDQogICAgICAgICAgICB2YXIgaSwgYm9keSwNCiAgICAgICAgICAgICAgICBvID0gdGhpcy5vcHRpb25zOw0KDQogICAgICAgICAgICB0aGlzLmN1cnJlbnRDb250YWluZXIgPSB0aGlzOw0KDQogICAgICAgICAgICAvL1dlIG9ubHkgbmVlZCB0byBjYWxsIHJlZnJlc2hQb3NpdGlvbnMsIGJlY2F1c2UgdGhlIHJlZnJlc2hJdGVtcyBjYWxsIGhhcyBiZWVuIG1vdmVkIHRvDQogICAgICAgICAgICAvLyBtb3VzZUNhcHR1cmUNCiAgICAgICAgICAgIHRoaXMucmVmcmVzaFBvc2l0aW9ucygpOw0KDQogICAgICAgICAgICAvL0NyZWF0ZSBhbmQgYXBwZW5kIHRoZSB2aXNpYmxlIGhlbHBlcg0KICAgICAgICAgICAgdGhpcy5oZWxwZXIgPSB0aGlzLl9jcmVhdGVIZWxwZXIoIGV2ZW50ICk7DQoNCiAgICAgICAgICAgIC8vQ2FjaGUgdGhlIGhlbHBlciBzaXplDQogICAgICAgICAgICB0aGlzLl9jYWNoZUhlbHBlclByb3BvcnRpb25zKCk7DQoNCiAgICAgICAgICAgIC8qDQoJCSAqIC0gUG9zaXRpb24gZ2VuZXJhdGlvbiAtDQoJCSAqIFRoaXMgYmxvY2sgZ2VuZXJhdGVzIGV2ZXJ5dGhpbmcgcG9zaXRpb24gcmVsYXRlZCAtIGl0J3MgdGhlIGNvcmUgb2YgZHJhZ2dhYmxlcy4NCgkJICovDQoNCiAgICAgICAgICAgIC8vQ2FjaGUgdGhlIG1hcmdpbnMgb2YgdGhlIG9yaWdpbmFsIGVsZW1lbnQNCiAgICAgICAgICAgIHRoaXMuX2NhY2hlTWFyZ2lucygpOw0KDQogICAgICAgICAgICAvL0dldCB0aGUgbmV4dCBzY3JvbGxpbmcgcGFyZW50DQogICAgICAgICAgICB0aGlzLnNjcm9sbFBhcmVudCA9IHRoaXMuaGVscGVyLnNjcm9sbFBhcmVudCgpOw0KDQogICAgICAgICAgICAvL1RoZSBlbGVtZW50J3MgYWJzb2x1dGUgcG9zaXRpb24gb24gdGhlIHBhZ2UgbWludXMgbWFyZ2lucw0KICAgICAgICAgICAgdGhpcy5vZmZzZXQgPSB0aGlzLmN1cnJlbnRJdGVtLm9mZnNldCgpOw0KICAgICAgICAgICAgdGhpcy5vZmZzZXQgPSB7DQogICAgICAgICAgICAgICAgdG9wOiB0aGlzLm9mZnNldC50b3AgLSB0aGlzLm1hcmdpbnMudG9wLA0KICAgICAgICAgICAgICAgIGxlZnQ6IHRoaXMub2Zmc2V0LmxlZnQgLSB0aGlzLm1hcmdpbnMubGVmdA0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgJC5leHRlbmQoIHRoaXMub2Zmc2V0LCB7DQogICAgICAgICAgICAgICAgY2xpY2s6IHsgLy9XaGVyZSB0aGUgY2xpY2sgaGFwcGVuZWQsIHJlbGF0aXZlIHRvIHRoZSBlbGVtZW50DQogICAgICAgICAgICAgICAgICAgIGxlZnQ6IGV2ZW50LnBhZ2VYIC0gdGhpcy5vZmZzZXQubGVmdCwNCiAgICAgICAgICAgICAgICAgICAgdG9wOiBldmVudC5wYWdlWSAtIHRoaXMub2Zmc2V0LnRvcA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgcGFyZW50OiB0aGlzLl9nZXRQYXJlbnRPZmZzZXQoKSwNCg0KICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgYSByZWxhdGl2ZSB0byBhYnNvbHV0ZSBwb3NpdGlvbiBtaW51cyB0aGUgYWN0dWFsIHBvc2l0aW9uIGNhbGN1bGF0aW9uIC0NCiAgICAgICAgICAgICAgICAvLyBvbmx5IHVzZWQgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgaGVscGVyDQogICAgICAgICAgICAgICAgcmVsYXRpdmU6IHRoaXMuX2dldFJlbGF0aXZlT2Zmc2V0KCkNCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgLy8gT25seSBhZnRlciB3ZSBnb3QgdGhlIG9mZnNldCwgd2UgY2FuIGNoYW5nZSB0aGUgaGVscGVyJ3MgcG9zaXRpb24gdG8gYWJzb2x1dGUNCiAgICAgICAgICAgIC8vIFRPRE86IFN0aWxsIG5lZWQgdG8gZmlndXJlIG91dCBhIHdheSB0byBtYWtlIHJlbGF0aXZlIHNvcnRpbmcgcG9zc2libGUNCiAgICAgICAgICAgIHRoaXMuaGVscGVyLmNzcyggInBvc2l0aW9uIiwgImFic29sdXRlIiApOw0KICAgICAgICAgICAgdGhpcy5jc3NQb3NpdGlvbiA9IHRoaXMuaGVscGVyLmNzcyggInBvc2l0aW9uIiApOw0KDQogICAgICAgICAgICAvL0dlbmVyYXRlIHRoZSBvcmlnaW5hbCBwb3NpdGlvbg0KICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFBvc2l0aW9uID0gdGhpcy5fZ2VuZXJhdGVQb3NpdGlvbiggZXZlbnQgKTsNCiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxQYWdlWCA9IGV2ZW50LnBhZ2VYOw0KICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFBhZ2VZID0gZXZlbnQucGFnZVk7DQoNCiAgICAgICAgICAgIC8vQWRqdXN0IHRoZSBtb3VzZSBvZmZzZXQgcmVsYXRpdmUgdG8gdGhlIGhlbHBlciBpZiAiY3Vyc29yQXQiIGlzIHN1cHBsaWVkDQogICAgICAgICAgICAoIG8uY3Vyc29yQXQgJiYgdGhpcy5fYWRqdXN0T2Zmc2V0RnJvbUhlbHBlciggby5jdXJzb3JBdCApICk7DQoNCiAgICAgICAgICAgIC8vQ2FjaGUgdGhlIGZvcm1lciBET00gcG9zaXRpb24NCiAgICAgICAgICAgIHRoaXMuZG9tUG9zaXRpb24gPSB7DQogICAgICAgICAgICAgICAgcHJldjogdGhpcy5jdXJyZW50SXRlbS5wcmV2KClbIDAgXSwNCiAgICAgICAgICAgICAgICBwYXJlbnQ6IHRoaXMuY3VycmVudEl0ZW0ucGFyZW50KClbIDAgXQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgLy8gSWYgdGhlIGhlbHBlciBpcyBub3QgdGhlIG9yaWdpbmFsLCBoaWRlIHRoZSBvcmlnaW5hbCBzbyBpdCdzIG5vdCBwbGF5aW5nIGFueSByb2xlIGR1cmluZw0KICAgICAgICAgICAgLy8gdGhlIGRyYWcsIHdvbid0IGNhdXNlIGFueXRoaW5nIGJhZCB0aGlzIHdheQ0KICAgICAgICAgICAgaWYgKCB0aGlzLmhlbHBlclsgMCBdICE9PSB0aGlzLmN1cnJlbnRJdGVtWyAwIF0gKSB7DQogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SXRlbS5oaWRlKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vQ3JlYXRlIHRoZSBwbGFjZWhvbGRlcg0KICAgICAgICAgICAgdGhpcy5fY3JlYXRlUGxhY2Vob2xkZXIoKTsNCg0KICAgICAgICAgICAgLy9TZXQgYSBjb250YWlubWVudCBpZiBnaXZlbiBpbiB0aGUgb3B0aW9ucw0KICAgICAgICAgICAgaWYgKCBvLmNvbnRhaW5tZW50ICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3NldENvbnRhaW5tZW50KCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggby5jdXJzb3IgJiYgby5jdXJzb3IgIT09ICJhdXRvIiApIHsgLy8gY3Vyc29yIG9wdGlvbg0KICAgICAgICAgICAgICAgIGJvZHkgPSB0aGlzLmRvY3VtZW50LmZpbmQoICJib2R5IiApOw0KDQogICAgICAgICAgICAgICAgLy8gU3VwcG9ydDogSUUNCiAgICAgICAgICAgICAgICB0aGlzLnN0b3JlZEN1cnNvciA9IGJvZHkuY3NzKCAiY3Vyc29yIiApOw0KICAgICAgICAgICAgICAgIGJvZHkuY3NzKCAiY3Vyc29yIiwgby5jdXJzb3IgKTsNCg0KICAgICAgICAgICAgICAgIHRoaXMuc3RvcmVkU3R5bGVzaGVldCA9DQogICAgICAgICAgICAgICAgICAgICQoICI8c3R5bGU+KnsgY3Vyc29yOiAiICsgby5jdXJzb3IgKyAiICFpbXBvcnRhbnQ7IH08L3N0eWxlPiIgKS5hcHBlbmRUbyggYm9keSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIG8ub3BhY2l0eSApIHsgLy8gb3BhY2l0eSBvcHRpb24NCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuaGVscGVyLmNzcyggIm9wYWNpdHkiICkgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0b3JlZE9wYWNpdHkgPSB0aGlzLmhlbHBlci5jc3MoICJvcGFjaXR5IiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLmhlbHBlci5jc3MoICJvcGFjaXR5Iiwgby5vcGFjaXR5ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggby56SW5kZXggKSB7IC8vIHpJbmRleCBvcHRpb24NCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuaGVscGVyLmNzcyggInpJbmRleCIgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RvcmVkWkluZGV4ID0gdGhpcy5oZWxwZXIuY3NzKCAiekluZGV4IiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLmhlbHBlci5jc3MoICJ6SW5kZXgiLCBvLnpJbmRleCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvL1ByZXBhcmUgc2Nyb2xsaW5nDQogICAgICAgICAgICBpZiAoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gIT09IHRoaXMuZG9jdW1lbnRbIDAgXSAmJg0KICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0udGFnTmFtZSAhPT0gIkhUTUwiICkgew0KICAgICAgICAgICAgICAgIHRoaXMub3ZlcmZsb3dPZmZzZXQgPSB0aGlzLnNjcm9sbFBhcmVudC5vZmZzZXQoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy9DYWxsIGNhbGxiYWNrcw0KICAgICAgICAgICAgdGhpcy5fdHJpZ2dlciggInN0YXJ0IiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpICk7DQoNCiAgICAgICAgICAgIC8vUmVjYWNoZSB0aGUgaGVscGVyIHNpemUNCiAgICAgICAgICAgIGlmICggIXRoaXMuX3ByZXNlcnZlSGVscGVyUHJvcG9ydGlvbnMgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fY2FjaGVIZWxwZXJQcm9wb3J0aW9ucygpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvL1Bvc3QgImFjdGl2YXRlIiBldmVudHMgdG8gcG9zc2libGUgY29udGFpbmVycw0KICAgICAgICAgICAgaWYgKCAhbm9BY3RpdmF0aW9uICkgew0KICAgICAgICAgICAgICAgIGZvciAoIGkgPSB0aGlzLmNvbnRhaW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyc1sgaSBdLl90cmlnZ2VyKCAiYWN0aXZhdGUiLCBldmVudCwgdGhpcy5fdWlIYXNoKCB0aGlzICkgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vUHJlcGFyZSBwb3NzaWJsZSBkcm9wcGFibGVzDQogICAgICAgICAgICBpZiAoICQudWkuZGRtYW5hZ2VyICkgew0KICAgICAgICAgICAgICAgICQudWkuZGRtYW5hZ2VyLmN1cnJlbnQgPSB0aGlzOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoICQudWkuZGRtYW5hZ2VyICYmICFvLmRyb3BCZWhhdmlvdXIgKSB7DQogICAgICAgICAgICAgICAgJC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHMoIHRoaXMsIGV2ZW50ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuZHJhZ2dpbmcgPSB0cnVlOw0KDQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy5oZWxwZXIsICJ1aS1zb3J0YWJsZS1oZWxwZXIiICk7DQoNCiAgICAgICAgICAgIC8vIEV4ZWN1dGUgdGhlIGRyYWcgb25jZSAtIHRoaXMgY2F1c2VzIHRoZSBoZWxwZXIgbm90IHRvIGJlIHZpc2libGViZWZvcmUgZ2V0dGluZyBpdHMNCiAgICAgICAgICAgIC8vIGNvcnJlY3QgcG9zaXRpb24NCiAgICAgICAgICAgIHRoaXMuX21vdXNlRHJhZyggZXZlbnQgKTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KDQogICAgICAgIH0sDQoNCiAgICAgICAgX21vdXNlRHJhZzogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgdmFyIGksIGl0ZW0sIGl0ZW1FbGVtZW50LCBpbnRlcnNlY3Rpb24sDQogICAgICAgICAgICAgICAgbyA9IHRoaXMub3B0aW9ucywNCiAgICAgICAgICAgICAgICBzY3JvbGxlZCA9IGZhbHNlOw0KDQogICAgICAgICAgICAvL0NvbXB1dGUgdGhlIGhlbHBlcnMgcG9zaXRpb24NCiAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSB0aGlzLl9nZW5lcmF0ZVBvc2l0aW9uKCBldmVudCApOw0KICAgICAgICAgICAgdGhpcy5wb3NpdGlvbkFicyA9IHRoaXMuX2NvbnZlcnRQb3NpdGlvblRvKCAiYWJzb2x1dGUiICk7DQoNCiAgICAgICAgICAgIGlmICggIXRoaXMubGFzdFBvc2l0aW9uQWJzICkgew0KICAgICAgICAgICAgICAgIHRoaXMubGFzdFBvc2l0aW9uQWJzID0gdGhpcy5wb3NpdGlvbkFiczsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy9EbyBzY3JvbGxpbmcNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLnNjcm9sbCApIHsNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gIT09IHRoaXMuZG9jdW1lbnRbIDAgXSAmJg0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFBhcmVudFsgMCBdLnRhZ05hbWUgIT09ICJIVE1MIiApIHsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoICggdGhpcy5vdmVyZmxvd09mZnNldC50b3AgKyB0aGlzLnNjcm9sbFBhcmVudFsgMCBdLm9mZnNldEhlaWdodCApIC0NCiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnBhZ2VZIDwgby5zY3JvbGxTZW5zaXRpdml0eSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0uc2Nyb2xsVG9wID0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxlZCA9IHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0uc2Nyb2xsVG9wICsgby5zY3JvbGxTcGVlZDsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggZXZlbnQucGFnZVkgLSB0aGlzLm92ZXJmbG93T2Zmc2V0LnRvcCA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFBhcmVudFsgMCBdLnNjcm9sbFRvcCA9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsZWQgPSB0aGlzLnNjcm9sbFBhcmVudFsgMCBdLnNjcm9sbFRvcCAtIG8uc2Nyb2xsU3BlZWQ7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZiAoICggdGhpcy5vdmVyZmxvd09mZnNldC5sZWZ0ICsgdGhpcy5zY3JvbGxQYXJlbnRbIDAgXS5vZmZzZXRXaWR0aCApIC0NCiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnBhZ2VYIDwgby5zY3JvbGxTZW5zaXRpdml0eSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0uc2Nyb2xsTGVmdCA9IHNjcm9sbGVkID0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFBhcmVudFsgMCBdLnNjcm9sbExlZnQgKyBvLnNjcm9sbFNwZWVkOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBldmVudC5wYWdlWCAtIHRoaXMub3ZlcmZsb3dPZmZzZXQubGVmdCA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFBhcmVudFsgMCBdLnNjcm9sbExlZnQgPSBzY3JvbGxlZCA9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxQYXJlbnRbIDAgXS5zY3JvbGxMZWZ0IC0gby5zY3JvbGxTcGVlZDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoIGV2ZW50LnBhZ2VZIC0gdGhpcy5kb2N1bWVudC5zY3JvbGxUb3AoKSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxlZCA9IHRoaXMuZG9jdW1lbnQuc2Nyb2xsVG9wKCB0aGlzLmRvY3VtZW50LnNjcm9sbFRvcCgpIC0gby5zY3JvbGxTcGVlZCApOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB0aGlzLndpbmRvdy5oZWlnaHQoKSAtICggZXZlbnQucGFnZVkgLSB0aGlzLmRvY3VtZW50LnNjcm9sbFRvcCgpICkgPA0KICAgICAgICAgICAgICAgICAgICAgICAgby5zY3JvbGxTZW5zaXRpdml0eSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbGVkID0gdGhpcy5kb2N1bWVudC5zY3JvbGxUb3AoIHRoaXMuZG9jdW1lbnQuc2Nyb2xsVG9wKCkgKyBvLnNjcm9sbFNwZWVkICk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZiAoIGV2ZW50LnBhZ2VYIC0gdGhpcy5kb2N1bWVudC5zY3JvbGxMZWZ0KCkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsZWQgPSB0aGlzLmRvY3VtZW50LnNjcm9sbExlZnQoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudC5zY3JvbGxMZWZ0KCkgLSBvLnNjcm9sbFNwZWVkDQogICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB0aGlzLndpbmRvdy53aWR0aCgpIC0gKCBldmVudC5wYWdlWCAtIHRoaXMuZG9jdW1lbnQuc2Nyb2xsTGVmdCgpICkgPA0KICAgICAgICAgICAgICAgICAgICAgICAgby5zY3JvbGxTZW5zaXRpdml0eSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbGVkID0gdGhpcy5kb2N1bWVudC5zY3JvbGxMZWZ0KA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQuc2Nyb2xsTGVmdCgpICsgby5zY3JvbGxTcGVlZA0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCBzY3JvbGxlZCAhPT0gZmFsc2UgJiYgJC51aS5kZG1hbmFnZXIgJiYgIW8uZHJvcEJlaGF2aW91ciApIHsNCiAgICAgICAgICAgICAgICAgICAgJC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHMoIHRoaXMsIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvL1JlZ2VuZXJhdGUgdGhlIGFic29sdXRlIHBvc2l0aW9uIHVzZWQgZm9yIHBvc2l0aW9uIGNoZWNrcw0KICAgICAgICAgICAgdGhpcy5wb3NpdGlvbkFicyA9IHRoaXMuX2NvbnZlcnRQb3NpdGlvblRvKCAiYWJzb2x1dGUiICk7DQoNCiAgICAgICAgICAgIC8vU2V0IHRoZSBoZWxwZXIgcG9zaXRpb24NCiAgICAgICAgICAgIGlmICggIXRoaXMub3B0aW9ucy5heGlzIHx8IHRoaXMub3B0aW9ucy5heGlzICE9PSAieSIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5oZWxwZXJbIDAgXS5zdHlsZS5sZWZ0ID0gdGhpcy5wb3NpdGlvbi5sZWZ0ICsgInB4IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggIXRoaXMub3B0aW9ucy5heGlzIHx8IHRoaXMub3B0aW9ucy5heGlzICE9PSAieCIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5oZWxwZXJbIDAgXS5zdHlsZS50b3AgPSB0aGlzLnBvc2l0aW9uLnRvcCArICJweCI7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vUmVhcnJhbmdlDQogICAgICAgICAgICBmb3IgKCBpID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSApIHsNCg0KICAgICAgICAgICAgICAgIC8vQ2FjaGUgdmFyaWFibGVzIGFuZCBpbnRlcnNlY3Rpb24sIGNvbnRpbnVlIGlmIG5vIGludGVyc2VjdGlvbg0KICAgICAgICAgICAgICAgIGl0ZW0gPSB0aGlzLml0ZW1zWyBpIF07DQogICAgICAgICAgICAgICAgaXRlbUVsZW1lbnQgPSBpdGVtLml0ZW1bIDAgXTsNCiAgICAgICAgICAgICAgICBpbnRlcnNlY3Rpb24gPSB0aGlzLl9pbnRlcnNlY3RzV2l0aFBvaW50ZXIoIGl0ZW0gKTsNCiAgICAgICAgICAgICAgICBpZiAoICFpbnRlcnNlY3Rpb24gKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIE9ubHkgcHV0IHRoZSBwbGFjZWhvbGRlciBpbnNpZGUgdGhlIGN1cnJlbnQgQ29udGFpbmVyLCBza2lwIGFsbA0KICAgICAgICAgICAgICAgIC8vIGl0ZW1zIGZyb20gb3RoZXIgY29udGFpbmVycy4gVGhpcyB3b3JrcyBiZWNhdXNlIHdoZW4gbW92aW5nDQogICAgICAgICAgICAgICAgLy8gYW4gaXRlbSBmcm9tIG9uZSBjb250YWluZXIgdG8gYW5vdGhlciB0aGUNCiAgICAgICAgICAgICAgICAvLyBjdXJyZW50Q29udGFpbmVyIGlzIHN3aXRjaGVkIGJlZm9yZSB0aGUgcGxhY2Vob2xkZXIgaXMgbW92ZWQuDQogICAgICAgICAgICAgICAgLy8NCiAgICAgICAgICAgICAgICAvLyBXaXRob3V0IHRoaXMsIG1vdmluZyBpdGVtcyBpbiAic3ViLXNvcnRhYmxlcyIgY2FuIGNhdXNlDQogICAgICAgICAgICAgICAgLy8gdGhlIHBsYWNlaG9sZGVyIHRvIGppdHRlciBiZXR3ZWVuIHRoZSBvdXRlciBhbmQgaW5uZXIgY29udGFpbmVyLg0KICAgICAgICAgICAgICAgIGlmICggaXRlbS5pbnN0YW5jZSAhPT0gdGhpcy5jdXJyZW50Q29udGFpbmVyICkgew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBDYW5ub3QgaW50ZXJzZWN0IHdpdGggaXRzZWxmDQogICAgICAgICAgICAgICAgLy8gbm8gdXNlbGVzcyBhY3Rpb25zIHRoYXQgaGF2ZSBiZWVuIGRvbmUgYmVmb3JlDQogICAgICAgICAgICAgICAgLy8gbm8gYWN0aW9uIGlmIHRoZSBpdGVtIG1vdmVkIGlzIHRoZSBwYXJlbnQgb2YgdGhlIGl0ZW0gY2hlY2tlZA0KICAgICAgICAgICAgICAgIGlmICggaXRlbUVsZW1lbnQgIT09IHRoaXMuY3VycmVudEl0ZW1bIDAgXSAmJg0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYWNlaG9sZGVyWyBpbnRlcnNlY3Rpb24gPT09IDEgPyAibmV4dCIgOiAicHJldiIgXSgpWyAwIF0gIT09IGl0ZW1FbGVtZW50ICYmDQogICAgICAgICAgICAgICAgICAgICEkLmNvbnRhaW5zKCB0aGlzLnBsYWNlaG9sZGVyWyAwIF0sIGl0ZW1FbGVtZW50ICkgJiYNCiAgICAgICAgICAgICAgICAgICAgKCB0aGlzLm9wdGlvbnMudHlwZSA9PT0gInNlbWktZHluYW1pYyIgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICEkLmNvbnRhaW5zKCB0aGlzLmVsZW1lbnRbIDAgXSwgaXRlbUVsZW1lbnQgKSA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICAgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBpbnRlcnNlY3Rpb24gPT09IDEgPyAiZG93biIgOiAidXAiOw0KDQogICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLnRvbGVyYW5jZSA9PT0gInBvaW50ZXIiIHx8IHRoaXMuX2ludGVyc2VjdHNXaXRoU2lkZXMoIGl0ZW0gKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlYXJyYW5nZSggZXZlbnQsIGl0ZW0gKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdHJpZ2dlciggImNoYW5nZSIsIGV2ZW50LCB0aGlzLl91aUhhc2goKSApOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vUG9zdCBldmVudHMgdG8gY29udGFpbmVycw0KICAgICAgICAgICAgdGhpcy5fY29udGFjdENvbnRhaW5lcnMoIGV2ZW50ICk7DQoNCiAgICAgICAgICAgIC8vSW50ZXJjb25uZWN0IHdpdGggZHJvcHBhYmxlcw0KICAgICAgICAgICAgaWYgKCAkLnVpLmRkbWFuYWdlciApIHsNCiAgICAgICAgICAgICAgICAkLnVpLmRkbWFuYWdlci5kcmFnKCB0aGlzLCBldmVudCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvL0NhbGwgY2FsbGJhY2tzDQogICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAic29ydCIsIGV2ZW50LCB0aGlzLl91aUhhc2goKSApOw0KDQogICAgICAgICAgICB0aGlzLmxhc3RQb3NpdGlvbkFicyA9IHRoaXMucG9zaXRpb25BYnM7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBfbW91c2VTdG9wOiBmdW5jdGlvbiggZXZlbnQsIG5vUHJvcGFnYXRpb24gKSB7DQoNCiAgICAgICAgICAgIGlmICggIWV2ZW50ICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy9JZiB3ZSBhcmUgdXNpbmcgZHJvcHBhYmxlcywgaW5mb3JtIHRoZSBtYW5hZ2VyIGFib3V0IHRoZSBkcm9wDQogICAgICAgICAgICBpZiAoICQudWkuZGRtYW5hZ2VyICYmICF0aGlzLm9wdGlvbnMuZHJvcEJlaGF2aW91ciApIHsNCiAgICAgICAgICAgICAgICAkLnVpLmRkbWFuYWdlci5kcm9wKCB0aGlzLCBldmVudCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5yZXZlcnQgKSB7DQogICAgICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICAgICAgICAgICBjdXIgPSB0aGlzLnBsYWNlaG9sZGVyLm9mZnNldCgpLA0KICAgICAgICAgICAgICAgICAgICBheGlzID0gdGhpcy5vcHRpb25zLmF4aXMsDQogICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IHt9Ow0KDQogICAgICAgICAgICAgICAgaWYgKCAhYXhpcyB8fCBheGlzID09PSAieCIgKSB7DQogICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5sZWZ0ID0gY3VyLmxlZnQgLSB0aGlzLm9mZnNldC5wYXJlbnQubGVmdCAtIHRoaXMubWFyZ2lucy5sZWZ0ICsNCiAgICAgICAgICAgICAgICAgICAgICAgICggdGhpcy5vZmZzZXRQYXJlbnRbIDAgXSA9PT0gdGhpcy5kb2N1bWVudFsgMCBdLmJvZHkgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXRQYXJlbnRbIDAgXS5zY3JvbGxMZWZ0DQogICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoICFheGlzIHx8IGF4aXMgPT09ICJ5IiApIHsNCiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnRvcCA9IGN1ci50b3AgLSB0aGlzLm9mZnNldC5wYXJlbnQudG9wIC0gdGhpcy5tYXJnaW5zLnRvcCArDQogICAgICAgICAgICAgICAgICAgICAgICAoIHRoaXMub2Zmc2V0UGFyZW50WyAwIF0gPT09IHRoaXMuZG9jdW1lbnRbIDAgXS5ib2R5ID8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0UGFyZW50WyAwIF0uc2Nyb2xsVG9wDQogICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLnJldmVydGluZyA9IHRydWU7DQogICAgICAgICAgICAgICAgJCggdGhpcy5oZWxwZXIgKS5hbmltYXRlKA0KICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24sDQogICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KCB0aGlzLm9wdGlvbnMucmV2ZXJ0LCAxMCApIHx8IDUwMCwNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9jbGVhciggZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuX2NsZWFyKCBldmVudCwgbm9Qcm9wYWdhdGlvbiApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBjYW5jZWw6IGZ1bmN0aW9uKCkgew0KDQogICAgICAgICAgICBpZiAoIHRoaXMuZHJhZ2dpbmcgKSB7DQoNCiAgICAgICAgICAgICAgICB0aGlzLl9tb3VzZVVwKCBuZXcgJC5FdmVudCggIm1vdXNldXAiLCB7IHRhcmdldDogbnVsbCB9ICkgKTsNCg0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmhlbHBlciA9PT0gIm9yaWdpbmFsIiApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SXRlbS5jc3MoIHRoaXMuX3N0b3JlZENTUyApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5jdXJyZW50SXRlbSwgInVpLXNvcnRhYmxlLWhlbHBlciIgKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRJdGVtLnNob3coKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvL1Bvc3QgZGVhY3RpdmF0aW5nIGV2ZW50cyB0byBjb250YWluZXJzDQogICAgICAgICAgICAgICAgZm9yICggdmFyIGkgPSB0aGlzLmNvbnRhaW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyc1sgaSBdLl90cmlnZ2VyKCAiZGVhY3RpdmF0ZSIsIG51bGwsIHRoaXMuX3VpSGFzaCggdGhpcyApICk7DQogICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5jb250YWluZXJzWyBpIF0uY29udGFpbmVyQ2FjaGUub3ZlciApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyc1sgaSBdLl90cmlnZ2VyKCAib3V0IiwgbnVsbCwgdGhpcy5fdWlIYXNoKCB0aGlzICkgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyc1sgaSBdLmNvbnRhaW5lckNhY2hlLm92ZXIgPSAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5wbGFjZWhvbGRlciApIHsNCg0KICAgICAgICAgICAgICAgIC8vJCh0aGlzLnBsYWNlaG9sZGVyWzBdKS5yZW1vdmUoKTsgd291bGQgaGF2ZSBiZWVuIHRoZSBqUXVlcnkgd2F5IC0gdW5mb3J0dW5hdGVseSwNCiAgICAgICAgICAgICAgICAvLyBpdCB1bmJpbmRzIEFMTCBldmVudHMgZnJvbSB0aGUgb3JpZ2luYWwgbm9kZSENCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMucGxhY2Vob2xkZXJbIDAgXS5wYXJlbnROb2RlICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYWNlaG9sZGVyWyAwIF0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggdGhpcy5wbGFjZWhvbGRlclsgMCBdICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmhlbHBlciAhPT0gIm9yaWdpbmFsIiAmJiB0aGlzLmhlbHBlciAmJg0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhlbHBlclsgMCBdLnBhcmVudE5vZGUgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaGVscGVyLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICQuZXh0ZW5kKCB0aGlzLCB7DQogICAgICAgICAgICAgICAgICAgIGhlbHBlcjogbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgZHJhZ2dpbmc6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICByZXZlcnRpbmc6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICBfbm9GaW5hbFNvcnQ6IG51bGwNCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuZG9tUG9zaXRpb24ucHJldiApIHsNCiAgICAgICAgICAgICAgICAgICAgJCggdGhpcy5kb21Qb3NpdGlvbi5wcmV2ICkuYWZ0ZXIoIHRoaXMuY3VycmVudEl0ZW0gKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAkKCB0aGlzLmRvbVBvc2l0aW9uLnBhcmVudCApLnByZXBlbmQoIHRoaXMuY3VycmVudEl0ZW0gKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiB0aGlzOw0KDQogICAgICAgIH0sDQoNCiAgICAgICAgc2VyaWFsaXplOiBmdW5jdGlvbiggbyApIHsNCg0KICAgICAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5fZ2V0SXRlbXNBc2pRdWVyeSggbyAmJiBvLmNvbm5lY3RlZCApLA0KICAgICAgICAgICAgICAgIHN0ciA9IFtdOw0KICAgICAgICAgICAgbyA9IG8gfHwge307DQoNCiAgICAgICAgICAgICQoIGl0ZW1zICkuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIHJlcyA9ICggJCggby5pdGVtIHx8IHRoaXMgKS5hdHRyKCBvLmF0dHJpYnV0ZSB8fCAiaWQiICkgfHwgIiIgKQ0KICAgICAgICAgICAgICAgICAgICAubWF0Y2goIG8uZXhwcmVzc2lvbiB8fCAoIC8oLispW1wtPV9dKC4rKS8gKSApOw0KICAgICAgICAgICAgICAgIGlmICggcmVzICkgew0KICAgICAgICAgICAgICAgICAgICBzdHIucHVzaCgNCiAgICAgICAgICAgICAgICAgICAgICAgICggby5rZXkgfHwgcmVzWyAxIF0gKyAiW10iICkgKw0KICAgICAgICAgICAgICAgICAgICAgICAgIj0iICsgKCBvLmtleSAmJiBvLmV4cHJlc3Npb24gPyByZXNbIDEgXSA6IHJlc1sgMiBdICkgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIGlmICggIXN0ci5sZW5ndGggJiYgby5rZXkgKSB7DQogICAgICAgICAgICAgICAgc3RyLnB1c2goIG8ua2V5ICsgIj0iICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBzdHIuam9pbiggIiYiICk7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICB0b0FycmF5OiBmdW5jdGlvbiggbyApIHsNCg0KICAgICAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5fZ2V0SXRlbXNBc2pRdWVyeSggbyAmJiBvLmNvbm5lY3RlZCApLA0KICAgICAgICAgICAgICAgIHJldCA9IFtdOw0KDQogICAgICAgICAgICBvID0gbyB8fCB7fTsNCg0KICAgICAgICAgICAgaXRlbXMuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0LnB1c2goICQoIG8uaXRlbSB8fCB0aGlzICkuYXR0ciggby5hdHRyaWJ1dGUgfHwgImlkIiApIHx8ICIiICk7DQogICAgICAgICAgICB9ICk7DQogICAgICAgICAgICByZXR1cm4gcmV0Ow0KDQogICAgICAgIH0sDQoNCiAgICAgICAgLyogQmUgY2FyZWZ1bCB3aXRoIHRoZSBmb2xsb3dpbmcgY29yZSBmdW5jdGlvbnMgKi8NCiAgICAgICAgX2ludGVyc2VjdHNXaXRoOiBmdW5jdGlvbiggaXRlbSApIHsNCg0KICAgICAgICAgICAgdmFyIHgxID0gdGhpcy5wb3NpdGlvbkFicy5sZWZ0LA0KICAgICAgICAgICAgICAgIHgyID0geDEgKyB0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoLA0KICAgICAgICAgICAgICAgIHkxID0gdGhpcy5wb3NpdGlvbkFicy50b3AsDQogICAgICAgICAgICAgICAgeTIgPSB5MSArIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LA0KICAgICAgICAgICAgICAgIGwgPSBpdGVtLmxlZnQsDQogICAgICAgICAgICAgICAgciA9IGwgKyBpdGVtLndpZHRoLA0KICAgICAgICAgICAgICAgIHQgPSBpdGVtLnRvcCwNCiAgICAgICAgICAgICAgICBiID0gdCArIGl0ZW0uaGVpZ2h0LA0KICAgICAgICAgICAgICAgIGR5Q2xpY2sgPSB0aGlzLm9mZnNldC5jbGljay50b3AsDQogICAgICAgICAgICAgICAgZHhDbGljayA9IHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQsDQogICAgICAgICAgICAgICAgaXNPdmVyRWxlbWVudEhlaWdodCA9ICggdGhpcy5vcHRpb25zLmF4aXMgPT09ICJ4IiApIHx8ICggKCB5MSArIGR5Q2xpY2sgKSA+IHQgJiYNCiAgICAgICAgICAgICAgICAgICAgKCB5MSArIGR5Q2xpY2sgKSA8IGIgKSwNCiAgICAgICAgICAgICAgICBpc092ZXJFbGVtZW50V2lkdGggPSAoIHRoaXMub3B0aW9ucy5heGlzID09PSAieSIgKSB8fCAoICggeDEgKyBkeENsaWNrICkgPiBsICYmDQogICAgICAgICAgICAgICAgICAgICggeDEgKyBkeENsaWNrICkgPCByICksDQogICAgICAgICAgICAgICAgaXNPdmVyRWxlbWVudCA9IGlzT3ZlckVsZW1lbnRIZWlnaHQgJiYgaXNPdmVyRWxlbWVudFdpZHRoOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy50b2xlcmFuY2UgPT09ICJwb2ludGVyIiB8fA0KICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5mb3JjZVBvaW50ZXJGb3JDb250YWluZXJzIHx8DQogICAgICAgICAgICAgICAgKCB0aGlzLm9wdGlvbnMudG9sZXJhbmNlICE9PSAicG9pbnRlciIgJiYNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWxwZXJQcm9wb3J0aW9uc1sgdGhpcy5mbG9hdGluZyA/ICJ3aWR0aCIgOiAiaGVpZ2h0IiBdID4NCiAgICAgICAgICAgICAgICAgICAgaXRlbVsgdGhpcy5mbG9hdGluZyA/ICJ3aWR0aCIgOiAiaGVpZ2h0IiBdICkNCiAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgIHJldHVybiBpc092ZXJFbGVtZW50Ow0KICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAoIGwgPCB4MSArICggdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAvIDIgKSAmJiAvLyBSaWdodCBIYWxmDQogICAgICAgICAgICAgICAgICAgIHgyIC0gKCB0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC8gMiApIDwgciAmJiAvLyBMZWZ0IEhhbGYNCiAgICAgICAgICAgICAgICAgICAgdCA8IHkxICsgKCB0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAvIDIgKSAmJiAvLyBCb3R0b20gSGFsZg0KICAgICAgICAgICAgICAgICAgICB5MiAtICggdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLyAyICkgPCBiICk7IC8vIFRvcCBIYWxmDQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfaW50ZXJzZWN0c1dpdGhQb2ludGVyOiBmdW5jdGlvbiggaXRlbSApIHsNCiAgICAgICAgICAgIHZhciB2ZXJ0aWNhbERpcmVjdGlvbiwgaG9yaXpvbnRhbERpcmVjdGlvbiwNCiAgICAgICAgICAgICAgICBpc092ZXJFbGVtZW50SGVpZ2h0ID0gKCB0aGlzLm9wdGlvbnMuYXhpcyA9PT0gIngiICkgfHwNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5faXNPdmVyQXhpcygNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb25BYnMudG9wICsgdGhpcy5vZmZzZXQuY2xpY2sudG9wLCBpdGVtLnRvcCwgaXRlbS5oZWlnaHQgKSwNCiAgICAgICAgICAgICAgICBpc092ZXJFbGVtZW50V2lkdGggPSAoIHRoaXMub3B0aW9ucy5heGlzID09PSAieSIgKSB8fA0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9pc092ZXJBeGlzKA0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbkFicy5sZWZ0ICsgdGhpcy5vZmZzZXQuY2xpY2subGVmdCwgaXRlbS5sZWZ0LCBpdGVtLndpZHRoICksDQogICAgICAgICAgICAgICAgaXNPdmVyRWxlbWVudCA9IGlzT3ZlckVsZW1lbnRIZWlnaHQgJiYgaXNPdmVyRWxlbWVudFdpZHRoOw0KDQogICAgICAgICAgICBpZiAoICFpc092ZXJFbGVtZW50ICkgew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdmVydGljYWxEaXJlY3Rpb24gPSB0aGlzLl9nZXREcmFnVmVydGljYWxEaXJlY3Rpb24oKTsNCiAgICAgICAgICAgIGhvcml6b250YWxEaXJlY3Rpb24gPSB0aGlzLl9nZXREcmFnSG9yaXpvbnRhbERpcmVjdGlvbigpOw0KDQogICAgICAgICAgICByZXR1cm4gdGhpcy5mbG9hdGluZyA/DQogICAgICAgICAgICAgICAgKCAoIGhvcml6b250YWxEaXJlY3Rpb24gPT09ICJyaWdodCIgfHwgdmVydGljYWxEaXJlY3Rpb24gPT09ICJkb3duIiApID8gMiA6IDEgKQ0KICAgICAgICAgICAgICAgIDogKCB2ZXJ0aWNhbERpcmVjdGlvbiAmJiAoIHZlcnRpY2FsRGlyZWN0aW9uID09PSAiZG93biIgPyAyIDogMSApICk7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBfaW50ZXJzZWN0c1dpdGhTaWRlczogZnVuY3Rpb24oIGl0ZW0gKSB7DQoNCiAgICAgICAgICAgIHZhciBpc092ZXJCb3R0b21IYWxmID0gdGhpcy5faXNPdmVyQXhpcyggdGhpcy5wb3NpdGlvbkFicy50b3AgKw0KICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCwgaXRlbS50b3AgKyAoIGl0ZW0uaGVpZ2h0IC8gMiApLCBpdGVtLmhlaWdodCApLA0KICAgICAgICAgICAgICAgIGlzT3ZlclJpZ2h0SGFsZiA9IHRoaXMuX2lzT3ZlckF4aXMoIHRoaXMucG9zaXRpb25BYnMubGVmdCArDQogICAgICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQsIGl0ZW0ubGVmdCArICggaXRlbS53aWR0aCAvIDIgKSwgaXRlbS53aWR0aCApLA0KICAgICAgICAgICAgICAgIHZlcnRpY2FsRGlyZWN0aW9uID0gdGhpcy5fZ2V0RHJhZ1ZlcnRpY2FsRGlyZWN0aW9uKCksDQogICAgICAgICAgICAgICAgaG9yaXpvbnRhbERpcmVjdGlvbiA9IHRoaXMuX2dldERyYWdIb3Jpem9udGFsRGlyZWN0aW9uKCk7DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5mbG9hdGluZyAmJiBob3Jpem9udGFsRGlyZWN0aW9uICkgew0KICAgICAgICAgICAgICAgIHJldHVybiAoICggaG9yaXpvbnRhbERpcmVjdGlvbiA9PT0gInJpZ2h0IiAmJiBpc092ZXJSaWdodEhhbGYgKSB8fA0KICAgICAgICAgICAgICAgICAgICAoIGhvcml6b250YWxEaXJlY3Rpb24gPT09ICJsZWZ0IiAmJiAhaXNPdmVyUmlnaHRIYWxmICkgKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHZlcnRpY2FsRGlyZWN0aW9uICYmICggKCB2ZXJ0aWNhbERpcmVjdGlvbiA9PT0gImRvd24iICYmIGlzT3ZlckJvdHRvbUhhbGYgKSB8fA0KICAgICAgICAgICAgICAgICAgICAoIHZlcnRpY2FsRGlyZWN0aW9uID09PSAidXAiICYmICFpc092ZXJCb3R0b21IYWxmICkgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9LA0KDQogICAgICAgIF9nZXREcmFnVmVydGljYWxEaXJlY3Rpb246IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGRlbHRhID0gdGhpcy5wb3NpdGlvbkFicy50b3AgLSB0aGlzLmxhc3RQb3NpdGlvbkFicy50b3A7DQogICAgICAgICAgICByZXR1cm4gZGVsdGEgIT09IDAgJiYgKCBkZWx0YSA+IDAgPyAiZG93biIgOiAidXAiICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2dldERyYWdIb3Jpem9udGFsRGlyZWN0aW9uOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBkZWx0YSA9IHRoaXMucG9zaXRpb25BYnMubGVmdCAtIHRoaXMubGFzdFBvc2l0aW9uQWJzLmxlZnQ7DQogICAgICAgICAgICByZXR1cm4gZGVsdGEgIT09IDAgJiYgKCBkZWx0YSA+IDAgPyAicmlnaHQiIDogImxlZnQiICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgcmVmcmVzaDogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgdGhpcy5fcmVmcmVzaEl0ZW1zKCBldmVudCApOw0KICAgICAgICAgICAgdGhpcy5fc2V0SGFuZGxlQ2xhc3NOYW1lKCk7DQogICAgICAgICAgICB0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKTsNCiAgICAgICAgICAgIHJldHVybiB0aGlzOw0KICAgICAgICB9LA0KDQogICAgICAgIF9jb25uZWN0V2l0aDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9uczsNCiAgICAgICAgICAgIHJldHVybiBvcHRpb25zLmNvbm5lY3RXaXRoLmNvbnN0cnVjdG9yID09PSBTdHJpbmcgPw0KICAgICAgICAgICAgICAgIFsgb3B0aW9ucy5jb25uZWN0V2l0aCBdIDoNCiAgICAgICAgICAgICAgICBvcHRpb25zLmNvbm5lY3RXaXRoOw0KICAgICAgICB9LA0KDQogICAgICAgIF9nZXRJdGVtc0FzalF1ZXJ5OiBmdW5jdGlvbiggY29ubmVjdGVkICkgew0KDQogICAgICAgICAgICB2YXIgaSwgaiwgY3VyLCBpbnN0LA0KICAgICAgICAgICAgICAgIGl0ZW1zID0gW10sDQogICAgICAgICAgICAgICAgcXVlcmllcyA9IFtdLA0KICAgICAgICAgICAgICAgIGNvbm5lY3RXaXRoID0gdGhpcy5fY29ubmVjdFdpdGgoKTsNCg0KICAgICAgICAgICAgaWYgKCBjb25uZWN0V2l0aCAmJiBjb25uZWN0ZWQgKSB7DQogICAgICAgICAgICAgICAgZm9yICggaSA9IGNvbm5lY3RXaXRoLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tICkgew0KICAgICAgICAgICAgICAgICAgICBjdXIgPSAkKCBjb25uZWN0V2l0aFsgaSBdLCB0aGlzLmRvY3VtZW50WyAwIF0gKTsNCiAgICAgICAgICAgICAgICAgICAgZm9yICggaiA9IGN1ci5sZW5ndGggLSAxOyBqID49IDA7IGotLSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGluc3QgPSAkLmRhdGEoIGN1clsgaiBdLCB0aGlzLndpZGdldEZ1bGxOYW1lICk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGluc3QgJiYgaW5zdCAhPT0gdGhpcyAmJiAhaW5zdC5vcHRpb25zLmRpc2FibGVkICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJpZXMucHVzaCggWyAkLmlzRnVuY3Rpb24oIGluc3Qub3B0aW9ucy5pdGVtcyApID8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdC5vcHRpb25zLml0ZW1zLmNhbGwoIGluc3QuZWxlbWVudCApIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCggaW5zdC5vcHRpb25zLml0ZW1zLCBpbnN0LmVsZW1lbnQgKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm5vdCggIi51aS1zb3J0YWJsZS1oZWxwZXIiICkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5ub3QoICIudWktc29ydGFibGUtcGxhY2Vob2xkZXIiICksIGluc3QgXSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBxdWVyaWVzLnB1c2goIFsgJC5pc0Z1bmN0aW9uKCB0aGlzLm9wdGlvbnMuaXRlbXMgKSA/DQogICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLml0ZW1zDQogICAgICAgICAgICAgICAgICAgIC5jYWxsKCB0aGlzLmVsZW1lbnQsIG51bGwsIHsgb3B0aW9uczogdGhpcy5vcHRpb25zLCBpdGVtOiB0aGlzLmN1cnJlbnRJdGVtIH0gKSA6DQogICAgICAgICAgICAgICAgJCggdGhpcy5vcHRpb25zLml0ZW1zLCB0aGlzLmVsZW1lbnQgKQ0KICAgICAgICAgICAgICAgICAgICAubm90KCAiLnVpLXNvcnRhYmxlLWhlbHBlciIgKQ0KICAgICAgICAgICAgICAgICAgICAubm90KCAiLnVpLXNvcnRhYmxlLXBsYWNlaG9sZGVyIiApLCB0aGlzIF0gKTsNCg0KICAgICAgICAgICAgZnVuY3Rpb24gYWRkSXRlbXMoKSB7DQogICAgICAgICAgICAgICAgaXRlbXMucHVzaCggdGhpcyApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZm9yICggaSA9IHF1ZXJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7DQogICAgICAgICAgICAgICAgcXVlcmllc1sgaSBdWyAwIF0uZWFjaCggYWRkSXRlbXMgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuICQoIGl0ZW1zICk7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBfcmVtb3ZlQ3VycmVudHNGcm9tSXRlbXM6IGZ1bmN0aW9uKCkgew0KDQogICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMuY3VycmVudEl0ZW0uZmluZCggIjpkYXRhKCIgKyB0aGlzLndpZGdldE5hbWUgKyAiLWl0ZW0pIiApOw0KDQogICAgICAgICAgICB0aGlzLml0ZW1zID0gJC5ncmVwKCB0aGlzLml0ZW1zLCBmdW5jdGlvbiggaXRlbSApIHsNCiAgICAgICAgICAgICAgICBmb3IgKCB2YXIgaiA9IDA7IGogPCBsaXN0Lmxlbmd0aDsgaisrICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIGxpc3RbIGogXSA9PT0gaXRlbS5pdGVtWyAwIF0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBfcmVmcmVzaEl0ZW1zOiBmdW5jdGlvbiggZXZlbnQgKSB7DQoNCiAgICAgICAgICAgIHRoaXMuaXRlbXMgPSBbXTsNCiAgICAgICAgICAgIHRoaXMuY29udGFpbmVycyA9IFsgdGhpcyBdOw0KDQogICAgICAgICAgICB2YXIgaSwgaiwgY3VyLCBpbnN0LCB0YXJnZXREYXRhLCBfcXVlcmllcywgaXRlbSwgcXVlcmllc0xlbmd0aCwNCiAgICAgICAgICAgICAgICBpdGVtcyA9IHRoaXMuaXRlbXMsDQogICAgICAgICAgICAgICAgcXVlcmllcyA9IFsgWyAkLmlzRnVuY3Rpb24oIHRoaXMub3B0aW9ucy5pdGVtcyApID8NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLml0ZW1zLmNhbGwoIHRoaXMuZWxlbWVudFsgMCBdLCBldmVudCwgeyBpdGVtOiB0aGlzLmN1cnJlbnRJdGVtIH0gKSA6DQogICAgICAgICAgICAgICAgICAgICQoIHRoaXMub3B0aW9ucy5pdGVtcywgdGhpcy5lbGVtZW50ICksIHRoaXMgXSBdLA0KICAgICAgICAgICAgICAgIGNvbm5lY3RXaXRoID0gdGhpcy5fY29ubmVjdFdpdGgoKTsNCg0KICAgICAgICAgICAgLy9TaG91bGRuJ3QgYmUgcnVuIHRoZSBmaXJzdCB0aW1lIHRocm91Z2ggZHVlIHRvIG1hc3NpdmUgc2xvdy1kb3duDQogICAgICAgICAgICBpZiAoIGNvbm5lY3RXaXRoICYmIHRoaXMucmVhZHkgKSB7DQogICAgICAgICAgICAgICAgZm9yICggaSA9IGNvbm5lY3RXaXRoLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tICkgew0KICAgICAgICAgICAgICAgICAgICBjdXIgPSAkKCBjb25uZWN0V2l0aFsgaSBdLCB0aGlzLmRvY3VtZW50WyAwIF0gKTsNCiAgICAgICAgICAgICAgICAgICAgZm9yICggaiA9IGN1ci5sZW5ndGggLSAxOyBqID49IDA7IGotLSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGluc3QgPSAkLmRhdGEoIGN1clsgaiBdLCB0aGlzLndpZGdldEZ1bGxOYW1lICk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGluc3QgJiYgaW5zdCAhPT0gdGhpcyAmJiAhaW5zdC5vcHRpb25zLmRpc2FibGVkICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJpZXMucHVzaCggWyAkLmlzRnVuY3Rpb24oIGluc3Qub3B0aW9ucy5pdGVtcyApID8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdC5vcHRpb25zLml0ZW1zDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2FsbCggaW5zdC5lbGVtZW50WyAwIF0sIGV2ZW50LCB7IGl0ZW06IHRoaXMuY3VycmVudEl0ZW0gfSApIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCggaW5zdC5vcHRpb25zLml0ZW1zLCBpbnN0LmVsZW1lbnQgKSwgaW5zdCBdICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJzLnB1c2goIGluc3QgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZm9yICggaSA9IHF1ZXJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7DQogICAgICAgICAgICAgICAgdGFyZ2V0RGF0YSA9IHF1ZXJpZXNbIGkgXVsgMSBdOw0KICAgICAgICAgICAgICAgIF9xdWVyaWVzID0gcXVlcmllc1sgaSBdWyAwIF07DQoNCiAgICAgICAgICAgICAgICBmb3IgKCBqID0gMCwgcXVlcmllc0xlbmd0aCA9IF9xdWVyaWVzLmxlbmd0aDsgaiA8IHF1ZXJpZXNMZW5ndGg7IGorKyApIHsNCiAgICAgICAgICAgICAgICAgICAgaXRlbSA9ICQoIF9xdWVyaWVzWyBqIF0gKTsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBEYXRhIGZvciB0YXJnZXQgY2hlY2tpbmcgKG1vdXNlIG1hbmFnZXIpDQogICAgICAgICAgICAgICAgICAgIGl0ZW0uZGF0YSggdGhpcy53aWRnZXROYW1lICsgIi1pdGVtIiwgdGFyZ2V0RGF0YSApOw0KDQogICAgICAgICAgICAgICAgICAgIGl0ZW1zLnB1c2goIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW06IGl0ZW0sDQogICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZTogdGFyZ2V0RGF0YSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAwLCBoZWlnaHQ6IDAsDQogICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwLCB0b3A6IDANCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9LA0KDQogICAgICAgIHJlZnJlc2hQb3NpdGlvbnM6IGZ1bmN0aW9uKCBmYXN0ICkgew0KDQogICAgICAgICAgICAvLyBEZXRlcm1pbmUgd2hldGhlciBpdGVtcyBhcmUgYmVpbmcgZGlzcGxheWVkIGhvcml6b250YWxseQ0KICAgICAgICAgICAgdGhpcy5mbG9hdGluZyA9IHRoaXMuaXRlbXMubGVuZ3RoID8NCiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuYXhpcyA9PT0gIngiIHx8IHRoaXMuX2lzRmxvYXRpbmcoIHRoaXMuaXRlbXNbIDAgXS5pdGVtICkgOg0KICAgICAgICAgICAgICAgIGZhbHNlOw0KDQogICAgICAgICAgICAvL1RoaXMgaGFzIHRvIGJlIHJlZG9uZSBiZWNhdXNlIGR1ZSB0byB0aGUgaXRlbSBiZWluZyBtb3ZlZCBvdXQvaW50byB0aGUgb2Zmc2V0UGFyZW50LA0KICAgICAgICAgICAgLy8gdGhlIG9mZnNldFBhcmVudCdzIHBvc2l0aW9uIHdpbGwgY2hhbmdlDQogICAgICAgICAgICBpZiAoIHRoaXMub2Zmc2V0UGFyZW50ICYmIHRoaXMuaGVscGVyICkgew0KICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0LnBhcmVudCA9IHRoaXMuX2dldFBhcmVudE9mZnNldCgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgaSwgaXRlbSwgdCwgcDsNCg0KICAgICAgICAgICAgZm9yICggaSA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7DQogICAgICAgICAgICAgICAgaXRlbSA9IHRoaXMuaXRlbXNbIGkgXTsNCg0KICAgICAgICAgICAgICAgIC8vV2UgaWdub3JlIGNhbGN1bGF0aW5nIHBvc2l0aW9ucyBvZiBhbGwgY29ubmVjdGVkIGNvbnRhaW5lcnMgd2hlbiB3ZSdyZSBub3Qgb3ZlciB0aGVtDQogICAgICAgICAgICAgICAgaWYgKCBpdGVtLmluc3RhbmNlICE9PSB0aGlzLmN1cnJlbnRDb250YWluZXIgJiYgdGhpcy5jdXJyZW50Q29udGFpbmVyICYmDQogICAgICAgICAgICAgICAgICAgIGl0ZW0uaXRlbVsgMCBdICE9PSB0aGlzLmN1cnJlbnRJdGVtWyAwIF0gKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHQgPSB0aGlzLm9wdGlvbnMudG9sZXJhbmNlRWxlbWVudCA/DQogICAgICAgICAgICAgICAgICAgICQoIHRoaXMub3B0aW9ucy50b2xlcmFuY2VFbGVtZW50LCBpdGVtLml0ZW0gKSA6DQogICAgICAgICAgICAgICAgICAgIGl0ZW0uaXRlbTsNCg0KICAgICAgICAgICAgICAgIGlmICggIWZhc3QgKSB7DQogICAgICAgICAgICAgICAgICAgIGl0ZW0ud2lkdGggPSB0Lm91dGVyV2lkdGgoKTsNCiAgICAgICAgICAgICAgICAgICAgaXRlbS5oZWlnaHQgPSB0Lm91dGVySGVpZ2h0KCk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcCA9IHQub2Zmc2V0KCk7DQogICAgICAgICAgICAgICAgaXRlbS5sZWZ0ID0gcC5sZWZ0Ow0KICAgICAgICAgICAgICAgIGl0ZW0udG9wID0gcC50b3A7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmN1c3RvbSAmJiB0aGlzLm9wdGlvbnMuY3VzdG9tLnJlZnJlc2hDb250YWluZXJzICkgew0KICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5jdXN0b20ucmVmcmVzaENvbnRhaW5lcnMuY2FsbCggdGhpcyApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBmb3IgKCBpID0gdGhpcy5jb250YWluZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tICkgew0KICAgICAgICAgICAgICAgICAgICBwID0gdGhpcy5jb250YWluZXJzWyBpIF0uZWxlbWVudC5vZmZzZXQoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJzWyBpIF0uY29udGFpbmVyQ2FjaGUubGVmdCA9IHAubGVmdDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJzWyBpIF0uY29udGFpbmVyQ2FjaGUudG9wID0gcC50b3A7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyc1sgaSBdLmNvbnRhaW5lckNhY2hlLndpZHRoID0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyc1sgaSBdLmVsZW1lbnQub3V0ZXJXaWR0aCgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lcnNbIGkgXS5jb250YWluZXJDYWNoZS5oZWlnaHQgPQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJzWyBpIF0uZWxlbWVudC5vdXRlckhlaWdodCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2NyZWF0ZVBsYWNlaG9sZGVyOiBmdW5jdGlvbiggdGhhdCApIHsNCiAgICAgICAgICAgIHRoYXQgPSB0aGF0IHx8IHRoaXM7DQogICAgICAgICAgICB2YXIgY2xhc3NOYW1lLA0KICAgICAgICAgICAgICAgIG8gPSB0aGF0Lm9wdGlvbnM7DQoNCiAgICAgICAgICAgIGlmICggIW8ucGxhY2Vob2xkZXIgfHwgby5wbGFjZWhvbGRlci5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nICkgew0KICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9IG8ucGxhY2Vob2xkZXI7DQogICAgICAgICAgICAgICAgby5wbGFjZWhvbGRlciA9IHsNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub2RlTmFtZSA9IHRoYXQuY3VycmVudEl0ZW1bIDAgXS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSAkKCAiPCIgKyBub2RlTmFtZSArICI+IiwgdGhhdC5kb2N1bWVudFsgMCBdICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX2FkZENsYXNzKCBlbGVtZW50LCAidWktc29ydGFibGUtcGxhY2Vob2xkZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZSB8fCB0aGF0LmN1cnJlbnRJdGVtWyAwIF0uY2xhc3NOYW1lICkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuX3JlbW92ZUNsYXNzKCBlbGVtZW50LCAidWktc29ydGFibGUtaGVscGVyIiApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG5vZGVOYW1lID09PSAidGJvZHkiICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX2NyZWF0ZVRyUGxhY2Vob2xkZXIoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuY3VycmVudEl0ZW0uZmluZCggInRyIiApLmVxKCAwICksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoICI8dHI+IiwgdGhhdC5kb2N1bWVudFsgMCBdICkuYXBwZW5kVG8oIGVsZW1lbnQgKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBub2RlTmFtZSA9PT0gInRyIiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9jcmVhdGVUclBsYWNlaG9sZGVyKCB0aGF0LmN1cnJlbnRJdGVtLCBlbGVtZW50ICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBub2RlTmFtZSA9PT0gImltZyIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hdHRyKCAic3JjIiwgdGhhdC5jdXJyZW50SXRlbS5hdHRyKCAic3JjIiApICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggIWNsYXNzTmFtZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNzcyggInZpc2liaWxpdHkiLCAiaGlkZGVuIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudDsNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgdXBkYXRlOiBmdW5jdGlvbiggY29udGFpbmVyLCBwICkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyAxLiBJZiBhIGNsYXNzTmFtZSBpcyBzZXQgYXMgJ3BsYWNlaG9sZGVyIG9wdGlvbiwgd2UgZG9uJ3QgZm9yY2Ugc2l6ZXMgLQ0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNsYXNzIGlzIHJlc3BvbnNpYmxlIGZvciB0aGF0DQogICAgICAgICAgICAgICAgICAgICAgICAvLyAyLiBUaGUgb3B0aW9uICdmb3JjZVBsYWNlaG9sZGVyU2l6ZSBjYW4gYmUgZW5hYmxlZCB0byBmb3JjZSBpdCBldmVuIGlmIGENCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNsYXNzIG5hbWUgaXMgc3BlY2lmaWVkDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGNsYXNzTmFtZSAmJiAhby5mb3JjZVBsYWNlaG9sZGVyU2l6ZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vSWYgdGhlIGVsZW1lbnQgZG9lc24ndCBoYXZlIGEgYWN0dWFsIGhlaWdodCBieSBpdHNlbGYgKHdpdGhvdXQgc3R5bGVzIGNvbWluZw0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZnJvbSBhIHN0eWxlc2hlZXQpLCBpdCByZWNlaXZlcyB0aGUgaW5saW5lIGhlaWdodCBmcm9tIHRoZSBkcmFnZ2VkIGl0ZW0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggIXAuaGVpZ2h0KCkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5oZWlnaHQoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuY3VycmVudEl0ZW0uaW5uZXJIZWlnaHQoKSAtDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KCB0aGF0LmN1cnJlbnRJdGVtLmNzcyggInBhZGRpbmdUb3AiICkgfHwgMCwgMTAgKSAtDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KCB0aGF0LmN1cnJlbnRJdGVtLmNzcyggInBhZGRpbmdCb3R0b20iICkgfHwgMCwgMTAgKSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhcC53aWR0aCgpICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAud2lkdGgoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuY3VycmVudEl0ZW0uaW5uZXJXaWR0aCgpIC0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQoIHRoYXQuY3VycmVudEl0ZW0uY3NzKCAicGFkZGluZ0xlZnQiICkgfHwgMCwgMTAgKSAtDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KCB0aGF0LmN1cnJlbnRJdGVtLmNzcyggInBhZGRpbmdSaWdodCIgKSB8fCAwLCAxMCApICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvL0NyZWF0ZSB0aGUgcGxhY2Vob2xkZXINCiAgICAgICAgICAgIHRoYXQucGxhY2Vob2xkZXIgPSAkKCBvLnBsYWNlaG9sZGVyLmVsZW1lbnQuY2FsbCggdGhhdC5lbGVtZW50LCB0aGF0LmN1cnJlbnRJdGVtICkgKTsNCg0KICAgICAgICAgICAgLy9BcHBlbmQgaXQgYWZ0ZXIgdGhlIGFjdHVhbCBjdXJyZW50IGl0ZW0NCiAgICAgICAgICAgIHRoYXQuY3VycmVudEl0ZW0uYWZ0ZXIoIHRoYXQucGxhY2Vob2xkZXIgKTsNCg0KICAgICAgICAgICAgLy9VcGRhdGUgdGhlIHNpemUgb2YgdGhlIHBsYWNlaG9sZGVyIChUT0RPOiBMb2dpYyB0byBmdXp6eSwgc2VlIGxpbmUgMzE2LzMxNykNCiAgICAgICAgICAgIG8ucGxhY2Vob2xkZXIudXBkYXRlKCB0aGF0LCB0aGF0LnBsYWNlaG9sZGVyICk7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBfY3JlYXRlVHJQbGFjZWhvbGRlcjogZnVuY3Rpb24oIHNvdXJjZVRyLCB0YXJnZXRUciApIHsNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpczsNCg0KICAgICAgICAgICAgc291cmNlVHIuY2hpbGRyZW4oKS5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAkKCAiPHRkPiYjMTYwOzwvdGQ+IiwgdGhhdC5kb2N1bWVudFsgMCBdICkNCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoICJjb2xzcGFuIiwgJCggdGhpcyApLmF0dHIoICJjb2xzcGFuIiApIHx8IDEgKQ0KICAgICAgICAgICAgICAgICAgICAuYXBwZW5kVG8oIHRhcmdldFRyICk7DQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2NvbnRhY3RDb250YWluZXJzOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgaSwgaiwgZGlzdCwgaXRlbVdpdGhMZWFzdERpc3RhbmNlLCBwb3NQcm9wZXJ0eSwgc2l6ZVByb3BlcnR5LCBjdXIsIG5lYXJCb3R0b20sDQogICAgICAgICAgICAgICAgZmxvYXRpbmcsIGF4aXMsDQogICAgICAgICAgICAgICAgaW5uZXJtb3N0Q29udGFpbmVyID0gbnVsbCwNCiAgICAgICAgICAgICAgICBpbm5lcm1vc3RJbmRleCA9IG51bGw7DQoNCiAgICAgICAgICAgIC8vIEdldCBpbm5lcm1vc3QgY29udGFpbmVyIHRoYXQgaW50ZXJzZWN0cyB3aXRoIGl0ZW0NCiAgICAgICAgICAgIGZvciAoIGkgPSB0aGlzLmNvbnRhaW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBOZXZlciBjb25zaWRlciBhIGNvbnRhaW5lciB0aGF0J3MgbG9jYXRlZCB3aXRoaW4gdGhlIGl0ZW0gaXRzZWxmDQogICAgICAgICAgICAgICAgaWYgKCAkLmNvbnRhaW5zKCB0aGlzLmN1cnJlbnRJdGVtWyAwIF0sIHRoaXMuY29udGFpbmVyc1sgaSBdLmVsZW1lbnRbIDAgXSApICkgew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuX2ludGVyc2VjdHNXaXRoKCB0aGlzLmNvbnRhaW5lcnNbIGkgXS5jb250YWluZXJDYWNoZSApICkgew0KDQogICAgICAgICAgICAgICAgICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgZm91bmQgYSBjb250YWluZXIgYW5kIGl0J3MgbW9yZSAiaW5uZXIiIHRoYW4gdGhpcywgdGhlbiBjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIGlubmVybW9zdENvbnRhaW5lciAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgJC5jb250YWlucygNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lcnNbIGkgXS5lbGVtZW50WyAwIF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJtb3N0Q29udGFpbmVyLmVsZW1lbnRbIDAgXSApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpbm5lcm1vc3RDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcnNbIGkgXTsNCiAgICAgICAgICAgICAgICAgICAgaW5uZXJtb3N0SW5kZXggPSBpOw0KDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBjb250YWluZXIgZG9lc24ndCBpbnRlcnNlY3QuIHRyaWdnZXIgIm91dCIgZXZlbnQgaWYgbmVjZXNzYXJ5DQogICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5jb250YWluZXJzWyBpIF0uY29udGFpbmVyQ2FjaGUub3ZlciApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyc1sgaSBdLl90cmlnZ2VyKCAib3V0IiwgZXZlbnQsIHRoaXMuX3VpSGFzaCggdGhpcyApICk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lcnNbIGkgXS5jb250YWluZXJDYWNoZS5vdmVyID0gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBJZiBubyBpbnRlcnNlY3RpbmcgY29udGFpbmVycyBmb3VuZCwgcmV0dXJuDQogICAgICAgICAgICBpZiAoICFpbm5lcm1vc3RDb250YWluZXIgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBNb3ZlIHRoZSBpdGVtIGludG8gdGhlIGNvbnRhaW5lciBpZiBpdCdzIG5vdCB0aGVyZSBhbHJlYWR5DQogICAgICAgICAgICBpZiAoIHRoaXMuY29udGFpbmVycy5sZW5ndGggPT09IDEgKSB7DQogICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5jb250YWluZXJzWyBpbm5lcm1vc3RJbmRleCBdLmNvbnRhaW5lckNhY2hlLm92ZXIgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyc1sgaW5uZXJtb3N0SW5kZXggXS5fdHJpZ2dlciggIm92ZXIiLCBldmVudCwgdGhpcy5fdWlIYXNoKCB0aGlzICkgKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJzWyBpbm5lcm1vc3RJbmRleCBdLmNvbnRhaW5lckNhY2hlLm92ZXIgPSAxOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICAvLyBXaGVuIGVudGVyaW5nIGEgbmV3IGNvbnRhaW5lciwgd2Ugd2lsbCBmaW5kIHRoZSBpdGVtIHdpdGggdGhlIGxlYXN0IGRpc3RhbmNlIGFuZA0KICAgICAgICAgICAgICAgIC8vIGFwcGVuZCBvdXIgaXRlbSBuZWFyIGl0DQogICAgICAgICAgICAgICAgZGlzdCA9IDEwMDAwOw0KICAgICAgICAgICAgICAgIGl0ZW1XaXRoTGVhc3REaXN0YW5jZSA9IG51bGw7DQogICAgICAgICAgICAgICAgZmxvYXRpbmcgPSBpbm5lcm1vc3RDb250YWluZXIuZmxvYXRpbmcgfHwgdGhpcy5faXNGbG9hdGluZyggdGhpcy5jdXJyZW50SXRlbSApOw0KICAgICAgICAgICAgICAgIHBvc1Byb3BlcnR5ID0gZmxvYXRpbmcgPyAibGVmdCIgOiAidG9wIjsNCiAgICAgICAgICAgICAgICBzaXplUHJvcGVydHkgPSBmbG9hdGluZyA/ICJ3aWR0aCIgOiAiaGVpZ2h0IjsNCiAgICAgICAgICAgICAgICBheGlzID0gZmxvYXRpbmcgPyAicGFnZVgiIDogInBhZ2VZIjsNCg0KICAgICAgICAgICAgICAgIGZvciAoIGogPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoICEkLmNvbnRhaW5zKA0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJzWyBpbm5lcm1vc3RJbmRleCBdLmVsZW1lbnRbIDAgXSwgdGhpcy5pdGVtc1sgaiBdLml0ZW1bIDAgXSApDQogICAgICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLml0ZW1zWyBqIF0uaXRlbVsgMCBdID09PSB0aGlzLmN1cnJlbnRJdGVtWyAwIF0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGN1ciA9IHRoaXMuaXRlbXNbIGogXS5pdGVtLm9mZnNldCgpWyBwb3NQcm9wZXJ0eSBdOw0KICAgICAgICAgICAgICAgICAgICBuZWFyQm90dG9tID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIGlmICggZXZlbnRbIGF4aXMgXSAtIGN1ciA+IHRoaXMuaXRlbXNbIGogXVsgc2l6ZVByb3BlcnR5IF0gLyAyICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbmVhckJvdHRvbSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZiAoIE1hdGguYWJzKCBldmVudFsgYXhpcyBdIC0gY3VyICkgPCBkaXN0ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZGlzdCA9IE1hdGguYWJzKCBldmVudFsgYXhpcyBdIC0gY3VyICk7DQogICAgICAgICAgICAgICAgICAgICAgICBpdGVtV2l0aExlYXN0RGlzdGFuY2UgPSB0aGlzLml0ZW1zWyBqIF07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IG5lYXJCb3R0b20gPyAidXAiIDogImRvd24iOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy9DaGVjayBpZiBkcm9wT25FbXB0eSBpcyBlbmFibGVkDQogICAgICAgICAgICAgICAgaWYgKCAhaXRlbVdpdGhMZWFzdERpc3RhbmNlICYmICF0aGlzLm9wdGlvbnMuZHJvcE9uRW1wdHkgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuY3VycmVudENvbnRhaW5lciA9PT0gdGhpcy5jb250YWluZXJzWyBpbm5lcm1vc3RJbmRleCBdICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoICF0aGlzLmN1cnJlbnRDb250YWluZXIuY29udGFpbmVyQ2FjaGUub3ZlciApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyc1sgaW5uZXJtb3N0SW5kZXggXS5fdHJpZ2dlciggIm92ZXIiLCBldmVudCwgdGhpcy5fdWlIYXNoKCkgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudENvbnRhaW5lci5jb250YWluZXJDYWNoZS5vdmVyID0gMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaXRlbVdpdGhMZWFzdERpc3RhbmNlID8NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVhcnJhbmdlKCBldmVudCwgaXRlbVdpdGhMZWFzdERpc3RhbmNlLCBudWxsLCB0cnVlICkgOg0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWFycmFuZ2UoIGV2ZW50LCBudWxsLCB0aGlzLmNvbnRhaW5lcnNbIGlubmVybW9zdEluZGV4IF0uZWxlbWVudCwgdHJ1ZSApOw0KICAgICAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJjaGFuZ2UiLCBldmVudCwgdGhpcy5fdWlIYXNoKCkgKTsNCiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lcnNbIGlubmVybW9zdEluZGV4IF0uX3RyaWdnZXIoICJjaGFuZ2UiLCBldmVudCwgdGhpcy5fdWlIYXNoKCB0aGlzICkgKTsNCiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcnNbIGlubmVybW9zdEluZGV4IF07DQoNCiAgICAgICAgICAgICAgICAvL1VwZGF0ZSB0aGUgcGxhY2Vob2xkZXINCiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXIudXBkYXRlKCB0aGlzLmN1cnJlbnRDb250YWluZXIsIHRoaXMucGxhY2Vob2xkZXIgKTsNCg0KICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyc1sgaW5uZXJtb3N0SW5kZXggXS5fdHJpZ2dlciggIm92ZXIiLCBldmVudCwgdGhpcy5fdWlIYXNoKCB0aGlzICkgKTsNCiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lcnNbIGlubmVybW9zdEluZGV4IF0uY29udGFpbmVyQ2FjaGUub3ZlciA9IDE7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBfY3JlYXRlSGVscGVyOiBmdW5jdGlvbiggZXZlbnQgKSB7DQoNCiAgICAgICAgICAgIHZhciBvID0gdGhpcy5vcHRpb25zLA0KICAgICAgICAgICAgICAgIGhlbHBlciA9ICQuaXNGdW5jdGlvbiggby5oZWxwZXIgKSA/DQogICAgICAgICAgICAgICAgICAgICQoIG8uaGVscGVyLmFwcGx5KCB0aGlzLmVsZW1lbnRbIDAgXSwgWyBldmVudCwgdGhpcy5jdXJyZW50SXRlbSBdICkgKSA6DQogICAgICAgICAgICAgICAgICAgICggby5oZWxwZXIgPT09ICJjbG9uZSIgPyB0aGlzLmN1cnJlbnRJdGVtLmNsb25lKCkgOiB0aGlzLmN1cnJlbnRJdGVtICk7DQoNCiAgICAgICAgICAgIC8vQWRkIHRoZSBoZWxwZXIgdG8gdGhlIERPTSBpZiB0aGF0IGRpZG4ndCBoYXBwZW4gYWxyZWFkeQ0KICAgICAgICAgICAgaWYgKCAhaGVscGVyLnBhcmVudHMoICJib2R5IiApLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICAkKCBvLmFwcGVuZFRvICE9PSAicGFyZW50IiA/DQogICAgICAgICAgICAgICAgICAgIG8uYXBwZW5kVG8gOg0KICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRJdGVtWyAwIF0ucGFyZW50Tm9kZSApWyAwIF0uYXBwZW5kQ2hpbGQoIGhlbHBlclsgMCBdICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggaGVscGVyWyAwIF0gPT09IHRoaXMuY3VycmVudEl0ZW1bIDAgXSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9zdG9yZWRDU1MgPSB7DQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiB0aGlzLmN1cnJlbnRJdGVtWyAwIF0uc3R5bGUud2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodDogdGhpcy5jdXJyZW50SXRlbVsgMCBdLnN0eWxlLmhlaWdodCwNCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHRoaXMuY3VycmVudEl0ZW0uY3NzKCAicG9zaXRpb24iICksDQogICAgICAgICAgICAgICAgICAgIHRvcDogdGhpcy5jdXJyZW50SXRlbS5jc3MoICJ0b3AiICksDQogICAgICAgICAgICAgICAgICAgIGxlZnQ6IHRoaXMuY3VycmVudEl0ZW0uY3NzKCAibGVmdCIgKQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggIWhlbHBlclsgMCBdLnN0eWxlLndpZHRoIHx8IG8uZm9yY2VIZWxwZXJTaXplICkgew0KICAgICAgICAgICAgICAgIGhlbHBlci53aWR0aCggdGhpcy5jdXJyZW50SXRlbS53aWR0aCgpICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoICFoZWxwZXJbIDAgXS5zdHlsZS5oZWlnaHQgfHwgby5mb3JjZUhlbHBlclNpemUgKSB7DQogICAgICAgICAgICAgICAgaGVscGVyLmhlaWdodCggdGhpcy5jdXJyZW50SXRlbS5oZWlnaHQoKSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gaGVscGVyOw0KDQogICAgICAgIH0sDQoNCiAgICAgICAgX2FkanVzdE9mZnNldEZyb21IZWxwZXI6IGZ1bmN0aW9uKCBvYmogKSB7DQogICAgICAgICAgICBpZiAoIHR5cGVvZiBvYmogPT09ICJzdHJpbmciICkgew0KICAgICAgICAgICAgICAgIG9iaiA9IG9iai5zcGxpdCggIiAiICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoICQuaXNBcnJheSggb2JqICkgKSB7DQogICAgICAgICAgICAgICAgb2JqID0geyBsZWZ0OiArb2JqWyAwIF0sIHRvcDogK29ialsgMSBdIHx8IDAgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggImxlZnQiIGluIG9iaiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID0gb2JqLmxlZnQgKyB0aGlzLm1hcmdpbnMubGVmdDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggInJpZ2h0IiBpbiBvYmogKSB7DQogICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQuY2xpY2subGVmdCA9IHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggLSBvYmoucmlnaHQgKyB0aGlzLm1hcmdpbnMubGVmdDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggInRvcCIgaW4gb2JqICkgew0KICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA9IG9iai50b3AgKyB0aGlzLm1hcmdpbnMudG9wOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCAiYm90dG9tIiBpbiBvYmogKSB7DQogICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQuY2xpY2sudG9wID0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLSBvYmouYm90dG9tICsgdGhpcy5tYXJnaW5zLnRvcDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfZ2V0UGFyZW50T2Zmc2V0OiBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgLy9HZXQgdGhlIG9mZnNldFBhcmVudCBhbmQgY2FjaGUgaXRzIHBvc2l0aW9uDQogICAgICAgICAgICB0aGlzLm9mZnNldFBhcmVudCA9IHRoaXMuaGVscGVyLm9mZnNldFBhcmVudCgpOw0KICAgICAgICAgICAgdmFyIHBvID0gdGhpcy5vZmZzZXRQYXJlbnQub2Zmc2V0KCk7DQoNCiAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBzcGVjaWFsIGNhc2Ugd2hlcmUgd2UgbmVlZCB0byBtb2RpZnkgYSBvZmZzZXQgY2FsY3VsYXRlZCBvbiBzdGFydCwgc2luY2UgdGhlDQogICAgICAgICAgICAvLyBmb2xsb3dpbmcgaGFwcGVuZWQ6DQogICAgICAgICAgICAvLyAxLiBUaGUgcG9zaXRpb24gb2YgdGhlIGhlbHBlciBpcyBhYnNvbHV0ZSwgc28gaXQncyBwb3NpdGlvbiBpcyBjYWxjdWxhdGVkIGJhc2VkIG9uIHRoZQ0KICAgICAgICAgICAgLy8gbmV4dCBwb3NpdGlvbmVkIHBhcmVudA0KICAgICAgICAgICAgLy8gMi4gVGhlIGFjdHVhbCBvZmZzZXQgcGFyZW50IGlzIGEgY2hpbGQgb2YgdGhlIHNjcm9sbCBwYXJlbnQsIGFuZCB0aGUgc2Nyb2xsIHBhcmVudCBpc24ndA0KICAgICAgICAgICAgLy8gdGhlIGRvY3VtZW50LCB3aGljaCBtZWFucyB0aGF0IHRoZSBzY3JvbGwgaXMgaW5jbHVkZWQgaW4gdGhlIGluaXRpYWwgY2FsY3VsYXRpb24gb2YgdGhlDQogICAgICAgICAgICAvLyBvZmZzZXQgb2YgdGhlIHBhcmVudCwgYW5kIG5ldmVyIHJlY2FsY3VsYXRlZCB1cG9uIGRyYWcNCiAgICAgICAgICAgIGlmICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gImFic29sdXRlIiAmJiB0aGlzLnNjcm9sbFBhcmVudFsgMCBdICE9PSB0aGlzLmRvY3VtZW50WyAwIF0gJiYNCiAgICAgICAgICAgICAgICAkLmNvbnRhaW5zKCB0aGlzLnNjcm9sbFBhcmVudFsgMCBdLCB0aGlzLm9mZnNldFBhcmVudFsgMCBdICkgKSB7DQogICAgICAgICAgICAgICAgcG8ubGVmdCArPSB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCk7DQogICAgICAgICAgICAgICAgcG8udG9wICs9IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBUaGlzIG5lZWRzIHRvIGJlIGFjdHVhbGx5IGRvbmUgZm9yIGFsbCBicm93c2Vycywgc2luY2UgcGFnZVgvcGFnZVkgaW5jbHVkZXMgdGhpcw0KICAgICAgICAgICAgLy8gaW5mb3JtYXRpb24gd2l0aCBhbiB1Z2x5IElFIGZpeA0KICAgICAgICAgICAgaWYgKCB0aGlzLm9mZnNldFBhcmVudFsgMCBdID09PSB0aGlzLmRvY3VtZW50WyAwIF0uYm9keSB8fA0KICAgICAgICAgICAgICAgICggdGhpcy5vZmZzZXRQYXJlbnRbIDAgXS50YWdOYW1lICYmDQogICAgICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0UGFyZW50WyAwIF0udGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAiaHRtbCIgJiYgJC51aS5pZSApICkgew0KICAgICAgICAgICAgICAgIHBvID0geyB0b3A6IDAsIGxlZnQ6IDAgfTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICB0b3A6IHBvLnRvcCArICggcGFyc2VJbnQoIHRoaXMub2Zmc2V0UGFyZW50LmNzcyggImJvcmRlclRvcFdpZHRoIiApLCAxMCApIHx8IDAgKSwNCiAgICAgICAgICAgICAgICBsZWZ0OiBwby5sZWZ0ICsgKCBwYXJzZUludCggdGhpcy5vZmZzZXRQYXJlbnQuY3NzKCAiYm9yZGVyTGVmdFdpZHRoIiApLCAxMCApIHx8IDAgKQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICB9LA0KDQogICAgICAgIF9nZXRSZWxhdGl2ZU9mZnNldDogZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gInJlbGF0aXZlIiApIHsNCiAgICAgICAgICAgICAgICB2YXIgcCA9IHRoaXMuY3VycmVudEl0ZW0ucG9zaXRpb24oKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICB0b3A6IHAudG9wIC0gKCBwYXJzZUludCggdGhpcy5oZWxwZXIuY3NzKCAidG9wIiApLCAxMCApIHx8IDAgKSArDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSwNCiAgICAgICAgICAgICAgICAgICAgbGVmdDogcC5sZWZ0IC0gKCBwYXJzZUludCggdGhpcy5oZWxwZXIuY3NzKCAibGVmdCIgKSwgMTAgKSB8fCAwICkgKw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsgdG9wOiAwLCBsZWZ0OiAwIH07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBfY2FjaGVNYXJnaW5zOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMubWFyZ2lucyA9IHsNCiAgICAgICAgICAgICAgICBsZWZ0OiAoIHBhcnNlSW50KCB0aGlzLmN1cnJlbnRJdGVtLmNzcyggIm1hcmdpbkxlZnQiICksIDEwICkgfHwgMCApLA0KICAgICAgICAgICAgICAgIHRvcDogKCBwYXJzZUludCggdGhpcy5jdXJyZW50SXRlbS5jc3MoICJtYXJnaW5Ub3AiICksIDEwICkgfHwgMCApDQogICAgICAgICAgICB9Ow0KICAgICAgICB9LA0KDQogICAgICAgIF9jYWNoZUhlbHBlclByb3BvcnRpb25zOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMgPSB7DQogICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMuaGVscGVyLm91dGVyV2lkdGgoKSwNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVscGVyLm91dGVySGVpZ2h0KCkNCiAgICAgICAgICAgIH07DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldENvbnRhaW5tZW50OiBmdW5jdGlvbigpIHsNCg0KICAgICAgICAgICAgdmFyIGNlLCBjbywgb3ZlciwNCiAgICAgICAgICAgICAgICBvID0gdGhpcy5vcHRpb25zOw0KICAgICAgICAgICAgaWYgKCBvLmNvbnRhaW5tZW50ID09PSAicGFyZW50IiApIHsNCiAgICAgICAgICAgICAgICBvLmNvbnRhaW5tZW50ID0gdGhpcy5oZWxwZXJbIDAgXS5wYXJlbnROb2RlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCBvLmNvbnRhaW5tZW50ID09PSAiZG9jdW1lbnQiIHx8IG8uY29udGFpbm1lbnQgPT09ICJ3aW5kb3ciICkgew0KICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbm1lbnQgPSBbDQogICAgICAgICAgICAgICAgICAgIDAgLSB0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0IC0gdGhpcy5vZmZzZXQucGFyZW50LmxlZnQsDQogICAgICAgICAgICAgICAgICAgIDAgLSB0aGlzLm9mZnNldC5yZWxhdGl2ZS50b3AgLSB0aGlzLm9mZnNldC5wYXJlbnQudG9wLA0KICAgICAgICAgICAgICAgICAgICBvLmNvbnRhaW5tZW50ID09PSAiZG9jdW1lbnQiID8NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQud2lkdGgoKSA6DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndpbmRvdy53aWR0aCgpIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIHRoaXMubWFyZ2lucy5sZWZ0LA0KICAgICAgICAgICAgICAgICAgICAoIG8uY29udGFpbm1lbnQgPT09ICJkb2N1bWVudCIgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICggdGhpcy5kb2N1bWVudC5oZWlnaHQoKSB8fCBkb2N1bWVudC5ib2R5LnBhcmVudE5vZGUuc2Nyb2xsSGVpZ2h0ICkgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2luZG93LmhlaWdodCgpIHx8IHRoaXMuZG9jdW1lbnRbIDAgXS5ib2R5LnBhcmVudE5vZGUuc2Nyb2xsSGVpZ2h0DQogICAgICAgICAgICAgICAgICAgICkgLSB0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAtIHRoaXMubWFyZ2lucy50b3ANCiAgICAgICAgICAgICAgICBdOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoICEoIC9eKGRvY3VtZW50fHdpbmRvd3xwYXJlbnQpJC8gKS50ZXN0KCBvLmNvbnRhaW5tZW50ICkgKSB7DQogICAgICAgICAgICAgICAgY2UgPSAkKCBvLmNvbnRhaW5tZW50IClbIDAgXTsNCiAgICAgICAgICAgICAgICBjbyA9ICQoIG8uY29udGFpbm1lbnQgKS5vZmZzZXQoKTsNCiAgICAgICAgICAgICAgICBvdmVyID0gKCAkKCBjZSApLmNzcyggIm92ZXJmbG93IiApICE9PSAiaGlkZGVuIiApOw0KDQogICAgICAgICAgICAgICAgdGhpcy5jb250YWlubWVudCA9IFsNCiAgICAgICAgICAgICAgICAgICAgY28ubGVmdCArICggcGFyc2VJbnQoICQoIGNlICkuY3NzKCAiYm9yZGVyTGVmdFdpZHRoIiApLCAxMCApIHx8IDAgKSArDQogICAgICAgICAgICAgICAgICAgICggcGFyc2VJbnQoICQoIGNlICkuY3NzKCAicGFkZGluZ0xlZnQiICksIDEwICkgfHwgMCApIC0gdGhpcy5tYXJnaW5zLmxlZnQsDQogICAgICAgICAgICAgICAgICAgIGNvLnRvcCArICggcGFyc2VJbnQoICQoIGNlICkuY3NzKCAiYm9yZGVyVG9wV2lkdGgiICksIDEwICkgfHwgMCApICsNCiAgICAgICAgICAgICAgICAgICAgKCBwYXJzZUludCggJCggY2UgKS5jc3MoICJwYWRkaW5nVG9wIiApLCAxMCApIHx8IDAgKSAtIHRoaXMubWFyZ2lucy50b3AsDQogICAgICAgICAgICAgICAgICAgIGNvLmxlZnQgKyAoIG92ZXIgPyBNYXRoLm1heCggY2Uuc2Nyb2xsV2lkdGgsIGNlLm9mZnNldFdpZHRoICkgOiBjZS5vZmZzZXRXaWR0aCApIC0NCiAgICAgICAgICAgICAgICAgICAgKCBwYXJzZUludCggJCggY2UgKS5jc3MoICJib3JkZXJMZWZ0V2lkdGgiICksIDEwICkgfHwgMCApIC0NCiAgICAgICAgICAgICAgICAgICAgKCBwYXJzZUludCggJCggY2UgKS5jc3MoICJwYWRkaW5nUmlnaHQiICksIDEwICkgfHwgMCApIC0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIHRoaXMubWFyZ2lucy5sZWZ0LA0KICAgICAgICAgICAgICAgICAgICBjby50b3AgKyAoIG92ZXIgPyBNYXRoLm1heCggY2Uuc2Nyb2xsSGVpZ2h0LCBjZS5vZmZzZXRIZWlnaHQgKSA6IGNlLm9mZnNldEhlaWdodCApIC0NCiAgICAgICAgICAgICAgICAgICAgKCBwYXJzZUludCggJCggY2UgKS5jc3MoICJib3JkZXJUb3BXaWR0aCIgKSwgMTAgKSB8fCAwICkgLQ0KICAgICAgICAgICAgICAgICAgICAoIHBhcnNlSW50KCAkKCBjZSApLmNzcyggInBhZGRpbmdCb3R0b20iICksIDEwICkgfHwgMCApIC0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLSB0aGlzLm1hcmdpbnMudG9wDQogICAgICAgICAgICAgICAgXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9LA0KDQogICAgICAgIF9jb252ZXJ0UG9zaXRpb25UbzogZnVuY3Rpb24oIGQsIHBvcyApIHsNCg0KICAgICAgICAgICAgaWYgKCAhcG9zICkgew0KICAgICAgICAgICAgICAgIHBvcyA9IHRoaXMucG9zaXRpb247DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgbW9kID0gZCA9PT0gImFic29sdXRlIiA/IDEgOiAtMSwNCiAgICAgICAgICAgICAgICBzY3JvbGwgPSB0aGlzLmNzc1Bvc2l0aW9uID09PSAiYWJzb2x1dGUiICYmDQogICAgICAgICAgICAgICAgISggdGhpcy5zY3JvbGxQYXJlbnRbIDAgXSAhPT0gdGhpcy5kb2N1bWVudFsgMCBdICYmDQogICAgICAgICAgICAgICAgICAgICQuY29udGFpbnMoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0sIHRoaXMub2Zmc2V0UGFyZW50WyAwIF0gKSApID8NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXRQYXJlbnQgOg0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFBhcmVudCwNCiAgICAgICAgICAgICAgICBzY3JvbGxJc1Jvb3ROb2RlID0gKCAvKGh0bWx8Ym9keSkvaSApLnRlc3QoIHNjcm9sbFsgMCBdLnRhZ05hbWUgKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICB0b3A6ICgNCg0KICAgICAgICAgICAgICAgICAgICAvLyBUaGUgYWJzb2x1dGUgbW91c2UgcG9zaXRpb24NCiAgICAgICAgICAgICAgICAgICAgcG9zLnRvcAkrDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gT25seSBmb3IgcmVsYXRpdmUgcG9zaXRpb25lZCBub2RlczogUmVsYXRpdmUgb2Zmc2V0IGZyb20gZWxlbWVudCB0byBvZmZzZXQgcGFyZW50DQogICAgICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCAqIG1vZCArDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIG9mZnNldFBhcmVudCdzIG9mZnNldCB3aXRob3V0IGJvcmRlcnMgKG9mZnNldCArIGJvcmRlcikNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQucGFyZW50LnRvcCAqIG1vZCAtDQogICAgICAgICAgICAgICAgICAgICggKCB0aGlzLmNzc1Bvc2l0aW9uID09PSAiZml4ZWQiID8NCiAgICAgICAgICAgICAgICAgICAgICAgIC10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSA6DQogICAgICAgICAgICAgICAgICAgICAgICAoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogc2Nyb2xsLnNjcm9sbFRvcCgpICkgKSAqIG1vZCApDQogICAgICAgICAgICAgICAgKSwNCiAgICAgICAgICAgICAgICBsZWZ0OiAoDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uDQogICAgICAgICAgICAgICAgICAgIHBvcy5sZWZ0ICsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnQNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdCAqIG1vZCArDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIG9mZnNldFBhcmVudCdzIG9mZnNldCB3aXRob3V0IGJvcmRlcnMgKG9mZnNldCArIGJvcmRlcikNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQucGFyZW50LmxlZnQgKiBtb2QJLQ0KICAgICAgICAgICAgICAgICAgICAoICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gImZpeGVkIiA/DQogICAgICAgICAgICAgICAgICAgICAgICAtdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpIDogc2Nyb2xsSXNSb290Tm9kZSA/IDAgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbC5zY3JvbGxMZWZ0KCkgKSAqIG1vZCApDQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICB9LA0KDQogICAgICAgIF9nZW5lcmF0ZVBvc2l0aW9uOiBmdW5jdGlvbiggZXZlbnQgKSB7DQoNCiAgICAgICAgICAgIHZhciB0b3AsIGxlZnQsDQogICAgICAgICAgICAgICAgbyA9IHRoaXMub3B0aW9ucywNCiAgICAgICAgICAgICAgICBwYWdlWCA9IGV2ZW50LnBhZ2VYLA0KICAgICAgICAgICAgICAgIHBhZ2VZID0gZXZlbnQucGFnZVksDQogICAgICAgICAgICAgICAgc2Nyb2xsID0gdGhpcy5jc3NQb3NpdGlvbiA9PT0gImFic29sdXRlIiAmJg0KICAgICAgICAgICAgICAgICEoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gIT09IHRoaXMuZG9jdW1lbnRbIDAgXSAmJg0KICAgICAgICAgICAgICAgICAgICAkLmNvbnRhaW5zKCB0aGlzLnNjcm9sbFBhcmVudFsgMCBdLCB0aGlzLm9mZnNldFBhcmVudFsgMCBdICkgKSA/DQogICAgICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0UGFyZW50IDoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxQYXJlbnQsDQogICAgICAgICAgICAgICAgc2Nyb2xsSXNSb290Tm9kZSA9ICggLyhodG1sfGJvZHkpL2kgKS50ZXN0KCBzY3JvbGxbIDAgXS50YWdOYW1lICk7DQoNCiAgICAgICAgICAgIC8vIFRoaXMgaXMgYW5vdGhlciB2ZXJ5IHdlaXJkIHNwZWNpYWwgY2FzZSB0aGF0IG9ubHkgaGFwcGVucyBmb3IgcmVsYXRpdmUgZWxlbWVudHM6DQogICAgICAgICAgICAvLyAxLiBJZiB0aGUgY3NzIHBvc2l0aW9uIGlzIHJlbGF0aXZlDQogICAgICAgICAgICAvLyAyLiBhbmQgdGhlIHNjcm9sbCBwYXJlbnQgaXMgdGhlIGRvY3VtZW50IG9yIHNpbWlsYXIgdG8gdGhlIG9mZnNldCBwYXJlbnQNCiAgICAgICAgICAgIC8vIHdlIGhhdmUgdG8gcmVmcmVzaCB0aGUgcmVsYXRpdmUgb2Zmc2V0IGR1cmluZyB0aGUgc2Nyb2xsIHNvIHRoZXJlIGFyZSBubyBqdW1wcw0KICAgICAgICAgICAgaWYgKCB0aGlzLmNzc1Bvc2l0aW9uID09PSAicmVsYXRpdmUiICYmICEoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gIT09IHRoaXMuZG9jdW1lbnRbIDAgXSAmJg0KICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gIT09IHRoaXMub2Zmc2V0UGFyZW50WyAwIF0gKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLm9mZnNldC5yZWxhdGl2ZSA9IHRoaXMuX2dldFJlbGF0aXZlT2Zmc2V0KCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qDQoJCSAqIC0gUG9zaXRpb24gY29uc3RyYWluaW5nIC0NCgkJICogQ29uc3RyYWluIHRoZSBwb3NpdGlvbiB0byBhIG1peCBvZiBncmlkLCBjb250YWlubWVudC4NCgkJICovDQoNCiAgICAgICAgICAgIGlmICggdGhpcy5vcmlnaW5hbFBvc2l0aW9uICkgeyAvL0lmIHdlIGFyZSBub3QgZHJhZ2dpbmcgeWV0LCB3ZSB3b24ndCBjaGVjayBmb3Igb3B0aW9ucw0KDQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLmNvbnRhaW5tZW50ICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIGV2ZW50LnBhZ2VYIC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA8IHRoaXMuY29udGFpbm1lbnRbIDAgXSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VYID0gdGhpcy5jb250YWlubWVudFsgMCBdICsgdGhpcy5vZmZzZXQuY2xpY2subGVmdDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIGV2ZW50LnBhZ2VZIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wIDwgdGhpcy5jb250YWlubWVudFsgMSBdICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcGFnZVkgPSB0aGlzLmNvbnRhaW5tZW50WyAxIF0gKyB0aGlzLm9mZnNldC5jbGljay50b3A7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCBldmVudC5wYWdlWCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPiB0aGlzLmNvbnRhaW5tZW50WyAyIF0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYWdlWCA9IHRoaXMuY29udGFpbm1lbnRbIDIgXSArIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCBldmVudC5wYWdlWSAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+IHRoaXMuY29udGFpbm1lbnRbIDMgXSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VZID0gdGhpcy5jb250YWlubWVudFsgMyBdICsgdGhpcy5vZmZzZXQuY2xpY2sudG9wOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCBvLmdyaWQgKSB7DQogICAgICAgICAgICAgICAgICAgIHRvcCA9IHRoaXMub3JpZ2luYWxQYWdlWSArIE1hdGgucm91bmQoICggcGFnZVkgLSB0aGlzLm9yaWdpbmFsUGFnZVkgKSAvDQogICAgICAgICAgICAgICAgICAgICAgICBvLmdyaWRbIDEgXSApICogby5ncmlkWyAxIF07DQogICAgICAgICAgICAgICAgICAgIHBhZ2VZID0gdGhpcy5jb250YWlubWVudCA/DQogICAgICAgICAgICAgICAgICAgICAgICAoICggdG9wIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wID49IHRoaXMuY29udGFpbm1lbnRbIDEgXSAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA8PSB0aGlzLmNvbnRhaW5tZW50WyAzIF0gKSA/DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoICggdG9wIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wID49IHRoaXMuY29udGFpbm1lbnRbIDEgXSApID8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wIC0gby5ncmlkWyAxIF0gOiB0b3AgKyBvLmdyaWRbIDEgXSApICkgOg0KICAgICAgICAgICAgICAgICAgICAgICAgdG9wOw0KDQogICAgICAgICAgICAgICAgICAgIGxlZnQgPSB0aGlzLm9yaWdpbmFsUGFnZVggKyBNYXRoLnJvdW5kKCAoIHBhZ2VYIC0gdGhpcy5vcmlnaW5hbFBhZ2VYICkgLw0KICAgICAgICAgICAgICAgICAgICAgICAgby5ncmlkWyAwIF0gKSAqIG8uZ3JpZFsgMCBdOw0KICAgICAgICAgICAgICAgICAgICBwYWdlWCA9IHRoaXMuY29udGFpbm1lbnQgPw0KICAgICAgICAgICAgICAgICAgICAgICAgKCAoIGxlZnQgLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID49IHRoaXMuY29udGFpbm1lbnRbIDAgXSAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQgLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0IDw9IHRoaXMuY29udGFpbm1lbnRbIDIgXSApID8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0IDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoICggbGVmdCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPj0gdGhpcy5jb250YWlubWVudFsgMCBdICkgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0IC0gby5ncmlkWyAwIF0gOiBsZWZ0ICsgby5ncmlkWyAwIF0gKSApIDoNCiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgdG9wOiAoDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uDQogICAgICAgICAgICAgICAgICAgIHBhZ2VZIC0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBDbGljayBvZmZzZXQgKHJlbGF0aXZlIHRvIHRoZSBlbGVtZW50KQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9mZnNldC5jbGljay50b3AgLQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudA0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9mZnNldC5yZWxhdGl2ZS50b3AgLQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpDQogICAgICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0LnBhcmVudC50b3AgKw0KICAgICAgICAgICAgICAgICAgICAoICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gImZpeGVkIiA/DQogICAgICAgICAgICAgICAgICAgICAgICAtdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCkgOg0KICAgICAgICAgICAgICAgICAgICAgICAgKCBzY3JvbGxJc1Jvb3ROb2RlID8gMCA6IHNjcm9sbC5zY3JvbGxUb3AoKSApICkgKQ0KICAgICAgICAgICAgICAgICksDQogICAgICAgICAgICAgICAgbGVmdDogKA0KDQogICAgICAgICAgICAgICAgICAgIC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvbg0KICAgICAgICAgICAgICAgICAgICBwYWdlWCAtDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gQ2xpY2sgb2Zmc2V0IChyZWxhdGl2ZSB0byB0aGUgZWxlbWVudCkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQuY2xpY2subGVmdCAtDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gT25seSBmb3IgcmVsYXRpdmUgcG9zaXRpb25lZCBub2RlczogUmVsYXRpdmUgb2Zmc2V0IGZyb20gZWxlbWVudCB0byBvZmZzZXQgcGFyZW50DQogICAgICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQgLQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpDQogICAgICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0LnBhcmVudC5sZWZ0ICsNCiAgICAgICAgICAgICAgICAgICAgKCAoIHRoaXMuY3NzUG9zaXRpb24gPT09ICJmaXhlZCIgPw0KICAgICAgICAgICAgICAgICAgICAgICAgLXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKSA6DQogICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxJc1Jvb3ROb2RlID8gMCA6IHNjcm9sbC5zY3JvbGxMZWZ0KCkgKSApDQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICB9LA0KDQogICAgICAgIF9yZWFycmFuZ2U6IGZ1bmN0aW9uKCBldmVudCwgaSwgYSwgaGFyZFJlZnJlc2ggKSB7DQoNCiAgICAgICAgICAgIGEgPyBhWyAwIF0uYXBwZW5kQ2hpbGQoIHRoaXMucGxhY2Vob2xkZXJbIDAgXSApIDoNCiAgICAgICAgICAgICAgICBpLml0ZW1bIDAgXS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSggdGhpcy5wbGFjZWhvbGRlclsgMCBdLA0KICAgICAgICAgICAgICAgICAgICAoIHRoaXMuZGlyZWN0aW9uID09PSAiZG93biIgPyBpLml0ZW1bIDAgXSA6IGkuaXRlbVsgMCBdLm5leHRTaWJsaW5nICkgKTsNCg0KICAgICAgICAgICAgLy9WYXJpb3VzIHRoaW5ncyBkb25lIGhlcmUgdG8gaW1wcm92ZSB0aGUgcGVyZm9ybWFuY2U6DQogICAgICAgICAgICAvLyAxLiB3ZSBjcmVhdGUgYSBzZXRUaW1lb3V0LCB0aGF0IGNhbGxzIHJlZnJlc2hQb3NpdGlvbnMNCiAgICAgICAgICAgIC8vIDIuIG9uIHRoZSBpbnN0YW5jZSwgd2UgaGF2ZSBhIGNvdW50ZXIgdmFyaWFibGUsIHRoYXQgZ2V0J3MgaGlnaGVyIGFmdGVyIGV2ZXJ5IGFwcGVuZA0KICAgICAgICAgICAgLy8gMy4gb24gdGhlIGxvY2FsIHNjb3BlLCB3ZSBjb3B5IHRoZSBjb3VudGVyIHZhcmlhYmxlLCBhbmQgY2hlY2sgaW4gdGhlIHRpbWVvdXQsDQogICAgICAgICAgICAvLyBpZiBpdCdzIHN0aWxsIHRoZSBzYW1lDQogICAgICAgICAgICAvLyA0LiB0aGlzIGxldHMgb25seSB0aGUgbGFzdCBhZGRpdGlvbiB0byB0aGUgdGltZW91dCBzdGFjayB0aHJvdWdoDQogICAgICAgICAgICB0aGlzLmNvdW50ZXIgPSB0aGlzLmNvdW50ZXIgPyArK3RoaXMuY291bnRlciA6IDE7DQogICAgICAgICAgICB2YXIgY291bnRlciA9IHRoaXMuY291bnRlcjsNCg0KICAgICAgICAgICAgdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGlmICggY291bnRlciA9PT0gdGhpcy5jb3VudGVyICkgew0KDQogICAgICAgICAgICAgICAgICAgIC8vUHJlY29tcHV0ZSBhZnRlciBlYWNoIERPTSBpbnNlcnRpb24sIE5PVCBvbiBtb3VzZW1vdmUNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoUG9zaXRpb25zKCAhaGFyZFJlZnJlc2ggKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBfY2xlYXI6IGZ1bmN0aW9uKCBldmVudCwgbm9Qcm9wYWdhdGlvbiApIHsNCg0KICAgICAgICAgICAgdGhpcy5yZXZlcnRpbmcgPSBmYWxzZTsNCg0KICAgICAgICAgICAgLy8gV2UgZGVsYXkgYWxsIGV2ZW50cyB0aGF0IGhhdmUgdG8gYmUgdHJpZ2dlcmVkIHRvIGFmdGVyIHRoZSBwb2ludCB3aGVyZSB0aGUgcGxhY2Vob2xkZXINCiAgICAgICAgICAgIC8vIGhhcyBiZWVuIHJlbW92ZWQgYW5kIGV2ZXJ5dGhpbmcgZWxzZSBub3JtYWxpemVkIGFnYWluDQogICAgICAgICAgICB2YXIgaSwNCiAgICAgICAgICAgICAgICBkZWxheWVkVHJpZ2dlcnMgPSBbXTsNCg0KICAgICAgICAgICAgLy8gV2UgZmlyc3QgaGF2ZSB0byB1cGRhdGUgdGhlIGRvbSBwb3NpdGlvbiBvZiB0aGUgYWN0dWFsIGN1cnJlbnRJdGVtDQogICAgICAgICAgICAvLyBOb3RlOiBkb24ndCBkbyBpdCBpZiB0aGUgY3VycmVudCBpdGVtIGlzIGFscmVhZHkgcmVtb3ZlZCAoYnkgYSB1c2VyKSwgb3IgaXQgZ2V0cw0KICAgICAgICAgICAgLy8gcmVhcHBlbmRlZCAoc2VlICM0MDg4KQ0KICAgICAgICAgICAgaWYgKCAhdGhpcy5fbm9GaW5hbFNvcnQgJiYgdGhpcy5jdXJyZW50SXRlbS5wYXJlbnQoKS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgdGhpcy5wbGFjZWhvbGRlci5iZWZvcmUoIHRoaXMuY3VycmVudEl0ZW0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX25vRmluYWxTb3J0ID0gbnVsbDsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLmhlbHBlclsgMCBdID09PSB0aGlzLmN1cnJlbnRJdGVtWyAwIF0gKSB7DQogICAgICAgICAgICAgICAgZm9yICggaSBpbiB0aGlzLl9zdG9yZWRDU1MgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5fc3RvcmVkQ1NTWyBpIF0gPT09ICJhdXRvIiB8fCB0aGlzLl9zdG9yZWRDU1NbIGkgXSA9PT0gInN0YXRpYyIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdG9yZWRDU1NbIGkgXSA9ICIiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEl0ZW0uY3NzKCB0aGlzLl9zdG9yZWRDU1MgKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5jdXJyZW50SXRlbSwgInVpLXNvcnRhYmxlLWhlbHBlciIgKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SXRlbS5zaG93KCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5mcm9tT3V0c2lkZSAmJiAhbm9Qcm9wYWdhdGlvbiApIHsNCiAgICAgICAgICAgICAgICBkZWxheWVkVHJpZ2dlcnMucHVzaCggZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAicmVjZWl2ZSIsIGV2ZW50LCB0aGlzLl91aUhhc2goIHRoaXMuZnJvbU91dHNpZGUgKSApOw0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggKCB0aGlzLmZyb21PdXRzaWRlIHx8DQogICAgICAgICAgICAgICAgdGhpcy5kb21Qb3NpdGlvbi5wcmV2ICE9PQ0KICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEl0ZW0ucHJldigpLm5vdCggIi51aS1zb3J0YWJsZS1oZWxwZXIiIClbIDAgXSB8fA0KICAgICAgICAgICAgICAgIHRoaXMuZG9tUG9zaXRpb24ucGFyZW50ICE9PSB0aGlzLmN1cnJlbnRJdGVtLnBhcmVudCgpWyAwIF0gKSAmJiAhbm9Qcm9wYWdhdGlvbiApIHsNCg0KICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdXBkYXRlIGNhbGxiYWNrIGlmIHRoZSBET00gcG9zaXRpb24gaGFzIGNoYW5nZWQNCiAgICAgICAgICAgICAgICBkZWxheWVkVHJpZ2dlcnMucHVzaCggZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAidXBkYXRlIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpICk7DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgaXRlbXMgQ29udGFpbmVyIGhhcyBDaGFuZ2VkIGFuZCB0cmlnZ2VyIGFwcHJvcHJpYXRlDQogICAgICAgICAgICAvLyBldmVudHMuDQogICAgICAgICAgICBpZiAoIHRoaXMgIT09IHRoaXMuY3VycmVudENvbnRhaW5lciApIHsNCiAgICAgICAgICAgICAgICBpZiAoICFub1Byb3BhZ2F0aW9uICkgew0KICAgICAgICAgICAgICAgICAgICBkZWxheWVkVHJpZ2dlcnMucHVzaCggZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdHJpZ2dlciggInJlbW92ZSIsIGV2ZW50LCB0aGlzLl91aUhhc2goKSApOw0KICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgICAgIGRlbGF5ZWRUcmlnZ2Vycy5wdXNoKCAoIGZ1bmN0aW9uKCBjICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLl90cmlnZ2VyKCAicmVjZWl2ZSIsIGV2ZW50LCB0aGlzLl91aUhhc2goIHRoaXMgKSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgfSApLmNhbGwoIHRoaXMsIHRoaXMuY3VycmVudENvbnRhaW5lciApICk7DQogICAgICAgICAgICAgICAgICAgIGRlbGF5ZWRUcmlnZ2Vycy5wdXNoKCAoIGZ1bmN0aW9uKCBjICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLl90cmlnZ2VyKCAidXBkYXRlIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCggdGhpcyApICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICB9ICkuY2FsbCggdGhpcywgdGhpcy5jdXJyZW50Q29udGFpbmVyICkgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vUG9zdCBldmVudHMgdG8gY29udGFpbmVycw0KICAgICAgICAgICAgZnVuY3Rpb24gZGVsYXlFdmVudCggdHlwZSwgaW5zdGFuY2UsIGNvbnRhaW5lciApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuX3RyaWdnZXIoIHR5cGUsIGV2ZW50LCBpbnN0YW5jZS5fdWlIYXNoKCBpbnN0YW5jZSApICk7DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGZvciAoIGkgPSB0aGlzLmNvbnRhaW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7DQogICAgICAgICAgICAgICAgaWYgKCAhbm9Qcm9wYWdhdGlvbiApIHsNCiAgICAgICAgICAgICAgICAgICAgZGVsYXllZFRyaWdnZXJzLnB1c2goIGRlbGF5RXZlbnQoICJkZWFjdGl2YXRlIiwgdGhpcywgdGhpcy5jb250YWluZXJzWyBpIF0gKSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuY29udGFpbmVyc1sgaSBdLmNvbnRhaW5lckNhY2hlLm92ZXIgKSB7DQogICAgICAgICAgICAgICAgICAgIGRlbGF5ZWRUcmlnZ2Vycy5wdXNoKCBkZWxheUV2ZW50KCAib3V0IiwgdGhpcywgdGhpcy5jb250YWluZXJzWyBpIF0gKSApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lcnNbIGkgXS5jb250YWluZXJDYWNoZS5vdmVyID0gMDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vRG8gd2hhdCB3YXMgb3JpZ2luYWxseSBpbiBwbHVnaW5zDQogICAgICAgICAgICBpZiAoIHRoaXMuc3RvcmVkQ3Vyc29yICkgew0KICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQuZmluZCggImJvZHkiICkuY3NzKCAiY3Vyc29yIiwgdGhpcy5zdG9yZWRDdXJzb3IgKTsNCiAgICAgICAgICAgICAgICB0aGlzLnN0b3JlZFN0eWxlc2hlZXQucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIHRoaXMuX3N0b3JlZE9wYWNpdHkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5oZWxwZXIuY3NzKCAib3BhY2l0eSIsIHRoaXMuX3N0b3JlZE9wYWNpdHkgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggdGhpcy5fc3RvcmVkWkluZGV4ICkgew0KICAgICAgICAgICAgICAgIHRoaXMuaGVscGVyLmNzcyggInpJbmRleCIsIHRoaXMuX3N0b3JlZFpJbmRleCA9PT0gImF1dG8iID8gIiIgOiB0aGlzLl9zdG9yZWRaSW5kZXggKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5kcmFnZ2luZyA9IGZhbHNlOw0KDQogICAgICAgICAgICBpZiAoICFub1Byb3BhZ2F0aW9uICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJiZWZvcmVTdG9wIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vJCh0aGlzLnBsYWNlaG9sZGVyWzBdKS5yZW1vdmUoKTsgd291bGQgaGF2ZSBiZWVuIHRoZSBqUXVlcnkgd2F5IC0gdW5mb3J0dW5hdGVseSwNCiAgICAgICAgICAgIC8vIGl0IHVuYmluZHMgQUxMIGV2ZW50cyBmcm9tIHRoZSBvcmlnaW5hbCBub2RlIQ0KICAgICAgICAgICAgdGhpcy5wbGFjZWhvbGRlclsgMCBdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIHRoaXMucGxhY2Vob2xkZXJbIDAgXSApOw0KDQogICAgICAgICAgICBpZiAoICF0aGlzLmNhbmNlbEhlbHBlclJlbW92YWwgKSB7DQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLmhlbHBlclsgMCBdICE9PSB0aGlzLmN1cnJlbnRJdGVtWyAwIF0gKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaGVscGVyLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLmhlbHBlciA9IG51bGw7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggIW5vUHJvcGFnYXRpb24gKSB7DQogICAgICAgICAgICAgICAgZm9yICggaSA9IDA7IGkgPCBkZWxheWVkVHJpZ2dlcnMubGVuZ3RoOyBpKysgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gVHJpZ2dlciBhbGwgZGVsYXllZCBldmVudHMNCiAgICAgICAgICAgICAgICAgICAgZGVsYXllZFRyaWdnZXJzWyBpIF0uY2FsbCggdGhpcywgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5fdHJpZ2dlciggInN0b3AiLCBldmVudCwgdGhpcy5fdWlIYXNoKCkgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5mcm9tT3V0c2lkZSA9IGZhbHNlOw0KICAgICAgICAgICAgcmV0dXJuICF0aGlzLmNhbmNlbEhlbHBlclJlbW92YWw7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBfdHJpZ2dlcjogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBpZiAoICQuV2lkZ2V0LnByb3RvdHlwZS5fdHJpZ2dlci5hcHBseSggdGhpcywgYXJndW1lbnRzICkgPT09IGZhbHNlICkgew0KICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX3VpSGFzaDogZnVuY3Rpb24oIF9pbnN0ICkgew0KICAgICAgICAgICAgdmFyIGluc3QgPSBfaW5zdCB8fCB0aGlzOw0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBoZWxwZXI6IGluc3QuaGVscGVyLA0KICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBpbnN0LnBsYWNlaG9sZGVyIHx8ICQoIFtdICksDQogICAgICAgICAgICAgICAgcG9zaXRpb246IGluc3QucG9zaXRpb24sDQogICAgICAgICAgICAgICAgb3JpZ2luYWxQb3NpdGlvbjogaW5zdC5vcmlnaW5hbFBvc2l0aW9uLA0KICAgICAgICAgICAgICAgIG9mZnNldDogaW5zdC5wb3NpdGlvbkFicywNCiAgICAgICAgICAgICAgICBpdGVtOiBpbnN0LmN1cnJlbnRJdGVtLA0KICAgICAgICAgICAgICAgIHNlbmRlcjogX2luc3QgPyBfaW5zdC5lbGVtZW50IDogbnVsbA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KDQogICAgfSApOw0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBTcGlubmVyIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBTcGlubmVyDQovLz4+Z3JvdXA6IFdpZGdldHMNCi8vPj5kZXNjcmlwdGlvbjogRGlzcGxheXMgYnV0dG9ucyB0byBlYXNpbHkgaW5wdXQgbnVtYmVycyB2aWEgdGhlIGtleWJvYXJkIG9yIG1vdXNlLg0KLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL3NwaW5uZXIvDQovLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vc3Bpbm5lci8NCi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9jb3JlLmNzcw0KLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL3NwaW5uZXIuY3NzDQovLz4+Y3NzLnRoZW1lOiAuLi8uLi90aGVtZXMvYmFzZS90aGVtZS5jc3MNCg0KDQoNCiAgICBmdW5jdGlvbiBzcGlubmVyTW9kaWZlciggZm4gKSB7DQogICAgICAgIHJldHVybiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBwcmV2aW91cyA9IHRoaXMuZWxlbWVudC52YWwoKTsNCiAgICAgICAgICAgIGZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsNCiAgICAgICAgICAgIHRoaXMuX3JlZnJlc2goKTsNCiAgICAgICAgICAgIGlmICggcHJldmlvdXMgIT09IHRoaXMuZWxlbWVudC52YWwoKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAiY2hhbmdlIiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgICQud2lkZ2V0KCAidWkuc3Bpbm5lciIsIHsNCiAgICAgICAgdmVyc2lvbjogIjEuMTIuMSIsDQogICAgICAgIGRlZmF1bHRFbGVtZW50OiAiPGlucHV0PiIsDQogICAgICAgIHdpZGdldEV2ZW50UHJlZml4OiAic3BpbiIsDQogICAgICAgIG9wdGlvbnM6IHsNCiAgICAgICAgICAgIGNsYXNzZXM6IHsNCiAgICAgICAgICAgICAgICAidWktc3Bpbm5lciI6ICJ1aS1jb3JuZXItYWxsIiwNCiAgICAgICAgICAgICAgICAidWktc3Bpbm5lci1kb3duIjogInVpLWNvcm5lci1iciIsDQogICAgICAgICAgICAgICAgInVpLXNwaW5uZXItdXAiOiAidWktY29ybmVyLXRyIg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGN1bHR1cmU6IG51bGwsDQogICAgICAgICAgICBpY29uczogew0KICAgICAgICAgICAgICAgIGRvd246ICJ1aS1pY29uLXRyaWFuZ2xlLTEtcyIsDQogICAgICAgICAgICAgICAgdXA6ICJ1aS1pY29uLXRyaWFuZ2xlLTEtbiINCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBpbmNyZW1lbnRhbDogdHJ1ZSwNCiAgICAgICAgICAgIG1heDogbnVsbCwNCiAgICAgICAgICAgIG1pbjogbnVsbCwNCiAgICAgICAgICAgIG51bWJlckZvcm1hdDogbnVsbCwNCiAgICAgICAgICAgIHBhZ2U6IDEwLA0KICAgICAgICAgICAgc3RlcDogMSwNCg0KICAgICAgICAgICAgY2hhbmdlOiBudWxsLA0KICAgICAgICAgICAgc3BpbjogbnVsbCwNCiAgICAgICAgICAgIHN0YXJ0OiBudWxsLA0KICAgICAgICAgICAgc3RvcDogbnVsbA0KICAgICAgICB9LA0KDQogICAgICAgIF9jcmVhdGU6IGZ1bmN0aW9uKCkgew0KDQogICAgICAgICAgICAvLyBoYW5kbGUgc3RyaW5nIHZhbHVlcyB0aGF0IG5lZWQgdG8gYmUgcGFyc2VkDQogICAgICAgICAgICB0aGlzLl9zZXRPcHRpb24oICJtYXgiLCB0aGlzLm9wdGlvbnMubWF4ICk7DQogICAgICAgICAgICB0aGlzLl9zZXRPcHRpb24oICJtaW4iLCB0aGlzLm9wdGlvbnMubWluICk7DQogICAgICAgICAgICB0aGlzLl9zZXRPcHRpb24oICJzdGVwIiwgdGhpcy5vcHRpb25zLnN0ZXAgKTsNCg0KICAgICAgICAgICAgLy8gT25seSBmb3JtYXQgaWYgdGhlcmUgaXMgYSB2YWx1ZSwgcHJldmVudHMgdGhlIGZpZWxkIGZyb20gYmVpbmcgbWFya2VkDQogICAgICAgICAgICAvLyBhcyBpbnZhbGlkIGluIEZpcmVmb3gsIHNlZSAjOTU3My4NCiAgICAgICAgICAgIGlmICggdGhpcy52YWx1ZSgpICE9PSAiIiApIHsNCg0KICAgICAgICAgICAgICAgIC8vIEZvcm1hdCB0aGUgdmFsdWUsIGJ1dCBkb24ndCBjb25zdHJhaW4uDQogICAgICAgICAgICAgICAgdGhpcy5fdmFsdWUoIHRoaXMuZWxlbWVudC52YWwoKSwgdHJ1ZSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLl9kcmF3KCk7DQogICAgICAgICAgICB0aGlzLl9vbiggdGhpcy5fZXZlbnRzICk7DQogICAgICAgICAgICB0aGlzLl9yZWZyZXNoKCk7DQoNCiAgICAgICAgICAgIC8vIFR1cm5pbmcgb2ZmIGF1dG9jb21wbGV0ZSBwcmV2ZW50cyB0aGUgYnJvd3NlciBmcm9tIHJlbWVtYmVyaW5nIHRoZQ0KICAgICAgICAgICAgLy8gdmFsdWUgd2hlbiBuYXZpZ2F0aW5nIHRocm91Z2ggaGlzdG9yeSwgc28gd2UgcmUtZW5hYmxlIGF1dG9jb21wbGV0ZQ0KICAgICAgICAgICAgLy8gaWYgdGhlIHBhZ2UgaXMgdW5sb2FkZWQgYmVmb3JlIHRoZSB3aWRnZXQgaXMgZGVzdHJveWVkLiAjNzc5MA0KICAgICAgICAgICAgdGhpcy5fb24oIHRoaXMud2luZG93LCB7DQogICAgICAgICAgICAgICAgYmVmb3JldW5sb2FkOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoICJhdXRvY29tcGxldGUiICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9nZXRDcmVhdGVPcHRpb25zOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5fc3VwZXIoKTsNCiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50Ow0KDQogICAgICAgICAgICAkLmVhY2goIFsgIm1pbiIsICJtYXgiLCAic3RlcCIgXSwgZnVuY3Rpb24oIGksIG9wdGlvbiApIHsNCiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBlbGVtZW50LmF0dHIoIG9wdGlvbiApOw0KICAgICAgICAgICAgICAgIGlmICggdmFsdWUgIT0gbnVsbCAmJiB2YWx1ZS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbnNbIG9wdGlvbiBdID0gdmFsdWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICByZXR1cm4gb3B0aW9uczsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZXZlbnRzOiB7DQogICAgICAgICAgICBrZXlkb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLl9zdGFydCggZXZlbnQgKSAmJiB0aGlzLl9rZXlkb3duKCBldmVudCApICkgew0KICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBrZXl1cDogIl9zdG9wIiwNCiAgICAgICAgICAgIGZvY3VzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnByZXZpb3VzID0gdGhpcy5lbGVtZW50LnZhbCgpOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGJsdXI6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuY2FuY2VsQmx1ciApIHsNCiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuY2FuY2VsQmx1cjsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHRoaXMuX3N0b3AoKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9yZWZyZXNoKCk7DQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLnByZXZpb3VzICE9PSB0aGlzLmVsZW1lbnQudmFsKCkgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3RyaWdnZXIoICJjaGFuZ2UiLCBldmVudCApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBtb3VzZXdoZWVsOiBmdW5jdGlvbiggZXZlbnQsIGRlbHRhICkgew0KICAgICAgICAgICAgICAgIGlmICggIWRlbHRhICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICggIXRoaXMuc3Bpbm5pbmcgJiYgIXRoaXMuX3N0YXJ0KCBldmVudCApICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdGhpcy5fc3BpbiggKCBkZWx0YSA+IDAgPyAxIDogLTEgKSAqIHRoaXMub3B0aW9ucy5zdGVwLCBldmVudCApOw0KICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCggdGhpcy5tb3VzZXdoZWVsVGltZXIgKTsNCiAgICAgICAgICAgICAgICB0aGlzLm1vdXNld2hlZWxUaW1lciA9IHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLnNwaW5uaW5nICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RvcCggZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sIDEwMCApOw0KICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgIm1vdXNlZG93biAudWktc3Bpbm5lci1idXR0b24iOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgdmFyIHByZXZpb3VzOw0KDQogICAgICAgICAgICAgICAgLy8gV2UgbmV2ZXIgd2FudCB0aGUgYnV0dG9ucyB0byBoYXZlIGZvY3VzOyB3aGVuZXZlciB0aGUgdXNlciBpcw0KICAgICAgICAgICAgICAgIC8vIGludGVyYWN0aW5nIHdpdGggdGhlIHNwaW5uZXIsIHRoZSBmb2N1cyBzaG91bGQgYmUgb24gdGhlIGlucHV0Lg0KICAgICAgICAgICAgICAgIC8vIElmIHRoZSBpbnB1dCBpcyBmb2N1c2VkIHRoZW4gdGhpcy5wcmV2aW91cyBpcyBwcm9wZXJseSBzZXQgZnJvbQ0KICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGlucHV0IGZpcnN0IHJlY2VpdmVkIGZvY3VzLiBJZiB0aGUgaW5wdXQgaXMgbm90IGZvY3VzZWQNCiAgICAgICAgICAgICAgICAvLyB0aGVuIHdlIG5lZWQgdG8gc2V0IHRoaXMucHJldmlvdXMgYmFzZWQgb24gdGhlIHZhbHVlIGJlZm9yZSBzcGlubmluZy4NCiAgICAgICAgICAgICAgICBwcmV2aW91cyA9IHRoaXMuZWxlbWVudFsgMCBdID09PSAkLnVpLnNhZmVBY3RpdmVFbGVtZW50KCB0aGlzLmRvY3VtZW50WyAwIF0gKSA/DQogICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlvdXMgOiB0aGlzLmVsZW1lbnQudmFsKCk7DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tGb2N1cygpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gdGhpcy5lbGVtZW50WyAwIF0gPT09ICQudWkuc2FmZUFjdGl2ZUVsZW1lbnQoIHRoaXMuZG9jdW1lbnRbIDAgXSApOw0KICAgICAgICAgICAgICAgICAgICBpZiAoICFpc0FjdGl2ZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC50cmlnZ2VyKCAiZm9jdXMiICk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpb3VzID0gcHJldmlvdXM7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN1cHBvcnQ6IElFDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBJRSBzZXRzIGZvY3VzIGFzeW5jaHJvbm91c2x5LCBzbyB3ZSBuZWVkIHRvIGNoZWNrIGlmIGZvY3VzDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3ZlZCBvZmYgb2YgdGhlIGlucHV0IGJlY2F1c2UgdGhlIHVzZXIgY2xpY2tlZCBvbiB0aGUgYnV0dG9uLg0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlvdXMgPSBwcmV2aW91czsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIEVuc3VyZSBmb2N1cyBpcyBvbiAob3Igc3RheXMgb24pIHRoZSB0ZXh0IGZpZWxkDQogICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICBjaGVja0ZvY3VzLmNhbGwoIHRoaXMgKTsNCg0KICAgICAgICAgICAgICAgIC8vIFN1cHBvcnQ6IElFDQogICAgICAgICAgICAgICAgLy8gSUUgZG9lc24ndCBwcmV2ZW50IG1vdmluZyBmb2N1cyBldmVuIHdpdGggZXZlbnQucHJldmVudERlZmF1bHQoKQ0KICAgICAgICAgICAgICAgIC8vIHNvIHdlIHNldCBhIGZsYWcgdG8ga25vdyB3aGVuIHdlIHNob3VsZCBpZ25vcmUgdGhlIGJsdXIgZXZlbnQNCiAgICAgICAgICAgICAgICAvLyBhbmQgY2hlY2sgKGFnYWluKSBpZiBmb2N1cyBtb3ZlZCBvZmYgb2YgdGhlIGlucHV0Lg0KICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsQmx1ciA9IHRydWU7DQogICAgICAgICAgICAgICAgdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5jYW5jZWxCbHVyOw0KICAgICAgICAgICAgICAgICAgICBjaGVja0ZvY3VzLmNhbGwoIHRoaXMgKTsNCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuX3N0YXJ0KCBldmVudCApID09PSBmYWxzZSApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHRoaXMuX3JlcGVhdCggbnVsbCwgJCggZXZlbnQuY3VycmVudFRhcmdldCApDQogICAgICAgICAgICAgICAgICAgIC5oYXNDbGFzcyggInVpLXNwaW5uZXItdXAiICkgPyAxIDogLTEsIGV2ZW50ICk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgIm1vdXNldXAgLnVpLXNwaW5uZXItYnV0dG9uIjogIl9zdG9wIiwNCiAgICAgICAgICAgICJtb3VzZWVudGVyIC51aS1zcGlubmVyLWJ1dHRvbiI6IGZ1bmN0aW9uKCBldmVudCApIHsNCg0KICAgICAgICAgICAgICAgIC8vIGJ1dHRvbiB3aWxsIGFkZCB1aS1zdGF0ZS1hY3RpdmUgaWYgbW91c2Ugd2FzIGRvd24gd2hpbGUgbW91c2VsZWF2ZSBhbmQga2VwdCBkb3duDQogICAgICAgICAgICAgICAgaWYgKCAhJCggZXZlbnQuY3VycmVudFRhcmdldCApLmhhc0NsYXNzKCAidWktc3RhdGUtYWN0aXZlIiApICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLl9zdGFydCggZXZlbnQgKSA9PT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5fcmVwZWF0KCBudWxsLCAkKCBldmVudC5jdXJyZW50VGFyZ2V0ICkNCiAgICAgICAgICAgICAgICAgICAgLmhhc0NsYXNzKCAidWktc3Bpbm5lci11cCIgKSA/IDEgOiAtMSwgZXZlbnQgKTsNCiAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgIC8vIFRPRE86IGRvIHdlIHJlYWxseSB3YW50IHRvIGNvbnNpZGVyIHRoaXMgYSBzdG9wPw0KICAgICAgICAgICAgLy8gc2hvdWxkbid0IHdlIGp1c3Qgc3RvcCB0aGUgcmVwZWF0ZXIgYW5kIHdhaXQgdW50aWwgbW91c2V1cCBiZWZvcmUNCiAgICAgICAgICAgIC8vIHdlIHRyaWdnZXIgdGhlIHN0b3AgZXZlbnQ/DQogICAgICAgICAgICAibW91c2VsZWF2ZSAudWktc3Bpbm5lci1idXR0b24iOiAiX3N0b3AiDQogICAgICAgIH0sDQoNCiAgICAgICAgLy8gU3VwcG9ydCBtb2JpbGUgZW5oYW5jZWQgb3B0aW9uIGFuZCBtYWtlIGJhY2tjb21wYXQgbW9yZSBzYW5lDQogICAgICAgIF9lbmhhbmNlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMudWlTcGlubmVyID0gdGhpcy5lbGVtZW50DQogICAgICAgICAgICAgICAgLmF0dHIoICJhdXRvY29tcGxldGUiLCAib2ZmIiApDQogICAgICAgICAgICAgICAgLndyYXAoICI8c3Bhbj4iICkNCiAgICAgICAgICAgICAgICAucGFyZW50KCkNCg0KICAgICAgICAgICAgICAgIC8vIEFkZCBidXR0b25zDQogICAgICAgICAgICAgICAgLmFwcGVuZCgNCiAgICAgICAgICAgICAgICAgICAgIjxhPjwvYT48YT48L2E+Ig0KICAgICAgICAgICAgICAgICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2RyYXc6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5fZW5oYW5jZSgpOw0KDQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy51aVNwaW5uZXIsICJ1aS1zcGlubmVyIiwgInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCIgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCAidWktc3Bpbm5lci1pbnB1dCIgKTsNCg0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LmF0dHIoICJyb2xlIiwgInNwaW5idXR0b24iICk7DQoNCiAgICAgICAgICAgIC8vIEJ1dHRvbiBiaW5kaW5ncw0KICAgICAgICAgICAgdGhpcy5idXR0b25zID0gdGhpcy51aVNwaW5uZXIuY2hpbGRyZW4oICJhIiApDQogICAgICAgICAgICAgICAgLmF0dHIoICJ0YWJJbmRleCIsIC0xICkNCiAgICAgICAgICAgICAgICAuYXR0ciggImFyaWEtaGlkZGVuIiwgdHJ1ZSApDQogICAgICAgICAgICAgICAgLmJ1dHRvbiggew0KICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAidWktYnV0dG9uIjogIiINCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgLy8gVE9ETzogUmlnaHQgbm93IGJ1dHRvbiBkb2VzIG5vdCBzdXBwb3J0IGNsYXNzZXMgdGhpcyBpcyBhbHJlYWR5IHVwZGF0ZWQgaW4gYnV0dG9uIFBSDQogICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5idXR0b25zLCAidWktY29ybmVyLWFsbCIgKTsNCg0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMuYnV0dG9ucy5maXJzdCgpLCAidWktc3Bpbm5lci1idXR0b24gdWktc3Bpbm5lci11cCIgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLmJ1dHRvbnMubGFzdCgpLCAidWktc3Bpbm5lci1idXR0b24gdWktc3Bpbm5lci1kb3duIiApOw0KICAgICAgICAgICAgdGhpcy5idXR0b25zLmZpcnN0KCkuYnV0dG9uKCB7DQogICAgICAgICAgICAgICAgImljb24iOiB0aGlzLm9wdGlvbnMuaWNvbnMudXAsDQogICAgICAgICAgICAgICAgInNob3dMYWJlbCI6IGZhbHNlDQogICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB0aGlzLmJ1dHRvbnMubGFzdCgpLmJ1dHRvbiggew0KICAgICAgICAgICAgICAgICJpY29uIjogdGhpcy5vcHRpb25zLmljb25zLmRvd24sDQogICAgICAgICAgICAgICAgInNob3dMYWJlbCI6IGZhbHNlDQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIC8vIElFIDYgZG9lc24ndCB1bmRlcnN0YW5kIGhlaWdodDogNTAlIGZvciB0aGUgYnV0dG9ucw0KICAgICAgICAgICAgLy8gdW5sZXNzIHRoZSB3cmFwcGVyIGhhcyBhbiBleHBsaWNpdCBoZWlnaHQNCiAgICAgICAgICAgIGlmICggdGhpcy5idXR0b25zLmhlaWdodCgpID4gTWF0aC5jZWlsKCB0aGlzLnVpU3Bpbm5lci5oZWlnaHQoKSAqIDAuNSApICYmDQogICAgICAgICAgICAgICAgdGhpcy51aVNwaW5uZXIuaGVpZ2h0KCkgPiAwICkgew0KICAgICAgICAgICAgICAgIHRoaXMudWlTcGlubmVyLmhlaWdodCggdGhpcy51aVNwaW5uZXIuaGVpZ2h0KCkgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfa2V5ZG93bjogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsDQogICAgICAgICAgICAgICAga2V5Q29kZSA9ICQudWkua2V5Q29kZTsNCg0KICAgICAgICAgICAgc3dpdGNoICggZXZlbnQua2V5Q29kZSApIHsNCiAgICAgICAgICAgICAgICBjYXNlIGtleUNvZGUuVVA6DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlcGVhdCggbnVsbCwgMSwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgY2FzZSBrZXlDb2RlLkRPV046DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlcGVhdCggbnVsbCwgLTEsIGV2ZW50ICk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgIGNhc2Uga2V5Q29kZS5QQUdFX1VQOg0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXBlYXQoIG51bGwsIG9wdGlvbnMucGFnZSwgZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgY2FzZSBrZXlDb2RlLlBBR0VfRE9XTjoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVwZWF0KCBudWxsLCAtb3B0aW9ucy5wYWdlLCBldmVudCApOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9LA0KDQogICAgICAgIF9zdGFydDogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgaWYgKCAhdGhpcy5zcGlubmluZyAmJiB0aGlzLl90cmlnZ2VyKCAic3RhcnQiLCBldmVudCApID09PSBmYWxzZSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggIXRoaXMuY291bnRlciApIHsNCiAgICAgICAgICAgICAgICB0aGlzLmNvdW50ZXIgPSAxOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5zcGlubmluZyA9IHRydWU7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcmVwZWF0OiBmdW5jdGlvbiggaSwgc3RlcHMsIGV2ZW50ICkgew0KICAgICAgICAgICAgaSA9IGkgfHwgNTAwOw0KDQogICAgICAgICAgICBjbGVhclRpbWVvdXQoIHRoaXMudGltZXIgKTsNCiAgICAgICAgICAgIHRoaXMudGltZXIgPSB0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fcmVwZWF0KCA0MCwgc3RlcHMsIGV2ZW50ICk7DQogICAgICAgICAgICB9LCBpICk7DQoNCiAgICAgICAgICAgIHRoaXMuX3NwaW4oIHN0ZXBzICogdGhpcy5vcHRpb25zLnN0ZXAsIGV2ZW50ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NwaW46IGZ1bmN0aW9uKCBzdGVwLCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMudmFsdWUoKSB8fCAwOw0KDQogICAgICAgICAgICBpZiAoICF0aGlzLmNvdW50ZXIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5jb3VudGVyID0gMTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdmFsdWUgPSB0aGlzLl9hZGp1c3RWYWx1ZSggdmFsdWUgKyBzdGVwICogdGhpcy5faW5jcmVtZW50KCB0aGlzLmNvdW50ZXIgKSApOw0KDQogICAgICAgICAgICBpZiAoICF0aGlzLnNwaW5uaW5nIHx8IHRoaXMuX3RyaWdnZXIoICJzcGluIiwgZXZlbnQsIHsgdmFsdWU6IHZhbHVlIH0gKSAhPT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fdmFsdWUoIHZhbHVlICk7DQogICAgICAgICAgICAgICAgdGhpcy5jb3VudGVyKys7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2luY3JlbWVudDogZnVuY3Rpb24oIGkgKSB7DQogICAgICAgICAgICB2YXIgaW5jcmVtZW50YWwgPSB0aGlzLm9wdGlvbnMuaW5jcmVtZW50YWw7DQoNCiAgICAgICAgICAgIGlmICggaW5jcmVtZW50YWwgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICQuaXNGdW5jdGlvbiggaW5jcmVtZW50YWwgKSA/DQogICAgICAgICAgICAgICAgICAgIGluY3JlbWVudGFsKCBpICkgOg0KICAgICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKCBpICogaSAqIGkgLyA1MDAwMCAtIGkgKiBpIC8gNTAwICsgMTcgKiBpIC8gMjAwICsgMSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcHJlY2lzaW9uOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBwcmVjaXNpb24gPSB0aGlzLl9wcmVjaXNpb25PZiggdGhpcy5vcHRpb25zLnN0ZXAgKTsNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLm1pbiAhPT0gbnVsbCApIHsNCiAgICAgICAgICAgICAgICBwcmVjaXNpb24gPSBNYXRoLm1heCggcHJlY2lzaW9uLCB0aGlzLl9wcmVjaXNpb25PZiggdGhpcy5vcHRpb25zLm1pbiApICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gcHJlY2lzaW9uOw0KICAgICAgICB9LA0KDQogICAgICAgIF9wcmVjaXNpb25PZjogZnVuY3Rpb24oIG51bSApIHsNCiAgICAgICAgICAgIHZhciBzdHIgPSBudW0udG9TdHJpbmcoKSwNCiAgICAgICAgICAgICAgICBkZWNpbWFsID0gc3RyLmluZGV4T2YoICIuIiApOw0KICAgICAgICAgICAgcmV0dXJuIGRlY2ltYWwgPT09IC0xID8gMCA6IHN0ci5sZW5ndGggLSBkZWNpbWFsIC0gMTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfYWRqdXN0VmFsdWU6IGZ1bmN0aW9uKCB2YWx1ZSApIHsNCiAgICAgICAgICAgIHZhciBiYXNlLCBhYm92ZU1pbiwNCiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zOw0KDQogICAgICAgICAgICAvLyBNYWtlIHN1cmUgd2UncmUgYXQgYSB2YWxpZCBzdGVwDQogICAgICAgICAgICAvLyAtIGZpbmQgb3V0IHdoZXJlIHdlIGFyZSByZWxhdGl2ZSB0byB0aGUgYmFzZSAobWluIG9yIDApDQogICAgICAgICAgICBiYXNlID0gb3B0aW9ucy5taW4gIT09IG51bGwgPyBvcHRpb25zLm1pbiA6IDA7DQogICAgICAgICAgICBhYm92ZU1pbiA9IHZhbHVlIC0gYmFzZTsNCg0KICAgICAgICAgICAgLy8gLSByb3VuZCB0byB0aGUgbmVhcmVzdCBzdGVwDQogICAgICAgICAgICBhYm92ZU1pbiA9IE1hdGgucm91bmQoIGFib3ZlTWluIC8gb3B0aW9ucy5zdGVwICkgKiBvcHRpb25zLnN0ZXA7DQoNCiAgICAgICAgICAgIC8vIC0gcm91bmRpbmcgaXMgYmFzZWQgb24gMCwgc28gYWRqdXN0IGJhY2sgdG8gb3VyIGJhc2UNCiAgICAgICAgICAgIHZhbHVlID0gYmFzZSArIGFib3ZlTWluOw0KDQogICAgICAgICAgICAvLyBGaXggcHJlY2lzaW9uIGZyb20gYmFkIEpTIGZsb2F0aW5nIHBvaW50IG1hdGgNCiAgICAgICAgICAgIHZhbHVlID0gcGFyc2VGbG9hdCggdmFsdWUudG9GaXhlZCggdGhpcy5fcHJlY2lzaW9uKCkgKSApOw0KDQogICAgICAgICAgICAvLyBDbGFtcCB0aGUgdmFsdWUNCiAgICAgICAgICAgIGlmICggb3B0aW9ucy5tYXggIT09IG51bGwgJiYgdmFsdWUgPiBvcHRpb25zLm1heCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gb3B0aW9ucy5tYXg7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIG9wdGlvbnMubWluICE9PSBudWxsICYmIHZhbHVlIDwgb3B0aW9ucy5taW4gKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnMubWluOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gdmFsdWU7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3N0b3A6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIGlmICggIXRoaXMuc3Bpbm5pbmcgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBjbGVhclRpbWVvdXQoIHRoaXMudGltZXIgKTsNCiAgICAgICAgICAgIGNsZWFyVGltZW91dCggdGhpcy5tb3VzZXdoZWVsVGltZXIgKTsNCiAgICAgICAgICAgIHRoaXMuY291bnRlciA9IDA7DQogICAgICAgICAgICB0aGlzLnNwaW5uaW5nID0gZmFsc2U7DQogICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAic3RvcCIsIGV2ZW50ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7DQogICAgICAgICAgICB2YXIgcHJldlZhbHVlLCBmaXJzdCwgbGFzdDsNCg0KICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJjdWx0dXJlIiB8fCBrZXkgPT09ICJudW1iZXJGb3JtYXQiICkgew0KICAgICAgICAgICAgICAgIHByZXZWYWx1ZSA9IHRoaXMuX3BhcnNlKCB0aGlzLmVsZW1lbnQudmFsKCkgKTsNCiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnNbIGtleSBdID0gdmFsdWU7DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnZhbCggdGhpcy5fZm9ybWF0KCBwcmV2VmFsdWUgKSApOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJtYXgiIHx8IGtleSA9PT0gIm1pbiIgfHwga2V5ID09PSAic3RlcCIgKSB7DQogICAgICAgICAgICAgICAgaWYgKCB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICkgew0KICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuX3BhcnNlKCB2YWx1ZSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICgga2V5ID09PSAiaWNvbnMiICkgew0KICAgICAgICAgICAgICAgIGZpcnN0ID0gdGhpcy5idXR0b25zLmZpcnN0KCkuZmluZCggIi51aS1pY29uIiApOw0KICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCBmaXJzdCwgbnVsbCwgdGhpcy5vcHRpb25zLmljb25zLnVwICk7DQogICAgICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIGZpcnN0LCBudWxsLCB2YWx1ZS51cCApOw0KICAgICAgICAgICAgICAgIGxhc3QgPSB0aGlzLmJ1dHRvbnMubGFzdCgpLmZpbmQoICIudWktaWNvbiIgKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggbGFzdCwgbnVsbCwgdGhpcy5vcHRpb25zLmljb25zLmRvd24gKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggbGFzdCwgbnVsbCwgdmFsdWUuZG93biApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb25EaXNhYmxlZDogZnVuY3Rpb24oIHZhbHVlICkgew0KICAgICAgICAgICAgdGhpcy5fc3VwZXIoIHZhbHVlICk7DQoNCiAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUNsYXNzKCB0aGlzLnVpU3Bpbm5lciwgbnVsbCwgInVpLXN0YXRlLWRpc2FibGVkIiwgISF2YWx1ZSApOw0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LnByb3AoICJkaXNhYmxlZCIsICEhdmFsdWUgKTsNCiAgICAgICAgICAgIHRoaXMuYnV0dG9ucy5idXR0b24oIHZhbHVlID8gImRpc2FibGUiIDogImVuYWJsZSIgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0T3B0aW9uczogc3Bpbm5lck1vZGlmZXIoIGZ1bmN0aW9uKCBvcHRpb25zICkgew0KICAgICAgICAgICAgdGhpcy5fc3VwZXIoIG9wdGlvbnMgKTsNCiAgICAgICAgfSApLA0KDQogICAgICAgIF9wYXJzZTogZnVuY3Rpb24oIHZhbCApIHsNCiAgICAgICAgICAgIGlmICggdHlwZW9mIHZhbCA9PT0gInN0cmluZyIgJiYgdmFsICE9PSAiIiApIHsNCiAgICAgICAgICAgICAgICB2YWwgPSB3aW5kb3cuR2xvYmFsaXplICYmIHRoaXMub3B0aW9ucy5udW1iZXJGb3JtYXQgPw0KICAgICAgICAgICAgICAgICAgICBHbG9iYWxpemUucGFyc2VGbG9hdCggdmFsLCAxMCwgdGhpcy5vcHRpb25zLmN1bHR1cmUgKSA6ICt2YWw7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gdmFsID09PSAiIiB8fCBpc05hTiggdmFsICkgPyBudWxsIDogdmFsOw0KICAgICAgICB9LA0KDQogICAgICAgIF9mb3JtYXQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHsNCiAgICAgICAgICAgIGlmICggdmFsdWUgPT09ICIiICkgew0KICAgICAgICAgICAgICAgIHJldHVybiAiIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuR2xvYmFsaXplICYmIHRoaXMub3B0aW9ucy5udW1iZXJGb3JtYXQgPw0KICAgICAgICAgICAgICAgIEdsb2JhbGl6ZS5mb3JtYXQoIHZhbHVlLCB0aGlzLm9wdGlvbnMubnVtYmVyRm9ybWF0LCB0aGlzLm9wdGlvbnMuY3VsdHVyZSApIDoNCiAgICAgICAgICAgICAgICB2YWx1ZTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcmVmcmVzaDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLmVsZW1lbnQuYXR0ciggew0KICAgICAgICAgICAgICAgICJhcmlhLXZhbHVlbWluIjogdGhpcy5vcHRpb25zLm1pbiwNCiAgICAgICAgICAgICAgICAiYXJpYS12YWx1ZW1heCI6IHRoaXMub3B0aW9ucy5tYXgsDQoNCiAgICAgICAgICAgICAgICAvLyBUT0RPOiB3aGF0IHNob3VsZCB3ZSBkbyB3aXRoIHZhbHVlcyB0aGF0IGNhbid0IGJlIHBhcnNlZD8NCiAgICAgICAgICAgICAgICAiYXJpYS12YWx1ZW5vdyI6IHRoaXMuX3BhcnNlKCB0aGlzLmVsZW1lbnQudmFsKCkgKQ0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIGlzVmFsaWQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy52YWx1ZSgpOw0KDQogICAgICAgICAgICAvLyBOdWxsIGlzIGludmFsaWQNCiAgICAgICAgICAgIGlmICggdmFsdWUgPT09IG51bGwgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBJZiB2YWx1ZSBnZXRzIGFkanVzdGVkLCBpdCdzIGludmFsaWQNCiAgICAgICAgICAgIHJldHVybiB2YWx1ZSA9PT0gdGhpcy5fYWRqdXN0VmFsdWUoIHZhbHVlICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLy8gVXBkYXRlIHRoZSB2YWx1ZSB3aXRob3V0IHRyaWdnZXJpbmcgY2hhbmdlDQogICAgICAgIF92YWx1ZTogZnVuY3Rpb24oIHZhbHVlLCBhbGxvd0FueSApIHsNCiAgICAgICAgICAgIHZhciBwYXJzZWQ7DQogICAgICAgICAgICBpZiAoIHZhbHVlICE9PSAiIiApIHsNCiAgICAgICAgICAgICAgICBwYXJzZWQgPSB0aGlzLl9wYXJzZSggdmFsdWUgKTsNCiAgICAgICAgICAgICAgICBpZiAoIHBhcnNlZCAhPT0gbnVsbCApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAhYWxsb3dBbnkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYXJzZWQgPSB0aGlzLl9hZGp1c3RWYWx1ZSggcGFyc2VkICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLl9mb3JtYXQoIHBhcnNlZCApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC52YWwoIHZhbHVlICk7DQogICAgICAgICAgICB0aGlzLl9yZWZyZXNoKCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2Rlc3Ryb3k6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5lbGVtZW50DQogICAgICAgICAgICAgICAgLnByb3AoICJkaXNhYmxlZCIsIGZhbHNlICkNCiAgICAgICAgICAgICAgICAucmVtb3ZlQXR0ciggImF1dG9jb21wbGV0ZSByb2xlIGFyaWEtdmFsdWVtaW4gYXJpYS12YWx1ZW1heCBhcmlhLXZhbHVlbm93IiApOw0KDQogICAgICAgICAgICB0aGlzLnVpU3Bpbm5lci5yZXBsYWNlV2l0aCggdGhpcy5lbGVtZW50ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgc3RlcFVwOiBzcGlubmVyTW9kaWZlciggZnVuY3Rpb24oIHN0ZXBzICkgew0KICAgICAgICAgICAgdGhpcy5fc3RlcFVwKCBzdGVwcyApOw0KICAgICAgICB9ICksDQogICAgICAgIF9zdGVwVXA6IGZ1bmN0aW9uKCBzdGVwcyApIHsNCiAgICAgICAgICAgIGlmICggdGhpcy5fc3RhcnQoKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9zcGluKCAoIHN0ZXBzIHx8IDEgKSAqIHRoaXMub3B0aW9ucy5zdGVwICk7DQogICAgICAgICAgICAgICAgdGhpcy5fc3RvcCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHN0ZXBEb3duOiBzcGlubmVyTW9kaWZlciggZnVuY3Rpb24oIHN0ZXBzICkgew0KICAgICAgICAgICAgdGhpcy5fc3RlcERvd24oIHN0ZXBzICk7DQogICAgICAgIH0gKSwNCiAgICAgICAgX3N0ZXBEb3duOiBmdW5jdGlvbiggc3RlcHMgKSB7DQogICAgICAgICAgICBpZiAoIHRoaXMuX3N0YXJ0KCkgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fc3BpbiggKCBzdGVwcyB8fCAxICkgKiAtdGhpcy5vcHRpb25zLnN0ZXAgKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9zdG9wKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgcGFnZVVwOiBzcGlubmVyTW9kaWZlciggZnVuY3Rpb24oIHBhZ2VzICkgew0KICAgICAgICAgICAgdGhpcy5fc3RlcFVwKCAoIHBhZ2VzIHx8IDEgKSAqIHRoaXMub3B0aW9ucy5wYWdlICk7DQogICAgICAgIH0gKSwNCg0KICAgICAgICBwYWdlRG93bjogc3Bpbm5lck1vZGlmZXIoIGZ1bmN0aW9uKCBwYWdlcyApIHsNCiAgICAgICAgICAgIHRoaXMuX3N0ZXBEb3duKCAoIHBhZ2VzIHx8IDEgKSAqIHRoaXMub3B0aW9ucy5wYWdlICk7DQogICAgICAgIH0gKSwNCg0KICAgICAgICB2YWx1ZTogZnVuY3Rpb24oIG5ld1ZhbCApIHsNCiAgICAgICAgICAgIGlmICggIWFyZ3VtZW50cy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BhcnNlKCB0aGlzLmVsZW1lbnQudmFsKCkgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHNwaW5uZXJNb2RpZmVyKCB0aGlzLl92YWx1ZSApLmNhbGwoIHRoaXMsIG5ld1ZhbCApOw0KICAgICAgICB9LA0KDQogICAgICAgIHdpZGdldDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy51aVNwaW5uZXI7DQogICAgICAgIH0NCiAgICB9ICk7DQoNCi8vIERFUFJFQ0FURUQNCi8vIFRPRE86IHN3aXRjaCByZXR1cm4gYmFjayB0byB3aWRnZXQgZGVjbGFyYXRpb24gYXQgdG9wIG9mIGZpbGUgd2hlbiB0aGlzIGlzIHJlbW92ZWQNCiAgICBpZiAoICQudWlCYWNrQ29tcGF0ICE9PSBmYWxzZSApIHsNCg0KICAgICAgICAvLyBCYWNrY29tcGF0IGZvciBzcGlubmVyIGh0bWwgZXh0ZW5zaW9uIHBvaW50cw0KICAgICAgICAkLndpZGdldCggInVpLnNwaW5uZXIiLCAkLnVpLnNwaW5uZXIsIHsNCiAgICAgICAgICAgIF9lbmhhbmNlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnVpU3Bpbm5lciA9IHRoaXMuZWxlbWVudA0KICAgICAgICAgICAgICAgICAgICAuYXR0ciggImF1dG9jb21wbGV0ZSIsICJvZmYiICkNCiAgICAgICAgICAgICAgICAgICAgLndyYXAoIHRoaXMuX3VpU3Bpbm5lckh0bWwoKSApDQogICAgICAgICAgICAgICAgICAgIC5wYXJlbnQoKQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIEFkZCBidXR0b25zDQogICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoIHRoaXMuX2J1dHRvbkh0bWwoKSApOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIF91aVNwaW5uZXJIdG1sOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gIjxzcGFuPiI7DQogICAgICAgICAgICB9LA0KDQogICAgICAgICAgICBfYnV0dG9uSHRtbDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICI8YT48L2E+PGE+PC9hPiI7DQogICAgICAgICAgICB9DQogICAgICAgIH0gKTsNCiAgICB9DQoNCiAgICB2YXIgd2lkZ2V0c1NwaW5uZXIgPSAkLnVpLnNwaW5uZXI7DQoNCg0KICAgIC8qIQ0KICogalF1ZXJ5IFVJIFRhYnMgMS4xMi4xDQogKiBodHRwOi8vanF1ZXJ5dWkuY29tDQogKg0KICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMNCiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UNCiAqLw0KDQovLz4+bGFiZWw6IFRhYnMNCi8vPj5ncm91cDogV2lkZ2V0cw0KLy8+PmRlc2NyaXB0aW9uOiBUcmFuc2Zvcm1zIGEgc2V0IG9mIGNvbnRhaW5lciBlbGVtZW50cyBpbnRvIGEgdGFiIHN0cnVjdHVyZS4NCi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS90YWJzLw0KLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL3RhYnMvDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29yZS5jc3MNCi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS90YWJzLmNzcw0KLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzDQoNCg0KDQogICAgJC53aWRnZXQoICJ1aS50YWJzIiwgew0KICAgICAgICB2ZXJzaW9uOiAiMS4xMi4xIiwNCiAgICAgICAgZGVsYXk6IDMwMCwNCiAgICAgICAgb3B0aW9uczogew0KICAgICAgICAgICAgYWN0aXZlOiBudWxsLA0KICAgICAgICAgICAgY2xhc3Nlczogew0KICAgICAgICAgICAgICAgICJ1aS10YWJzIjogInVpLWNvcm5lci1hbGwiLA0KICAgICAgICAgICAgICAgICJ1aS10YWJzLW5hdiI6ICJ1aS1jb3JuZXItYWxsIiwNCiAgICAgICAgICAgICAgICAidWktdGFicy1wYW5lbCI6ICJ1aS1jb3JuZXItYm90dG9tIiwNCiAgICAgICAgICAgICAgICAidWktdGFicy10YWIiOiAidWktY29ybmVyLXRvcCINCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBjb2xsYXBzaWJsZTogZmFsc2UsDQogICAgICAgICAgICBldmVudDogImNsaWNrIiwNCiAgICAgICAgICAgIGhlaWdodFN0eWxlOiAiY29udGVudCIsDQogICAgICAgICAgICBoaWRlOiBudWxsLA0KICAgICAgICAgICAgc2hvdzogbnVsbCwNCg0KICAgICAgICAgICAgLy8gQ2FsbGJhY2tzDQogICAgICAgICAgICBhY3RpdmF0ZTogbnVsbCwNCiAgICAgICAgICAgIGJlZm9yZUFjdGl2YXRlOiBudWxsLA0KICAgICAgICAgICAgYmVmb3JlTG9hZDogbnVsbCwNCiAgICAgICAgICAgIGxvYWQ6IG51bGwNCiAgICAgICAgfSwNCg0KICAgICAgICBfaXNMb2NhbDogKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciByaGFzaCA9IC8jLiokLzsNCg0KICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCBhbmNob3IgKSB7DQogICAgICAgICAgICAgICAgdmFyIGFuY2hvclVybCwgbG9jYXRpb25Vcmw7DQoNCiAgICAgICAgICAgICAgICBhbmNob3JVcmwgPSBhbmNob3IuaHJlZi5yZXBsYWNlKCByaGFzaCwgIiIgKTsNCiAgICAgICAgICAgICAgICBsb2NhdGlvblVybCA9IGxvY2F0aW9uLmhyZWYucmVwbGFjZSggcmhhc2gsICIiICk7DQoNCiAgICAgICAgICAgICAgICAvLyBEZWNvZGluZyBtYXkgdGhyb3cgYW4gZXJyb3IgaWYgdGhlIFVSTCBpc24ndCBVVEYtOCAoIzk1MTgpDQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yVXJsID0gZGVjb2RlVVJJQ29tcG9uZW50KCBhbmNob3JVcmwgKTsNCiAgICAgICAgICAgICAgICB9IGNhdGNoICggZXJyb3IgKSB7fQ0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uVXJsID0gZGVjb2RlVVJJQ29tcG9uZW50KCBsb2NhdGlvblVybCApOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKCBlcnJvciApIHt9DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gYW5jaG9yLmhhc2gubGVuZ3RoID4gMSAmJiBhbmNob3JVcmwgPT09IGxvY2F0aW9uVXJsOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgfSApKCksDQoNCiAgICAgICAgX2NyZWF0ZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9uczsNCg0KICAgICAgICAgICAgdGhpcy5ydW5uaW5nID0gZmFsc2U7DQoNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCAidWktdGFicyIsICJ1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQiICk7DQogICAgICAgICAgICB0aGlzLl90b2dnbGVDbGFzcyggInVpLXRhYnMtY29sbGFwc2libGUiLCBudWxsLCBvcHRpb25zLmNvbGxhcHNpYmxlICk7DQoNCiAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3NUYWJzKCk7DQogICAgICAgICAgICBvcHRpb25zLmFjdGl2ZSA9IHRoaXMuX2luaXRpYWxBY3RpdmUoKTsNCg0KICAgICAgICAgICAgLy8gVGFrZSBkaXNhYmxpbmcgdGFicyB2aWEgY2xhc3MgYXR0cmlidXRlIGZyb20gSFRNTA0KICAgICAgICAgICAgLy8gaW50byBhY2NvdW50IGFuZCB1cGRhdGUgb3B0aW9uIHByb3Blcmx5Lg0KICAgICAgICAgICAgaWYgKCAkLmlzQXJyYXkoIG9wdGlvbnMuZGlzYWJsZWQgKSApIHsNCiAgICAgICAgICAgICAgICBvcHRpb25zLmRpc2FibGVkID0gJC51bmlxdWUoIG9wdGlvbnMuZGlzYWJsZWQuY29uY2F0KA0KICAgICAgICAgICAgICAgICAgICAkLm1hcCggdGhpcy50YWJzLmZpbHRlciggIi51aS1zdGF0ZS1kaXNhYmxlZCIgKSwgZnVuY3Rpb24oIGxpICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoYXQudGFicy5pbmRleCggbGkgKTsNCiAgICAgICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgKSApLnNvcnQoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIGxlbmd0aCBhdm9pZHMgZXJyb3Igd2hlbiBpbml0aWFsaXppbmcgZW1wdHkgbGlzdA0KICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuYWN0aXZlICE9PSBmYWxzZSAmJiB0aGlzLmFuY2hvcnMubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gdGhpcy5fZmluZEFjdGl2ZSggb3B0aW9ucy5hY3RpdmUgKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUgPSAkKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX3JlZnJlc2goKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLmFjdGl2ZS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgdGhpcy5sb2FkKCBvcHRpb25zLmFjdGl2ZSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9pbml0aWFsQWN0aXZlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBhY3RpdmUgPSB0aGlzLm9wdGlvbnMuYWN0aXZlLA0KICAgICAgICAgICAgICAgIGNvbGxhcHNpYmxlID0gdGhpcy5vcHRpb25zLmNvbGxhcHNpYmxlLA0KICAgICAgICAgICAgICAgIGxvY2F0aW9uSGFzaCA9IGxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKCAxICk7DQoNCiAgICAgICAgICAgIGlmICggYWN0aXZlID09PSBudWxsICkgew0KDQogICAgICAgICAgICAgICAgLy8gY2hlY2sgdGhlIGZyYWdtZW50IGlkZW50aWZpZXIgaW4gdGhlIFVSTA0KICAgICAgICAgICAgICAgIGlmICggbG9jYXRpb25IYXNoICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRhYnMuZWFjaCggZnVuY3Rpb24oIGksIHRhYiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggJCggdGFiICkuYXR0ciggImFyaWEtY29udHJvbHMiICkgPT09IGxvY2F0aW9uSGFzaCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmUgPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIENoZWNrIGZvciBhIHRhYiBtYXJrZWQgYWN0aXZlIHZpYSBhIGNsYXNzDQogICAgICAgICAgICAgICAgaWYgKCBhY3RpdmUgPT09IG51bGwgKSB7DQogICAgICAgICAgICAgICAgICAgIGFjdGl2ZSA9IHRoaXMudGFicy5pbmRleCggdGhpcy50YWJzLmZpbHRlciggIi51aS10YWJzLWFjdGl2ZSIgKSApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIE5vIGFjdGl2ZSB0YWIsIHNldCB0byBmYWxzZQ0KICAgICAgICAgICAgICAgIGlmICggYWN0aXZlID09PSBudWxsIHx8IGFjdGl2ZSA9PT0gLTEgKSB7DQogICAgICAgICAgICAgICAgICAgIGFjdGl2ZSA9IHRoaXMudGFicy5sZW5ndGggPyAwIDogZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBIYW5kbGUgbnVtYmVyczogbmVnYXRpdmUsIG91dCBvZiByYW5nZQ0KICAgICAgICAgICAgaWYgKCBhY3RpdmUgIT09IGZhbHNlICkgew0KICAgICAgICAgICAgICAgIGFjdGl2ZSA9IHRoaXMudGFicy5pbmRleCggdGhpcy50YWJzLmVxKCBhY3RpdmUgKSApOw0KICAgICAgICAgICAgICAgIGlmICggYWN0aXZlID09PSAtMSApIHsNCiAgICAgICAgICAgICAgICAgICAgYWN0aXZlID0gY29sbGFwc2libGUgPyBmYWxzZSA6IDA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBEb24ndCBhbGxvdyBjb2xsYXBzaWJsZTogZmFsc2UgYW5kIGFjdGl2ZTogZmFsc2UNCiAgICAgICAgICAgIGlmICggIWNvbGxhcHNpYmxlICYmIGFjdGl2ZSA9PT0gZmFsc2UgJiYgdGhpcy5hbmNob3JzLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICBhY3RpdmUgPSAwOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gYWN0aXZlOw0KICAgICAgICB9LA0KDQogICAgICAgIF9nZXRDcmVhdGVFdmVudERhdGE6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICB0YWI6IHRoaXMuYWN0aXZlLA0KICAgICAgICAgICAgICAgIHBhbmVsOiAhdGhpcy5hY3RpdmUubGVuZ3RoID8gJCgpIDogdGhpcy5fZ2V0UGFuZWxGb3JUYWIoIHRoaXMuYWN0aXZlICkNCiAgICAgICAgICAgIH07DQogICAgICAgIH0sDQoNCiAgICAgICAgX3RhYktleWRvd246IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciBmb2N1c2VkVGFiID0gJCggJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICkgKS5jbG9zZXN0KCAibGkiICksDQogICAgICAgICAgICAgICAgc2VsZWN0ZWRJbmRleCA9IHRoaXMudGFicy5pbmRleCggZm9jdXNlZFRhYiApLA0KICAgICAgICAgICAgICAgIGdvaW5nRm9yd2FyZCA9IHRydWU7DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5faGFuZGxlUGFnZU5hdiggZXZlbnQgKSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7DQogICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuUklHSFQ6DQogICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuRE9XTjoNCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJbmRleCsrOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5VUDoNCiAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5MRUZUOg0KICAgICAgICAgICAgICAgICAgICBnb2luZ0ZvcndhcmQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJbmRleC0tOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICQudWkua2V5Q29kZS5FTkQ6DQogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkSW5kZXggPSB0aGlzLmFuY2hvcnMubGVuZ3RoIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAkLnVpLmtleUNvZGUuSE9NRToNCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJbmRleCA9IDA7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLlNQQUNFOg0KDQogICAgICAgICAgICAgICAgICAgIC8vIEFjdGl2YXRlIG9ubHksIG5vIGNvbGxhcHNpbmcNCiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KCB0aGlzLmFjdGl2YXRpbmcgKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWN0aXZhdGUoIHNlbGVjdGVkSW5kZXggKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIGNhc2UgJC51aS5rZXlDb2RlLkVOVEVSOg0KDQogICAgICAgICAgICAgICAgICAgIC8vIFRvZ2dsZSAoY2FuY2VsIGRlbGF5ZWQgYWN0aXZhdGlvbiwgYWxsb3cgY29sbGFwc2luZykNCiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KCB0aGlzLmFjdGl2YXRpbmcgKTsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBEZXRlcm1pbmUgaWYgd2Ugc2hvdWxkIGNvbGxhcHNlIG9yIGFjdGl2YXRlDQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2FjdGl2YXRlKCBzZWxlY3RlZEluZGV4ID09PSB0aGlzLm9wdGlvbnMuYWN0aXZlID8gZmFsc2UgOiBzZWxlY3RlZEluZGV4ICk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIEZvY3VzIHRoZSBhcHByb3ByaWF0ZSB0YWIsIGJhc2VkIG9uIHdoaWNoIGtleSB3YXMgcHJlc3NlZA0KICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIGNsZWFyVGltZW91dCggdGhpcy5hY3RpdmF0aW5nICk7DQogICAgICAgICAgICBzZWxlY3RlZEluZGV4ID0gdGhpcy5fZm9jdXNOZXh0VGFiKCBzZWxlY3RlZEluZGV4LCBnb2luZ0ZvcndhcmQgKTsNCg0KICAgICAgICAgICAgLy8gTmF2aWdhdGluZyB3aXRoIGNvbnRyb2wvY29tbWFuZCBrZXkgd2lsbCBwcmV2ZW50IGF1dG9tYXRpYyBhY3RpdmF0aW9uDQogICAgICAgICAgICBpZiAoICFldmVudC5jdHJsS2V5ICYmICFldmVudC5tZXRhS2V5ICkgew0KDQogICAgICAgICAgICAgICAgLy8gVXBkYXRlIGFyaWEtc2VsZWN0ZWQgaW1tZWRpYXRlbHkgc28gdGhhdCBBVCB0aGluayB0aGUgdGFiIGlzIGFscmVhZHkgc2VsZWN0ZWQuDQogICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIEFUIG1heSBjb25mdXNlIHRoZSB1c2VyIGJ5IHN0YXRpbmcgdGhhdCB0aGV5IG5lZWQgdG8gYWN0aXZhdGUgdGhlIHRhYiwNCiAgICAgICAgICAgICAgICAvLyBidXQgdGhlIHRhYiB3aWxsIGFscmVhZHkgYmUgYWN0aXZhdGVkIGJ5IHRoZSB0aW1lIHRoZSBhbm5vdW5jZW1lbnQgZmluaXNoZXMuDQogICAgICAgICAgICAgICAgZm9jdXNlZFRhYi5hdHRyKCAiYXJpYS1zZWxlY3RlZCIsICJmYWxzZSIgKTsNCiAgICAgICAgICAgICAgICB0aGlzLnRhYnMuZXEoIHNlbGVjdGVkSW5kZXggKS5hdHRyKCAiYXJpYS1zZWxlY3RlZCIsICJ0cnVlIiApOw0KDQogICAgICAgICAgICAgICAgdGhpcy5hY3RpdmF0aW5nID0gdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbiggImFjdGl2ZSIsIHNlbGVjdGVkSW5kZXggKTsNCiAgICAgICAgICAgICAgICB9LCB0aGlzLmRlbGF5ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX3BhbmVsS2V5ZG93bjogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgaWYgKCB0aGlzLl9oYW5kbGVQYWdlTmF2KCBldmVudCApICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gQ3RybCt1cCBtb3ZlcyBmb2N1cyB0byB0aGUgY3VycmVudCB0YWINCiAgICAgICAgICAgIGlmICggZXZlbnQuY3RybEtleSAmJiBldmVudC5rZXlDb2RlID09PSAkLnVpLmtleUNvZGUuVVAgKSB7DQogICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZS50cmlnZ2VyKCAiZm9jdXMiICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgLy8gQWx0K3BhZ2UgdXAvZG93biBtb3ZlcyBmb2N1cyB0byB0aGUgcHJldmlvdXMvbmV4dCB0YWIgKGFuZCBhY3RpdmF0ZXMpDQogICAgICAgIF9oYW5kbGVQYWdlTmF2OiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICBpZiAoIGV2ZW50LmFsdEtleSAmJiBldmVudC5rZXlDb2RlID09PSAkLnVpLmtleUNvZGUuUEFHRV9VUCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9hY3RpdmF0ZSggdGhpcy5fZm9jdXNOZXh0VGFiKCB0aGlzLm9wdGlvbnMuYWN0aXZlIC0gMSwgZmFsc2UgKSApOw0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCBldmVudC5hbHRLZXkgJiYgZXZlbnQua2V5Q29kZSA9PT0gJC51aS5rZXlDb2RlLlBBR0VfRE9XTiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9hY3RpdmF0ZSggdGhpcy5fZm9jdXNOZXh0VGFiKCB0aGlzLm9wdGlvbnMuYWN0aXZlICsgMSwgdHJ1ZSApICk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2ZpbmROZXh0VGFiOiBmdW5jdGlvbiggaW5kZXgsIGdvaW5nRm9yd2FyZCApIHsNCiAgICAgICAgICAgIHZhciBsYXN0VGFiSW5kZXggPSB0aGlzLnRhYnMubGVuZ3RoIC0gMTsNCg0KICAgICAgICAgICAgZnVuY3Rpb24gY29uc3RyYWluKCkgew0KICAgICAgICAgICAgICAgIGlmICggaW5kZXggPiBsYXN0VGFiSW5kZXggKSB7DQogICAgICAgICAgICAgICAgICAgIGluZGV4ID0gMDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCBpbmRleCA8IDAgKSB7DQogICAgICAgICAgICAgICAgICAgIGluZGV4ID0gbGFzdFRhYkluZGV4Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXg7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdoaWxlICggJC5pbkFycmF5KCBjb25zdHJhaW4oKSwgdGhpcy5vcHRpb25zLmRpc2FibGVkICkgIT09IC0xICkgew0KICAgICAgICAgICAgICAgIGluZGV4ID0gZ29pbmdGb3J3YXJkID8gaW5kZXggKyAxIDogaW5kZXggLSAxOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gaW5kZXg7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2ZvY3VzTmV4dFRhYjogZnVuY3Rpb24oIGluZGV4LCBnb2luZ0ZvcndhcmQgKSB7DQogICAgICAgICAgICBpbmRleCA9IHRoaXMuX2ZpbmROZXh0VGFiKCBpbmRleCwgZ29pbmdGb3J3YXJkICk7DQogICAgICAgICAgICB0aGlzLnRhYnMuZXEoIGluZGV4ICkudHJpZ2dlciggImZvY3VzIiApOw0KICAgICAgICAgICAgcmV0dXJuIGluZGV4Ow0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgew0KICAgICAgICAgICAgaWYgKCBrZXkgPT09ICJhY3RpdmUiICkgew0KDQogICAgICAgICAgICAgICAgLy8gX2FjdGl2YXRlKCkgd2lsbCBoYW5kbGUgaW52YWxpZCB2YWx1ZXMgYW5kIHVwZGF0ZSB0aGlzLm9wdGlvbnMNCiAgICAgICAgICAgICAgICB0aGlzLl9hY3RpdmF0ZSggdmFsdWUgKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX3N1cGVyKCBrZXksIHZhbHVlICk7DQoNCiAgICAgICAgICAgIGlmICgga2V5ID09PSAiY29sbGFwc2libGUiICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUNsYXNzKCAidWktdGFicy1jb2xsYXBzaWJsZSIsIG51bGwsIHZhbHVlICk7DQoNCiAgICAgICAgICAgICAgICAvLyBTZXR0aW5nIGNvbGxhcHNpYmxlOiBmYWxzZSB3aGlsZSBjb2xsYXBzZWQ7IG9wZW4gZmlyc3QgcGFuZWwNCiAgICAgICAgICAgICAgICBpZiAoICF2YWx1ZSAmJiB0aGlzLm9wdGlvbnMuYWN0aXZlID09PSBmYWxzZSApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWN0aXZhdGUoIDAgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICgga2V5ID09PSAiZXZlbnQiICkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3NldHVwRXZlbnRzKCB2YWx1ZSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImhlaWdodFN0eWxlIiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9zZXR1cEhlaWdodFN0eWxlKCB2YWx1ZSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9zYW5pdGl6ZVNlbGVjdG9yOiBmdW5jdGlvbiggaGFzaCApIHsNCiAgICAgICAgICAgIHJldHVybiBoYXNoID8gaGFzaC5yZXBsYWNlKCAvWyEiJCUmJygpKissLlwvOjs8PT4/QFxbXF1cXmB7fH1+XS9nLCAiXFwkJiIgKSA6ICIiOw0KICAgICAgICB9LA0KDQogICAgICAgIHJlZnJlc2g6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsDQogICAgICAgICAgICAgICAgbGlzID0gdGhpcy50YWJsaXN0LmNoaWxkcmVuKCAiOmhhcyhhW2hyZWZdKSIgKTsNCg0KICAgICAgICAgICAgLy8gR2V0IGRpc2FibGVkIHRhYnMgZnJvbSBjbGFzcyBhdHRyaWJ1dGUgZnJvbSBIVE1MDQogICAgICAgICAgICAvLyB0aGlzIHdpbGwgZ2V0IGNvbnZlcnRlZCB0byBhIGJvb2xlYW4gaWYgbmVlZGVkIGluIF9yZWZyZXNoKCkNCiAgICAgICAgICAgIG9wdGlvbnMuZGlzYWJsZWQgPSAkLm1hcCggbGlzLmZpbHRlciggIi51aS1zdGF0ZS1kaXNhYmxlZCIgKSwgZnVuY3Rpb24oIHRhYiApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbGlzLmluZGV4KCB0YWIgKTsNCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgdGhpcy5fcHJvY2Vzc1RhYnMoKTsNCg0KICAgICAgICAgICAgLy8gV2FzIGNvbGxhcHNlZCBvciBubyB0YWJzDQogICAgICAgICAgICBpZiAoIG9wdGlvbnMuYWN0aXZlID09PSBmYWxzZSB8fCAhdGhpcy5hbmNob3JzLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICBvcHRpb25zLmFjdGl2ZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gJCgpOw0KDQogICAgICAgICAgICAgICAgLy8gd2FzIGFjdGl2ZSwgYnV0IGFjdGl2ZSB0YWIgaXMgZ29uZQ0KICAgICAgICAgICAgfSBlbHNlIGlmICggdGhpcy5hY3RpdmUubGVuZ3RoICYmICEkLmNvbnRhaW5zKCB0aGlzLnRhYmxpc3RbIDAgXSwgdGhpcy5hY3RpdmVbIDAgXSApICkgew0KDQogICAgICAgICAgICAgICAgLy8gYWxsIHJlbWFpbmluZyB0YWJzIGFyZSBkaXNhYmxlZA0KICAgICAgICAgICAgICAgIGlmICggdGhpcy50YWJzLmxlbmd0aCA9PT0gb3B0aW9ucy5kaXNhYmxlZC5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuYWN0aXZlID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gJCgpOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIGFjdGl2YXRlIHByZXZpb3VzIHRhYg0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2FjdGl2YXRlKCB0aGlzLl9maW5kTmV4dFRhYiggTWF0aC5tYXgoIDAsIG9wdGlvbnMuYWN0aXZlIC0gMSApLCBmYWxzZSApICk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8gd2FzIGFjdGl2ZSwgYWN0aXZlIHRhYiBzdGlsbCBleGlzdHMNCiAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUgYWN0aXZlIGluZGV4IGlzIGNvcnJlY3QNCiAgICAgICAgICAgICAgICBvcHRpb25zLmFjdGl2ZSA9IHRoaXMudGFicy5pbmRleCggdGhpcy5hY3RpdmUgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fcmVmcmVzaCgpOw0KICAgICAgICB9LA0KDQogICAgICAgIF9yZWZyZXNoOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuX3NldE9wdGlvbkRpc2FibGVkKCB0aGlzLm9wdGlvbnMuZGlzYWJsZWQgKTsNCiAgICAgICAgICAgIHRoaXMuX3NldHVwRXZlbnRzKCB0aGlzLm9wdGlvbnMuZXZlbnQgKTsNCiAgICAgICAgICAgIHRoaXMuX3NldHVwSGVpZ2h0U3R5bGUoIHRoaXMub3B0aW9ucy5oZWlnaHRTdHlsZSApOw0KDQogICAgICAgICAgICB0aGlzLnRhYnMubm90KCB0aGlzLmFjdGl2ZSApLmF0dHIoIHsNCiAgICAgICAgICAgICAgICAiYXJpYS1zZWxlY3RlZCI6ICJmYWxzZSIsDQogICAgICAgICAgICAgICAgImFyaWEtZXhwYW5kZWQiOiAiZmFsc2UiLA0KICAgICAgICAgICAgICAgIHRhYkluZGV4OiAtMQ0KICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgdGhpcy5wYW5lbHMubm90KCB0aGlzLl9nZXRQYW5lbEZvclRhYiggdGhpcy5hY3RpdmUgKSApDQogICAgICAgICAgICAgICAgLmhpZGUoKQ0KICAgICAgICAgICAgICAgIC5hdHRyKCB7DQogICAgICAgICAgICAgICAgICAgICJhcmlhLWhpZGRlbiI6ICJ0cnVlIg0KICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgLy8gTWFrZSBzdXJlIG9uZSB0YWIgaXMgaW4gdGhlIHRhYiBvcmRlcg0KICAgICAgICAgICAgaWYgKCAhdGhpcy5hY3RpdmUubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIHRoaXMudGFicy5lcSggMCApLmF0dHIoICJ0YWJJbmRleCIsIDAgKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUNCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJhcmlhLXNlbGVjdGVkIjogInRydWUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgImFyaWEtZXhwYW5kZWQiOiAidHJ1ZSIsDQogICAgICAgICAgICAgICAgICAgICAgICB0YWJJbmRleDogMA0KICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMuYWN0aXZlLCAidWktdGFicy1hY3RpdmUiLCAidWktc3RhdGUtYWN0aXZlIiApOw0KICAgICAgICAgICAgICAgIHRoaXMuX2dldFBhbmVsRm9yVGFiKCB0aGlzLmFjdGl2ZSApDQogICAgICAgICAgICAgICAgICAgIC5zaG93KCkNCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJhcmlhLWhpZGRlbiI6ICJmYWxzZSINCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9wcm9jZXNzVGFiczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgcHJldlRhYnMgPSB0aGlzLnRhYnMsDQogICAgICAgICAgICAgICAgcHJldkFuY2hvcnMgPSB0aGlzLmFuY2hvcnMsDQogICAgICAgICAgICAgICAgcHJldlBhbmVscyA9IHRoaXMucGFuZWxzOw0KDQogICAgICAgICAgICB0aGlzLnRhYmxpc3QgPSB0aGlzLl9nZXRMaXN0KCkuYXR0ciggInJvbGUiLCAidGFibGlzdCIgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLnRhYmxpc3QsICJ1aS10YWJzLW5hdiIsDQogICAgICAgICAgICAgICAgInVpLWhlbHBlci1yZXNldCB1aS1oZWxwZXItY2xlYXJmaXggdWktd2lkZ2V0LWhlYWRlciIgKTsNCg0KICAgICAgICAgICAgLy8gUHJldmVudCB1c2VycyBmcm9tIGZvY3VzaW5nIGRpc2FibGVkIHRhYnMgdmlhIGNsaWNrDQogICAgICAgICAgICB0aGlzLnRhYmxpc3QNCiAgICAgICAgICAgICAgICAub24oICJtb3VzZWRvd24iICsgdGhpcy5ldmVudE5hbWVzcGFjZSwgIj4gbGkiLCBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggJCggdGhpcyApLmlzKCAiLnVpLXN0YXRlLWRpc2FibGVkIiApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gKQ0KDQogICAgICAgICAgICAgICAgLy8gU3VwcG9ydDogSUUgPDkNCiAgICAgICAgICAgICAgICAvLyBQcmV2ZW50aW5nIHRoZSBkZWZhdWx0IGFjdGlvbiBpbiBtb3VzZWRvd24gZG9lc24ndCBwcmV2ZW50IElFDQogICAgICAgICAgICAgICAgLy8gZnJvbSBmb2N1c2luZyB0aGUgZWxlbWVudCwgc28gaWYgdGhlIGFuY2hvciBnZXRzIGZvY3VzZWQsIGJsdXIuDQogICAgICAgICAgICAgICAgLy8gV2UgZG9uJ3QgaGF2ZSB0byB3b3JyeSBhYm91dCBmb2N1c2luZyB0aGUgcHJldmlvdXNseSBmb2N1c2VkDQogICAgICAgICAgICAgICAgLy8gZWxlbWVudCBzaW5jZSBjbGlja2luZyBvbiBhIG5vbi1mb2N1c2FibGUgZWxlbWVudCBzaG91bGQgZm9jdXMNCiAgICAgICAgICAgICAgICAvLyB0aGUgYm9keSBhbnl3YXkuDQogICAgICAgICAgICAgICAgLm9uKCAiZm9jdXMiICsgdGhpcy5ldmVudE5hbWVzcGFjZSwgIi51aS10YWJzLWFuY2hvciIsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoICQoIHRoaXMgKS5jbG9zZXN0KCAibGkiICkuaXMoICIudWktc3RhdGUtZGlzYWJsZWQiICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJsdXIoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgdGhpcy50YWJzID0gdGhpcy50YWJsaXN0LmZpbmQoICI+IGxpOmhhcyhhW2hyZWZdKSIgKQ0KICAgICAgICAgICAgICAgIC5hdHRyKCB7DQogICAgICAgICAgICAgICAgICAgIHJvbGU6ICJ0YWIiLA0KICAgICAgICAgICAgICAgICAgICB0YWJJbmRleDogLTENCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy50YWJzLCAidWktdGFicy10YWIiLCAidWktc3RhdGUtZGVmYXVsdCIgKTsNCg0KICAgICAgICAgICAgdGhpcy5hbmNob3JzID0gdGhpcy50YWJzLm1hcCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICQoICJhIiwgdGhpcyApWyAwIF07DQogICAgICAgICAgICB9ICkNCiAgICAgICAgICAgICAgICAuYXR0ciggew0KICAgICAgICAgICAgICAgICAgICByb2xlOiAicHJlc2VudGF0aW9uIiwNCiAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg6IC0xDQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRoaXMuYW5jaG9ycywgInVpLXRhYnMtYW5jaG9yIiApOw0KDQogICAgICAgICAgICB0aGlzLnBhbmVscyA9ICQoKTsNCg0KICAgICAgICAgICAgdGhpcy5hbmNob3JzLmVhY2goIGZ1bmN0aW9uKCBpLCBhbmNob3IgKSB7DQogICAgICAgICAgICAgICAgdmFyIHNlbGVjdG9yLCBwYW5lbCwgcGFuZWxJZCwNCiAgICAgICAgICAgICAgICAgICAgYW5jaG9ySWQgPSAkKCBhbmNob3IgKS51bmlxdWVJZCgpLmF0dHIoICJpZCIgKSwNCiAgICAgICAgICAgICAgICAgICAgdGFiID0gJCggYW5jaG9yICkuY2xvc2VzdCggImxpIiApLA0KICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbEFyaWFDb250cm9scyA9IHRhYi5hdHRyKCAiYXJpYS1jb250cm9scyIgKTsNCg0KICAgICAgICAgICAgICAgIC8vIElubGluZSB0YWINCiAgICAgICAgICAgICAgICBpZiAoIHRoYXQuX2lzTG9jYWwoIGFuY2hvciApICkgew0KICAgICAgICAgICAgICAgICAgICBzZWxlY3RvciA9IGFuY2hvci5oYXNoOw0KICAgICAgICAgICAgICAgICAgICBwYW5lbElkID0gc2VsZWN0b3Iuc3Vic3RyaW5nKCAxICk7DQogICAgICAgICAgICAgICAgICAgIHBhbmVsID0gdGhhdC5lbGVtZW50LmZpbmQoIHRoYXQuX3Nhbml0aXplU2VsZWN0b3IoIHNlbGVjdG9yICkgKTsNCg0KICAgICAgICAgICAgICAgICAgICAvLyByZW1vdGUgdGFiDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgdGFiIGRvZXNuJ3QgYWxyZWFkeSBoYXZlIGFyaWEtY29udHJvbHMsDQogICAgICAgICAgICAgICAgICAgIC8vIGdlbmVyYXRlIGFuIGlkIGJ5IHVzaW5nIGEgdGhyb3ctYXdheSBlbGVtZW50DQogICAgICAgICAgICAgICAgICAgIHBhbmVsSWQgPSB0YWIuYXR0ciggImFyaWEtY29udHJvbHMiICkgfHwgJCgge30gKS51bmlxdWVJZCgpWyAwIF0uaWQ7DQogICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yID0gIiMiICsgcGFuZWxJZDsNCiAgICAgICAgICAgICAgICAgICAgcGFuZWwgPSB0aGF0LmVsZW1lbnQuZmluZCggc2VsZWN0b3IgKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAhcGFuZWwubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWwgPSB0aGF0Ll9jcmVhdGVQYW5lbCggcGFuZWxJZCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWwuaW5zZXJ0QWZ0ZXIoIHRoYXQucGFuZWxzWyBpIC0gMSBdIHx8IHRoYXQudGFibGlzdCApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHBhbmVsLmF0dHIoICJhcmlhLWxpdmUiLCAicG9saXRlIiApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggcGFuZWwubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgICAgICB0aGF0LnBhbmVscyA9IHRoYXQucGFuZWxzLmFkZCggcGFuZWwgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCBvcmlnaW5hbEFyaWFDb250cm9scyApIHsNCiAgICAgICAgICAgICAgICAgICAgdGFiLmRhdGEoICJ1aS10YWJzLWFyaWEtY29udHJvbHMiLCBvcmlnaW5hbEFyaWFDb250cm9scyApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0YWIuYXR0ciggew0KICAgICAgICAgICAgICAgICAgICAiYXJpYS1jb250cm9scyI6IHBhbmVsSWQsDQogICAgICAgICAgICAgICAgICAgICJhcmlhLWxhYmVsbGVkYnkiOiBhbmNob3JJZA0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICBwYW5lbC5hdHRyKCAiYXJpYS1sYWJlbGxlZGJ5IiwgYW5jaG9ySWQgKTsNCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgdGhpcy5wYW5lbHMuYXR0ciggInJvbGUiLCAidGFicGFuZWwiICk7DQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy5wYW5lbHMsICJ1aS10YWJzLXBhbmVsIiwgInVpLXdpZGdldC1jb250ZW50IiApOw0KDQogICAgICAgICAgICAvLyBBdm9pZCBtZW1vcnkgbGVha3MgKCMxMDA1NikNCiAgICAgICAgICAgIGlmICggcHJldlRhYnMgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fb2ZmKCBwcmV2VGFicy5ub3QoIHRoaXMudGFicyApICk7DQogICAgICAgICAgICAgICAgdGhpcy5fb2ZmKCBwcmV2QW5jaG9ycy5ub3QoIHRoaXMuYW5jaG9ycyApICk7DQogICAgICAgICAgICAgICAgdGhpcy5fb2ZmKCBwcmV2UGFuZWxzLm5vdCggdGhpcy5wYW5lbHMgKSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIC8vIEFsbG93IG92ZXJyaWRpbmcgaG93IHRvIGZpbmQgdGhlIGxpc3QgZm9yIHJhcmUgdXNhZ2Ugc2NlbmFyaW9zICgjNzcxNSkNCiAgICAgICAgX2dldExpc3Q6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFibGlzdCB8fCB0aGlzLmVsZW1lbnQuZmluZCggIm9sLCB1bCIgKS5lcSggMCApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9jcmVhdGVQYW5lbDogZnVuY3Rpb24oIGlkICkgew0KICAgICAgICAgICAgcmV0dXJuICQoICI8ZGl2PiIgKQ0KICAgICAgICAgICAgICAgIC5hdHRyKCAiaWQiLCBpZCApDQogICAgICAgICAgICAgICAgLmRhdGEoICJ1aS10YWJzLWRlc3Ryb3kiLCB0cnVlICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldE9wdGlvbkRpc2FibGVkOiBmdW5jdGlvbiggZGlzYWJsZWQgKSB7DQogICAgICAgICAgICB2YXIgY3VycmVudEl0ZW0sIGxpLCBpOw0KDQogICAgICAgICAgICBpZiAoICQuaXNBcnJheSggZGlzYWJsZWQgKSApIHsNCiAgICAgICAgICAgICAgICBpZiAoICFkaXNhYmxlZC5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgICAgIGRpc2FibGVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmICggZGlzYWJsZWQubGVuZ3RoID09PSB0aGlzLmFuY2hvcnMubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBEaXNhYmxlIHRhYnMNCiAgICAgICAgICAgIGZvciAoIGkgPSAwOyAoIGxpID0gdGhpcy50YWJzWyBpIF0gKTsgaSsrICkgew0KICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVtID0gJCggbGkgKTsNCiAgICAgICAgICAgICAgICBpZiAoIGRpc2FibGVkID09PSB0cnVlIHx8ICQuaW5BcnJheSggaSwgZGlzYWJsZWQgKSAhPT0gLTEgKSB7DQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVtLmF0dHIoICJhcmlhLWRpc2FibGVkIiwgInRydWUiICk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCBjdXJyZW50SXRlbSwgbnVsbCwgInVpLXN0YXRlLWRpc2FibGVkIiApOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVtLnJlbW92ZUF0dHIoICJhcmlhLWRpc2FibGVkIiApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVDbGFzcyggY3VycmVudEl0ZW0sIG51bGwsICJ1aS1zdGF0ZS1kaXNhYmxlZCIgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5kaXNhYmxlZCA9IGRpc2FibGVkOw0KDQogICAgICAgICAgICB0aGlzLl90b2dnbGVDbGFzcyggdGhpcy53aWRnZXQoKSwgdGhpcy53aWRnZXRGdWxsTmFtZSArICItZGlzYWJsZWQiLCBudWxsLA0KICAgICAgICAgICAgICAgIGRpc2FibGVkID09PSB0cnVlICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldHVwRXZlbnRzOiBmdW5jdGlvbiggZXZlbnQgKSB7DQogICAgICAgICAgICB2YXIgZXZlbnRzID0ge307DQogICAgICAgICAgICBpZiAoIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgICQuZWFjaCggZXZlbnQuc3BsaXQoICIgIiApLCBmdW5jdGlvbiggaW5kZXgsIGV2ZW50TmFtZSApIHsNCiAgICAgICAgICAgICAgICAgICAgZXZlbnRzWyBldmVudE5hbWUgXSA9ICJfZXZlbnRIYW5kbGVyIjsNCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX29mZiggdGhpcy5hbmNob3JzLmFkZCggdGhpcy50YWJzICkuYWRkKCB0aGlzLnBhbmVscyApICk7DQoNCiAgICAgICAgICAgIC8vIEFsd2F5cyBwcmV2ZW50IHRoZSBkZWZhdWx0IGFjdGlvbiwgZXZlbiB3aGVuIGRpc2FibGVkDQogICAgICAgICAgICB0aGlzLl9vbiggdHJ1ZSwgdGhpcy5hbmNob3JzLCB7DQogICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB0aGlzLl9vbiggdGhpcy5hbmNob3JzLCBldmVudHMgKTsNCiAgICAgICAgICAgIHRoaXMuX29uKCB0aGlzLnRhYnMsIHsga2V5ZG93bjogIl90YWJLZXlkb3duIiB9ICk7DQogICAgICAgICAgICB0aGlzLl9vbiggdGhpcy5wYW5lbHMsIHsga2V5ZG93bjogIl9wYW5lbEtleWRvd24iIH0gKTsNCg0KICAgICAgICAgICAgdGhpcy5fZm9jdXNhYmxlKCB0aGlzLnRhYnMgKTsNCiAgICAgICAgICAgIHRoaXMuX2hvdmVyYWJsZSggdGhpcy50YWJzICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3NldHVwSGVpZ2h0U3R5bGU6IGZ1bmN0aW9uKCBoZWlnaHRTdHlsZSApIHsNCiAgICAgICAgICAgIHZhciBtYXhIZWlnaHQsDQogICAgICAgICAgICAgICAgcGFyZW50ID0gdGhpcy5lbGVtZW50LnBhcmVudCgpOw0KDQogICAgICAgICAgICBpZiAoIGhlaWdodFN0eWxlID09PSAiZmlsbCIgKSB7DQogICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gcGFyZW50LmhlaWdodCgpOw0KICAgICAgICAgICAgICAgIG1heEhlaWdodCAtPSB0aGlzLmVsZW1lbnQub3V0ZXJIZWlnaHQoKSAtIHRoaXMuZWxlbWVudC5oZWlnaHQoKTsNCg0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zaWJsaW5ncyggIjp2aXNpYmxlIiApLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbSA9ICQoIHRoaXMgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gZWxlbS5jc3MoICJwb3NpdGlvbiIgKTsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoIHBvc2l0aW9uID09PSAiYWJzb2x1dGUiIHx8IHBvc2l0aW9uID09PSAiZml4ZWQiICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIG1heEhlaWdodCAtPSBlbGVtLm91dGVySGVpZ2h0KCB0cnVlICk7DQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNoaWxkcmVuKCkubm90KCB0aGlzLnBhbmVscyApLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBtYXhIZWlnaHQgLT0gJCggdGhpcyApLm91dGVySGVpZ2h0KCB0cnVlICk7DQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgdGhpcy5wYW5lbHMuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICQoIHRoaXMgKS5oZWlnaHQoIE1hdGgubWF4KCAwLCBtYXhIZWlnaHQgLQ0KICAgICAgICAgICAgICAgICAgICAgICAgJCggdGhpcyApLmlubmVySGVpZ2h0KCkgKyAkKCB0aGlzICkuaGVpZ2h0KCkgKSApOw0KICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgICAgICAuY3NzKCAib3ZlcmZsb3ciLCAiYXV0byIgKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGhlaWdodFN0eWxlID09PSAiYXV0byIgKSB7DQogICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gMDsNCiAgICAgICAgICAgICAgICB0aGlzLnBhbmVscy5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gTWF0aC5tYXgoIG1heEhlaWdodCwgJCggdGhpcyApLmhlaWdodCggIiIgKS5oZWlnaHQoKSApOw0KICAgICAgICAgICAgICAgIH0gKS5oZWlnaHQoIG1heEhlaWdodCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9ldmVudEhhbmRsZXI6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLA0KICAgICAgICAgICAgICAgIGFjdGl2ZSA9IHRoaXMuYWN0aXZlLA0KICAgICAgICAgICAgICAgIGFuY2hvciA9ICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwNCiAgICAgICAgICAgICAgICB0YWIgPSBhbmNob3IuY2xvc2VzdCggImxpIiApLA0KICAgICAgICAgICAgICAgIGNsaWNrZWRJc0FjdGl2ZSA9IHRhYlsgMCBdID09PSBhY3RpdmVbIDAgXSwNCiAgICAgICAgICAgICAgICBjb2xsYXBzaW5nID0gY2xpY2tlZElzQWN0aXZlICYmIG9wdGlvbnMuY29sbGFwc2libGUsDQogICAgICAgICAgICAgICAgdG9TaG93ID0gY29sbGFwc2luZyA/ICQoKSA6IHRoaXMuX2dldFBhbmVsRm9yVGFiKCB0YWIgKSwNCiAgICAgICAgICAgICAgICB0b0hpZGUgPSAhYWN0aXZlLmxlbmd0aCA/ICQoKSA6IHRoaXMuX2dldFBhbmVsRm9yVGFiKCBhY3RpdmUgKSwNCiAgICAgICAgICAgICAgICBldmVudERhdGEgPSB7DQogICAgICAgICAgICAgICAgICAgIG9sZFRhYjogYWN0aXZlLA0KICAgICAgICAgICAgICAgICAgICBvbGRQYW5lbDogdG9IaWRlLA0KICAgICAgICAgICAgICAgICAgICBuZXdUYWI6IGNvbGxhcHNpbmcgPyAkKCkgOiB0YWIsDQogICAgICAgICAgICAgICAgICAgIG5ld1BhbmVsOiB0b1Nob3cNCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KDQogICAgICAgICAgICBpZiAoIHRhYi5oYXNDbGFzcyggInVpLXN0YXRlLWRpc2FibGVkIiApIHx8DQoNCiAgICAgICAgICAgICAgICAvLyB0YWIgaXMgYWxyZWFkeSBsb2FkaW5nDQogICAgICAgICAgICAgICAgdGFiLmhhc0NsYXNzKCAidWktdGFicy1sb2FkaW5nIiApIHx8DQoNCiAgICAgICAgICAgICAgICAvLyBjYW4ndCBzd2l0Y2ggZHVybmluZyBhbiBhbmltYXRpb24NCiAgICAgICAgICAgICAgICB0aGlzLnJ1bm5pbmcgfHwNCg0KICAgICAgICAgICAgICAgIC8vIGNsaWNrIG9uIGFjdGl2ZSBoZWFkZXIsIGJ1dCBub3QgY29sbGFwc2libGUNCiAgICAgICAgICAgICAgICAoIGNsaWNrZWRJc0FjdGl2ZSAmJiAhb3B0aW9ucy5jb2xsYXBzaWJsZSApIHx8DQoNCiAgICAgICAgICAgICAgICAvLyBhbGxvdyBjYW5jZWxpbmcgYWN0aXZhdGlvbg0KICAgICAgICAgICAgICAgICggdGhpcy5fdHJpZ2dlciggImJlZm9yZUFjdGl2YXRlIiwgZXZlbnQsIGV2ZW50RGF0YSApID09PSBmYWxzZSApICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgb3B0aW9ucy5hY3RpdmUgPSBjb2xsYXBzaW5nID8gZmFsc2UgOiB0aGlzLnRhYnMuaW5kZXgoIHRhYiApOw0KDQogICAgICAgICAgICB0aGlzLmFjdGl2ZSA9IGNsaWNrZWRJc0FjdGl2ZSA/ICQoKSA6IHRhYjsNCiAgICAgICAgICAgIGlmICggdGhpcy54aHIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy54aHIuYWJvcnQoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCAhdG9IaWRlLmxlbmd0aCAmJiAhdG9TaG93Lmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICAkLmVycm9yKCAialF1ZXJ5IFVJIFRhYnM6IE1pc21hdGNoaW5nIGZyYWdtZW50IGlkZW50aWZpZXIuIiApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHRvU2hvdy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgdGhpcy5sb2FkKCB0aGlzLnRhYnMuaW5kZXgoIHRhYiApLCBldmVudCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5fdG9nZ2xlKCBldmVudCwgZXZlbnREYXRhICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLy8gSGFuZGxlcyBzaG93L2hpZGUgZm9yIHNlbGVjdGluZyB0YWJzDQogICAgICAgIF90b2dnbGU6IGZ1bmN0aW9uKCBldmVudCwgZXZlbnREYXRhICkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIHRvU2hvdyA9IGV2ZW50RGF0YS5uZXdQYW5lbCwNCiAgICAgICAgICAgICAgICB0b0hpZGUgPSBldmVudERhdGEub2xkUGFuZWw7DQoNCiAgICAgICAgICAgIHRoaXMucnVubmluZyA9IHRydWU7DQoNCiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXBsZXRlKCkgew0KICAgICAgICAgICAgICAgIHRoYXQucnVubmluZyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIHRoYXQuX3RyaWdnZXIoICJhY3RpdmF0ZSIsIGV2ZW50LCBldmVudERhdGEgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZnVuY3Rpb24gc2hvdygpIHsNCiAgICAgICAgICAgICAgICB0aGF0Ll9hZGRDbGFzcyggZXZlbnREYXRhLm5ld1RhYi5jbG9zZXN0KCAibGkiICksICJ1aS10YWJzLWFjdGl2ZSIsICJ1aS1zdGF0ZS1hY3RpdmUiICk7DQoNCiAgICAgICAgICAgICAgICBpZiAoIHRvU2hvdy5sZW5ndGggJiYgdGhhdC5vcHRpb25zLnNob3cgKSB7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX3Nob3coIHRvU2hvdywgdGhhdC5vcHRpb25zLnNob3csIGNvbXBsZXRlICk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdG9TaG93LnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgY29tcGxldGUoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFN0YXJ0IG91dCBieSBoaWRpbmcsIHRoZW4gc2hvd2luZywgdGhlbiBjb21wbGV0aW5nDQogICAgICAgICAgICBpZiAoIHRvSGlkZS5sZW5ndGggJiYgdGhpcy5vcHRpb25zLmhpZGUgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5faGlkZSggdG9IaWRlLCB0aGlzLm9wdGlvbnMuaGlkZSwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX3JlbW92ZUNsYXNzKCBldmVudERhdGEub2xkVGFiLmNsb3Nlc3QoICJsaSIgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ1aS10YWJzLWFjdGl2ZSIsICJ1aS1zdGF0ZS1hY3RpdmUiICk7DQogICAgICAgICAgICAgICAgICAgIHNob3coKTsNCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNsYXNzKCBldmVudERhdGEub2xkVGFiLmNsb3Nlc3QoICJsaSIgKSwNCiAgICAgICAgICAgICAgICAgICAgInVpLXRhYnMtYWN0aXZlIiwgInVpLXN0YXRlLWFjdGl2ZSIgKTsNCiAgICAgICAgICAgICAgICB0b0hpZGUuaGlkZSgpOw0KICAgICAgICAgICAgICAgIHNob3coKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdG9IaWRlLmF0dHIoICJhcmlhLWhpZGRlbiIsICJ0cnVlIiApOw0KICAgICAgICAgICAgZXZlbnREYXRhLm9sZFRhYi5hdHRyKCB7DQogICAgICAgICAgICAgICAgImFyaWEtc2VsZWN0ZWQiOiAiZmFsc2UiLA0KICAgICAgICAgICAgICAgICJhcmlhLWV4cGFuZGVkIjogImZhbHNlIg0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAvLyBJZiB3ZSdyZSBzd2l0Y2hpbmcgdGFicywgcmVtb3ZlIHRoZSBvbGQgdGFiIGZyb20gdGhlIHRhYiBvcmRlci4NCiAgICAgICAgICAgIC8vIElmIHdlJ3JlIG9wZW5pbmcgZnJvbSBjb2xsYXBzZWQgc3RhdGUsIHJlbW92ZSB0aGUgcHJldmlvdXMgdGFiIGZyb20gdGhlIHRhYiBvcmRlci4NCiAgICAgICAgICAgIC8vIElmIHdlJ3JlIGNvbGxhcHNpbmcsIHRoZW4ga2VlcCB0aGUgY29sbGFwc2luZyB0YWIgaW4gdGhlIHRhYiBvcmRlci4NCiAgICAgICAgICAgIGlmICggdG9TaG93Lmxlbmd0aCAmJiB0b0hpZGUubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIGV2ZW50RGF0YS5vbGRUYWIuYXR0ciggInRhYkluZGV4IiwgLTEgKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHRvU2hvdy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgdGhpcy50YWJzLmZpbHRlciggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAkKCB0aGlzICkuYXR0ciggInRhYkluZGV4IiApID09PSAwOw0KICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgICAgICAuYXR0ciggInRhYkluZGV4IiwgLTEgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdG9TaG93LmF0dHIoICJhcmlhLWhpZGRlbiIsICJmYWxzZSIgKTsNCiAgICAgICAgICAgIGV2ZW50RGF0YS5uZXdUYWIuYXR0ciggew0KICAgICAgICAgICAgICAgICJhcmlhLXNlbGVjdGVkIjogInRydWUiLA0KICAgICAgICAgICAgICAgICJhcmlhLWV4cGFuZGVkIjogInRydWUiLA0KICAgICAgICAgICAgICAgIHRhYkluZGV4OiAwDQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2FjdGl2YXRlOiBmdW5jdGlvbiggaW5kZXggKSB7DQogICAgICAgICAgICB2YXIgYW5jaG9yLA0KICAgICAgICAgICAgICAgIGFjdGl2ZSA9IHRoaXMuX2ZpbmRBY3RpdmUoIGluZGV4ICk7DQoNCiAgICAgICAgICAgIC8vIFRyeWluZyB0byBhY3RpdmF0ZSB0aGUgYWxyZWFkeSBhY3RpdmUgcGFuZWwNCiAgICAgICAgICAgIGlmICggYWN0aXZlWyAwIF0gPT09IHRoaXMuYWN0aXZlWyAwIF0gKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBUcnlpbmcgdG8gY29sbGFwc2UsIHNpbXVsYXRlIGEgY2xpY2sgb24gdGhlIGN1cnJlbnQgYWN0aXZlIGhlYWRlcg0KICAgICAgICAgICAgaWYgKCAhYWN0aXZlLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICBhY3RpdmUgPSB0aGlzLmFjdGl2ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgYW5jaG9yID0gYWN0aXZlLmZpbmQoICIudWktdGFicy1hbmNob3IiIClbIDAgXTsNCiAgICAgICAgICAgIHRoaXMuX2V2ZW50SGFuZGxlciggew0KICAgICAgICAgICAgICAgIHRhcmdldDogYW5jaG9yLA0KICAgICAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQ6IGFuY2hvciwNCiAgICAgICAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogJC5ub29wDQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2ZpbmRBY3RpdmU6IGZ1bmN0aW9uKCBpbmRleCApIHsNCiAgICAgICAgICAgIHJldHVybiBpbmRleCA9PT0gZmFsc2UgPyAkKCkgOiB0aGlzLnRhYnMuZXEoIGluZGV4ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2dldEluZGV4OiBmdW5jdGlvbiggaW5kZXggKSB7DQoNCiAgICAgICAgICAgIC8vIG1ldGEtZnVuY3Rpb24gdG8gZ2l2ZSB1c2VycyBvcHRpb24gdG8gcHJvdmlkZSBhIGhyZWYgc3RyaW5nIGluc3RlYWQgb2YgYSBudW1lcmljYWwgaW5kZXguDQogICAgICAgICAgICBpZiAoIHR5cGVvZiBpbmRleCA9PT0gInN0cmluZyIgKSB7DQogICAgICAgICAgICAgICAgaW5kZXggPSB0aGlzLmFuY2hvcnMuaW5kZXgoIHRoaXMuYW5jaG9ycy5maWx0ZXIoICJbaHJlZiQ9JyIgKw0KICAgICAgICAgICAgICAgICAgICAkLnVpLmVzY2FwZVNlbGVjdG9yKCBpbmRleCApICsgIiddIiApICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBpbmRleDsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZGVzdHJveTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBpZiAoIHRoaXMueGhyICkgew0KICAgICAgICAgICAgICAgIHRoaXMueGhyLmFib3J0KCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMudGFibGlzdA0KICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKCAicm9sZSIgKQ0KICAgICAgICAgICAgICAgIC5vZmYoIHRoaXMuZXZlbnROYW1lc3BhY2UgKTsNCg0KICAgICAgICAgICAgdGhpcy5hbmNob3JzDQogICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoICJyb2xlIHRhYkluZGV4IiApDQogICAgICAgICAgICAgICAgLnJlbW92ZVVuaXF1ZUlkKCk7DQoNCiAgICAgICAgICAgIHRoaXMudGFicy5hZGQoIHRoaXMucGFuZWxzICkuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgaWYgKCAkLmRhdGEoIHRoaXMsICJ1aS10YWJzLWRlc3Ryb3kiICkgKSB7DQogICAgICAgICAgICAgICAgICAgICQoIHRoaXMgKS5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAkKCB0aGlzICkucmVtb3ZlQXR0ciggInJvbGUgdGFiSW5kZXggIiArDQogICAgICAgICAgICAgICAgICAgICAgICAiYXJpYS1saXZlIGFyaWEtYnVzeSBhcmlhLXNlbGVjdGVkIGFyaWEtbGFiZWxsZWRieSBhcmlhLWhpZGRlbiBhcmlhLWV4cGFuZGVkIiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgdGhpcy50YWJzLmVhY2goIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciBsaSA9ICQoIHRoaXMgKSwNCiAgICAgICAgICAgICAgICAgICAgcHJldiA9IGxpLmRhdGEoICJ1aS10YWJzLWFyaWEtY29udHJvbHMiICk7DQogICAgICAgICAgICAgICAgaWYgKCBwcmV2ICkgew0KICAgICAgICAgICAgICAgICAgICBsaQ0KICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoICJhcmlhLWNvbnRyb2xzIiwgcHJldiApDQogICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlRGF0YSggInVpLXRhYnMtYXJpYS1jb250cm9scyIgKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBsaS5yZW1vdmVBdHRyKCAiYXJpYS1jb250cm9scyIgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIHRoaXMucGFuZWxzLnNob3coKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuaGVpZ2h0U3R5bGUgIT09ICJjb250ZW50IiApIHsNCiAgICAgICAgICAgICAgICB0aGlzLnBhbmVscy5jc3MoICJoZWlnaHQiLCAiIiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIGVuYWJsZTogZnVuY3Rpb24oIGluZGV4ICkgew0KICAgICAgICAgICAgdmFyIGRpc2FibGVkID0gdGhpcy5vcHRpb25zLmRpc2FibGVkOw0KICAgICAgICAgICAgaWYgKCBkaXNhYmxlZCA9PT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIGluZGV4ID09PSB1bmRlZmluZWQgKSB7DQogICAgICAgICAgICAgICAgZGlzYWJsZWQgPSBmYWxzZTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaW5kZXggPSB0aGlzLl9nZXRJbmRleCggaW5kZXggKTsNCiAgICAgICAgICAgICAgICBpZiAoICQuaXNBcnJheSggZGlzYWJsZWQgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQgPSAkLm1hcCggZGlzYWJsZWQsIGZ1bmN0aW9uKCBudW0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVtICE9PSBpbmRleCA/IG51bSA6IG51bGw7DQogICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZCA9ICQubWFwKCB0aGlzLnRhYnMsIGZ1bmN0aW9uKCBsaSwgbnVtICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bSAhPT0gaW5kZXggPyBudW0gOiBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5fc2V0T3B0aW9uRGlzYWJsZWQoIGRpc2FibGVkICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgZGlzYWJsZTogZnVuY3Rpb24oIGluZGV4ICkgew0KICAgICAgICAgICAgdmFyIGRpc2FibGVkID0gdGhpcy5vcHRpb25zLmRpc2FibGVkOw0KICAgICAgICAgICAgaWYgKCBkaXNhYmxlZCA9PT0gdHJ1ZSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggaW5kZXggPT09IHVuZGVmaW5lZCApIHsNCiAgICAgICAgICAgICAgICBkaXNhYmxlZCA9IHRydWU7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy5fZ2V0SW5kZXgoIGluZGV4ICk7DQogICAgICAgICAgICAgICAgaWYgKCAkLmluQXJyYXkoIGluZGV4LCBkaXNhYmxlZCApICE9PSAtMSApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoICQuaXNBcnJheSggZGlzYWJsZWQgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQgPSAkLm1lcmdlKCBbIGluZGV4IF0sIGRpc2FibGVkICkuc29ydCgpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGRpc2FibGVkID0gWyBpbmRleCBdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX3NldE9wdGlvbkRpc2FibGVkKCBkaXNhYmxlZCApOw0KICAgICAgICB9LA0KDQogICAgICAgIGxvYWQ6IGZ1bmN0aW9uKCBpbmRleCwgZXZlbnQgKSB7DQogICAgICAgICAgICBpbmRleCA9IHRoaXMuX2dldEluZGV4KCBpbmRleCApOw0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIHRhYiA9IHRoaXMudGFicy5lcSggaW5kZXggKSwNCiAgICAgICAgICAgICAgICBhbmNob3IgPSB0YWIuZmluZCggIi51aS10YWJzLWFuY2hvciIgKSwNCiAgICAgICAgICAgICAgICBwYW5lbCA9IHRoaXMuX2dldFBhbmVsRm9yVGFiKCB0YWIgKSwNCiAgICAgICAgICAgICAgICBldmVudERhdGEgPSB7DQogICAgICAgICAgICAgICAgICAgIHRhYjogdGFiLA0KICAgICAgICAgICAgICAgICAgICBwYW5lbDogcGFuZWwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIGNvbXBsZXRlID0gZnVuY3Rpb24oIGpxWEhSLCBzdGF0dXMgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggc3RhdHVzID09PSAiYWJvcnQiICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5wYW5lbHMuc3RvcCggZmFsc2UsIHRydWUgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHRoYXQuX3JlbW92ZUNsYXNzKCB0YWIsICJ1aS10YWJzLWxvYWRpbmciICk7DQogICAgICAgICAgICAgICAgICAgIHBhbmVsLnJlbW92ZUF0dHIoICJhcmlhLWJ1c3kiICk7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBqcVhIUiA9PT0gdGhhdC54aHIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhhdC54aHI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAvLyBOb3QgcmVtb3RlDQogICAgICAgICAgICBpZiAoIHRoaXMuX2lzTG9jYWwoIGFuY2hvclsgMCBdICkgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLnhociA9ICQuYWpheCggdGhpcy5fYWpheFNldHRpbmdzKCBhbmNob3IsIGV2ZW50LCBldmVudERhdGEgKSApOw0KDQogICAgICAgICAgICAvLyBTdXBwb3J0OiBqUXVlcnkgPDEuOA0KICAgICAgICAgICAgLy8galF1ZXJ5IDwxLjggcmV0dXJucyBmYWxzZSBpZiB0aGUgcmVxdWVzdCBpcyBjYW5jZWxlZCBpbiBiZWZvcmVTZW5kLA0KICAgICAgICAgICAgLy8gYnV0IGFzIG9mIDEuOCwgJC5hamF4KCkgYWx3YXlzIHJldHVybnMgYSBqcVhIUiBvYmplY3QuDQogICAgICAgICAgICBpZiAoIHRoaXMueGhyICYmIHRoaXMueGhyLnN0YXR1c1RleHQgIT09ICJjYW5jZWxlZCIgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fYWRkQ2xhc3MoIHRhYiwgInVpLXRhYnMtbG9hZGluZyIgKTsNCiAgICAgICAgICAgICAgICBwYW5lbC5hdHRyKCAiYXJpYS1idXN5IiwgInRydWUiICk7DQoNCiAgICAgICAgICAgICAgICB0aGlzLnhocg0KICAgICAgICAgICAgICAgICAgICAuZG9uZSggZnVuY3Rpb24oIHJlc3BvbnNlLCBzdGF0dXMsIGpxWEhSICkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzdXBwb3J0OiBqUXVlcnkgPDEuOA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gaHR0cDovL2J1Z3MuanF1ZXJ5LmNvbS90aWNrZXQvMTE3NzgNCiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsLmh0bWwoIHJlc3BvbnNlICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5fdHJpZ2dlciggImxvYWQiLCBldmVudCwgZXZlbnREYXRhICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZSgganFYSFIsIHN0YXR1cyApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwgMSApOw0KICAgICAgICAgICAgICAgICAgICB9ICkNCiAgICAgICAgICAgICAgICAgICAgLmZhaWwoIGZ1bmN0aW9uKCBqcVhIUiwgc3RhdHVzICkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzdXBwb3J0OiBqUXVlcnkgPDEuOA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gaHR0cDovL2J1Z3MuanF1ZXJ5LmNvbS90aWNrZXQvMTE3NzgNCiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlKCBqcVhIUiwgc3RhdHVzICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9LCAxICk7DQogICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfYWpheFNldHRpbmdzOiBmdW5jdGlvbiggYW5jaG9yLCBldmVudCwgZXZlbnREYXRhICkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KICAgICAgICAgICAgcmV0dXJuIHsNCg0KICAgICAgICAgICAgICAgIC8vIFN1cHBvcnQ6IElFIDwxMSBvbmx5DQogICAgICAgICAgICAgICAgLy8gU3RyaXAgYW55IGhhc2ggdGhhdCBleGlzdHMgdG8gcHJldmVudCBlcnJvcnMgd2l0aCB0aGUgQWpheCByZXF1ZXN0DQogICAgICAgICAgICAgICAgdXJsOiBhbmNob3IuYXR0ciggImhyZWYiICkucmVwbGFjZSggLyMuKiQvLCAiIiApLA0KICAgICAgICAgICAgICAgIGJlZm9yZVNlbmQ6IGZ1bmN0aW9uKCBqcVhIUiwgc2V0dGluZ3MgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGF0Ll90cmlnZ2VyKCAiYmVmb3JlTG9hZCIsIGV2ZW50LA0KICAgICAgICAgICAgICAgICAgICAgICAgJC5leHRlbmQoIHsganFYSFI6IGpxWEhSLCBhamF4U2V0dGluZ3M6IHNldHRpbmdzIH0sIGV2ZW50RGF0YSApICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZ2V0UGFuZWxGb3JUYWI6IGZ1bmN0aW9uKCB0YWIgKSB7DQogICAgICAgICAgICB2YXIgaWQgPSAkKCB0YWIgKS5hdHRyKCAiYXJpYS1jb250cm9scyIgKTsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQuZmluZCggdGhpcy5fc2FuaXRpemVTZWxlY3RvciggIiMiICsgaWQgKSApOw0KICAgICAgICB9DQogICAgfSApOw0KDQovLyBERVBSRUNBVEVEDQovLyBUT0RPOiBTd2l0Y2ggcmV0dXJuIGJhY2sgdG8gd2lkZ2V0IGRlY2xhcmF0aW9uIGF0IHRvcCBvZiBmaWxlIHdoZW4gdGhpcyBpcyByZW1vdmVkDQogICAgaWYgKCAkLnVpQmFja0NvbXBhdCAhPT0gZmFsc2UgKSB7DQoNCiAgICAgICAgLy8gQmFja2NvbXBhdCBmb3IgdWktdGFiIGNsYXNzIChub3cgdWktdGFicy10YWIpDQogICAgICAgICQud2lkZ2V0KCAidWkudGFicyIsICQudWkudGFicywgew0KICAgICAgICAgICAgX3Byb2Nlc3NUYWJzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9zdXBlckFwcGx5KCBhcmd1bWVudHMgKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggdGhpcy50YWJzLCAidWktdGFiIiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9ICk7DQogICAgfQ0KDQogICAgdmFyIHdpZGdldHNUYWJzID0gJC51aS50YWJzOw0KDQoNCiAgICAvKiENCiAqIGpRdWVyeSBVSSBUb29sdGlwIDEuMTIuMQ0KICogaHR0cDovL2pxdWVyeXVpLmNvbQ0KICoNCiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuDQogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlDQogKi8NCg0KLy8+PmxhYmVsOiBUb29sdGlwDQovLz4+Z3JvdXA6IFdpZGdldHMNCi8vPj5kZXNjcmlwdGlvbjogU2hvd3MgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiBmb3IgYW55IGVsZW1lbnQgb24gaG92ZXIgb3IgZm9jdXMuDQovLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vdG9vbHRpcC8NCi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS90b29sdGlwLw0KLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2NvcmUuY3NzDQovLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvdG9vbHRpcC5jc3MNCi8vPj5jc3MudGhlbWU6IC4uLy4uL3RoZW1lcy9iYXNlL3RoZW1lLmNzcw0KDQoNCg0KICAgICQud2lkZ2V0KCAidWkudG9vbHRpcCIsIHsNCiAgICAgICAgdmVyc2lvbjogIjEuMTIuMSIsDQogICAgICAgIG9wdGlvbnM6IHsNCiAgICAgICAgICAgIGNsYXNzZXM6IHsNCiAgICAgICAgICAgICAgICAidWktdG9vbHRpcCI6ICJ1aS1jb3JuZXItYWxsIHVpLXdpZGdldC1zaGFkb3ciDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgY29udGVudDogZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBzdXBwb3J0OiBJRTw5LCBPcGVyYSBpbiBqUXVlcnkgPDEuNw0KICAgICAgICAgICAgICAgIC8vIC50ZXh0KCkgY2FuJ3QgYWNjZXB0IHVuZGVmaW5lZCwgc28gY29lcmNlIHRvIGEgc3RyaW5nDQogICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gJCggdGhpcyApLmF0dHIoICJ0aXRsZSIgKSB8fCAiIjsNCg0KICAgICAgICAgICAgICAgIC8vIEVzY2FwZSB0aXRsZSwgc2luY2Ugd2UncmUgZ29pbmcgZnJvbSBhbiBhdHRyaWJ1dGUgdG8gcmF3IEhUTUwNCiAgICAgICAgICAgICAgICByZXR1cm4gJCggIjxhPiIgKS50ZXh0KCB0aXRsZSApLmh0bWwoKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBoaWRlOiB0cnVlLA0KDQogICAgICAgICAgICAvLyBEaXNhYmxlZCBlbGVtZW50cyBoYXZlIGluY29uc2lzdGVudCBiZWhhdmlvciBhY3Jvc3MgYnJvd3NlcnMgKCM4NjYxKQ0KICAgICAgICAgICAgaXRlbXM6ICJbdGl0bGVdOm5vdChbZGlzYWJsZWRdKSIsDQogICAgICAgICAgICBwb3NpdGlvbjogew0KICAgICAgICAgICAgICAgIG15OiAibGVmdCB0b3ArMTUiLA0KICAgICAgICAgICAgICAgIGF0OiAibGVmdCBib3R0b20iLA0KICAgICAgICAgICAgICAgIGNvbGxpc2lvbjogImZsaXBmaXQgZmxpcCINCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBzaG93OiB0cnVlLA0KICAgICAgICAgICAgdHJhY2s6IGZhbHNlLA0KDQogICAgICAgICAgICAvLyBDYWxsYmFja3MNCiAgICAgICAgICAgIGNsb3NlOiBudWxsLA0KICAgICAgICAgICAgb3BlbjogbnVsbA0KICAgICAgICB9LA0KDQogICAgICAgIF9hZGREZXNjcmliZWRCeTogZnVuY3Rpb24oIGVsZW0sIGlkICkgew0KICAgICAgICAgICAgdmFyIGRlc2NyaWJlZGJ5ID0gKCBlbGVtLmF0dHIoICJhcmlhLWRlc2NyaWJlZGJ5IiApIHx8ICIiICkuc3BsaXQoIC9ccysvICk7DQogICAgICAgICAgICBkZXNjcmliZWRieS5wdXNoKCBpZCApOw0KICAgICAgICAgICAgZWxlbQ0KICAgICAgICAgICAgICAgIC5kYXRhKCAidWktdG9vbHRpcC1pZCIsIGlkICkNCiAgICAgICAgICAgICAgICAuYXR0ciggImFyaWEtZGVzY3JpYmVkYnkiLCAkLnRyaW0oIGRlc2NyaWJlZGJ5LmpvaW4oICIgIiApICkgKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBfcmVtb3ZlRGVzY3JpYmVkQnk6IGZ1bmN0aW9uKCBlbGVtICkgew0KICAgICAgICAgICAgdmFyIGlkID0gZWxlbS5kYXRhKCAidWktdG9vbHRpcC1pZCIgKSwNCiAgICAgICAgICAgICAgICBkZXNjcmliZWRieSA9ICggZWxlbS5hdHRyKCAiYXJpYS1kZXNjcmliZWRieSIgKSB8fCAiIiApLnNwbGl0KCAvXHMrLyApLA0KICAgICAgICAgICAgICAgIGluZGV4ID0gJC5pbkFycmF5KCBpZCwgZGVzY3JpYmVkYnkgKTsNCg0KICAgICAgICAgICAgaWYgKCBpbmRleCAhPT0gLTEgKSB7DQogICAgICAgICAgICAgICAgZGVzY3JpYmVkYnkuc3BsaWNlKCBpbmRleCwgMSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBlbGVtLnJlbW92ZURhdGEoICJ1aS10b29sdGlwLWlkIiApOw0KICAgICAgICAgICAgZGVzY3JpYmVkYnkgPSAkLnRyaW0oIGRlc2NyaWJlZGJ5LmpvaW4oICIgIiApICk7DQogICAgICAgICAgICBpZiAoIGRlc2NyaWJlZGJ5ICkgew0KICAgICAgICAgICAgICAgIGVsZW0uYXR0ciggImFyaWEtZGVzY3JpYmVkYnkiLCBkZXNjcmliZWRieSApOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBlbGVtLnJlbW92ZUF0dHIoICJhcmlhLWRlc2NyaWJlZGJ5IiApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9jcmVhdGU6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy5fb24oIHsNCiAgICAgICAgICAgICAgICBtb3VzZW92ZXI6ICJvcGVuIiwNCiAgICAgICAgICAgICAgICBmb2N1c2luOiAib3BlbiINCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgLy8gSURzIG9mIGdlbmVyYXRlZCB0b29sdGlwcywgbmVlZGVkIGZvciBkZXN0cm95DQogICAgICAgICAgICB0aGlzLnRvb2x0aXBzID0ge307DQoNCiAgICAgICAgICAgIC8vIElEcyBvZiBwYXJlbnQgdG9vbHRpcHMgd2hlcmUgd2UgcmVtb3ZlZCB0aGUgdGl0bGUgYXR0cmlidXRlDQogICAgICAgICAgICB0aGlzLnBhcmVudHMgPSB7fTsNCg0KICAgICAgICAgICAgLy8gQXBwZW5kIHRoZSBhcmlhLWxpdmUgcmVnaW9uIHNvIHRvb2x0aXBzIGFubm91bmNlIGNvcnJlY3RseQ0KICAgICAgICAgICAgdGhpcy5saXZlUmVnaW9uID0gJCggIjxkaXY+IiApDQogICAgICAgICAgICAgICAgLmF0dHIoIHsNCiAgICAgICAgICAgICAgICAgICAgcm9sZTogImxvZyIsDQogICAgICAgICAgICAgICAgICAgICJhcmlhLWxpdmUiOiAiYXNzZXJ0aXZlIiwNCiAgICAgICAgICAgICAgICAgICAgImFyaWEtcmVsZXZhbnQiOiAiYWRkaXRpb25zIg0KICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgIC5hcHBlbmRUbyggdGhpcy5kb2N1bWVudFsgMCBdLmJvZHkgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0aGlzLmxpdmVSZWdpb24sIG51bGwsICJ1aS1oZWxwZXItaGlkZGVuLWFjY2Vzc2libGUiICk7DQoNCiAgICAgICAgICAgIHRoaXMuZGlzYWJsZWRUaXRsZXMgPSAkKCBbXSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KDQogICAgICAgICAgICB0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApOw0KDQogICAgICAgICAgICBpZiAoIGtleSA9PT0gImNvbnRlbnQiICkgew0KICAgICAgICAgICAgICAgICQuZWFjaCggdGhpcy50b29sdGlwcywgZnVuY3Rpb24oIGlkLCB0b29sdGlwRGF0YSApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fdXBkYXRlQ29udGVudCggdG9vbHRpcERhdGEuZWxlbWVudCApOw0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfc2V0T3B0aW9uRGlzYWJsZWQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHsNCiAgICAgICAgICAgIHRoaXNbIHZhbHVlID8gIl9kaXNhYmxlIiA6ICJfZW5hYmxlIiBdKCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2Rpc2FibGU6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KDQogICAgICAgICAgICAvLyBDbG9zZSBvcGVuIHRvb2x0aXBzDQogICAgICAgICAgICAkLmVhY2goIHRoaXMudG9vbHRpcHMsIGZ1bmN0aW9uKCBpZCwgdG9vbHRpcERhdGEgKSB7DQogICAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gJC5FdmVudCggImJsdXIiICk7DQogICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0ID0gZXZlbnQuY3VycmVudFRhcmdldCA9IHRvb2x0aXBEYXRhLmVsZW1lbnRbIDAgXTsNCiAgICAgICAgICAgICAgICB0aGF0LmNsb3NlKCBldmVudCwgdHJ1ZSApOw0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAvLyBSZW1vdmUgdGl0bGUgYXR0cmlidXRlcyB0byBwcmV2ZW50IG5hdGl2ZSB0b29sdGlwcw0KICAgICAgICAgICAgdGhpcy5kaXNhYmxlZFRpdGxlcyA9IHRoaXMuZGlzYWJsZWRUaXRsZXMuYWRkKA0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKS5hZGRCYWNrKCkNCiAgICAgICAgICAgICAgICAgICAgLmZpbHRlciggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9ICQoIHRoaXMgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggZWxlbWVudC5pcyggIlt0aXRsZV0iICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoICJ1aS10b29sdGlwLXRpdGxlIiwgZWxlbWVudC5hdHRyKCAidGl0bGUiICkgKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQXR0ciggInRpdGxlIiApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9ICkNCiAgICAgICAgICAgICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX2VuYWJsZTogZnVuY3Rpb24oKSB7DQoNCiAgICAgICAgICAgIC8vIHJlc3RvcmUgdGl0bGUgYXR0cmlidXRlcw0KICAgICAgICAgICAgdGhpcy5kaXNhYmxlZFRpdGxlcy5lYWNoKCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9ICQoIHRoaXMgKTsNCiAgICAgICAgICAgICAgICBpZiAoIGVsZW1lbnQuZGF0YSggInVpLXRvb2x0aXAtdGl0bGUiICkgKSB7DQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXR0ciggInRpdGxlIiwgZWxlbWVudC5kYXRhKCAidWktdG9vbHRpcC10aXRsZSIgKSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIHRoaXMuZGlzYWJsZWRUaXRsZXMgPSAkKCBbXSApOw0KICAgICAgICB9LA0KDQogICAgICAgIG9wZW46IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcywNCiAgICAgICAgICAgICAgICB0YXJnZXQgPSAkKCBldmVudCA/IGV2ZW50LnRhcmdldCA6IHRoaXMuZWxlbWVudCApDQoNCiAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIGNsb3Nlc3QgaGVyZSBkdWUgdG8gbW91c2VvdmVyIGJ1YmJsaW5nLA0KICAgICAgICAgICAgICAgIC8vIGJ1dCBhbHdheXMgcG9pbnRpbmcgYXQgdGhlIHNhbWUgZXZlbnQgdGFyZ2V0DQogICAgICAgICAgICAgICAgICAgIC5jbG9zZXN0KCB0aGlzLm9wdGlvbnMuaXRlbXMgKTsNCg0KICAgICAgICAgICAgLy8gTm8gZWxlbWVudCB0byBzaG93IGEgdG9vbHRpcCBmb3Igb3IgdGhlIHRvb2x0aXAgaXMgYWxyZWFkeSBvcGVuDQogICAgICAgICAgICBpZiAoICF0YXJnZXQubGVuZ3RoIHx8IHRhcmdldC5kYXRhKCAidWktdG9vbHRpcC1pZCIgKSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGFyZ2V0LmF0dHIoICJ0aXRsZSIgKSApIHsNCiAgICAgICAgICAgICAgICB0YXJnZXQuZGF0YSggInVpLXRvb2x0aXAtdGl0bGUiLCB0YXJnZXQuYXR0ciggInRpdGxlIiApICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRhcmdldC5kYXRhKCAidWktdG9vbHRpcC1vcGVuIiwgdHJ1ZSApOw0KDQogICAgICAgICAgICAvLyBLaWxsIHBhcmVudCB0b29sdGlwcywgY3VzdG9tIG9yIG5hdGl2ZSwgZm9yIGhvdmVyDQogICAgICAgICAgICBpZiAoIGV2ZW50ICYmIGV2ZW50LnR5cGUgPT09ICJtb3VzZW92ZXIiICkgew0KICAgICAgICAgICAgICAgIHRhcmdldC5wYXJlbnRzKCkuZWFjaCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSAkKCB0aGlzICksDQogICAgICAgICAgICAgICAgICAgICAgICBibHVyRXZlbnQ7DQogICAgICAgICAgICAgICAgICAgIGlmICggcGFyZW50LmRhdGEoICJ1aS10b29sdGlwLW9wZW4iICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBibHVyRXZlbnQgPSAkLkV2ZW50KCAiYmx1ciIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJsdXJFdmVudC50YXJnZXQgPSBibHVyRXZlbnQuY3VycmVudFRhcmdldCA9IHRoaXM7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmNsb3NlKCBibHVyRXZlbnQsIHRydWUgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIHBhcmVudC5hdHRyKCAidGl0bGUiICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQudW5pcXVlSWQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQucGFyZW50c1sgdGhpcy5pZCBdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IHRoaXMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHBhcmVudC5hdHRyKCAidGl0bGUiICkNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuYXR0ciggInRpdGxlIiwgIiIgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fcmVnaXN0ZXJDbG9zZUhhbmRsZXJzKCBldmVudCwgdGFyZ2V0ICk7DQogICAgICAgICAgICB0aGlzLl91cGRhdGVDb250ZW50KCB0YXJnZXQsIGV2ZW50ICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3VwZGF0ZUNvbnRlbnQ6IGZ1bmN0aW9uKCB0YXJnZXQsIGV2ZW50ICkgew0KICAgICAgICAgICAgdmFyIGNvbnRlbnQsDQogICAgICAgICAgICAgICAgY29udGVudE9wdGlvbiA9IHRoaXMub3B0aW9ucy5jb250ZW50LA0KICAgICAgICAgICAgICAgIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIGV2ZW50VHlwZSA9IGV2ZW50ID8gZXZlbnQudHlwZSA6IG51bGw7DQoNCiAgICAgICAgICAgIGlmICggdHlwZW9mIGNvbnRlbnRPcHRpb24gPT09ICJzdHJpbmciIHx8IGNvbnRlbnRPcHRpb24ubm9kZVR5cGUgfHwNCiAgICAgICAgICAgICAgICBjb250ZW50T3B0aW9uLmpxdWVyeSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fb3BlbiggZXZlbnQsIHRhcmdldCwgY29udGVudE9wdGlvbiApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBjb250ZW50ID0gY29udGVudE9wdGlvbi5jYWxsKCB0YXJnZXRbIDAgXSwgZnVuY3Rpb24oIHJlc3BvbnNlICkgew0KDQogICAgICAgICAgICAgICAgLy8gSUUgbWF5IGluc3RhbnRseSBzZXJ2ZSBhIGNhY2hlZCByZXNwb25zZSBmb3IgYWpheCByZXF1ZXN0cw0KICAgICAgICAgICAgICAgIC8vIGRlbGF5IHRoaXMgY2FsbCB0byBfb3BlbiBzbyB0aGUgb3RoZXIgY2FsbCB0byBfb3BlbiBydW5zIGZpcnN0DQogICAgICAgICAgICAgICAgdGhhdC5fZGVsYXkoIGZ1bmN0aW9uKCkgew0KDQogICAgICAgICAgICAgICAgICAgIC8vIElnbm9yZSBhc3luYyByZXNwb25zZSBpZiB0b29sdGlwIHdhcyBjbG9zZWQgYWxyZWFkeQ0KICAgICAgICAgICAgICAgICAgICBpZiAoICF0YXJnZXQuZGF0YSggInVpLXRvb2x0aXAtb3BlbiIgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIEpRdWVyeSBjcmVhdGVzIGEgc3BlY2lhbCBldmVudCBmb3IgZm9jdXNpbiB3aGVuIGl0IGRvZXNuJ3QNCiAgICAgICAgICAgICAgICAgICAgLy8gZXhpc3QgbmF0aXZlbHkuIFRvIGltcHJvdmUgcGVyZm9ybWFuY2UsIHRoZSBuYXRpdmUgZXZlbnQNCiAgICAgICAgICAgICAgICAgICAgLy8gb2JqZWN0IGlzIHJldXNlZCBhbmQgdGhlIHR5cGUgaXMgY2hhbmdlZC4gVGhlcmVmb3JlLCB3ZSBjYW4ndA0KICAgICAgICAgICAgICAgICAgICAvLyByZWx5IG9uIHRoZSB0eXBlIGJlaW5nIGNvcnJlY3QgYWZ0ZXIgdGhlIGV2ZW50IGZpbmlzaGVkDQogICAgICAgICAgICAgICAgICAgIC8vIGJ1YmJsaW5nLCBzbyB3ZSBzZXQgaXQgYmFjayB0byB0aGUgcHJldmlvdXMgdmFsdWUuICgjODc0MCkNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnR5cGUgPSBldmVudFR5cGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb3BlbiggZXZlbnQsIHRhcmdldCwgcmVzcG9uc2UgKTsNCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9ICk7DQogICAgICAgICAgICBpZiAoIGNvbnRlbnQgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5fb3BlbiggZXZlbnQsIHRhcmdldCwgY29udGVudCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9vcGVuOiBmdW5jdGlvbiggZXZlbnQsIHRhcmdldCwgY29udGVudCApIHsNCiAgICAgICAgICAgIHZhciB0b29sdGlwRGF0YSwgdG9vbHRpcCwgZGVsYXllZFNob3csIGExMXlDb250ZW50LA0KICAgICAgICAgICAgICAgIHBvc2l0aW9uT3B0aW9uID0gJC5leHRlbmQoIHt9LCB0aGlzLm9wdGlvbnMucG9zaXRpb24gKTsNCg0KICAgICAgICAgICAgaWYgKCAhY29udGVudCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIENvbnRlbnQgY2FuIGJlIHVwZGF0ZWQgbXVsdGlwbGUgdGltZXMuIElmIHRoZSB0b29sdGlwIGFscmVhZHkNCiAgICAgICAgICAgIC8vIGV4aXN0cywgdGhlbiBqdXN0IHVwZGF0ZSB0aGUgY29udGVudCBhbmQgYmFpbC4NCiAgICAgICAgICAgIHRvb2x0aXBEYXRhID0gdGhpcy5fZmluZCggdGFyZ2V0ICk7DQogICAgICAgICAgICBpZiAoIHRvb2x0aXBEYXRhICkgew0KICAgICAgICAgICAgICAgIHRvb2x0aXBEYXRhLnRvb2x0aXAuZmluZCggIi51aS10b29sdGlwLWNvbnRlbnQiICkuaHRtbCggY29udGVudCApOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gSWYgd2UgaGF2ZSBhIHRpdGxlLCBjbGVhciBpdCB0byBwcmV2ZW50IHRoZSBuYXRpdmUgdG9vbHRpcA0KICAgICAgICAgICAgLy8gd2UgaGF2ZSB0byBjaGVjayBmaXJzdCB0byBhdm9pZCBkZWZpbmluZyBhIHRpdGxlIGlmIG5vbmUgZXhpc3RzDQogICAgICAgICAgICAvLyAod2UgZG9uJ3Qgd2FudCB0byBjYXVzZSBhbiBlbGVtZW50IHRvIHN0YXJ0IG1hdGNoaW5nIFt0aXRsZV0pDQogICAgICAgICAgICAvLw0KICAgICAgICAgICAgLy8gV2UgdXNlIHJlbW92ZUF0dHIgb25seSBmb3Iga2V5IGV2ZW50cywgdG8gYWxsb3cgSUUgdG8gZXhwb3J0IHRoZSBjb3JyZWN0DQogICAgICAgICAgICAvLyBhY2Nlc3NpYmxlIGF0dHJpYnV0ZXMuIEZvciBtb3VzZSBldmVudHMsIHNldCB0byBlbXB0eSBzdHJpbmcgdG8gYXZvaWQNCiAgICAgICAgICAgIC8vIG5hdGl2ZSB0b29sdGlwIHNob3dpbmcgdXAgKGhhcHBlbnMgb25seSB3aGVuIHJlbW92aW5nIGluc2lkZSBtb3VzZW92ZXIpLg0KICAgICAgICAgICAgaWYgKCB0YXJnZXQuaXMoICJbdGl0bGVdIiApICkgew0KICAgICAgICAgICAgICAgIGlmICggZXZlbnQgJiYgZXZlbnQudHlwZSA9PT0gIm1vdXNlb3ZlciIgKSB7DQogICAgICAgICAgICAgICAgICAgIHRhcmdldC5hdHRyKCAidGl0bGUiLCAiIiApOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRhcmdldC5yZW1vdmVBdHRyKCAidGl0bGUiICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0b29sdGlwRGF0YSA9IHRoaXMuX3Rvb2x0aXAoIHRhcmdldCApOw0KICAgICAgICAgICAgdG9vbHRpcCA9IHRvb2x0aXBEYXRhLnRvb2x0aXA7DQogICAgICAgICAgICB0aGlzLl9hZGREZXNjcmliZWRCeSggdGFyZ2V0LCB0b29sdGlwLmF0dHIoICJpZCIgKSApOw0KICAgICAgICAgICAgdG9vbHRpcC5maW5kKCAiLnVpLXRvb2x0aXAtY29udGVudCIgKS5odG1sKCBjb250ZW50ICk7DQoNCiAgICAgICAgICAgIC8vIFN1cHBvcnQ6IFZvaWNlb3ZlciBvbiBPUyBYLCBKQVdTIG9uIElFIDw9IDkNCiAgICAgICAgICAgIC8vIEpBV1MgYW5ub3VuY2VzIGRlbGV0aW9ucyBldmVuIHdoZW4gYXJpYS1yZWxldmFudD0iYWRkaXRpb25zIg0KICAgICAgICAgICAgLy8gVm9pY2VvdmVyIHdpbGwgc29tZXRpbWVzIHJlLXJlYWQgdGhlIGVudGlyZSBsb2cgcmVnaW9uJ3MgY29udGVudHMgZnJvbSB0aGUgYmVnaW5uaW5nDQogICAgICAgICAgICB0aGlzLmxpdmVSZWdpb24uY2hpbGRyZW4oKS5oaWRlKCk7DQogICAgICAgICAgICBhMTF5Q29udGVudCA9ICQoICI8ZGl2PiIgKS5odG1sKCB0b29sdGlwLmZpbmQoICIudWktdG9vbHRpcC1jb250ZW50IiApLmh0bWwoKSApOw0KICAgICAgICAgICAgYTExeUNvbnRlbnQucmVtb3ZlQXR0ciggIm5hbWUiICkuZmluZCggIltuYW1lXSIgKS5yZW1vdmVBdHRyKCAibmFtZSIgKTsNCiAgICAgICAgICAgIGExMXlDb250ZW50LnJlbW92ZUF0dHIoICJpZCIgKS5maW5kKCAiW2lkXSIgKS5yZW1vdmVBdHRyKCAiaWQiICk7DQogICAgICAgICAgICBhMTF5Q29udGVudC5hcHBlbmRUbyggdGhpcy5saXZlUmVnaW9uICk7DQoNCiAgICAgICAgICAgIGZ1bmN0aW9uIHBvc2l0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgICAgICBwb3NpdGlvbk9wdGlvbi5vZiA9IGV2ZW50Ow0KICAgICAgICAgICAgICAgIGlmICggdG9vbHRpcC5pcyggIjpoaWRkZW4iICkgKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdG9vbHRpcC5wb3NpdGlvbiggcG9zaXRpb25PcHRpb24gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLnRyYWNrICYmIGV2ZW50ICYmIC9ebW91c2UvLnRlc3QoIGV2ZW50LnR5cGUgKSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9vbiggdGhpcy5kb2N1bWVudCwgew0KICAgICAgICAgICAgICAgICAgICBtb3VzZW1vdmU6IHBvc2l0aW9uDQogICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgLy8gdHJpZ2dlciBvbmNlIHRvIG92ZXJyaWRlIGVsZW1lbnQtcmVsYXRpdmUgcG9zaXRpb25pbmcNCiAgICAgICAgICAgICAgICBwb3NpdGlvbiggZXZlbnQgKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdG9vbHRpcC5wb3NpdGlvbiggJC5leHRlbmQoIHsNCiAgICAgICAgICAgICAgICAgICAgb2Y6IHRhcmdldA0KICAgICAgICAgICAgICAgIH0sIHRoaXMub3B0aW9ucy5wb3NpdGlvbiApICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRvb2x0aXAuaGlkZSgpOw0KDQogICAgICAgICAgICB0aGlzLl9zaG93KCB0b29sdGlwLCB0aGlzLm9wdGlvbnMuc2hvdyApOw0KDQogICAgICAgICAgICAvLyBIYW5kbGUgdHJhY2tpbmcgdG9vbHRpcHMgdGhhdCBhcmUgc2hvd24gd2l0aCBhIGRlbGF5ICgjODY0NCkuIEFzIHNvb24NCiAgICAgICAgICAgIC8vIGFzIHRoZSB0b29sdGlwIGlzIHZpc2libGUsIHBvc2l0aW9uIHRoZSB0b29sdGlwIHVzaW5nIHRoZSBtb3N0IHJlY2VudA0KICAgICAgICAgICAgLy8gZXZlbnQuDQogICAgICAgICAgICAvLyBBZGRzIHRoZSBjaGVjayB0byBhZGQgdGhlIHRpbWVycyBvbmx5IHdoZW4gYm90aCBkZWxheSBhbmQgdHJhY2sgb3B0aW9ucyBhcmUgc2V0ICgjMTQ2ODIpDQogICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy50cmFjayAmJiB0aGlzLm9wdGlvbnMuc2hvdyAmJiB0aGlzLm9wdGlvbnMuc2hvdy5kZWxheSApIHsNCiAgICAgICAgICAgICAgICBkZWxheWVkU2hvdyA9IHRoaXMuZGVsYXllZFNob3cgPSBzZXRJbnRlcnZhbCggZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggdG9vbHRpcC5pcyggIjp2aXNpYmxlIiApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24oIHBvc2l0aW9uT3B0aW9uLm9mICk7DQogICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKCBkZWxheWVkU2hvdyApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwgJC5meC5pbnRlcnZhbCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAib3BlbiIsIGV2ZW50LCB7IHRvb2x0aXA6IHRvb2x0aXAgfSApOw0KICAgICAgICB9LA0KDQogICAgICAgIF9yZWdpc3RlckNsb3NlSGFuZGxlcnM6IGZ1bmN0aW9uKCBldmVudCwgdGFyZ2V0ICkgew0KICAgICAgICAgICAgdmFyIGV2ZW50cyA9IHsNCiAgICAgICAgICAgICAgICBrZXl1cDogZnVuY3Rpb24oIGV2ZW50ICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIGV2ZW50LmtleUNvZGUgPT09ICQudWkua2V5Q29kZS5FU0NBUEUgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFrZUV2ZW50ID0gJC5FdmVudCggZXZlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZha2VFdmVudC5jdXJyZW50VGFyZ2V0ID0gdGFyZ2V0WyAwIF07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCBmYWtlRXZlbnQsIHRydWUgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIC8vIE9ubHkgYmluZCByZW1vdmUgaGFuZGxlciBmb3IgZGVsZWdhdGVkIHRhcmdldHMuIE5vbi1kZWxlZ2F0ZWQNCiAgICAgICAgICAgIC8vIHRvb2x0aXBzIHdpbGwgaGFuZGxlIHRoaXMgaW4gZGVzdHJveS4NCiAgICAgICAgICAgIGlmICggdGFyZ2V0WyAwIF0gIT09IHRoaXMuZWxlbWVudFsgMCBdICkgew0KICAgICAgICAgICAgICAgIGV2ZW50cy5yZW1vdmUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlVG9vbHRpcCggdGhpcy5fZmluZCggdGFyZ2V0ICkudG9vbHRpcCApOw0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggIWV2ZW50IHx8IGV2ZW50LnR5cGUgPT09ICJtb3VzZW92ZXIiICkgew0KICAgICAgICAgICAgICAgIGV2ZW50cy5tb3VzZWxlYXZlID0gImNsb3NlIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICggIWV2ZW50IHx8IGV2ZW50LnR5cGUgPT09ICJmb2N1c2luIiApIHsNCiAgICAgICAgICAgICAgICBldmVudHMuZm9jdXNvdXQgPSAiY2xvc2UiOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5fb24oIHRydWUsIHRhcmdldCwgZXZlbnRzICk7DQogICAgICAgIH0sDQoNCiAgICAgICAgY2xvc2U6IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciB0b29sdGlwLA0KICAgICAgICAgICAgICAgIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIHRhcmdldCA9ICQoIGV2ZW50ID8gZXZlbnQuY3VycmVudFRhcmdldCA6IHRoaXMuZWxlbWVudCApLA0KICAgICAgICAgICAgICAgIHRvb2x0aXBEYXRhID0gdGhpcy5fZmluZCggdGFyZ2V0ICk7DQoNCiAgICAgICAgICAgIC8vIFRoZSB0b29sdGlwIG1heSBhbHJlYWR5IGJlIGNsb3NlZA0KICAgICAgICAgICAgaWYgKCAhdG9vbHRpcERhdGEgKSB7DQoNCiAgICAgICAgICAgICAgICAvLyBXZSBzZXQgdWktdG9vbHRpcC1vcGVuIGltbWVkaWF0ZWx5IHVwb24gb3BlbiAoaW4gb3BlbigpKSwgYnV0IG9ubHkgc2V0IHRoZQ0KICAgICAgICAgICAgICAgIC8vIGFkZGl0aW9uYWwgZGF0YSBvbmNlIHRoZXJlJ3MgYWN0dWFsbHkgY29udGVudCB0byBzaG93IChpbiBfb3BlbigpKS4gU28gZXZlbiBpZiB0aGUNCiAgICAgICAgICAgICAgICAvLyB0b29sdGlwIGRvZXNuJ3QgaGF2ZSBmdWxsIGRhdGEsIHdlIGFsd2F5cyByZW1vdmUgdWktdG9vbHRpcC1vcGVuIGluIGNhc2Ugd2UncmUgaW4NCiAgICAgICAgICAgICAgICAvLyB0aGUgcGVyaW9kIGJldHdlZW4gb3BlbigpIGFuZCBfb3BlbigpLg0KICAgICAgICAgICAgICAgIHRhcmdldC5yZW1vdmVEYXRhKCAidWktdG9vbHRpcC1vcGVuIiApOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdG9vbHRpcCA9IHRvb2x0aXBEYXRhLnRvb2x0aXA7DQoNCiAgICAgICAgICAgIC8vIERpc2FibGluZyBjbG9zZXMgdGhlIHRvb2x0aXAsIHNvIHdlIG5lZWQgdG8gdHJhY2sgd2hlbiB3ZSdyZSBjbG9zaW5nDQogICAgICAgICAgICAvLyB0byBhdm9pZCBhbiBpbmZpbml0ZSBsb29wIGluIGNhc2UgdGhlIHRvb2x0aXAgYmVjb21lcyBkaXNhYmxlZCBvbiBjbG9zZQ0KICAgICAgICAgICAgaWYgKCB0b29sdGlwRGF0YS5jbG9zaW5nICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIGludGVydmFsIGZvciBkZWxheWVkIHRyYWNraW5nIHRvb2x0aXBzDQogICAgICAgICAgICBjbGVhckludGVydmFsKCB0aGlzLmRlbGF5ZWRTaG93ICk7DQoNCiAgICAgICAgICAgIC8vIE9ubHkgc2V0IHRpdGxlIGlmIHdlIGhhZCBvbmUgYmVmb3JlIChzZWUgY29tbWVudCBpbiBfb3BlbigpKQ0KICAgICAgICAgICAgLy8gSWYgdGhlIHRpdGxlIGF0dHJpYnV0ZSBoYXMgY2hhbmdlZCBzaW5jZSBvcGVuKCksIGRvbid0IHJlc3RvcmUNCiAgICAgICAgICAgIGlmICggdGFyZ2V0LmRhdGEoICJ1aS10b29sdGlwLXRpdGxlIiApICYmICF0YXJnZXQuYXR0ciggInRpdGxlIiApICkgew0KICAgICAgICAgICAgICAgIHRhcmdldC5hdHRyKCAidGl0bGUiLCB0YXJnZXQuZGF0YSggInVpLXRvb2x0aXAtdGl0bGUiICkgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fcmVtb3ZlRGVzY3JpYmVkQnkoIHRhcmdldCApOw0KDQogICAgICAgICAgICB0b29sdGlwRGF0YS5oaWRpbmcgPSB0cnVlOw0KICAgICAgICAgICAgdG9vbHRpcC5zdG9wKCB0cnVlICk7DQogICAgICAgICAgICB0aGlzLl9oaWRlKCB0b29sdGlwLCB0aGlzLm9wdGlvbnMuaGlkZSwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdGhhdC5fcmVtb3ZlVG9vbHRpcCggJCggdGhpcyApICk7DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIHRhcmdldC5yZW1vdmVEYXRhKCAidWktdG9vbHRpcC1vcGVuIiApOw0KICAgICAgICAgICAgdGhpcy5fb2ZmKCB0YXJnZXQsICJtb3VzZWxlYXZlIGZvY3Vzb3V0IGtleXVwIiApOw0KDQogICAgICAgICAgICAvLyBSZW1vdmUgJ3JlbW92ZScgYmluZGluZyBvbmx5IG9uIGRlbGVnYXRlZCB0YXJnZXRzDQogICAgICAgICAgICBpZiAoIHRhcmdldFsgMCBdICE9PSB0aGlzLmVsZW1lbnRbIDAgXSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9vZmYoIHRhcmdldCwgInJlbW92ZSIgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX29mZiggdGhpcy5kb2N1bWVudCwgIm1vdXNlbW92ZSIgKTsNCg0KICAgICAgICAgICAgaWYgKCBldmVudCAmJiBldmVudC50eXBlID09PSAibW91c2VsZWF2ZSIgKSB7DQogICAgICAgICAgICAgICAgJC5lYWNoKCB0aGlzLnBhcmVudHMsIGZ1bmN0aW9uKCBpZCwgcGFyZW50ICkgew0KICAgICAgICAgICAgICAgICAgICAkKCBwYXJlbnQuZWxlbWVudCApLmF0dHIoICJ0aXRsZSIsIHBhcmVudC50aXRsZSApOw0KICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhhdC5wYXJlbnRzWyBpZCBdOw0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdG9vbHRpcERhdGEuY2xvc2luZyA9IHRydWU7DQogICAgICAgICAgICB0aGlzLl90cmlnZ2VyKCAiY2xvc2UiLCBldmVudCwgeyB0b29sdGlwOiB0b29sdGlwIH0gKTsNCiAgICAgICAgICAgIGlmICggIXRvb2x0aXBEYXRhLmhpZGluZyApIHsNCiAgICAgICAgICAgICAgICB0b29sdGlwRGF0YS5jbG9zaW5nID0gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX3Rvb2x0aXA6IGZ1bmN0aW9uKCBlbGVtZW50ICkgew0KICAgICAgICAgICAgdmFyIHRvb2x0aXAgPSAkKCAiPGRpdj4iICkuYXR0ciggInJvbGUiLCAidG9vbHRpcCIgKSwNCiAgICAgICAgICAgICAgICBjb250ZW50ID0gJCggIjxkaXY+IiApLmFwcGVuZFRvKCB0b29sdGlwICksDQogICAgICAgICAgICAgICAgaWQgPSB0b29sdGlwLnVuaXF1ZUlkKCkuYXR0ciggImlkIiApOw0KDQogICAgICAgICAgICB0aGlzLl9hZGRDbGFzcyggY29udGVudCwgInVpLXRvb2x0aXAtY29udGVudCIgKTsNCiAgICAgICAgICAgIHRoaXMuX2FkZENsYXNzKCB0b29sdGlwLCAidWktdG9vbHRpcCIsICJ1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQiICk7DQoNCiAgICAgICAgICAgIHRvb2x0aXAuYXBwZW5kVG8oIHRoaXMuX2FwcGVuZFRvKCBlbGVtZW50ICkgKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9vbHRpcHNbIGlkIF0gPSB7DQogICAgICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudCwNCiAgICAgICAgICAgICAgICB0b29sdGlwOiB0b29sdGlwDQogICAgICAgICAgICB9Ow0KICAgICAgICB9LA0KDQogICAgICAgIF9maW5kOiBmdW5jdGlvbiggdGFyZ2V0ICkgew0KICAgICAgICAgICAgdmFyIGlkID0gdGFyZ2V0LmRhdGEoICJ1aS10b29sdGlwLWlkIiApOw0KICAgICAgICAgICAgcmV0dXJuIGlkID8gdGhpcy50b29sdGlwc1sgaWQgXSA6IG51bGw7DQogICAgICAgIH0sDQoNCiAgICAgICAgX3JlbW92ZVRvb2x0aXA6IGZ1bmN0aW9uKCB0b29sdGlwICkgew0KICAgICAgICAgICAgdG9vbHRpcC5yZW1vdmUoKTsNCiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnRvb2x0aXBzWyB0b29sdGlwLmF0dHIoICJpZCIgKSBdOw0KICAgICAgICB9LA0KDQogICAgICAgIF9hcHBlbmRUbzogZnVuY3Rpb24oIHRhcmdldCApIHsNCiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGFyZ2V0LmNsb3Nlc3QoICIudWktZnJvbnQsIGRpYWxvZyIgKTsNCg0KICAgICAgICAgICAgaWYgKCAhZWxlbWVudC5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgZWxlbWVudCA9IHRoaXMuZG9jdW1lbnRbIDAgXS5ib2R5Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gZWxlbWVudDsNCiAgICAgICAgfSwNCg0KICAgICAgICBfZGVzdHJveTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7DQoNCiAgICAgICAgICAgIC8vIENsb3NlIG9wZW4gdG9vbHRpcHMNCiAgICAgICAgICAgICQuZWFjaCggdGhpcy50b29sdGlwcywgZnVuY3Rpb24oIGlkLCB0b29sdGlwRGF0YSApIHsNCg0KICAgICAgICAgICAgICAgIC8vIERlbGVnYXRlIHRvIGNsb3NlIG1ldGhvZCB0byBoYW5kbGUgY29tbW9uIGNsZWFudXANCiAgICAgICAgICAgICAgICB2YXIgZXZlbnQgPSAkLkV2ZW50KCAiYmx1ciIgKSwNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IHRvb2x0aXBEYXRhLmVsZW1lbnQ7DQogICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0ID0gZXZlbnQuY3VycmVudFRhcmdldCA9IGVsZW1lbnRbIDAgXTsNCiAgICAgICAgICAgICAgICB0aGF0LmNsb3NlKCBldmVudCwgdHJ1ZSApOw0KDQogICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGltbWVkaWF0ZWx5OyBkZXN0cm95aW5nIGFuIG9wZW4gdG9vbHRpcCBkb2Vzbid0IHVzZSB0aGUNCiAgICAgICAgICAgICAgICAvLyBoaWRlIGFuaW1hdGlvbg0KICAgICAgICAgICAgICAgICQoICIjIiArIGlkICkucmVtb3ZlKCk7DQoNCiAgICAgICAgICAgICAgICAvLyBSZXN0b3JlIHRoZSB0aXRsZQ0KICAgICAgICAgICAgICAgIGlmICggZWxlbWVudC5kYXRhKCAidWktdG9vbHRpcC10aXRsZSIgKSApIHsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgdGl0bGUgYXR0cmlidXRlIGhhcyBjaGFuZ2VkIHNpbmNlIG9wZW4oKSwgZG9uJ3QgcmVzdG9yZQ0KICAgICAgICAgICAgICAgICAgICBpZiAoICFlbGVtZW50LmF0dHIoICJ0aXRsZSIgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXR0ciggInRpdGxlIiwgZWxlbWVudC5kYXRhKCAidWktdG9vbHRpcC10aXRsZSIgKSApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlRGF0YSggInVpLXRvb2x0aXAtdGl0bGUiICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgdGhpcy5saXZlUmVnaW9uLnJlbW92ZSgpOw0KICAgICAgICB9DQogICAgfSApOw0KDQovLyBERVBSRUNBVEVEDQovLyBUT0RPOiBTd2l0Y2ggcmV0dXJuIGJhY2sgdG8gd2lkZ2V0IGRlY2xhcmF0aW9uIGF0IHRvcCBvZiBmaWxlIHdoZW4gdGhpcyBpcyByZW1vdmVkDQogICAgaWYgKCAkLnVpQmFja0NvbXBhdCAhPT0gZmFsc2UgKSB7DQoNCiAgICAgICAgLy8gQmFja2NvbXBhdCBmb3IgdG9vbHRpcENsYXNzIG9wdGlvbg0KICAgICAgICAkLndpZGdldCggInVpLnRvb2x0aXAiLCAkLnVpLnRvb2x0aXAsIHsNCiAgICAgICAgICAgIG9wdGlvbnM6IHsNCiAgICAgICAgICAgICAgICB0b29sdGlwQ2xhc3M6IG51bGwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBfdG9vbHRpcDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIHRvb2x0aXBEYXRhID0gdGhpcy5fc3VwZXJBcHBseSggYXJndW1lbnRzICk7DQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMudG9vbHRpcENsYXNzICkgew0KICAgICAgICAgICAgICAgICAgICB0b29sdGlwRGF0YS50b29sdGlwLmFkZENsYXNzKCB0aGlzLm9wdGlvbnMudG9vbHRpcENsYXNzICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiB0b29sdGlwRGF0YTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSApOw0KICAgIH0NCg0KICAgIHZhciB3aWRnZXRzVG9vbHRpcCA9ICQudWkudG9vbHRpcDsNCg0KDQoNCg0KfSkpOw=="
                    },
                    {
                        "id": "ui/erTabSlideOut.js",
                        "source": "LyoNCnRhYiBzbGlkZSBvdXQgaW50ZXJmYWNlLCBkb3VibGUtZHJhZ2dhYmxlIChkcmFnIHRoZSB3aG9sZSBlbGVtZW50IGFuZCBkcmFnIHRoZSBoYW5kbGUgcmVsYXRpdmUgdG8gdGhlIHdob2xlIGVsZW1lbnQpLCANCmNhcGFibGUgb2YgaG9sZGluZyBuIERPTSBlbGVtZW50cyBpbiBhIGxpbmUtbGF5b3V0IChob3Jpem9udGFsIHZlcnNpb24pIG9yIDItY29sdW1uLWdyaWQgKHZlcnRpY2FsIHZlcnNpb24pDQpmb3IgdXNhZ2UsIHlvdXIgcGFnZSBtdXN0IGNvbnRhaW4gdGhlIGZvbGxvd2luZyBET00gZWxlbWVudHM6DQogICAgJzxkaXYgaWQ9ImVyLXRhYi1zbGlkZS1vdXQiPicgKw0KICAgICAgICAnPGRpdiBpZD0iZXItdGFiLXNsaWRlLW91dC1oYW5kbGUiPjwvZGl2PicgKw0KICAgICAgICAnPGRpdiBpZD0iZXItdGFiLXNsaWRlLW91dC1ncmlkLWNvbnRhaW5lciI+PC9kaXY+JyArDQogICAgJzwvZGl2PicpOw0KDQpvcHRpb25zIA0KdGFiUG9zaXRpb25pbmc6IHRvcCwgYm90dG9tLCBsZWZ0LCByaWdodCAoZGVmYXVsdCkNCnBhbmVsVmlzaWJsZTogdHJ1ZSwgZmFsc2UgKGRlZmF1bHQpDQpwYW5lbFBvczoge3RvcDogeCwgbGVmdDogeX0gKGRlZmF1bHQ6IHg9MjAwLCB5PTIwMCkNCmhhbmRsZVBvczoge3RvcDogeCwgbGVmdDogeX0gKGRlZmF1bHQ6IHg9MCwgeT0wKQ0KDQptZXRob2RzDQp1cGRhdGVQYW5lbDogbmVlZHMgdG8gYmUgY2FsbGVkIGV2ZXJ5IHRpbWUgdGhlIGNvbnRlbnRzIG9mIHRoZSBwYW5lbCBoYXZlIGNoYW5nZWQNCmFkYXB0VG9XaW5kb3dTaXplOiBjYWxsIHdoZW4gbmV3IGl0ZW1zIGhhdmUgYmVlbiBhZGRlZCBvciBpdGVtcyBoYXZlIGJlZW4gdGFrZW4gYXdheQ0KcmVmcmVzaDogcmVmcmVzaCB2aWV3IHN0YXR1cyBvZiBwYW5lbA0KKi8NCg0KJC53aWRnZXQoInVpLmVyVGFiU2xpZGVPdXQiLCB7DQogICAgDQogICAgLy8gZGVmYXVsdCBvcHRpb25zDQogICAgb3B0aW9uczogew0KICAgICAgICB0YWJQb3NpdGlvbmluZzogInJpZ2h0IiwNCiAgICAgICAgcGFuZWxWaXNpYmxlOiBmYWxzZSwNCiAgICAgICAgcGFuZWxQb3M6IHt0b3A6IDIwMCwgbGVmdDogMjAwfSwNCiAgICAgICAgaGFuZGxlUG9zOiB7dG9wOiAwLCBsZWZ0OiAwfSwgLy8gcG9zaXRpb24gb2YgaGFuZGxlIHJlbGF0aXZlIHRvIHRoZSBwYW5lbA0KICAgICAgICBzYXZlQ29uZmlnOiBmdW5jdGlvbihvbGRDb25mKSB7fQ0KICAgIH0sDQoNCiAgICBfY3JlYXRlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgdGhpcy5pZ25vcmVOZXh0Q2xpY2sgPSBmYWxzZTsNCiAgICAgICAgdGhpcy5wYW5lbCA9ICQoIiNlci10YWItc2xpZGUtb3V0Iik7DQogICAgICAgIHRoaXMuaGFuZGxlID0gJCgiI2VyLXRhYi1zbGlkZS1vdXQtaGFuZGxlIik7DQogICAgICAgIHRoaXMuZ3JpZENvbnRhaW5lciA9ICQoJyNlci10YWItc2xpZGUtb3V0LWdyaWQtY29udGFpbmVyJyk7DQogICAgICAgIHRoaXMuZHJhZ0F4aXMgPSAneSc7DQogICAgICAgIGlmICh0aGlzLm9wdGlvbnMudGFiUG9zaXRpb25pbmcgPT09ICJ0b3AiIHx8IHRoaXMub3B0aW9ucy50YWJQb3NpdGlvbmluZyA9PT0gImJvdHRvbSIpIHsNCiAgICAgICAgICAgIHRoaXMuZ3JpZENvbnRhaW5lci5hZGRDbGFzcygnZXItdGFiLXNsaWRlLW91dC1ncmlkLWhvcml6b250YWwnKTsNCiAgICAgICAgICAgIHRoaXMuZHJhZ0F4aXMgPSAneCc7DQogICAgICAgICAgICB0aGlzLnBhbmVsLmNzcyh7J2xlZnQnIDogdGhpcy5vcHRpb25zLnBhbmVsUG9zLmxlZnQgKyAncHgnfSk7DQogICAgICAgICAgICB0aGlzLmhhbmRsZS5jc3MoeydsZWZ0JyA6IHRoaXMub3B0aW9ucy5oYW5kbGVQb3MubGVmdCArICdweCd9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMucGFuZWwuY3NzKHsndG9wJyA6IHRoaXMub3B0aW9ucy5wYW5lbFBvcy50b3AgKyAncHgnfSk7DQogICAgICAgICAgICB0aGlzLmhhbmRsZS5jc3Moeyd0b3AnIDogdGhpcy5vcHRpb25zLmhhbmRsZVBvcy50b3AgKyAncHgnfSk7DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5wYW5lbEhlaWdodCA9IDE7IC8vIHRoZSB0cnVlIGhlaWdodCBhbmQgd2lkdGggb2YgdGhlIHBhbmVsIHdpbGwgYmUgc2V0LCB3aGVuIHBhbmVsIGltYWdlcyBhcmUgbG9hZGVkDQogICAgICAgIHRoaXMucGFuZWxXaWR0aCA9IDE7DQoNCiAgICAgICAgLy8gZW5hYmxlIDItbGV2ZWwgZHJhZ2dpbmcgb2YgdGhlIHBhbmVsDQogICAgICAgIGxldCBwcmV2TW91c2VYID0gMDsNCiAgICAgICAgbGV0IHByZXZNb3VzZVkgPSAwOw0KICAgICAgICBsZXQgaGFuZGxlT2Zmc2V0WE9uTW91c2Vkb3duID0gMDsNCiAgICAgICAgbGV0IGhhbmRsZU9mZnNldFlPbk1vdXNlZG93biA9IDA7DQogICAgICAgIGxldCBtb3VzZVhJbkhhbmRsZU9uTW91c2Vkb3duID0gMDsNCiAgICAgICAgbGV0IG1vdXNlWUluSGFuZGxlT25Nb3VzZWRvd24gPSAwOw0KICAgICAgICBsZXQgaGF2ZUJlZW5EcmFnZ2luZ0hhbmRsZSA9IGZhbHNlOw0KICAgICAgICBsZXQgZXJUU08gPSB0aGlzOw0KICAgICAgICB0aGlzLmhhbmRsZS5tb3VzZWRvd24oZnVuY3Rpb24oZXZlbnQpew0KICAgICAgICAgICAgcHJldk1vdXNlWCA9IGV2ZW50LmNsaWVudFg7IC8vIG5lZWRlZCBmb3IgZHJhZ2dpbmcgaGFuZGxlIGhvcml6b250YWxseQ0KICAgICAgICAgICAgcHJldk1vdXNlWSA9IGV2ZW50LmNsaWVudFk7IC8vIG5lZWRlZCBmb3IgZHJhZ2dpbmcgaGFuZGxlIHZlcnRpY2FsbHkNCiAgICAgICAgICAgIGhhbmRsZU9mZnNldFhPbk1vdXNlZG93biA9IGVyVFNPLmhhbmRsZS5wb3NpdGlvbigpLmxlZnQ7DQogICAgICAgICAgICBoYW5kbGVPZmZzZXRZT25Nb3VzZWRvd24gPSBlclRTTy5oYW5kbGUucG9zaXRpb24oKS50b3A7DQogICAgICAgICAgICBtb3VzZVhJbkhhbmRsZU9uTW91c2Vkb3duID0gZXZlbnQuY2xpZW50WCAtIGVyVFNPLmhhbmRsZS5wb3NpdGlvbigpLmxlZnQgLSBlclRTTy5wYW5lbC5wb3NpdGlvbigpLmxlZnQ7DQogICAgICAgICAgICBtb3VzZVlJbkhhbmRsZU9uTW91c2Vkb3duID0gZXZlbnQuY2xpZW50WSAtIGVyVFNPLmhhbmRsZS5wb3NpdGlvbigpLnRvcCAtIGVyVFNPLnBhbmVsLnBvc2l0aW9uKCkudG9wOw0KICAgICAgICAgICAgaGF2ZUJlZW5EcmFnZ2luZ0hhbmRsZSA9IGZhbHNlOw0KICAgICAgICAgICAgZXJUU08uaWdub3JlTmV4dENsaWNrID0gZmFsc2U7IC8vIGNsaWNrLWV2ZW50cyBzaGFsbCBiZSBpZ25vcmVkLCBpZiBmaXJlZCBkaXJlY3RseSBhZnRlciBhIGRyYWctZXZlbnQ7IG9uIG1vdXNlZG93biwgd2UgYXNzdW1lIHRoaXMgaXMgZ29pbmcgdG8gYmUgYSBjbGljazsgaWdub3JlbmV4dENsaWNrIGlzIHNldCB0byB0cnVlIGluIHRoZSBkcmFnLWV2ZW50DQogICAgICAgIH0pOw0KICAgICAgICAgICAgIA0KICAgICAgICB0aGlzLnBhbmVsLmRyYWdnYWJsZSh7DQogICAgICAgICAgICBheGlzOiB0aGlzLmRyYWdBeGlzLA0KICAgICAgICAgICAgc2Nyb2xsOiBmYWxzZSwNCiAgICAgICAgICAgIGRyYWc6IGZ1bmN0aW9uKGV2dCwgdWkpIHsNCiAgICAgICAgICAgICAgICBlclRTTy5pZ25vcmVOZXh0Q2xpY2sgPSB0cnVlOw0KICAgICAgICAgICAgICAgIGlmIChlclRTTy5kcmFnQXhpcyA9PT0gJ3gnKSB7DQogICAgICAgICAgICAgICAgICAgIGxldCBoYW5kbGVMZWZ0ID0gZXZ0LmNsaWVudFggLSBlclRTTy5wYW5lbC5wb3NpdGlvbigpLmxlZnQgLSBtb3VzZVhJbkhhbmRsZU9uTW91c2Vkb3duOw0KICAgICAgICAgICAgICAgICAgICBpZiAodWkucG9zaXRpb24ubGVmdCA8IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnBvc2l0aW9uLmxlZnQgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGF2ZUJlZW5EcmFnZ2luZ0hhbmRsZSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFuZGxlTGVmdCA8IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVMZWZ0ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldnQuY2xpZW50WCA+IHByZXZNb3VzZVgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZ0LmNsaWVudFggPj0gbW91c2VYSW5IYW5kbGVPbk1vdXNlZG93bikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5oYW5kbGUuY3NzKCdsZWZ0JywgaGFuZGxlTGVmdCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5oYW5kbGUuY3NzKCdsZWZ0JywgaGFuZGxlTGVmdCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgbGVmdE1heCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCAtIGVyVFNPLnBhbmVsV2lkdGg7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodWkucG9zaXRpb24ubGVmdCA+IGxlZnRNYXgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5wb3NpdGlvbi5sZWZ0ID0gbGVmdE1heDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXZlQmVlbkRyYWdnaW5nSGFuZGxlID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaGFuZGxlTGVmdE1heCA9IGVyVFNPLnBhbmVsV2lkdGggLSBlclRTTy5oYW5kbGUub3V0ZXJXaWR0aCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYW5kbGVMZWZ0ID4gaGFuZGxlTGVmdE1heCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVMZWZ0ID0gaGFuZGxlTGVmdE1heDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2dC5jbGllbnRYIDwgcHJldk1vdXNlWCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbW91c2VYTW9zdFJpZ2h0UG9zaXRpb24gPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggLSAoZXJUU08uaGFuZGxlLm91dGVyV2lkdGgoKSAtIG1vdXNlWEluSGFuZGxlT25Nb3VzZWRvd24pOyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2dC5jbGllbnRYIDw9IG1vdXNlWE1vc3RSaWdodFBvc2l0aW9uKSB7IC8vIGF2b2lkIG1vdmluZyBoYW5kbGUgd2hpbGUgbW91c2UgaXMgb3V0c2lkZSB0aGUgcGFnZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08uaGFuZGxlLmNzcygnbGVmdCcsIGhhbmRsZUxlZnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08uaGFuZGxlLmNzcygnbGVmdCcsIGhhbmRsZUxlZnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhdmVCZWVuRHJhZ2dpbmdIYW5kbGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGhhbmRsZSB0byB0aGUgcG9zaXRpb24gaXQgaGFkIGF0IG1vdXNkb3duIChvdGhlcndpc2UgdGhlIGxhc3Qgc3RlcCBpbiBkcmFnZ2luZyBpdCBiYWNrIHdvdWxkIGdldCBsb3N0KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5oYW5kbGUuY3NzKCdsZWZ0JywgaGFuZGxlT2Zmc2V0WE9uTW91c2Vkb3duKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGF2ZUJlZW5EcmFnZ2luZ0hhbmRsZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBwcmV2TW91c2VYID0gZXZ0LmNsaWVudFg7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgbGV0IGhhbmRsZVRvcCA9IGV2dC5jbGllbnRZIC0gZXJUU08ucGFuZWwucG9zaXRpb24oKS50b3AgLSBtb3VzZVlJbkhhbmRsZU9uTW91c2Vkb3duOw0KICAgICAgICAgICAgICAgICAgICBpZiAodWkucG9zaXRpb24udG9wIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdWkucG9zaXRpb24udG9wID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhhdmVCZWVuRHJhZ2dpbmdIYW5kbGUgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhbmRsZVRvcCA8IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVUb3AgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2dC5jbGllbnRZID4gcHJldk1vdXNlWSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldnQuY2xpZW50WSA+PSBtb3VzZVlJbkhhbmRsZU9uTW91c2Vkb3duKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLmhhbmRsZS5jc3MoJ3RvcCcsIGhhbmRsZVRvcCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5oYW5kbGUuY3NzKCd0b3AnLCBoYW5kbGVUb3ApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRvcE1heCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIGVyVFNPLnBhbmVsSGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVpLnBvc2l0aW9uLnRvcCA+IHRvcE1heCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnBvc2l0aW9uLnRvcCA9IHRvcE1heDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXZlQmVlbkRyYWdnaW5nSGFuZGxlID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaGFuZGxlVG9wTWF4ID0gZXJUU08ucGFuZWxIZWlnaHQgLSBlclRTTy5oYW5kbGUub3V0ZXJIZWlnaHQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFuZGxlVG9wID4gaGFuZGxlVG9wTWF4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZVRvcCA9IGhhbmRsZVRvcE1heDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2dC5jbGllbnRZIDwgcHJldk1vdXNlWSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbW91c2VZQm90dG9tbW9zdFBvc2l0aW9uID0gd2luZG93LmlubmVySGVpZ2h0IC0gKGVyVFNPLmhhbmRsZS5vdXRlckhlaWdodCgpIC0gbW91c2VZSW5IYW5kbGVPbk1vdXNlZG93bik7IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZ0LmNsaWVudFkgPD0gbW91c2VZQm90dG9tbW9zdFBvc2l0aW9uKSB7IC8vIGF2b2lkIG1vdmluZyBoYW5kbGUgd2hpbGUgbW91c2UgaXMgb3V0c2lkZSB0aGUgcGFnZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08uaGFuZGxlLmNzcygndG9wJywgaGFuZGxlVG9wKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5oYW5kbGUuY3NzKCd0b3AnLCBoYW5kbGVUb3ApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhdmVCZWVuRHJhZ2dpbmdIYW5kbGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGhhbmRsZSB0byB0aGUgcG9zaXRpb24gaXQgaGFkIGF0IG1vdXNkb3duIChvdGhlcndpc2UgdGhlIGxhc3Qgc3RlcCBpbiBkcmFnZ2luZyBpdCBiYWNrIHdvdWxkIGdldCBsb3N0KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5oYW5kbGUuY3NzKCd0b3AnLCBoYW5kbGVPZmZzZXRZT25Nb3VzZWRvd24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXZlQmVlbkRyYWdnaW5nSGFuZGxlID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHByZXZNb3VzZVkgPSBldnQuY2xpZW50WTsgDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uKGV2ZW50LCB1aSkgew0KICAgICAgICAgICAgICAgIGVyVFNPLnNhdmVDb25maWd1cmF0aW9uKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgIC8vIGFkZCBjYWxsYmFjayBmb3IgcGFuZWwvaGFuZGxlIHBvc2l0aW9uaW5nDQogICAgICAgIC8vIChvdGhlcndpc2UgdGhleSBtaWdodCBiZSBwb3NpdGlvbmVkIGluY29ycmVjdGx5IGlmIGltYWdlcyBpbiBwYW5lbCBhcmUgbm90IGZ1bGx5IGxvYWRlZCB5ZXQpDQogICAgICAgIHRoaXMucGFuZWwuaW1hZ2VzTG9hZGVkKGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgZXJUU08ucGFuZWxIZWlnaHQgPSBlclRTTy5wYW5lbC5vdXRlckhlaWdodCgpOw0KICAgICAgICAgICAgZXJUU08ucGFuZWxXaWR0aCA9IGVyVFNPLnBhbmVsLm91dGVyV2lkdGgoKTsNCiAgICAgICAgICAgIGlmIChlclRTTy5vcHRpb25zLnRhYlBvc2l0aW9uaW5nID09PSAndG9wJykgew0KICAgICAgICAgICAgICAgIGVyVFNPLnBhbmVsLmNzcyh7J3RvcCcgOiAnLScgKyBlclRTTy5wYW5lbEhlaWdodCArICdweCd9KTsNCiAgICAgICAgICAgICAgICBlclRTTy5oYW5kbGUuY3NzKHsndG9wJyA6IChlclRTTy5wYW5lbEhlaWdodCAtIDEpICsgJ3B4J30pOw0KICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMudGFiUG9zaXRpb25pbmcgPT09ICdsZWZ0Jykgew0KICAgICAgICAgICAgICAgIGVyVFNPLnBhbmVsLmNzcyh7J2xlZnQnIDogJy0nICsgZXJUU08ucGFuZWxXaWR0aCArICdweCd9KTsNCiAgICAgICAgICAgICAgICBlclRTTy5oYW5kbGUuY3NzKHsnbGVmdCcgOiAoZXJUU08ucGFuZWxXaWR0aCAtIDEpICsgJ3B4J30pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZXJUU08uYWRhcHRUb1dpbmRvd1NpemUoKTsNCiAgICAgICAgICAgIGVyVFNPLnJlZnJlc2goKTsNCiAgICAgICAgICAgIGVyVFNPLl9zZXRUcmFuc2l0aW9ucygpOw0KDQogICAgICAgICAgICAvLyBtYWtlIHRvb2x0aXBzIHdvcmsgb24gdG91Y2gtaG9sZA0KICAgICAgICAgICAgbGV0IHR0ID0gbmV3IGVyTW9iaWxlVG9vbFRpcHMoZXJUU08ucGFuZWwpOyAgICAgICAgICAgIA0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyBjaGFuZ2UgcGFuZWwgdmlzaWJpbGl0eSBvbiBoYW5kbGUtY2xpY2sNCiAgICAgICAgdGhpcy5oYW5kbGUuY2xpY2soZnVuY3Rpb24oZXZ0KSB7DQogICAgICAgICAgICBpZiAoIWVyVFNPLmlnbm9yZU5leHRDbGljaykgew0KICAgICAgICAgICAgICAgIGVyVFNPLm9wdGlvbnMucGFuZWxWaXNpYmxlID0gIWVyVFNPLm9wdGlvbnMucGFuZWxWaXNpYmxlOw0KICAgICAgICAgICAgICAgIGVyVFNPLnJlZnJlc2goKTsNCiAgICAgICAgICAgICAgICBlclRTTy5zYXZlQ29uZmlndXJhdGlvbigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyB3aW5kb3cgcmVzaXplIChvciBzY2FsaW5nKSBtaWdodCBjaGFuZ2UgcGFuZWwgc2l6ZQ0KICAgICAgICAkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uKGV2dCkgew0KICAgICAgICAgICAgJCgnLmVyLXRhYi1zbGlkZS1vdXQtZ3JpZC1ob3Jpem9udGFsJykuY3NzKHsnZmxleC13cmFwJyA6ICdub3dyYXAnfSk7DQogICAgICAgICAgICBlclRTTy5hZGFwdFRvV2luZG93U2l6ZSgpOw0KICAgICAgICAgICAgZXJUU08ucmVmcmVzaCgpOw0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyBkcmFnIHVpIHdpdGggdG91Y2ggZXZlbnRzDQogICAgICAgIGxldCBwcmV2VG91Y2hQb3NpdGlvblggPSAwOw0KICAgICAgICBsZXQgcHJldlRvdWNoUG9zaXRpb25ZID0gMDsNCiAgICAgICAgJCgnI2VyLXRhYi1zbGlkZS1vdXQtaGFuZGxlJykub24oJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbihldnQpIHsNCiAgICAgICAgICAgIGlmIChlclRTTy5kcmFnQXhpcyA9PT0gJ3gnKSB7DQogICAgICAgICAgICAgICAgcHJldlRvdWNoUG9zaXRpb25YID0gZXZ0LnRvdWNoZXNbMF0uY2xpZW50WDsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcHJldlRvdWNoUG9zaXRpb25ZID0gZXZ0LnRvdWNoZXNbMF0uY2xpZW50WTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgICQoJyNlci10YWItc2xpZGUtb3V0LWhhbmRsZScpLm9uKCd0b3VjaG1vdmUnLCBmdW5jdGlvbihldnQpIHsNCiAgICAgICAgICAgIGlmICgoZXZ0LnRvdWNoZXNbMF0uY2xpZW50WCA+IDApICYmIChldnQudG91Y2hlc1swXS5jbGllbnRYIDwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoKSkgeyAvLyBpZiB0b3VjaCBoYXBwZW5zIGluc2lkZSB2aWV3cG9ydA0KICAgICAgICAgICAgICAgIGlmIChlclRTTy5kcmFnQXhpcyA9PT0gJ3gnKSB7DQogICAgICAgICAgICAgICAgICAgIGxldCBsZWZ0TWF4ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIC0gZXJUU08ucGFuZWxXaWR0aDsNCiAgICAgICAgICAgICAgICAgICAgbGV0IGhhbmRsZUxlZnRNYXggPSBlclRTTy5wYW5lbFdpZHRoIC0gZXJUU08uaGFuZGxlLm91dGVyV2lkdGgoKTsNCiAgICAgICAgICAgICAgICAgICAgbGV0IG1vdmVkcGl4ZWxzID0gMDsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZUb3VjaFBvc2l0aW9uWCA8IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVkcGl4ZWxzID0gZXZ0LnRvdWNoZXNbMF0uY2xpZW50WDsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcmV2VG91Y2hQb3NpdGlvblggPiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVkcGl4ZWxzID0gZXZ0LnRvdWNoZXNbMF0uY2xpZW50WCAtIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVkcGl4ZWxzID0gZXZ0LnRvdWNoZXNbMF0uY2xpZW50WCAtIHByZXZUb3VjaFBvc2l0aW9uWDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoZXJUU08ucGFuZWwucG9zaXRpb24oKS5sZWZ0ICsgbW92ZWRwaXhlbHMgPCAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVhbGx5TW92ZWRQaXhlbHMgPSAtZXJUU08ucGFuZWwucG9zaXRpb24oKS5sZWZ0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRpZmZNb3ZlZFBpeGVscyA9IG1vdmVkcGl4ZWxzIC0gcmVhbGx5TW92ZWRQaXhlbHM7DQogICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5wYW5lbC5jc3MoJ2xlZnQnLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlclRTTy5oYW5kbGUucG9zaXRpb24oKS5sZWZ0ICsgZGlmZk1vdmVkUGl4ZWxzIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLmhhbmRsZS5jc3MoJ2xlZnQnLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08uaGFuZGxlLmNzcygnbGVmdCcsIGVyVFNPLmhhbmRsZS5wb3NpdGlvbigpLmxlZnQgKyBkaWZmTW92ZWRQaXhlbHMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVyVFNPLnBhbmVsLnBvc2l0aW9uKCkubGVmdCArIG1vdmVkcGl4ZWxzID4gbGVmdE1heCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlYWxseU1vdmVkUGl4ZWxzID0gbGVmdE1heCAtIGVyVFNPLnBhbmVsLnBvc2l0aW9uKCkubGVmdDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkaWZmTW92ZWRQaXhlbHMgPSBtb3ZlZHBpeGVscyAtIHJlYWxseU1vdmVkUGl4ZWxzOw0KICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08ucGFuZWwuY3NzKCdsZWZ0JywgbGVmdE1heCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJUU08uaGFuZGxlLnBvc2l0aW9uKCkubGVmdCArIGRpZmZNb3ZlZFBpeGVscyA+IGhhbmRsZUxlZnRNYXgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5oYW5kbGUuY3NzKCdsZWZ0JywgaGFuZGxlTGVmdE1heCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLmhhbmRsZS5jc3MoJ2xlZnQnLCBlclRTTy5oYW5kbGUucG9zaXRpb24oKS5sZWZ0ICsgZGlmZk1vdmVkUGl4ZWxzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLnBhbmVsLmNzcygnbGVmdCcsIGVyVFNPLnBhbmVsLnBvc2l0aW9uKCkubGVmdCArIG1vdmVkcGl4ZWxzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBwcmV2VG91Y2hQb3NpdGlvblggPSBldnQudG91Y2hlc1swXS5jbGllbnRYOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGxldCB0b3BNYXggPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSBlclRTTy5wYW5lbEhlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgbGV0IGhhbmRsZVRvcE1heCA9IGVyVFNPLnBhbmVsSGVpZ2h0IC0gZXJUU08uaGFuZGxlLm91dGVySGVpZ2h0KCk7DQogICAgICAgICAgICAgICAgICAgIGxldCBtb3ZlZHBpeGVscyA9IDA7DQogICAgICAgICAgICAgICAgICAgIGlmIChwcmV2VG91Y2hQb3NpdGlvblkgPCAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtb3ZlZHBpeGVscyA9IGV2dC50b3VjaGVzWzBdLmNsaWVudFk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocHJldlRvdWNoUG9zaXRpb25ZID4gd2luZG93LmlubmVySGVpZ2h0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtb3ZlZHBpeGVscyA9IGV2dC50b3VjaGVzWzBdLmNsaWVudFkgLSB3aW5kb3cuaW5uZXJIZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtb3ZlZHBpeGVscyA9IGV2dC50b3VjaGVzWzBdLmNsaWVudFkgLSBwcmV2VG91Y2hQb3NpdGlvblk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKGVyVFNPLnBhbmVsLnBvc2l0aW9uKCkudG9wICsgbW92ZWRwaXhlbHMgPCAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVhbGx5TW92ZWRQaXhlbHMgPSAtZXJUU08ucGFuZWwucG9zaXRpb24oKS50b3A7DQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGlmZk1vdmVkUGl4ZWxzID0gbW92ZWRwaXhlbHMgLSByZWFsbHlNb3ZlZFBpeGVsczsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLnBhbmVsLmNzcygndG9wJywgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJUU08uaGFuZGxlLnBvc2l0aW9uKCkudG9wICsgZGlmZk1vdmVkUGl4ZWxzIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLmhhbmRsZS5jc3MoJ3RvcCcsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5oYW5kbGUuY3NzKCd0b3AnLCBlclRTTy5oYW5kbGUucG9zaXRpb24oKS50b3AgKyBkaWZmTW92ZWRQaXhlbHMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVyVFNPLnBhbmVsLnBvc2l0aW9uKCkudG9wICsgbW92ZWRwaXhlbHMgPiB0b3BNYXgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZWFsbHlNb3ZlZFBpeGVscyA9IHRvcE1heCAtIGVyVFNPLnBhbmVsLnBvc2l0aW9uKCkudG9wOw0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRpZmZNb3ZlZFBpeGVscyA9IG1vdmVkcGl4ZWxzIC0gcmVhbGx5TW92ZWRQaXhlbHM7DQogICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5wYW5lbC5jc3MoJ3RvcCcsIHRvcE1heCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJUU08uaGFuZGxlLnBvc2l0aW9uKCkudG9wICsgZGlmZk1vdmVkUGl4ZWxzID4gaGFuZGxlVG9wTWF4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08uaGFuZGxlLmNzcygndG9wJywgaGFuZGxlVG9wTWF4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08uaGFuZGxlLmNzcygndG9wJywgZXJUU08uaGFuZGxlLnBvc2l0aW9uKCkudG9wICsgZGlmZk1vdmVkUGl4ZWxzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLnBhbmVsLmNzcygndG9wJywgZXJUU08ucGFuZWwucG9zaXRpb24oKS50b3AgKyBtb3ZlZHBpeGVscyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcHJldlRvdWNoUG9zaXRpb25ZID0gZXZ0LnRvdWNoZXNbMF0uY2xpZW50WTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgIC8vIHNldCBoYW5kbGVyIGZvciBrZXlib2FyZCBhY2Nlc3NpYmlsaXR5DQogICAgICAgICQoZG9jdW1lbnQpLm9uKCdrZXlkb3duJywgZnVuY3Rpb24oZXZ0KSB7DQogICAgICAgICAgICBpZiAoJChldnQudGFyZ2V0KS5hdHRyKCdpZCcpID09PSAnZXItdGFiLXNsaWRlLW91dC1oYW5kbGUnKSB7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gb3Blbi9jbG9zZSBwYW5lbCBvbiBFbnRlcg0KICAgICAgICAgICAgICAgIGlmIChldnQud2hpY2ggPT09IDEzKSB7DQogICAgICAgICAgICAgICAgICAgIGVyVFNPLm9wdGlvbnMucGFuZWxWaXNpYmxlID0gIWVyVFNPLm9wdGlvbnMucGFuZWxWaXNpYmxlOw0KICAgICAgICAgICAgICAgICAgICBlclRTTy5yZWZyZXNoKCk7DQogICAgICAgICAgICAgICAgICAgIGVyVFNPLnNhdmVDb25maWd1cmF0aW9uKCk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8gZHJhZyB3aXRoIHNoaWZ0LWFycm93S2V5DQogICAgICAgICAgICAgICAgaWYgKGV2dC5zaGlmdEtleSkgew0KICAgICAgICAgICAgICAgICAgICBzd2l0Y2goZXZ0LndoaWNoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM3OiB7IC8vIGFycm93IGxlZnQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJUU08uZHJhZ0F4aXMgPT09ICd4Jykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsgLy8gcHJldmVudCBkZWZhdWx0IGFjdGlvbiBmb3Iga2V5cw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dFBvc1hIYW5kbGUgPSBwYXJzZUZsb2F0KGVyVFNPLmhhbmRsZS5jc3MoJ2xlZnQnKSkgLSAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dFBvc1hIYW5kbGUgPCAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dFBvc1hQYW5lbCA9IHBhcnNlRmxvYXQoZXJUU08ucGFuZWwuY3NzKCdsZWZ0JykpIC0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0UG9zWFBhbmVsID49IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5wYW5lbC5jc3MoJ2xlZnQnLCAobmV4dFBvc1hQYW5lbCkgKyAncHgnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLmhhbmRsZS5jc3MoJ2xlZnQnLCAobmV4dFBvc1hIYW5kbGUpICsgJ3B4Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08uc2F2ZUNvbmZpZ3VyYXRpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM4OiB7IC8vIGFycm93IHVwDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVyVFNPLmRyYWdBeGlzID09PSAneScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXh0UG9zWUhhbmRsZSA9IHBhcnNlRmxvYXQoZXJUU08uaGFuZGxlLmNzcygndG9wJykpIC0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRQb3NZSGFuZGxlIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG5leHRQb3NZUGFuZWwgPSBwYXJzZUZsb2F0KGVyVFNPLnBhbmVsLmNzcygndG9wJykpIC0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0UG9zWVBhbmVsID49IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5wYW5lbC5jc3MoJ3RvcCcsIChuZXh0UG9zWVBhbmVsKSArICdweCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08uaGFuZGxlLmNzcygndG9wJywgKG5leHRQb3NZSGFuZGxlKSArICdweCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLnNhdmVDb25maWd1cmF0aW9uKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOTogeyAvLyBhcnJvdyByaWdodA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlclRTTy5kcmFnQXhpcyA9PT0gJ3gnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaGFuZGxlTGVmdE1heCA9IGVyVFNPLnBhbmVsV2lkdGggLSBlclRTTy5oYW5kbGUub3V0ZXJXaWR0aCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dFBvc1hIYW5kbGUgPSBwYXJzZUZsb2F0KGVyVFNPLmhhbmRsZS5jc3MoJ2xlZnQnKSkgKyAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dFBvc1hIYW5kbGUgPiBoYW5kbGVMZWZ0TWF4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGFuZWxMZWZ0TWF4ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIC0gZXJUU08ucGFuZWxXaWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXh0UG9zWFBhbmVsID0gcGFyc2VGbG9hdChlclRTTy5wYW5lbC5jc3MoJ2xlZnQnKSkgKyAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRQb3NYUGFuZWwgPD0gcGFuZWxMZWZ0TWF4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08ucGFuZWwuY3NzKCdsZWZ0JywgKG5leHRQb3NYUGFuZWwpICsgJ3B4Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5oYW5kbGUuY3NzKCdsZWZ0JywgKG5leHRQb3NYSGFuZGxlKSArICdweCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLnNhdmVDb25maWd1cmF0aW9uKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0MDogeyAvLyBhcnJvdyBkb3duDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVyVFNPLmRyYWdBeGlzID09PSAneScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBoYW5kbGVUb3BNYXggPSBlclRTTy5wYW5lbEhlaWdodCAtIGVyVFNPLmhhbmRsZS5vdXRlckhlaWdodCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dFBvc1lIYW5kbGUgPSBwYXJzZUZsb2F0KGVyVFNPLmhhbmRsZS5jc3MoJ3RvcCcpKSArIDI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0UG9zWUhhbmRsZSA+IGhhbmRsZVRvcE1heCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBhbmVsVG9wTWF4ID0gd2luZG93LmlubmVySGVpZ2h0IC0gZXJUU08ucGFuZWxIZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dFBvc1lQYW5lbCA9IHBhcnNlRmxvYXQoZXJUU08ucGFuZWwuY3NzKCd0b3AnKSkgKyAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRQb3NZUGFuZWwgPCBwYW5lbFRvcE1heCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLnBhbmVsLmNzcygndG9wJywgKG5leHRQb3NZUGFuZWwpICsgJ3B4Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5oYW5kbGUuY3NzKCd0b3AnLCAobmV4dFBvc1lIYW5kbGUpICsgJ3B4Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08uc2F2ZUNvbmZpZ3VyYXRpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0sDQoNCiAgICBfc2V0VHJhbnNpdGlvbnM6IGZ1bmN0aW9uKCkgew0KICAgICAgICBpZiAodGhpcy5vcHRpb25zLnRhYlBvc2l0aW9uaW5nID09PSAnbGVmdCcgfHwgdGhpcy5vcHRpb25zLnRhYlBvc2l0aW9uaW5nID09PSAncmlnaHQnKSB7DQogICAgICAgICAgICB0aGlzLnBhbmVsLmNzcyh7Jy13ZWJraXQtdHJhbnNpdGlvbicgOiAnbGVmdCAwLjVzLCB0b3AgMHMnLCAnLW1vei10cmFuc2l0aW9uJyA6ICdsZWZ0IDAuNXMsIHRvcCAwcycsDQogICAgICAgICAgICAnLW8tdHJhbnNpdGlvbicgOiAnbGVmdCAwLjVzLCB0b3AgMHMnLCAndHJhbnNpdGlvbicgOiAnbGVmdCAwLjVzLCB0b3AgMHMnfSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aGlzLnBhbmVsLmNzcyh7Jy13ZWJraXQtdHJhbnNpdGlvbicgOiAnbGVmdCAwcywgdG9wIDAuNXMnLCAnLW1vei10cmFuc2l0aW9uJyA6ICdsZWZ0IDBzLCB0b3AgMC41cycsDQogICAgICAgICAgICAnLW8tdHJhbnNpdGlvbicgOiAnbGVmdCAwcywgdG9wIDAuNXMnLCAndHJhbnNpdGlvbicgOiAnbGVmdCAwcywgdG9wIDAuNXMnfSk7DQogICAgICAgIH0NCiAgICB9LA0KDQogICAgYWRhcHRUb1dpbmRvd1NpemU6IGZ1bmN0aW9uKCkgew0KICAgICAgICBpZiAodGhpcy5kcmFnQXhpcyA9PT0gJ3gnKSB7DQogICAgICAgICAgICBpZiAodGhpcy5wYW5lbC5wb3NpdGlvbigpLmxlZnQgKyB0aGlzLnBhbmVsV2lkdGggPiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgpIHsNCiAgICAgICAgICAgICAgICBsZXQgbmV3UG9zTGVmdCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCAtIHRoaXMucGFuZWxXaWR0aDsNCiAgICAgICAgICAgICAgICBpZiAobmV3UG9zTGVmdCA+PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucGFuZWwuY3NzKHsnbGVmdCcgOiBuZXdQb3NMZWZ0ICsgJ3B4J30pOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucGFuZWwuY3NzKHsnbGVmdCcgOiAnMHB4J30pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICh0aGlzLmhhbmRsZS5wb3NpdGlvbigpLmxlZnQgPiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggLSB0aGlzLmhhbmRsZS5vdXRlcldpZHRoKCkpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZS5jc3MoeydsZWZ0JyA6IChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggLSB0aGlzLmhhbmRsZS5vdXRlcldpZHRoKCkpICsgJ3B4J30pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKHRoaXMucGFuZWxIZWlnaHQgPiB3aW5kb3cuaW5uZXJIZWlnaHQpIHsNCiAgICAgICAgICAgICAgICAgJCgnI2VyLXRhYi1zbGlkZS1vdXQtZ3JpZC1jb250YWluZXInKS5jc3MoeydncmlkLXRlbXBsYXRlLWNvbHVtbnMnIDogJ2F1dG8gYXV0byBhdXRvJ30pOw0KICAgICAgICAgICAgICAgIHRoaXMucGFuZWxIZWlnaHQgPSB0aGlzLnBhbmVsLm91dGVySGVpZ2h0KCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICQoJyNlci10YWItc2xpZGUtb3V0LWdyaWQtY29udGFpbmVyJykuY3NzKHsnZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zJyA6ICdhdXRvIGF1dG8nfSk7DQogICAgICAgICAgICAgICAgdGhpcy5wYW5lbEhlaWdodCA9IHRoaXMucGFuZWwub3V0ZXJIZWlnaHQoKTsNCiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYW5lbEhlaWdodCA+IHdpbmRvdy5pbm5lckhlaWdodCkgew0KICAgICAgICAgICAgICAgICAgICAkKCcjZXItdGFiLXNsaWRlLW91dC1ncmlkLWNvbnRhaW5lcicpLmNzcyh7J2dyaWQtdGVtcGxhdGUtY29sdW1ucycgOiAnYXV0byBhdXRvIGF1dG8nfSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucGFuZWxIZWlnaHQgPSB0aGlzLnBhbmVsLm91dGVySGVpZ2h0KCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHRoaXMucGFuZWwucG9zaXRpb24oKS50b3AgKyB0aGlzLnBhbmVsSGVpZ2h0ID4gd2luZG93LmlubmVySGVpZ2h0KSB7DQogICAgICAgICAgICAgICAgbGV0IG5ld1Bvc1RvcCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIHRoaXMucGFuZWxIZWlnaHQ7DQogICAgICAgICAgICAgICAgaWYgKG5ld1Bvc1RvcCA+PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucGFuZWwuY3NzKHsndG9wJyA6IG5ld1Bvc1RvcCArICdweCd9KTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBhbmVsLmNzcyh7J3RvcCcgOiAnMHB4J30pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICh0aGlzLmhhbmRsZS5wb3NpdGlvbigpLnRvcCA+IHdpbmRvdy5pbm5lckhlaWdodCAtIHRoaXMuaGFuZGxlLm91dGVySGVpZ2h0KCkpIHsNCiAgICAgICAgICAgICAgICBpZiAod2luZG93LmlubmVySGVpZ2h0IC0gdGhpcy5oYW5kbGUub3V0ZXJIZWlnaHQoKSA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGUuY3NzKHsndG9wJyA6ICh3aW5kb3cuaW5uZXJIZWlnaHQgLSB0aGlzLmhhbmRsZS5vdXRlckhlaWdodCgpKSArICdweCd9KTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZS5jc3Moeyd0b3AnIDogJzBweCd9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ICAgICAgICAgICAgDQogICAgICAgIH0NCiAgICAgICAgJCgnLmVyLXRhYi1zbGlkZS1vdXQtZ3JpZC1ob3Jpem9udGFsJykuY3NzKHsnZmxleC13cmFwJyA6ICd3cmFwJ30pOw0KDQogICAgICAgIC8vIHNldCBoaWdodCBhbmQgd2lkdGggaW4gY2FzZSB0aGUgcGFuZWwgaGFzIHdyYXBwZWQgYW5kIGhhcyB0aGVyZWZvcmUgYSBkaWZmZXJlbnQgc2l6ZQ0KICAgICAgICB0aGlzLnBhbmVsSGVpZ2h0ID0gdGhpcy5wYW5lbC5vdXRlckhlaWdodCgpOw0KICAgICAgICB0aGlzLnBhbmVsV2lkdGggPSB0aGlzLnBhbmVsLm91dGVyV2lkdGgoKTsNCg0KICAgICAgICB0aGlzLnNhdmVDb25maWd1cmF0aW9uKCk7DQogICAgfSwNCg0KICAgIF9zZXRPcHRpb246IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsNCiAgICAgICAgdGhpcy5fc3VwZXIoa2V5LCB2YWx1ZSk7DQogICAgICAgIGlmIChrZXkgPT09ICJ0YWJQb3NpdGlvbmluZyIpIHsNCiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gInRvcCIgfHwgdmFsdWUgPT09ICJib3R0b20iKSB7DQogICAgICAgICAgICAgICAgJCgnI2VyLXRhYi1zbGlkZS1vdXQtZ3JpZC1jb250YWluZXInKS5hZGRDbGFzcygnZXItdGFiLXNsaWRlLW91dC1ncmlkLWhvcml6b250YWwnKTsNCiAgICAgICAgICAgICAgICB0aGlzLmRyYWdBeGlzID0geDsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5kcmFnQXhpcyA9IHk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLnJlZnJlc2goKTsNCiAgICAgICAgICAgIHRoaXMuX3NldFRyYW5zaXRpb25zKCk7DQogICAgICAgIH0gZWxzZSBpZihrZXkgPT09ICJwYW5lbFZpc2libGUiKSB7DQogICAgICAgICAgICB0aGlzLnJlZnJlc2goKTsNCiAgICAgICAgfQ0KICAgIH0sDQoNCiAgICBzYXZlQ29uZmlndXJhdGlvbjogZnVuY3Rpb24oKSB7DQogICAgICAgIHRoaXMub3B0aW9ucy5zYXZlQ29uZmlnKHt0YWJQb3M6IHRoaXMub3B0aW9ucy50YWJQb3NpdGlvbmluZywgLy8gbmVlZGVkIHRvIHJlY29nbml6ZSBhIGNoYW5nZSBhbmQgdGhlbiBzZXQgb3B0aW9ucyB0byBkZWZhdWx0IGFnYWluDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5WaXM6IHRoaXMub3B0aW9ucy5wYW5lbFZpc2libGUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5Qb3M6IHt0b3A6IHBhcnNlSW50KHRoaXMucGFuZWwuY3NzKCd0b3AnKSwgMTApLCBsZWZ0OiBwYXJzZUludCh0aGlzLnBhbmVsLmNzcygnbGVmdCcpLCAxMCl9LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuUG9zOiB7dG9wOiBwYXJzZUludCh0aGlzLmhhbmRsZS5jc3MoJ3RvcCcpLCAxMCksIGxlZnQ6IHBhcnNlSW50KHRoaXMuaGFuZGxlLmNzcygnbGVmdCcpLCAxMCl9fSk7DQogICAgfSwNCg0KICAgIHVwZGF0ZVBhbmVsOiBmdW5jdGlvbigpIHsNCiAgICAgICAgLy8gbWFrZSBzdXJlIHBhbmVsIGlzIGluIGRpc3BsYXk9Z3JpZCB0byBiZSBhYmxlIHRvIHNldCB0aGUgY29ycmVjdCBkaW1lbnNpb25zIG9mIHRoZSBwYW5lbA0KICAgICAgICBsZXQgcHJldkRpc3BsYXlTZXR0aW5nID0gdGhpcy5ncmlkQ29udGFpbmVyLmNzcygnZGlzcGxheScpOw0KICAgICAgICBsZXQgaGFkQ2xhc3NIb3Jpem9udGFsID0gdGhpcy5ncmlkQ29udGFpbmVyLmhhc0NsYXNzKCdlci10YWItc2xpZGUtb3V0LWdyaWQtaG9yaXpvbnRhbCcpOw0KICAgICAgICBpZiAodGhpcy5kcmFnQXhpcyA9PT0gJ3knKSB7DQogICAgICAgICAgICB0aGlzLmdyaWRDb250YWluZXIuY3NzKHsnZGlzcGxheScgOiAnZ3JpZCd9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlmICghaGFkQ2xhc3NIb3Jpem9udGFsKSB7DQogICAgICAgICAgICAgICAgdGhpcy5ncmlkQ29udGFpbmVyLmFkZENsYXNzKCdlci10YWItc2xpZGUtb3V0LWdyaWQtaG9yaXpvbnRhbCcpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5ncmlkQ29udGFpbmVyLmNzcyh7J2Rpc3BsYXknIDogJ2ZsZXgnfSk7DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5wYW5lbEhlaWdodCA9IHRoaXMucGFuZWwub3V0ZXJIZWlnaHQoKTsNCiAgICAgICAgdGhpcy5wYW5lbFdpZHRoID0gdGhpcy5wYW5lbC5vdXRlcldpZHRoKCk7DQogICAgICAgIGlmICgodGhpcy5kcmFnQXhpcyA9PT0gJ3gnKSAmJiAhaGFkQ2xhc3NIb3Jpem9udGFsKSB7DQogICAgICAgICAgICB0aGlzLmdyaWRDb250YWluZXIucmVtb3ZlQ2xhc3MoJ2VyLXRhYi1zbGlkZS1vdXQtZ3JpZC1ob3Jpem9udGFsJyk7DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5ncmlkQ29udGFpbmVyLmNzcygnZGlzcGxheScsIHByZXZEaXNwbGF5U2V0dGluZyk7DQogICAgfSwNCg0KICAgIHJlZnJlc2g6IGZ1bmN0aW9uKCkgew0KICAgICAgICAvLyBhZGp1c3QgdmlzaWJpbGl0eSBkZXBlbmRpbmcgb24gY3VycmVudGx5IHNldCBvcHRpb25zDQogICAgICAgIGxldCBlclRTTyA9IHRoaXM7DQogICAgICAgIGlmICh0aGlzLm9wdGlvbnMudGFiUG9zaXRpb25pbmcgPT09ICdyaWdodCcpIHsNCiAgICAgICAgICAgIHRoaXMuaGFuZGxlLmNzcyh7J2xlZnQnIDogJy0nICsgKHRoaXMuaGFuZGxlLm91dGVyV2lkdGgoKSArIDEpICsgJ3B4J30pOw0KICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5wYW5lbFZpc2libGUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmdyaWRDb250YWluZXIuY3NzKHsnZGlzcGxheScgOiAnZ3JpZCd9KTsNCiAgICAgICAgICAgICAgICB0aGlzLnBhbmVsLmNzcyh7J2xlZnQnIDogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIC0gdGhpcy5wYW5lbFdpZHRoICsgJ3B4J30pOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLnBhbmVsLmNzcyh7J2xlZnQnIDogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoICsgJ3B4J30pOw0KICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICghZXJUU08ub3B0aW9ucy5wYW5lbFZpc2libGUpIHsgLy8gaXQgbWlnaHQgaGF2ZSBiZWVuIHNldCB0byB0cnVlIGFnYWluIGR1cmluZyB0aW1lb3V0IGR1cmF0aW9uDQogICAgICAgICAgICAgICAgICAgICAgICBlclRTTy5ncmlkQ29udGFpbmVyLmNzcygnZGlzcGxheScsICdub25lJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LCA1MDApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy50YWJQb3NpdGlvbmluZyA9PT0gJ3RvcCcpIHsNCiAgICAgICAgICAgIHRoaXMuaGFuZGxlLmNzcyh7J3RvcCcgOiAodGhpcy5wYW5lbEhlaWdodCAtIDEpICsgJ3B4J30pOw0KICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5wYW5lbFZpc2libGUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmdyaWRDb250YWluZXIuYWRkQ2xhc3MoJ2VyLXRhYi1zbGlkZS1vdXQtZ3JpZC1ob3Jpem9udGFsJyk7DQogICAgICAgICAgICAgICAgdGhpcy5ncmlkQ29udGFpbmVyLmNzcyh7J2Rpc3BsYXknIDogJ2ZsZXgnfSk7DQogICAgICAgICAgICAgICAgdGhpcy5wYW5lbC5jc3Moeyd0b3AnIDogJzBweCd9KTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5wYW5lbC5jc3Moeyd0b3AnIDogJy0nICsgdGhpcy5wYW5lbEhlaWdodCArICdweCd9KTsNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIWVyVFNPLm9wdGlvbnMucGFuZWxWaXNpYmxlKSB7IC8vIGl0IG1pZ2h0IGhhdmUgYmVlbiBzZXQgdG8gdHJ1ZSBhZ2FpbiBkdXJpbmcgdGltZW91dCBkdXJhdGlvbg0KICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08uZ3JpZENvbnRhaW5lci5yZW1vdmVDbGFzcygnZXItdGFiLXNsaWRlLW91dC1ncmlkLWhvcml6b250YWwnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLmdyaWRDb250YWluZXIuY3NzKHsnZGlzcGxheScgOiAnbm9uZSd9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sIDUwMCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zLnRhYlBvc2l0aW9uaW5nID09PSAnYm90dG9tJykgew0KICAgICAgICAgICAgdGhpcy5oYW5kbGUuY3NzKHsndG9wJyA6ICctJyArICh0aGlzLmhhbmRsZS5vdXRlckhlaWdodCgpICsgMSkgKyAncHgnfSk7DQogICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBhbmVsVmlzaWJsZSkgew0KICAgICAgICAgICAgICAgIHRoaXMuZ3JpZENvbnRhaW5lci5hZGRDbGFzcygnZXItdGFiLXNsaWRlLW91dC1ncmlkLWhvcml6b250YWwnKTsNCiAgICAgICAgICAgICAgICB0aGlzLmdyaWRDb250YWluZXIuY3NzKHsnZGlzcGxheScgOiAnZmxleCd9KTsNCiAgICAgICAgICAgICAgICB0aGlzLnBhbmVsLmNzcyh7J3RvcCcgOiB3aW5kb3cuaW5uZXJIZWlnaHQtdGhpcy5wYW5lbEhlaWdodCArICdweCd9KTsNCiAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMucGFuZWwuY3NzKHsndG9wJyA6IHdpbmRvdy5pbm5lckhlaWdodCArICdweCd9KTsNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIWVyVFNPLm9wdGlvbnMucGFuZWxWaXNpYmxlKSB7IC8vIGl0IG1pZ2h0IGhhdmUgYmVlbiBzZXQgdG8gdHJ1ZSBhZ2FpbiBkdXJpbmcgdGltZW91dCBkdXJhdGlvbg0KICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08uZ3JpZENvbnRhaW5lci5yZW1vdmVDbGFzcygnZXItdGFiLXNsaWRlLW91dC1ncmlkLWhvcml6b250YWwnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVyVFNPLmdyaWRDb250YWluZXIuY3NzKHsnZGlzcGxheScgOiAnbm9uZSd9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sIDUwMCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zLnRhYlBvc2l0aW9uaW5nID09PSAnbGVmdCcpIHsNCiAgICAgICAgICAgIHRoaXMuaGFuZGxlLmNzcyh7J2xlZnQnIDogKHRoaXMucGFuZWxXaWR0aCAtIDEpICsgJ3B4J30pOw0KICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5wYW5lbFZpc2libGUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmdyaWRDb250YWluZXIuY3NzKHsnZGlzcGxheScgOiAnZ3JpZCd9KTsNCiAgICAgICAgICAgICAgICB0aGlzLnBhbmVsLmNzcyh7J2xlZnQnIDogJzBweCd9KTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5wYW5lbC5jc3MoeydsZWZ0JyA6ICctJyArIHRoaXMucGFuZWxXaWR0aCArICdweCd9KTsNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIWVyVFNPLm9wdGlvbnMucGFuZWxWaXNpYmxlKSB7IC8vIGl0IG1pZ2h0IGhhdmUgYmVlbiBzZXQgdG8gdHJ1ZSBhZ2FpbiBkdXJpbmcgdGltZW91dCBkdXJhdGlvbg0KICAgICAgICAgICAgICAgICAgICAgICAgZXJUU08uZ3JpZENvbnRhaW5lci5jc3MoeydkaXNwbGF5JyA6ICdub25lJ30pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwgNTAwKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBsZXQgdGFiX3NsaWRlX291dCA9ICQoJyNlci10YWItc2xpZGUtb3V0Jyk7DQogICAgICAgIGlmICh0YWJfc2xpZGVfb3V0Lmxlbmd0aCkgew0KICAgICAgICAgICAgaWYgKGVyVFNPLm9wdGlvbnMucGFuZWxWaXNpYmxlKSB7DQogICAgICAgICAgICAgICAgdGFiX3NsaWRlX291dC5yZW1vdmVDbGFzcygnZXItdGFiLWluJyk7DQogICAgICAgICAgICAgICAgdGFiX3NsaWRlX291dC5hZGRDbGFzcygnZXItdGFiLW91dCcpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0YWJfc2xpZGVfb3V0LnJlbW92ZUNsYXNzKCdlci10YWItb3V0Jyk7DQogICAgICAgICAgICAgICAgdGFiX3NsaWRlX291dC5hZGRDbGFzcygnZXItdGFiLWluJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9KTs="
                    },
                    {
                        "id": "ui/tab-slide-out-ui.js",
                        "source": "Y2xhc3MgVGFiU2xpZGVPdXRVc2VySW50ZXJmYWNlIGV4dGVuZHMgVXNlckludGVyZmFjZUJhc2Ugew0KICAgIGNvbnN0cnVjdG9yKGNvbmZpZ3VyYXRpb24sIHRhYkNvbmZpZ3VyYXRpb24pIHsNCiAgICAgICAgc3VwZXIoY29uZmlndXJhdGlvbiwgdGFiQ29uZmlndXJhdGlvbik7DQoNCiAgICAgICAgdGhpcy5jb25maWd1cmF0aW9uID0gY29uZmlndXJhdGlvbjsNCiAgICAgICAgdGhpcy5jdXJyZW50VG9vbElkID0gMTsNCg0KICAgICAgICB0aGlzLnRvb2xzQ29udGFpbmVycyA9IFtdOw0KICAgIH0gICAgICAgIA0KDQogICAgaW5pdFVJKCl7DQogICAgICAgIGxldCB1c2VySW50ZXJmYWNlID0gdGhpczsNCiAgICAgICAgJCgiYm9keSIpLmFwcGVuZCgNCiAgICAgICAgICAgICc8ZGl2IGlkPSJlci10YWItc2xpZGUtb3V0IiBjbGFzcz0iZWFzeS1yZWFkaW5nLWludGVyZmFjZSBkcmFnZ2FibGUgdWktd2lkZ2V0LWNvbnRlbnQiIHN0eWxlPSJ6LWluZGV4OiA5OTk5OSI+JyArDQogICAgICAgICAgICAgICAgJzxkaXYgaWQ9ImVyLXRhYi1zbGlkZS1vdXQtaGFuZGxlIiBjbGFzcz0iaGFuZGxlIiB0YWJpbmRleD0iMCIgc3R5bGU9IndpZHRoOiAnICsgKHRoaXMuY29uZmlndXJhdGlvbi5idXR0b25TaXplKSArICdweDtoZWlnaHQ6ICcgKyAodGhpcy5jb25maWd1cmF0aW9uLmJ1dHRvblNpemUpICsgJ3B4OyI+PC9kaXY+JyArDQogICAgICAgICAgICAgICAgJzxkaXYgaWQ9ImVyLXRhYi1zbGlkZS1vdXQtZ3JpZC1jb250YWluZXIiPjwvZGl2PicgKw0KICAgICAgICAgICAgJzwvZGl2PicpOw0KICAgICAgICBsZXQgcGFuVmlzID0gZmFsc2U7DQogICAgICAgIGxldCBwYW5Qb3MgPSB7dG9wOiAyMDAsIGxlZnQ6IDIwMH07DQogICAgICAgIGxldCBoYW5Qb3MgPSB7dG9wOiAwLCBsZWZ0OiAwfTsNCiAgICAgICAgaWYgKHRoaXMudGFiQ29uZmlndXJhdGlvbiAmJiAodGhpcy5jb25maWd1cmF0aW9uLnRhYlBvc2l0aW9uaW5nID09PSB0aGlzLnRhYkNvbmZpZ3VyYXRpb24udGFiUG9zKSkgew0KICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy50YWJDb25maWd1cmF0aW9uKTsNCiAgICAgICAgICAgIHBhblZpcyA9IHRoaXMudGFiQ29uZmlndXJhdGlvbi5wYW5WaXM7DQogICAgICAgICAgICBwYW5Qb3MgPSB0aGlzLnRhYkNvbmZpZ3VyYXRpb24ucGFuUG9zOw0KICAgICAgICAgICAgaGFuUG9zID0gdGhpcy50YWJDb25maWd1cmF0aW9uLmhhblBvczsNCiAgICAgICAgfQ0KICAgICAgICAkKCIjZXItdGFiLXNsaWRlLW91dCIpLmVyVGFiU2xpZGVPdXQoew0KICAgICAgICAgICAgdGFiUG9zaXRpb25pbmc6IHRoaXMuY29uZmlndXJhdGlvbi50YWJQb3NpdGlvbmluZywNCiAgICAgICAgICAgIHBhbmVsVmlzaWJsZTogcGFuVmlzLA0KICAgICAgICAgICAgcGFuZWxQb3M6IHBhblBvcywNCiAgICAgICAgICAgIGhhbmRsZVBvczogaGFuUG9zLA0KICAgICAgICAgICAgc2F2ZUNvbmZpZzogZnVuY3Rpb24ob2xkQ29uZikgew0KICAgICAgICAgICAgICAgIHVpVXBkYXRlTWFuYWdlci5zYXZlQ3VycmVudENvbmZpZ3VyYXRpb24odXNlckludGVyZmFjZSwgb2xkQ29uZik7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0NCg0KICAgIHNob3coKXsNCiAgICAgICAgJCgiI2VyLXRhYi1zbGlkZS1vdXQiKS5zaG93KCk7DQogICAgfQ0KDQogICAgaGlkZSgpew0KICAgICAgICAkKCIjZXItdGFiLXNsaWRlLW91dCIpLmhpZGUoKTsNCiAgICB9DQoNCiAgICBnZXRUb29sQ29udGFpbmVySURGb3JMYXlvdXQodG9vbElELCBsYXlvdXRDb25maWcsIG9yZGVyKSB7DQoNCiAgICAgICAgbGV0IGFuaW1hdGVkQ1NTQ2xhc3MgPSAiIjsNCiAgICAgICAgaWYgKHR5cGVvZiBvcmRlciAhPT0gInVuZGVmaW5lZCIpIHsNCiAgICAgICAgICAgIGFuaW1hdGVkQ1NTQ2xhc3MgPSAiIHRhYi1zbGlkZS1vdXQtYW5pbWF0ZWQiOw0KICAgICAgICB9DQoNCiAgICAgICAgbGV0IGN1cnJlbnRDb250YWluZXJJRCA9ICJ0YWItc2xpZGUtb3V0LWNvbnRhaW5lci0iICsgdGhpcy5jdXJyZW50VG9vbElkOw0KICAgICAgICB0aGlzLmN1cnJlbnRUb29sSWQrKzsNCg0KICAgICAgICBsZXQgdG9vbEluZm8gPSB7DQogICAgICAgICAgICB0b29sSUQ6IHRvb2xJRCwNCiAgICAgICAgICAgIGNvbnRhaW5lcklEOiBjdXJyZW50Q29udGFpbmVySUQsDQogICAgICAgIH07DQoNCg0KICAgICAgICBpZiAodHlwZW9mIG9yZGVyICE9PSAidW5kZWZpbmVkIiAmJiBvcmRlciA8IHRoaXMudG9vbHNDb250YWluZXJzLmxlbmd0aCkgew0KDQogICAgICAgICAgICBsZXQgY3VycmVudFRvb2xJblRoYXRPcmRlciA9IHRoaXMudG9vbHNDb250YWluZXJzW29yZGVyXTsNCg0KICAgICAgICAgICAgaWYgKCQoIiNlci10YWItc2xpZGUtb3V0IikuZXJUYWJTbGlkZU91dCgib3B0aW9uIiwgInBhbmVsVmlzaWJsZSIpKSB7DQoNCiAgICAgICAgICAgICAgICAkKCIjIiArIGN1cnJlbnRUb29sSW5UaGF0T3JkZXIuY29udGFpbmVySUQpLmJlZm9yZSgnPGRpdiBjbGFzcz0iZXItdGFiLXNsaWRlLW91dC1ncmlkLWl0ZW0nICsgYW5pbWF0ZWRDU1NDbGFzcyArICciIGlkPSInICsgY3VycmVudENvbnRhaW5lcklEICsgJyIgc3R5bGU9IndpZHRoOiAnICsgdGhpcy5jb25maWd1cmF0aW9uLmJ1dHRvblNpemUgKyAncHg7aGVpZ2h0OiAnICsgdGhpcy5jb25maWd1cmF0aW9uLmJ1dHRvblNpemUgKyAncHg7Ij48L2Rpdj4nKTsNCg0KICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICQoIiMiICsgY3VycmVudFRvb2xJblRoYXRPcmRlci5jb250YWluZXJJRCkuYmVmb3JlKCc8ZGl2IGNsYXNzPSJlci10YWItc2xpZGUtb3V0LWdyaWQtaXRlbSIgaWQ9IicgKyBjdXJyZW50Q29udGFpbmVySUQgKyAnIiBzdHlsZT0id2lkdGg6ICcgKyB0aGlzLmNvbmZpZ3VyYXRpb24uYnV0dG9uU2l6ZSArICdweDtoZWlnaHQ6ICcgKyB0aGlzLmNvbmZpZ3VyYXRpb24uYnV0dG9uU2l6ZSArICdweDsiPjwvZGl2PicpOw0KICAgICAgICAgICAgICAgICQoIiMiICsgY3VycmVudENvbnRhaW5lcklEKS5oaWRlKCk7DQogICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICQoIiMiICsgY3VycmVudENvbnRhaW5lcklEKS5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgICQoIiMiICsgY3VycmVudENvbnRhaW5lcklEKS5hZGRDbGFzcygidGFiLXNsaWRlLW91dC1hbmltYXRlZCIpOw0KICAgICAgICAgICAgICAgIH0sIDUwMCk7DQoNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy50b29sc0NvbnRhaW5lcnMuc3BsaWNlKG9yZGVyLCAwLCB0b29sSW5mbyk7DQoNCg0KICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgICBpZiAodHlwZW9mIG9yZGVyID09PSAidW5kZWZpbmVkIikgew0KDQogICAgICAgICAgICAgICAgJCgnI2VyLXRhYi1zbGlkZS1vdXQtZ3JpZC1jb250YWluZXInKS5hcHBlbmQoJzxkaXYgY2xhc3M9ImVyLXRhYi1zbGlkZS1vdXQtZ3JpZC1pdGVtIiBpZD0iJyArIGN1cnJlbnRDb250YWluZXJJRCArICciIHN0eWxlPSJ3aWR0aDogJyArIHRoaXMuY29uZmlndXJhdGlvbi5idXR0b25TaXplICsgJ3B4O2hlaWdodDogJyArIHRoaXMuY29uZmlndXJhdGlvbi5idXR0b25TaXplICsgJ3B4OyI+PC9kaXY+Jyk7DQoNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaWYgKCQoIiNlci10YWItc2xpZGUtb3V0IikuZXJUYWJTbGlkZU91dCgib3B0aW9uIiwgInBhbmVsVmlzaWJsZSIpKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgJCgnI2VyLXRhYi1zbGlkZS1vdXQtZ3JpZC1jb250YWluZXInKS5hcHBlbmQoJzxkaXYgY2xhc3M9ImVyLXRhYi1zbGlkZS1vdXQtZ3JpZC1pdGVtJyArIGFuaW1hdGVkQ1NTQ2xhc3MgKyAnIiBpZD0iJyArIGN1cnJlbnRDb250YWluZXJJRCArICciIHN0eWxlPSJ3aWR0aDogJyArIHRoaXMuY29uZmlndXJhdGlvbi5idXR0b25TaXplICsgJ3B4O2hlaWdodDogJyArIHRoaXMuY29uZmlndXJhdGlvbi5idXR0b25TaXplICsgJ3B4OyI+PC9kaXY+Jyk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICAkKCcjZXItdGFiLXNsaWRlLW91dC1ncmlkLWNvbnRhaW5lcicpLmFwcGVuZCgnPGRpdiBjbGFzcz0iZXItdGFiLXNsaWRlLW91dC1ncmlkLWl0ZW0iIGlkPSInICsgY3VycmVudENvbnRhaW5lcklEICsgJyIgc3R5bGU9IndpZHRoOiAnICsgdGhpcy5jb25maWd1cmF0aW9uLmJ1dHRvblNpemUgKyAncHg7aGVpZ2h0OiAnICsgdGhpcy5jb25maWd1cmF0aW9uLmJ1dHRvblNpemUgKyAncHg7Ij48L2Rpdj4nKTsNCiAgICAgICAgICAgICAgICAgICAgJCgiIyIgKyBjdXJyZW50Q29udGFpbmVySUQpLmhpZGUoKTsNCiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkKCIjIiArIGN1cnJlbnRDb250YWluZXJJRCkuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgJCgiIyIgKyBjdXJyZW50Q29udGFpbmVySUQpLmFkZENsYXNzKCJ0YWItc2xpZGUtb3V0LWFuaW1hdGVkIik7DQogICAgICAgICAgICAgICAgICAgIH0sIDUwMCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLnRvb2xzQ29udGFpbmVycy5wdXNoKHRvb2xJbmZvKTsNCg0KICAgICAgICB9DQogICAgICAgIHJldHVybiBjdXJyZW50Q29udGFpbmVySUQ7DQogICAgfQ0KDQogICAgcmVtb3ZlQ29udGFpbmVyRm9yVG9vbCh0b29sSUQpIHsNCg0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudG9vbHNDb250YWluZXJzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBpZiAodGhpcy50b29sc0NvbnRhaW5lcnNbaV0udG9vbElEID09PSB0b29sSUQpIHsNCg0KDQogICAgICAgICAgICAgICAgJCgnIycgKyB0aGlzLnRvb2xzQ29udGFpbmVyc1tpXS5jb250YWluZXJJRCkucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgdGhpcy50b29sc0NvbnRhaW5lcnMuc3BsaWNlKGksIDEpOw0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSRU1PVklORzoiICsgdG9vbElEKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICB0b29sc0xvYWRlZCgpIHsNCiAgICAgICAgLy8gaWYgdWkgaXMgaG9yaXpvbnRhbCwgYWRkIHNwZWNpYWwgYnV0dG9ucyBkaXJlY3RseSB0byB0aGUgc2xpZGUgb3V0IGdyaWQgY29udGFpbmVyDQogICAgICAgIGlmICh0aGlzLmNvbmZpZ3VyYXRpb24udGFiUG9zaXRpb25pbmcgPT09ICJ0b3AiIHx8IHRoaXMuY29uZmlndXJhdGlvbi50YWJQb3NpdGlvbmluZyA9PT0gImJvdHRvbSIpIHsNCiAgICAgICAgICAgICQoIiNlci10YWItc2xpZGUtb3V0LWdyaWQtY29udGFpbmVyIikuYXBwZW5kKCAgICANCiAgICAgICAgICAgICAgICAnPGRpdiBpZD0idGFiLXNsaWRlLW91dC1jb250YWluZXItc2V0dGluZ3MiIGNsYXNzPSJlci10YWItc2xpZGUtb3V0LWdyaWQtaXRlbSIgc3R5bGU9IndpZHRoOiAnICsgdGhpcy5jb25maWd1cmF0aW9uLmJ1dHRvblNpemUgKyAncHg7aGVpZ2h0OiAnICsgdGhpcy5jb25maWd1cmF0aW9uLmJ1dHRvblNpemUgKyAncHg7Ij4nICsgDQogICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGlkPSJlci10YWItc2xpZGUtb3V0LXNldHRpbmdzLWJ1dHRvbiIgY2xhc3M9ImVhc3ktcmVhZGluZy1idXR0b24iIG9uY2xpY2s9ImxvY2F0aW9uLmhyZWY9XCcnICsgZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLnNlcnZlclVSTCArICcvY2xpZW50L3dlbGNvbWVcJzsiPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgJzxpbWcgc3JjPSInICsgZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLnNlcnZlclVSTCArICcvY29tcG9uZW50cy91c2VyLWludGVyZmFjZS90YWItc2xpZGUtb3V0LzEuMC91aS9pbWFnZXMvc2V0dGluZ3MucG5nIiB0aXRsZT0iT3BlbnMgc2V0dGluZ3MiPicgKw0KICAgICAgICAgICAgICAgICAgICAnPC9idXR0b24+JyArIA0KICAgICAgICAgICAgICAgICc8L2Rpdj4nICsgDQogICAgICAgICAgICAgICAgJzxkaXYgaWQ9InRhYi1zbGlkZS1vdXQtY29udGFpbmVyLWZlZWRiYWNrIiBjbGFzcz0iZXItdGFiLXNsaWRlLW91dC1ncmlkLWl0ZW0iIHN0eWxlPSJ3aWR0aDogJyArIHRoaXMuY29uZmlndXJhdGlvbi5idXR0b25TaXplICsgJ3B4O2hlaWdodDogJyArIHRoaXMuY29uZmlndXJhdGlvbi5idXR0b25TaXplICsgJ3B4OyI+JyArIA0KICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiBpZD0iZXItdGFiLXNsaWRlLW91dC1mZWVkYmFja19idXR0b24iIGNsYXNzPSJlYXN5LXJlYWRpbmctYnV0dG9uIiBzdHlsZT0id2lkdGg6ICcgKyB0aGlzLmNvbmZpZ3VyYXRpb24uYnV0dG9uU2l6ZSArICdweDtoZWlnaHQ6ICcgKyB0aGlzLmNvbmZpZ3VyYXRpb24uYnV0dG9uU2l6ZSArICdweDsiPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgJzxpbWcgc3JjPSInICsgZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLnNlcnZlclVSTCArICcvY29tcG9uZW50cy91c2VyLWludGVyZmFjZS90YWItc2xpZGUtb3V0LzEuMC91aS9pbWFnZXMvZmVlZGJhY2sucG5nIiB0aXRsZT0iT3BlbnMgZmVlZGJhY2sgZm9ybSI+JyArDQogICAgICAgICAgICAgICAgICAgICc8L2J1dHRvbj4nICsgDQogICAgICAgICAgICAgICAgJzwvZGl2PicpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gaWYgbm90LCBwdXQgdGhlbSBpbiBhIHNlcGFyYXRlIGNvbnRhaW5lcg0KICAgICAgICAgICAgJCgiI2VyLXRhYi1zbGlkZS1vdXQiKS5hcHBlbmQoDQogICAgICAgICAgICAgICAgJzxkaXYgaWQ9ImVyLXRhYi1zbGlkZS1vdXQtc3BlY2lhbC1idXR0b24tY29udGFpbmVyIj4nICsgDQogICAgICAgICAgICAgICAgICAgICc8ZGl2IGlkPSJ0YWItc2xpZGUtb3V0LWNvbnRhaW5lci1zZXR0aW5ncyIgY2xhc3M9ImVyLXRhYi1zbGlkZS1vdXQtZ3JpZC1pdGVtIiBzdHlsZT0id2lkdGg6ICcgKyB0aGlzLmNvbmZpZ3VyYXRpb24uYnV0dG9uU2l6ZSArICdweDtoZWlnaHQ6ICcgKyB0aGlzLmNvbmZpZ3VyYXRpb24uYnV0dG9uU2l6ZSArICdweDsiPicgKyANCiAgICAgICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGlkPSJlci10YWItc2xpZGUtb3V0LXNldHRpbmdzLWJ1dHRvbiIgY2xhc3M9ImVhc3ktcmVhZGluZy1idXR0b24iIG9uY2xpY2s9ImxvY2F0aW9uLmhyZWY9XCcnICsgZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLnNlcnZlclVSTCArICcvY2xpZW50L3dlbGNvbWVcJzsiPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aW1nIHNyYz0iJyArIGVhc3lSZWFkaW5nLnVpQ29sbGVjdGlvbi5zZXJ2ZXJVUkwgKyAnL2NvbXBvbmVudHMvdXNlci1pbnRlcmZhY2UvdGFiLXNsaWRlLW91dC8xLjAvdWkvaW1hZ2VzL3NldHRpbmdzLnBuZyIgdGl0bGU9Ik9wZW5zIHNldHRpbmdzIj4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICc8L2J1dHRvbj4nICsgDQogICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nICsgDQogICAgICAgICAgICAgICAgICAgICc8ZGl2IGlkPSJ0YWItc2xpZGUtb3V0LWNvbnRhaW5lci1mZWVkYmFjayIgY2xhc3M9ImVyLXRhYi1zbGlkZS1vdXQtZ3JpZC1pdGVtIiBzdHlsZT0id2lkdGg6ICcgKyB0aGlzLmNvbmZpZ3VyYXRpb24uYnV0dG9uU2l6ZSArICdweDtoZWlnaHQ6ICcgKyB0aGlzLmNvbmZpZ3VyYXRpb24uYnV0dG9uU2l6ZSArICdweDsiPicgKyANCiAgICAgICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGlkPSJlci10YWItc2xpZGUtb3V0LWZlZWRiYWNrX2J1dHRvbiIgY2xhc3M9ImVhc3ktcmVhZGluZy1idXR0b24iIHN0eWxlPSJ3aWR0aDogJyArIHRoaXMuY29uZmlndXJhdGlvbi5idXR0b25TaXplICsgJ3B4O2hlaWdodDogJyArIHRoaXMuY29uZmlndXJhdGlvbi5idXR0b25TaXplICsgJ3B4OyI+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxpbWcgc3JjPSInICsgZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLnNlcnZlclVSTCArICcvY29tcG9uZW50cy91c2VyLWludGVyZmFjZS90YWItc2xpZGUtb3V0LzEuMC91aS9pbWFnZXMvZmVlZGJhY2sucG5nIiB0aXRsZT0iT3BlbnMgZmVlZGJhY2sgZm9ybSI+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAnPC9idXR0b24+JyArIA0KICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JyArDQogICAgICAgICAgICAgICAgJzwvZGl2PicpOw0KICAgICAgICB9DQoNCiAgICAgICAgJCgiI2VyLXRhYi1zbGlkZS1vdXQtc3BlY2lhbC1idXR0b24tY29udGFpbmVyIikuY3NzKCJncmlkLXRlbXBsYXRlLWNvbHVtbnMiLCB0aGlzLmNvbmZpZ3VyYXRpb24uYnV0dG9uU2l6ZSArICJweCAiICsgdGhpcy5jb25maWd1cmF0aW9uLmJ1dHRvblNpemUgKyAicHgiKTsgDQoNCiAgICAgICAgJCgiI2VyLXRhYi1zbGlkZS1vdXQtZmVlZGJhY2tfYnV0dG9uIikuY2xpY2soZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBmZWVkYmFja0Zvcm0uc2hvd0ZlZWRiYWNrRm9ybSgpOw0KICAgICAgICB9KTsNCg0KICAgICAgICAkKCIjZXItdGFiLXNsaWRlLW91dCIpLmVyVGFiU2xpZGVPdXQoInJlZnJlc2giKTsNCiAgICB9DQoNCiAgICByZW1vdmUoKXsNCiAgICAgICAgJCgiI2VyLXRhYi1zbGlkZS1vdXQiKS5yZW1vdmUoKTsNCiAgICB9DQoNCiAgICB1aVVwZGF0ZWQoKSB7DQogICAgICAgIGlmICghJCgiI2VyLXRhYi1zbGlkZS1vdXQiKS5lclRhYlNsaWRlT3V0KCJvcHRpb24iLCAicGFuZWxWaXNpYmxlIikpIHsNCiAgICAgICAgICAgICQoIiNlci10YWItc2xpZGUtb3V0IikuZXJUYWJTbGlkZU91dCgib3B0aW9uIiwgInBhbmVsVmlzaWJsZSIsIHRydWUpOw0KICAgICAgICB9DQogICAgICAgICQoIiNlci10YWItc2xpZGUtb3V0IikuZXJUYWJTbGlkZU91dCgidXBkYXRlUGFuZWwiKTsNCiAgICAgICAgJCgiI2VyLXRhYi1zbGlkZS1vdXQiKS5lclRhYlNsaWRlT3V0KCJhZGFwdFRvV2luZG93U2l6ZSIpOw0KICAgICAgICAkKCIjZXItdGFiLXNsaWRlLW91dCIpLmVyVGFiU2xpZGVPdXQoInJlZnJlc2giKTsNCiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAkKCIuZXItdGFiLXNsaWRlLW91dC1ncmlkLWl0ZW0iKS5yZW1vdmVDbGFzcygidGFiLXNsaWRlLW91dC1hbmltYXRlZCIpOw0KICAgICAgICB9LCAxMDAwKTsNCg0KICAgICAgICAkKCIjZXItdGFiLXNsaWRlLW91dC1zcGVjaWFsLWJ1dHRvbi1jb250YWluZXIiKS5jc3MoImdyaWQtdGVtcGxhdGUtY29sdW1ucyIsIHRoaXMuY29uZmlndXJhdGlvbi5idXR0b25TaXplICsgInB4ICIgKyB0aGlzLmNvbmZpZ3VyYXRpb24uYnV0dG9uU2l6ZSArICJweCIpOyANCiAgICB9DQoNCg0KfQ=="
                    },
                    {
                        "id": "ui/imagesloaded.pkgd.js",
                        "source": "LyohDQogKiBpbWFnZXNMb2FkZWQgUEFDS0FHRUQgdjQuMS40DQogKiBKYXZhU2NyaXB0IGlzIGFsbCBsaWtlICJZb3UgaW1hZ2VzIGFyZSBkb25lIHlldCBvciB3aGF0PyINCiAqIE1JVCBMaWNlbnNlDQogKi8NCg0KLyoqDQogKiBFdkVtaXR0ZXIgdjEuMS4wDQogKiBMaWwnIGV2ZW50IGVtaXR0ZXINCiAqIE1JVCBMaWNlbnNlDQogKi8NCg0KLyoganNoaW50IHVudXNlZDogdHJ1ZSwgdW5kZWY6IHRydWUsIHN0cmljdDogdHJ1ZSAqLw0KDQooIGZ1bmN0aW9uKCBnbG9iYWwsIGZhY3RvcnkgKSB7DQogICAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uDQogICAgLyoganNoaW50IHN0cmljdDogZmFsc2UgKi8gLyogZ2xvYmFscyBkZWZpbmUsIG1vZHVsZSwgd2luZG93ICovDQogICAgaWYgKCB0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCApIHsNCiAgICAgICAgLy8gQU1EIC0gUmVxdWlyZUpTDQogICAgICAgIGRlZmluZSggJ2V2LWVtaXR0ZXIvZXYtZW1pdHRlcicsZmFjdG9yeSApOw0KICAgIH0gZWxzZSBpZiAoIHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMgKSB7DQogICAgICAgIC8vIENvbW1vbkpTIC0gQnJvd3NlcmlmeSwgV2VicGFjaw0KICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBCcm93c2VyIGdsb2JhbHMNCiAgICAgICAgZ2xvYmFsLkV2RW1pdHRlciA9IGZhY3RvcnkoKTsNCiAgICB9DQoNCn0oIHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB0aGlzLCBmdW5jdGlvbigpIHsNCg0KDQoNCiAgICBmdW5jdGlvbiBFdkVtaXR0ZXIoKSB7fQ0KDQogICAgdmFyIHByb3RvID0gRXZFbWl0dGVyLnByb3RvdHlwZTsNCg0KICAgIHByb3RvLm9uID0gZnVuY3Rpb24oIGV2ZW50TmFtZSwgbGlzdGVuZXIgKSB7DQogICAgICAgIGlmICggIWV2ZW50TmFtZSB8fCAhbGlzdGVuZXIgKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgLy8gc2V0IGV2ZW50cyBoYXNoDQogICAgICAgIHZhciBldmVudHMgPSB0aGlzLl9ldmVudHMgPSB0aGlzLl9ldmVudHMgfHwge307DQogICAgICAgIC8vIHNldCBsaXN0ZW5lcnMgYXJyYXkNCiAgICAgICAgdmFyIGxpc3RlbmVycyA9IGV2ZW50c1sgZXZlbnROYW1lIF0gPSBldmVudHNbIGV2ZW50TmFtZSBdIHx8IFtdOw0KICAgICAgICAvLyBvbmx5IGFkZCBvbmNlDQogICAgICAgIGlmICggbGlzdGVuZXJzLmluZGV4T2YoIGxpc3RlbmVyICkgPT0gLTEgKSB7DQogICAgICAgICAgICBsaXN0ZW5lcnMucHVzaCggbGlzdGVuZXIgKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0aGlzOw0KICAgIH07DQoNCiAgICBwcm90by5vbmNlID0gZnVuY3Rpb24oIGV2ZW50TmFtZSwgbGlzdGVuZXIgKSB7DQogICAgICAgIGlmICggIWV2ZW50TmFtZSB8fCAhbGlzdGVuZXIgKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgLy8gYWRkIGV2ZW50DQogICAgICAgIHRoaXMub24oIGV2ZW50TmFtZSwgbGlzdGVuZXIgKTsNCiAgICAgICAgLy8gc2V0IG9uY2UgZmxhZw0KICAgICAgICAvLyBzZXQgb25jZUV2ZW50cyBoYXNoDQogICAgICAgIHZhciBvbmNlRXZlbnRzID0gdGhpcy5fb25jZUV2ZW50cyA9IHRoaXMuX29uY2VFdmVudHMgfHwge307DQogICAgICAgIC8vIHNldCBvbmNlTGlzdGVuZXJzIG9iamVjdA0KICAgICAgICB2YXIgb25jZUxpc3RlbmVycyA9IG9uY2VFdmVudHNbIGV2ZW50TmFtZSBdID0gb25jZUV2ZW50c1sgZXZlbnROYW1lIF0gfHwge307DQogICAgICAgIC8vIHNldCBmbGFnDQogICAgICAgIG9uY2VMaXN0ZW5lcnNbIGxpc3RlbmVyIF0gPSB0cnVlOw0KDQogICAgICAgIHJldHVybiB0aGlzOw0KICAgIH07DQoNCiAgICBwcm90by5vZmYgPSBmdW5jdGlvbiggZXZlbnROYW1lLCBsaXN0ZW5lciApIHsNCiAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50cyAmJiB0aGlzLl9ldmVudHNbIGV2ZW50TmFtZSBdOw0KICAgICAgICBpZiAoICFsaXN0ZW5lcnMgfHwgIWxpc3RlbmVycy5sZW5ndGggKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgdmFyIGluZGV4ID0gbGlzdGVuZXJzLmluZGV4T2YoIGxpc3RlbmVyICk7DQogICAgICAgIGlmICggaW5kZXggIT0gLTEgKSB7DQogICAgICAgICAgICBsaXN0ZW5lcnMuc3BsaWNlKCBpbmRleCwgMSApOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgfTsNCg0KICAgIHByb3RvLmVtaXRFdmVudCA9IGZ1bmN0aW9uKCBldmVudE5hbWUsIGFyZ3MgKSB7DQogICAgICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9ldmVudHMgJiYgdGhpcy5fZXZlbnRzWyBldmVudE5hbWUgXTsNCiAgICAgICAgaWYgKCAhbGlzdGVuZXJzIHx8ICFsaXN0ZW5lcnMubGVuZ3RoICkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIC8vIGNvcHkgb3ZlciB0byBhdm9pZCBpbnRlcmZlcmVuY2UgaWYgLm9mZigpIGluIGxpc3RlbmVyDQogICAgICAgIGxpc3RlbmVycyA9IGxpc3RlbmVycy5zbGljZSgwKTsNCiAgICAgICAgYXJncyA9IGFyZ3MgfHwgW107DQogICAgICAgIC8vIG9uY2Ugc3R1ZmYNCiAgICAgICAgdmFyIG9uY2VMaXN0ZW5lcnMgPSB0aGlzLl9vbmNlRXZlbnRzICYmIHRoaXMuX29uY2VFdmVudHNbIGV2ZW50TmFtZSBdOw0KDQogICAgICAgIGZvciAoIHZhciBpPTA7IGkgPCBsaXN0ZW5lcnMubGVuZ3RoOyBpKysgKSB7DQogICAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBsaXN0ZW5lcnNbaV0NCiAgICAgICAgICAgIHZhciBpc09uY2UgPSBvbmNlTGlzdGVuZXJzICYmIG9uY2VMaXN0ZW5lcnNbIGxpc3RlbmVyIF07DQogICAgICAgICAgICBpZiAoIGlzT25jZSApIHsNCiAgICAgICAgICAgICAgICAvLyByZW1vdmUgbGlzdGVuZXINCiAgICAgICAgICAgICAgICAvLyByZW1vdmUgYmVmb3JlIHRyaWdnZXIgdG8gcHJldmVudCByZWN1cnNpb24NCiAgICAgICAgICAgICAgICB0aGlzLm9mZiggZXZlbnROYW1lLCBsaXN0ZW5lciApOw0KICAgICAgICAgICAgICAgIC8vIHVuc2V0IG9uY2UgZmxhZw0KICAgICAgICAgICAgICAgIGRlbGV0ZSBvbmNlTGlzdGVuZXJzWyBsaXN0ZW5lciBdOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy8gdHJpZ2dlciBsaXN0ZW5lcg0KICAgICAgICAgICAgbGlzdGVuZXIuYXBwbHkoIHRoaXMsIGFyZ3MgKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0aGlzOw0KICAgIH07DQoNCiAgICBwcm90by5hbGxPZmYgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50czsNCiAgICAgICAgZGVsZXRlIHRoaXMuX29uY2VFdmVudHM7DQogICAgfTsNCg0KICAgIHJldHVybiBFdkVtaXR0ZXI7DQoNCn0pKTsNCg0KLyohDQogKiBpbWFnZXNMb2FkZWQgdjQuMS40DQogKiBKYXZhU2NyaXB0IGlzIGFsbCBsaWtlICJZb3UgaW1hZ2VzIGFyZSBkb25lIHlldCBvciB3aGF0PyINCiAqIE1JVCBMaWNlbnNlDQogKi8NCg0KKCBmdW5jdGlvbiggd2luZG93LCBmYWN0b3J5ICkgeyAndXNlIHN0cmljdCc7DQogICAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uDQoNCiAgICAvKmdsb2JhbCBkZWZpbmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlLCByZXF1aXJlOiBmYWxzZSAqLw0KDQogICAgaWYgKCB0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCApIHsNCiAgICAgICAgLy8gQU1EDQogICAgICAgIGRlZmluZSggWw0KICAgICAgICAgICAgJ2V2LWVtaXR0ZXIvZXYtZW1pdHRlcicNCiAgICAgICAgXSwgZnVuY3Rpb24oIEV2RW1pdHRlciApIHsNCiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5KCB3aW5kb3csIEV2RW1pdHRlciApOw0KICAgICAgICB9KTsNCiAgICB9IGVsc2UgaWYgKCB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkgew0KICAgICAgICAvLyBDb21tb25KUw0KICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoDQogICAgICAgICAgICB3aW5kb3csDQogICAgICAgICAgICByZXF1aXJlKCdldi1lbWl0dGVyJykNCiAgICAgICAgKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyBicm93c2VyIGdsb2JhbA0KICAgICAgICB3aW5kb3cuaW1hZ2VzTG9hZGVkID0gZmFjdG9yeSgNCiAgICAgICAgICAgIHdpbmRvdywNCiAgICAgICAgICAgIHdpbmRvdy5FdkVtaXR0ZXINCiAgICAgICAgKTsNCiAgICB9DQoNCn0pKCB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHRoaXMsDQoNCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICBmYWN0b3J5IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vDQoNCiAgICBmdW5jdGlvbiBmYWN0b3J5KCB3aW5kb3csIEV2RW1pdHRlciApIHsNCg0KDQoNCiAgICAgICAgdmFyICQgPSB3aW5kb3cualF1ZXJ5Ow0KICAgICAgICB2YXIgY29uc29sZSA9IHdpbmRvdy5jb25zb2xlOw0KDQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBoZWxwZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vDQoNCi8vIGV4dGVuZCBvYmplY3RzDQogICAgICAgIGZ1bmN0aW9uIGV4dGVuZCggYSwgYiApIHsNCiAgICAgICAgICAgIGZvciAoIHZhciBwcm9wIGluIGIgKSB7DQogICAgICAgICAgICAgICAgYVsgcHJvcCBdID0gYlsgcHJvcCBdOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGE7DQogICAgICAgIH0NCg0KICAgICAgICB2YXIgYXJyYXlTbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTsNCg0KLy8gdHVybiBlbGVtZW50IG9yIG5vZGVMaXN0IGludG8gYW4gYXJyYXkNCiAgICAgICAgZnVuY3Rpb24gbWFrZUFycmF5KCBvYmogKSB7DQogICAgICAgICAgICBpZiAoIEFycmF5LmlzQXJyYXkoIG9iaiApICkgew0KICAgICAgICAgICAgICAgIC8vIHVzZSBvYmplY3QgaWYgYWxyZWFkeSBhbiBhcnJheQ0KICAgICAgICAgICAgICAgIHJldHVybiBvYmo7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciBpc0FycmF5TGlrZSA9IHR5cGVvZiBvYmogPT0gJ29iamVjdCcgJiYgdHlwZW9mIG9iai5sZW5ndGggPT0gJ251bWJlcic7DQogICAgICAgICAgICBpZiAoIGlzQXJyYXlMaWtlICkgew0KICAgICAgICAgICAgICAgIC8vIGNvbnZlcnQgbm9kZUxpc3QgdG8gYXJyYXkNCiAgICAgICAgICAgICAgICByZXR1cm4gYXJyYXlTbGljZS5jYWxsKCBvYmogKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gYXJyYXkgb2Ygc2luZ2xlIGluZGV4DQogICAgICAgICAgICByZXR1cm4gWyBvYmogXTsNCiAgICAgICAgfQ0KDQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBpbWFnZXNMb2FkZWQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy8NCg0KICAgICAgICAvKioNCiAgICAgICAgICogQHBhcmFtIHtBcnJheSwgRWxlbWVudCwgTm9kZUxpc3QsIFN0cmluZ30gZWxlbQ0KICAgICAgICAgKiBAcGFyYW0ge09iamVjdCBvciBGdW5jdGlvbn0gb3B0aW9ucyAtIGlmIGZ1bmN0aW9uLCB1c2UgYXMgY2FsbGJhY2sNCiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25BbHdheXMgLSBjYWxsYmFjayBmdW5jdGlvbg0KICAgICAgICAgKi8NCiAgICAgICAgZnVuY3Rpb24gSW1hZ2VzTG9hZGVkKCBlbGVtLCBvcHRpb25zLCBvbkFsd2F5cyApIHsNCiAgICAgICAgICAgIC8vIGNvZXJjZSBJbWFnZXNMb2FkZWQoKSB3aXRob3V0IG5ldywgdG8gYmUgbmV3IEltYWdlc0xvYWRlZCgpDQogICAgICAgICAgICBpZiAoICEoIHRoaXMgaW5zdGFuY2VvZiBJbWFnZXNMb2FkZWQgKSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEltYWdlc0xvYWRlZCggZWxlbSwgb3B0aW9ucywgb25BbHdheXMgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8vIHVzZSBlbGVtIGFzIHNlbGVjdG9yIHN0cmluZw0KICAgICAgICAgICAgdmFyIHF1ZXJ5RWxlbSA9IGVsZW07DQogICAgICAgICAgICBpZiAoIHR5cGVvZiBlbGVtID09ICdzdHJpbmcnICkgew0KICAgICAgICAgICAgICAgIHF1ZXJ5RWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIGVsZW0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8vIGJhaWwgaWYgYmFkIGVsZW1lbnQNCiAgICAgICAgICAgIGlmICggIXF1ZXJ5RWxlbSApIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCAnQmFkIGVsZW1lbnQgZm9yIGltYWdlc0xvYWRlZCAnICsgKCBxdWVyeUVsZW0gfHwgZWxlbSApICk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLmVsZW1lbnRzID0gbWFrZUFycmF5KCBxdWVyeUVsZW0gKTsNCiAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCgge30sIHRoaXMub3B0aW9ucyApOw0KICAgICAgICAgICAgLy8gc2hpZnQgYXJndW1lbnRzIGlmIG5vIG9wdGlvbnMgc2V0DQogICAgICAgICAgICBpZiAoIHR5cGVvZiBvcHRpb25zID09ICdmdW5jdGlvbicgKSB7DQogICAgICAgICAgICAgICAgb25BbHdheXMgPSBvcHRpb25zOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBleHRlbmQoIHRoaXMub3B0aW9ucywgb3B0aW9ucyApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIG9uQWx3YXlzICkgew0KICAgICAgICAgICAgICAgIHRoaXMub24oICdhbHdheXMnLCBvbkFsd2F5cyApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLmdldEltYWdlcygpOw0KDQogICAgICAgICAgICBpZiAoICQgKSB7DQogICAgICAgICAgICAgICAgLy8gYWRkIGpRdWVyeSBEZWZlcnJlZCBvYmplY3QNCiAgICAgICAgICAgICAgICB0aGlzLmpxRGVmZXJyZWQgPSBuZXcgJC5EZWZlcnJlZCgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBIQUNLIGNoZWNrIGFzeW5jIHRvIGFsbG93IHRpbWUgdG8gYmluZCBsaXN0ZW5lcnMNCiAgICAgICAgICAgIHNldFRpbWVvdXQoIHRoaXMuY2hlY2suYmluZCggdGhpcyApICk7DQogICAgICAgIH0NCg0KICAgICAgICBJbWFnZXNMb2FkZWQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggRXZFbWl0dGVyLnByb3RvdHlwZSApOw0KDQogICAgICAgIEltYWdlc0xvYWRlZC5wcm90b3R5cGUub3B0aW9ucyA9IHt9Ow0KDQogICAgICAgIEltYWdlc0xvYWRlZC5wcm90b3R5cGUuZ2V0SW1hZ2VzID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLmltYWdlcyA9IFtdOw0KDQogICAgICAgICAgICAvLyBmaWx0ZXIgJiBmaW5kIGl0ZW1zIGlmIHdlIGhhdmUgYW4gaXRlbSBzZWxlY3Rvcg0KICAgICAgICAgICAgdGhpcy5lbGVtZW50cy5mb3JFYWNoKCB0aGlzLmFkZEVsZW1lbnRJbWFnZXMsIHRoaXMgKTsNCiAgICAgICAgfTsNCg0KICAgICAgICAvKioNCiAgICAgICAgICogQHBhcmFtIHtOb2RlfSBlbGVtZW50DQogICAgICAgICAqLw0KICAgICAgICBJbWFnZXNMb2FkZWQucHJvdG90eXBlLmFkZEVsZW1lbnRJbWFnZXMgPSBmdW5jdGlvbiggZWxlbSApIHsNCiAgICAgICAgICAgIC8vIGZpbHRlciBzaWJsaW5ncw0KICAgICAgICAgICAgaWYgKCBlbGVtLm5vZGVOYW1lID09ICdJTUcnICkgew0KICAgICAgICAgICAgICAgIHRoaXMuYWRkSW1hZ2UoIGVsZW0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8vIGdldCBiYWNrZ3JvdW5kIGltYWdlIG9uIGVsZW1lbnQNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmJhY2tncm91bmQgPT09IHRydWUgKSB7DQogICAgICAgICAgICAgICAgdGhpcy5hZGRFbGVtZW50QmFja2dyb3VuZEltYWdlcyggZWxlbSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBmaW5kIGNoaWxkcmVuDQogICAgICAgICAgICAvLyBubyBub24tZWxlbWVudCBub2RlcywgIzE0Mw0KICAgICAgICAgICAgdmFyIG5vZGVUeXBlID0gZWxlbS5ub2RlVHlwZTsNCiAgICAgICAgICAgIGlmICggIW5vZGVUeXBlIHx8ICFlbGVtZW50Tm9kZVR5cGVzWyBub2RlVHlwZSBdICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBjaGlsZEltZ3MgPSBlbGVtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2ltZycpOw0KICAgICAgICAgICAgLy8gY29uY2F0IGNoaWxkRWxlbXMgdG8gZmlsdGVyRm91bmQgYXJyYXkNCiAgICAgICAgICAgIGZvciAoIHZhciBpPTA7IGkgPCBjaGlsZEltZ3MubGVuZ3RoOyBpKysgKSB7DQogICAgICAgICAgICAgICAgdmFyIGltZyA9IGNoaWxkSW1nc1tpXTsNCiAgICAgICAgICAgICAgICB0aGlzLmFkZEltYWdlKCBpbWcgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gZ2V0IGNoaWxkIGJhY2tncm91bmQgaW1hZ2VzDQogICAgICAgICAgICBpZiAoIHR5cGVvZiB0aGlzLm9wdGlvbnMuYmFja2dyb3VuZCA9PSAnc3RyaW5nJyApIHsNCiAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW4gPSBlbGVtLnF1ZXJ5U2VsZWN0b3JBbGwoIHRoaXMub3B0aW9ucy5iYWNrZ3JvdW5kICk7DQogICAgICAgICAgICAgICAgZm9yICggaT0wOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKysgKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IGNoaWxkcmVuW2ldOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZEVsZW1lbnRCYWNrZ3JvdW5kSW1hZ2VzKCBjaGlsZCApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCg0KICAgICAgICB2YXIgZWxlbWVudE5vZGVUeXBlcyA9IHsNCiAgICAgICAgICAgIDE6IHRydWUsDQogICAgICAgICAgICA5OiB0cnVlLA0KICAgICAgICAgICAgMTE6IHRydWUNCiAgICAgICAgfTsNCg0KICAgICAgICBJbWFnZXNMb2FkZWQucHJvdG90eXBlLmFkZEVsZW1lbnRCYWNrZ3JvdW5kSW1hZ2VzID0gZnVuY3Rpb24oIGVsZW0gKSB7DQogICAgICAgICAgICB2YXIgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKCBlbGVtICk7DQogICAgICAgICAgICBpZiAoICFzdHlsZSApIHsNCiAgICAgICAgICAgICAgICAvLyBGaXJlZm94IHJldHVybnMgbnVsbCBpZiBpbiBhIGhpZGRlbiBpZnJhbWUgaHR0cHM6Ly9idWd6aWwubGEvNTQ4Mzk3DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy8gZ2V0IHVybCBpbnNpZGUgdXJsKCIuLi4iKQ0KICAgICAgICAgICAgdmFyIHJlVVJMID0gL3VybFwoKFsnIl0pPyguKj8pXDFcKS9naTsNCiAgICAgICAgICAgIHZhciBtYXRjaGVzID0gcmVVUkwuZXhlYyggc3R5bGUuYmFja2dyb3VuZEltYWdlICk7DQogICAgICAgICAgICB3aGlsZSAoIG1hdGNoZXMgIT09IG51bGwgKSB7DQogICAgICAgICAgICAgICAgdmFyIHVybCA9IG1hdGNoZXMgJiYgbWF0Y2hlc1syXTsNCiAgICAgICAgICAgICAgICBpZiAoIHVybCApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRCYWNrZ3JvdW5kKCB1cmwsIGVsZW0gKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgbWF0Y2hlcyA9IHJlVVJMLmV4ZWMoIHN0eWxlLmJhY2tncm91bmRJbWFnZSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBAcGFyYW0ge0ltYWdlfSBpbWcNCiAgICAgICAgICovDQogICAgICAgIEltYWdlc0xvYWRlZC5wcm90b3R5cGUuYWRkSW1hZ2UgPSBmdW5jdGlvbiggaW1nICkgew0KICAgICAgICAgICAgdmFyIGxvYWRpbmdJbWFnZSA9IG5ldyBMb2FkaW5nSW1hZ2UoIGltZyApOw0KICAgICAgICAgICAgdGhpcy5pbWFnZXMucHVzaCggbG9hZGluZ0ltYWdlICk7DQogICAgICAgIH07DQoNCiAgICAgICAgSW1hZ2VzTG9hZGVkLnByb3RvdHlwZS5hZGRCYWNrZ3JvdW5kID0gZnVuY3Rpb24oIHVybCwgZWxlbSApIHsNCiAgICAgICAgICAgIHZhciBiYWNrZ3JvdW5kID0gbmV3IEJhY2tncm91bmQoIHVybCwgZWxlbSApOw0KICAgICAgICAgICAgdGhpcy5pbWFnZXMucHVzaCggYmFja2dyb3VuZCApOw0KICAgICAgICB9Ow0KDQogICAgICAgIEltYWdlc0xvYWRlZC5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICAgICAgICB0aGlzLnByb2dyZXNzZWRDb3VudCA9IDA7DQogICAgICAgICAgICB0aGlzLmhhc0FueUJyb2tlbiA9IGZhbHNlOw0KICAgICAgICAgICAgLy8gY29tcGxldGUgaWYgbm8gaW1hZ2VzDQogICAgICAgICAgICBpZiAoICF0aGlzLmltYWdlcy5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgdGhpcy5jb21wbGV0ZSgpOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZnVuY3Rpb24gb25Qcm9ncmVzcyggaW1hZ2UsIGVsZW0sIG1lc3NhZ2UgKSB7DQogICAgICAgICAgICAgICAgLy8gSEFDSyAtIENocm9tZSB0cmlnZ2VycyBldmVudCBiZWZvcmUgb2JqZWN0IHByb3BlcnRpZXMgaGF2ZSBjaGFuZ2VkLiAjODMNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgX3RoaXMucHJvZ3Jlc3MoIGltYWdlLCBlbGVtLCBtZXNzYWdlICk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuaW1hZ2VzLmZvckVhY2goIGZ1bmN0aW9uKCBsb2FkaW5nSW1hZ2UgKSB7DQogICAgICAgICAgICAgICAgbG9hZGluZ0ltYWdlLm9uY2UoICdwcm9ncmVzcycsIG9uUHJvZ3Jlc3MgKTsNCiAgICAgICAgICAgICAgICBsb2FkaW5nSW1hZ2UuY2hlY2soKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9Ow0KDQogICAgICAgIEltYWdlc0xvYWRlZC5wcm90b3R5cGUucHJvZ3Jlc3MgPSBmdW5jdGlvbiggaW1hZ2UsIGVsZW0sIG1lc3NhZ2UgKSB7DQogICAgICAgICAgICB0aGlzLnByb2dyZXNzZWRDb3VudCsrOw0KICAgICAgICAgICAgdGhpcy5oYXNBbnlCcm9rZW4gPSB0aGlzLmhhc0FueUJyb2tlbiB8fCAhaW1hZ2UuaXNMb2FkZWQ7DQogICAgICAgICAgICAvLyBwcm9ncmVzcyBldmVudA0KICAgICAgICAgICAgdGhpcy5lbWl0RXZlbnQoICdwcm9ncmVzcycsIFsgdGhpcywgaW1hZ2UsIGVsZW0gXSApOw0KICAgICAgICAgICAgaWYgKCB0aGlzLmpxRGVmZXJyZWQgJiYgdGhpcy5qcURlZmVycmVkLm5vdGlmeSApIHsNCiAgICAgICAgICAgICAgICB0aGlzLmpxRGVmZXJyZWQubm90aWZ5KCB0aGlzLCBpbWFnZSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy8gY2hlY2sgaWYgY29tcGxldGVkDQogICAgICAgICAgICBpZiAoIHRoaXMucHJvZ3Jlc3NlZENvdW50ID09IHRoaXMuaW1hZ2VzLmxlbmd0aCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLmNvbXBsZXRlKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmRlYnVnICYmIGNvbnNvbGUgKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coICdwcm9ncmVzczogJyArIG1lc3NhZ2UsIGltYWdlLCBlbGVtICk7DQogICAgICAgICAgICB9DQogICAgICAgIH07DQoNCiAgICAgICAgSW1hZ2VzTG9hZGVkLnByb3RvdHlwZS5jb21wbGV0ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGV2ZW50TmFtZSA9IHRoaXMuaGFzQW55QnJva2VuID8gJ2ZhaWwnIDogJ2RvbmUnOw0KICAgICAgICAgICAgdGhpcy5pc0NvbXBsZXRlID0gdHJ1ZTsNCiAgICAgICAgICAgIHRoaXMuZW1pdEV2ZW50KCBldmVudE5hbWUsIFsgdGhpcyBdICk7DQogICAgICAgICAgICB0aGlzLmVtaXRFdmVudCggJ2Fsd2F5cycsIFsgdGhpcyBdICk7DQogICAgICAgICAgICBpZiAoIHRoaXMuanFEZWZlcnJlZCApIHsNCiAgICAgICAgICAgICAgICB2YXIganFNZXRob2QgPSB0aGlzLmhhc0FueUJyb2tlbiA/ICdyZWplY3QnIDogJ3Jlc29sdmUnOw0KICAgICAgICAgICAgICAgIHRoaXMuanFEZWZlcnJlZFsganFNZXRob2QgXSggdGhpcyApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KDQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy8NCg0KICAgICAgICBmdW5jdGlvbiBMb2FkaW5nSW1hZ2UoIGltZyApIHsNCiAgICAgICAgICAgIHRoaXMuaW1nID0gaW1nOw0KICAgICAgICB9DQoNCiAgICAgICAgTG9hZGluZ0ltYWdlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIEV2RW1pdHRlci5wcm90b3R5cGUgKTsNCg0KICAgICAgICBMb2FkaW5nSW1hZ2UucHJvdG90eXBlLmNoZWNrID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAvLyBJZiBjb21wbGV0ZSBpcyB0cnVlIGFuZCBicm93c2VyIHN1cHBvcnRzIG5hdHVyYWwgc2l6ZXMsDQogICAgICAgICAgICAvLyB0cnkgdG8gY2hlY2sgZm9yIGltYWdlIHN0YXR1cyBtYW51YWxseS4NCiAgICAgICAgICAgIHZhciBpc0NvbXBsZXRlID0gdGhpcy5nZXRJc0ltYWdlQ29tcGxldGUoKTsNCiAgICAgICAgICAgIGlmICggaXNDb21wbGV0ZSApIHsNCiAgICAgICAgICAgICAgICAvLyByZXBvcnQgYmFzZWQgb24gbmF0dXJhbFdpZHRoDQogICAgICAgICAgICAgICAgdGhpcy5jb25maXJtKCB0aGlzLmltZy5uYXR1cmFsV2lkdGggIT09IDAsICduYXR1cmFsV2lkdGgnICk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBJZiBub25lIG9mIHRoZSBjaGVja3MgYWJvdmUgbWF0Y2hlZCwgc2ltdWxhdGUgbG9hZGluZyBvbiBkZXRhY2hlZCBlbGVtZW50Lg0KICAgICAgICAgICAgdGhpcy5wcm94eUltYWdlID0gbmV3IEltYWdlKCk7DQogICAgICAgICAgICB0aGlzLnByb3h5SW1hZ2UuYWRkRXZlbnRMaXN0ZW5lciggJ2xvYWQnLCB0aGlzICk7DQogICAgICAgICAgICB0aGlzLnByb3h5SW1hZ2UuYWRkRXZlbnRMaXN0ZW5lciggJ2Vycm9yJywgdGhpcyApOw0KICAgICAgICAgICAgLy8gYmluZCB0byBpbWFnZSBhcyB3ZWxsIGZvciBGaXJlZm94LiAjMTkxDQogICAgICAgICAgICB0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKCAnbG9hZCcsIHRoaXMgKTsNCiAgICAgICAgICAgIHRoaXMuaW1nLmFkZEV2ZW50TGlzdGVuZXIoICdlcnJvcicsIHRoaXMgKTsNCiAgICAgICAgICAgIHRoaXMucHJveHlJbWFnZS5zcmMgPSB0aGlzLmltZy5zcmM7DQogICAgICAgIH07DQoNCiAgICAgICAgTG9hZGluZ0ltYWdlLnByb3RvdHlwZS5nZXRJc0ltYWdlQ29tcGxldGUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIC8vIGNoZWNrIGZvciBub24temVybywgbm9uLXVuZGVmaW5lZCBuYXR1cmFsV2lkdGgNCiAgICAgICAgICAgIC8vIGZpeGVzIFNhZmFyaStJbmZpbml0ZVNjcm9sbCtNYXNvbnJ5IGJ1ZyBpbmZpbml0ZS1zY3JvbGwjNjcxDQogICAgICAgICAgICByZXR1cm4gdGhpcy5pbWcuY29tcGxldGUgJiYgdGhpcy5pbWcubmF0dXJhbFdpZHRoOw0KICAgICAgICB9Ow0KDQogICAgICAgIExvYWRpbmdJbWFnZS5wcm90b3R5cGUuY29uZmlybSA9IGZ1bmN0aW9uKCBpc0xvYWRlZCwgbWVzc2FnZSApIHsNCiAgICAgICAgICAgIHRoaXMuaXNMb2FkZWQgPSBpc0xvYWRlZDsNCiAgICAgICAgICAgIHRoaXMuZW1pdEV2ZW50KCAncHJvZ3Jlc3MnLCBbIHRoaXMsIHRoaXMuaW1nLCBtZXNzYWdlIF0gKTsNCiAgICAgICAgfTsNCg0KLy8gLS0tLS0gZXZlbnRzIC0tLS0tIC8vDQoNCi8vIHRyaWdnZXIgc3BlY2lmaWVkIGhhbmRsZXIgZm9yIGV2ZW50IHR5cGUNCiAgICAgICAgTG9hZGluZ0ltYWdlLnByb3RvdHlwZS5oYW5kbGVFdmVudCA9IGZ1bmN0aW9uKCBldmVudCApIHsNCiAgICAgICAgICAgIHZhciBtZXRob2QgPSAnb24nICsgZXZlbnQudHlwZTsNCiAgICAgICAgICAgIGlmICggdGhpc1sgbWV0aG9kIF0gKSB7DQogICAgICAgICAgICAgICAgdGhpc1sgbWV0aG9kIF0oIGV2ZW50ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH07DQoNCiAgICAgICAgTG9hZGluZ0ltYWdlLnByb3RvdHlwZS5vbmxvYWQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMuY29uZmlybSggdHJ1ZSwgJ29ubG9hZCcgKTsNCiAgICAgICAgICAgIHRoaXMudW5iaW5kRXZlbnRzKCk7DQogICAgICAgIH07DQoNCiAgICAgICAgTG9hZGluZ0ltYWdlLnByb3RvdHlwZS5vbmVycm9yID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLmNvbmZpcm0oIGZhbHNlLCAnb25lcnJvcicgKTsNCiAgICAgICAgICAgIHRoaXMudW5iaW5kRXZlbnRzKCk7DQogICAgICAgIH07DQoNCiAgICAgICAgTG9hZGluZ0ltYWdlLnByb3RvdHlwZS51bmJpbmRFdmVudHMgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHRoaXMucHJveHlJbWFnZS5yZW1vdmVFdmVudExpc3RlbmVyKCAnbG9hZCcsIHRoaXMgKTsNCiAgICAgICAgICAgIHRoaXMucHJveHlJbWFnZS5yZW1vdmVFdmVudExpc3RlbmVyKCAnZXJyb3InLCB0aGlzICk7DQogICAgICAgICAgICB0aGlzLmltZy5yZW1vdmVFdmVudExpc3RlbmVyKCAnbG9hZCcsIHRoaXMgKTsNCiAgICAgICAgICAgIHRoaXMuaW1nLnJlbW92ZUV2ZW50TGlzdGVuZXIoICdlcnJvcicsIHRoaXMgKTsNCiAgICAgICAgfTsNCg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQmFja2dyb3VuZCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvLw0KDQogICAgICAgIGZ1bmN0aW9uIEJhY2tncm91bmQoIHVybCwgZWxlbWVudCApIHsNCiAgICAgICAgICAgIHRoaXMudXJsID0gdXJsOw0KICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDsNCiAgICAgICAgICAgIHRoaXMuaW1nID0gbmV3IEltYWdlKCk7DQogICAgICAgIH0NCg0KLy8gaW5oZXJpdCBMb2FkaW5nSW1hZ2UgcHJvdG90eXBlDQogICAgICAgIEJhY2tncm91bmQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggTG9hZGluZ0ltYWdlLnByb3RvdHlwZSApOw0KDQogICAgICAgIEJhY2tncm91bmQucHJvdG90eXBlLmNoZWNrID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKCAnbG9hZCcsIHRoaXMgKTsNCiAgICAgICAgICAgIHRoaXMuaW1nLmFkZEV2ZW50TGlzdGVuZXIoICdlcnJvcicsIHRoaXMgKTsNCiAgICAgICAgICAgIHRoaXMuaW1nLnNyYyA9IHRoaXMudXJsOw0KICAgICAgICAgICAgLy8gY2hlY2sgaWYgaW1hZ2UgaXMgYWxyZWFkeSBjb21wbGV0ZQ0KICAgICAgICAgICAgdmFyIGlzQ29tcGxldGUgPSB0aGlzLmdldElzSW1hZ2VDb21wbGV0ZSgpOw0KICAgICAgICAgICAgaWYgKCBpc0NvbXBsZXRlICkgew0KICAgICAgICAgICAgICAgIHRoaXMuY29uZmlybSggdGhpcy5pbWcubmF0dXJhbFdpZHRoICE9PSAwLCAnbmF0dXJhbFdpZHRoJyApOw0KICAgICAgICAgICAgICAgIHRoaXMudW5iaW5kRXZlbnRzKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH07DQoNCiAgICAgICAgQmFja2dyb3VuZC5wcm90b3R5cGUudW5iaW5kRXZlbnRzID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB0aGlzLmltZy5yZW1vdmVFdmVudExpc3RlbmVyKCAnbG9hZCcsIHRoaXMgKTsNCiAgICAgICAgICAgIHRoaXMuaW1nLnJlbW92ZUV2ZW50TGlzdGVuZXIoICdlcnJvcicsIHRoaXMgKTsNCiAgICAgICAgfTsNCg0KICAgICAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5jb25maXJtID0gZnVuY3Rpb24oIGlzTG9hZGVkLCBtZXNzYWdlICkgew0KICAgICAgICAgICAgdGhpcy5pc0xvYWRlZCA9IGlzTG9hZGVkOw0KICAgICAgICAgICAgdGhpcy5lbWl0RXZlbnQoICdwcm9ncmVzcycsIFsgdGhpcywgdGhpcy5lbGVtZW50LCBtZXNzYWdlIF0gKTsNCiAgICAgICAgfTsNCg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0galF1ZXJ5IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vDQoNCiAgICAgICAgSW1hZ2VzTG9hZGVkLm1ha2VKUXVlcnlQbHVnaW4gPSBmdW5jdGlvbiggalF1ZXJ5ICkgew0KICAgICAgICAgICAgalF1ZXJ5ID0galF1ZXJ5IHx8IHdpbmRvdy5qUXVlcnk7DQogICAgICAgICAgICBpZiAoICFqUXVlcnkgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy8gc2V0IGxvY2FsIHZhcmlhYmxlDQogICAgICAgICAgICAkID0galF1ZXJ5Ow0KICAgICAgICAgICAgLy8gJCgpLmltYWdlc0xvYWRlZCgpDQogICAgICAgICAgICAkLmZuLmltYWdlc0xvYWRlZCA9IGZ1bmN0aW9uKCBvcHRpb25zLCBjYWxsYmFjayApIHsNCiAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBuZXcgSW1hZ2VzTG9hZGVkKCB0aGlzLCBvcHRpb25zLCBjYWxsYmFjayApOw0KICAgICAgICAgICAgICAgIHJldHVybiBpbnN0YW5jZS5qcURlZmVycmVkLnByb21pc2UoICQodGhpcykgKTsNCiAgICAgICAgICAgIH07DQogICAgICAgIH07DQovLyB0cnkgbWFraW5nIHBsdWdpbg0KICAgICAgICBJbWFnZXNMb2FkZWQubWFrZUpRdWVyeVBsdWdpbigpOw0KDQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy8NCg0KICAgICAgICByZXR1cm4gSW1hZ2VzTG9hZGVkOw0KDQogICAgfSk7DQo="
                    },
                    {
                        "id": "ui/erMobileToolTips.js",
                        "source": "Ly8gZGlzbGF5cyB0b29sdGlwcyBvbiB0b3VjaC1ob2xkIGZvciBhbGwgZWxlbWVudHMgaW5zaWRlIGEgZ2l2ZW4gcGFyZW50LU9iamVjdCwgaWYgdGhleSBjb250YWluIGEgInRpdGxlIi1hdHRyaWJ1dGUNCi8vIHVzYWdlOiBzaW1wbHkgY2FsbCBjb25zdHJ1Y3RvciB3aXRoIGEgalF1ZXJ5IE9iamVjdCBjb250YWluaW5nIHRoZSBlbGVtZW50cyB0aGF0IG1pZ2h0IG5lZWQgdG9vbHRpcHMgZGlzcGxheWVkIGFzIGFuIGFyZ3VtZW50DQoNCmNsYXNzIGVyTW9iaWxlVG9vbFRpcHMgew0KICAgIGNvbnN0cnVjdG9yKHBhcmVudE9iaikgeyAvLyBwYXJlbnRPYmogaXMgYSBqUXVlcnktT2JqZWN0IGNvbnRhaW5pbmcgdGhlIGVsZW1lbnRzIHRoYXQgbWlnaHQgbmVlZCB0b29sdGlwcyBkaXNwbGF5ZWQNCiAgICAgICAgbGV0IHN0b3BCdWJibGVGb3JDbGljayA9IGZhbHNlOw0KDQogICAgICAgIGxldCBzaG93VG9vbFRpcCA9IGZ1bmN0aW9uKGV2dCwgZG9tT2JqKSB7DQogICAgICAgICAgICAvLyBmaXJzdCByZW1vdmUgb3RoZXIgdG9vbHRpcHMgdGhhdCBtaWdodCBiZSBhY3RpdmUNCiAgICAgICAgICAgICQoZG9jdW1lbnQpLmZpbmQoJy5lclRvb2xUaXAnKS5yZW1vdmUoKTsNCiAgICAgICAgICAgIC8vIHRoZW4gYWRkIHRoZSBuZXcgb25lDQogICAgICAgICAgICBsZXQgdG9vbFRpcFkgPSBNYXRoLnJvdW5kKGV2dC50b3VjaGVzWzBdLmNsaWVudFkgLSAkKCcjZXItdGFiLXNsaWRlLW91dCcpLm9mZnNldCgpLnRvcCkgLSAzMDsNCiAgICAgICAgICAgICQoZG9tT2JqKS5wYXJlbnQoKS5hcHBlbmQoJzxkaXYgY2xhc3M9ImVyVG9vbFRpcCIgc3R5bGU9IiB0b3A6ICcgKyB0b29sVGlwWSArICdweDsiPicgKyAkKGRvbU9iaikuYXR0cigndGl0bGUnKSArICc8L2Rpdj4nKTsNCiAgICAgICAgICAgIHN0b3BCdWJibGVGb3JDbGljayA9IHRydWU7DQogICAgICAgICAgICAkKGRvbU9iaikubmV4dCgpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2dCkgew0KICAgICAgICAgICAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgICAgICBpZiAoc3RvcEJ1YmJsZUZvckNsaWNrKSB7DQogICAgICAgICAgICAgICAgICAgIHN0b3BCdWJibGVGb3JDbGljayA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7ICANCiAgICAgICAgfTsNCiAgICAgICAgDQogICAgICAgIGxldCBvYmpBcnJheSA9IHBhcmVudE9iai5maW5kKCJbdGl0bGVdIik7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb2JqQXJyYXkubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGxldCB0aW1lcjsNCiAgICAgICAgICAgIGxldCB0b3VjaER1cmF0aW9uID0gMTAwMDsNCiAgICAgICAgICAgIGxldCBjdXJPYmogPSBvYmpBcnJheVtpXTsNCiAgICAgICAgICAgICQoY3VyT2JqKS5vbigndG91Y2hzdGFydCcsIGZ1bmN0aW9uKGV2dCkgew0KICAgICAgICAgICAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93VG9vbFRpcChldnQsIGN1ck9iaik7DQogICAgICAgICAgICAgICAgICAgICAgICB9LCB0b3VjaER1cmF0aW9uKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgJChjdXJPYmopLm9uKCd0b3VjaGVuZCcsIGZ1bmN0aW9uKGV2dCkgew0KICAgICAgICAgICAgICAgIGlmICh0aW1lcikgY2xlYXJUaW1lb3V0KHRpbWVyKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgJChjdXJPYmopLm9uKCd0b3VjaG1vdmUnLCBmdW5jdGlvbihldnQpIHsNCiAgICAgICAgICAgICAgICBpZiAodGltZXIpIGNsZWFyVGltZW91dCh0aW1lcik7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICQoY3VyT2JqKS5vbignY2xpY2snLCBmdW5jdGlvbihldnQpIHsNCiAgICAgICAgICAgICAgICBpZiAoc3RvcEJ1YmJsZUZvckNsaWNrKSB7DQogICAgICAgICAgICAgICAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgc3RvcEJ1YmJsZUZvckNsaWNrID0gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZ0KSB7DQogICAgICAgICAgICAkKGRvY3VtZW50KS5maW5kKCcuZXJUb29sVGlwJykucmVtb3ZlKCk7DQogICAgICAgIH0pOw0KICAgIH0NCiAgICANCiAgICANCn0="
                    }
                ],
                "contentCSS": [
                    {
                        "id": "ui/jquery-ui.css",
                        "css": "LyohIGpRdWVyeSBVSSAtIHYxLjEyLjEgLSAyMDE2LTA5LTE0DQoqIGh0dHA6Ly9qcXVlcnl1aS5jb20NCiogSW5jbHVkZXM6IGNvcmUuY3NzLCBhY2NvcmRpb24uY3NzLCBhdXRvY29tcGxldGUuY3NzLCBtZW51LmNzcywgYnV0dG9uLmNzcywgY29udHJvbGdyb3VwLmNzcywgY2hlY2tib3hyYWRpby5jc3MsIGRhdGVwaWNrZXIuY3NzLCBkaWFsb2cuY3NzLCBkcmFnZ2FibGUuY3NzLCByZXNpemFibGUuY3NzLCBwcm9ncmVzc2Jhci5jc3MsIHNlbGVjdGFibGUuY3NzLCBzZWxlY3RtZW51LmNzcywgc2xpZGVyLmNzcywgc29ydGFibGUuY3NzLCBzcGlubmVyLmNzcywgdGFicy5jc3MsIHRvb2x0aXAuY3NzLCB0aGVtZS5jc3MNCiogVG8gdmlldyBhbmQgbW9kaWZ5IHRoaXMgdGhlbWUsIHZpc2l0IGh0dHA6Ly9qcXVlcnl1aS5jb20vdGhlbWVyb2xsZXIvP2JnU2hhZG93WFBvcz0mYmdPdmVybGF5WFBvcz0mYmdFcnJvclhQb3M9JmJnSGlnaGxpZ2h0WFBvcz0mYmdDb250ZW50WFBvcz0mYmdIZWFkZXJYUG9zPSZiZ0FjdGl2ZVhQb3M9JmJnSG92ZXJYUG9zPSZiZ0RlZmF1bHRYUG9zPSZiZ1NoYWRvd1lQb3M9JmJnT3ZlcmxheVlQb3M9JmJnRXJyb3JZUG9zPSZiZ0hpZ2hsaWdodFlQb3M9JmJnQ29udGVudFlQb3M9JmJnSGVhZGVyWVBvcz0mYmdBY3RpdmVZUG9zPSZiZ0hvdmVyWVBvcz0mYmdEZWZhdWx0WVBvcz0mYmdTaGFkb3dSZXBlYXQ9JmJnT3ZlcmxheVJlcGVhdD0mYmdFcnJvclJlcGVhdD0mYmdIaWdobGlnaHRSZXBlYXQ9JmJnQ29udGVudFJlcGVhdD0mYmdIZWFkZXJSZXBlYXQ9JmJnQWN0aXZlUmVwZWF0PSZiZ0hvdmVyUmVwZWF0PSZiZ0RlZmF1bHRSZXBlYXQ9Jmljb25zSG92ZXI9dXJsKCUyMmltYWdlcyUyRnVpLWljb25zXzU1NTU1NV8yNTZ4MjQwLnBuZyUyMikmaWNvbnNIaWdobGlnaHQ9dXJsKCUyMmltYWdlcyUyRnVpLWljb25zXzc3NzYyMF8yNTZ4MjQwLnBuZyUyMikmaWNvbnNIZWFkZXI9dXJsKCUyMmltYWdlcyUyRnVpLWljb25zXzQ0NDQ0NF8yNTZ4MjQwLnBuZyUyMikmaWNvbnNFcnJvcj11cmwoJTIyaW1hZ2VzJTJGdWktaWNvbnNfY2MwMDAwXzI1NngyNDAucG5nJTIyKSZpY29uc0RlZmF1bHQ9dXJsKCUyMmltYWdlcyUyRnVpLWljb25zXzc3Nzc3N18yNTZ4MjQwLnBuZyUyMikmaWNvbnNDb250ZW50PXVybCglMjJpbWFnZXMlMkZ1aS1pY29uc180NDQ0NDRfMjU2eDI0MC5wbmclMjIpJmljb25zQWN0aXZlPXVybCglMjJpbWFnZXMlMkZ1aS1pY29uc19mZmZmZmZfMjU2eDI0MC5wbmclMjIpJmJnSW1nVXJsU2hhZG93PSZiZ0ltZ1VybE92ZXJsYXk9JmJnSW1nVXJsSG92ZXI9JmJnSW1nVXJsSGlnaGxpZ2h0PSZiZ0ltZ1VybEhlYWRlcj0mYmdJbWdVcmxFcnJvcj0mYmdJbWdVcmxEZWZhdWx0PSZiZ0ltZ1VybENvbnRlbnQ9JmJnSW1nVXJsQWN0aXZlPSZvcGFjaXR5RmlsdGVyU2hhZG93PUFscGhhKE9wYWNpdHklM0QzMCkmb3BhY2l0eUZpbHRlck92ZXJsYXk9QWxwaGEoT3BhY2l0eSUzRDMwKSZvcGFjaXR5U2hhZG93UGVyYz0zMCZvcGFjaXR5T3ZlcmxheVBlcmM9MzAmaWNvbkNvbG9ySG92ZXI9JTIzNTU1NTU1Jmljb25Db2xvckhpZ2hsaWdodD0lMjM3Nzc2MjAmaWNvbkNvbG9ySGVhZGVyPSUyMzQ0NDQ0NCZpY29uQ29sb3JFcnJvcj0lMjNjYzAwMDAmaWNvbkNvbG9yRGVmYXVsdD0lMjM3Nzc3NzcmaWNvbkNvbG9yQ29udGVudD0lMjM0NDQ0NDQmaWNvbkNvbG9yQWN0aXZlPSUyM2ZmZmZmZiZiZ0ltZ09wYWNpdHlTaGFkb3c9MCZiZ0ltZ09wYWNpdHlPdmVybGF5PTAmYmdJbWdPcGFjaXR5RXJyb3I9OTUmYmdJbWdPcGFjaXR5SGlnaGxpZ2h0PTU1JmJnSW1nT3BhY2l0eUNvbnRlbnQ9NzUmYmdJbWdPcGFjaXR5SGVhZGVyPTc1JmJnSW1nT3BhY2l0eUFjdGl2ZT02NSZiZ0ltZ09wYWNpdHlIb3Zlcj03NSZiZ0ltZ09wYWNpdHlEZWZhdWx0PTc1JmJnVGV4dHVyZVNoYWRvdz1mbGF0JmJnVGV4dHVyZU92ZXJsYXk9ZmxhdCZiZ1RleHR1cmVFcnJvcj1mbGF0JmJnVGV4dHVyZUhpZ2hsaWdodD1mbGF0JmJnVGV4dHVyZUNvbnRlbnQ9ZmxhdCZiZ1RleHR1cmVIZWFkZXI9ZmxhdCZiZ1RleHR1cmVBY3RpdmU9ZmxhdCZiZ1RleHR1cmVIb3Zlcj1mbGF0JmJnVGV4dHVyZURlZmF1bHQ9ZmxhdCZjb3JuZXJSYWRpdXM9M3B4JmZ3RGVmYXVsdD1ub3JtYWwmZmZEZWZhdWx0PUFyaWFsJTJDSGVsdmV0aWNhJTJDc2Fucy1zZXJpZiZmc0RlZmF1bHQ9MWVtJmNvcm5lclJhZGl1c1NoYWRvdz04cHgmdGhpY2tuZXNzU2hhZG93PTVweCZvZmZzZXRMZWZ0U2hhZG93PTBweCZvZmZzZXRUb3BTaGFkb3c9MHB4Jm9wYWNpdHlTaGFkb3c9LjMmYmdDb2xvclNoYWRvdz0lMjM2NjY2NjYmb3BhY2l0eU92ZXJsYXk9LjMmYmdDb2xvck92ZXJsYXk9JTIzYWFhYWFhJmZjRXJyb3I9JTIzNWYzZjNmJmJvcmRlckNvbG9yRXJyb3I9JTIzZjFhODk5JmJnQ29sb3JFcnJvcj0lMjNmZGRmZGYmZmNIaWdobGlnaHQ9JTIzNzc3NjIwJmJvcmRlckNvbG9ySGlnaGxpZ2h0PSUyM2RhZDU1ZSZiZ0NvbG9ySGlnaGxpZ2h0PSUyM2ZmZmE5MCZmY0NvbnRlbnQ9JTIzMzMzMzMzJmJvcmRlckNvbG9yQ29udGVudD0lMjNkZGRkZGQmYmdDb2xvckNvbnRlbnQ9JTIzZmZmZmZmJmZjSGVhZGVyPSUyMzMzMzMzMyZib3JkZXJDb2xvckhlYWRlcj0lMjNkZGRkZGQmYmdDb2xvckhlYWRlcj0lMjNlOWU5ZTkmZmNBY3RpdmU9JTIzZmZmZmZmJmJvcmRlckNvbG9yQWN0aXZlPSUyMzAwM2VmZiZiZ0NvbG9yQWN0aXZlPSUyMzAwN2ZmZiZmY0hvdmVyPSUyMzJiMmIyYiZib3JkZXJDb2xvckhvdmVyPSUyM2NjY2NjYyZiZ0NvbG9ySG92ZXI9JTIzZWRlZGVkJmZjRGVmYXVsdD0lMjM0NTQ1NDUmYm9yZGVyQ29sb3JEZWZhdWx0PSUyM2M1YzVjNSZiZ0NvbG9yRGVmYXVsdD0lMjNmNmY2ZjYNCiogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnM7IExpY2Vuc2VkIE1JVCAqLw0KDQovKiBMYXlvdXQgaGVscGVycw0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovDQoudWktaGVscGVyLWhpZGRlbiB7DQoJZGlzcGxheTogbm9uZTsNCn0NCi51aS1oZWxwZXItaGlkZGVuLWFjY2Vzc2libGUgew0KCWJvcmRlcjogMDsNCgljbGlwOiByZWN0KDAgMCAwIDApOw0KCWhlaWdodDogMXB4Ow0KCW1hcmdpbjogLTFweDsNCglvdmVyZmxvdzogaGlkZGVuOw0KCXBhZGRpbmc6IDA7DQoJcG9zaXRpb246IGFic29sdXRlOw0KCXdpZHRoOiAxcHg7DQp9DQoudWktaGVscGVyLXJlc2V0IHsNCgltYXJnaW46IDA7DQoJcGFkZGluZzogMDsNCglib3JkZXI6IDA7DQoJb3V0bGluZTogMDsNCglsaW5lLWhlaWdodDogMS4zOw0KCXRleHQtZGVjb3JhdGlvbjogbm9uZTsNCglmb250LXNpemU6IDEwMCU7DQoJbGlzdC1zdHlsZTogbm9uZTsNCn0NCi51aS1oZWxwZXItY2xlYXJmaXg6YmVmb3JlLA0KLnVpLWhlbHBlci1jbGVhcmZpeDphZnRlciB7DQoJY29udGVudDogIiI7DQoJZGlzcGxheTogdGFibGU7DQoJYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsNCn0NCi51aS1oZWxwZXItY2xlYXJmaXg6YWZ0ZXIgew0KCWNsZWFyOiBib3RoOw0KfQ0KLnVpLWhlbHBlci16Zml4IHsNCgl3aWR0aDogMTAwJTsNCgloZWlnaHQ6IDEwMCU7DQoJdG9wOiAwOw0KCWxlZnQ6IDA7DQoJcG9zaXRpb246IGFic29sdXRlOw0KCW9wYWNpdHk6IDA7DQoJZmlsdGVyOkFscGhhKE9wYWNpdHk9MCk7IC8qIHN1cHBvcnQ6IElFOCAqLw0KfQ0KDQoudWktZnJvbnQgew0KCXotaW5kZXg6IDEwMDsNCn0NCg0KDQovKiBJbnRlcmFjdGlvbiBDdWVzDQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8NCi51aS1zdGF0ZS1kaXNhYmxlZCB7DQoJY3Vyc29yOiBkZWZhdWx0ICFpbXBvcnRhbnQ7DQoJcG9pbnRlci1ldmVudHM6IG5vbmU7DQp9DQoNCg0KLyogSWNvbnMNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLw0KLnVpLWljb24gew0KCWRpc3BsYXk6IGlubGluZS1ibG9jazsNCgl2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOw0KCW1hcmdpbi10b3A6IC0uMjVlbTsNCglwb3NpdGlvbjogcmVsYXRpdmU7DQoJdGV4dC1pbmRlbnQ6IC05OTk5OXB4Ow0KCW92ZXJmbG93OiBoaWRkZW47DQoJYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsNCn0NCg0KLnVpLXdpZGdldC1pY29uLWJsb2NrIHsNCglsZWZ0OiA1MCU7DQoJbWFyZ2luLWxlZnQ6IC04cHg7DQoJZGlzcGxheTogYmxvY2s7DQp9DQoNCi8qIE1pc2MgdmlzdWFscw0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovDQoNCi8qIE92ZXJsYXlzICovDQoudWktd2lkZ2V0LW92ZXJsYXkgew0KCXBvc2l0aW9uOiBmaXhlZDsNCgl0b3A6IDA7DQoJbGVmdDogMDsNCgl3aWR0aDogMTAwJTsNCgloZWlnaHQ6IDEwMCU7DQp9DQoudWktYWNjb3JkaW9uIC51aS1hY2NvcmRpb24taGVhZGVyIHsNCglkaXNwbGF5OiBibG9jazsNCgljdXJzb3I6IHBvaW50ZXI7DQoJcG9zaXRpb246IHJlbGF0aXZlOw0KCW1hcmdpbjogMnB4IDAgMCAwOw0KCXBhZGRpbmc6IC41ZW0gLjVlbSAuNWVtIC43ZW07DQoJZm9udC1zaXplOiAxMDAlOw0KfQ0KLnVpLWFjY29yZGlvbiAudWktYWNjb3JkaW9uLWNvbnRlbnQgew0KCXBhZGRpbmc6IDFlbSAyLjJlbTsNCglib3JkZXItdG9wOiAwOw0KCW92ZXJmbG93OiBhdXRvOw0KfQ0KLnVpLWF1dG9jb21wbGV0ZSB7DQoJcG9zaXRpb246IGFic29sdXRlOw0KCXRvcDogMDsNCglsZWZ0OiAwOw0KCWN1cnNvcjogZGVmYXVsdDsNCn0NCi51aS1tZW51IHsNCglsaXN0LXN0eWxlOiBub25lOw0KCXBhZGRpbmc6IDA7DQoJbWFyZ2luOiAwOw0KCWRpc3BsYXk6IGJsb2NrOw0KCW91dGxpbmU6IDA7DQp9DQoudWktbWVudSAudWktbWVudSB7DQoJcG9zaXRpb246IGFic29sdXRlOw0KfQ0KLnVpLW1lbnUgLnVpLW1lbnUtaXRlbSB7DQoJbWFyZ2luOiAwOw0KCWN1cnNvcjogcG9pbnRlcjsNCgkvKiBzdXBwb3J0OiBJRTEwLCBzZWUgIzg4NDQgKi8NCglsaXN0LXN0eWxlLWltYWdlOiB1cmwoImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBSUFBQUFBQUFQLy8veUg1QkFFQUFBQUFMQUFBQUFBQkFBRUFBQUlCUkFBNyIpOw0KfQ0KLnVpLW1lbnUgLnVpLW1lbnUtaXRlbS13cmFwcGVyIHsNCglwb3NpdGlvbjogcmVsYXRpdmU7DQoJcGFkZGluZzogM3B4IDFlbSAzcHggLjRlbTsNCn0NCi51aS1tZW51IC51aS1tZW51LWRpdmlkZXIgew0KCW1hcmdpbjogNXB4IDA7DQoJaGVpZ2h0OiAwOw0KCWZvbnQtc2l6ZTogMDsNCglsaW5lLWhlaWdodDogMDsNCglib3JkZXItd2lkdGg6IDFweCAwIDAgMDsNCn0NCi51aS1tZW51IC51aS1zdGF0ZS1mb2N1cywNCi51aS1tZW51IC51aS1zdGF0ZS1hY3RpdmUgew0KCW1hcmdpbjogLTFweDsNCn0NCg0KLyogaWNvbiBzdXBwb3J0ICovDQoudWktbWVudS1pY29ucyB7DQoJcG9zaXRpb246IHJlbGF0aXZlOw0KfQ0KLnVpLW1lbnUtaWNvbnMgLnVpLW1lbnUtaXRlbS13cmFwcGVyIHsNCglwYWRkaW5nLWxlZnQ6IDJlbTsNCn0NCg0KLyogbGVmdC1hbGlnbmVkICovDQoudWktbWVudSAudWktaWNvbiB7DQoJcG9zaXRpb246IGFic29sdXRlOw0KCXRvcDogMDsNCglib3R0b206IDA7DQoJbGVmdDogLjJlbTsNCgltYXJnaW46IGF1dG8gMDsNCn0NCg0KLyogcmlnaHQtYWxpZ25lZCAqLw0KLnVpLW1lbnUgLnVpLW1lbnUtaWNvbiB7DQoJbGVmdDogYXV0bzsNCglyaWdodDogMDsNCn0NCi51aS1idXR0b24gew0KCXBhZGRpbmc6IC40ZW0gMWVtOw0KCWRpc3BsYXk6IGlubGluZS1ibG9jazsNCglwb3NpdGlvbjogcmVsYXRpdmU7DQoJbGluZS1oZWlnaHQ6IG5vcm1hbDsNCgltYXJnaW4tcmlnaHQ6IC4xZW07DQoJY3Vyc29yOiBwb2ludGVyOw0KCXZlcnRpY2FsLWFsaWduOiBtaWRkbGU7DQoJdGV4dC1hbGlnbjogY2VudGVyOw0KCS13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7DQoJLW1vei11c2VyLXNlbGVjdDogbm9uZTsNCgktbXMtdXNlci1zZWxlY3Q6IG5vbmU7DQoJdXNlci1zZWxlY3Q6IG5vbmU7DQoNCgkvKiBTdXBwb3J0OiBJRSA8PSAxMSAqLw0KCW92ZXJmbG93OiB2aXNpYmxlOw0KfQ0KDQoudWktYnV0dG9uLA0KLnVpLWJ1dHRvbjpsaW5rLA0KLnVpLWJ1dHRvbjp2aXNpdGVkLA0KLnVpLWJ1dHRvbjpob3ZlciwNCi51aS1idXR0b246YWN0aXZlIHsNCgl0ZXh0LWRlY29yYXRpb246IG5vbmU7DQp9DQoNCi8qIHRvIG1ha2Ugcm9vbSBmb3IgdGhlIGljb24sIGEgd2lkdGggbmVlZHMgdG8gYmUgc2V0IGhlcmUgKi8NCi51aS1idXR0b24taWNvbi1vbmx5IHsNCgl3aWR0aDogMmVtOw0KCWJveC1zaXppbmc6IGJvcmRlci1ib3g7DQoJdGV4dC1pbmRlbnQ6IC05OTk5cHg7DQoJd2hpdGUtc3BhY2U6IG5vd3JhcDsNCn0NCg0KLyogbm8gaWNvbiBzdXBwb3J0IGZvciBpbnB1dCBlbGVtZW50cyAqLw0KaW5wdXQudWktYnV0dG9uLnVpLWJ1dHRvbi1pY29uLW9ubHkgew0KCXRleHQtaW5kZW50OiAwOw0KfQ0KDQovKiBidXR0b24gaWNvbiBlbGVtZW50KHMpICovDQoudWktYnV0dG9uLWljb24tb25seSAudWktaWNvbiB7DQoJcG9zaXRpb246IGFic29sdXRlOw0KCXRvcDogNTAlOw0KCWxlZnQ6IDUwJTsNCgltYXJnaW4tdG9wOiAtOHB4Ow0KCW1hcmdpbi1sZWZ0OiAtOHB4Ow0KfQ0KDQoudWktYnV0dG9uLnVpLWljb24tbm90ZXh0IC51aS1pY29uIHsNCglwYWRkaW5nOiAwOw0KCXdpZHRoOiAyLjFlbTsNCgloZWlnaHQ6IDIuMWVtOw0KCXRleHQtaW5kZW50OiAtOTk5OXB4Ow0KCXdoaXRlLXNwYWNlOiBub3dyYXA7DQoNCn0NCg0KaW5wdXQudWktYnV0dG9uLnVpLWljb24tbm90ZXh0IC51aS1pY29uIHsNCgl3aWR0aDogYXV0bzsNCgloZWlnaHQ6IGF1dG87DQoJdGV4dC1pbmRlbnQ6IDA7DQoJd2hpdGUtc3BhY2U6IG5vcm1hbDsNCglwYWRkaW5nOiAuNGVtIDFlbTsNCn0NCg0KLyogd29ya2Fyb3VuZHMgKi8NCi8qIFN1cHBvcnQ6IEZpcmVmb3ggNSAtIDQwICovDQppbnB1dC51aS1idXR0b246Oi1tb3otZm9jdXMtaW5uZXIsDQpidXR0b24udWktYnV0dG9uOjotbW96LWZvY3VzLWlubmVyIHsNCglib3JkZXI6IDA7DQoJcGFkZGluZzogMDsNCn0NCi51aS1jb250cm9sZ3JvdXAgew0KCXZlcnRpY2FsLWFsaWduOiBtaWRkbGU7DQoJZGlzcGxheTogaW5saW5lLWJsb2NrOw0KfQ0KLnVpLWNvbnRyb2xncm91cCA+IC51aS1jb250cm9sZ3JvdXAtaXRlbSB7DQoJZmxvYXQ6IGxlZnQ7DQoJbWFyZ2luLWxlZnQ6IDA7DQoJbWFyZ2luLXJpZ2h0OiAwOw0KfQ0KLnVpLWNvbnRyb2xncm91cCA+IC51aS1jb250cm9sZ3JvdXAtaXRlbTpmb2N1cywNCi51aS1jb250cm9sZ3JvdXAgPiAudWktY29udHJvbGdyb3VwLWl0ZW0udWktdmlzdWFsLWZvY3VzIHsNCgl6LWluZGV4OiA5OTk5Ow0KfQ0KLnVpLWNvbnRyb2xncm91cC12ZXJ0aWNhbCA+IC51aS1jb250cm9sZ3JvdXAtaXRlbSB7DQoJZGlzcGxheTogYmxvY2s7DQoJZmxvYXQ6IG5vbmU7DQoJd2lkdGg6IDEwMCU7DQoJbWFyZ2luLXRvcDogMDsNCgltYXJnaW4tYm90dG9tOiAwOw0KCXRleHQtYWxpZ246IGxlZnQ7DQp9DQoudWktY29udHJvbGdyb3VwLXZlcnRpY2FsIC51aS1jb250cm9sZ3JvdXAtaXRlbSB7DQoJYm94LXNpemluZzogYm9yZGVyLWJveDsNCn0NCi51aS1jb250cm9sZ3JvdXAgLnVpLWNvbnRyb2xncm91cC1sYWJlbCB7DQoJcGFkZGluZzogLjRlbSAxZW07DQp9DQoudWktY29udHJvbGdyb3VwIC51aS1jb250cm9sZ3JvdXAtbGFiZWwgc3BhbiB7DQoJZm9udC1zaXplOiA4MCU7DQp9DQoudWktY29udHJvbGdyb3VwLWhvcml6b250YWwgLnVpLWNvbnRyb2xncm91cC1sYWJlbCArIC51aS1jb250cm9sZ3JvdXAtaXRlbSB7DQoJYm9yZGVyLWxlZnQ6IG5vbmU7DQp9DQoudWktY29udHJvbGdyb3VwLXZlcnRpY2FsIC51aS1jb250cm9sZ3JvdXAtbGFiZWwgKyAudWktY29udHJvbGdyb3VwLWl0ZW0gew0KCWJvcmRlci10b3A6IG5vbmU7DQp9DQoudWktY29udHJvbGdyb3VwLWhvcml6b250YWwgLnVpLWNvbnRyb2xncm91cC1sYWJlbC51aS13aWRnZXQtY29udGVudCB7DQoJYm9yZGVyLXJpZ2h0OiBub25lOw0KfQ0KLnVpLWNvbnRyb2xncm91cC12ZXJ0aWNhbCAudWktY29udHJvbGdyb3VwLWxhYmVsLnVpLXdpZGdldC1jb250ZW50IHsNCglib3JkZXItYm90dG9tOiBub25lOw0KfQ0KDQovKiBTcGlubmVyIHNwZWNpZmljIHN0eWxlIGZpeGVzICovDQoudWktY29udHJvbGdyb3VwLXZlcnRpY2FsIC51aS1zcGlubmVyLWlucHV0IHsNCg0KCS8qIFN1cHBvcnQ6IElFOCBvbmx5LCBBbmRyb2lkIDwgNC40IG9ubHkgKi8NCgl3aWR0aDogNzUlOw0KCXdpZHRoOiBjYWxjKCAxMDAlIC0gMi40ZW0gKTsNCn0NCi51aS1jb250cm9sZ3JvdXAtdmVydGljYWwgLnVpLXNwaW5uZXIgLnVpLXNwaW5uZXItdXAgew0KCWJvcmRlci10b3Atc3R5bGU6IHNvbGlkOw0KfQ0KDQoudWktY2hlY2tib3hyYWRpby1sYWJlbCAudWktaWNvbi1iYWNrZ3JvdW5kIHsNCglib3gtc2hhZG93OiBpbnNldCAxcHggMXB4IDFweCAjY2NjOw0KCWJvcmRlci1yYWRpdXM6IC4xMmVtOw0KCWJvcmRlcjogbm9uZTsNCn0NCi51aS1jaGVja2JveHJhZGlvLXJhZGlvLWxhYmVsIC51aS1pY29uLWJhY2tncm91bmQgew0KCXdpZHRoOiAxNnB4Ow0KCWhlaWdodDogMTZweDsNCglib3JkZXItcmFkaXVzOiAxZW07DQoJb3ZlcmZsb3c6IHZpc2libGU7DQoJYm9yZGVyOiBub25lOw0KfQ0KLnVpLWNoZWNrYm94cmFkaW8tcmFkaW8tbGFiZWwudWktY2hlY2tib3hyYWRpby1jaGVja2VkIC51aS1pY29uLA0KLnVpLWNoZWNrYm94cmFkaW8tcmFkaW8tbGFiZWwudWktY2hlY2tib3hyYWRpby1jaGVja2VkOmhvdmVyIC51aS1pY29uIHsNCgliYWNrZ3JvdW5kLWltYWdlOiBub25lOw0KCXdpZHRoOiA4cHg7DQoJaGVpZ2h0OiA4cHg7DQoJYm9yZGVyLXdpZHRoOiA0cHg7DQoJYm9yZGVyLXN0eWxlOiBzb2xpZDsNCn0NCi51aS1jaGVja2JveHJhZGlvLWRpc2FibGVkIHsNCglwb2ludGVyLWV2ZW50czogbm9uZTsNCn0NCi51aS1kYXRlcGlja2VyIHsNCgl3aWR0aDogMTdlbTsNCglwYWRkaW5nOiAuMmVtIC4yZW0gMDsNCglkaXNwbGF5OiBub25lOw0KfQ0KLnVpLWRhdGVwaWNrZXIgLnVpLWRhdGVwaWNrZXItaGVhZGVyIHsNCglwb3NpdGlvbjogcmVsYXRpdmU7DQoJcGFkZGluZzogLjJlbSAwOw0KfQ0KLnVpLWRhdGVwaWNrZXIgLnVpLWRhdGVwaWNrZXItcHJldiwNCi51aS1kYXRlcGlja2VyIC51aS1kYXRlcGlja2VyLW5leHQgew0KCXBvc2l0aW9uOiBhYnNvbHV0ZTsNCgl0b3A6IDJweDsNCgl3aWR0aDogMS44ZW07DQoJaGVpZ2h0OiAxLjhlbTsNCn0NCi51aS1kYXRlcGlja2VyIC51aS1kYXRlcGlja2VyLXByZXYtaG92ZXIsDQoudWktZGF0ZXBpY2tlciAudWktZGF0ZXBpY2tlci1uZXh0LWhvdmVyIHsNCgl0b3A6IDFweDsNCn0NCi51aS1kYXRlcGlja2VyIC51aS1kYXRlcGlja2VyLXByZXYgew0KCWxlZnQ6IDJweDsNCn0NCi51aS1kYXRlcGlja2VyIC51aS1kYXRlcGlja2VyLW5leHQgew0KCXJpZ2h0OiAycHg7DQp9DQoudWktZGF0ZXBpY2tlciAudWktZGF0ZXBpY2tlci1wcmV2LWhvdmVyIHsNCglsZWZ0OiAxcHg7DQp9DQoudWktZGF0ZXBpY2tlciAudWktZGF0ZXBpY2tlci1uZXh0LWhvdmVyIHsNCglyaWdodDogMXB4Ow0KfQ0KLnVpLWRhdGVwaWNrZXIgLnVpLWRhdGVwaWNrZXItcHJldiBzcGFuLA0KLnVpLWRhdGVwaWNrZXIgLnVpLWRhdGVwaWNrZXItbmV4dCBzcGFuIHsNCglkaXNwbGF5OiBibG9jazsNCglwb3NpdGlvbjogYWJzb2x1dGU7DQoJbGVmdDogNTAlOw0KCW1hcmdpbi1sZWZ0OiAtOHB4Ow0KCXRvcDogNTAlOw0KCW1hcmdpbi10b3A6IC04cHg7DQp9DQoudWktZGF0ZXBpY2tlciAudWktZGF0ZXBpY2tlci10aXRsZSB7DQoJbWFyZ2luOiAwIDIuM2VtOw0KCWxpbmUtaGVpZ2h0OiAxLjhlbTsNCgl0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoudWktZGF0ZXBpY2tlciAudWktZGF0ZXBpY2tlci10aXRsZSBzZWxlY3Qgew0KCWZvbnQtc2l6ZTogMWVtOw0KCW1hcmdpbjogMXB4IDA7DQp9DQoudWktZGF0ZXBpY2tlciBzZWxlY3QudWktZGF0ZXBpY2tlci1tb250aCwNCi51aS1kYXRlcGlja2VyIHNlbGVjdC51aS1kYXRlcGlja2VyLXllYXIgew0KCXdpZHRoOiA0NSU7DQp9DQoudWktZGF0ZXBpY2tlciB0YWJsZSB7DQoJd2lkdGg6IDEwMCU7DQoJZm9udC1zaXplOiAuOWVtOw0KCWJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7DQoJbWFyZ2luOiAwIDAgLjRlbTsNCn0NCi51aS1kYXRlcGlja2VyIHRoIHsNCglwYWRkaW5nOiAuN2VtIC4zZW07DQoJdGV4dC1hbGlnbjogY2VudGVyOw0KCWZvbnQtd2VpZ2h0OiBib2xkOw0KCWJvcmRlcjogMDsNCn0NCi51aS1kYXRlcGlja2VyIHRkIHsNCglib3JkZXI6IDA7DQoJcGFkZGluZzogMXB4Ow0KfQ0KLnVpLWRhdGVwaWNrZXIgdGQgc3BhbiwNCi51aS1kYXRlcGlja2VyIHRkIGEgew0KCWRpc3BsYXk6IGJsb2NrOw0KCXBhZGRpbmc6IC4yZW07DQoJdGV4dC1hbGlnbjogcmlnaHQ7DQoJdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KfQ0KLnVpLWRhdGVwaWNrZXIgLnVpLWRhdGVwaWNrZXItYnV0dG9ucGFuZSB7DQoJYmFja2dyb3VuZC1pbWFnZTogbm9uZTsNCgltYXJnaW46IC43ZW0gMCAwIDA7DQoJcGFkZGluZzogMCAuMmVtOw0KCWJvcmRlci1sZWZ0OiAwOw0KCWJvcmRlci1yaWdodDogMDsNCglib3JkZXItYm90dG9tOiAwOw0KfQ0KLnVpLWRhdGVwaWNrZXIgLnVpLWRhdGVwaWNrZXItYnV0dG9ucGFuZSBidXR0b24gew0KCWZsb2F0OiByaWdodDsNCgltYXJnaW46IC41ZW0gLjJlbSAuNGVtOw0KCWN1cnNvcjogcG9pbnRlcjsNCglwYWRkaW5nOiAuMmVtIC42ZW0gLjNlbSAuNmVtOw0KCXdpZHRoOiBhdXRvOw0KCW92ZXJmbG93OiB2aXNpYmxlOw0KfQ0KLnVpLWRhdGVwaWNrZXIgLnVpLWRhdGVwaWNrZXItYnV0dG9ucGFuZSBidXR0b24udWktZGF0ZXBpY2tlci1jdXJyZW50IHsNCglmbG9hdDogbGVmdDsNCn0NCg0KLyogd2l0aCBtdWx0aXBsZSBjYWxlbmRhcnMgKi8NCi51aS1kYXRlcGlja2VyLnVpLWRhdGVwaWNrZXItbXVsdGkgew0KCXdpZHRoOiBhdXRvOw0KfQ0KLnVpLWRhdGVwaWNrZXItbXVsdGkgLnVpLWRhdGVwaWNrZXItZ3JvdXAgew0KCWZsb2F0OiBsZWZ0Ow0KfQ0KLnVpLWRhdGVwaWNrZXItbXVsdGkgLnVpLWRhdGVwaWNrZXItZ3JvdXAgdGFibGUgew0KCXdpZHRoOiA5NSU7DQoJbWFyZ2luOiAwIGF1dG8gLjRlbTsNCn0NCi51aS1kYXRlcGlja2VyLW11bHRpLTIgLnVpLWRhdGVwaWNrZXItZ3JvdXAgew0KCXdpZHRoOiA1MCU7DQp9DQoudWktZGF0ZXBpY2tlci1tdWx0aS0zIC51aS1kYXRlcGlja2VyLWdyb3VwIHsNCgl3aWR0aDogMzMuMyU7DQp9DQoudWktZGF0ZXBpY2tlci1tdWx0aS00IC51aS1kYXRlcGlja2VyLWdyb3VwIHsNCgl3aWR0aDogMjUlOw0KfQ0KLnVpLWRhdGVwaWNrZXItbXVsdGkgLnVpLWRhdGVwaWNrZXItZ3JvdXAtbGFzdCAudWktZGF0ZXBpY2tlci1oZWFkZXIsDQoudWktZGF0ZXBpY2tlci1tdWx0aSAudWktZGF0ZXBpY2tlci1ncm91cC1taWRkbGUgLnVpLWRhdGVwaWNrZXItaGVhZGVyIHsNCglib3JkZXItbGVmdC13aWR0aDogMDsNCn0NCi51aS1kYXRlcGlja2VyLW11bHRpIC51aS1kYXRlcGlja2VyLWJ1dHRvbnBhbmUgew0KCWNsZWFyOiBsZWZ0Ow0KfQ0KLnVpLWRhdGVwaWNrZXItcm93LWJyZWFrIHsNCgljbGVhcjogYm90aDsNCgl3aWR0aDogMTAwJTsNCglmb250LXNpemU6IDA7DQp9DQoNCi8qIFJUTCBzdXBwb3J0ICovDQoudWktZGF0ZXBpY2tlci1ydGwgew0KCWRpcmVjdGlvbjogcnRsOw0KfQ0KLnVpLWRhdGVwaWNrZXItcnRsIC51aS1kYXRlcGlja2VyLXByZXYgew0KCXJpZ2h0OiAycHg7DQoJbGVmdDogYXV0bzsNCn0NCi51aS1kYXRlcGlja2VyLXJ0bCAudWktZGF0ZXBpY2tlci1uZXh0IHsNCglsZWZ0OiAycHg7DQoJcmlnaHQ6IGF1dG87DQp9DQoudWktZGF0ZXBpY2tlci1ydGwgLnVpLWRhdGVwaWNrZXItcHJldjpob3ZlciB7DQoJcmlnaHQ6IDFweDsNCglsZWZ0OiBhdXRvOw0KfQ0KLnVpLWRhdGVwaWNrZXItcnRsIC51aS1kYXRlcGlja2VyLW5leHQ6aG92ZXIgew0KCWxlZnQ6IDFweDsNCglyaWdodDogYXV0bzsNCn0NCi51aS1kYXRlcGlja2VyLXJ0bCAudWktZGF0ZXBpY2tlci1idXR0b25wYW5lIHsNCgljbGVhcjogcmlnaHQ7DQp9DQoudWktZGF0ZXBpY2tlci1ydGwgLnVpLWRhdGVwaWNrZXItYnV0dG9ucGFuZSBidXR0b24gew0KCWZsb2F0OiBsZWZ0Ow0KfQ0KLnVpLWRhdGVwaWNrZXItcnRsIC51aS1kYXRlcGlja2VyLWJ1dHRvbnBhbmUgYnV0dG9uLnVpLWRhdGVwaWNrZXItY3VycmVudCwNCi51aS1kYXRlcGlja2VyLXJ0bCAudWktZGF0ZXBpY2tlci1ncm91cCB7DQoJZmxvYXQ6IHJpZ2h0Ow0KfQ0KLnVpLWRhdGVwaWNrZXItcnRsIC51aS1kYXRlcGlja2VyLWdyb3VwLWxhc3QgLnVpLWRhdGVwaWNrZXItaGVhZGVyLA0KLnVpLWRhdGVwaWNrZXItcnRsIC51aS1kYXRlcGlja2VyLWdyb3VwLW1pZGRsZSAudWktZGF0ZXBpY2tlci1oZWFkZXIgew0KCWJvcmRlci1yaWdodC13aWR0aDogMDsNCglib3JkZXItbGVmdC13aWR0aDogMXB4Ow0KfQ0KDQovKiBJY29ucyAqLw0KLnVpLWRhdGVwaWNrZXIgLnVpLWljb24gew0KCWRpc3BsYXk6IGJsb2NrOw0KCXRleHQtaW5kZW50OiAtOTk5OTlweDsNCglvdmVyZmxvdzogaGlkZGVuOw0KCWJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7DQoJbGVmdDogLjVlbTsNCgl0b3A6IC4zZW07DQp9DQoudWktZGlhbG9nIHsNCglwb3NpdGlvbjogYWJzb2x1dGU7DQoJdG9wOiAwOw0KCWxlZnQ6IDA7DQoJcGFkZGluZzogLjJlbTsNCglvdXRsaW5lOiAwOw0KfQ0KLnVpLWRpYWxvZyAudWktZGlhbG9nLXRpdGxlYmFyIHsNCglwYWRkaW5nOiAuNGVtIDFlbTsNCglwb3NpdGlvbjogcmVsYXRpdmU7DQp9DQoudWktZGlhbG9nIC51aS1kaWFsb2ctdGl0bGUgew0KCWZsb2F0OiBsZWZ0Ow0KCW1hcmdpbjogLjFlbSAwOw0KCXdoaXRlLXNwYWNlOiBub3dyYXA7DQoJd2lkdGg6IDkwJTsNCglvdmVyZmxvdzogaGlkZGVuOw0KCXRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KfQ0KLnVpLWRpYWxvZyAudWktZGlhbG9nLXRpdGxlYmFyLWNsb3NlIHsNCglwb3NpdGlvbjogYWJzb2x1dGU7DQoJcmlnaHQ6IC4zZW07DQoJdG9wOiA1MCU7DQoJd2lkdGg6IDIwcHg7DQoJbWFyZ2luOiAtMTBweCAwIDAgMDsNCglwYWRkaW5nOiAxcHg7DQoJaGVpZ2h0OiAyMHB4Ow0KfQ0KLnVpLWRpYWxvZyAudWktZGlhbG9nLWNvbnRlbnQgew0KCXBvc2l0aW9uOiByZWxhdGl2ZTsNCglib3JkZXI6IDA7DQoJcGFkZGluZzogLjVlbSAxZW07DQoJYmFja2dyb3VuZDogbm9uZTsNCglvdmVyZmxvdzogYXV0bzsNCn0NCi51aS1kaWFsb2cgLnVpLWRpYWxvZy1idXR0b25wYW5lIHsNCgl0ZXh0LWFsaWduOiBsZWZ0Ow0KCWJvcmRlci13aWR0aDogMXB4IDAgMCAwOw0KCWJhY2tncm91bmQtaW1hZ2U6IG5vbmU7DQoJbWFyZ2luLXRvcDogLjVlbTsNCglwYWRkaW5nOiAuM2VtIDFlbSAuNWVtIC40ZW07DQp9DQoudWktZGlhbG9nIC51aS1kaWFsb2ctYnV0dG9ucGFuZSAudWktZGlhbG9nLWJ1dHRvbnNldCB7DQoJZmxvYXQ6IHJpZ2h0Ow0KfQ0KLnVpLWRpYWxvZyAudWktZGlhbG9nLWJ1dHRvbnBhbmUgYnV0dG9uIHsNCgltYXJnaW46IC41ZW0gLjRlbSAuNWVtIDA7DQoJY3Vyc29yOiBwb2ludGVyOw0KfQ0KLnVpLWRpYWxvZyAudWktcmVzaXphYmxlLW4gew0KCWhlaWdodDogMnB4Ow0KCXRvcDogMDsNCn0NCi51aS1kaWFsb2cgLnVpLXJlc2l6YWJsZS1lIHsNCgl3aWR0aDogMnB4Ow0KCXJpZ2h0OiAwOw0KfQ0KLnVpLWRpYWxvZyAudWktcmVzaXphYmxlLXMgew0KCWhlaWdodDogMnB4Ow0KCWJvdHRvbTogMDsNCn0NCi51aS1kaWFsb2cgLnVpLXJlc2l6YWJsZS13IHsNCgl3aWR0aDogMnB4Ow0KCWxlZnQ6IDA7DQp9DQoudWktZGlhbG9nIC51aS1yZXNpemFibGUtc2UsDQoudWktZGlhbG9nIC51aS1yZXNpemFibGUtc3csDQoudWktZGlhbG9nIC51aS1yZXNpemFibGUtbmUsDQoudWktZGlhbG9nIC51aS1yZXNpemFibGUtbncgew0KCXdpZHRoOiA3cHg7DQoJaGVpZ2h0OiA3cHg7DQp9DQoudWktZGlhbG9nIC51aS1yZXNpemFibGUtc2Ugew0KCXJpZ2h0OiAwOw0KCWJvdHRvbTogMDsNCn0NCi51aS1kaWFsb2cgLnVpLXJlc2l6YWJsZS1zdyB7DQoJbGVmdDogMDsNCglib3R0b206IDA7DQp9DQoudWktZGlhbG9nIC51aS1yZXNpemFibGUtbmUgew0KCXJpZ2h0OiAwOw0KCXRvcDogMDsNCn0NCi51aS1kaWFsb2cgLnVpLXJlc2l6YWJsZS1udyB7DQoJbGVmdDogMDsNCgl0b3A6IDA7DQp9DQoudWktZHJhZ2dhYmxlIC51aS1kaWFsb2ctdGl0bGViYXIgew0KCWN1cnNvcjogbW92ZTsNCn0NCi51aS1kcmFnZ2FibGUtaGFuZGxlIHsNCgktbXMtdG91Y2gtYWN0aW9uOiBub25lOw0KCXRvdWNoLWFjdGlvbjogbm9uZTsNCn0NCi51aS1yZXNpemFibGUgew0KCXBvc2l0aW9uOiByZWxhdGl2ZTsNCn0NCi51aS1yZXNpemFibGUtaGFuZGxlIHsNCglwb3NpdGlvbjogYWJzb2x1dGU7DQoJZm9udC1zaXplOiAwLjFweDsNCglkaXNwbGF5OiBibG9jazsNCgktbXMtdG91Y2gtYWN0aW9uOiBub25lOw0KCXRvdWNoLWFjdGlvbjogbm9uZTsNCn0NCi51aS1yZXNpemFibGUtZGlzYWJsZWQgLnVpLXJlc2l6YWJsZS1oYW5kbGUsDQoudWktcmVzaXphYmxlLWF1dG9oaWRlIC51aS1yZXNpemFibGUtaGFuZGxlIHsNCglkaXNwbGF5OiBub25lOw0KfQ0KLnVpLXJlc2l6YWJsZS1uIHsNCgljdXJzb3I6IG4tcmVzaXplOw0KCWhlaWdodDogN3B4Ow0KCXdpZHRoOiAxMDAlOw0KCXRvcDogLTVweDsNCglsZWZ0OiAwOw0KfQ0KLnVpLXJlc2l6YWJsZS1zIHsNCgljdXJzb3I6IHMtcmVzaXplOw0KCWhlaWdodDogN3B4Ow0KCXdpZHRoOiAxMDAlOw0KCWJvdHRvbTogLTVweDsNCglsZWZ0OiAwOw0KfQ0KLnVpLXJlc2l6YWJsZS1lIHsNCgljdXJzb3I6IGUtcmVzaXplOw0KCXdpZHRoOiA3cHg7DQoJcmlnaHQ6IC01cHg7DQoJdG9wOiAwOw0KCWhlaWdodDogMTAwJTsNCn0NCi51aS1yZXNpemFibGUtdyB7DQoJY3Vyc29yOiB3LXJlc2l6ZTsNCgl3aWR0aDogN3B4Ow0KCWxlZnQ6IC01cHg7DQoJdG9wOiAwOw0KCWhlaWdodDogMTAwJTsNCn0NCi51aS1yZXNpemFibGUtc2Ugew0KCWN1cnNvcjogc2UtcmVzaXplOw0KCXdpZHRoOiAxMnB4Ow0KCWhlaWdodDogMTJweDsNCglyaWdodDogMXB4Ow0KCWJvdHRvbTogMXB4Ow0KfQ0KLnVpLXJlc2l6YWJsZS1zdyB7DQoJY3Vyc29yOiBzdy1yZXNpemU7DQoJd2lkdGg6IDlweDsNCgloZWlnaHQ6IDlweDsNCglsZWZ0OiAtNXB4Ow0KCWJvdHRvbTogLTVweDsNCn0NCi51aS1yZXNpemFibGUtbncgew0KCWN1cnNvcjogbnctcmVzaXplOw0KCXdpZHRoOiA5cHg7DQoJaGVpZ2h0OiA5cHg7DQoJbGVmdDogLTVweDsNCgl0b3A6IC01cHg7DQp9DQoudWktcmVzaXphYmxlLW5lIHsNCgljdXJzb3I6IG5lLXJlc2l6ZTsNCgl3aWR0aDogOXB4Ow0KCWhlaWdodDogOXB4Ow0KCXJpZ2h0OiAtNXB4Ow0KCXRvcDogLTVweDsNCn0NCi51aS1wcm9ncmVzc2JhciB7DQoJaGVpZ2h0OiAyZW07DQoJdGV4dC1hbGlnbjogbGVmdDsNCglvdmVyZmxvdzogaGlkZGVuOw0KfQ0KLnVpLXByb2dyZXNzYmFyIC51aS1wcm9ncmVzc2Jhci12YWx1ZSB7DQoJbWFyZ2luOiAtMXB4Ow0KCWhlaWdodDogMTAwJTsNCn0NCi51aS1wcm9ncmVzc2JhciAudWktcHJvZ3Jlc3NiYXItb3ZlcmxheSB7DQoJYmFja2dyb3VuZDogdXJsKCJkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhLQUFvQUlBQkFBQUFBUC8vL3lIL0MwNUZWRk5EUVZCRk1pNHdBd0VBQUFBaCtRUUpBUUFCQUN3QUFBQUFLQUFvQUFBQ2tZd05xWHJkQzUyRFMwNmE3TUZaSSs0RkhCQ0tvRGVXS1hxeW1QcUdxeHZKclhaYk14N1R0Yyt3OVhnVTJGQjNsT3lRUldFVDJJRkdpVTltMWZyRFZweFpaYzZiZkh3djRjMVlYUDZrMVZkeTI5MkZiNlVrdXZGdFhwdldTekErSHljWEpIVVhpR1lJaU1nMlI2VzQ1OWduV0dmSE5kaklxRFdWcWVtSDJla3BPYmtwT2xwcFdVcVppcXI2ZWRxcVdRQUFJZmtFQ1FFQUFRQXNBQUFBQUNnQUtBQUFBcFNNZ1puR2ZhcWNnMUUydXV6RG1tSFVCUjhRaWw5NWhpUEtxV24zYXF0THNTMTh5N0cxU3pOZW93V0JFTnRRZCtUMUprdFAwNW56UFRkSlpsUjZ2VXhOV1dqVit2VVdoV05rV0Z3eGw5VnBaUmVkWWNmbElPTGFmYWEyOFhkc0gveW5sY2MxdVBWRFp4UUlSMEsyNStjSUNDbW9xQ2U1bUdoWk9mZVlTVWg1eUpjSnlya1pXV3BhUjhkb0oybzROWXE2MmxBQUFDSDVCQWtCQUFFQUxBQUFBQUFvQUNnQUFBS1ZESTRZeTIyWm5JTlJOcW9zdzBCdjdpMWd5SFVrRmo3b1NhV2x1M292QzhHeE5zbzVmbHV6M3FMVmhCVmVUL0x6N1pUSHl4TDVkRGFsUVdQVk9zUVd0Um51d1hhRlRqOWpWVmg4cG1hOUpqWjR6WVNqNVpPeW1hN3V1b2xmZmgrSVI1YVc5N2NIdUJVWEtHS1hsS2puK0RpSFdNY1lKYWg0TjBsWUNNbEpPWGlwR1JyNXFkZ29TVHJxV1NxNldGbDJ5cG9hVUFBQUlma0VDUUVBQVFBc0FBQUFBQ2dBS0FBQUFwYUViNkhMZ2QvaU83Rk5XdGNGV2UrdWZPREdqUmZvaUoyYWtTaGJ1ZWIwd3RJNTB6bTAycGJ2d2ZXRU1XQlExektHbExJaHNraUVQbTlSNnZSWHhWNFp6V1QyeUhPR3BXTXlvcmJsS2xOcDhIbUhFYi9sQ1hqY1c3Ym10WFA4WHQyMjlPVldSMWZvZDJlV3FOZkh1TWpYQ1BrSUdOaWxlT2lJbVZtQ09FbW9TZm4zeVhsSldtb0hHaHFwNmlsWXVXWXBtVHFLVWdBQUlma0VDUUVBQVFBc0FBQUFBQ2dBS0FBQUFwaUVINmtiNThiaVEzRk5XdE1GV1czZU5WY29qdUZHZnFuWnFTZWJ1UzA2dzVWODAvWDAycEtlOHpGd1A2RUZXT1QxbERGazhyR0VSaDFUVE5Pb2NRNjFIbTRYbTJWZXhVSHB6anltVmlIckZiaUVMc2VmVnJuNlhLZm50MlE5Ry8rWGRpZTQ5OVhIZDJnNGg3aW9PR2hYR0pib0dBblhTQm5vQndLWXlmaW91YlpKMkhuMFJ1UlphZmxaT2lsNTZacDZpaW9LU1hwVUFBQWgrUVFKQVFBQkFDd0FBQUFBS0FBb0FBQUNrb1FScVJ2bnh1STdrVTFhMVVVNWJkNXRuU2VPWlhobW41bFdLM3FOVFd2UmRReFA4cXZhQysveWFZUXpYTzdCTXZhVUVtSlJkM1RzaU1BZ3N3bU5ZclNnWmRZclRYNnRTSEdaTzczZXp1QXcydXh1UStCYmVaZk14c2V4WTM1Ky9RZTRKMWluVjBnNHgzV0h1TWhJbDJqWE9LVDJRK1ZVNWZnb1NVSTUyVmZaeWZrSkdraGE2am1ZK2FhWWRpcnErbFFBQUNINUJBa0JBQUVBTEFBQUFBQW9BQ2dBQUFLV0JJS3BZZTBMM1lOS1RvcXN3VWx2em5pZ2Q0d2lSNEtoWnJLdDlVcHFpcDYxaTlFM3ZNdnhSZEhsYkVGaUVYZms5WUFSWXhPWlpENlZRMnBVdW5CbXRSWG8xTGY4aE1WVmNObDhKYWZWMzhhTTIvRnU1VjE2Qm42M3I2eHQ5N2owOStNWFNGaTRCbmlHRmFlM2h6Ykg5K2hZQnprcHVVaDVhWm1IdWFuWk9aZ0l1dmJHaU5lb21DbmF4eGFwMnVwYUNac3ErMWtBQUNINUJBa0JBQUVBTEFBQUFBQW9BQ2dBQUFLWGpJOEJ5NXpmNGtPeFRWclhOVmx2MVgwZDhJR1pHS0xuTnBZdG04THI5Y3FWZXVPU3ZmT1c3OUQ5YURIaXpOaERKaWRGWmhOeWRFYWhPYURINm5vbXRKanAxdHV0S29OV2t2QTZKcWZSVkxIVS9RVWZhdTlsMng3RzU0ZDFmbDk5NXhjSUdBZFhxTWZCTmFkb1lyaEgrTWcyS0JscFZwYmx1Q2lYbU1uWjJTaDRHQnFKK2NrSU9xcUo2TG1LU2xsWm1zb3E2d3BRQUFBaCtRUUpBUUFCQUN3QUFBQUFLQUFvQUFBQ2xZeC9vTHZveHVKRGtVMWExWVVaYko1OW5TZDJaWGhXcWJSYTIvZ0Y4R3UyRFkzaXFzN3lycSt4QllFa1l2RlNNOGFTU09iRStaZ1JsMUJIRlpOcjdwUkNhdlo1QlcyMTQyaFkzQU4veld0c21mMTJwOVh4eEZsMmxwTG4xcnNlenRmWFpqZElXSWYyczVkSXR3allLQmdvOXlnNXBIZ3pKWFRFZUdsWnVlbnB5UG1wR1FvS09Xa1ltU3BhU25xS2lsZUkyRkFBQUNINUJBa0JBQUVBTEFBQUFBQW9BQ2dBQUFLVmpCK2d1K2pHNGtPUlRWclZoUmxzbm4yZEozWmxlRmFwdEZyYitDWG1POU9vemVMNVZmUDk5SHZBV2hwaVVkY3drcEJIMzgyNUF3WWRVOHhUcWxMR2h0Q29zQXJLTXB2ZmExbU1SYWU5VnZXWmZlQjJYZlBrZUxtbTE4bFVjQmorcDVkbk44alhaM1lJR0VoWXVPVW40NWFvQ0RrcDE2aGw1SWpZSnZqV0tjbm9HUXBxeVBscE9ocjNhRWxhcXJxNTZCcTdWQUFBT3c9PSIpOw0KCWhlaWdodDogMTAwJTsNCglmaWx0ZXI6IGFscGhhKG9wYWNpdHk9MjUpOyAvKiBzdXBwb3J0OiBJRTggKi8NCglvcGFjaXR5OiAwLjI1Ow0KfQ0KLnVpLXByb2dyZXNzYmFyLWluZGV0ZXJtaW5hdGUgLnVpLXByb2dyZXNzYmFyLXZhbHVlIHsNCgliYWNrZ3JvdW5kLWltYWdlOiBub25lOw0KfQ0KLnVpLXNlbGVjdGFibGUgew0KCS1tcy10b3VjaC1hY3Rpb246IG5vbmU7DQoJdG91Y2gtYWN0aW9uOiBub25lOw0KfQ0KLnVpLXNlbGVjdGFibGUtaGVscGVyIHsNCglwb3NpdGlvbjogYWJzb2x1dGU7DQoJei1pbmRleDogMTAwOw0KCWJvcmRlcjogMXB4IGRvdHRlZCBibGFjazsNCn0NCi51aS1zZWxlY3RtZW51LW1lbnUgew0KCXBhZGRpbmc6IDA7DQoJbWFyZ2luOiAwOw0KCXBvc2l0aW9uOiBhYnNvbHV0ZTsNCgl0b3A6IDA7DQoJbGVmdDogMDsNCglkaXNwbGF5OiBub25lOw0KfQ0KLnVpLXNlbGVjdG1lbnUtbWVudSAudWktbWVudSB7DQoJb3ZlcmZsb3c6IGF1dG87DQoJb3ZlcmZsb3cteDogaGlkZGVuOw0KCXBhZGRpbmctYm90dG9tOiAxcHg7DQp9DQoudWktc2VsZWN0bWVudS1tZW51IC51aS1tZW51IC51aS1zZWxlY3RtZW51LW9wdGdyb3VwIHsNCglmb250LXNpemU6IDFlbTsNCglmb250LXdlaWdodDogYm9sZDsNCglsaW5lLWhlaWdodDogMS41Ow0KCXBhZGRpbmc6IDJweCAwLjRlbTsNCgltYXJnaW46IDAuNWVtIDAgMCAwOw0KCWhlaWdodDogYXV0bzsNCglib3JkZXI6IDA7DQp9DQoudWktc2VsZWN0bWVudS1vcGVuIHsNCglkaXNwbGF5OiBibG9jazsNCn0NCi51aS1zZWxlY3RtZW51LXRleHQgew0KCWRpc3BsYXk6IGJsb2NrOw0KCW1hcmdpbi1yaWdodDogMjBweDsNCglvdmVyZmxvdzogaGlkZGVuOw0KCXRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KfQ0KLnVpLXNlbGVjdG1lbnUtYnV0dG9uLnVpLWJ1dHRvbiB7DQoJdGV4dC1hbGlnbjogbGVmdDsNCgl3aGl0ZS1zcGFjZTogbm93cmFwOw0KCXdpZHRoOiAxNGVtOw0KfQ0KLnVpLXNlbGVjdG1lbnUtaWNvbi51aS1pY29uIHsNCglmbG9hdDogcmlnaHQ7DQoJbWFyZ2luLXRvcDogMDsNCn0NCi51aS1zbGlkZXIgew0KCXBvc2l0aW9uOiByZWxhdGl2ZTsNCgl0ZXh0LWFsaWduOiBsZWZ0Ow0KfQ0KLnVpLXNsaWRlciAudWktc2xpZGVyLWhhbmRsZSB7DQoJcG9zaXRpb246IGFic29sdXRlOw0KCXotaW5kZXg6IDI7DQoJd2lkdGg6IDEuMmVtOw0KCWhlaWdodDogMS4yZW07DQoJY3Vyc29yOiBkZWZhdWx0Ow0KCS1tcy10b3VjaC1hY3Rpb246IG5vbmU7DQoJdG91Y2gtYWN0aW9uOiBub25lOw0KfQ0KLnVpLXNsaWRlciAudWktc2xpZGVyLXJhbmdlIHsNCglwb3NpdGlvbjogYWJzb2x1dGU7DQoJei1pbmRleDogMTsNCglmb250LXNpemU6IC43ZW07DQoJZGlzcGxheTogYmxvY2s7DQoJYm9yZGVyOiAwOw0KCWJhY2tncm91bmQtcG9zaXRpb246IDAgMDsNCn0NCg0KLyogc3VwcG9ydDogSUU4IC0gU2VlICM2NzI3ICovDQoudWktc2xpZGVyLnVpLXN0YXRlLWRpc2FibGVkIC51aS1zbGlkZXItaGFuZGxlLA0KLnVpLXNsaWRlci51aS1zdGF0ZS1kaXNhYmxlZCAudWktc2xpZGVyLXJhbmdlIHsNCglmaWx0ZXI6IGluaGVyaXQ7DQp9DQoNCi51aS1zbGlkZXItaG9yaXpvbnRhbCB7DQoJaGVpZ2h0OiAuOGVtOw0KfQ0KLnVpLXNsaWRlci1ob3Jpem9udGFsIC51aS1zbGlkZXItaGFuZGxlIHsNCgl0b3A6IC0uM2VtOw0KCW1hcmdpbi1sZWZ0OiAtLjZlbTsNCn0NCi51aS1zbGlkZXItaG9yaXpvbnRhbCAudWktc2xpZGVyLXJhbmdlIHsNCgl0b3A6IDA7DQoJaGVpZ2h0OiAxMDAlOw0KfQ0KLnVpLXNsaWRlci1ob3Jpem9udGFsIC51aS1zbGlkZXItcmFuZ2UtbWluIHsNCglsZWZ0OiAwOw0KfQ0KLnVpLXNsaWRlci1ob3Jpem9udGFsIC51aS1zbGlkZXItcmFuZ2UtbWF4IHsNCglyaWdodDogMDsNCn0NCg0KLnVpLXNsaWRlci12ZXJ0aWNhbCB7DQoJd2lkdGg6IC44ZW07DQoJaGVpZ2h0OiAxMDBweDsNCn0NCi51aS1zbGlkZXItdmVydGljYWwgLnVpLXNsaWRlci1oYW5kbGUgew0KCWxlZnQ6IC0uM2VtOw0KCW1hcmdpbi1sZWZ0OiAwOw0KCW1hcmdpbi1ib3R0b206IC0uNmVtOw0KfQ0KLnVpLXNsaWRlci12ZXJ0aWNhbCAudWktc2xpZGVyLXJhbmdlIHsNCglsZWZ0OiAwOw0KCXdpZHRoOiAxMDAlOw0KfQ0KLnVpLXNsaWRlci12ZXJ0aWNhbCAudWktc2xpZGVyLXJhbmdlLW1pbiB7DQoJYm90dG9tOiAwOw0KfQ0KLnVpLXNsaWRlci12ZXJ0aWNhbCAudWktc2xpZGVyLXJhbmdlLW1heCB7DQoJdG9wOiAwOw0KfQ0KLnVpLXNvcnRhYmxlLWhhbmRsZSB7DQoJLW1zLXRvdWNoLWFjdGlvbjogbm9uZTsNCgl0b3VjaC1hY3Rpb246IG5vbmU7DQp9DQoudWktc3Bpbm5lciB7DQoJcG9zaXRpb246IHJlbGF0aXZlOw0KCWRpc3BsYXk6IGlubGluZS1ibG9jazsNCglvdmVyZmxvdzogaGlkZGVuOw0KCXBhZGRpbmc6IDA7DQoJdmVydGljYWwtYWxpZ246IG1pZGRsZTsNCn0NCi51aS1zcGlubmVyLWlucHV0IHsNCglib3JkZXI6IG5vbmU7DQoJYmFja2dyb3VuZDogbm9uZTsNCgljb2xvcjogaW5oZXJpdDsNCglwYWRkaW5nOiAuMjIyZW0gMDsNCgltYXJnaW46IC4yZW0gMDsNCgl2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOw0KCW1hcmdpbi1sZWZ0OiAuNGVtOw0KCW1hcmdpbi1yaWdodDogMmVtOw0KfQ0KLnVpLXNwaW5uZXItYnV0dG9uIHsNCgl3aWR0aDogMS42ZW07DQoJaGVpZ2h0OiA1MCU7DQoJZm9udC1zaXplOiAuNWVtOw0KCXBhZGRpbmc6IDA7DQoJbWFyZ2luOiAwOw0KCXRleHQtYWxpZ246IGNlbnRlcjsNCglwb3NpdGlvbjogYWJzb2x1dGU7DQoJY3Vyc29yOiBkZWZhdWx0Ow0KCWRpc3BsYXk6IGJsb2NrOw0KCW92ZXJmbG93OiBoaWRkZW47DQoJcmlnaHQ6IDA7DQp9DQovKiBtb3JlIHNwZWNpZmljaXR5IHJlcXVpcmVkIGhlcmUgdG8gb3ZlcnJpZGUgZGVmYXVsdCBib3JkZXJzICovDQoudWktc3Bpbm5lciBhLnVpLXNwaW5uZXItYnV0dG9uIHsNCglib3JkZXItdG9wLXN0eWxlOiBub25lOw0KCWJvcmRlci1ib3R0b20tc3R5bGU6IG5vbmU7DQoJYm9yZGVyLXJpZ2h0LXN0eWxlOiBub25lOw0KfQ0KLnVpLXNwaW5uZXItdXAgew0KCXRvcDogMDsNCn0NCi51aS1zcGlubmVyLWRvd24gew0KCWJvdHRvbTogMDsNCn0NCi51aS10YWJzIHsNCglwb3NpdGlvbjogcmVsYXRpdmU7LyogcG9zaXRpb246IHJlbGF0aXZlIHByZXZlbnRzIElFIHNjcm9sbCBidWcgKGVsZW1lbnQgd2l0aCBwb3NpdGlvbjogcmVsYXRpdmUgaW5zaWRlIGNvbnRhaW5lciB3aXRoIG92ZXJmbG93OiBhdXRvIGFwcGVhciBhcyAiZml4ZWQiKSAqLw0KCXBhZGRpbmc6IC4yZW07DQp9DQoudWktdGFicyAudWktdGFicy1uYXYgew0KCW1hcmdpbjogMDsNCglwYWRkaW5nOiAuMmVtIC4yZW0gMDsNCn0NCi51aS10YWJzIC51aS10YWJzLW5hdiBsaSB7DQoJbGlzdC1zdHlsZTogbm9uZTsNCglmbG9hdDogbGVmdDsNCglwb3NpdGlvbjogcmVsYXRpdmU7DQoJdG9wOiAwOw0KCW1hcmdpbjogMXB4IC4yZW0gMCAwOw0KCWJvcmRlci1ib3R0b20td2lkdGg6IDA7DQoJcGFkZGluZzogMDsNCgl3aGl0ZS1zcGFjZTogbm93cmFwOw0KfQ0KLnVpLXRhYnMgLnVpLXRhYnMtbmF2IC51aS10YWJzLWFuY2hvciB7DQoJZmxvYXQ6IGxlZnQ7DQoJcGFkZGluZzogLjVlbSAxZW07DQoJdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KfQ0KLnVpLXRhYnMgLnVpLXRhYnMtbmF2IGxpLnVpLXRhYnMtYWN0aXZlIHsNCgltYXJnaW4tYm90dG9tOiAtMXB4Ow0KCXBhZGRpbmctYm90dG9tOiAxcHg7DQp9DQoudWktdGFicyAudWktdGFicy1uYXYgbGkudWktdGFicy1hY3RpdmUgLnVpLXRhYnMtYW5jaG9yLA0KLnVpLXRhYnMgLnVpLXRhYnMtbmF2IGxpLnVpLXN0YXRlLWRpc2FibGVkIC51aS10YWJzLWFuY2hvciwNCi51aS10YWJzIC51aS10YWJzLW5hdiBsaS51aS10YWJzLWxvYWRpbmcgLnVpLXRhYnMtYW5jaG9yIHsNCgljdXJzb3I6IHRleHQ7DQp9DQoudWktdGFicy1jb2xsYXBzaWJsZSAudWktdGFicy1uYXYgbGkudWktdGFicy1hY3RpdmUgLnVpLXRhYnMtYW5jaG9yIHsNCgljdXJzb3I6IHBvaW50ZXI7DQp9DQoudWktdGFicyAudWktdGFicy1wYW5lbCB7DQoJZGlzcGxheTogYmxvY2s7DQoJYm9yZGVyLXdpZHRoOiAwOw0KCXBhZGRpbmc6IDFlbSAxLjRlbTsNCgliYWNrZ3JvdW5kOiBub25lOw0KfQ0KLnVpLXRvb2x0aXAgew0KCXBhZGRpbmc6IDhweDsNCglwb3NpdGlvbjogYWJzb2x1dGU7DQoJei1pbmRleDogOTk5OTsNCgltYXgtd2lkdGg6IDMwMHB4Ow0KfQ0KYm9keSAudWktdG9vbHRpcCB7DQoJYm9yZGVyLXdpZHRoOiAycHg7DQp9DQoNCi8qIENvbXBvbmVudCBjb250YWluZXJzDQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8NCi51aS13aWRnZXQgew0KCWZvbnQtZmFtaWx5OiBBcmlhbCxIZWx2ZXRpY2Esc2Fucy1zZXJpZjsNCglmb250LXNpemU6IDFlbTsNCn0NCi51aS13aWRnZXQgLnVpLXdpZGdldCB7DQoJZm9udC1zaXplOiAxZW07DQp9DQoudWktd2lkZ2V0IGlucHV0LA0KLnVpLXdpZGdldCBzZWxlY3QsDQoudWktd2lkZ2V0IHRleHRhcmVhLA0KLnVpLXdpZGdldCBidXR0b24gew0KCWZvbnQtZmFtaWx5OiBBcmlhbCxIZWx2ZXRpY2Esc2Fucy1zZXJpZjsNCglmb250LXNpemU6IDFlbTsNCn0NCi51aS13aWRnZXQudWktd2lkZ2V0LWNvbnRlbnQgew0KCWJvcmRlcjogMXB4IHNvbGlkICNjNWM1YzU7DQp9DQoudWktd2lkZ2V0LWNvbnRlbnQgew0KCWJvcmRlcjogMXB4IHNvbGlkICNkZGRkZGQ7DQoJYmFja2dyb3VuZDogI2ZmZmZmZjsNCgljb2xvcjogIzMzMzMzMzsNCn0NCi51aS13aWRnZXQtY29udGVudCBhIHsNCgljb2xvcjogIzMzMzMzMzsNCn0NCi51aS13aWRnZXQtaGVhZGVyIHsNCglib3JkZXI6IDFweCBzb2xpZCAjZGRkZGRkOw0KCWJhY2tncm91bmQ6ICNlOWU5ZTk7DQoJY29sb3I6ICMzMzMzMzM7DQoJZm9udC13ZWlnaHQ6IGJvbGQ7DQp9DQoudWktd2lkZ2V0LWhlYWRlciBhIHsNCgljb2xvcjogIzMzMzMzMzsNCn0NCg0KLyogSW50ZXJhY3Rpb24gc3RhdGVzDQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8NCi51aS1zdGF0ZS1kZWZhdWx0LA0KLnVpLXdpZGdldC1jb250ZW50IC51aS1zdGF0ZS1kZWZhdWx0LA0KLnVpLXdpZGdldC1oZWFkZXIgLnVpLXN0YXRlLWRlZmF1bHQsDQoudWktYnV0dG9uLA0KDQoJLyogV2UgdXNlIGh0bWwgaGVyZSBiZWNhdXNlIHdlIG5lZWQgYSBncmVhdGVyIHNwZWNpZmljaXR5IHRvIG1ha2Ugc3VyZSBkaXNhYmxlZA0KICAgIHdvcmtzIHByb3Blcmx5IHdoZW4gY2xpY2tlZCBvciBob3ZlcmVkICovDQpodG1sIC51aS1idXR0b24udWktc3RhdGUtZGlzYWJsZWQ6aG92ZXIsDQpodG1sIC51aS1idXR0b24udWktc3RhdGUtZGlzYWJsZWQ6YWN0aXZlIHsNCglib3JkZXI6IDFweCBzb2xpZCAjYzVjNWM1Ow0KCWJhY2tncm91bmQ6ICNmNmY2ZjY7DQoJZm9udC13ZWlnaHQ6IG5vcm1hbDsNCgljb2xvcjogIzQ1NDU0NTsNCn0NCi51aS1zdGF0ZS1kZWZhdWx0IGEsDQoudWktc3RhdGUtZGVmYXVsdCBhOmxpbmssDQoudWktc3RhdGUtZGVmYXVsdCBhOnZpc2l0ZWQsDQphLnVpLWJ1dHRvbiwNCmE6bGluay51aS1idXR0b24sDQphOnZpc2l0ZWQudWktYnV0dG9uLA0KLnVpLWJ1dHRvbiB7DQoJY29sb3I6ICM0NTQ1NDU7DQoJdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KfQ0KLnVpLXN0YXRlLWhvdmVyLA0KLnVpLXdpZGdldC1jb250ZW50IC51aS1zdGF0ZS1ob3ZlciwNCi51aS13aWRnZXQtaGVhZGVyIC51aS1zdGF0ZS1ob3ZlciwNCi51aS1zdGF0ZS1mb2N1cywNCi51aS13aWRnZXQtY29udGVudCAudWktc3RhdGUtZm9jdXMsDQoudWktd2lkZ2V0LWhlYWRlciAudWktc3RhdGUtZm9jdXMsDQoudWktYnV0dG9uOmhvdmVyLA0KLnVpLWJ1dHRvbjpmb2N1cyB7DQoJYm9yZGVyOiAxcHggc29saWQgI2NjY2NjYzsNCgliYWNrZ3JvdW5kOiAjZWRlZGVkOw0KCWZvbnQtd2VpZ2h0OiBub3JtYWw7DQoJY29sb3I6ICMyYjJiMmI7DQp9DQoudWktc3RhdGUtaG92ZXIgYSwNCi51aS1zdGF0ZS1ob3ZlciBhOmhvdmVyLA0KLnVpLXN0YXRlLWhvdmVyIGE6bGluaywNCi51aS1zdGF0ZS1ob3ZlciBhOnZpc2l0ZWQsDQoudWktc3RhdGUtZm9jdXMgYSwNCi51aS1zdGF0ZS1mb2N1cyBhOmhvdmVyLA0KLnVpLXN0YXRlLWZvY3VzIGE6bGluaywNCi51aS1zdGF0ZS1mb2N1cyBhOnZpc2l0ZWQsDQphLnVpLWJ1dHRvbjpob3ZlciwNCmEudWktYnV0dG9uOmZvY3VzIHsNCgljb2xvcjogIzJiMmIyYjsNCgl0ZXh0LWRlY29yYXRpb246IG5vbmU7DQp9DQoNCi51aS12aXN1YWwtZm9jdXMgew0KCWJveC1zaGFkb3c6IDAgMCAzcHggMXB4IHJnYig5NCwgMTU4LCAyMTQpOw0KfQ0KLnVpLXN0YXRlLWFjdGl2ZSwNCi51aS13aWRnZXQtY29udGVudCAudWktc3RhdGUtYWN0aXZlLA0KLnVpLXdpZGdldC1oZWFkZXIgLnVpLXN0YXRlLWFjdGl2ZSwNCmEudWktYnV0dG9uOmFjdGl2ZSwNCi51aS1idXR0b246YWN0aXZlLA0KLnVpLWJ1dHRvbi51aS1zdGF0ZS1hY3RpdmU6aG92ZXIgew0KCWJvcmRlcjogMXB4IHNvbGlkICMwMDNlZmY7DQoJYmFja2dyb3VuZDogIzAwN2ZmZjsNCglmb250LXdlaWdodDogbm9ybWFsOw0KCWNvbG9yOiAjZmZmZmZmOw0KfQ0KLnVpLWljb24tYmFja2dyb3VuZCwNCi51aS1zdGF0ZS1hY3RpdmUgLnVpLWljb24tYmFja2dyb3VuZCB7DQoJYm9yZGVyOiAjMDAzZWZmOw0KCWJhY2tncm91bmQtY29sb3I6ICNmZmZmZmY7DQp9DQoudWktc3RhdGUtYWN0aXZlIGEsDQoudWktc3RhdGUtYWN0aXZlIGE6bGluaywNCi51aS1zdGF0ZS1hY3RpdmUgYTp2aXNpdGVkIHsNCgljb2xvcjogI2ZmZmZmZjsNCgl0ZXh0LWRlY29yYXRpb246IG5vbmU7DQp9DQoNCi8qIEludGVyYWN0aW9uIEN1ZXMNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLw0KLnVpLXN0YXRlLWhpZ2hsaWdodCwNCi51aS13aWRnZXQtY29udGVudCAudWktc3RhdGUtaGlnaGxpZ2h0LA0KLnVpLXdpZGdldC1oZWFkZXIgLnVpLXN0YXRlLWhpZ2hsaWdodCB7DQoJYm9yZGVyOiAxcHggc29saWQgI2RhZDU1ZTsNCgliYWNrZ3JvdW5kOiAjZmZmYTkwOw0KCWNvbG9yOiAjNzc3NjIwOw0KfQ0KLnVpLXN0YXRlLWNoZWNrZWQgew0KCWJvcmRlcjogMXB4IHNvbGlkICNkYWQ1NWU7DQoJYmFja2dyb3VuZDogI2ZmZmE5MDsNCn0NCi51aS1zdGF0ZS1oaWdobGlnaHQgYSwNCi51aS13aWRnZXQtY29udGVudCAudWktc3RhdGUtaGlnaGxpZ2h0IGEsDQoudWktd2lkZ2V0LWhlYWRlciAudWktc3RhdGUtaGlnaGxpZ2h0IGEgew0KCWNvbG9yOiAjNzc3NjIwOw0KfQ0KLnVpLXN0YXRlLWVycm9yLA0KLnVpLXdpZGdldC1jb250ZW50IC51aS1zdGF0ZS1lcnJvciwNCi51aS13aWRnZXQtaGVhZGVyIC51aS1zdGF0ZS1lcnJvciB7DQoJYm9yZGVyOiAxcHggc29saWQgI2YxYTg5OTsNCgliYWNrZ3JvdW5kOiAjZmRkZmRmOw0KCWNvbG9yOiAjNWYzZjNmOw0KfQ0KLnVpLXN0YXRlLWVycm9yIGEsDQoudWktd2lkZ2V0LWNvbnRlbnQgLnVpLXN0YXRlLWVycm9yIGEsDQoudWktd2lkZ2V0LWhlYWRlciAudWktc3RhdGUtZXJyb3IgYSB7DQoJY29sb3I6ICM1ZjNmM2Y7DQp9DQoudWktc3RhdGUtZXJyb3ItdGV4dCwNCi51aS13aWRnZXQtY29udGVudCAudWktc3RhdGUtZXJyb3ItdGV4dCwNCi51aS13aWRnZXQtaGVhZGVyIC51aS1zdGF0ZS1lcnJvci10ZXh0IHsNCgljb2xvcjogIzVmM2YzZjsNCn0NCi51aS1wcmlvcml0eS1wcmltYXJ5LA0KLnVpLXdpZGdldC1jb250ZW50IC51aS1wcmlvcml0eS1wcmltYXJ5LA0KLnVpLXdpZGdldC1oZWFkZXIgLnVpLXByaW9yaXR5LXByaW1hcnkgew0KCWZvbnQtd2VpZ2h0OiBib2xkOw0KfQ0KLnVpLXByaW9yaXR5LXNlY29uZGFyeSwNCi51aS13aWRnZXQtY29udGVudCAudWktcHJpb3JpdHktc2Vjb25kYXJ5LA0KLnVpLXdpZGdldC1oZWFkZXIgLnVpLXByaW9yaXR5LXNlY29uZGFyeSB7DQoJb3BhY2l0eTogLjc7DQoJZmlsdGVyOkFscGhhKE9wYWNpdHk9NzApOyAvKiBzdXBwb3J0OiBJRTggKi8NCglmb250LXdlaWdodDogbm9ybWFsOw0KfQ0KLnVpLXN0YXRlLWRpc2FibGVkLA0KLnVpLXdpZGdldC1jb250ZW50IC51aS1zdGF0ZS1kaXNhYmxlZCwNCi51aS13aWRnZXQtaGVhZGVyIC51aS1zdGF0ZS1kaXNhYmxlZCB7DQoJb3BhY2l0eTogLjM1Ow0KCWZpbHRlcjpBbHBoYShPcGFjaXR5PTM1KTsgLyogc3VwcG9ydDogSUU4ICovDQoJYmFja2dyb3VuZC1pbWFnZTogbm9uZTsNCn0NCi51aS1zdGF0ZS1kaXNhYmxlZCAudWktaWNvbiB7DQoJZmlsdGVyOkFscGhhKE9wYWNpdHk9MzUpOyAvKiBzdXBwb3J0OiBJRTggLSBTZWUgIzYwNTkgKi8NCn0NCg0KLyogSWNvbnMNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLw0KDQovKiBzdGF0ZXMgYW5kIGltYWdlcyAqLw0KLnVpLWljb24gew0KCXdpZHRoOiAxNnB4Ow0KCWhlaWdodDogMTZweDsNCn0NCi51aS1pY29uLA0KLnVpLXdpZGdldC1jb250ZW50IC51aS1pY29uIHsNCgliYWNrZ3JvdW5kLWltYWdlOiB1cmwoImh0dHBzOi8vbG9jYWxob3N0OjgwODAvY29tcG9uZW50cy91c2VyLWludGVyZmFjZS90YWItc2xpZGUtb3V0LzEuMC91aS9pbWFnZXMvdWktaWNvbnNfNDQ0NDQ0XzI1NngyNDAucG5nIik7DQp9DQoudWktd2lkZ2V0LWhlYWRlciAudWktaWNvbiB7DQoJYmFja2dyb3VuZC1pbWFnZTogdXJsKCJodHRwczovL2xvY2FsaG9zdDo4MDgwL2NvbXBvbmVudHMvdXNlci1pbnRlcmZhY2UvdGFiLXNsaWRlLW91dC8xLjAvdWkvaW1hZ2VzL3VpLWljb25zXzQ0NDQ0NF8yNTZ4MjQwLnBuZyIpOw0KfQ0KLnVpLXN0YXRlLWhvdmVyIC51aS1pY29uLA0KLnVpLXN0YXRlLWZvY3VzIC51aS1pY29uLA0KLnVpLWJ1dHRvbjpob3ZlciAudWktaWNvbiwNCi51aS1idXR0b246Zm9jdXMgLnVpLWljb24gew0KCWJhY2tncm91bmQtaW1hZ2U6IHVybCgiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA4MC9jb21wb25lbnRzL3VzZXItaW50ZXJmYWNlL3RhYi1zbGlkZS1vdXQvMS4wL3VpL2ltYWdlcy91aS1pY29uc181NTU1NTVfMjU2eDI0MC5wbmciKTsNCn0NCi51aS1zdGF0ZS1hY3RpdmUgLnVpLWljb24sDQoudWktYnV0dG9uOmFjdGl2ZSAudWktaWNvbiB7DQoJYmFja2dyb3VuZC1pbWFnZTogdXJsKCJodHRwczovL2xvY2FsaG9zdDo4MDgwL2NvbXBvbmVudHMvdXNlci1pbnRlcmZhY2UvdGFiLXNsaWRlLW91dC8xLjAvdWkvaW1hZ2VzL3VpLWljb25zX2ZmZmZmZl8yNTZ4MjQwLnBuZyIpOw0KfQ0KLnVpLXN0YXRlLWhpZ2hsaWdodCAudWktaWNvbiwNCi51aS1idXR0b24gLnVpLXN0YXRlLWhpZ2hsaWdodC51aS1pY29uIHsNCgliYWNrZ3JvdW5kLWltYWdlOiB1cmwoImh0dHBzOi8vbG9jYWxob3N0OjgwODAvY29tcG9uZW50cy91c2VyLWludGVyZmFjZS90YWItc2xpZGUtb3V0LzEuMC91aS9pbWFnZXMvdWktaWNvbnNfNzc3NjIwXzI1NngyNDAucG5nIik7DQp9DQoudWktc3RhdGUtZXJyb3IgLnVpLWljb24sDQoudWktc3RhdGUtZXJyb3ItdGV4dCAudWktaWNvbiB7DQoJYmFja2dyb3VuZC1pbWFnZTogdXJsKCJodHRwczovL2xvY2FsaG9zdDo4MDgwL2NvbXBvbmVudHMvdXNlci1pbnRlcmZhY2UvdGFiLXNsaWRlLW91dC8xLjAvdWkvaW1hZ2VzL3VpLWljb25zX2NjMDAwMF8yNTZ4MjQwLnBuZyIpOw0KfQ0KLnVpLWJ1dHRvbiAudWktaWNvbiB7DQoJYmFja2dyb3VuZC1pbWFnZTogdXJsKCJodHRwczovL2xvY2FsaG9zdDo4MDgwL2NvbXBvbmVudHMvdXNlci1pbnRlcmZhY2UvdGFiLXNsaWRlLW91dC8xLjAvdWkvaW1hZ2VzL3VpLWljb25zXzc3Nzc3N18yNTZ4MjQwLnBuZyIpOw0KfQ0KDQovKiBwb3NpdGlvbmluZyAqLw0KLnVpLWljb24tYmxhbmsgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAxNnB4IDE2cHg7IH0NCi51aS1pY29uLWNhcmV0LTEtbiB7IGJhY2tncm91bmQtcG9zaXRpb246IDAgMDsgfQ0KLnVpLWljb24tY2FyZXQtMS1uZSB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNnB4IDA7IH0NCi51aS1pY29uLWNhcmV0LTEtZSB7IGJhY2tncm91bmQtcG9zaXRpb246IC0zMnB4IDA7IH0NCi51aS1pY29uLWNhcmV0LTEtc2UgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNDhweCAwOyB9DQoudWktaWNvbi1jYXJldC0xLXMgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNjVweCAwOyB9DQoudWktaWNvbi1jYXJldC0xLXN3IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTgwcHggMDsgfQ0KLnVpLWljb24tY2FyZXQtMS13IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTk2cHggMDsgfQ0KLnVpLWljb24tY2FyZXQtMS1udyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xMTJweCAwOyB9DQoudWktaWNvbi1jYXJldC0yLW4tcyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xMjhweCAwOyB9DQoudWktaWNvbi1jYXJldC0yLWUtdyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNDRweCAwOyB9DQoudWktaWNvbi10cmlhbmdsZS0xLW4geyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAwIC0xNnB4OyB9DQoudWktaWNvbi10cmlhbmdsZS0xLW5lIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE2cHggLTE2cHg7IH0NCi51aS1pY29uLXRyaWFuZ2xlLTEtZSB7IGJhY2tncm91bmQtcG9zaXRpb246IC0zMnB4IC0xNnB4OyB9DQoudWktaWNvbi10cmlhbmdsZS0xLXNlIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTQ4cHggLTE2cHg7IH0NCi51aS1pY29uLXRyaWFuZ2xlLTEtcyB7IGJhY2tncm91bmQtcG9zaXRpb246IC02NXB4IC0xNnB4OyB9DQoudWktaWNvbi10cmlhbmdsZS0xLXN3IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTgwcHggLTE2cHg7IH0NCi51aS1pY29uLXRyaWFuZ2xlLTEtdyB7IGJhY2tncm91bmQtcG9zaXRpb246IC05NnB4IC0xNnB4OyB9DQoudWktaWNvbi10cmlhbmdsZS0xLW53IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTExMnB4IC0xNnB4OyB9DQoudWktaWNvbi10cmlhbmdsZS0yLW4tcyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xMjhweCAtMTZweDsgfQ0KLnVpLWljb24tdHJpYW5nbGUtMi1lLXcgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTQ0cHggLTE2cHg7IH0NCi51aS1pY29uLWFycm93LTEtbiB7IGJhY2tncm91bmQtcG9zaXRpb246IDAgLTMycHg7IH0NCi51aS1pY29uLWFycm93LTEtbmUgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTZweCAtMzJweDsgfQ0KLnVpLWljb24tYXJyb3ctMS1lIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTMycHggLTMycHg7IH0NCi51aS1pY29uLWFycm93LTEtc2UgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNDhweCAtMzJweDsgfQ0KLnVpLWljb24tYXJyb3ctMS1zIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTY1cHggLTMycHg7IH0NCi51aS1pY29uLWFycm93LTEtc3cgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtODBweCAtMzJweDsgfQ0KLnVpLWljb24tYXJyb3ctMS13IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTk2cHggLTMycHg7IH0NCi51aS1pY29uLWFycm93LTEtbncgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTEycHggLTMycHg7IH0NCi51aS1pY29uLWFycm93LTItbi1zIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTEyOHB4IC0zMnB4OyB9DQoudWktaWNvbi1hcnJvdy0yLW5lLXN3IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE0NHB4IC0zMnB4OyB9DQoudWktaWNvbi1hcnJvdy0yLWUtdyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNjBweCAtMzJweDsgfQ0KLnVpLWljb24tYXJyb3ctMi1zZS1udyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNzZweCAtMzJweDsgfQ0KLnVpLWljb24tYXJyb3dzdG9wLTEtbiB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xOTJweCAtMzJweDsgfQ0KLnVpLWljb24tYXJyb3dzdG9wLTEtZSB7IGJhY2tncm91bmQtcG9zaXRpb246IC0yMDhweCAtMzJweDsgfQ0KLnVpLWljb24tYXJyb3dzdG9wLTEtcyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0yMjRweCAtMzJweDsgfQ0KLnVpLWljb24tYXJyb3dzdG9wLTEtdyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0yNDBweCAtMzJweDsgfQ0KLnVpLWljb24tYXJyb3d0aGljay0xLW4geyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAxcHggLTQ4cHg7IH0NCi51aS1pY29uLWFycm93dGhpY2stMS1uZSB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNnB4IC00OHB4OyB9DQoudWktaWNvbi1hcnJvd3RoaWNrLTEtZSB7IGJhY2tncm91bmQtcG9zaXRpb246IC0zMnB4IC00OHB4OyB9DQoudWktaWNvbi1hcnJvd3RoaWNrLTEtc2UgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNDhweCAtNDhweDsgfQ0KLnVpLWljb24tYXJyb3d0aGljay0xLXMgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNjRweCAtNDhweDsgfQ0KLnVpLWljb24tYXJyb3d0aGljay0xLXN3IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTgwcHggLTQ4cHg7IH0NCi51aS1pY29uLWFycm93dGhpY2stMS13IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTk2cHggLTQ4cHg7IH0NCi51aS1pY29uLWFycm93dGhpY2stMS1udyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xMTJweCAtNDhweDsgfQ0KLnVpLWljb24tYXJyb3d0aGljay0yLW4tcyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xMjhweCAtNDhweDsgfQ0KLnVpLWljb24tYXJyb3d0aGljay0yLW5lLXN3IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE0NHB4IC00OHB4OyB9DQoudWktaWNvbi1hcnJvd3RoaWNrLTItZS13IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE2MHB4IC00OHB4OyB9DQoudWktaWNvbi1hcnJvd3RoaWNrLTItc2UtbncgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTc2cHggLTQ4cHg7IH0NCi51aS1pY29uLWFycm93dGhpY2tzdG9wLTEtbiB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xOTJweCAtNDhweDsgfQ0KLnVpLWljb24tYXJyb3d0aGlja3N0b3AtMS1lIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTIwOHB4IC00OHB4OyB9DQoudWktaWNvbi1hcnJvd3RoaWNrc3RvcC0xLXMgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMjI0cHggLTQ4cHg7IH0NCi51aS1pY29uLWFycm93dGhpY2tzdG9wLTEtdyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0yNDBweCAtNDhweDsgfQ0KLnVpLWljb24tYXJyb3dyZXR1cm50aGljay0xLXcgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAwIC02NHB4OyB9DQoudWktaWNvbi1hcnJvd3JldHVybnRoaWNrLTEtbiB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNnB4IC02NHB4OyB9DQoudWktaWNvbi1hcnJvd3JldHVybnRoaWNrLTEtZSB7IGJhY2tncm91bmQtcG9zaXRpb246IC0zMnB4IC02NHB4OyB9DQoudWktaWNvbi1hcnJvd3JldHVybnRoaWNrLTEtcyB7IGJhY2tncm91bmQtcG9zaXRpb246IC00OHB4IC02NHB4OyB9DQoudWktaWNvbi1hcnJvd3JldHVybi0xLXcgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNjRweCAtNjRweDsgfQ0KLnVpLWljb24tYXJyb3dyZXR1cm4tMS1uIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTgwcHggLTY0cHg7IH0NCi51aS1pY29uLWFycm93cmV0dXJuLTEtZSB7IGJhY2tncm91bmQtcG9zaXRpb246IC05NnB4IC02NHB4OyB9DQoudWktaWNvbi1hcnJvd3JldHVybi0xLXMgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTEycHggLTY0cHg7IH0NCi51aS1pY29uLWFycm93cmVmcmVzaC0xLXcgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTI4cHggLTY0cHg7IH0NCi51aS1pY29uLWFycm93cmVmcmVzaC0xLW4geyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTQ0cHggLTY0cHg7IH0NCi51aS1pY29uLWFycm93cmVmcmVzaC0xLWUgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTYwcHggLTY0cHg7IH0NCi51aS1pY29uLWFycm93cmVmcmVzaC0xLXMgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTc2cHggLTY0cHg7IH0NCi51aS1pY29uLWFycm93LTQgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAwIC04MHB4OyB9DQoudWktaWNvbi1hcnJvdy00LWRpYWcgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTZweCAtODBweDsgfQ0KLnVpLWljb24tZXh0bGluayB7IGJhY2tncm91bmQtcG9zaXRpb246IC0zMnB4IC04MHB4OyB9DQoudWktaWNvbi1uZXd3aW4geyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNDhweCAtODBweDsgfQ0KLnVpLWljb24tcmVmcmVzaCB7IGJhY2tncm91bmQtcG9zaXRpb246IC02NHB4IC04MHB4OyB9DQoudWktaWNvbi1zaHVmZmxlIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTgwcHggLTgwcHg7IH0NCi51aS1pY29uLXRyYW5zZmVyLWUtdyB7IGJhY2tncm91bmQtcG9zaXRpb246IC05NnB4IC04MHB4OyB9DQoudWktaWNvbi10cmFuc2ZlcnRoaWNrLWUtdyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xMTJweCAtODBweDsgfQ0KLnVpLWljb24tZm9sZGVyLWNvbGxhcHNlZCB7IGJhY2tncm91bmQtcG9zaXRpb246IDAgLTk2cHg7IH0NCi51aS1pY29uLWZvbGRlci1vcGVuIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE2cHggLTk2cHg7IH0NCi51aS1pY29uLWRvY3VtZW50IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTMycHggLTk2cHg7IH0NCi51aS1pY29uLWRvY3VtZW50LWIgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNDhweCAtOTZweDsgfQ0KLnVpLWljb24tbm90ZSB7IGJhY2tncm91bmQtcG9zaXRpb246IC02NHB4IC05NnB4OyB9DQoudWktaWNvbi1tYWlsLWNsb3NlZCB7IGJhY2tncm91bmQtcG9zaXRpb246IC04MHB4IC05NnB4OyB9DQoudWktaWNvbi1tYWlsLW9wZW4geyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtOTZweCAtOTZweDsgfQ0KLnVpLWljb24tc3VpdGNhc2UgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTEycHggLTk2cHg7IH0NCi51aS1pY29uLWNvbW1lbnQgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTI4cHggLTk2cHg7IH0NCi51aS1pY29uLXBlcnNvbiB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNDRweCAtOTZweDsgfQ0KLnVpLWljb24tcHJpbnQgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTYwcHggLTk2cHg7IH0NCi51aS1pY29uLXRyYXNoIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE3NnB4IC05NnB4OyB9DQoudWktaWNvbi1sb2NrZWQgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTkycHggLTk2cHg7IH0NCi51aS1pY29uLXVubG9ja2VkIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTIwOHB4IC05NnB4OyB9DQoudWktaWNvbi1ib29rbWFyayB7IGJhY2tncm91bmQtcG9zaXRpb246IC0yMjRweCAtOTZweDsgfQ0KLnVpLWljb24tdGFnIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTI0MHB4IC05NnB4OyB9DQoudWktaWNvbi1ob21lIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogMCAtMTEycHg7IH0NCi51aS1pY29uLWZsYWcgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTZweCAtMTEycHg7IH0NCi51aS1pY29uLWNhbGVuZGFyIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTMycHggLTExMnB4OyB9DQoudWktaWNvbi1jYXJ0IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTQ4cHggLTExMnB4OyB9DQoudWktaWNvbi1wZW5jaWwgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNjRweCAtMTEycHg7IH0NCi51aS1pY29uLWNsb2NrIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTgwcHggLTExMnB4OyB9DQoudWktaWNvbi1kaXNrIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTk2cHggLTExMnB4OyB9DQoudWktaWNvbi1jYWxjdWxhdG9yIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTExMnB4IC0xMTJweDsgfQ0KLnVpLWljb24tem9vbWluIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTEyOHB4IC0xMTJweDsgfQ0KLnVpLWljb24tem9vbW91dCB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNDRweCAtMTEycHg7IH0NCi51aS1pY29uLXNlYXJjaCB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNjBweCAtMTEycHg7IH0NCi51aS1pY29uLXdyZW5jaCB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNzZweCAtMTEycHg7IH0NCi51aS1pY29uLWdlYXIgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTkycHggLTExMnB4OyB9DQoudWktaWNvbi1oZWFydCB7IGJhY2tncm91bmQtcG9zaXRpb246IC0yMDhweCAtMTEycHg7IH0NCi51aS1pY29uLXN0YXIgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMjI0cHggLTExMnB4OyB9DQoudWktaWNvbi1saW5rIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTI0MHB4IC0xMTJweDsgfQ0KLnVpLWljb24tY2FuY2VsIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogMCAtMTI4cHg7IH0NCi51aS1pY29uLXBsdXMgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTZweCAtMTI4cHg7IH0NCi51aS1pY29uLXBsdXN0aGljayB7IGJhY2tncm91bmQtcG9zaXRpb246IC0zMnB4IC0xMjhweDsgfQ0KLnVpLWljb24tbWludXMgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNDhweCAtMTI4cHg7IH0NCi51aS1pY29uLW1pbnVzdGhpY2sgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNjRweCAtMTI4cHg7IH0NCi51aS1pY29uLWNsb3NlIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTgwcHggLTEyOHB4OyB9DQoudWktaWNvbi1jbG9zZXRoaWNrIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTk2cHggLTEyOHB4OyB9DQoudWktaWNvbi1rZXkgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTEycHggLTEyOHB4OyB9DQoudWktaWNvbi1saWdodGJ1bGIgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTI4cHggLTEyOHB4OyB9DQoudWktaWNvbi1zY2lzc29ycyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNDRweCAtMTI4cHg7IH0NCi51aS1pY29uLWNsaXBib2FyZCB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNjBweCAtMTI4cHg7IH0NCi51aS1pY29uLWNvcHkgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTc2cHggLTEyOHB4OyB9DQoudWktaWNvbi1jb250YWN0IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE5MnB4IC0xMjhweDsgfQ0KLnVpLWljb24taW1hZ2UgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMjA4cHggLTEyOHB4OyB9DQoudWktaWNvbi12aWRlbyB7IGJhY2tncm91bmQtcG9zaXRpb246IC0yMjRweCAtMTI4cHg7IH0NCi51aS1pY29uLXNjcmlwdCB7IGJhY2tncm91bmQtcG9zaXRpb246IC0yNDBweCAtMTI4cHg7IH0NCi51aS1pY29uLWFsZXJ0IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogMCAtMTQ0cHg7IH0NCi51aS1pY29uLWluZm8geyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTZweCAtMTQ0cHg7IH0NCi51aS1pY29uLW5vdGljZSB7IGJhY2tncm91bmQtcG9zaXRpb246IC0zMnB4IC0xNDRweDsgfQ0KLnVpLWljb24taGVscCB7IGJhY2tncm91bmQtcG9zaXRpb246IC00OHB4IC0xNDRweDsgfQ0KLnVpLWljb24tY2hlY2sgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNjRweCAtMTQ0cHg7IH0NCi51aS1pY29uLWJ1bGxldCB7IGJhY2tncm91bmQtcG9zaXRpb246IC04MHB4IC0xNDRweDsgfQ0KLnVpLWljb24tcmFkaW8tb24geyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtOTZweCAtMTQ0cHg7IH0NCi51aS1pY29uLXJhZGlvLW9mZiB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xMTJweCAtMTQ0cHg7IH0NCi51aS1pY29uLXBpbi13IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTEyOHB4IC0xNDRweDsgfQ0KLnVpLWljb24tcGluLXMgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTQ0cHggLTE0NHB4OyB9DQoudWktaWNvbi1wbGF5IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogMCAtMTYwcHg7IH0NCi51aS1pY29uLXBhdXNlIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE2cHggLTE2MHB4OyB9DQoudWktaWNvbi1zZWVrLW5leHQgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMzJweCAtMTYwcHg7IH0NCi51aS1pY29uLXNlZWstcHJldiB7IGJhY2tncm91bmQtcG9zaXRpb246IC00OHB4IC0xNjBweDsgfQ0KLnVpLWljb24tc2Vlay1lbmQgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNjRweCAtMTYwcHg7IH0NCi51aS1pY29uLXNlZWstc3RhcnQgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtODBweCAtMTYwcHg7IH0NCi8qIHVpLWljb24tc2Vlay1maXJzdCBpcyBkZXByZWNhdGVkLCB1c2UgdWktaWNvbi1zZWVrLXN0YXJ0IGluc3RlYWQgKi8NCi51aS1pY29uLXNlZWstZmlyc3QgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtODBweCAtMTYwcHg7IH0NCi51aS1pY29uLXN0b3AgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtOTZweCAtMTYwcHg7IH0NCi51aS1pY29uLWVqZWN0IHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTExMnB4IC0xNjBweDsgfQ0KLnVpLWljb24tdm9sdW1lLW9mZiB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xMjhweCAtMTYwcHg7IH0NCi51aS1pY29uLXZvbHVtZS1vbiB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNDRweCAtMTYwcHg7IH0NCi51aS1pY29uLXBvd2VyIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogMCAtMTc2cHg7IH0NCi51aS1pY29uLXNpZ25hbC1kaWFnIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE2cHggLTE3NnB4OyB9DQoudWktaWNvbi1zaWduYWwgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMzJweCAtMTc2cHg7IH0NCi51aS1pY29uLWJhdHRlcnktMCB7IGJhY2tncm91bmQtcG9zaXRpb246IC00OHB4IC0xNzZweDsgfQ0KLnVpLWljb24tYmF0dGVyeS0xIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTY0cHggLTE3NnB4OyB9DQoudWktaWNvbi1iYXR0ZXJ5LTIgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtODBweCAtMTc2cHg7IH0NCi51aS1pY29uLWJhdHRlcnktMyB7IGJhY2tncm91bmQtcG9zaXRpb246IC05NnB4IC0xNzZweDsgfQ0KLnVpLWljb24tY2lyY2xlLXBsdXMgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAwIC0xOTJweDsgfQ0KLnVpLWljb24tY2lyY2xlLW1pbnVzIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE2cHggLTE5MnB4OyB9DQoudWktaWNvbi1jaXJjbGUtY2xvc2UgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMzJweCAtMTkycHg7IH0NCi51aS1pY29uLWNpcmNsZS10cmlhbmdsZS1lIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTQ4cHggLTE5MnB4OyB9DQoudWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtcyB7IGJhY2tncm91bmQtcG9zaXRpb246IC02NHB4IC0xOTJweDsgfQ0KLnVpLWljb24tY2lyY2xlLXRyaWFuZ2xlLXcgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtODBweCAtMTkycHg7IH0NCi51aS1pY29uLWNpcmNsZS10cmlhbmdsZS1uIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTk2cHggLTE5MnB4OyB9DQoudWktaWNvbi1jaXJjbGUtYXJyb3ctZSB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xMTJweCAtMTkycHg7IH0NCi51aS1pY29uLWNpcmNsZS1hcnJvdy1zIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTEyOHB4IC0xOTJweDsgfQ0KLnVpLWljb24tY2lyY2xlLWFycm93LXcgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTQ0cHggLTE5MnB4OyB9DQoudWktaWNvbi1jaXJjbGUtYXJyb3ctbiB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xNjBweCAtMTkycHg7IH0NCi51aS1pY29uLWNpcmNsZS16b29taW4geyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTc2cHggLTE5MnB4OyB9DQoudWktaWNvbi1jaXJjbGUtem9vbW91dCB7IGJhY2tncm91bmQtcG9zaXRpb246IC0xOTJweCAtMTkycHg7IH0NCi51aS1pY29uLWNpcmNsZS1jaGVjayB7IGJhY2tncm91bmQtcG9zaXRpb246IC0yMDhweCAtMTkycHg7IH0NCi51aS1pY29uLWNpcmNsZXNtYWxsLXBsdXMgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAwIC0yMDhweDsgfQ0KLnVpLWljb24tY2lyY2xlc21hbGwtbWludXMgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTZweCAtMjA4cHg7IH0NCi51aS1pY29uLWNpcmNsZXNtYWxsLWNsb3NlIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTMycHggLTIwOHB4OyB9DQoudWktaWNvbi1zcXVhcmVzbWFsbC1wbHVzIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTQ4cHggLTIwOHB4OyB9DQoudWktaWNvbi1zcXVhcmVzbWFsbC1taW51cyB7IGJhY2tncm91bmQtcG9zaXRpb246IC02NHB4IC0yMDhweDsgfQ0KLnVpLWljb24tc3F1YXJlc21hbGwtY2xvc2UgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtODBweCAtMjA4cHg7IH0NCi51aS1pY29uLWdyaXAtZG90dGVkLXZlcnRpY2FsIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogMCAtMjI0cHg7IH0NCi51aS1pY29uLWdyaXAtZG90dGVkLWhvcml6b250YWwgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTZweCAtMjI0cHg7IH0NCi51aS1pY29uLWdyaXAtc29saWQtdmVydGljYWwgeyBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMzJweCAtMjI0cHg7IH0NCi51aS1pY29uLWdyaXAtc29saWQtaG9yaXpvbnRhbCB7IGJhY2tncm91bmQtcG9zaXRpb246IC00OHB4IC0yMjRweDsgfQ0KLnVpLWljb24tZ3JpcHNtYWxsLWRpYWdvbmFsLXNlIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTY0cHggLTIyNHB4OyB9DQoudWktaWNvbi1ncmlwLWRpYWdvbmFsLXNlIHsgYmFja2dyb3VuZC1wb3NpdGlvbjogLTgwcHggLTIyNHB4OyB9DQoNCg0KLyogTWlzYyB2aXN1YWxzDQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8NCg0KLyogQ29ybmVyIHJhZGl1cyAqLw0KLnVpLWNvcm5lci1hbGwsDQoudWktY29ybmVyLXRvcCwNCi51aS1jb3JuZXItbGVmdCwNCi51aS1jb3JuZXItdGwgew0KCWJvcmRlci10b3AtbGVmdC1yYWRpdXM6IDNweDsNCn0NCi51aS1jb3JuZXItYWxsLA0KLnVpLWNvcm5lci10b3AsDQoudWktY29ybmVyLXJpZ2h0LA0KLnVpLWNvcm5lci10ciB7DQoJYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6IDNweDsNCn0NCi51aS1jb3JuZXItYWxsLA0KLnVpLWNvcm5lci1ib3R0b20sDQoudWktY29ybmVyLWxlZnQsDQoudWktY29ybmVyLWJsIHsNCglib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOiAzcHg7DQp9DQoudWktY29ybmVyLWFsbCwNCi51aS1jb3JuZXItYm90dG9tLA0KLnVpLWNvcm5lci1yaWdodCwNCi51aS1jb3JuZXItYnIgew0KCWJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOiAzcHg7DQp9DQoNCi8qIE92ZXJsYXlzICovDQoudWktd2lkZ2V0LW92ZXJsYXkgew0KCWJhY2tncm91bmQ6ICNhYWFhYWE7DQoJb3BhY2l0eTogLjAwMzsNCglmaWx0ZXI6IEFscGhhKE9wYWNpdHk9LjMpOyAvKiBzdXBwb3J0OiBJRTggKi8NCn0NCi51aS13aWRnZXQtc2hhZG93IHsNCgktd2Via2l0LWJveC1zaGFkb3c6IDBweCAwcHggNXB4ICM2NjY2NjY7DQoJYm94LXNoYWRvdzogMHB4IDBweCA1cHggIzY2NjY2NjsNCn0NCg=="
                    },
                    {
                        "id": "ui/tab-slide-out-ui.css",
                        "css": "LnN3YWwyLWNvbnRhaW5lcnsNCiAgICB6LWluZGV4OiA5OTk5OTk5OTk5OTk5OTk5ICFpbXBvcnRhbnQ7DQp9DQoNCiNlci10YWItc2xpZGUtb3V0LWhhbmRsZSB7DQogICAgYmFja2dyb3VuZDogdXJsKCJodHRwczovL2xvY2FsaG9zdDo4MDgwL2NvbXBvbmVudHMvdXNlci1pbnRlcmZhY2UvdGFiLXNsaWRlLW91dC8xLjAvdWkvaW1hZ2VzL2xvZ29fdy5wbmciKSBuby1yZXBlYXQgY2VudGVyOw0KfQ0KDQoudGFiLXNsaWRlLW91dC1hbmltYXRlZHsNCiAgICBhbmltYXRpb246IHRhYi1zbGlkZS1vdXQtc2NhbGUtZWFzZUluQm91bmNlIDAuN3MgcmV2ZXJzZSBlYXNlLWluOw0KfQ0KDQoNCkBrZXlmcmFtZXMgdGFiLXNsaWRlLW91dC1zY2FsZS1lYXNlSW5Cb3VuY2Ugew0KICAgIDAlIHsNCiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxKTsNCiAgICB9DQoNCiAgICA0JSB7DQogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMC45OCk7DQogICAgfQ0KDQogICAgOCUgew0KICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDAuOTkpOw0KICAgIH0NCg0KICAgIDE4JSB7DQogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMC45NCk7DQogICAgfQ0KDQogICAgMjYlIHsNCiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgwLjk4KTsNCiAgICB9DQoNCiAgICA0NiUgew0KICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDAuNzUpOw0KICAgIH0NCg0KICAgIDY0JSB7DQogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMC45OCk7DQogICAgfQ0KDQogICAgNzYlIHsNCiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgwLjQ0KTsNCiAgICB9DQoNCiAgICA4OCUgew0KICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDAuMTEpOw0KICAgIH0NCg0KICAgIDEwMCUgew0KICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDApOw0KICAgIH0NCg0KfQ0KDQojZXItdGFiLXNsaWRlLW91dC1ncmlkLWNvbnRhaW5lciBidXR0b24sICNlci10YWItc2xpZGUtb3V0LXNwZWNpYWwtYnV0dG9uLWNvbnRhaW5lciBidXR0b24gew0KICAgYmFja2dyb3VuZC1jb2xvcjogI2ViZWJlYiAhaW1wb3J0YW50Ow0KICAgYm9yZGVyOiAzcHggb3V0c2V0ICNmNWY1ZjUgIWltcG9ydGFudDsNCiAgIGJveC1zaGFkb3c6IG5vbmUgIWltcG9ydGFudDsNCiAgIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7DQogICBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsNCn0NCg0KI2VyLXRhYi1zbGlkZS1vdXQtc3BlY2lhbC1idXR0b24tY29udGFpbmVyIHsNCiAgICBtYXJnaW4tdG9wOiAzcHg7DQogICAgcGFkZGluZy10b3A6IDNweDsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgYmxhY2s7DQp9DQoNCiNlci10YWItc2xpZGUtb3V0LWdyaWQtY29udGFpbmVyIGJ1dHRvbi5lYXN5LXJlYWRpbmctc2luZ2xlLWNob2ljZS1hY3RpdmUsIA0KI2VyLXRhYi1zbGlkZS1vdXQtZ3JpZC1jb250YWluZXIgYnV0dG9uLmVyLWJ1dHRvbi1hY3RpdmUsDQojZXItdGFiLXNsaWRlLW91dC1ncmlkLWNvbnRhaW5lciBidXR0b24uZWFzeS1yZWFkaW5nLWNvbnRpbnVvdXMtY2hvaWNlLWFjdGl2ZSB7DQogICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZjNjc5ICFpbXBvcnRhbnQ7DQp9DQoNCiNlci10YWItc2xpZGUtb3V0LWdyaWQtY29udGFpbmVyIGJ1dHRvbjphY3RpdmUgew0KICAgIGJvcmRlci1zdHlsZTogZ3Jvb3ZlICFpbXBvcnRhbnQ7DQp9DQoNCiNlci10YWItc2xpZGUtb3V0LWdyaWQtY29udGFpbmVyIGJ1dHRvbjpob3ZlciB7DQogIC8qIHRoaXMgcmVtb3ZlcyB0aGUgc3RhdGUgZnJvbSB0d28gc3RhdGUgYnV0dG9ucyAgYmFja2dyb3VuZC1jb2xvcjogI2RlZGVkZSAhaW1wb3J0YW50OyAqLw0KfQ0KDQojZXItdGFiLXNsaWRlLW91dC1ncmlkLWNvbnRhaW5lciBidXR0b246Zm9jdXMsIA0KI2VyLXRhYi1zbGlkZS1vdXQtaGFuZGxlOmZvY3VzLCANCiNlci10YWItc2xpZGUtb3V0LXNwZWNpYWwtYnV0dG9uLWNvbnRhaW5lciBidXR0b246Zm9jdXMgew0KICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCA3cHggYmx1ZSAhaW1wb3J0YW50Ow0KfQ0KDQojZXItdGFiLXNsaWRlLW91dC1oYW5kbGUgew0KICAgIGJveC1zaGFkb3c6IG5vbmUgIWltcG9ydGFudDsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94ICFpbXBvcnRhbnQ7DQp9"
                    },
                    {
                        "id": "ui/erTabSlideOut.css",
                        "css": "I2VyLXRhYi1zbGlkZS1vdXQtaGFuZGxlIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgcGFkZGluZzogN3B4Ow0KICAgIGJvcmRlcjogMnB4IHNvbGlkIGJsYWNrOw0KICAgIC13ZWJraXQtYmFja2dyb3VuZC1zaXplOiBjb250YWluOw0KICAgIC1tb3otYmFja2dyb3VuZC1zaXplOiBjb250YWluOw0KICAgIC1vLWJhY2tncm91bmQtc2l6ZTogY29udGFpbjsNCiAgICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47DQogICAgYmFja2dyb3VuZC1zaXplOiAxMDAlICFpbXBvcnRhbnQ7ICAgIA0KfQ0KDQojZXItdGFiLXNsaWRlLW91dC1ncmlkLWNvbnRhaW5lciB7DQogICAgZGlzcGxheTogZ3JpZDsNCiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IGF1dG8gYXV0bzsNCn0NCg0KI2VyLXRhYi1zbGlkZS1vdXQtc3BlY2lhbC1idXR0b24tY29udGFpbmVyIHsNCiAgICBkaXNwbGF5OiBncmlkOw0KICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogODBweCA4MHB4OyAgIA0KfQ0KDQojZXItdGFiLXNsaWRlLW91dCB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7DQogICAgcG9zaXRpb246IGZpeGVkOw0KfQ0KDQouZXItdGFiLXNsaWRlLW91dC1ncmlkLWhvcml6b250YWwgew0KICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsNCiAgICBtaW4td2lkdGg6IDk4cHggIWltcG9ydGFudDsNCiAgICBtYXgtd2lkdGg6IDEwMCUgIWltcG9ydGFudDsNCiAgICBmbG9hdDogbGVmdDsNCn0="
                    },
                    {
                        "id": "ui/erMobileToolTips.css",
                        "css": "LmVyVG9vbFRpcCB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHotaW5kZXg6IDEwMDsNCiAgICBjb2xvcjogYmxhY2s7DQogICAgYmFja2dyb3VuZC1jb2xvcjogc2lsdmVyOw0KICAgIGJvcmRlcjogMnB4IHNvbGlkIGRhcmtibHVlOw0KICAgIHBhZGRpbmc6IDJweDsNCn0="
                    }
                ]
            },
            "configuration": {
                "tabPositioning": "right",
                "buttonSize": 80,
                "remoteAssetDirectory": "https://localhost:8080//components/user-interface/tab-slide-out/1.0/ui/images"
            },
            "tools": [
                {
                    "function": {
                        "source": {
                            "id": "tts",
                            "engine": {
                                "id": "aws-polly-tts",
                                "version": "1.0",
                                "debugMode": false
                            },
                            "debugMode": false,
                            "name": "AWS: Polly",
                            "description": "Converts text to Speech",
                            "inputTypes": [
                                {
                                    "inputType": "Paragraph",
                                    "name": "Input paragraph",
                                    "description": "Paragraph to convert to audio"
                                },
                                {
                                    "inputType": "Word",
                                    "name": "Input word",
                                    "description": "Word to convert to audio"
                                }
                            ],
                            "outputTypes": [
                                {
                                    "outputType": "AudioType",
                                    "name": "Output",
                                    "description": "Image word"
                                }
                            ],
                            "defaultIcon": "assets/text-to-speech.png",
                            "defaultIconURL": "https://localhost:8080/components/engines/aws-polly-tts/1.0/assets/text-to-speech.png",
                            "remoteBaseDirectory": "components/engines/aws-polly-tts/1.0/",
                            "type": "RemoteFunction",
                            "entryPoint": "convertTextToSpeech"
                        },
                        "configuration": {
                            "language": "language_of_website",
                            "gender": "female"
                        }
                    },
                    "widget": {
                        "source": {
                            "id": "continuous-choice-button",
                            "name": "Continuous Choice Button",
                            "description": "A simple button.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "",
                            "remoteBaseDirectory": "components/widget/continuous-choice-button/1.0/",
                            "implementationClass": "ContinuousChoiceButton",
                            "contentScripts": [
                                {
                                    "id": "widget/continuous-choice-button.js",
                                    "source": "Y2xhc3MgQ29udGludW91c0Nob2ljZUJ1dHRvbiBleHRlbmRzIFdpZGdldEJhc2Ugew0KDQogICAgY29uc3RydWN0b3IoZnVuY3Rpb25JbmZvLCB1c2VySW50ZXJmYWNlLCB0YXJnZXRJRCwgY29uZmlndXJhdGlvbikgew0KICAgICAgICBzdXBlcihmdW5jdGlvbkluZm8sIHVzZXJJbnRlcmZhY2UsIHRhcmdldElELCBjb25maWd1cmF0aW9uKTsNCiAgICAgICAgdGhpcy5jb250aW51ZXNUb0NyZWF0ZVJlcXVlc3RzID0gdHJ1ZTsNCiAgICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTsNCiAgICAgICAgdGhpcy5yZXF1ZXN0SW5Qcm9ncmVzcyA9IGZhbHNlOw0KICAgICAgICB0aGlzLndpZGdldElEID0gJ2VyX2NvbnRpbnVvdXNfY2hvaWNlX2J1dHRvbl8nICsgdGhpcy53aWRnZXRJRDsNCiAgICAgICAgJCgiIyIgKyB0YXJnZXRJRCkuYXBwZW5kKCI8YnV0dG9uIGlkPSciICsgdGhpcy53aWRnZXRJRCArICInIGNsYXNzPSdlYXN5LXJlYWRpbmctY29udGludW91cy1jaG9pY2UgZWFzeS1yZWFkaW5nLWJ1dHRvbic+PGltZyBzcmM9JyIgKyBmdW5jdGlvbkluZm8uc291cmNlLmRlZmF1bHRJY29uVVJMICsgIicgdGl0bGU9JyIgKyBmdW5jdGlvbkluZm8uc291cmNlLm5hbWUgKyAiOiAiICsgZnVuY3Rpb25JbmZvLnNvdXJjZS5kZXNjcmlwdGlvbiArICInPiA8L2J1dHRvbj4iKTsNCg0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFkZFByZXNlbnRhdGlvbkZpbmlzaExpc3RlbmVyKHRoaXMpOw0KDQogICAgICAgIHRoaXMuaHRtbEl0ZXJhdG9yID0gbnVsbDsNCiAgICAgICAgdGhpcy50ZXh0U2VsZWN0aW9uID0gbnVsbDsNCiAgICAgICAgdGhpcy5lbmFibGUoKTsNCg0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFkZFdpZGdldEFjdGl2YXRlZExpc3RlbmVycyh0aGlzKTsNCg0KICAgIH0NCg0KDQogICAgZW5hYmxlKCkgew0KICAgICAgICAkKCIjIiArIHRoaXMud2lkZ2V0SUQpLm9uKCJjbGljayIsIHRoaXMsIHRoaXMuY29udGludW91c0Nob2ljZUJ1dHRvbkNsaWNrZWQpOw0KDQogICAgfQ0KDQogICAgZGlzYWJsZSgpIHsNCiAgICAgICAgJCgiIyIgKyB0aGlzLndpZGdldElEKS5vZmYoImNsaWNrIiwgdGhpcywgdGhpcy5jb250aW51b3VzQ2hvaWNlQnV0dG9uQ2xpY2tlZCk7DQogICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIucmVtb3ZlV2lkZ2V0QWN0aXZhdGVkTGlzdGVuZXJzKHRoaXMpOw0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLnJlbW92ZVByZXNlbnRhdGlvbkZpbmlzaExpc3RlbmVyKHRoaXMpOw0KDQoNCiAgICB9DQoNCiAgICBhY3RpdmF0ZVdpZGdldCgpew0KICAgICAgICBjb25zb2xlLmxvZygiY29udGludW91cyBDaG9pY2UgQnV0dG9uIEFjdGl2ZSIpOw0KICAgICAgICAkKCIjIiArIHRoaXMud2lkZ2V0SUQpLmFkZENsYXNzKCJlYXN5LXJlYWRpbmctY29udGludW91cy1jaG9pY2UtYWN0aXZlIik7DQoNCg0KICAgICAgICAvL09ubHkgY29uc2lkZXIgZmlyc3QgaW5wdXQgdHlwZSBhcyB2YWxpZCBvbmUNCiAgICAgICAgaWYodGhpcy5mdW5jdGlvbkluZm8uc291cmNlLmlucHV0VHlwZXMubGVuZ3RoID4gMCl7DQogICAgICAgICAgICBzd2l0Y2ggKHRoaXMuZnVuY3Rpb25JbmZvLnNvdXJjZS5pbnB1dFR5cGVzWzBdLmlucHV0VHlwZSkgew0KICAgICAgICAgICAgICAgIGNhc2UgV29yZC5jbGFzc05hbWU6DQogICAgICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWRkV29yZENsaWNrTGlzdGVuZXIodGhpcyx0aGlzLmdldFByZXNlbnRhdGlvbigpLmlzQ29tcGF0aWJsZVdpdGhPdGhlclByZXNlbnRhdGlvbnMpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIFBhcmFncmFwaC5jbGFzc05hbWU6DQogICAgICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWRkUGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcih0aGlzLHRoaXMuZ2V0UHJlc2VudGF0aW9uKCkuaXNDb21wYXRpYmxlV2l0aE90aGVyUHJlc2VudGF0aW9ucyk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci53aWRnZXRBY3RpdmF0ZWQodGhpcyk7DQoNCiAgICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlOw0KICAgIH0NCg0KICAgIGRlYWN0aXZhdGVXaWRnZXQobWFudWFsPXRydWUpew0KICAgICAgICBzdXBlci5kZWFjdGl2YXRlV2lkZ2V0KG1hbnVhbCk7DQoNCg0KICAgICAgICBjb25zb2xlLmxvZygiY29udGludW91cyBDaG9pY2UgQnV0dG9uIE5vdCBBY3RpdmUiKTsNCiAgICAgICAgJCgiIyIgKyB0aGlzLndpZGdldElEKS5yZW1vdmVDbGFzcygiZWFzeS1yZWFkaW5nLWNvbnRpbnVvdXMtY2hvaWNlLWFjdGl2ZSIpOw0KDQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5mdW5jdGlvbkluZm8uc291cmNlLmlucHV0VHlwZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5mdW5jdGlvbkluZm8uc291cmNlLmlucHV0VHlwZXNbaV0uaW5wdXRUeXBlKSB7DQogICAgICAgICAgICAgICAgY2FzZSBXb3JkLmNsYXNzTmFtZToNCiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5yZW1vdmVXb3JkQ2xpY2tMaXN0ZW5lcih0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSBQYXJhZ3JhcGguY2xhc3NOYW1lOg0KICAgICAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLnJlbW92ZVBhcmFncmFwaENsaWNrTGlzdGVuZXIodGhpcyk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCg0KICAgICAgICBpZih0aGlzLmh0bWxJdGVyYXRvcil7DQogICAgICAgICAgICB0aGlzLmh0bWxJdGVyYXRvci5ub3JtYWxpemVPbGRUZXh0Tm9kZXMoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7DQogICAgfQ0KDQogICAgY29udGludW91c0Nob2ljZUJ1dHRvbkNsaWNrZWQoZSkgew0KDQogICAgICAgIGlmKGUuZGF0YS5hY3RpdmUpew0KICAgICAgICAgICAgZS5kYXRhLmRlYWN0aXZhdGVXaWRnZXQodHJ1ZSk7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgZS5kYXRhLmFjdGl2YXRlV2lkZ2V0KCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBvbldvcmRDbGljayh3b3JkLCBlKSB7DQogICAgICAgIGlmKHRoaXMucmVxdWVzdEluUHJvZ3Jlc3Mpew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIHRoaXMucmVxdWVzdEluUHJvZ3Jlc3MgPSB0cnVlOw0KDQogICAgICAgIGVhc3lSZWFkaW5nLmJ1c3lBbmltYXRpb24uc3RhcnRBbmltYXRpb24oKTsNCg0KICAgICAgICBpZighdGhpcy5maWx0ZXJVc2VySW50ZXJmYWNlRWxlbWVudHMod29yZCkpew0KICAgICAgICAgICAgcmVxdWVzdE1hbmFnZXIuY3JlYXRlUmVxdWVzdCh0aGlzLCB3b3JkLCBlKTsNCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgb25QYXJhZ3JhcGhDTGljayhwYXJhZ3JhcGgsIGUpIHsNCiAgICAgICAgaWYodGhpcy5yZXF1ZXN0SW5Qcm9ncmVzcyl7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5yZXF1ZXN0SW5Qcm9ncmVzcyA9IHRydWU7DQogICAgICAgIGVhc3lSZWFkaW5nLmJ1c3lBbmltYXRpb24uc3RhcnRBbmltYXRpb24oKTsNCg0KICAgICAgICBpZighdGhpcy5maWx0ZXJVc2VySW50ZXJmYWNlRWxlbWVudHMocGFyYWdyYXBoKSl7DQoNCiAgICAgICAgICAgIHRoaXMuaHRtbEl0ZXJhdG9yID0gbmV3IEhUTUxJdGVyYXRvcihwYXJhZ3JhcGguZWxlbWVudCk7DQoNCg0KICAgICAgICAgICAgbGV0IGN1cnJlbnRQYXJhZ3JhcGggPSB0aGlzLmh0bWxJdGVyYXRvci5nZXROZXh0RWxlbWVudHMoKTsNCiAgICAgICAgICAgIGlmKGN1cnJlbnRQYXJhZ3JhcGgpew0KICAgICAgICAgICAgICAgIHRoaXMudGV4dFNlbGVjdGlvbiA9ICBuZXcgVGV4dFNlbGVjdGlvbihjdXJyZW50UGFyYWdyYXBoLnRleHROb2Rlcyw1MDApOw0KICAgICAgICAgICAgICAgIGxldCBuZXh0UGFyYWdyYXBoID0gdGhpcy50ZXh0U2VsZWN0aW9uLmdldE5leHRQYXJhZ3JhcGgoKTsNCiAgICAgICAgICAgICAgICBpZihuZXh0UGFyYWdyYXBoKXsNCiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdE1hbmFnZXIuY3JlYXRlUmVxdWVzdCh0aGlzLCBuZXh0UGFyYWdyYXBoLCBlKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmaWx0ZXJVc2VySW50ZXJmYWNlRWxlbWVudHMoZWxlbWVudCl7DQogICAgICAgIHJldHVybiAkKGVsZW1lbnQpLnBhcmVudHMoJy5lYXN5LXJlYWRpbmctaW50ZXJmYWNlJykubGVuZ3RoOw0KICAgIH0NCg0KICAgIHByZXNlbnRhdGlvbkZpbmlzaGVkKHByZXNlbnRhdGlvbil7DQoNCiAgICAgICAgaWYoIXRoaXMuYWN0aXZlIHx8ICF0aGlzLnRleHRTZWxlY3Rpb24pew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgbGV0IG5leHRQYXJhZ3JhcGggPSB0aGlzLnRleHRTZWxlY3Rpb24uZ2V0TmV4dFBhcmFncmFwaCgpOw0KICAgICAgICBpZihuZXh0UGFyYWdyYXBoKXsNCiAgICAgICAgICAgIHJlcXVlc3RNYW5hZ2VyLmNyZWF0ZVJlcXVlc3QodGhpcywgbmV4dFBhcmFncmFwaCwgbnVsbCwgdHJ1ZSk7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgbGV0IG5leHRFbGVtZW50cyA9IHRoaXMuaHRtbEl0ZXJhdG9yLmdldE5leHRFbGVtZW50cygpOw0KICAgICAgICAgICAgaWYobmV4dEVsZW1lbnRzKXsNCiAgICAgICAgICAgICAgICB0aGlzLnRleHRTZWxlY3Rpb24gPSAgbmV3IFRleHRTZWxlY3Rpb24obmV4dEVsZW1lbnRzLnRleHROb2Rlcyw1MDApOw0KICAgICAgICAgICAgICAgIG5leHRQYXJhZ3JhcGggPSB0aGlzLnRleHRTZWxlY3Rpb24uZ2V0TmV4dFBhcmFncmFwaCgpOw0KICAgICAgICAgICAgICAgIGlmKG5leHRQYXJhZ3JhcGgpew0KICAgICAgICAgICAgICAgICAgICByZXF1ZXN0TWFuYWdlci5jcmVhdGVSZXF1ZXN0KHRoaXMsIG5leHRQYXJhZ3JhcGgsIG51bGwsIHRydWUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghbmV4dFBhcmFncmFwaCkgew0KICAgICAgICAgICAgY29uc29sZS5sb2coJ25vIG5leHQgcGFyYWdyYXBoIGZvdW5kISEnKTsNCiAgICAgICAgICAgIGNvbnRlbnRTY3JpcHRDb250cm9sbGVyLnNlbmRNZXNzYWdlVG9CYWNrZ3JvdW5kU2NyaXB0KHsNCiAgICAgICAgICAgICAgICB0eXBlOiAiaGVscENvbXBsZXRlIiwNCiAgICAgICAgICAgICAgICB1aV9pOiB0aGlzLnVzZXJJbnRlcmZhY2UuaWQsDQogICAgICAgICAgICAgICAgdG9vbF9pOiB0aGlzLnRvb2xJZCwNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICByZXF1ZXN0RmluaXNoZWQoKXsNCiAgICAgICAgc3VwZXIucmVxdWVzdEZpbmlzaGVkKCk7DQogICAgICAgIGVhc3lSZWFkaW5nLmJ1c3lBbmltYXRpb24uc3RvcEFuaW1hdGlvbigpOw0KICAgICAgICB0aGlzLnJlcXVlc3RJblByb2dyZXNzID0gZmFsc2U7DQogICAgfQ0KDQogICAgcmVtb3ZlKCl7DQoNCg0KICAgICAgICBpZih0aGlzLmFjdGl2ZSl7DQogICAgICAgICAgICB0aGlzLmRlYWN0aXZhdGVXaWRnZXQoZmFsc2UpOw0KICAgICAgICB9DQogICAgICAgIHRoaXMuZGlzYWJsZSgpOw0KDQogICAgICAgICQoIiMiICsgdGhpcy53aWRnZXRJRCkucmVtb3ZlKCk7DQogICAgfQ0KfQ=="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "widget/continuous-choice-button.css",
                                    "css": "LmVhc3ktcmVhZGluZy1jb250aW51b3VzLWNob2ljZT5pbWd7DQogICAgbWF4LXdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7DQp9DQoNCi5lYXN5LXJlYWRpbmctY29udGludW91cy1jaG9pY2UtYWN0aXZlew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmM2NzkgIWltcG9ydGFudDsNCn0NCg0KLmVhc3ktcmVhZGluZy1jb250aW51b3VzLWNob2ljZXsNCiAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmUgIWltcG9ydGFudDsNCiAgICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDAgIWltcG9ydGFudDsNCiAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7DQp9DQoNCg=="
                                }
                            ]
                        }
                    },
                    "presentation": {
                        "source": {
                            "id": "audio-highlighter",
                            "name": "AudioHighlighter",
                            "description": "Plays audio and highlights current spoken words",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "",
                            "remoteBaseDirectory": "components/presentation/audio-highlighter/1.0/",
                            "implementationClass": "AudioHighlighter",
                            "contentScripts": [
                                {
                                    "id": "presentation/audio-highlighter.js",
                                    "source": "Y2xhc3MgQXVkaW9IaWdobGlnaHRlciBleHRlbmRzIFByZXNlbnRhdGlvbiB7DQogICAgY29uc3RydWN0b3IoZnVuY3Rpb25JbmZvLCB1c2VySW50ZXJmYWNlLCBjb25maWd1cmF0aW9uKSB7DQoNCiAgICAgICAgc3VwZXIoZnVuY3Rpb25JbmZvLCB1c2VySW50ZXJmYWNlLCBjb25maWd1cmF0aW9uKTsNCg0KICAgICAgICB0aGlzLmF1ZGlvID0gbnVsbDsNCiAgICAgICAgdGhpcy5sYXN0RWxlbWVudCA9IG51bGw7DQogICAgICAgIHRoaXMud29yZFNwZWVjaE1hcmtzID0gbnVsbDsNCiAgICAgICAgdGhpcy53b3JkVGV4dE1hcmtlciA9IG51bGw7DQogICAgICAgIHRoaXMuc2VudGVuY2VUZXh0TWFya2VyID0gbnVsbDsNCiAgICAgICAgdGhpcy5zZW50ZW5jZVNwZWVjaE1hcmtzID0gW107DQogICAgICAgIHRoaXMuaXNDb21wYXRpYmxlV2l0aE90aGVyUHJlc2VudGF0aW9ucyA9IHRydWU7DQogICAgICAgIHRoaXMuaW5zdGFudERpc3BsYXkgPSBmYWxzZTsNCiAgICB9DQoNCiAgICByZW5kZXJSZXN1bHQocmVxdWVzdCwgcmVzdWx0KSB7DQoNCiAgICAgICAgbGV0IGlvUmVzID0gaW9UeXBlVXRpbHMudG9JT1R5cGVJbnN0YW5jZShyZXN1bHQucmVzdWx0KTsNCg0KDQogICAgICAgIGlmICh0aGlzLndvcmRUZXh0TWFya2VyKSB7DQogICAgICAgICAgICB0aGlzLndvcmRUZXh0TWFya2VyLnJlbW92ZSgpOw0KICAgICAgICB9DQogICAgICAgIGlmICh0aGlzLnNlbnRlbmNlVGV4dE1hcmtlcikgew0KICAgICAgICAgICAgdGhpcy5zZW50ZW5jZVRleHRNYXJrZXIucmVtb3ZlKCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAodGhpcy5sYXN0RWxlbWVudCkgew0KICAgICAgICAgICAgJCh0aGlzLmxhc3RFbGVtZW50KS5yZW1vdmVDbGFzcygiaGlnaGxpZ2h0LWF1ZGlvIik7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGlvUmVzLm5hbWUgPT09ICJBdWRpb1R5cGUiKSB7DQoNCg0KICAgICAgICAgICAgdGhpcy5zZW50ZW5jZVNwZWVjaE1hcmtzID0gW107DQogICAgICAgICAgICBsZXQgc2VudGVuY2VzID0gW107DQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlvUmVzLnNwZWVjaE1hcmtzLmxlbmd0aDsgaSsrKSB7DQoNCiAgICAgICAgICAgICAgICBpZiAoaW9SZXMuc3BlZWNoTWFya3NbaV0udHlwZSA9PT0gInNlbnRlbmNlIikgew0KDQogICAgICAgICAgICAgICAgICAgIC8vQVdTIFNQRUNJRklDIFNUVUZGDQogICAgICAgICAgICAgICAgICAgIC8vQWxsb3cgb25seSB1bmlxdWUgc3RhcnRzLiBBV1Mgc29tZXRpbWVzIHByb2R1Y2VzIG1vcmUgc3BlZWNobWFya3Mgd2l0aCBzYW1lIHN0YXJ0KGUuZzogMTg0NS0xOTI4IHdpbGwgcmV0dXJuIDMgc3BlZWNobWFya3MpIHRoaXMgd2lsbCBjb25mdXNlIGhpZ2hsaWdodG5pbmcNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VudGVuY2VTcGVlY2hNYXJrcy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZW50ZW5jZVNwZWVjaE1hcmtzW3RoaXMuc2VudGVuY2VTcGVlY2hNYXJrcy5sZW5ndGggLSAxXS5zdGFydCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbnRlbmNlU3BlZWNoTWFya3NbdGhpcy5zZW50ZW5jZVNwZWVjaE1hcmtzLmxlbmd0aCAtIDFdLnN0YXJ0ID09PSBpb1Jlcy5zcGVlY2hNYXJrc1tpXS5zdGFydCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbnRlbmNlU3BlZWNoTWFya3NbdGhpcy5zZW50ZW5jZVNwZWVjaE1hcmtzLmxlbmd0aCAtIDFdLmVuZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbnRlbmNlU3BlZWNoTWFya3NbdGhpcy5zZW50ZW5jZVNwZWVjaE1hcmtzLmxlbmd0aCAtIDFdLmVuZCA9PT0gaW9SZXMuc3BlZWNoTWFya3NbaV0uZW5kKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICAgICAgc2VudGVuY2VzLnB1c2goaW9SZXMuc3BlZWNoTWFya3NbaV0udmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbnRlbmNlU3BlZWNoTWFya3MucHVzaChpb1Jlcy5zcGVlY2hNYXJrc1tpXSk7DQoNCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICB0aGlzLnNlbnRlbmNlVGV4dE1hcmtlciA9IG5ldyBUZXh0TWFya2VyKHJlcXVlc3QuaW5wdXQudGV4dE5vZGVzLCBzZW50ZW5jZXMsIHsNCiAgICAgICAgICAgICAgICBoaWdobGlnaHRFbGVtZW50TmFtZTogInNwYW4iLA0KICAgICAgICAgICAgICAgIGhpZ2hsaWdodEVsZW1lbnRDbGFzczogInNlbnRlbmNlLWhpZ2hsaWdodGVyIiwNCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICIjM2VjZmZmIiwNCiAgICAgICAgICAgICAgICBjb2xvcjogImluaGVyaXQiLA0KDQogICAgICAgICAgICB9KTsNCg0KDQogICAgICAgICAgICB0aGlzLndvcmRTcGVlY2hNYXJrcyA9IFtdOw0KICAgICAgICAgICAgbGV0IHdvcmRzID0gW107DQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlvUmVzLnNwZWVjaE1hcmtzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgaWYgKGlvUmVzLnNwZWVjaE1hcmtzW2ldLnR5cGUgPT09ICJ3b3JkIikgew0KDQogICAgICAgICAgICAgICAgICAgIC8vQVdTIFNQRUNJRklDIFNUVUZGDQogICAgICAgICAgICAgICAgICAgIC8vQWxsb3cgb25seSB1bmlxdWUgc3RhcnRzLiBBV1Mgc29tZXRpbWVzIHByb2R1Y2VzIG1vcmUgc3BlZWNobWFya3Mgd2l0aCBzYW1lIHN0YXJ0KGUuZzogMTg0NS0xOTI4IHdpbGwgcmV0dXJuIDMgc3BlZWNobWFya3MpIHRoaXMgd2lsbCBjb25mdXNlIGhpZ2hsaWdodG5pbmcNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMud29yZFNwZWVjaE1hcmtzLmxlbmd0aCA+IDApIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMud29yZFNwZWVjaE1hcmtzW3RoaXMud29yZFNwZWVjaE1hcmtzLmxlbmd0aCAtIDFdLnN0YXJ0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMud29yZFNwZWVjaE1hcmtzW3RoaXMud29yZFNwZWVjaE1hcmtzLmxlbmd0aCAtIDFdLnN0YXJ0ID09PSBpb1Jlcy5zcGVlY2hNYXJrc1tpXS5zdGFydCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMud29yZFNwZWVjaE1hcmtzW3RoaXMud29yZFNwZWVjaE1hcmtzLmxlbmd0aCAtIDFdLmVuZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLndvcmRTcGVlY2hNYXJrc1t0aGlzLndvcmRTcGVlY2hNYXJrcy5sZW5ndGggLSAxXS5lbmQgPT09IGlvUmVzLnNwZWVjaE1hcmtzW2ldLmVuZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgd29yZHMucHVzaChpb1Jlcy5zcGVlY2hNYXJrc1tpXS52YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMud29yZFNwZWVjaE1hcmtzLnB1c2goaW9SZXMuc3BlZWNoTWFya3NbaV0pOw0KDQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLndvcmRUZXh0TWFya2VyID0gbmV3IFRleHRNYXJrZXIocmVxdWVzdC5pbnB1dC50ZXh0Tm9kZXMsIHdvcmRzKTsNCg0KICAgICAgICAgICAgaWYgKHRoaXMuYXVkaW8pIHsNCiAgICAgICAgICAgICAgICB0aGlzLmF1ZGlvLnBhdXNlKCk7DQogICAgICAgICAgICAgICAgdGhpcy5hdWRpbyA9IG51bGw7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuYXVkaW8gPSBuZXcgQXVkaW8oaW9SZXMubXAzVVJMKTsNCiAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZ3VyYXRpb24uc3BlZWQpIHsNCiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb25maWd1cmF0aW9uLnNwZWVkID09PSAic2xvdyIpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdWRpby5wbGF5YmFja1JhdGUgPSAwLjc7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmNvbmZpZ3VyYXRpb24uc3BlZWQgPT09ICJmYXN0Iikgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmF1ZGlvLnBsYXliYWNrUmF0ZSA9IDEuMzsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy9EaXNhYmxlIGhpZ2hsaWdodGluZyBiZWNhdXNlIG1hcmsuanMgZG9lcyBub3Qgd29yayBwcm9wZXJseQ0KDQogICAgICAgICAgICBsZXQgY3VycmVudEhpZ2hsaWdodFNlbnRlbmNlID0gMDsNCiAgICAgICAgICAgIGxldCBjdXJyZW50SGlnaGxpZ2h0V29yZCA9IDA7DQoNCiAgICAgICAgICAgIGxldCBhdWRpb0hpZ2hsaWdodGVyID0gdGhpczsNCiAgICAgICAgICAgIHRoaXMuYXVkaW8ub250aW1ldXBkYXRlID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIGlmIChjdXJyZW50SGlnaGxpZ2h0U2VudGVuY2UgKyAxIDwgYXVkaW9IaWdobGlnaHRlci5zZW50ZW5jZVNwZWVjaE1hcmtzLmxlbmd0aCkgew0KDQogICAgICAgICAgICAgICAgICAgIGlmIChhdWRpb0hpZ2hsaWdodGVyLnNlbnRlbmNlU3BlZWNoTWFya3NbY3VycmVudEhpZ2hsaWdodFNlbnRlbmNlICsgMV0udGltZSA8IGF1ZGlvSGlnaGxpZ2h0ZXIuYXVkaW8uY3VycmVudFRpbWUgKiAxMDAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50SGlnaGxpZ2h0U2VudGVuY2UrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF1ZGlvSGlnaGxpZ2h0ZXIuc2VudGVuY2VUZXh0TWFya2VyLm1hcmtOZXh0KCk7DQoNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRIaWdobGlnaHRXb3JkICsgMSA8IGF1ZGlvSGlnaGxpZ2h0ZXIud29yZFNwZWVjaE1hcmtzLmxlbmd0aCkgew0KDQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKGF1ZGlvSGlnaGxpZ2h0ZXIud29yZFNwZWVjaE1hcmtzW2N1cnJlbnRIaWdobGlnaHRXb3JkICsgMV0udGltZSA8IGF1ZGlvSGlnaGxpZ2h0ZXIuYXVkaW8uY3VycmVudFRpbWUgKiAxMDAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50SGlnaGxpZ2h0V29yZCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXVkaW9IaWdobGlnaHRlci53b3JkVGV4dE1hcmtlci5tYXJrTmV4dCgpOw0KDQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHRoaXMuc2VudGVuY2VUZXh0TWFya2VyLm1hcmtOZXh0KCk7DQogICAgICAgICAgICB0aGlzLndvcmRUZXh0TWFya2VyLm1hcmtOZXh0KCk7DQoNCiAgICAgICAgICAgIHRoaXMuYXVkaW8ucGxheSgpOw0KICAgICAgICAgICAgdGhpcy5hdWRpby5vbmVuZGVkID0gZnVuY3Rpb24gKCkgew0KDQogICAgICAgICAgICAgICAgaWYgKGF1ZGlvSGlnaGxpZ2h0ZXIud29yZFRleHRNYXJrZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgYXVkaW9IaWdobGlnaHRlci53b3JkVGV4dE1hcmtlci5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGF1ZGlvSGlnaGxpZ2h0ZXIuc2VudGVuY2VUZXh0TWFya2VyKSB7DQogICAgICAgICAgICAgICAgICAgIGF1ZGlvSGlnaGxpZ2h0ZXIuc2VudGVuY2VUZXh0TWFya2VyLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmIChhdWRpb0hpZ2hsaWdodGVyLmxhc3RFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgICAgICQoYXVkaW9IaWdobGlnaHRlci5sYXN0RWxlbWVudCkucmVtb3ZlQ2xhc3MoImhpZ2hsaWdodC1hdWRpbyIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLnByZXNlbnRhdGlvbkZpbmlzaGVkKGF1ZGlvSGlnaGxpZ2h0ZXIpOw0KICAgICAgICAgICAgfTsNCg0KICAgICAgICB9IGVsc2UgaWYgKGlvUmVzLm5hbWUgPT09ICJFcnJvciIpIHsNCg0KICAgICAgICAgICAgYWxlcnRNYW5hZ2VyLnNob3dFcnJvckFsZXJ0KGlvUmVzLm1lc3NhZ2UpOw0KDQogICAgICAgIH0gZWxzZSBpZiAoaW9SZXMubmFtZSA9PT0gIk5vUmVzdWx0Iikgew0KICAgICAgICAgICAgYWxlcnRNYW5hZ2VyLnNob3dFcnJvckFsZXJ0KGlvUmVzLm1lc3NhZ2UpOw0KICAgICAgICB9DQoNCg0KICAgIH0NCg0KICAgIHJlbW92ZVJlc3VsdChyZXF1ZXN0SUQpIHsNCg0KICAgICAgICBpZiAodGhpcy53b3JkVGV4dE1hcmtlcikgew0KICAgICAgICAgICAgdGhpcy53b3JkVGV4dE1hcmtlci5yZW1vdmUoKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAodGhpcy5zZW50ZW5jZVRleHRNYXJrZXIpIHsNCiAgICAgICAgICAgIHRoaXMuc2VudGVuY2VUZXh0TWFya2VyLnJlbW92ZSgpOw0KICAgICAgICB9DQoNCg0KICAgICAgICBpZiAodGhpcy5hdWRpbykgew0KICAgICAgICAgICAgdGhpcy5hdWRpby5wYXVzZSgpOw0KICAgICAgICAgICAgdGhpcy5hdWRpby5vbnRpbWV1cGRhdGUgPSBudWxsOw0KICAgICAgICAgICAgdGhpcy5hdWRpby5vbmVuZGVkID0gbnVsbDsNCiAgICAgICAgICAgIHRoaXMuYXVkaW8gPSBudWxsOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmVtb3ZlQW5pbWF0ZWRSZXN1bHQoKSB7DQogICAgICAgIHRoaXMucmVtb3ZlUmVzdWx0KCk7DQogICAgfQ0KDQogICAgdW5kbygpIHsNCg0KICAgIH0NCn0NCg=="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "presentation/audio-highlighter.css",
                                    "css": "bWFyay5oaWdobGlnaHQtd29yZHsNCiAgICBiYWNrZ3JvdW5kOiBvcmFuZ2U7DQogICAgY29sb3I6IGJsYWNrOw0KfQ0KDQpzcGFuLmhpZ2hsaWdodC1zZW50ZW5jZXsNCiAgICBiYWNrZ3JvdW5kOiAjZmZmODFmOw0KICAgIGNvbG9yOiBibGFjazsNCn0NCg0KLmhpZ2hsaWdodC1hdWRpb3sNCiAgICBiYWNrZ3JvdW5kOiAjZmZmODFmOw0KICAgIGNvbG9yOiBibGFjazsNCn0NCg0KLndvcmQtaGlnaGxpZ2h0ZXJ7DQoNCiAgICBwYWRkaW5nOiA0cHggIWltcG9ydGFudDsNCiAgICBib3JkZXItcmFkaXVzOiA0cHggIWltcG9ydGFudDsNCg0KfQ=="
                                }
                            ]
                        },
                        "configuration": {
                            "speed": "normal"
                        }
                    }
                },
                {
                    "function": {
                        "source": {
                            "id": "colorize",
                            "engine": {
                                "id": "colorize",
                                "version": "1.0",
                                "debugMode": false
                            },
                            "debugMode": false,
                            "name": "Colorize",
                            "description": "Colors a page according to your favorite color",
                            "inputTypes": [
                                {
                                    "inputType": "VoidIOType"
                                }
                            ],
                            "outputTypes": [
                                {
                                    "outputType": "VoidIOType"
                                }
                            ],
                            "defaultIcon": "assets/colorize.png",
                            "defaultIconURL": "https://localhost:8080/components/engines/colorize/1.0/assets/colorize.png",
                            "remoteBaseDirectory": "components/engines/colorize/1.0/",
                            "type": "LocalFunction",
                            "entryPoint": "colorize",
                            "remoteAssetDirectory": "",
                            "contentScripts": [
                                {
                                    "id": "colorize/1.0/js/colorize.js",
                                    "source": "DQpsZXQgZWFzeVJlYWRpbmdDb2xvcml6ZUVuYWJsZWQgPSBmYWxzZTsNCmZ1bmN0aW9uIGNvbG9yaXplKHJlcSwgY29uZmlnLHdpZGdldCkgew0KDQogICAgJCgiI2Vhc3ktcmVhZGluZy1jb2xvcml6ZS1zdHlsZSIpLnJlbW92ZSgpOw0KICAgICQoIjxzdHlsZSBpZD0nZWFzeS1yZWFkaW5nLWNvbG9yaXplLXN0eWxlJyB0eXBlPSd0ZXh0L2Nzcyc+IC5lYXN5UmVhZGVyQ29sb3JpemV7IGNvbG9yOiIrY29uZmlnLmZvbnRDb2xvcisiICFpbXBvcnRhbnQ7IGJhY2tncm91bmQtY29sb3I6Iitjb25maWcuYmFja2dyb3VuZENvbG9yKyIgIWltcG9ydGFudDt9IDwvc3R5bGU+IikuYXBwZW5kVG8oImhlYWQiKTsNCg0KICAgIGlmKGVhc3lSZWFkaW5nQ29sb3JpemVFbmFibGVkKXsNCiAgICAgICAgJCgiKiIpLnJlbW92ZUNsYXNzKCJlYXN5UmVhZGVyQ29sb3JpemUiKTsNCiAgICB9ZWxzZXsNCiAgICAgICAgJCgiKiIpLmVhY2goZnVuY3Rpb24gKCkgew0KDQogICAgICAgICAgICBpZighJCh0aGlzKS5wYXJlbnRzKCcuZWFzeS1yZWFkaW5nLWludGVyZmFjZScpLmxlbmd0aCAmJiAhICQodGhpcykuaGFzQ2xhc3MoJ2Vhc3ktcmVhZGluZy1pbnRlcmZhY2UnKSl7DQoNCiAgICAgICAgICAgICAgICBpZighJCh0aGlzKS5pcygiaW1nIikpew0KICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCJlYXN5UmVhZGVyQ29sb3JpemUiKTsNCiAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCg0KDQogICAgfQ0KDQogICAgZWFzeVJlYWRpbmdDb2xvcml6ZUVuYWJsZWQgPSAhZWFzeVJlYWRpbmdDb2xvcml6ZUVuYWJsZWQ7DQp9"
                                }
                            ],
                            "contentCSS": []
                        },
                        "configuration": {
                            "backgroundColor": "#000000",
                            "fontColor": "#FFFFFF"
                        }
                    },
                    "widget": {
                        "source": {
                            "id": "two-state-button",
                            "name": "Two state button",
                            "description": "A simple two state button.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "",
                            "remoteBaseDirectory": "components/widget/two-state-button/1.0/",
                            "implementationClass": "TwoStateButton",
                            "contentScripts": [
                                {
                                    "id": "widget/two-state-button.js",
                                    "source": "Y2xhc3MgVHdvU3RhdGVCdXR0b24gZXh0ZW5kcyBXaWRnZXRCYXNlew0KDQogICAgY29uc3RydWN0b3IoZnVuY3Rpb25JbmZvLCB1c2VySW50ZXJmYWNlLHRhcmdldElELCBjb25maWd1cmF0aW9uKXsNCiAgICAgICAgc3VwZXIoZnVuY3Rpb25JbmZvLHVzZXJJbnRlcmZhY2UsdGFyZ2V0SUQsY29uZmlndXJhdGlvbik7DQoNCiAgICAgICAgY29uc29sZS5sb2codGhpcy53aWRnZXRJRCApOw0KICAgICAgICB0aGlzLndpZGdldElEID0gJ2VyX2J1dHRvbl8nK3RoaXMud2lkZ2V0SUQ7DQogICAgICAgICQoIiMiK3RhcmdldElEKS5hcHBlbmQoIjxidXR0b24gaWQ9JyIrdGhpcy53aWRnZXRJRCsiJyBjbGFzcz0nZWFzeS1yZWFkaW5nLXR3by1zdGF0ZS1idXR0b24nPjxpbWcgc3JjPSciK2Z1bmN0aW9uSW5mby5zb3VyY2UuZGVmYXVsdEljb25VUkwrIicgdGl0bGU9JyIrZnVuY3Rpb25JbmZvLnNvdXJjZS5uYW1lKyI6ICIrZnVuY3Rpb25JbmZvLnNvdXJjZS5kZXNjcmlwdGlvbisiJz4gPC9idXR0b24+Iik7DQogICAgICAgIHRoaXMuZW5hYmxlKCk7DQogICAgICAgIHRoaXMucHJlc3NlZCA9IGZhbHNlOw0KICAgIH0NCg0KICAgIGVuYWJsZSgpew0KICAgICAgICAkKCIjIit0aGlzLndpZGdldElEKS5vbiggImNsaWNrIix0aGlzLCB0aGlzLmJ1dHRvbkNsaWNrZWQpOw0KDQogICAgfQ0KDQogICAgZGlzYWJsZSgpew0KICAgICAgICAkKCIjIit0aGlzLndpZGdldElEKS5vZmYoICJjbGljayIsdGhpcywgdGhpcy5idXR0b25DbGlja2VkKTsNCg0KDQogICAgfQ0KDQogICAgYnV0dG9uQ2xpY2tlZChlKXsNCiAgICAgICAgZS5kYXRhLnByZXNzZWQgPSAhZS5kYXRhLnByZXNzZWQ7DQogICAgICAgICQoIiMiK2UuZGF0YS53aWRnZXRJRCkudG9nZ2xlQ2xhc3MoICJlci1idXR0b24tYWN0aXZlIiApOw0KICAgICAgICBsZXQgdm9pZElucHV0ID0gew0KICAgICAgICAgICAgdHlwZTogIlZvaWQiLA0KICAgICAgICB9Ow0KICAgICAgICByZXF1ZXN0TWFuYWdlci5jcmVhdGVSZXF1ZXN0KGUuZGF0YSwgdm9pZElucHV0LCBlKTsNCiAgICB9DQoNCiAgICByZW1vdmUoKXsNCiAgICAgICAgJCgiIyIrdGhpcy53aWRnZXRJRCkucmVtb3ZlKCk7DQoNCg0KICAgIH0NCg0KICAgIHJlcXVlc3RGYWlsZWQocmVxLGNvbmZpZyl7DQogICAgICAgICQoIiMiK3RoaXMud2lkZ2V0SUQpLnJlbW92ZUNsYXNzKCAiZXItYnV0dG9uLWFjdGl2ZSIgKTsNCiAgICAgICAgdGhpcy5wcmVzc2VkID0gZmFsc2U7DQogICAgfQ0KfQ0K"
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "widget/two-state-button.css",
                                    "css": "LmVhc3ktcmVhZGluZy10d28tc3RhdGUtYnV0dG9uPmltZ3sNCiAgICBtYXgtd2lkdGg6IDEwMCU7DQp9DQoNCi5lYXN5LXJlYWRpbmctdHdvLXN0YXRlLWJ1dHRvbnsNCiAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmUgIWltcG9ydGFudDsNCiAgICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDAgIWltcG9ydGFudDsNCiAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7DQp9DQo="
                                }
                            ]
                        }
                    }
                },
                {
                    "function": {
                        "source": {
                            "id": "content_replacement",
                            "engine": {
                                "id": "content_replacement",
                                "version": "1.0",
                                "debugMode": false
                            },
                            "debugMode": false,
                            "name": "Content",
                            "description": "Content Replacement",
                            "inputTypes": [
                                {
                                    "inputType": "URLType",
                                    "name": "Url",
                                    "description": "Url of the page to search for replacements"
                                }
                            ],
                            "outputTypes": [
                                {
                                    "outputType": "ContentReplacement",
                                    "name": "Content replacements",
                                    "description": "Content replacements"
                                }
                            ],
                            "defaultIcon": "assets/content_replacement.png",
                            "defaultIconURL": "https://localhost:8080/components/engines/content_replacement/1.0/assets/content_replacement.png",
                            "remoteBaseDirectory": "components/engines/content_replacement/1.0/",
                            "type": "RemoteFunction",
                            "entryPoint": "contentReplacement"
                        }
                    },
                    "widget": {
                        "source": {
                            "id": "auto-button",
                            "name": "Auto Button",
                            "description": "A button that can automatically trigger on pageload",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "",
                            "remoteBaseDirectory": "components/widget/auto-button/1.0/",
                            "implementationClass": "AutoButton",
                            "contentScripts": [
                                {
                                    "id": "widget/auto-button.js",
                                    "source": "Y2xhc3MgQXV0b0J1dHRvbiBleHRlbmRzIFdpZGdldEJhc2V7DQoNCiAgICBjb25zdHJ1Y3RvcihmdW5jdGlvbkluZm8sIHVzZXJJbnRlcmZhY2UsdGFyZ2V0SUQsIGNvbmZpZ3VyYXRpb24pew0KICAgICAgICBzdXBlcihmdW5jdGlvbkluZm8sdXNlckludGVyZmFjZSx0YXJnZXRJRCxjb25maWd1cmF0aW9uKTsNCg0KICAgICAgICB0aGlzLndpZGdldElEID0gJ2VyX2J1dHRvbl8nK3RoaXMud2lkZ2V0SUQ7DQogICAgICAgICQoIiMiK3RhcmdldElEKS5hcHBlbmQoIjxidXR0b24gaWQ9JyIrdGhpcy53aWRnZXRJRCsiJyBjbGFzcz0nZWFzeS1yZWFkaW5nLWJ1dHRvbic+PGltZyBzcmM9JyIrZnVuY3Rpb25JbmZvLnNvdXJjZS5kZWZhdWx0SWNvblVSTCsiJyB0aXRsZT0nIitmdW5jdGlvbkluZm8uc291cmNlLm5hbWUrIjogIitmdW5jdGlvbkluZm8uc291cmNlLmRlc2NyaXB0aW9uKyInPiA8L2J1dHRvbj4iKTsNCiAgICAgICAgdGhpcy5lbmFibGUoKTsNCg0KICAgICAgICB0aGlzLmlzQWN0aXZhdGVkID0gZmFsc2U7DQogICAgICAgIHRoaXMuaW5pdGlhbFJlcXVlc3QgPSB0cnVlOw0KDQogICAgICAgIHRoaXMucmVxdWVzdEluUHJvZ3Jlc3MgPSB0cnVlOw0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFkZFByZXNlbnRhdGlvbkZpbmlzaExpc3RlbmVyKHRoaXMpOw0KICAgICAgICBsZXQgYXV0b0J1dHRvbiA9IHRoaXM7DQogICAgICAgICQoZG9jdW1lbnQpLnJlYWR5KCgpPT57DQogICAgICAgICAgICBhdXRvQnV0dG9uLmNyZWF0ZVJlcXVlc3QoKTsNCiAgICAgICAgICAgIC8vYXV0b0J1dHRvbi50b2dnbGUoKTsNCiAgICAgICAgfSk7DQogICAgfQ0KDQogICAgZW5hYmxlKCl7DQogICAgICAgICQoIiMiK3RoaXMud2lkZ2V0SUQpLm9uKCAiY2xpY2siLHRoaXMsIHRoaXMuYnV0dG9uQ2xpY2tlZCk7DQoNCiAgICB9DQoNCiAgICBkaXNhYmxlKCl7DQogICAgICAgICQoIiMiK3RoaXMud2lkZ2V0SUQpLm9mZiggImNsaWNrIix0aGlzLCB0aGlzLmJ1dHRvbkNsaWNrZWQpOw0KDQoNCiAgICB9DQoNCiAgICBidXR0b25DbGlja2VkKGUpew0KICAgICAgICBpZighZS5kYXRhLnJlcXVlc3RJblByb2dyZXNzKXsNCg0KICAgICAgICAgICAgaWYoZS5kYXRhLmlzQWN0aXZhdGVkKXsNCiAgICAgICAgICAgICAgICBlLmRhdGEudG9nZ2xlKCk7DQogICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICBlLmRhdGEuY3JlYXRlUmVxdWVzdCgpOw0KICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgdG9nZ2xlKCl7DQogICAgICAgIGlmKHRoaXMuaXNBY3RpdmF0ZWQpew0KICAgICAgICAgICAgJCgiIyIrdGhpcy53aWRnZXRJRCkucmVtb3ZlQ2xhc3MoImVyLWJ1dHRvbi1hY3RpdmUiKTsNCiAgICAgICAgICAgIHRoaXMuc3RvcFByZXNlbnRhdGlvbigpOw0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICQoIiMiK3RoaXMud2lkZ2V0SUQpLmFkZENsYXNzKCJlci1idXR0b24tYWN0aXZlIik7DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5pc0FjdGl2YXRlZCA9ICF0aGlzLmlzQWN0aXZhdGVkOw0KICAgIH0NCg0KICAgIGNyZWF0ZVJlcXVlc3QoKXsNCiAgICAgICAgdGhpcy5yZXF1ZXN0SW5Qcm9ncmVzcyA9IHRydWU7DQogICAgICAgIHJlcXVlc3RNYW5hZ2VyLmNyZWF0ZVJlcXVlc3QodGhpcyx7DQogICAgICAgICAgICB0eXBlOiAiVVJMIiwNCiAgICAgICAgICAgIHVybDogd2luZG93LmxvY2F0aW9uLmhyZWYsDQogICAgICAgIH0sIG51bGwsIHRoaXMuaW5pdGlhbFJlcXVlc3QpOw0KICAgIH0NCg0KICAgIHJlbW92ZSgpew0KICAgICAgICB0aGlzLmlzQWN0aXZhdGVkID0gZmFsc2U7DQogICAgICAgICQoIiMiK3RoaXMud2lkZ2V0SUQpLnJlbW92ZSgpOw0KICAgIH0NCg0KICAgIHByZXNlbnRhdGlvbkZpbmlzaGVkKHByZXNlbnRhdGlvbikgew0KICAgICAgICBzdXBlci5wcmVzZW50YXRpb25GaW5pc2hlZChwcmVzZW50YXRpb24pOw0KDQoNCiAgICAgICAgaWYocHJlc2VudGF0aW9uLnJlcXVlc3RDb3VudGVyID4gMCl7DQogICAgICAgICAgICB0aGlzLnRvZ2dsZSgpDQoNCiAgICAgICAgfQ0KDQogICAgICAgIHRoaXMuaW5pdGlhbFJlcXVlc3QgPSBmYWxzZTsNCiAgICAgICAgdGhpcy5yZXF1ZXN0SW5Qcm9ncmVzcyA9IGZhbHNlOw0KDQoNCiAgICB9DQp9DQo="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "widget/auto-button.css",
                                    "css": "LmVhc3ktcmVhZGluZy1idXR0b24+aW1new0KICAgIG1heC13aWR0aDogMTAwJTsNCn0NCg0KLmVhc3ktcmVhZGluZy1idXR0b257DQogICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lICFpbXBvcnRhbnQ7DQogICAgLXdlYmtpdC1ib3JkZXItcmFkaXVzOiAwICFpbXBvcnRhbnQ7DQogICAgcGFkZGluZzogMCAhaW1wb3J0YW50Ow0KfQ0KDQouZXItYnV0dG9uLWFjdGl2ZXsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZjNjc5ICFpbXBvcnRhbnQ7DQp9"
                                }
                            ]
                        }
                    },
                    "presentation": {
                        "source": {
                            "id": "content-replacement-switcher",
                            "name": "Content Replacement Switcher Switcher",
                            "description": "Renders the result instead of the paragraph but providing a switch to bring the original back.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "/components/presentation/content-replacement-switcher/1.0/presentation/images",
                            "remoteBaseDirectory": "components/presentation/content-replacement-switcher/1.0/",
                            "implementationClass": "ContentReplacementSwitcher",
                            "contentScripts": [
                                {
                                    "id": "presentation/content-replacement-switcher.js",
                                    "source": "Y2xhc3MgQ29udGVudFJlcGxhY2VtZW50U3dpdGNoZXIgZXh0ZW5kcyBQcmVzZW50YXRpb24gew0KICAgIGNvbnN0cnVjdG9yKGZ1bmN0aW9uSW5mbywgdXNlckludGVyZmFjZSwgY29uZmlndXJhdGlvbikgew0KICAgICAgICBzdXBlcihmdW5jdGlvbkluZm8sIHVzZXJJbnRlcmZhY2UsIGNvbmZpZ3VyYXRpb24pOw0KICAgICAgICB0aGlzLnJlcXVlc3RDb3VudGVyID0gMDsNCiAgICAgICAgdGhpcy5jdXJyZW50UmVxdWVzdElEID0gbnVsbDsNCiAgICB9DQoNCiAgICByZW5kZXJSZXN1bHQocmVxdWVzdCwgcmVzdWx0KSB7DQoNCiAgICAgICAgaWYodGhpcy5jdXJyZW50UmVxdWVzdElEKXsNCiAgICAgICAgICAgIHRoaXMucmVtb3ZlUmVzdWx0KCk7DQogICAgICAgIH0NCg0KICAgICAgICBsZXQgaW9SZXMgPSBpb1R5cGVVdGlscy50b0lPVHlwZUluc3RhbmNlKHJlc3VsdC5yZXN1bHQpOw0KICAgICAgICBpZiAoaW9SZXMubmFtZSA9PT0gIkVycm9yIikgew0KICAgICAgICAgICAgYWxlcnRNYW5hZ2VyLnNob3dFcnJvckFsZXJ0KGlvUmVzLm1lc3NhZ2UpOw0KDQogICAgICAgIH0gZWxzZSBpZiAoaW9SZXMubmFtZSA9PT0gIk5vUmVzdWx0Iikgew0KDQogICAgICAgICAgICBpZighcmVzdWx0LnJlcXVlc3RJbmZvLmF1dG9tYXRpY1JlcXVlc3Qpew0KICAgICAgICAgICAgICAgIGFsZXJ0TWFuYWdlci5zaG93SW5mb0FsZXJ0KGlvUmVzLm1lc3NhZ2UpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKGlvUmVzLm5hbWUgPT09ICJDb250ZW50UmVwbGFjZW1lbnQiKSB7DQoNCiAgICAgICAgICAgIGlmKGlvUmVzLnJlcGxhY2VtZW50cy5sZW5ndGggPiAwKXsNCiAgICAgICAgICAgICAgICBsZXQgcmVxdWVzdElEID0gdGhpcy5jcmVhdGVSZXF1ZXN0SWQoKTsNCiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0Q2xhc3MgPSB0aGlzLmdldFJlc3VsdENsYXNzKCk7DQogICAgICAgICAgICAgICAgbGV0IHByZXNlbnRhdGlvbklkZW50aWZpZXIgPSB0aGlzLmdldFByZXNlbnRhdGlvbkFuZFJlcXVlc3RJZGVudGlmaWVyKHJlcXVlc3RJRCk7DQoNCiAgICAgICAgICAgICAgICB0aGlzLnJlcGxhY2VtZW50cyA9IGlvUmVzLnJlcGxhY2VtZW50czsNCiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSZXF1ZXN0SUQgPSByZXF1ZXN0SUQ7DQoNCg0KICAgICAgICAgICAgICAgIGZvcihsZXQgaT0wOyBpICA8IGlvUmVzLnJlcGxhY2VtZW50cy5sZW5ndGg7IGkrKyl7DQoNCg0KICAgICAgICAgICAgICAgICAgICBpZihpb1Jlcy5yZXBsYWNlbWVudHNbaV0udHlwZSA9PT0gImNvbnRlbnRfcmVwbGFjZW1lbnQiKXsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5ew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXBsYWNlbWVudElEID0gInJlcGxhY2VtZW50LSIgKyBpICsgIi0iICsgaW9SZXMucmVwbGFjZW1lbnRzW2ldLnJlcGxhY2VtZW50LmlkOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW9SZXMucmVwbGFjZW1lbnRzW2ldLnJlcGxhY2VtZW50SUQgPSByZXBsYWNlbWVudElEOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbGVtZW50VG9SZXBsYWNlID0gJChpb1Jlcy5yZXBsYWNlbWVudHNbaV0ucmVwbGFjZW1lbnQuc2VsZWN0b3IpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9XZSBkb250IHVzZSB0YWcgbmFtZSBhbnkgbW9yZS4uLi4uIHRhZyBjb3VsZCBiZSBhIHNwYW4gb3IgYSBwIGFuZCB0aGVuIGhlYWRpbmdzIGFuZCBvdGhlciBwIHdpbGwgYnJlYWsgZG9tLi4uLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0YWdOYW1lID0gJChpb1Jlcy5yZXBsYWNlbWVudHNbaV0ucmVwbGFjZW1lbnQuc2VsZWN0b3IpLnByb3AoInRhZ05hbWUiKS50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvcmlnaW5hbENsYXNzZXMgPSAkKGlvUmVzLnJlcGxhY2VtZW50c1tpXS5yZXBsYWNlbWVudC5zZWxlY3RvcikuYXR0cignY2xhc3MnKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoZWxlbWVudFRvUmVwbGFjZSkuYWRkQ2xhc3MocmVwbGFjZW1lbnRJRCArICcgZXItY3JzLW9yaWdpbmFsLXRleHQgZXItY29udGVudC1yZXBsYWNlbWVudCcpOw0KDQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBydWxlcyA9IGdldE1hdGNoZWRDU1NSdWxlcyhlbGVtZW50VG9SZXBsYWNlWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29tYmluZWRTdHlsZXMgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJ1bGVzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbWJpbmVkU3R5bGVzICs9IHJ1bGVzW2ldLnN0eWxlLmNzc1RleHQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGh0bWwgPSAnPHNwYW4gY2xhc3M9ImVyLWNvbnRlbnQtcmVwbGFjZW1lbnQgZXItY29udGVudC1yZXBsYWNlbWVudC11aSI+PHNwYW4+PHNwYW4gY2xhc3M9ImVyLXRvZ2dsZS1idXR0b24gICcgKyByZXBsYWNlbWVudElEICsgJyByb2xlPSJidXR0b24iIHRhYmluZGV4PSIwIiBhcmlhLXByZXNzZWQ9ImZhbHNlIiBhcmlhLWxhYmVsPSJTd2l0Y2ggdG8gc2ltcGxlIHZlcnNpb24iID5cbicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnICAgIDxzcGFuIGNsYXNzPSJlci10b2dnbGUtYnV0dG9uLWlubmVyIj5cbicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnICAgICAgICA8c3BhbiBjbGFzcz0iZXItdG9nZ2xlLWJ1dHRvbi1mcm9udCI+XG4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyAgICAgICAgICAgPGltZyBzcmM9IicrdGhpcy5jb25maWd1cmF0aW9uLnJlbW90ZUFzc2V0RGlyZWN0b3J5KycvaGVscC1sb2dvLnBuZyIgYWx0PSIiPlxuJyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgICAgICAgIDwvc3Bhbj5cbicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnICAgICAgICA8c3BhbiBjbGFzcz0iZXItdG9nZ2xlLWJ1dHRvbi1iYWNrIj5cbicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnICAgICAgICAgICAgICA8aW1nIHNyYz0iJyt0aGlzLmNvbmZpZ3VyYXRpb24ucmVtb3RlQXNzZXREaXJlY3RvcnkrJy9vcmlnaW5hbC1sb2dvLnBuZyIgYWx0PSIiPlxuJyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgICAgICAgIDwvc3Bhbj5cbicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnICAgIDwvc3Bhbj5cbicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9zcGFuPjwvc3Bhbj48L3NwYW4+JzsNCg0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCc8ZGl2IGNsYXNzPSInICsgcmVwbGFjZW1lbnRJRCArICcgZXItY3JzLXJlcGxhY2UtdGV4dCBlci1jb250ZW50LXJlcGxhY2VtZW50IiBzdHlsZT0iJyArIGNvbWJpbmVkU3R5bGVzICsgJyI+JytodG1sICsgaW9SZXMucmVwbGFjZW1lbnRzW2ldLnJlcGxhY2VtZW50LnJlcGxhY2VtZW50ICsgJzwvZGl2PicpLmluc2VydEFmdGVyKCQoIi4iICsgcmVwbGFjZW1lbnRJRCArICIuZXItY3JzLW9yaWdpbmFsLXRleHQiKS5sYXN0KCkpOw0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIuIiArIHJlcGxhY2VtZW50SUQgKyAiLmVyLWNycy1yZXBsYWNlLXRleHQiKS5hZGRDbGFzcyhvcmlnaW5hbENsYXNzZXMpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgiLiIgKyByZXBsYWNlbWVudElEICsgIi5lci1jcnMtcmVwbGFjZS10ZXh0IikuaGlkZSgpOw0KDQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoaHRtbCkucHJlcGVuZFRvKCQoZWxlbWVudFRvUmVwbGFjZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vJChodG1sKS5pbnNlcnRCZWZvcmUoJChlbGVtZW50VG9SZXBsYWNlKSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIuZXItdG9nZ2xlLWJ1dHRvbi4iICsgcmVwbGFjZW1lbnRJRCkuY2xpY2soZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2dnbGVCdXR0b24ocmVwbGFjZW1lbnRJRCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkua2V5ZG93bihmdW5jdGlvbiAoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5rZXkgPT09ICIgIiB8fCBlLmtleSA9PT0gIkVudGVyIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQnV0dG9uKHJlcGxhY2VtZW50SUQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB0b2dnbGVCdXR0b24ocmVwbGFjZW1lbnRJRCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIuIiArIHJlcGxhY2VtZW50SUQgKyAiLmVyLWNycy1vcmlnaW5hbC10ZXh0IikudG9nZ2xlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIi4iICsgcmVwbGFjZW1lbnRJRCArICIuZXItY3JzLXJlcGxhY2UtdGV4dCIpLnRvZ2dsZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIuIiArIHJlcGxhY2VtZW50SUQgKyAiLmVyLWNycy1yZXBsYWNlLXRleHQgLmVyLXRvZ2dsZS1idXR0b24taW5uZXIiKS50b2dnbGVDbGFzcygiYWN0aXZlIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmbGlwQnV0dG9uID0gJCgiLiIgKyByZXBsYWNlbWVudElEICsgIi5lci10b2dnbGUtYnV0dG9uIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmbGlwQnV0dG9uLmF0dHIoImFyaWEtcHJlc3NlZCIpID09PSAidHJ1ZSIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsaXBCdXR0b24uYXR0cigiYXJpYS1wcmVzc2VkIiwgImZhbHNlIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGlwQnV0dG9uLmF0dHIoImFyaWEtcHJlc3NlZCIsICJ0cnVlIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldEludGVydmFsKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgiLiIrcmVwbGFjZW1lbnRJRCkudG9nZ2xlQ2xhc3MoImFuaW1hdGlvbi1hY3RpdmUiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH1jYXRjaCAoZSkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgIH0NCg0KDQoNCiAgICAgICAgfQ0KDQogICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIucHJlc2VudGF0aW9uRmluaXNoZWQodGhpcyk7DQoNCg0KICAgIH0NCg0KICAgIHVuZG8oKSB7DQoNCiAgICB9DQoNCiAgICByZW1vdmUoKXsNCiAgICAgICAgdGhpcy5yZW1vdmVMYXN0UmVzdWx0KCk7DQogICAgfQ0KDQogICAgcmVtb3ZlTGFzdFJlc3VsdCgpew0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucmVwbGFjZW1lbnRzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAkKCIuIiArIHRoaXMucmVwbGFjZW1lbnRzW2ldLnJlcGxhY2VtZW50SUQgKyAiLmVyLWNycy1vcmlnaW5hbC10ZXh0IC5lci1jb250ZW50LXJlcGxhY2VtZW50LXVpIikucmVtb3ZlKCk7DQogICAgICAgICAgICAkKCIuIiArIHRoaXMucmVwbGFjZW1lbnRzW2ldLnJlcGxhY2VtZW50SUQgKyAiLmVyLWNycy1vcmlnaW5hbC10ZXh0Iikuc2hvdygpLnJlbW92ZUNsYXNzKCBbICJlci1jcnMtb3JpZ2luYWwtdGV4dCIsICJlci1jb250ZW50LXJlcGxhY2VtZW50Il0pOw0KICAgICAgICAgICAgJCgiLiIgKyB0aGlzLnJlcGxhY2VtZW50c1tpXS5yZXBsYWNlbWVudElEICsgIi5lci1jcnMtcmVwbGFjZS10ZXh0IikucmVtb3ZlKCk7DQoNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLnJlcGxhY2VtZW50cyA9IFtdOw0KICAgIH0NCg0KICAgIHJlbW92ZVJlc3VsdChyZXF1ZXN0SUQpIHsNCiAgICAgICAgdGhpcy5yZW1vdmVMYXN0UmVzdWx0KCk7DQogICAgfQ0KfQ0KDQoNCg0KLy8gcG9seWZpbGwgd2luZG93LmdldE1hdGNoZWRDU1NSdWxlcygpIGluIEZpcmVGb3ggNisNCmlmICh0eXBlb2Ygd2luZG93LmdldE1hdGNoZWRDU1NSdWxlcyAhPT0gJ2Z1bmN0aW9uJykgew0KICAgIHZhciBFTEVNRU5UX1JFID0gL1tcdy1dKy9nLA0KICAgICAgICBJRF9SRSA9IC8jW1x3LV0rL2csDQogICAgICAgIENMQVNTX1JFID0gL1wuW1x3LV0rL2csDQogICAgICAgIEFUVFJfUkUgPSAvXFtbXlxdXStcXS9nLA0KICAgICAgICAvLyA6bm90KCkgcHNldWRvLWNsYXNzIGRvZXMgbm90IGFkZCB0byBzcGVjaWZpY2l0eSwgYnV0IGl0cyBjb250ZW50IGRvZXMgYXMgaWYgaXQgd2FzIG91dHNpZGUgaXQNCiAgICAgICAgUFNFVURPX0NMQVNTRVNfUkUgPSAvXDooPyFub3QpW1x3LV0rKFwoLipcKSk/L2csDQogICAgICAgIFBTRVVET19FTEVNRU5UU19SRSA9IC9cOlw6PyhhZnRlcnxiZWZvcmV8Zmlyc3QtbGV0dGVyfGZpcnN0LWxpbmV8c2VsZWN0aW9uKS9nOw0KDQogICAgLy8gY29udmVydCBhbiBhcnJheS1saWtlIG9iamVjdCB0byBhcnJheQ0KICAgIGZ1bmN0aW9uIHRvQXJyYXkobGlzdCkgew0KICAgICAgICByZXR1cm4gW10uc2xpY2UuY2FsbChsaXN0KTsNCiAgICB9DQoNCiAgICAvLyBoYW5kbGVzIGV4dHJhY3Rpb24gb2YgYGNzc1J1bGVzYCBhcyBhbiBgQXJyYXlgIGZyb20gYSBzdHlsZXNoZWV0IG9yIHNvbWV0aGluZyB0aGF0IGJlaGF2ZXMgdGhlIHNhbWUNCiAgICBmdW5jdGlvbiBnZXRTaGVldFJ1bGVzKHN0eWxlc2hlZXQpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHZhciBzaGVldF9tZWRpYSA9IHN0eWxlc2hlZXQubWVkaWEgJiYgc3R5bGVzaGVldC5tZWRpYS5tZWRpYVRleHQ7DQogICAgICAgICAgICAvLyBpZiB0aGlzIHNoZWV0IGlzIGRpc2FibGVkIHNraXAgaXQNCiAgICAgICAgICAgIGlmIChzdHlsZXNoZWV0LmRpc2FibGVkKSByZXR1cm4gW107DQogICAgICAgICAgICAvLyBpZiB0aGlzIHNoZWV0J3MgbWVkaWEgaXMgc3BlY2lmaWVkIGFuZCBkb2Vzbid0IG1hdGNoIHRoZSB2aWV3cG9ydCB0aGVuIHNraXAgaXQNCiAgICAgICAgICAgIGlmIChzaGVldF9tZWRpYSAmJiBzaGVldF9tZWRpYS5sZW5ndGggJiYgIXdpbmRvdy5tYXRjaE1lZGlhKHNoZWV0X21lZGlhKS5tYXRjaGVzKSByZXR1cm4gW107DQogICAgICAgICAgICAvLyBnZXQgdGhlIHN0eWxlIHJ1bGVzIG9mIHRoaXMgc2hlZXQNCg0KICAgICAgICAgICAgcmV0dXJuIHRvQXJyYXkoc3R5bGVzaGVldC5jc3NSdWxlcyk7DQogICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgIHJldHVybiBbXTsNCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gX2ZpbmQoc3RyaW5nLCByZSkgew0KICAgICAgICB2YXIgbWF0Y2hlcyA9IHN0cmluZy5tYXRjaChyZSk7DQogICAgICAgIHJldHVybiBtYXRjaGVzID8gbWF0Y2hlcy5sZW5ndGggOiAwOw0KICAgIH0NCg0KICAgIC8vIGNhbGN1bGF0ZXMgdGhlIHNwZWNpZmljaXR5IG9mIGEgZ2l2ZW4gYHNlbGVjdG9yYA0KICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVNjb3JlKHNlbGVjdG9yKSB7DQogICAgICAgIHZhciBzY29yZSA9IFswLCAwLCAwXSwNCiAgICAgICAgICAgIHBhcnRzID0gc2VsZWN0b3Iuc3BsaXQoJyAnKSwNCiAgICAgICAgICAgIHBhcnQsIG1hdGNoOw0KICAgICAgICAvL1RPRE86IGNsZWFuIHRoZSAnOm5vdCcgcGFydCBzaW5jZSB0aGUgbGFzdCBFTEVNRU5UX1JFIHdpbGwgcGljayBpdCB1cA0KICAgICAgICB3aGlsZSAocGFydCA9IHBhcnRzLnNoaWZ0KCksIHR5cGVvZiBwYXJ0ID09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAvLyBmaW5kIGFsbCBwc2V1ZG8tZWxlbWVudHMNCiAgICAgICAgICAgIG1hdGNoID0gX2ZpbmQocGFydCwgUFNFVURPX0VMRU1FTlRTX1JFKTsNCiAgICAgICAgICAgIHNjb3JlWzJdICs9IG1hdGNoOw0KICAgICAgICAgICAgLy8gYW5kIHJlbW92ZSB0aGVtDQogICAgICAgICAgICBtYXRjaCAmJiAocGFydCA9IHBhcnQucmVwbGFjZShQU0VVRE9fRUxFTUVOVFNfUkUsICcnKSk7DQogICAgICAgICAgICAvLyBmaW5kIGFsbCBwc2V1ZG8tY2xhc3Nlcw0KICAgICAgICAgICAgbWF0Y2ggPSBfZmluZChwYXJ0LCBQU0VVRE9fQ0xBU1NFU19SRSk7DQogICAgICAgICAgICBzY29yZVsxXSArPSBtYXRjaDsNCiAgICAgICAgICAgIC8vIGFuZCByZW1vdmUgdGhlbQ0KICAgICAgICAgICAgbWF0Y2ggJiYgKHBhcnQgPSBwYXJ0LnJlcGxhY2UoUFNFVURPX0NMQVNTRVNfUkUsICcnKSk7DQogICAgICAgICAgICAvLyBmaW5kIGFsbCBhdHRyaWJ1dGVzDQogICAgICAgICAgICBtYXRjaCA9IF9maW5kKHBhcnQsIEFUVFJfUkUpOw0KICAgICAgICAgICAgc2NvcmVbMV0gKz0gbWF0Y2g7DQogICAgICAgICAgICAvLyBhbmQgcmVtb3ZlIHRoZW0NCiAgICAgICAgICAgIG1hdGNoICYmIChwYXJ0ID0gcGFydC5yZXBsYWNlKEFUVFJfUkUsICcnKSk7DQogICAgICAgICAgICAvLyBmaW5kIGFsbCBJRHMNCiAgICAgICAgICAgIG1hdGNoID0gX2ZpbmQocGFydCwgSURfUkUpOw0KICAgICAgICAgICAgc2NvcmVbMF0gKz0gbWF0Y2g7DQogICAgICAgICAgICAvLyBhbmQgcmVtb3ZlIHRoZW0NCiAgICAgICAgICAgIG1hdGNoICYmIChwYXJ0ID0gcGFydC5yZXBsYWNlKElEX1JFLCAnJykpOw0KICAgICAgICAgICAgLy8gZmluZCBhbGwgY2xhc3Nlcw0KICAgICAgICAgICAgbWF0Y2ggPSBfZmluZChwYXJ0LCBDTEFTU19SRSk7DQogICAgICAgICAgICBzY29yZVsxXSArPSBtYXRjaDsNCiAgICAgICAgICAgIC8vIGFuZCByZW1vdmUgdGhlbQ0KICAgICAgICAgICAgbWF0Y2ggJiYgKHBhcnQgPSBwYXJ0LnJlcGxhY2UoQ0xBU1NfUkUsICcnKSk7DQogICAgICAgICAgICAvLyBmaW5kIGFsbCBlbGVtZW50cw0KICAgICAgICAgICAgc2NvcmVbMl0gKz0gX2ZpbmQocGFydCwgRUxFTUVOVF9SRSk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHBhcnNlSW50KHNjb3JlLmpvaW4oJycpLCAxMCk7DQogICAgfQ0KDQogICAgLy8gcmV0dXJucyB0aGUgaGVpZ2h0cyBwb3NzaWJsZSBzcGVjaWZpY2l0eSBzY29yZSBhbiBlbGVtZW50IGNhbiBnZXQgZnJvbSBhIGdpdmUgcnVsZSdzIHNlbGVjdG9yVGV4dA0KICAgIGZ1bmN0aW9uIGdldFNwZWNpZmljaXR5U2NvcmUoZWxlbWVudCwgc2VsZWN0b3JfdGV4dCkgew0KICAgICAgICB2YXIgc2VsZWN0b3JzID0gc2VsZWN0b3JfdGV4dC5zcGxpdCgnLCcpLA0KICAgICAgICAgICAgc2VsZWN0b3IsIHNjb3JlLCByZXN1bHQgPSAwOw0KICAgICAgICB3aGlsZSAoc2VsZWN0b3IgPSBzZWxlY3RvcnMuc2hpZnQoKSkgew0KICAgICAgICAgICAgaWYgKG1hdGNoZXNTZWxlY3RvcihlbGVtZW50LCBzZWxlY3RvcikpIHsNCiAgICAgICAgICAgICAgICBzY29yZSA9IGNhbGN1bGF0ZVNjb3JlKHNlbGVjdG9yKTsNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBzY29yZSA+IHJlc3VsdCA/IHNjb3JlIDogcmVzdWx0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc29ydEJ5U3BlY2lmaWNpdHkoZWxlbWVudCwgcnVsZXMpIHsNCiAgICAgICAgLy8gY29tcGFyaW5nIGZ1bmN0aW9uIHRoYXQgc29ydHMgQ1NTU3R5bGVSdWxlcyBhY2NvcmRpbmcgdG8gc3BlY2lmaWNpdHkgb2YgdGhlaXIgYHNlbGVjdG9yVGV4dGANCiAgICAgICAgZnVuY3Rpb24gY29tcGFyZVNwZWNpZmljaXR5KGEsIGIpIHsNCiAgICAgICAgICAgIHJldHVybiBnZXRTcGVjaWZpY2l0eVNjb3JlKGVsZW1lbnQsIGIuc2VsZWN0b3JUZXh0KSAtIGdldFNwZWNpZmljaXR5U2NvcmUoZWxlbWVudCwgYS5zZWxlY3RvclRleHQpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHJ1bGVzLnNvcnQoY29tcGFyZVNwZWNpZmljaXR5KTsNCiAgICB9DQoNCiAgICAvLyBGaW5kIGNvcnJlY3QgbWF0Y2hlc1NlbGVjdG9yIGltcGwNCiAgICBmdW5jdGlvbiBtYXRjaGVzU2VsZWN0b3IoZWwsIHNlbGVjdG9yKSB7DQogICAgICAgIHZhciBtYXRjaGVyID0gZWwubWF0Y2hlc1NlbGVjdG9yIHx8IGVsLm1vek1hdGNoZXNTZWxlY3RvciB8fA0KICAgICAgICAgICAgZWwud2Via2l0TWF0Y2hlc1NlbGVjdG9yIHx8IGVsLm9NYXRjaGVzU2VsZWN0b3IgfHwgZWwubXNNYXRjaGVzU2VsZWN0b3I7DQogICAgICAgIHJldHVybiBtYXRjaGVyLmNhbGwoZWwsIHNlbGVjdG9yKTsNCiAgICB9DQoNCiAgICAvL1RPRE86IG5vdCBzdXBwb3J0aW5nIDJuZCBhcmd1bWVudCBmb3Igc2VsZWN0aW5nIHBzZXVkbyBlbGVtZW50cw0KICAgIC8vVE9ETzogbm90IHN1cHBvcnRpbmcgM3JkIGFyZ3VtZW50IGZvciBjaGVja2luZyBhdXRob3Igc3R5bGUgc2hlZXRzIG9ubHkNCiAgICB3aW5kb3cuZ2V0TWF0Y2hlZENTU1J1bGVzID0gZnVuY3Rpb24gKGVsZW1lbnQgLyosIHBzZXVkbywgYXV0aG9yX29ubHkqLykgew0KICAgICAgICB2YXIgc3R5bGVfc2hlZXRzLCBzaGVldCwgc2hlZXRfbWVkaWEsDQogICAgICAgICAgICBydWxlcywgcnVsZSwNCiAgICAgICAgICAgIHJlc3VsdCA9IFtdOw0KICAgICAgICAvLyBnZXQgc3R5bGVzaGVldHMgYW5kIGNvbnZlcnQgdG8gYSByZWd1bGFyIEFycmF5DQogICAgICAgIHN0eWxlX3NoZWV0cyA9IHRvQXJyYXkod2luZG93LmRvY3VtZW50LnN0eWxlU2hlZXRzKTsNCg0KICAgICAgICAvLyBhc3N1bWluZyB0aGUgYnJvd3NlciBoYW5kcyB1cyBzdHlsZXNoZWV0cyBpbiBvcmRlciBvZiBhcHBlYXJhbmNlDQogICAgICAgIC8vIHdlIGl0ZXJhdGUgdGhlbSBmcm9tIHRoZSBiZWdpbm5pbmcgdG8gZm9sbG93IHByb3BlciBjYXNjYWRlIG9yZGVyDQogICAgICAgIHdoaWxlIChzaGVldCA9IHN0eWxlX3NoZWV0cy5zaGlmdCgpKSB7DQogICAgICAgICAgICAvLyBnZXQgdGhlIHN0eWxlIHJ1bGVzIG9mIHRoaXMgc2hlZXQNCiAgICAgICAgICAgIHJ1bGVzID0gZ2V0U2hlZXRSdWxlcyhzaGVldCk7DQogICAgICAgICAgICAvLyBsb29wIHRoZSBydWxlcyBpbiBvcmRlciBvZiBhcHBlYXJhbmNlDQogICAgICAgICAgICB3aGlsZSAocnVsZSA9IHJ1bGVzLnNoaWZ0KCkpIHsNCiAgICAgICAgICAgICAgICAvLyBpZiB0aGlzIGlzIGFuIEBpbXBvcnQgcnVsZQ0KICAgICAgICAgICAgICAgIGlmIChydWxlLnN0eWxlU2hlZXQpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gaW5zZXJ0IHRoZSBpbXBvcnRlZCBzdHlsZXNoZWV0J3MgcnVsZXMgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGlzIHN0eWxlc2hlZXQncyBydWxlcw0KICAgICAgICAgICAgICAgICAgICBydWxlcyA9IGdldFNoZWV0UnVsZXMocnVsZS5zdHlsZVNoZWV0KS5jb25jYXQocnVsZXMpOw0KICAgICAgICAgICAgICAgICAgICAvLyBhbmQgc2tpcCB0aGlzIHJ1bGUNCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlJ3Mgbm8gc3R5bGVzaGVldCBhdHRyaWJ1dGUgQlVUIHRoZXJlIElTIGEgbWVkaWEgYXR0cmlidXRlIGl0J3MgYSBtZWRpYSBydWxlDQogICAgICAgICAgICAgICAgZWxzZSBpZiAocnVsZS5tZWRpYSkgew0KICAgICAgICAgICAgICAgICAgICAvLyBpbnNlcnQgdGhlIGNvbnRhaW5lZCBydWxlcyBvZiB0aGlzIG1lZGlhIHJ1bGUgdG8gdGhlIGJlZ2lubmluZyBvZiB0aGlzIHN0eWxlc2hlZXQncyBydWxlcw0KICAgICAgICAgICAgICAgICAgICBydWxlcyA9IGdldFNoZWV0UnVsZXMocnVsZSkuY29uY2F0KHJ1bGVzKTsNCiAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHNraXAgaXQNCiAgICAgICAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGlzIGVsZW1lbnQgbWF0Y2hlcyB0aGlzIHJ1bGUncyBzZWxlY3Rvcg0KICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzU2VsZWN0b3IoZWxlbWVudCwgcnVsZS5zZWxlY3RvclRleHQpKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIHB1c2ggdGhlIHJ1bGUgdG8gdGhlIHJlc3VsdHMgc2V0DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHJ1bGUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAvLyBzb3J0IGFjY29yZGluZyB0byBzcGVjaWZpY2l0eQ0KICAgICAgICByZXR1cm4gc29ydEJ5U3BlY2lmaWNpdHkoZWxlbWVudCwgcmVzdWx0KTsNCiAgICB9Ow0KfQ=="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "presentation/content-replacement-switcher.css",
                                    "css": "LmVyLWNvbnRlbnQtcmVwbGFjZW1lbnQtdWl7DQogICAgZGlzcGxheTogdGFibGU7DQp9DQouZXItY29udGVudC1yZXBsYWNlbWVudC11aT5zcGFuew0KICAgIGRpc3BsYXk6IHRhYmxlLXJvdzsNCn0NCg0KLmVyLXRvZ2dsZS1idXR0b24gew0KICAgIGRpc3BsYXk6IHRhYmxlLWNlbGw7DQogICAgZmxvYXQ6IGxlZnQ7DQogICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7DQogICAgd2lkdGg6IDUwcHggIWltcG9ydGFudDsNCiAgICBoZWlnaHQ6IDUwcHggIWltcG9ydGFudDsNCiAgICBwZXJzcGVjdGl2ZTogMTAwMHB4Ow0KICAgIC13ZWJraXQtdHJhbnNpdGlvbjogYm9yZGVyIDAuMXMgbGluZWFyLCBib3gtc2hhZG93IDAuMnMgbGluZWFyOw0KICAgIC1tb3otdHJhbnNpdGlvbjogYm9yZGVyIDAuMXMgbGluZWFyLCBib3gtc2hhZG93IDAuMnMgbGluZWFyOw0KICAgIHRyYW5zaXRpb246IGJvcmRlciAwLjFzIGxpbmVhciwgYm94LXNoYWRvdyAwLjJzIGxpbmVhcjsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgbWFyZ2luOiAxMHB4ICFpbXBvcnRhbnQ7DQogICAgcGFkZGluZzogMCAhaW1wb3J0YW50Ow0KfQ0KLmVyLXRvZ2dsZS1idXR0b24taW5uZXI+c3Bhbj5pbWd7DQogICAgd2lkdGg6IDUwcHggIWltcG9ydGFudDsNCiAgICBoZWlnaHQ6IDUwcHggIWltcG9ydGFudDsNCn0NCg0KLmVyLXRvZ2dsZS1idXR0b24uYW5pbWF0aW9uLWFjdGl2ZSB7DQogICAgLXdlYmtpdC1ib3gtc2hhZG93OiAwIDAgMTBweCBibHVlOw0KICAgIC1tb3otYm94LXNoYWRvdzogMCAwIDEwcHggYmx1ZTsNCiAgICBib3gtc2hhZG93OiAwIDAgMTBweCBibHVlOw0KfQ0KDQouZXItdG9nZ2xlLWJ1dHRvbi1pbm5lciB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuNnM7DQogICAgdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZDsNCiAgICBib3gtc2hhZG93OiAwIDRweCA4cHggMCByZ2JhKDAsMCwwLDAuMik7DQp9DQoNCi5lci10b2dnbGUtYnV0dG9uLWlubmVyLmFjdGl2ZSB7DQogICAgdHJhbnNmb3JtOiByb3RhdGVZKDE4MGRlZyk7DQp9DQoNCi5lci10b2dnbGUtYnV0dG9uLWZyb250LCAuZXItdG9nZ2xlLWJ1dHRvbi1iYWNrIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7DQogICAgd2lkdGg6IDEwMCU7DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIC13ZWJraXQtYmFja2ZhY2UtdmlzaWJpbGl0eTogaGlkZGVuOw0KICAgIGJhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjsNCn0NCg0KLmVyLXRvZ2dsZS1idXR0b24tZnJvbnQgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIGJhY2tncm91bmQtY29sb3I6ICNiYmI7DQogICAgY29sb3I6IGJsYWNrOw0KfQ0KDQouZXItdG9nZ2xlLWJ1dHRvbi1iYWNrIHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICB0cmFuc2Zvcm06IHJvdGF0ZVkoMTgwZGVnKTsNCn0NCg0KLmVyLXRvZ2dsZS1idXR0b24tdWktY29udGFpbmVyew0KICAgIGRpc3BsYXk6IHRhYmxlLWNlbGw7DQogICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsNCn0NCg0KLmVyLXRvZ2dsZS1idXR0b24tdWktY29udGFpbmVyPmJ1dHRvbnsNCiAgICBtYXgtd2lkdGg6IDI1cHggIWltcG9ydGFudDsNCiAgICBtYXgtaGVpZ2h0OiAyNXB4ICFpbXBvcnRhbnQ7DQogICAgd2lkdGg6IDI1cHggIWltcG9ydGFudDsNCiAgICBoZWlnaHQ6IDI1cHggIWltcG9ydGFudDsNCiAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7DQogICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7DQogICAgYmFja2dyb3VuZDogaW5oZXJpdCAhaW1wb3J0YW50Ow0KICAgIGJvcmRlcjogbm9uZTsNCn0NCg0KLmVyLXRvZ2dsZS1idXR0b24tdWktY29udGFpbmVyPmJ1dHRvbjpob3ZlcnsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgYmFja2dyb3VuZDogIzIyNzZkMiAhaW1wb3J0YW50Ow0KfQ0KDQouZXItdG9nZ2xlLWJ1dHRvbi11aS1jb250YWluZXI+YnV0dG9uPmltZ3sNCiAgICBtYXgtd2lkdGg6IDI1cHggIWltcG9ydGFudDsNCiAgICBtYXgtaGVpZ2h0OiAyNXB4ICFpbXBvcnRhbnQ7DQogICAgcGFkZGluZzogMCAhaW1wb3J0YW50Ow0KICAgIG1hcmdpbjogMCAhaW1wb3J0YW50Ow0KfQ0KDQoNCg=="
                                }
                            ]
                        },
                        "configuration": {
                            "remoteAssetDirectory": "https://localhost:8080//components/presentation/content-replacement-switcher/1.0/presentation/images"
                        }
                    }
                },
                {
                    "function": {
                        "source": {
                            "id": "magnifyFont",
                            "engine": {
                                "id": "font-magnification-tool",
                                "version": "1.0",
                                "debugMode": false
                            },
                            "debugMode": false,
                            "name": "Magnify font",
                            "description": "Magnifies the font size",
                            "inputTypes": [
                                {
                                    "inputType": "VoidIOType"
                                }
                            ],
                            "outputTypes": [
                                {
                                    "outputType": "VoidIOType"
                                }
                            ],
                            "defaultIcon": "assets/magnify.png",
                            "defaultIconURL": "https://localhost:8080/components/engines/font-magnification-tool/1.0/assets/magnify.png",
                            "remoteBaseDirectory": "components/engines/font-magnification-tool/1.0/",
                            "type": "LocalFunction",
                            "entryPoint": "magnifyFont",
                            "remoteAssetDirectory": "",
                            "contentScripts": [
                                {
                                    "id": "font-magnification-tool/1.0/js/font-magnification-tool.js",
                                    "source": "bGV0IHpvb20gPSAwOw0KbGV0IHpvb21Jbml0ID0gZmFsc2U7DQoNCmZ1bmN0aW9uIGluaXRGb250TWFnbmlmaWNhdGlvbigpIHsNCiAgICBpZiAoIXpvb21Jbml0KSB7DQogICAgICAgICQoJyonKS5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGxldCBlbCA9ICQodGhpcyk7DQogICAgICAgICAgICBsZXQgc2l6ZSA9IHBhcnNlSW50KGVsLmNzcygnZm9udC1zaXplJykpOw0KICAgICAgICAgICAgZWwuZGF0YSgnZm9udC1zaXplJywgc2l6ZSk7DQoNCg0KICAgICAgICB9KTsNCiAgICAgICAgem9vbUluaXQgPSB0cnVlOw0KICAgIH0NCg0KfQ0KDQpmdW5jdGlvbiBtYWduaWZ5Rm9udChyZXEsIGNvbmZpZyx3aWRnZXQpIHsNCiAgICBpbml0Rm9udE1hZ25pZmljYXRpb24oKTsNCiAgICB6b29tKys7DQogICAgJCgnKicpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICBpZighJCh0aGlzKS5wYXJlbnRzKCcuZWFzeS1yZWFkaW5nLWludGVyZmFjZScpLmxlbmd0aCl7DQogICAgICAgICAgICBsZXQgZWwgPSAkKHRoaXMpOw0KICAgICAgICAgICAgbGV0IHNpemUgPSBlbC5kYXRhKCdmb250LXNpemUnKTsNCiAgICAgICAgICAgIGVsLmNzcygnZm9udC1zaXplJywgTWF0aC5tYXgoc2l6ZSArIHpvb20sIDApICsgJ3B4Jyk7DQogICAgICAgIH0NCg0KICAgIH0pOw0KDQoNCn0NCg0KZnVuY3Rpb24gc2hyaW5rRm9udChyZXEsIGNvbmZpZykgew0KICAgIGluaXRGb250TWFnbmlmaWNhdGlvbigpOw0KICAgIHpvb20tLTsNCiAgICAkKCcqJykuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgIGlmKCEkKHRoaXMpLnBhcmVudHMoJy5lYXN5LXJlYWRpbmctaW50ZXJmYWNlJykubGVuZ3RoKXsNCiAgICAgICAgICAgIGxldCBlbCA9ICQodGhpcyk7DQogICAgICAgICAgICBsZXQgc2l6ZSA9IGVsLmRhdGEoJ2ZvbnQtc2l6ZScpOw0KICAgICAgICAgICAgZWwuY3NzKCdmb250LXNpemUnLCBNYXRoLm1heChzaXplICsgem9vbSwgMCkgKyAncHgnKTsNCiAgICAgICAgfQ0KDQogICAgfSk7DQp9DQoNCg0KDQovLy9MSU5FIEhFSUdIVA0KbGV0IGxpbmVIZWlnaHQgPSAwOw0KbGV0IGxpbmVIZWlnaHRJbml0ID0gZmFsc2U7DQoNCmZ1bmN0aW9uIGluaXRMaW5lSGVpZ2h0KCkgew0KICAgIGlmICghbGluZUhlaWdodEluaXQpIHsNCiAgICAgICAgJCgnKicpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgbGV0IGVsID0gJCh0aGlzKTsNCiAgICAgICAgICAgIGxldCBzaXplID0gcGFyc2VJbnQoZWwuY3NzKCdsaW5lLWhlaWdodCcpKTsNCiAgICAgICAgICAgIGVsLmRhdGEoJ2xpbmUtaGVpZ2h0Jywgc2l6ZSk7DQoNCiAgICAgICAgfSk7DQogICAgICAgIGxpbmVIZWlnaHRJbml0ID0gdHJ1ZTsNCiAgICB9DQoNCn0NCg0KZnVuY3Rpb24gaW5jcmVhc2VMaW5lSGVpZ2h0KHJlcSwgY29uZmlnKSB7DQogICAgaW5pdExpbmVIZWlnaHQoKTsNCiAgICBsaW5lSGVpZ2h0Kys7DQogICAgJCgnKicpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICBpZighJCh0aGlzKS5wYXJlbnRzKCcuZWFzeS1yZWFkaW5nLWludGVyZmFjZScpLmxlbmd0aCl7DQogICAgICAgICAgICBsZXQgZWwgPSAkKHRoaXMpOw0KICAgICAgICAgICAgbGV0IHNpemUgPSBlbC5kYXRhKCdsaW5lLWhlaWdodCcpOw0KICAgICAgICAgICAgZWwuY3NzKCdsaW5lLWhlaWdodCcsIE1hdGgubWF4KHNpemUgKyBsaW5lSGVpZ2h0LCAwKSArICdweCcpOw0KICAgICAgICB9DQoNCiAgICB9KTsNCg0KDQp9DQoNCmZ1bmN0aW9uIGRlY3JlYXNlTGluZUhlaWdodChyZXEsIGNvbmZpZykgew0KICAgIGluaXRMaW5lSGVpZ2h0KCk7DQogICAgbGluZUhlaWdodC0tOw0KICAgICQoJyonKS5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaWYoISQodGhpcykucGFyZW50cygnLmVhc3ktcmVhZGluZy1pbnRlcmZhY2UnKS5sZW5ndGgpew0KICAgICAgICAgICAgbGV0IGVsID0gJCh0aGlzKTsNCiAgICAgICAgICAgIGxldCBzaXplID0gZWwuZGF0YSgnbGluZS1oZWlnaHQnKTsNCiAgICAgICAgICAgIGVsLmNzcygnbGluZS1oZWlnaHQnLCBNYXRoLm1heChzaXplICsgbGluZUhlaWdodCwgMCkgKyAncHgnKTsNCiAgICAgICAgfQ0KDQogICAgfSk7DQp9"
                                }
                            ],
                            "contentCSS": []
                        }
                    },
                    "widget": {
                        "source": {
                            "id": "button",
                            "name": "Simple Button",
                            "description": "A simple button.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "",
                            "remoteBaseDirectory": "components/widget/button/1.0/",
                            "implementationClass": "Button",
                            "contentScripts": [
                                {
                                    "id": "widget/button.js",
                                    "source": "Y2xhc3MgQnV0dG9uIGV4dGVuZHMgV2lkZ2V0QmFzZSB7DQoNCiAgICBjb25zdHJ1Y3RvcihmdW5jdGlvbkluZm8sIHVzZXJJbnRlcmZhY2UsdGFyZ2V0SUQsIGNvbmZpZ3VyYXRpb24pew0KICAgICAgICBzdXBlcihmdW5jdGlvbkluZm8sdXNlckludGVyZmFjZSx0YXJnZXRJRCxjb25maWd1cmF0aW9uKTsNCg0KICAgICAgICB0aGlzLndpZGdldElEID0gJ2VyX2J1dHRvbl8nK3RoaXMud2lkZ2V0SUQ7DQogICAgICAgICQoIiMiK3RhcmdldElEKS5hcHBlbmQoIjxidXR0b24gaWQ9JyIrdGhpcy53aWRnZXRJRCsiJyBjbGFzcz0nZWFzeS1yZWFkaW5nLWJ1dHRvbic+PGltZyBzcmM9JyIrZnVuY3Rpb25JbmZvLnNvdXJjZS5kZWZhdWx0SWNvblVSTCsiJyB0aXRsZT0nIitmdW5jdGlvbkluZm8uc291cmNlLm5hbWUrIjogIitmdW5jdGlvbkluZm8uc291cmNlLmRlc2NyaXB0aW9uKyInPiA8L2J1dHRvbj4iKTsNCiAgICAgICAgdGhpcy5lbmFibGUoKTsNCiAgICB9DQoNCiAgICBlbmFibGUoKXsNCiAgICAgICAgJCgiIyIrdGhpcy53aWRnZXRJRCkub24oICJjbGljayIsdGhpcywgdGhpcy5idXR0b25DbGlja2VkKTsNCg0KICAgIH0NCg0KICAgIGRpc2FibGUoKXsNCiAgICAgICAgJCgiIyIrdGhpcy53aWRnZXRJRCkub2ZmKCAiY2xpY2siLHRoaXMsIHRoaXMuYnV0dG9uQ2xpY2tlZCk7DQogICAgfQ0KDQogICAgYnV0dG9uQ2xpY2tlZChlKXsNCiAgICAgICAgbGV0IHZvaWRJbnB1dCA9IHsNCiAgICAgICAgICAgIHR5cGU6ICJWb2lkIiwNCiAgICAgICAgfTsNCiAgICAgICAgcmVxdWVzdE1hbmFnZXIuY3JlYXRlUmVxdWVzdChlLmRhdGEsIHZvaWRJbnB1dCwgZSk7DQogICAgfQ0KDQogICAgcmVtb3ZlKCl7DQogICAgICAgICQoIiMiK3RoaXMud2lkZ2V0SUQpLnJlbW92ZSgpOw0KICAgIH0NCn0NCg=="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "widget/button.css",
                                    "css": "LmVhc3ktcmVhZGluZy1idXR0b24+aW1new0KICAgIG1heC13aWR0aDogMTAwJTsNCn0NCg0KLmVhc3ktcmVhZGluZy1idXR0b257DQogICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lICFpbXBvcnRhbnQ7DQogICAgLXdlYmtpdC1ib3JkZXItcmFkaXVzOiAwICFpbXBvcnRhbnQ7DQogICAgcGFkZGluZzogMCAhaW1wb3J0YW50Ow0KfQ=="
                                }
                            ]
                        }
                    }
                },
                {
                    "function": {
                        "source": {
                            "id": "shrinkFont",
                            "engine": {
                                "id": "font-magnification-tool",
                                "version": "1.0",
                                "debugMode": false
                            },
                            "debugMode": false,
                            "name": "Shrink font",
                            "description": "Shrinks the font size",
                            "inputTypes": [
                                {
                                    "inputType": "VoidIOType"
                                }
                            ],
                            "outputTypes": [
                                {
                                    "outputType": "VoidIOType"
                                }
                            ],
                            "defaultIcon": "assets/shrink.png",
                            "defaultIconURL": "https://localhost:8080/components/engines/font-magnification-tool/1.0/assets/shrink.png",
                            "remoteBaseDirectory": "components/engines/font-magnification-tool/1.0/",
                            "type": "LocalFunction",
                            "entryPoint": "shrinkFont",
                            "remoteAssetDirectory": "",
                            "contentScripts": [
                                {
                                    "id": "font-magnification-tool/1.0/js/font-magnification-tool.js",
                                    "source": "bGV0IHpvb20gPSAwOw0KbGV0IHpvb21Jbml0ID0gZmFsc2U7DQoNCmZ1bmN0aW9uIGluaXRGb250TWFnbmlmaWNhdGlvbigpIHsNCiAgICBpZiAoIXpvb21Jbml0KSB7DQogICAgICAgICQoJyonKS5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGxldCBlbCA9ICQodGhpcyk7DQogICAgICAgICAgICBsZXQgc2l6ZSA9IHBhcnNlSW50KGVsLmNzcygnZm9udC1zaXplJykpOw0KICAgICAgICAgICAgZWwuZGF0YSgnZm9udC1zaXplJywgc2l6ZSk7DQoNCg0KICAgICAgICB9KTsNCiAgICAgICAgem9vbUluaXQgPSB0cnVlOw0KICAgIH0NCg0KfQ0KDQpmdW5jdGlvbiBtYWduaWZ5Rm9udChyZXEsIGNvbmZpZyx3aWRnZXQpIHsNCiAgICBpbml0Rm9udE1hZ25pZmljYXRpb24oKTsNCiAgICB6b29tKys7DQogICAgJCgnKicpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICBpZighJCh0aGlzKS5wYXJlbnRzKCcuZWFzeS1yZWFkaW5nLWludGVyZmFjZScpLmxlbmd0aCl7DQogICAgICAgICAgICBsZXQgZWwgPSAkKHRoaXMpOw0KICAgICAgICAgICAgbGV0IHNpemUgPSBlbC5kYXRhKCdmb250LXNpemUnKTsNCiAgICAgICAgICAgIGVsLmNzcygnZm9udC1zaXplJywgTWF0aC5tYXgoc2l6ZSArIHpvb20sIDApICsgJ3B4Jyk7DQogICAgICAgIH0NCg0KICAgIH0pOw0KDQoNCn0NCg0KZnVuY3Rpb24gc2hyaW5rRm9udChyZXEsIGNvbmZpZykgew0KICAgIGluaXRGb250TWFnbmlmaWNhdGlvbigpOw0KICAgIHpvb20tLTsNCiAgICAkKCcqJykuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgIGlmKCEkKHRoaXMpLnBhcmVudHMoJy5lYXN5LXJlYWRpbmctaW50ZXJmYWNlJykubGVuZ3RoKXsNCiAgICAgICAgICAgIGxldCBlbCA9ICQodGhpcyk7DQogICAgICAgICAgICBsZXQgc2l6ZSA9IGVsLmRhdGEoJ2ZvbnQtc2l6ZScpOw0KICAgICAgICAgICAgZWwuY3NzKCdmb250LXNpemUnLCBNYXRoLm1heChzaXplICsgem9vbSwgMCkgKyAncHgnKTsNCiAgICAgICAgfQ0KDQogICAgfSk7DQp9DQoNCg0KDQovLy9MSU5FIEhFSUdIVA0KbGV0IGxpbmVIZWlnaHQgPSAwOw0KbGV0IGxpbmVIZWlnaHRJbml0ID0gZmFsc2U7DQoNCmZ1bmN0aW9uIGluaXRMaW5lSGVpZ2h0KCkgew0KICAgIGlmICghbGluZUhlaWdodEluaXQpIHsNCiAgICAgICAgJCgnKicpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgbGV0IGVsID0gJCh0aGlzKTsNCiAgICAgICAgICAgIGxldCBzaXplID0gcGFyc2VJbnQoZWwuY3NzKCdsaW5lLWhlaWdodCcpKTsNCiAgICAgICAgICAgIGVsLmRhdGEoJ2xpbmUtaGVpZ2h0Jywgc2l6ZSk7DQoNCiAgICAgICAgfSk7DQogICAgICAgIGxpbmVIZWlnaHRJbml0ID0gdHJ1ZTsNCiAgICB9DQoNCn0NCg0KZnVuY3Rpb24gaW5jcmVhc2VMaW5lSGVpZ2h0KHJlcSwgY29uZmlnKSB7DQogICAgaW5pdExpbmVIZWlnaHQoKTsNCiAgICBsaW5lSGVpZ2h0Kys7DQogICAgJCgnKicpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICBpZighJCh0aGlzKS5wYXJlbnRzKCcuZWFzeS1yZWFkaW5nLWludGVyZmFjZScpLmxlbmd0aCl7DQogICAgICAgICAgICBsZXQgZWwgPSAkKHRoaXMpOw0KICAgICAgICAgICAgbGV0IHNpemUgPSBlbC5kYXRhKCdsaW5lLWhlaWdodCcpOw0KICAgICAgICAgICAgZWwuY3NzKCdsaW5lLWhlaWdodCcsIE1hdGgubWF4KHNpemUgKyBsaW5lSGVpZ2h0LCAwKSArICdweCcpOw0KICAgICAgICB9DQoNCiAgICB9KTsNCg0KDQp9DQoNCmZ1bmN0aW9uIGRlY3JlYXNlTGluZUhlaWdodChyZXEsIGNvbmZpZykgew0KICAgIGluaXRMaW5lSGVpZ2h0KCk7DQogICAgbGluZUhlaWdodC0tOw0KICAgICQoJyonKS5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaWYoISQodGhpcykucGFyZW50cygnLmVhc3ktcmVhZGluZy1pbnRlcmZhY2UnKS5sZW5ndGgpew0KICAgICAgICAgICAgbGV0IGVsID0gJCh0aGlzKTsNCiAgICAgICAgICAgIGxldCBzaXplID0gZWwuZGF0YSgnbGluZS1oZWlnaHQnKTsNCiAgICAgICAgICAgIGVsLmNzcygnbGluZS1oZWlnaHQnLCBNYXRoLm1heChzaXplICsgbGluZUhlaWdodCwgMCkgKyAncHgnKTsNCiAgICAgICAgfQ0KDQogICAgfSk7DQp9"
                                }
                            ],
                            "contentCSS": []
                        }
                    },
                    "widget": {
                        "source": {
                            "id": "button",
                            "name": "Simple Button",
                            "description": "A simple button.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "",
                            "remoteBaseDirectory": "components/widget/button/1.0/",
                            "implementationClass": "Button",
                            "contentScripts": [
                                {
                                    "id": "widget/button.js",
                                    "source": "Y2xhc3MgQnV0dG9uIGV4dGVuZHMgV2lkZ2V0QmFzZSB7DQoNCiAgICBjb25zdHJ1Y3RvcihmdW5jdGlvbkluZm8sIHVzZXJJbnRlcmZhY2UsdGFyZ2V0SUQsIGNvbmZpZ3VyYXRpb24pew0KICAgICAgICBzdXBlcihmdW5jdGlvbkluZm8sdXNlckludGVyZmFjZSx0YXJnZXRJRCxjb25maWd1cmF0aW9uKTsNCg0KICAgICAgICB0aGlzLndpZGdldElEID0gJ2VyX2J1dHRvbl8nK3RoaXMud2lkZ2V0SUQ7DQogICAgICAgICQoIiMiK3RhcmdldElEKS5hcHBlbmQoIjxidXR0b24gaWQ9JyIrdGhpcy53aWRnZXRJRCsiJyBjbGFzcz0nZWFzeS1yZWFkaW5nLWJ1dHRvbic+PGltZyBzcmM9JyIrZnVuY3Rpb25JbmZvLnNvdXJjZS5kZWZhdWx0SWNvblVSTCsiJyB0aXRsZT0nIitmdW5jdGlvbkluZm8uc291cmNlLm5hbWUrIjogIitmdW5jdGlvbkluZm8uc291cmNlLmRlc2NyaXB0aW9uKyInPiA8L2J1dHRvbj4iKTsNCiAgICAgICAgdGhpcy5lbmFibGUoKTsNCiAgICB9DQoNCiAgICBlbmFibGUoKXsNCiAgICAgICAgJCgiIyIrdGhpcy53aWRnZXRJRCkub24oICJjbGljayIsdGhpcywgdGhpcy5idXR0b25DbGlja2VkKTsNCg0KICAgIH0NCg0KICAgIGRpc2FibGUoKXsNCiAgICAgICAgJCgiIyIrdGhpcy53aWRnZXRJRCkub2ZmKCAiY2xpY2siLHRoaXMsIHRoaXMuYnV0dG9uQ2xpY2tlZCk7DQogICAgfQ0KDQogICAgYnV0dG9uQ2xpY2tlZChlKXsNCiAgICAgICAgbGV0IHZvaWRJbnB1dCA9IHsNCiAgICAgICAgICAgIHR5cGU6ICJWb2lkIiwNCiAgICAgICAgfTsNCiAgICAgICAgcmVxdWVzdE1hbmFnZXIuY3JlYXRlUmVxdWVzdChlLmRhdGEsIHZvaWRJbnB1dCwgZSk7DQogICAgfQ0KDQogICAgcmVtb3ZlKCl7DQogICAgICAgICQoIiMiK3RoaXMud2lkZ2V0SUQpLnJlbW92ZSgpOw0KICAgIH0NCn0NCg=="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "widget/button.css",
                                    "css": "LmVhc3ktcmVhZGluZy1idXR0b24+aW1new0KICAgIG1heC13aWR0aDogMTAwJTsNCn0NCg0KLmVhc3ktcmVhZGluZy1idXR0b257DQogICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lICFpbXBvcnRhbnQ7DQogICAgLXdlYmtpdC1ib3JkZXItcmFkaXVzOiAwICFpbXBvcnRhbnQ7DQogICAgcGFkZGluZzogMCAhaW1wb3J0YW50Ow0KfQ=="
                                }
                            ]
                        }
                    }
                },
                {
                    "function": {
                        "source": {
                            "id": "image_search",
                            "engine": {
                                "id": "image_search",
                                "version": "1.0",
                                "debugMode": false
                            },
                            "debugMode": false,
                            "name": "Image Search",
                            "description": "Simple image search using Google Image Search",
                            "inputTypes": [
                                {
                                    "inputType": "Word",
                                    "name": "Input word",
                                    "description": "Word to translate"
                                }
                            ],
                            "outputTypes": [
                                {
                                    "outputType": "ImageIOType",
                                    "name": "Image",
                                    "description": "Image word"
                                }
                            ],
                            "defaultIcon": "assets/image_search.png",
                            "defaultIconURL": "https://localhost:8080/components/engines/image_search/1.0/assets/image_search.png",
                            "remoteBaseDirectory": "components/engines/image_search/1.0/",
                            "type": "RemoteFunction",
                            "entryPoint": "getImage"
                        }
                    },
                    "widget": {
                        "source": {
                            "id": "single-choice-button",
                            "name": "Single Choice Button",
                            "description": "A simple button.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "",
                            "remoteBaseDirectory": "components/widget/single-choice-button/1.0/",
                            "implementationClass": "SingleChoiceButton",
                            "contentScripts": [
                                {
                                    "id": "widget/single-choice-button.js",
                                    "source": "Y2xhc3MgU2luZ2xlQ2hvaWNlQnV0dG9uIGV4dGVuZHMgV2lkZ2V0QmFzZSB7DQoNCiAgICBjb25zdHJ1Y3RvcihmdW5jdGlvbkluZm8sIHVzZXJJbnRlcmZhY2UsIHRhcmdldElELCBjb25maWd1cmF0aW9uKSB7DQogICAgICAgIHN1cGVyKGZ1bmN0aW9uSW5mbywgdXNlckludGVyZmFjZSwgdGFyZ2V0SUQsIGNvbmZpZ3VyYXRpb24pOw0KDQogICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7DQogICAgICAgIHRoaXMub3V0cHV0VHlwZUNsYXNzID0gbnVsbDsNCiAgICAgICAgdGhpcy5yZXF1ZXN0SW5Qcm9ncmVzcyA9IGZhbHNlOw0KICAgICAgICB0aGlzLndpZGdldElEID0gJ2VyX3NpbmdsZV9jaG9pY2VfYnV0dG9uXycgKyB0aGlzLndpZGdldElEOw0KICAgICAgICAkKCIjIiArIHRhcmdldElEKS5hcHBlbmQoIjxidXR0b24gaWQ9JyIgKyB0aGlzLndpZGdldElEICsgIicgY2xhc3M9J2Vhc3ktcmVhZGluZy1zaW5nbGUtY2hvaWNlIGVhc3ktcmVhZGluZy1idXR0b24nPjxpbWcgc3JjPSciICsgZnVuY3Rpb25JbmZvLnNvdXJjZS5kZWZhdWx0SWNvblVSTCArICInIHRpdGxlPSciICsgZnVuY3Rpb25JbmZvLnNvdXJjZS5uYW1lICsgIjogIiArIGZ1bmN0aW9uSW5mby5zb3VyY2UuZGVzY3JpcHRpb24gKyAiJz4gPC9idXR0b24+Iik7DQoNCiAgICAgLy8gICAkKCIjIiArIHRoaXMud2lkZ2V0SUQpLmNzcygnY3NzVGV4dCcsICdiYWNrZ3JvdW5kLWNvbG9yOiAnK2NvbmZpZ3VyYXRpb24uYmFja2dyb3VuZENvbG9yQnV0dG9uQWN0aXZlKycgIWltcG9ydGFudCcpOw0KICAgICAgICB0aGlzLmVuYWJsZSgpOw0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFkZFdpZGdldEFjdGl2YXRlZExpc3RlbmVycyh0aGlzKTsNCiAgICB9DQoNCg0KICAgIGVuYWJsZSgpIHsNCiAgICAgICAgJCgiIyIgKyB0aGlzLndpZGdldElEKS5vbigiY2xpY2siLCB0aGlzLCB0aGlzLnNpbmdsZUNob2ljZUJ1dHRvbkNsaWNrZWQpOw0KDQogICAgfQ0KDQogICAgZGlzYWJsZSgpIHsNCiAgICAgICAgJCgiIyIgKyB0aGlzLndpZGdldElEKS5vZmYoImNsaWNrIiwgdGhpcywgdGhpcy5zaW5nbGVDaG9pY2VCdXR0b25DbGlja2VkKTsNCiAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5yZW1vdmVXaWRnZXRBY3RpdmF0ZWRMaXN0ZW5lcnModGhpcyk7DQoNCiAgICB9DQoNCiAgICBhY3RpdmF0ZVdpZGdldCgpew0KICAgICAgICBjb25zb2xlLmxvZygiU2luZ2xlIENob2ljZSBCdXR0b24gQWN0aXZlIik7DQogICAgICAgICQoIiMiICsgdGhpcy53aWRnZXRJRCkuYWRkQ2xhc3MoImVhc3ktcmVhZGluZy1zaW5nbGUtY2hvaWNlLWFjdGl2ZSIpOw0KICAgICAgICBpZih0aGlzLmZ1bmN0aW9uSW5mby5zb3VyY2UuaW5wdXRUeXBlcy5sZW5ndGggPiAwKXsNCiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5mdW5jdGlvbkluZm8uc291cmNlLmlucHV0VHlwZXNbMF0uaW5wdXRUeXBlKSB7DQoNCiAgICAgICAgICAgICAgICBjYXNlIFBhcmFncmFwaC5jbGFzc05hbWU6DQogICAgICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWRkUGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcih0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoNCiAgICAgICAgICAgICAgICBjYXNlIFdvcmQuY2xhc3NOYW1lOg0KICAgICAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFkZFdvcmRDbGlja0xpc3RlbmVyKHRoaXMpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCg0KICAgICAgICAgICAgICAgIGNhc2UgQW5ub3RhdGVkUGFyYWdyYXBoLmNsYXNzTmFtZToNCiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hZGRQYXJhZ3JhcGhDbGlja0xpc3RlbmVyKHRoaXMpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMub3V0cHV0VHlwZUNsYXNzID0gdGhpcy5mdW5jdGlvbkluZm8uc291cmNlLmlucHV0VHlwZXNbMF0uaW5wdXRUeXBlOw0KICAgICAgICB9DQoNCiAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci53aWRnZXRBY3RpdmF0ZWQodGhpcyk7DQoNCiAgICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlOw0KDQogICAgfQ0KDQogICAgZGVhY3RpdmF0ZVdpZGdldChtYW51YWw9dHJ1ZSl7DQogICAgICAgIHN1cGVyLmRlYWN0aXZhdGVXaWRnZXQobWFudWFsKTsNCiAgICAgICAgY29uc29sZS5sb2coIlNpbmdsZSBDaG9pY2UgQnV0dG9uIE5vdCBBY3RpdmUiKTsNCiAgICAgICAgJCgiIyIgKyB0aGlzLndpZGdldElEKS5yZW1vdmVDbGFzcygiZWFzeS1yZWFkaW5nLXNpbmdsZS1jaG9pY2UtYWN0aXZlIik7DQoNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZ1bmN0aW9uSW5mby5zb3VyY2UuaW5wdXRUeXBlcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgc3dpdGNoICh0aGlzLmZ1bmN0aW9uSW5mby5zb3VyY2UuaW5wdXRUeXBlc1tpXS5pbnB1dFR5cGUpIHsNCiAgICAgICAgICAgICAgICBjYXNlIFdvcmQuY2xhc3NOYW1lOg0KICAgICAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLnJlbW92ZVdvcmRDbGlja0xpc3RlbmVyKHRoaXMpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIFBhcmFncmFwaC5jbGFzc05hbWU6DQogICAgICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIucmVtb3ZlUGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcih0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSBBbm5vdGF0ZWRQYXJhZ3JhcGguY2xhc3NOYW1lOg0KICAgICAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLnJlbW92ZVBhcmFncmFwaENsaWNrTGlzdGVuZXIodGhpcyk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KDQoNCg0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlOw0KICAgIH0NCg0KICAgIHNpbmdsZUNob2ljZUJ1dHRvbkNsaWNrZWQoZSkgew0KICAgICAgICBpZihlLmRhdGEuYWN0aXZlKXsNCiAgICAgICAgICAgIGUuZGF0YS5kZWFjdGl2YXRlV2lkZ2V0KHRydWUpOw0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIGUuZGF0YS5hY3RpdmF0ZVdpZGdldCgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgb25Xb3JkQ2xpY2sod29yZCwgZSkgew0KICAgICAgICBpZih0aGlzLnJlcXVlc3RJblByb2dyZXNzKXsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLnJlcXVlc3RJblByb2dyZXNzID0gdHJ1ZTsNCiAgICAgICAgZWFzeVJlYWRpbmcuYnVzeUFuaW1hdGlvbi5zdGFydEFuaW1hdGlvbigpOw0KICAgICAgICBpZighdGhpcy5maWx0ZXJVc2VySW50ZXJmYWNlRWxlbWVudHMod29yZCkpew0KICAgICAgICAgICAgcmVxdWVzdE1hbmFnZXIuY3JlYXRlUmVxdWVzdCh0aGlzLCB3b3JkLCBlKTsNCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgb25QYXJhZ3JhcGhDTGljayhwYXJhZ3JhcGgsIGUpIHsNCiAgICAgICAgaWYodGhpcy5yZXF1ZXN0SW5Qcm9ncmVzcyl7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5yZXF1ZXN0SW5Qcm9ncmVzcyA9IHRydWU7DQogICAgICAgIGVhc3lSZWFkaW5nLmJ1c3lBbmltYXRpb24uc3RhcnRBbmltYXRpb24oKTsNCiAgICAgICAgaWYoIXRoaXMuZmlsdGVyVXNlckludGVyZmFjZUVsZW1lbnRzKHBhcmFncmFwaCkpew0KICAgICAgICAgICAgaWYodGhpcy5vdXRwdXRUeXBlQ2xhc3MgPT09IFBhcmFncmFwaC5jbGFzc05hbWUpew0KICAgICAgICAgICAgICAgIHJlcXVlc3RNYW5hZ2VyLmNyZWF0ZVJlcXVlc3QodGhpcywgcGFyYWdyYXBoLCBlKTsNCiAgICAgICAgICAgIH1lbHNlIGlmKHRoaXMub3V0cHV0VHlwZUNsYXNzID09PSBBbm5vdGF0ZWRQYXJhZ3JhcGguY2xhc3NOYW1lKXsNCiAgICAgICAgICAgICAgICBwYXJhZ3JhcGgudHlwZSA9IEFubm90YXRlZFBhcmFncmFwaC5jbGFzc05hbWU7DQogICAgICAgICAgICAgICAgcmVxdWVzdE1hbmFnZXIuY3JlYXRlUmVxdWVzdCh0aGlzLCBwYXJhZ3JhcGgsIGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZmlsdGVyVXNlckludGVyZmFjZUVsZW1lbnRzKGVsZW1lbnQpew0KICAgICAgICByZXR1cm4gJChlbGVtZW50KS5wYXJlbnRzKCcuZWFzeS1yZWFkaW5nLWludGVyZmFjZScpLmxlbmd0aDsNCiAgICB9DQoNCg0KICAgIHJlcXVlc3RGaW5pc2hlZCgpew0KICAgICAgICBzdXBlci5yZXF1ZXN0RmluaXNoZWQoKTsNCiAgICAgICAgZWFzeVJlYWRpbmcuYnVzeUFuaW1hdGlvbi5zdG9wQW5pbWF0aW9uKCk7DQogICAgICAgIHRoaXMucmVxdWVzdEluUHJvZ3Jlc3MgPSBmYWxzZTsNCiAgICB9DQoNCiAgICByZW1vdmUoKXsNCiAgICAgICAgaWYodGhpcy5hY3RpdmUpew0KICAgICAgICAgICAgdGhpcy5kZWFjdGl2YXRlV2lkZ2V0KGZhbHNlKTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLmRpc2FibGUoKTsNCiAgICAgICAgJCgiIyIgKyB0aGlzLndpZGdldElEKS5yZW1vdmUoKTsNCg0KICAgIH0NCn0="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "widget/single-choice-button.css",
                                    "css": "LmVhc3ktcmVhZGluZy1zaW5nbGUtY2hvaWNlPmltZ3sNCiAgICBtYXgtd2lkdGg6IDEwMCUgIWltcG9ydGFudDsNCn0NCg0KLmVhc3ktcmVhZGluZy1zaW5nbGUtY2hvaWNlLWFjdGl2ZXsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZjNjc5ICFpbXBvcnRhbnQ7DQp9DQoNCi5lYXN5LXJlYWRpbmctc2luZ2xlLWNob2ljZXsNCiAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmUgIWltcG9ydGFudDsNCiAgICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDAgIWltcG9ydGFudDsNCiAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7DQp9"
                                }
                            ]
                        }
                    },
                    "presentation": {
                        "source": {
                            "id": "tippy-tooltip",
                            "name": "TippyTooltip",
                            "description": "Renders the result within a tooltip based on tippy.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "/components/presentation/tippy-tooltip/1.0/presentation/images",
                            "remoteBaseDirectory": "components/presentation/tippy-tooltip/1.0/",
                            "implementationClass": "TippyTooltip",
                            "contentScripts": [
                                {
                                    "id": "presentation/popper.min.js",
                                    "source": "LyoKIENvcHlyaWdodCAoQykgRmVkZXJpY28gWml2b2xvIDIwMTkKIERpc3RyaWJ1dGVkIHVuZGVyIHRoZSBNSVQgTGljZW5zZSAobGljZW5zZSB0ZXJtcyBhcmUgYXQgaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVCkuCiAqLyhmdW5jdGlvbihlLHQpeydvYmplY3QnPT10eXBlb2YgZXhwb3J0cyYmJ3VuZGVmaW5lZCchPXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9dCgpOidmdW5jdGlvbic9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKHQpOmUuUG9wcGVyPXQoKX0pKHRoaXMsZnVuY3Rpb24oKXsndXNlIHN0cmljdCc7ZnVuY3Rpb24gZShlKXtyZXR1cm4gZSYmJ1tvYmplY3QgRnVuY3Rpb25dJz09PXt9LnRvU3RyaW5nLmNhbGwoZSl9ZnVuY3Rpb24gdChlLHQpe2lmKDEhPT1lLm5vZGVUeXBlKXJldHVybltdO3ZhciBvPWUub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldyxuPW8uZ2V0Q29tcHV0ZWRTdHlsZShlLG51bGwpO3JldHVybiB0P25bdF06bn1mdW5jdGlvbiBvKGUpe3JldHVybidIVE1MJz09PWUubm9kZU5hbWU/ZTplLnBhcmVudE5vZGV8fGUuaG9zdH1mdW5jdGlvbiBuKGUpe2lmKCFlKXJldHVybiBkb2N1bWVudC5ib2R5O3N3aXRjaChlLm5vZGVOYW1lKXtjYXNlJ0hUTUwnOmNhc2UnQk9EWSc6cmV0dXJuIGUub3duZXJEb2N1bWVudC5ib2R5O2Nhc2UnI2RvY3VtZW50JzpyZXR1cm4gZS5ib2R5O312YXIgaT10KGUpLHI9aS5vdmVyZmxvdyxwPWkub3ZlcmZsb3dYLHM9aS5vdmVyZmxvd1k7cmV0dXJuIC8oYXV0b3xzY3JvbGx8b3ZlcmxheSkvLnRlc3QocitzK3ApP2U6bihvKGUpKX1mdW5jdGlvbiByKGUpe3JldHVybiAxMT09PWU/cGU6MTA9PT1lP3NlOnBlfHxzZX1mdW5jdGlvbiBwKGUpe2lmKCFlKXJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7Zm9yKHZhciBvPXIoMTApP2RvY3VtZW50LmJvZHk6bnVsbCxuPWUub2Zmc2V0UGFyZW50fHxudWxsO249PT1vJiZlLm5leHRFbGVtZW50U2libGluZzspbj0oZT1lLm5leHRFbGVtZW50U2libGluZykub2Zmc2V0UGFyZW50O3ZhciBpPW4mJm4ubm9kZU5hbWU7cmV0dXJuIGkmJidCT0RZJyE9PWkmJidIVE1MJyE9PWk/LTEhPT1bJ1RIJywnVEQnLCdUQUJMRSddLmluZGV4T2Yobi5ub2RlTmFtZSkmJidzdGF0aWMnPT09dChuLCdwb3NpdGlvbicpP3Aobik6bjplP2Uub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ6ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50fWZ1bmN0aW9uIHMoZSl7dmFyIHQ9ZS5ub2RlTmFtZTtyZXR1cm4nQk9EWSchPT10JiYoJ0hUTUwnPT09dHx8cChlLmZpcnN0RWxlbWVudENoaWxkKT09PWUpfWZ1bmN0aW9uIGQoZSl7cmV0dXJuIG51bGw9PT1lLnBhcmVudE5vZGU/ZTpkKGUucGFyZW50Tm9kZSl9ZnVuY3Rpb24gYShlLHQpe2lmKCFlfHwhZS5ub2RlVHlwZXx8IXR8fCF0Lm5vZGVUeXBlKXJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7dmFyIG89ZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbih0KSZOb2RlLkRPQ1VNRU5UX1BPU0lUSU9OX0ZPTExPV0lORyxuPW8/ZTp0LGk9bz90OmUscj1kb2N1bWVudC5jcmVhdGVSYW5nZSgpO3Iuc2V0U3RhcnQobiwwKSxyLnNldEVuZChpLDApO3ZhciBsPXIuY29tbW9uQW5jZXN0b3JDb250YWluZXI7aWYoZSE9PWwmJnQhPT1sfHxuLmNvbnRhaW5zKGkpKXJldHVybiBzKGwpP2w6cChsKTt2YXIgZj1kKGUpO3JldHVybiBmLmhvc3Q/YShmLmhvc3QsdCk6YShlLGQodCkuaG9zdCl9ZnVuY3Rpb24gbChlKXt2YXIgdD0xPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06J3RvcCcsbz0ndG9wJz09PXQ/J3Njcm9sbFRvcCc6J3Njcm9sbExlZnQnLG49ZS5ub2RlTmFtZTtpZignQk9EWSc9PT1ufHwnSFRNTCc9PT1uKXt2YXIgaT1lLm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LHI9ZS5vd25lckRvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnR8fGk7cmV0dXJuIHJbb119cmV0dXJuIGVbb119ZnVuY3Rpb24gZihlLHQpe3ZhciBvPTI8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzJdJiZhcmd1bWVudHNbMl0sbj1sKHQsJ3RvcCcpLGk9bCh0LCdsZWZ0Jykscj1vPy0xOjE7cmV0dXJuIGUudG9wKz1uKnIsZS5ib3R0b20rPW4qcixlLmxlZnQrPWkqcixlLnJpZ2h0Kz1pKnIsZX1mdW5jdGlvbiBtKGUsdCl7dmFyIG89J3gnPT09dD8nTGVmdCc6J1RvcCcsbj0nTGVmdCc9PW8/J1JpZ2h0JzonQm90dG9tJztyZXR1cm4gcGFyc2VGbG9hdChlWydib3JkZXInK28rJ1dpZHRoJ10sMTApK3BhcnNlRmxvYXQoZVsnYm9yZGVyJytuKydXaWR0aCddLDEwKX1mdW5jdGlvbiBoKGUsdCxvLG4pe3JldHVybiBlZSh0WydvZmZzZXQnK2VdLHRbJ3Njcm9sbCcrZV0sb1snY2xpZW50JytlXSxvWydvZmZzZXQnK2VdLG9bJ3Njcm9sbCcrZV0scigxMCk/cGFyc2VJbnQob1snb2Zmc2V0JytlXSkrcGFyc2VJbnQoblsnbWFyZ2luJysoJ0hlaWdodCc9PT1lPydUb3AnOidMZWZ0JyldKStwYXJzZUludChuWydtYXJnaW4nKygnSGVpZ2h0Jz09PWU/J0JvdHRvbSc6J1JpZ2h0JyldKTowKX1mdW5jdGlvbiBjKGUpe3ZhciB0PWUuYm9keSxvPWUuZG9jdW1lbnRFbGVtZW50LG49cigxMCkmJmdldENvbXB1dGVkU3R5bGUobyk7cmV0dXJue2hlaWdodDpoKCdIZWlnaHQnLHQsbyxuKSx3aWR0aDpoKCdXaWR0aCcsdCxvLG4pfX1mdW5jdGlvbiBnKGUpe3JldHVybiBmZSh7fSxlLHtyaWdodDplLmxlZnQrZS53aWR0aCxib3R0b206ZS50b3ArZS5oZWlnaHR9KX1mdW5jdGlvbiB1KGUpe3ZhciBvPXt9O3RyeXtpZihyKDEwKSl7bz1lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3ZhciBuPWwoZSwndG9wJyksaT1sKGUsJ2xlZnQnKTtvLnRvcCs9bixvLmxlZnQrPWksby5ib3R0b20rPW4sby5yaWdodCs9aX1lbHNlIG89ZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKX1jYXRjaCh0KXt9dmFyIHA9e2xlZnQ6by5sZWZ0LHRvcDpvLnRvcCx3aWR0aDpvLnJpZ2h0LW8ubGVmdCxoZWlnaHQ6by5ib3R0b20tby50b3B9LHM9J0hUTUwnPT09ZS5ub2RlTmFtZT9jKGUub3duZXJEb2N1bWVudCk6e30sZD1zLndpZHRofHxlLmNsaWVudFdpZHRofHxwLnJpZ2h0LXAubGVmdCxhPXMuaGVpZ2h0fHxlLmNsaWVudEhlaWdodHx8cC5ib3R0b20tcC50b3AsZj1lLm9mZnNldFdpZHRoLWQsaD1lLm9mZnNldEhlaWdodC1hO2lmKGZ8fGgpe3ZhciB1PXQoZSk7Zi09bSh1LCd4JyksaC09bSh1LCd5JykscC53aWR0aC09ZixwLmhlaWdodC09aH1yZXR1cm4gZyhwKX1mdW5jdGlvbiBiKGUsbyl7dmFyIGk9Mjxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0mJmFyZ3VtZW50c1syXSxwPXIoMTApLHM9J0hUTUwnPT09by5ub2RlTmFtZSxkPXUoZSksYT11KG8pLGw9bihlKSxtPXQobyksaD1wYXJzZUZsb2F0KG0uYm9yZGVyVG9wV2lkdGgsMTApLGM9cGFyc2VGbG9hdChtLmJvcmRlckxlZnRXaWR0aCwxMCk7aSYmcyYmKGEudG9wPWVlKGEudG9wLDApLGEubGVmdD1lZShhLmxlZnQsMCkpO3ZhciBiPWcoe3RvcDpkLnRvcC1hLnRvcC1oLGxlZnQ6ZC5sZWZ0LWEubGVmdC1jLHdpZHRoOmQud2lkdGgsaGVpZ2h0OmQuaGVpZ2h0fSk7aWYoYi5tYXJnaW5Ub3A9MCxiLm1hcmdpbkxlZnQ9MCwhcCYmcyl7dmFyIHc9cGFyc2VGbG9hdChtLm1hcmdpblRvcCwxMCkseT1wYXJzZUZsb2F0KG0ubWFyZ2luTGVmdCwxMCk7Yi50b3AtPWgtdyxiLmJvdHRvbS09aC13LGIubGVmdC09Yy15LGIucmlnaHQtPWMteSxiLm1hcmdpblRvcD13LGIubWFyZ2luTGVmdD15fXJldHVybihwJiYhaT9vLmNvbnRhaW5zKGwpOm89PT1sJiYnQk9EWSchPT1sLm5vZGVOYW1lKSYmKGI9ZihiLG8pKSxifWZ1bmN0aW9uIHcoZSl7dmFyIHQ9MTxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0mJmFyZ3VtZW50c1sxXSxvPWUub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsbj1iKGUsbyksaT1lZShvLmNsaWVudFdpZHRoLHdpbmRvdy5pbm5lcldpZHRofHwwKSxyPWVlKG8uY2xpZW50SGVpZ2h0LHdpbmRvdy5pbm5lckhlaWdodHx8MCkscD10PzA6bChvKSxzPXQ/MDpsKG8sJ2xlZnQnKSxkPXt0b3A6cC1uLnRvcCtuLm1hcmdpblRvcCxsZWZ0OnMtbi5sZWZ0K24ubWFyZ2luTGVmdCx3aWR0aDppLGhlaWdodDpyfTtyZXR1cm4gZyhkKX1mdW5jdGlvbiB5KGUpe3ZhciBuPWUubm9kZU5hbWU7aWYoJ0JPRFknPT09bnx8J0hUTUwnPT09bilyZXR1cm4hMTtpZignZml4ZWQnPT09dChlLCdwb3NpdGlvbicpKXJldHVybiEwO3ZhciBpPW8oZSk7cmV0dXJuISFpJiZ5KGkpfWZ1bmN0aW9uIEUoZSl7aWYoIWV8fCFlLnBhcmVudEVsZW1lbnR8fHIoKSlyZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O2Zvcih2YXIgbz1lLnBhcmVudEVsZW1lbnQ7byYmJ25vbmUnPT09dChvLCd0cmFuc2Zvcm0nKTspbz1vLnBhcmVudEVsZW1lbnQ7cmV0dXJuIG98fGRvY3VtZW50LmRvY3VtZW50RWxlbWVudH1mdW5jdGlvbiB2KGUsdCxpLHIpe3ZhciBwPTQ8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzRdJiZhcmd1bWVudHNbNF0scz17dG9wOjAsbGVmdDowfSxkPXA/RShlKTphKGUsdCk7aWYoJ3ZpZXdwb3J0Jz09PXIpcz13KGQscCk7ZWxzZXt2YXIgbDsnc2Nyb2xsUGFyZW50Jz09PXI/KGw9bihvKHQpKSwnQk9EWSc9PT1sLm5vZGVOYW1lJiYobD1lLm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSk6J3dpbmRvdyc9PT1yP2w9ZS5vd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudDpsPXI7dmFyIGY9YihsLGQscCk7aWYoJ0hUTUwnPT09bC5ub2RlTmFtZSYmIXkoZCkpe3ZhciBtPWMoZS5vd25lckRvY3VtZW50KSxoPW0uaGVpZ2h0LGc9bS53aWR0aDtzLnRvcCs9Zi50b3AtZi5tYXJnaW5Ub3Ascy5ib3R0b209aCtmLnRvcCxzLmxlZnQrPWYubGVmdC1mLm1hcmdpbkxlZnQscy5yaWdodD1nK2YubGVmdH1lbHNlIHM9Zn1pPWl8fDA7dmFyIHU9J251bWJlcic9PXR5cGVvZiBpO3JldHVybiBzLmxlZnQrPXU/aTppLmxlZnR8fDAscy50b3ArPXU/aTppLnRvcHx8MCxzLnJpZ2h0LT11P2k6aS5yaWdodHx8MCxzLmJvdHRvbS09dT9pOmkuYm90dG9tfHwwLHN9ZnVuY3Rpb24geChlKXt2YXIgdD1lLndpZHRoLG89ZS5oZWlnaHQ7cmV0dXJuIHQqb31mdW5jdGlvbiBPKGUsdCxvLG4saSl7dmFyIHI9NTxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbNV0/YXJndW1lbnRzWzVdOjA7aWYoLTE9PT1lLmluZGV4T2YoJ2F1dG8nKSlyZXR1cm4gZTt2YXIgcD12KG8sbixyLGkpLHM9e3RvcDp7d2lkdGg6cC53aWR0aCxoZWlnaHQ6dC50b3AtcC50b3B9LHJpZ2h0Ont3aWR0aDpwLnJpZ2h0LXQucmlnaHQsaGVpZ2h0OnAuaGVpZ2h0fSxib3R0b206e3dpZHRoOnAud2lkdGgsaGVpZ2h0OnAuYm90dG9tLXQuYm90dG9tfSxsZWZ0Ont3aWR0aDp0LmxlZnQtcC5sZWZ0LGhlaWdodDpwLmhlaWdodH19LGQ9T2JqZWN0LmtleXMocykubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBmZSh7a2V5OmV9LHNbZV0se2FyZWE6eChzW2VdKX0pfSkuc29ydChmdW5jdGlvbihlLHQpe3JldHVybiB0LmFyZWEtZS5hcmVhfSksYT1kLmZpbHRlcihmdW5jdGlvbihlKXt2YXIgdD1lLndpZHRoLG49ZS5oZWlnaHQ7cmV0dXJuIHQ+PW8uY2xpZW50V2lkdGgmJm4+PW8uY2xpZW50SGVpZ2h0fSksbD0wPGEubGVuZ3RoP2FbMF0ua2V5OmRbMF0ua2V5LGY9ZS5zcGxpdCgnLScpWzFdO3JldHVybiBsKyhmPyctJytmOicnKX1mdW5jdGlvbiBMKGUsdCxvKXt2YXIgbj0zPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1szXT9hcmd1bWVudHNbM106bnVsbCxpPW4/RSh0KTphKHQsbyk7cmV0dXJuIGIobyxpLG4pfWZ1bmN0aW9uIFMoZSl7dmFyIHQ9ZS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LG89dC5nZXRDb21wdXRlZFN0eWxlKGUpLG49cGFyc2VGbG9hdChvLm1hcmdpblRvcHx8MCkrcGFyc2VGbG9hdChvLm1hcmdpbkJvdHRvbXx8MCksaT1wYXJzZUZsb2F0KG8ubWFyZ2luTGVmdHx8MCkrcGFyc2VGbG9hdChvLm1hcmdpblJpZ2h0fHwwKSxyPXt3aWR0aDplLm9mZnNldFdpZHRoK2ksaGVpZ2h0OmUub2Zmc2V0SGVpZ2h0K259O3JldHVybiByfWZ1bmN0aW9uIFQoZSl7dmFyIHQ9e2xlZnQ6J3JpZ2h0JyxyaWdodDonbGVmdCcsYm90dG9tOid0b3AnLHRvcDonYm90dG9tJ307cmV0dXJuIGUucmVwbGFjZSgvbGVmdHxyaWdodHxib3R0b218dG9wL2csZnVuY3Rpb24oZSl7cmV0dXJuIHRbZV19KX1mdW5jdGlvbiBDKGUsdCxvKXtvPW8uc3BsaXQoJy0nKVswXTt2YXIgbj1TKGUpLGk9e3dpZHRoOm4ud2lkdGgsaGVpZ2h0Om4uaGVpZ2h0fSxyPS0xIT09WydyaWdodCcsJ2xlZnQnXS5pbmRleE9mKG8pLHA9cj8ndG9wJzonbGVmdCcscz1yPydsZWZ0JzondG9wJyxkPXI/J2hlaWdodCc6J3dpZHRoJyxhPXI/J3dpZHRoJzonaGVpZ2h0JztyZXR1cm4gaVtwXT10W3BdK3RbZF0vMi1uW2RdLzIsaVtzXT1vPT09cz90W3NdLW5bYV06dFtUKHMpXSxpfWZ1bmN0aW9uIEQoZSx0KXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLmZpbmQ/ZS5maW5kKHQpOmUuZmlsdGVyKHQpWzBdfWZ1bmN0aW9uIE4oZSx0LG8pe2lmKEFycmF5LnByb3RvdHlwZS5maW5kSW5kZXgpcmV0dXJuIGUuZmluZEluZGV4KGZ1bmN0aW9uKGUpe3JldHVybiBlW3RdPT09b30pO3ZhciBuPUQoZSxmdW5jdGlvbihlKXtyZXR1cm4gZVt0XT09PW99KTtyZXR1cm4gZS5pbmRleE9mKG4pfWZ1bmN0aW9uIFAodCxvLG4pe3ZhciBpPXZvaWQgMD09PW4/dDp0LnNsaWNlKDAsTih0LCduYW1lJyxuKSk7cmV0dXJuIGkuZm9yRWFjaChmdW5jdGlvbih0KXt0WydmdW5jdGlvbiddJiZjb25zb2xlLndhcm4oJ2Btb2RpZmllci5mdW5jdGlvbmAgaXMgZGVwcmVjYXRlZCwgdXNlIGBtb2RpZmllci5mbmAhJyk7dmFyIG49dFsnZnVuY3Rpb24nXXx8dC5mbjt0LmVuYWJsZWQmJmUobikmJihvLm9mZnNldHMucG9wcGVyPWcoby5vZmZzZXRzLnBvcHBlciksby5vZmZzZXRzLnJlZmVyZW5jZT1nKG8ub2Zmc2V0cy5yZWZlcmVuY2UpLG89bihvLHQpKX0pLG99ZnVuY3Rpb24gaygpe2lmKCF0aGlzLnN0YXRlLmlzRGVzdHJveWVkKXt2YXIgZT17aW5zdGFuY2U6dGhpcyxzdHlsZXM6e30sYXJyb3dTdHlsZXM6e30sYXR0cmlidXRlczp7fSxmbGlwcGVkOiExLG9mZnNldHM6e319O2Uub2Zmc2V0cy5yZWZlcmVuY2U9TCh0aGlzLnN0YXRlLHRoaXMucG9wcGVyLHRoaXMucmVmZXJlbmNlLHRoaXMub3B0aW9ucy5wb3NpdGlvbkZpeGVkKSxlLnBsYWNlbWVudD1PKHRoaXMub3B0aW9ucy5wbGFjZW1lbnQsZS5vZmZzZXRzLnJlZmVyZW5jZSx0aGlzLnBvcHBlcix0aGlzLnJlZmVyZW5jZSx0aGlzLm9wdGlvbnMubW9kaWZpZXJzLmZsaXAuYm91bmRhcmllc0VsZW1lbnQsdGhpcy5vcHRpb25zLm1vZGlmaWVycy5mbGlwLnBhZGRpbmcpLGUub3JpZ2luYWxQbGFjZW1lbnQ9ZS5wbGFjZW1lbnQsZS5wb3NpdGlvbkZpeGVkPXRoaXMub3B0aW9ucy5wb3NpdGlvbkZpeGVkLGUub2Zmc2V0cy5wb3BwZXI9Qyh0aGlzLnBvcHBlcixlLm9mZnNldHMucmVmZXJlbmNlLGUucGxhY2VtZW50KSxlLm9mZnNldHMucG9wcGVyLnBvc2l0aW9uPXRoaXMub3B0aW9ucy5wb3NpdGlvbkZpeGVkPydmaXhlZCc6J2Fic29sdXRlJyxlPVAodGhpcy5tb2RpZmllcnMsZSksdGhpcy5zdGF0ZS5pc0NyZWF0ZWQ/dGhpcy5vcHRpb25zLm9uVXBkYXRlKGUpOih0aGlzLnN0YXRlLmlzQ3JlYXRlZD0hMCx0aGlzLm9wdGlvbnMub25DcmVhdGUoZSkpfX1mdW5jdGlvbiBXKGUsdCl7cmV0dXJuIGUuc29tZShmdW5jdGlvbihlKXt2YXIgbz1lLm5hbWUsbj1lLmVuYWJsZWQ7cmV0dXJuIG4mJm89PT10fSl9ZnVuY3Rpb24gQihlKXtmb3IodmFyIHQ9WyExLCdtcycsJ1dlYmtpdCcsJ01veicsJ08nXSxvPWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrZS5zbGljZSgxKSxuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciBpPXRbbl0scj1pPycnK2krbzplO2lmKCd1bmRlZmluZWQnIT10eXBlb2YgZG9jdW1lbnQuYm9keS5zdHlsZVtyXSlyZXR1cm4gcn1yZXR1cm4gbnVsbH1mdW5jdGlvbiBIKCl7cmV0dXJuIHRoaXMuc3RhdGUuaXNEZXN0cm95ZWQ9ITAsVyh0aGlzLm1vZGlmaWVycywnYXBwbHlTdHlsZScpJiYodGhpcy5wb3BwZXIucmVtb3ZlQXR0cmlidXRlKCd4LXBsYWNlbWVudCcpLHRoaXMucG9wcGVyLnN0eWxlLnBvc2l0aW9uPScnLHRoaXMucG9wcGVyLnN0eWxlLnRvcD0nJyx0aGlzLnBvcHBlci5zdHlsZS5sZWZ0PScnLHRoaXMucG9wcGVyLnN0eWxlLnJpZ2h0PScnLHRoaXMucG9wcGVyLnN0eWxlLmJvdHRvbT0nJyx0aGlzLnBvcHBlci5zdHlsZS53aWxsQ2hhbmdlPScnLHRoaXMucG9wcGVyLnN0eWxlW0IoJ3RyYW5zZm9ybScpXT0nJyksdGhpcy5kaXNhYmxlRXZlbnRMaXN0ZW5lcnMoKSx0aGlzLm9wdGlvbnMucmVtb3ZlT25EZXN0cm95JiZ0aGlzLnBvcHBlci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMucG9wcGVyKSx0aGlzfWZ1bmN0aW9uIEEoZSl7dmFyIHQ9ZS5vd25lckRvY3VtZW50O3JldHVybiB0P3QuZGVmYXVsdFZpZXc6d2luZG93fWZ1bmN0aW9uIE0oZSx0LG8saSl7dmFyIHI9J0JPRFknPT09ZS5ub2RlTmFtZSxwPXI/ZS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3OmU7cC5hZGRFdmVudExpc3RlbmVyKHQsbyx7cGFzc2l2ZTohMH0pLHJ8fE0obihwLnBhcmVudE5vZGUpLHQsbyxpKSxpLnB1c2gocCl9ZnVuY3Rpb24gRihlLHQsbyxpKXtvLnVwZGF0ZUJvdW5kPWksQShlKS5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLG8udXBkYXRlQm91bmQse3Bhc3NpdmU6ITB9KTt2YXIgcj1uKGUpO3JldHVybiBNKHIsJ3Njcm9sbCcsby51cGRhdGVCb3VuZCxvLnNjcm9sbFBhcmVudHMpLG8uc2Nyb2xsRWxlbWVudD1yLG8uZXZlbnRzRW5hYmxlZD0hMCxvfWZ1bmN0aW9uIEkoKXt0aGlzLnN0YXRlLmV2ZW50c0VuYWJsZWR8fCh0aGlzLnN0YXRlPUYodGhpcy5yZWZlcmVuY2UsdGhpcy5vcHRpb25zLHRoaXMuc3RhdGUsdGhpcy5zY2hlZHVsZVVwZGF0ZSkpfWZ1bmN0aW9uIFIoZSx0KXtyZXR1cm4gQShlKS5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLHQudXBkYXRlQm91bmQpLHQuc2Nyb2xsUGFyZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJyx0LnVwZGF0ZUJvdW5kKX0pLHQudXBkYXRlQm91bmQ9bnVsbCx0LnNjcm9sbFBhcmVudHM9W10sdC5zY3JvbGxFbGVtZW50PW51bGwsdC5ldmVudHNFbmFibGVkPSExLHR9ZnVuY3Rpb24gVSgpe3RoaXMuc3RhdGUuZXZlbnRzRW5hYmxlZCYmKGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuc2NoZWR1bGVVcGRhdGUpLHRoaXMuc3RhdGU9Uih0aGlzLnJlZmVyZW5jZSx0aGlzLnN0YXRlKSl9ZnVuY3Rpb24gWShlKXtyZXR1cm4nJyE9PWUmJiFpc05hTihwYXJzZUZsb2F0KGUpKSYmaXNGaW5pdGUoZSl9ZnVuY3Rpb24gVihlLHQpe09iamVjdC5rZXlzKHQpLmZvckVhY2goZnVuY3Rpb24obyl7dmFyIG49Jyc7LTEhPT1bJ3dpZHRoJywnaGVpZ2h0JywndG9wJywncmlnaHQnLCdib3R0b20nLCdsZWZ0J10uaW5kZXhPZihvKSYmWSh0W29dKSYmKG49J3B4JyksZS5zdHlsZVtvXT10W29dK259KX1mdW5jdGlvbiBqKGUsdCl7T2JqZWN0LmtleXModCkuZm9yRWFjaChmdW5jdGlvbihvKXt2YXIgbj10W29dOyExPT09bj9lLnJlbW92ZUF0dHJpYnV0ZShvKTplLnNldEF0dHJpYnV0ZShvLHRbb10pfSl9ZnVuY3Rpb24gcShlLHQpe3ZhciBvPWUub2Zmc2V0cyxuPW8ucG9wcGVyLGk9by5yZWZlcmVuY2Uscj0kLHA9ZnVuY3Rpb24oZSl7cmV0dXJuIGV9LHM9cihpLndpZHRoKSxkPXIobi53aWR0aCksYT0tMSE9PVsnbGVmdCcsJ3JpZ2h0J10uaW5kZXhPZihlLnBsYWNlbWVudCksbD0tMSE9PWUucGxhY2VtZW50LmluZGV4T2YoJy0nKSxmPXQ/YXx8bHx8cyUyPT1kJTI/cjpaOnAsbT10P3I6cDtyZXR1cm57bGVmdDpmKDE9PXMlMiYmMT09ZCUyJiYhbCYmdD9uLmxlZnQtMTpuLmxlZnQpLHRvcDptKG4udG9wKSxib3R0b206bShuLmJvdHRvbSkscmlnaHQ6ZihuLnJpZ2h0KX19ZnVuY3Rpb24gSyhlLHQsbyl7dmFyIG49RChlLGZ1bmN0aW9uKGUpe3ZhciBvPWUubmFtZTtyZXR1cm4gbz09PXR9KSxpPSEhbiYmZS5zb21lKGZ1bmN0aW9uKGUpe3JldHVybiBlLm5hbWU9PT1vJiZlLmVuYWJsZWQmJmUub3JkZXI8bi5vcmRlcn0pO2lmKCFpKXt2YXIgcj0nYCcrdCsnYCc7Y29uc29sZS53YXJuKCdgJytvKydgJysnIG1vZGlmaWVyIGlzIHJlcXVpcmVkIGJ5ICcrcisnIG1vZGlmaWVyIGluIG9yZGVyIHRvIHdvcmssIGJlIHN1cmUgdG8gaW5jbHVkZSBpdCBiZWZvcmUgJytyKychJyl9cmV0dXJuIGl9ZnVuY3Rpb24geihlKXtyZXR1cm4nZW5kJz09PWU/J3N0YXJ0Jzonc3RhcnQnPT09ZT8nZW5kJzplfWZ1bmN0aW9uIEcoZSl7dmFyIHQ9MTxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0mJmFyZ3VtZW50c1sxXSxvPWNlLmluZGV4T2YoZSksbj1jZS5zbGljZShvKzEpLmNvbmNhdChjZS5zbGljZSgwLG8pKTtyZXR1cm4gdD9uLnJldmVyc2UoKTpufWZ1bmN0aW9uIF8oZSx0LG8sbil7dmFyIGk9ZS5tYXRjaCgvKCg/OlwtfFwrKT9cZCpcLj9cZCopKC4qKS8pLHI9K2lbMV0scD1pWzJdO2lmKCFyKXJldHVybiBlO2lmKDA9PT1wLmluZGV4T2YoJyUnKSl7dmFyIHM7c3dpdGNoKHApe2Nhc2UnJXAnOnM9bzticmVhaztjYXNlJyUnOmNhc2UnJXInOmRlZmF1bHQ6cz1uO312YXIgZD1nKHMpO3JldHVybiBkW3RdLzEwMCpyfWlmKCd2aCc9PT1wfHwndncnPT09cCl7dmFyIGE7cmV0dXJuIGE9J3ZoJz09PXA/ZWUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCx3aW5kb3cuaW5uZXJIZWlnaHR8fDApOmVlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCx3aW5kb3cuaW5uZXJXaWR0aHx8MCksYS8xMDAqcn1yZXR1cm4gcn1mdW5jdGlvbiBYKGUsdCxvLG4pe3ZhciBpPVswLDBdLHI9LTEhPT1bJ3JpZ2h0JywnbGVmdCddLmluZGV4T2YobikscD1lLnNwbGl0KC8oXCt8XC0pLykubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBlLnRyaW0oKX0pLHM9cC5pbmRleE9mKEQocCxmdW5jdGlvbihlKXtyZXR1cm4tMSE9PWUuc2VhcmNoKC8sfFxzLyl9KSk7cFtzXSYmLTE9PT1wW3NdLmluZGV4T2YoJywnKSYmY29uc29sZS53YXJuKCdPZmZzZXRzIHNlcGFyYXRlZCBieSB3aGl0ZSBzcGFjZShzKSBhcmUgZGVwcmVjYXRlZCwgdXNlIGEgY29tbWEgKCwpIGluc3RlYWQuJyk7dmFyIGQ9L1xzKixccyp8XHMrLyxhPS0xPT09cz9bcF06W3Auc2xpY2UoMCxzKS5jb25jYXQoW3Bbc10uc3BsaXQoZClbMF1dKSxbcFtzXS5zcGxpdChkKVsxXV0uY29uY2F0KHAuc2xpY2UocysxKSldO3JldHVybiBhPWEubWFwKGZ1bmN0aW9uKGUsbil7dmFyIGk9KDE9PT1uPyFyOnIpPydoZWlnaHQnOid3aWR0aCcscD0hMTtyZXR1cm4gZS5yZWR1Y2UoZnVuY3Rpb24oZSx0KXtyZXR1cm4nJz09PWVbZS5sZW5ndGgtMV0mJi0xIT09WycrJywnLSddLmluZGV4T2YodCk/KGVbZS5sZW5ndGgtMV09dCxwPSEwLGUpOnA/KGVbZS5sZW5ndGgtMV0rPXQscD0hMSxlKTplLmNvbmNhdCh0KX0sW10pLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gXyhlLGksdCxvKX0pfSksYS5mb3JFYWNoKGZ1bmN0aW9uKGUsdCl7ZS5mb3JFYWNoKGZ1bmN0aW9uKG8sbil7WShvKSYmKGlbdF0rPW8qKCctJz09PWVbbi0xXT8tMToxKSl9KX0pLGl9ZnVuY3Rpb24gSihlLHQpe3ZhciBvLG49dC5vZmZzZXQsaT1lLnBsYWNlbWVudCxyPWUub2Zmc2V0cyxwPXIucG9wcGVyLHM9ci5yZWZlcmVuY2UsZD1pLnNwbGl0KCctJylbMF07cmV0dXJuIG89WSgrbik/WytuLDBdOlgobixwLHMsZCksJ2xlZnQnPT09ZD8ocC50b3ArPW9bMF0scC5sZWZ0LT1vWzFdKToncmlnaHQnPT09ZD8ocC50b3ArPW9bMF0scC5sZWZ0Kz1vWzFdKTondG9wJz09PWQ/KHAubGVmdCs9b1swXSxwLnRvcC09b1sxXSk6J2JvdHRvbSc9PT1kJiYocC5sZWZ0Kz1vWzBdLHAudG9wKz1vWzFdKSxlLnBvcHBlcj1wLGV9Zm9yKHZhciBRPU1hdGgubWluLFo9TWF0aC5mbG9vciwkPU1hdGgucm91bmQsZWU9TWF0aC5tYXgsdGU9J3VuZGVmaW5lZCchPXR5cGVvZiB3aW5kb3cmJid1bmRlZmluZWQnIT10eXBlb2YgZG9jdW1lbnQsb2U9WydFZGdlJywnVHJpZGVudCcsJ0ZpcmVmb3gnXSxuZT0wLGllPTA7aWU8b2UubGVuZ3RoO2llKz0xKWlmKHRlJiYwPD1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2Yob2VbaWVdKSl7bmU9MTticmVha312YXIgaT10ZSYmd2luZG93LlByb21pc2UscmU9aT9mdW5jdGlvbihlKXt2YXIgdD0hMTtyZXR1cm4gZnVuY3Rpb24oKXt0fHwodD0hMCx3aW5kb3cuUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpe3Q9ITEsZSgpfSkpfX06ZnVuY3Rpb24oZSl7dmFyIHQ9ITE7cmV0dXJuIGZ1bmN0aW9uKCl7dHx8KHQ9ITAsc2V0VGltZW91dChmdW5jdGlvbigpe3Q9ITEsZSgpfSxuZSkpfX0scGU9dGUmJiEhKHdpbmRvdy5NU0lucHV0TWV0aG9kQ29udGV4dCYmZG9jdW1lbnQuZG9jdW1lbnRNb2RlKSxzZT10ZSYmL01TSUUgMTAvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksZGU9ZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKX0sYWU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7Zm9yKHZhciBvLG49MDtuPHQubGVuZ3RoO24rKylvPXRbbl0sby5lbnVtZXJhYmxlPW8uZW51bWVyYWJsZXx8ITEsby5jb25maWd1cmFibGU9ITAsJ3ZhbHVlJ2luIG8mJihvLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxvLmtleSxvKX1yZXR1cm4gZnVuY3Rpb24odCxvLG4pe3JldHVybiBvJiZlKHQucHJvdG90eXBlLG8pLG4mJmUodCxuKSx0fX0oKSxsZT1mdW5jdGlvbihlLHQsbyl7cmV0dXJuIHQgaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHt2YWx1ZTpvLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVt0XT1vLGV9LGZlPU9iamVjdC5hc3NpZ258fGZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxvPTE7bzxhcmd1bWVudHMubGVuZ3RoO28rKylmb3IodmFyIG4gaW4gdD1hcmd1bWVudHNbb10sdClPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxuKSYmKGVbbl09dFtuXSk7cmV0dXJuIGV9LG1lPXRlJiYvRmlyZWZveC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksaGU9WydhdXRvLXN0YXJ0JywnYXV0bycsJ2F1dG8tZW5kJywndG9wLXN0YXJ0JywndG9wJywndG9wLWVuZCcsJ3JpZ2h0LXN0YXJ0JywncmlnaHQnLCdyaWdodC1lbmQnLCdib3R0b20tZW5kJywnYm90dG9tJywnYm90dG9tLXN0YXJ0JywnbGVmdC1lbmQnLCdsZWZ0JywnbGVmdC1zdGFydCddLGNlPWhlLnNsaWNlKDMpLGdlPXtGTElQOidmbGlwJyxDTE9DS1dJU0U6J2Nsb2Nrd2lzZScsQ09VTlRFUkNMT0NLV0lTRTonY291bnRlcmNsb2Nrd2lzZSd9LHVlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChvLG4pe3ZhciBpPXRoaXMscj0yPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1syXT9hcmd1bWVudHNbMl06e307ZGUodGhpcyx0KSx0aGlzLnNjaGVkdWxlVXBkYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHJlcXVlc3RBbmltYXRpb25GcmFtZShpLnVwZGF0ZSl9LHRoaXMudXBkYXRlPXJlKHRoaXMudXBkYXRlLmJpbmQodGhpcykpLHRoaXMub3B0aW9ucz1mZSh7fSx0LkRlZmF1bHRzLHIpLHRoaXMuc3RhdGU9e2lzRGVzdHJveWVkOiExLGlzQ3JlYXRlZDohMSxzY3JvbGxQYXJlbnRzOltdfSx0aGlzLnJlZmVyZW5jZT1vJiZvLmpxdWVyeT9vWzBdOm8sdGhpcy5wb3BwZXI9biYmbi5qcXVlcnk/blswXTpuLHRoaXMub3B0aW9ucy5tb2RpZmllcnM9e30sT2JqZWN0LmtleXMoZmUoe30sdC5EZWZhdWx0cy5tb2RpZmllcnMsci5tb2RpZmllcnMpKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2kub3B0aW9ucy5tb2RpZmllcnNbZV09ZmUoe30sdC5EZWZhdWx0cy5tb2RpZmllcnNbZV18fHt9LHIubW9kaWZpZXJzP3IubW9kaWZpZXJzW2VdOnt9KX0pLHRoaXMubW9kaWZpZXJzPU9iamVjdC5rZXlzKHRoaXMub3B0aW9ucy5tb2RpZmllcnMpLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gZmUoe25hbWU6ZX0saS5vcHRpb25zLm1vZGlmaWVyc1tlXSl9KS5zb3J0KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUub3JkZXItdC5vcmRlcn0pLHRoaXMubW9kaWZpZXJzLmZvckVhY2goZnVuY3Rpb24odCl7dC5lbmFibGVkJiZlKHQub25Mb2FkKSYmdC5vbkxvYWQoaS5yZWZlcmVuY2UsaS5wb3BwZXIsaS5vcHRpb25zLHQsaS5zdGF0ZSl9KSx0aGlzLnVwZGF0ZSgpO3ZhciBwPXRoaXMub3B0aW9ucy5ldmVudHNFbmFibGVkO3AmJnRoaXMuZW5hYmxlRXZlbnRMaXN0ZW5lcnMoKSx0aGlzLnN0YXRlLmV2ZW50c0VuYWJsZWQ9cH1yZXR1cm4gYWUodCxbe2tleTondXBkYXRlJyx2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBrLmNhbGwodGhpcyl9fSx7a2V5OidkZXN0cm95Jyx2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBILmNhbGwodGhpcyl9fSx7a2V5OidlbmFibGVFdmVudExpc3RlbmVycycsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gSS5jYWxsKHRoaXMpfX0se2tleTonZGlzYWJsZUV2ZW50TGlzdGVuZXJzJyx2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBVLmNhbGwodGhpcyl9fV0pLHR9KCk7cmV0dXJuIHVlLlV0aWxzPSgndW5kZWZpbmVkJz09dHlwZW9mIHdpbmRvdz9nbG9iYWw6d2luZG93KS5Qb3BwZXJVdGlscyx1ZS5wbGFjZW1lbnRzPWhlLHVlLkRlZmF1bHRzPXtwbGFjZW1lbnQ6J2JvdHRvbScscG9zaXRpb25GaXhlZDohMSxldmVudHNFbmFibGVkOiEwLHJlbW92ZU9uRGVzdHJveTohMSxvbkNyZWF0ZTpmdW5jdGlvbigpe30sb25VcGRhdGU6ZnVuY3Rpb24oKXt9LG1vZGlmaWVyczp7c2hpZnQ6e29yZGVyOjEwMCxlbmFibGVkOiEwLGZuOmZ1bmN0aW9uKGUpe3ZhciB0PWUucGxhY2VtZW50LG89dC5zcGxpdCgnLScpWzBdLG49dC5zcGxpdCgnLScpWzFdO2lmKG4pe3ZhciBpPWUub2Zmc2V0cyxyPWkucmVmZXJlbmNlLHA9aS5wb3BwZXIscz0tMSE9PVsnYm90dG9tJywndG9wJ10uaW5kZXhPZihvKSxkPXM/J2xlZnQnOid0b3AnLGE9cz8nd2lkdGgnOidoZWlnaHQnLGw9e3N0YXJ0OmxlKHt9LGQscltkXSksZW5kOmxlKHt9LGQscltkXStyW2FdLXBbYV0pfTtlLm9mZnNldHMucG9wcGVyPWZlKHt9LHAsbFtuXSl9cmV0dXJuIGV9fSxvZmZzZXQ6e29yZGVyOjIwMCxlbmFibGVkOiEwLGZuOkosb2Zmc2V0OjB9LHByZXZlbnRPdmVyZmxvdzp7b3JkZXI6MzAwLGVuYWJsZWQ6ITAsZm46ZnVuY3Rpb24oZSx0KXt2YXIgbz10LmJvdW5kYXJpZXNFbGVtZW50fHxwKGUuaW5zdGFuY2UucG9wcGVyKTtlLmluc3RhbmNlLnJlZmVyZW5jZT09PW8mJihvPXAobykpO3ZhciBuPUIoJ3RyYW5zZm9ybScpLGk9ZS5pbnN0YW5jZS5wb3BwZXIuc3R5bGUscj1pLnRvcCxzPWkubGVmdCxkPWlbbl07aS50b3A9JycsaS5sZWZ0PScnLGlbbl09Jyc7dmFyIGE9dihlLmluc3RhbmNlLnBvcHBlcixlLmluc3RhbmNlLnJlZmVyZW5jZSx0LnBhZGRpbmcsbyxlLnBvc2l0aW9uRml4ZWQpO2kudG9wPXIsaS5sZWZ0PXMsaVtuXT1kLHQuYm91bmRhcmllcz1hO3ZhciBsPXQucHJpb3JpdHksZj1lLm9mZnNldHMucG9wcGVyLG09e3ByaW1hcnk6ZnVuY3Rpb24oZSl7dmFyIG89ZltlXTtyZXR1cm4gZltlXTxhW2VdJiYhdC5lc2NhcGVXaXRoUmVmZXJlbmNlJiYobz1lZShmW2VdLGFbZV0pKSxsZSh7fSxlLG8pfSxzZWNvbmRhcnk6ZnVuY3Rpb24oZSl7dmFyIG89J3JpZ2h0Jz09PWU/J2xlZnQnOid0b3AnLG49ZltvXTtyZXR1cm4gZltlXT5hW2VdJiYhdC5lc2NhcGVXaXRoUmVmZXJlbmNlJiYobj1RKGZbb10sYVtlXS0oJ3JpZ2h0Jz09PWU/Zi53aWR0aDpmLmhlaWdodCkpKSxsZSh7fSxvLG4pfX07cmV0dXJuIGwuZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgdD0tMT09PVsnbGVmdCcsJ3RvcCddLmluZGV4T2YoZSk/J3NlY29uZGFyeSc6J3ByaW1hcnknO2Y9ZmUoe30sZixtW3RdKGUpKX0pLGUub2Zmc2V0cy5wb3BwZXI9ZixlfSxwcmlvcml0eTpbJ2xlZnQnLCdyaWdodCcsJ3RvcCcsJ2JvdHRvbSddLHBhZGRpbmc6NSxib3VuZGFyaWVzRWxlbWVudDonc2Nyb2xsUGFyZW50J30sa2VlcFRvZ2V0aGVyOntvcmRlcjo0MDAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbihlKXt2YXIgdD1lLm9mZnNldHMsbz10LnBvcHBlcixuPXQucmVmZXJlbmNlLGk9ZS5wbGFjZW1lbnQuc3BsaXQoJy0nKVswXSxyPVoscD0tMSE9PVsndG9wJywnYm90dG9tJ10uaW5kZXhPZihpKSxzPXA/J3JpZ2h0JzonYm90dG9tJyxkPXA/J2xlZnQnOid0b3AnLGE9cD8nd2lkdGgnOidoZWlnaHQnO3JldHVybiBvW3NdPHIobltkXSkmJihlLm9mZnNldHMucG9wcGVyW2RdPXIobltkXSktb1thXSksb1tkXT5yKG5bc10pJiYoZS5vZmZzZXRzLnBvcHBlcltkXT1yKG5bc10pKSxlfX0sYXJyb3c6e29yZGVyOjUwMCxlbmFibGVkOiEwLGZuOmZ1bmN0aW9uKGUsbyl7dmFyIG47aWYoIUsoZS5pbnN0YW5jZS5tb2RpZmllcnMsJ2Fycm93Jywna2VlcFRvZ2V0aGVyJykpcmV0dXJuIGU7dmFyIGk9by5lbGVtZW50O2lmKCdzdHJpbmcnPT10eXBlb2YgaSl7aWYoaT1lLmluc3RhbmNlLnBvcHBlci5xdWVyeVNlbGVjdG9yKGkpLCFpKXJldHVybiBlO31lbHNlIGlmKCFlLmluc3RhbmNlLnBvcHBlci5jb250YWlucyhpKSlyZXR1cm4gY29uc29sZS53YXJuKCdXQVJOSU5HOiBgYXJyb3cuZWxlbWVudGAgbXVzdCBiZSBjaGlsZCBvZiBpdHMgcG9wcGVyIGVsZW1lbnQhJyksZTt2YXIgcj1lLnBsYWNlbWVudC5zcGxpdCgnLScpWzBdLHA9ZS5vZmZzZXRzLHM9cC5wb3BwZXIsZD1wLnJlZmVyZW5jZSxhPS0xIT09WydsZWZ0JywncmlnaHQnXS5pbmRleE9mKHIpLGw9YT8naGVpZ2h0Jzond2lkdGgnLGY9YT8nVG9wJzonTGVmdCcsbT1mLnRvTG93ZXJDYXNlKCksaD1hPydsZWZ0JzondG9wJyxjPWE/J2JvdHRvbSc6J3JpZ2h0Jyx1PVMoaSlbbF07ZFtjXS11PHNbbV0mJihlLm9mZnNldHMucG9wcGVyW21dLT1zW21dLShkW2NdLXUpKSxkW21dK3U+c1tjXSYmKGUub2Zmc2V0cy5wb3BwZXJbbV0rPWRbbV0rdS1zW2NdKSxlLm9mZnNldHMucG9wcGVyPWcoZS5vZmZzZXRzLnBvcHBlcik7dmFyIGI9ZFttXStkW2xdLzItdS8yLHc9dChlLmluc3RhbmNlLnBvcHBlcikseT1wYXJzZUZsb2F0KHdbJ21hcmdpbicrZl0sMTApLEU9cGFyc2VGbG9hdCh3Wydib3JkZXInK2YrJ1dpZHRoJ10sMTApLHY9Yi1lLm9mZnNldHMucG9wcGVyW21dLXktRTtyZXR1cm4gdj1lZShRKHNbbF0tdSx2KSwwKSxlLmFycm93RWxlbWVudD1pLGUub2Zmc2V0cy5hcnJvdz0obj17fSxsZShuLG0sJCh2KSksbGUobixoLCcnKSxuKSxlfSxlbGVtZW50OidbeC1hcnJvd10nfSxmbGlwOntvcmRlcjo2MDAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbihlLHQpe2lmKFcoZS5pbnN0YW5jZS5tb2RpZmllcnMsJ2lubmVyJykpcmV0dXJuIGU7aWYoZS5mbGlwcGVkJiZlLnBsYWNlbWVudD09PWUub3JpZ2luYWxQbGFjZW1lbnQpcmV0dXJuIGU7dmFyIG89dihlLmluc3RhbmNlLnBvcHBlcixlLmluc3RhbmNlLnJlZmVyZW5jZSx0LnBhZGRpbmcsdC5ib3VuZGFyaWVzRWxlbWVudCxlLnBvc2l0aW9uRml4ZWQpLG49ZS5wbGFjZW1lbnQuc3BsaXQoJy0nKVswXSxpPVQobikscj1lLnBsYWNlbWVudC5zcGxpdCgnLScpWzFdfHwnJyxwPVtdO3N3aXRjaCh0LmJlaGF2aW9yKXtjYXNlIGdlLkZMSVA6cD1bbixpXTticmVhaztjYXNlIGdlLkNMT0NLV0lTRTpwPUcobik7YnJlYWs7Y2FzZSBnZS5DT1VOVEVSQ0xPQ0tXSVNFOnA9RyhuLCEwKTticmVhaztkZWZhdWx0OnA9dC5iZWhhdmlvcjt9cmV0dXJuIHAuZm9yRWFjaChmdW5jdGlvbihzLGQpe2lmKG4hPT1zfHxwLmxlbmd0aD09PWQrMSlyZXR1cm4gZTtuPWUucGxhY2VtZW50LnNwbGl0KCctJylbMF0saT1UKG4pO3ZhciBhPWUub2Zmc2V0cy5wb3BwZXIsbD1lLm9mZnNldHMucmVmZXJlbmNlLGY9WixtPSdsZWZ0Jz09PW4mJmYoYS5yaWdodCk+ZihsLmxlZnQpfHwncmlnaHQnPT09biYmZihhLmxlZnQpPGYobC5yaWdodCl8fCd0b3AnPT09biYmZihhLmJvdHRvbSk+ZihsLnRvcCl8fCdib3R0b20nPT09biYmZihhLnRvcCk8ZihsLmJvdHRvbSksaD1mKGEubGVmdCk8ZihvLmxlZnQpLGM9ZihhLnJpZ2h0KT5mKG8ucmlnaHQpLGc9ZihhLnRvcCk8ZihvLnRvcCksdT1mKGEuYm90dG9tKT5mKG8uYm90dG9tKSxiPSdsZWZ0Jz09PW4mJmh8fCdyaWdodCc9PT1uJiZjfHwndG9wJz09PW4mJmd8fCdib3R0b20nPT09biYmdSx3PS0xIT09Wyd0b3AnLCdib3R0b20nXS5pbmRleE9mKG4pLHk9ISF0LmZsaXBWYXJpYXRpb25zJiYodyYmJ3N0YXJ0Jz09PXImJmh8fHcmJidlbmQnPT09ciYmY3x8IXcmJidzdGFydCc9PT1yJiZnfHwhdyYmJ2VuZCc9PT1yJiZ1KSxFPSEhdC5mbGlwVmFyaWF0aW9uc0J5Q29udGVudCYmKHcmJidzdGFydCc9PT1yJiZjfHx3JiYnZW5kJz09PXImJmh8fCF3JiYnc3RhcnQnPT09ciYmdXx8IXcmJidlbmQnPT09ciYmZyksdj15fHxFOyhtfHxifHx2KSYmKGUuZmxpcHBlZD0hMCwobXx8YikmJihuPXBbZCsxXSksdiYmKHI9eihyKSksZS5wbGFjZW1lbnQ9bisocj8nLScrcjonJyksZS5vZmZzZXRzLnBvcHBlcj1mZSh7fSxlLm9mZnNldHMucG9wcGVyLEMoZS5pbnN0YW5jZS5wb3BwZXIsZS5vZmZzZXRzLnJlZmVyZW5jZSxlLnBsYWNlbWVudCkpLGU9UChlLmluc3RhbmNlLm1vZGlmaWVycyxlLCdmbGlwJykpfSksZX0sYmVoYXZpb3I6J2ZsaXAnLHBhZGRpbmc6NSxib3VuZGFyaWVzRWxlbWVudDondmlld3BvcnQnLGZsaXBWYXJpYXRpb25zOiExLGZsaXBWYXJpYXRpb25zQnlDb250ZW50OiExfSxpbm5lcjp7b3JkZXI6NzAwLGVuYWJsZWQ6ITEsZm46ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wbGFjZW1lbnQsbz10LnNwbGl0KCctJylbMF0sbj1lLm9mZnNldHMsaT1uLnBvcHBlcixyPW4ucmVmZXJlbmNlLHA9LTEhPT1bJ2xlZnQnLCdyaWdodCddLmluZGV4T2Yobykscz0tMT09PVsndG9wJywnbGVmdCddLmluZGV4T2Yobyk7cmV0dXJuIGlbcD8nbGVmdCc6J3RvcCddPXJbb10tKHM/aVtwPyd3aWR0aCc6J2hlaWdodCddOjApLGUucGxhY2VtZW50PVQodCksZS5vZmZzZXRzLnBvcHBlcj1nKGkpLGV9fSxoaWRlOntvcmRlcjo4MDAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbihlKXtpZighSyhlLmluc3RhbmNlLm1vZGlmaWVycywnaGlkZScsJ3ByZXZlbnRPdmVyZmxvdycpKXJldHVybiBlO3ZhciB0PWUub2Zmc2V0cy5yZWZlcmVuY2Usbz1EKGUuaW5zdGFuY2UubW9kaWZpZXJzLGZ1bmN0aW9uKGUpe3JldHVybidwcmV2ZW50T3ZlcmZsb3cnPT09ZS5uYW1lfSkuYm91bmRhcmllcztpZih0LmJvdHRvbTxvLnRvcHx8dC5sZWZ0Pm8ucmlnaHR8fHQudG9wPm8uYm90dG9tfHx0LnJpZ2h0PG8ubGVmdCl7aWYoITA9PT1lLmhpZGUpcmV0dXJuIGU7ZS5oaWRlPSEwLGUuYXR0cmlidXRlc1sneC1vdXQtb2YtYm91bmRhcmllcyddPScnfWVsc2V7aWYoITE9PT1lLmhpZGUpcmV0dXJuIGU7ZS5oaWRlPSExLGUuYXR0cmlidXRlc1sneC1vdXQtb2YtYm91bmRhcmllcyddPSExfXJldHVybiBlfX0sY29tcHV0ZVN0eWxlOntvcmRlcjo4NTAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbihlLHQpe3ZhciBvPXQueCxuPXQueSxpPWUub2Zmc2V0cy5wb3BwZXIscj1EKGUuaW5zdGFuY2UubW9kaWZpZXJzLGZ1bmN0aW9uKGUpe3JldHVybidhcHBseVN0eWxlJz09PWUubmFtZX0pLmdwdUFjY2VsZXJhdGlvbjt2b2lkIDAhPT1yJiZjb25zb2xlLndhcm4oJ1dBUk5JTkc6IGBncHVBY2NlbGVyYXRpb25gIG9wdGlvbiBtb3ZlZCB0byBgY29tcHV0ZVN0eWxlYCBtb2RpZmllciBhbmQgd2lsbCBub3QgYmUgc3VwcG9ydGVkIGluIGZ1dHVyZSB2ZXJzaW9ucyBvZiBQb3BwZXIuanMhJyk7dmFyIHMsZCxhPXZvaWQgMD09PXI/dC5ncHVBY2NlbGVyYXRpb246cixsPXAoZS5pbnN0YW5jZS5wb3BwZXIpLGY9dShsKSxtPXtwb3NpdGlvbjppLnBvc2l0aW9ufSxoPXEoZSwyPndpbmRvdy5kZXZpY2VQaXhlbFJhdGlvfHwhbWUpLGM9J2JvdHRvbSc9PT1vPyd0b3AnOidib3R0b20nLGc9J3JpZ2h0Jz09PW4/J2xlZnQnOidyaWdodCcsYj1CKCd0cmFuc2Zvcm0nKTtpZihkPSdib3R0b20nPT1jPydIVE1MJz09PWwubm9kZU5hbWU/LWwuY2xpZW50SGVpZ2h0K2guYm90dG9tOi1mLmhlaWdodCtoLmJvdHRvbTpoLnRvcCxzPSdyaWdodCc9PWc/J0hUTUwnPT09bC5ub2RlTmFtZT8tbC5jbGllbnRXaWR0aCtoLnJpZ2h0Oi1mLndpZHRoK2gucmlnaHQ6aC5sZWZ0LGEmJmIpbVtiXT0ndHJhbnNsYXRlM2QoJytzKydweCwgJytkKydweCwgMCknLG1bY109MCxtW2ddPTAsbS53aWxsQ2hhbmdlPSd0cmFuc2Zvcm0nO2Vsc2V7dmFyIHc9J2JvdHRvbSc9PWM/LTE6MSx5PSdyaWdodCc9PWc/LTE6MTttW2NdPWQqdyxtW2ddPXMqeSxtLndpbGxDaGFuZ2U9YysnLCAnK2d9dmFyIEU9eyJ4LXBsYWNlbWVudCI6ZS5wbGFjZW1lbnR9O3JldHVybiBlLmF0dHJpYnV0ZXM9ZmUoe30sRSxlLmF0dHJpYnV0ZXMpLGUuc3R5bGVzPWZlKHt9LG0sZS5zdHlsZXMpLGUuYXJyb3dTdHlsZXM9ZmUoe30sZS5vZmZzZXRzLmFycm93LGUuYXJyb3dTdHlsZXMpLGV9LGdwdUFjY2VsZXJhdGlvbjohMCx4Oidib3R0b20nLHk6J3JpZ2h0J30sYXBwbHlTdHlsZTp7b3JkZXI6OTAwLGVuYWJsZWQ6ITAsZm46ZnVuY3Rpb24oZSl7cmV0dXJuIFYoZS5pbnN0YW5jZS5wb3BwZXIsZS5zdHlsZXMpLGooZS5pbnN0YW5jZS5wb3BwZXIsZS5hdHRyaWJ1dGVzKSxlLmFycm93RWxlbWVudCYmT2JqZWN0LmtleXMoZS5hcnJvd1N0eWxlcykubGVuZ3RoJiZWKGUuYXJyb3dFbGVtZW50LGUuYXJyb3dTdHlsZXMpLGV9LG9uTG9hZDpmdW5jdGlvbihlLHQsbyxuLGkpe3ZhciByPUwoaSx0LGUsby5wb3NpdGlvbkZpeGVkKSxwPU8oby5wbGFjZW1lbnQscix0LGUsby5tb2RpZmllcnMuZmxpcC5ib3VuZGFyaWVzRWxlbWVudCxvLm1vZGlmaWVycy5mbGlwLnBhZGRpbmcpO3JldHVybiB0LnNldEF0dHJpYnV0ZSgneC1wbGFjZW1lbnQnLHApLFYodCx7cG9zaXRpb246by5wb3NpdGlvbkZpeGVkPydmaXhlZCc6J2Fic29sdXRlJ30pLG99LGdwdUFjY2VsZXJhdGlvbjp2b2lkIDB9fX0sdWV9KTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9cG9wcGVyLm1pbi5qcy5tYXAK"
                                },
                                {
                                    "id": "presentation/tippy.min.js",
                                    "source": "IWZ1bmN0aW9uKHQsZSl7Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzJiYidW5kZWZpbmVkIiE9dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz1lKHJlcXVpcmUoInBvcHBlci5qcyIpKToiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbInBvcHBlci5qcyJdLGUpOih0PXR8fHNlbGYpLnRpcHB5PWUodC5Qb3BwZXIpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt0PXQmJnQuaGFzT3duUHJvcGVydHkoImRlZmF1bHQiKT90LmRlZmF1bHQ6dDtmdW5jdGlvbiBlKCl7cmV0dXJuKGU9T2JqZWN0LmFzc2lnbnx8ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTE7ZTxhcmd1bWVudHMubGVuZ3RoO2UrKyl7dmFyIGE9YXJndW1lbnRzW2VdO2Zvcih2YXIgciBpbiBhKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhLHIpJiYodFtyXT1hW3JdKX1yZXR1cm4gdH0pLmFwcGx5KHRoaXMsYXJndW1lbnRzKX12YXIgYT0idW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmInVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudCxyPWE/bmF2aWdhdG9yLnVzZXJBZ2VudDoiIixuPS9NU0lFIHxUcmlkZW50XC8vLnRlc3QociksaT0vVUNCcm93c2VyXC8vLnRlc3Qociksbz1hJiYvaVBob25lfGlQYWR8aVBvZC8udGVzdChuYXZpZ2F0b3IucGxhdGZvcm0pJiYhd2luZG93Lk1TU3RyZWFtLHA9e2ExMXk6ITAsYWxsb3dIVE1MOiEwLGFuaW1hdGVGaWxsOiEwLGFuaW1hdGlvbjoic2hpZnQtYXdheSIsYXBwZW5kVG86ZnVuY3Rpb24oKXtyZXR1cm4gZG9jdW1lbnQuYm9keX0sYXJpYToiZGVzY3JpYmVkYnkiLGFycm93OiExLGFycm93VHlwZToic2hhcnAiLGJvdW5kYXJ5OiJzY3JvbGxQYXJlbnQiLGNvbnRlbnQ6IiIsZGVsYXk6MCxkaXN0YW5jZToxMCxkdXJhdGlvbjpbMzI1LDI3NV0sZmxpcDohMCxmbGlwQmVoYXZpb3I6ImZsaXAiLGZsaXBPblVwZGF0ZTohMSxmb2xsb3dDdXJzb3I6ITEsaGlkZU9uQ2xpY2s6ITAsaWdub3JlQXR0cmlidXRlczohMSxpbmVydGlhOiExLGludGVyYWN0aXZlOiExLGludGVyYWN0aXZlQm9yZGVyOjIsaW50ZXJhY3RpdmVEZWJvdW5jZTowLGxhenk6ITAsbWF4V2lkdGg6MzUwLG11bHRpcGxlOiExLG9mZnNldDowLG9uSGlkZGVuOmZ1bmN0aW9uKCl7fSxvbkhpZGU6ZnVuY3Rpb24oKXt9LG9uTW91bnQ6ZnVuY3Rpb24oKXt9LG9uU2hvdzpmdW5jdGlvbigpe30sb25TaG93bjpmdW5jdGlvbigpe30sb25UcmlnZ2VyOmZ1bmN0aW9uKCl7fSxwbGFjZW1lbnQ6InRvcCIscG9wcGVyT3B0aW9uczp7fSxyb2xlOiJ0b29sdGlwIixzaG93T25Jbml0OiExLHNpemU6InJlZ3VsYXIiLHN0aWNreTohMSx0YXJnZXQ6IiIsdGhlbWU6ImRhcmsiLHRvdWNoOiEwLHRvdWNoSG9sZDohMSx0cmlnZ2VyOiJtb3VzZWVudGVyIGZvY3VzIix0cmlnZ2VyVGFyZ2V0Om51bGwsdXBkYXRlRHVyYXRpb246MCx3YWl0Om51bGwsekluZGV4Ojk5OTl9LHM9WyJhcnJvdyIsImFycm93VHlwZSIsImJvdW5kYXJ5IiwiZGlzdGFuY2UiLCJmbGlwIiwiZmxpcEJlaGF2aW9yIiwiZmxpcE9uVXBkYXRlIiwib2Zmc2V0IiwicGxhY2VtZW50IiwicG9wcGVyT3B0aW9ucyJdLGM9YT9FbGVtZW50LnByb3RvdHlwZTp7fSxsPWMubWF0Y2hlc3x8Yy5tYXRjaGVzU2VsZWN0b3J8fGMud2Via2l0TWF0Y2hlc1NlbGVjdG9yfHxjLm1vek1hdGNoZXNTZWxlY3Rvcnx8Yy5tc01hdGNoZXNTZWxlY3RvcjtmdW5jdGlvbiBkKHQpe3JldHVybltdLnNsaWNlLmNhbGwodCl9ZnVuY3Rpb24gZih0LGUpe3JldHVybiBtKHQsZnVuY3Rpb24odCl7cmV0dXJuIGwuY2FsbCh0LGUpfSl9ZnVuY3Rpb24gbSh0LGUpe2Zvcig7dDspe2lmKGUodCkpcmV0dXJuIHQ7dD10LnBhcmVudEVsZW1lbnR9cmV0dXJuIG51bGx9dmFyIHU9e3Bhc3NpdmU6ITB9LGI9NCx5PSJ4LXBsYWNlbWVudCIsdj0ieC1vdXQtb2YtYm91bmRhcmllcyIsaD0idGlwcHktaU9TIix4PSJ0aXBweS1hY3RpdmUiLGc9InRpcHB5LXBvcHBlciIsdz0idGlwcHktdG9vbHRpcCIsaz0idGlwcHktY29udGVudCIsQT0idGlwcHktYmFja2Ryb3AiLEU9InRpcHB5LWFycm93IixYPSJ0aXBweS1yb3VuZGFycm93IixZPSIuIi5jb25jYXQoZyksQz0iLiIuY29uY2F0KHcpLEw9Ii4iLmNvbmNhdChrKSxUPSIuIi5jb25jYXQoQSksST0iLiIuY29uY2F0KEUpLFM9Ii4iLmNvbmNhdChYKSxPPSExO2Z1bmN0aW9uIHooKXtPfHwoTz0hMCxvJiZkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoaCksd2luZG93LnBlcmZvcm1hbmNlJiZkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLEgpKX12YXIgTT0wO2Z1bmN0aW9uIEgoKXt2YXIgdD1wZXJmb3JtYW5jZS5ub3coKTt0LU08MjAmJihPPSExLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsSCksb3x8ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKGgpKSxNPXR9ZnVuY3Rpb24gVigpe3ZhciB0PWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7dCYmdC5ibHVyJiZ0Ll90aXBweSYmdC5ibHVyKCl9dmFyIF89T2JqZWN0LmtleXMocCk7ZnVuY3Rpb24gTih0LGUpe3JldHVybnt9Lmhhc093blByb3BlcnR5LmNhbGwodCxlKX1mdW5jdGlvbiBQKHQsZSxhKXtpZihBcnJheS5pc0FycmF5KHQpKXt2YXIgcj10W2VdO3JldHVybiBudWxsPT1yP2E6cn1yZXR1cm4gdH1mdW5jdGlvbiBEKHQsZSl7cmV0dXJuIDA9PT1lP3Q6ZnVuY3Rpb24ocil7Y2xlYXJUaW1lb3V0KGEpLGE9c2V0VGltZW91dChmdW5jdGlvbigpe3Qocil9LGUpfTt2YXIgYX1mdW5jdGlvbiBxKHQsZSl7cmV0dXJuIHQmJnQubW9kaWZpZXJzJiZ0Lm1vZGlmaWVyc1tlXX1mdW5jdGlvbiBCKHQsZSl7cmV0dXJuIHQuaW5kZXhPZihlKT4tMX1mdW5jdGlvbiBGKHQpe3JldHVybiB0IGluc3RhbmNlb2YgRWxlbWVudH1mdW5jdGlvbiBqKHQpe3JldHVybiEoIXR8fCFOKHQsImlzVmlydHVhbCIpKXx8Rih0KX1mdW5jdGlvbiBVKHQsZSl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIHQ/dC5hcHBseShudWxsLGUpOnR9ZnVuY3Rpb24gVyh0LGUpe3QuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiJmbGlwIj09PXQubmFtZX0pWzBdLmVuYWJsZWQ9ZX1mdW5jdGlvbiBSKCl7cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpfWZ1bmN0aW9uIEoodCxlKXt0LmZvckVhY2goZnVuY3Rpb24odCl7dCYmKHQuc3R5bGUudHJhbnNpdGlvbkR1cmF0aW9uPSIiLmNvbmNhdChlLCJtcyIpKX0pfWZ1bmN0aW9uIEcodCxlKXt0LmZvckVhY2goZnVuY3Rpb24odCl7dCYmdC5zZXRBdHRyaWJ1dGUoImRhdGEtc3RhdGUiLGUpfSl9ZnVuY3Rpb24gSyh0LGEpe3ZhciByPWUoe30sYSx7Y29udGVudDpVKGEuY29udGVudCxbdF0pfSxhLmlnbm9yZUF0dHJpYnV0ZXM/e306ZnVuY3Rpb24odCl7cmV0dXJuIF8ucmVkdWNlKGZ1bmN0aW9uKGUsYSl7dmFyIHI9KHQuZ2V0QXR0cmlidXRlKCJkYXRhLXRpcHB5LSIuY29uY2F0KGEpKXx8IiIpLnRyaW0oKTtpZighcilyZXR1cm4gZTtpZigiY29udGVudCI9PT1hKWVbYV09cjtlbHNlIHRyeXtlW2FdPUpTT04ucGFyc2Uocil9Y2F0Y2godCl7ZVthXT1yfXJldHVybiBlfSx7fSl9KHQpKTtyZXR1cm4oci5hcnJvd3x8aSkmJihyLmFuaW1hdGVGaWxsPSExKSxyfWZ1bmN0aW9uIFEodCxlKXtPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2lmKCFOKGUsdCkpdGhyb3cgbmV3IEVycm9yKCJbdGlwcHldOiBgIi5jb25jYXQodCwiYCBpcyBub3QgYSB2YWxpZCBvcHRpb24iKSl9KX1mdW5jdGlvbiBaKHQsZSl7dC5pbm5lckhUTUw9RihlKT9lLmlubmVySFRNTDplfWZ1bmN0aW9uICQodCxlKXtpZihGKGUuY29udGVudCkpWih0LCIiKSx0LmFwcGVuZENoaWxkKGUuY29udGVudCk7ZWxzZSBpZigiZnVuY3Rpb24iIT10eXBlb2YgZS5jb250ZW50KXt0W2UuYWxsb3dIVE1MPyJpbm5lckhUTUwiOiJ0ZXh0Q29udGVudCJdPWUuY29udGVudH19ZnVuY3Rpb24gdHQodCl7cmV0dXJue3Rvb2x0aXA6dC5xdWVyeVNlbGVjdG9yKEMpLGJhY2tkcm9wOnQucXVlcnlTZWxlY3RvcihUKSxjb250ZW50OnQucXVlcnlTZWxlY3RvcihMKSxhcnJvdzp0LnF1ZXJ5U2VsZWN0b3IoSSl8fHQucXVlcnlTZWxlY3RvcihTKX19ZnVuY3Rpb24gZXQodCl7dC5zZXRBdHRyaWJ1dGUoImRhdGEtaW5lcnRpYSIsIiIpfWZ1bmN0aW9uIGF0KHQpe3ZhciBlPVIoKTtyZXR1cm4icm91bmQiPT09dD8oZS5jbGFzc05hbWU9WCxaKGUsJzxzdmcgdmlld0JveD0iMCAwIDE4IDciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTAgN3MyLjAyMS0uMDE1IDUuMjUzLTQuMjE4QzYuNTg0IDEuMDUxIDcuNzk3LjAwNyA5IDBjMS4yMDMtLjAwNyAyLjQxNiAxLjAzNSAzLjc2MSAyLjc4MkMxNi4wMTIgNy4wMDUgMTggNyAxOCA3SDB6Ii8+PC9zdmc+JykpOmUuY2xhc3NOYW1lPUUsZX1mdW5jdGlvbiBydCgpe3ZhciB0PVIoKTtyZXR1cm4gdC5jbGFzc05hbWU9QSx0LnNldEF0dHJpYnV0ZSgiZGF0YS1zdGF0ZSIsImhpZGRlbiIpLHR9ZnVuY3Rpb24gbnQodCxlKXt0LnNldEF0dHJpYnV0ZSgidGFiaW5kZXgiLCItMSIpLGUuc2V0QXR0cmlidXRlKCJkYXRhLWludGVyYWN0aXZlIiwiIil9ZnVuY3Rpb24gaXQodCxlLGEpe3ZhciByPWkmJnZvaWQgMCE9PWRvY3VtZW50LmJvZHkuc3R5bGUud2Via2l0VHJhbnNpdGlvbj8id2Via2l0VHJhbnNpdGlvbkVuZCI6InRyYW5zaXRpb25lbmQiO3RbZSsiRXZlbnRMaXN0ZW5lciJdKHIsYSl9ZnVuY3Rpb24gb3QodCl7dmFyIGU9dC5nZXRBdHRyaWJ1dGUoeSk7cmV0dXJuIGU/ZS5zcGxpdCgiLSIpWzBdOiIifWZ1bmN0aW9uIHB0KHQsZSxhKXthLnNwbGl0KCIgIikuZm9yRWFjaChmdW5jdGlvbihhKXt0LmNsYXNzTGlzdFtlXShhKyItdGhlbWUiKX0pfWZ1bmN0aW9uIHN0KHQsZSl7dmFyIGE9UigpO2EuY2xhc3NOYW1lPWcsYS5pZD0idGlwcHktIi5jb25jYXQodCksYS5zdHlsZS56SW5kZXg9IiIrZS56SW5kZXgsYS5zdHlsZS5wb3NpdGlvbj0iYWJzb2x1dGUiLGEuc3R5bGUudG9wPSIwIixhLnN0eWxlLmxlZnQ9IjAiLGUucm9sZSYmYS5zZXRBdHRyaWJ1dGUoInJvbGUiLGUucm9sZSk7dmFyIHI9UigpO3IuY2xhc3NOYW1lPXcsci5zdHlsZS5tYXhXaWR0aD1lLm1heFdpZHRoKygibnVtYmVyIj09dHlwZW9mIGUubWF4V2lkdGg/InB4IjoiIiksci5zZXRBdHRyaWJ1dGUoImRhdGEtc2l6ZSIsZS5zaXplKSxyLnNldEF0dHJpYnV0ZSgiZGF0YS1hbmltYXRpb24iLGUuYW5pbWF0aW9uKSxyLnNldEF0dHJpYnV0ZSgiZGF0YS1zdGF0ZSIsImhpZGRlbiIpLHB0KHIsImFkZCIsZS50aGVtZSk7dmFyIG49UigpO3JldHVybiBuLmNsYXNzTmFtZT1rLG4uc2V0QXR0cmlidXRlKCJkYXRhLXN0YXRlIiwiaGlkZGVuIiksZS5pbnRlcmFjdGl2ZSYmbnQoYSxyKSxlLmFycm93JiZyLmFwcGVuZENoaWxkKGF0KGUuYXJyb3dUeXBlKSksZS5hbmltYXRlRmlsbCYmKHIuYXBwZW5kQ2hpbGQocnQoKSksci5zZXRBdHRyaWJ1dGUoImRhdGEtYW5pbWF0ZWZpbGwiLCIiKSksZS5pbmVydGlhJiZldChyKSwkKG4sZSksci5hcHBlbmRDaGlsZChuKSxhLmFwcGVuZENoaWxkKHIpLGF9ZnVuY3Rpb24gY3QodCxlLGEpe3ZhciByPXR0KHQpLG49ci50b29sdGlwLGk9ci5jb250ZW50LG89ci5iYWNrZHJvcCxwPXIuYXJyb3c7dC5zdHlsZS56SW5kZXg9IiIrYS56SW5kZXgsbi5zZXRBdHRyaWJ1dGUoImRhdGEtc2l6ZSIsYS5zaXplKSxuLnNldEF0dHJpYnV0ZSgiZGF0YS1hbmltYXRpb24iLGEuYW5pbWF0aW9uKSxuLnN0eWxlLm1heFdpZHRoPWEubWF4V2lkdGgrKCJudW1iZXIiPT10eXBlb2YgYS5tYXhXaWR0aD8icHgiOiIiKSxhLnJvbGU/dC5zZXRBdHRyaWJ1dGUoInJvbGUiLGEucm9sZSk6dC5yZW1vdmVBdHRyaWJ1dGUoInJvbGUiKSxlLmNvbnRlbnQhPT1hLmNvbnRlbnQmJiQoaSxhKSwhZS5hbmltYXRlRmlsbCYmYS5hbmltYXRlRmlsbD8obi5hcHBlbmRDaGlsZChydCgpKSxuLnNldEF0dHJpYnV0ZSgiZGF0YS1hbmltYXRlZmlsbCIsIiIpKTplLmFuaW1hdGVGaWxsJiYhYS5hbmltYXRlRmlsbCYmKG4ucmVtb3ZlQ2hpbGQobyksbi5yZW1vdmVBdHRyaWJ1dGUoImRhdGEtYW5pbWF0ZWZpbGwiKSksIWUuYXJyb3cmJmEuYXJyb3c/bi5hcHBlbmRDaGlsZChhdChhLmFycm93VHlwZSkpOmUuYXJyb3cmJiFhLmFycm93JiZuLnJlbW92ZUNoaWxkKHApLGUuYXJyb3cmJmEuYXJyb3cmJmUuYXJyb3dUeXBlIT09YS5hcnJvd1R5cGUmJm4ucmVwbGFjZUNoaWxkKGF0KGEuYXJyb3dUeXBlKSxwKSwhZS5pbnRlcmFjdGl2ZSYmYS5pbnRlcmFjdGl2ZT9udCh0LG4pOmUuaW50ZXJhY3RpdmUmJiFhLmludGVyYWN0aXZlJiZmdW5jdGlvbih0LGUpe3QucmVtb3ZlQXR0cmlidXRlKCJ0YWJpbmRleCIpLGUucmVtb3ZlQXR0cmlidXRlKCJkYXRhLWludGVyYWN0aXZlIil9KHQsbiksIWUuaW5lcnRpYSYmYS5pbmVydGlhP2V0KG4pOmUuaW5lcnRpYSYmIWEuaW5lcnRpYSYmZnVuY3Rpb24odCl7dC5yZW1vdmVBdHRyaWJ1dGUoImRhdGEtaW5lcnRpYSIpfShuKSxlLnRoZW1lIT09YS50aGVtZSYmKHB0KG4sInJlbW92ZSIsZS50aGVtZSkscHQobiwiYWRkIixhLnRoZW1lKSl9dmFyIGx0PTEsZHQ9W107ZnVuY3Rpb24gZnQoYSxyKXt2YXIgaSxvLGMsaCxnLHc9SyhhLHIpO2lmKCF3Lm11bHRpcGxlJiZhLl90aXBweSlyZXR1cm4gbnVsbDt2YXIgayxBLEUsWCxDLEw9ITEsVD0hMSxJPSExLFM9ITEsej1bXSxNPUQodnQsdy5pbnRlcmFjdGl2ZURlYm91bmNlKSxIPWx0KyssVj1zdChILHcpLF89dHQoViksaj17aWQ6SCxyZWZlcmVuY2U6YSxwb3BwZXI6Vixwb3BwZXJDaGlsZHJlbjpfLHBvcHBlckluc3RhbmNlOm51bGwscHJvcHM6dyxzdGF0ZTp7aXNFbmFibGVkOiEwLGlzVmlzaWJsZTohMSxpc0Rlc3Ryb3llZDohMSxpc01vdW50ZWQ6ITEsaXNTaG93bjohMX0sY2xlYXJEZWxheVRpbWVvdXRzOkx0LHNldDpUdCxzZXRDb250ZW50OmZ1bmN0aW9uKHQpe1R0KHtjb250ZW50OnR9KX0sc2hvdzpJdCxoaWRlOlN0LGVuYWJsZTpmdW5jdGlvbigpe2ouc3RhdGUuaXNFbmFibGVkPSEwfSxkaXNhYmxlOmZ1bmN0aW9uKCl7ai5zdGF0ZS5pc0VuYWJsZWQ9ITF9LGRlc3Ryb3k6ZnVuY3Rpb24odCl7aWYoai5zdGF0ZS5pc0Rlc3Ryb3llZClyZXR1cm47VD0hMCxqLnN0YXRlLmlzTW91bnRlZCYmU3QoMCk7dXQoKSxkZWxldGUgYS5fdGlwcHk7dmFyIGU9ai5wcm9wcy50YXJnZXQ7ZSYmdCYmRihhKSYmZChhLnF1ZXJ5U2VsZWN0b3JBbGwoZSkpLmZvckVhY2goZnVuY3Rpb24odCl7dC5fdGlwcHkmJnQuX3RpcHB5LmRlc3Ryb3koKX0pO2oucG9wcGVySW5zdGFuY2UmJmoucG9wcGVySW5zdGFuY2UuZGVzdHJveSgpO1Q9ITEsai5zdGF0ZS5pc0Rlc3Ryb3llZD0hMH19O3JldHVybiBhLl90aXBweT1qLFYuX3RpcHB5PWosbXQoKSx3Lmxhenl8fEV0KCksdy5zaG93T25Jbml0JiZYdCgpLCF3LmExMXl8fHcudGFyZ2V0fHwoIUYoQz0kKCkpfHxsLmNhbGwoQywiYVtocmVmXSxhcmVhW2hyZWZdLGJ1dHRvbixkZXRhaWxzLGlucHV0LHRleHRhcmVhLHNlbGVjdCxpZnJhbWUsW3RhYmluZGV4XSIpJiYhQy5oYXNBdHRyaWJ1dGUoImRpc2FibGVkIikpfHwkKCkuc2V0QXR0cmlidXRlKCJ0YWJpbmRleCIsIjAiKSxWLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZW50ZXIiLGZ1bmN0aW9uKHQpe2oucHJvcHMuaW50ZXJhY3RpdmUmJmouc3RhdGUuaXNWaXNpYmxlJiYibW91c2VlbnRlciI9PT1pJiZYdCh0LCEwKX0pLFYuYWRkRXZlbnRMaXN0ZW5lcigibW91c2VsZWF2ZSIsZnVuY3Rpb24oKXtqLnByb3BzLmludGVyYWN0aXZlJiYibW91c2VlbnRlciI9PT1pJiZkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLE0pfSksajtmdW5jdGlvbiBSKCl7ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIixidCl9ZnVuY3Rpb24gWigpe2RvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcigibW91c2VsZWF2ZSIsWXQpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsTSksZHQ9ZHQuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiB0IT09TX0pfWZ1bmN0aW9uICQoKXtyZXR1cm4gai5wcm9wcy50cmlnZ2VyVGFyZ2V0fHxhfWZ1bmN0aW9uIGV0KCl7ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLEN0LCEwKX1mdW5jdGlvbiBhdCgpe3JldHVybltqLnBvcHBlckNoaWxkcmVuLnRvb2x0aXAsai5wb3BwZXJDaGlsZHJlbi5iYWNrZHJvcCxqLnBvcHBlckNoaWxkcmVuLmNvbnRlbnRdfWZ1bmN0aW9uIHJ0KCl7dmFyIHQ9ai5wcm9wcy5mb2xsb3dDdXJzb3I7cmV0dXJuIHQmJiJmb2N1cyIhPT1pfHxPJiYiaW5pdGlhbCI9PT10fWZ1bmN0aW9uIG50KHQsZSl7dmFyIGE9ai5wb3BwZXJDaGlsZHJlbi50b29sdGlwO2Z1bmN0aW9uIHIodCl7dC50YXJnZXQ9PT1hJiYoaXQoYSwicmVtb3ZlIixyKSxlKCkpfWlmKDA9PT10KXJldHVybiBlKCk7aXQoYSwicmVtb3ZlIixFKSxpdChhLCJhZGQiLHIpLEU9cn1mdW5jdGlvbiBwdCh0LGUpe3ZhciBhPWFyZ3VtZW50cy5sZW5ndGg+MiYmdm9pZCAwIT09YXJndW1lbnRzWzJdJiZhcmd1bWVudHNbMl07JCgpLmFkZEV2ZW50TGlzdGVuZXIodCxlLGEpLHoucHVzaCh7ZXZlbnRUeXBlOnQsaGFuZGxlcjplLG9wdGlvbnM6YX0pfWZ1bmN0aW9uIG10KCl7ai5wcm9wcy50b3VjaEhvbGQmJiFqLnByb3BzLnRhcmdldCYmKHB0KCJ0b3VjaHN0YXJ0Iix5dCx1KSxwdCgidG91Y2hlbmQiLGh0LHUpKSxqLnByb3BzLnRyaWdnZXIudHJpbSgpLnNwbGl0KCIgIikuZm9yRWFjaChmdW5jdGlvbih0KXtpZigibWFudWFsIiE9PXQpaWYoai5wcm9wcy50YXJnZXQpc3dpdGNoKHQpe2Nhc2UibW91c2VlbnRlciI6cHQoIm1vdXNlb3ZlciIsZ3QpLHB0KCJtb3VzZW91dCIsd3QpO2JyZWFrO2Nhc2UiZm9jdXMiOnB0KCJmb2N1c2luIixndCkscHQoImZvY3Vzb3V0Iix3dCk7YnJlYWs7Y2FzZSJjbGljayI6cHQodCxndCl9ZWxzZSBzd2l0Y2gocHQodCx5dCksdCl7Y2FzZSJtb3VzZWVudGVyIjpwdCgibW91c2VsZWF2ZSIsaHQpO2JyZWFrO2Nhc2UiZm9jdXMiOnB0KG4/ImZvY3Vzb3V0IjoiYmx1ciIseHQpfX0pfWZ1bmN0aW9uIHV0KCl7ei5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBlPXQuZXZlbnRUeXBlLGE9dC5oYW5kbGVyLHI9dC5vcHRpb25zOyQoKS5yZW1vdmVFdmVudExpc3RlbmVyKGUsYSxyKX0pLHo9W119ZnVuY3Rpb24gYnQodCl7dmFyIHI9bz10LG49ci5jbGllbnRYLGk9ci5jbGllbnRZO2lmKFgpe3ZhciBwPW0odC50YXJnZXQsZnVuY3Rpb24odCl7cmV0dXJuIHQ9PT1hfSkscz1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGM9ai5wcm9wcy5mb2xsb3dDdXJzb3IsbD0iaG9yaXpvbnRhbCI9PT1jLGQ9InZlcnRpY2FsIj09PWMsZj1CKFsidG9wIiwiYm90dG9tIl0sb3QoVikpLHU9Vi5nZXRBdHRyaWJ1dGUoeSksYj0hIXUmJiEhdS5zcGxpdCgiLSIpWzFdLHY9Zj9WLm9mZnNldFdpZHRoOlYub2Zmc2V0SGVpZ2h0LGg9di8yLHg9Zj8wOmI/djpoLGc9Zj9iP3Y6aDowOyFwJiZqLnByb3BzLmludGVyYWN0aXZlfHwoai5wb3BwZXJJbnN0YW5jZS5yZWZlcmVuY2U9ZSh7fSxqLnBvcHBlckluc3RhbmNlLnJlZmVyZW5jZSx7Y2xpZW50V2lkdGg6MCxjbGllbnRIZWlnaHQ6MCxnZXRCb3VuZGluZ0NsaWVudFJlY3Q6ZnVuY3Rpb24oKXtyZXR1cm57d2lkdGg6Zj92OjAsaGVpZ2h0OmY/MDp2LHRvcDoobD9zLnRvcDppKS14LGJvdHRvbToobD9zLmJvdHRvbTppKSt4LGxlZnQ6KGQ/cy5sZWZ0Om4pLWcscmlnaHQ6KGQ/cy5yaWdodDpuKStnfX19KSxqLnBvcHBlckluc3RhbmNlLnVwZGF0ZSgpKSwiaW5pdGlhbCI9PT1jJiZqLnN0YXRlLmlzVmlzaWJsZSYmUigpfX1mdW5jdGlvbiB5dCh0KXtqLnN0YXRlLmlzRW5hYmxlZCYmIWt0KHQpJiYoai5zdGF0ZS5pc1Zpc2libGV8fChpPXQudHlwZSx0IGluc3RhbmNlb2YgTW91c2VFdmVudCYmKG89dCxkdC5mb3JFYWNoKGZ1bmN0aW9uKGUpe3JldHVybiBlKHQpfSkpKSwiY2xpY2siPT09dC50eXBlJiYhMSE9PWoucHJvcHMuaGlkZU9uQ2xpY2smJmouc3RhdGUuaXNWaXNpYmxlP1l0KCk6WHQodCkpfWZ1bmN0aW9uIHZ0KHQpe3ZhciBlPWYodC50YXJnZXQsWSk9PT1WLHI9bSh0LnRhcmdldCxmdW5jdGlvbih0KXtyZXR1cm4gdD09PWF9KTtlfHxyfHxmdW5jdGlvbih0LGUsYSxyKXtpZighdClyZXR1cm4hMDt2YXIgbj1hLmNsaWVudFgsaT1hLmNsaWVudFksbz1yLmludGVyYWN0aXZlQm9yZGVyLHA9ci5kaXN0YW5jZSxzPWUudG9wLWk+KCJ0b3AiPT09dD9vK3A6byksYz1pLWUuYm90dG9tPigiYm90dG9tIj09PXQ/bytwOm8pLGw9ZS5sZWZ0LW4+KCJsZWZ0Ij09PXQ/bytwOm8pLGQ9bi1lLnJpZ2h0PigicmlnaHQiPT09dD9vK3A6byk7cmV0dXJuIHN8fGN8fGx8fGR9KG90KFYpLFYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksdCxqLnByb3BzKSYmKFooKSxZdCgpKX1mdW5jdGlvbiBodCh0KXtpZigha3QodCkpcmV0dXJuIGoucHJvcHMuaW50ZXJhY3RpdmU/KGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigibW91c2VsZWF2ZSIsWXQpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsTSksdm9pZCBkdC5wdXNoKE0pKTp2b2lkIFl0KCl9ZnVuY3Rpb24geHQodCl7dC50YXJnZXQ9PT0kKCkmJihqLnByb3BzLmludGVyYWN0aXZlJiZ0LnJlbGF0ZWRUYXJnZXQmJlYuY29udGFpbnModC5yZWxhdGVkVGFyZ2V0KXx8WXQoKSl9ZnVuY3Rpb24gZ3QodCl7Zih0LnRhcmdldCxqLnByb3BzLnRhcmdldCkmJlh0KHQpfWZ1bmN0aW9uIHd0KHQpe2YodC50YXJnZXQsai5wcm9wcy50YXJnZXQpJiZZdCgpfWZ1bmN0aW9uIGt0KHQpe3ZhciBlPSJvbnRvdWNoc3RhcnQiaW4gd2luZG93LGE9Qih0LnR5cGUsInRvdWNoIikscj1qLnByb3BzLnRvdWNoSG9sZDtyZXR1cm4gZSYmTyYmciYmIWF8fE8mJiFyJiZhfWZ1bmN0aW9uIEF0KCl7IVMmJkEmJihTPSEwLGZ1bmN0aW9uKHQpe3Qub2Zmc2V0SGVpZ2h0fShWKSxBKCkpfWZ1bmN0aW9uIEV0KCl7dmFyIHI9ai5wcm9wcy5wb3BwZXJPcHRpb25zLG49ai5wb3BwZXJDaGlsZHJlbixpPW4udG9vbHRpcCxvPW4uYXJyb3cscD1xKHIsInByZXZlbnRPdmVyZmxvdyIpO2Z1bmN0aW9uIHModCl7ai5wcm9wcy5mbGlwJiYhai5wcm9wcy5mbGlwT25VcGRhdGUmJih0LmZsaXBwZWQmJihqLnBvcHBlckluc3RhbmNlLm9wdGlvbnMucGxhY2VtZW50PXQucGxhY2VtZW50KSxXKGoucG9wcGVySW5zdGFuY2UubW9kaWZpZXJzLCExKSksaS5zZXRBdHRyaWJ1dGUoeSx0LnBsYWNlbWVudCksITEhPT10LmF0dHJpYnV0ZXNbdl0/aS5zZXRBdHRyaWJ1dGUodiwiIik6aS5yZW1vdmVBdHRyaWJ1dGUodiksayYmayE9PXQucGxhY2VtZW50JiZJJiYoaS5zdHlsZS50cmFuc2l0aW9uPSJub25lIixyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXtpLnN0eWxlLnRyYW5zaXRpb249IiJ9KSksaz10LnBsYWNlbWVudCxJPWouc3RhdGUuaXNWaXNpYmxlO3ZhciBhPW90KFYpLHI9aS5zdHlsZTtyLnRvcD1yLmJvdHRvbT1yLmxlZnQ9ci5yaWdodD0iIixyW2FdPS0oai5wcm9wcy5kaXN0YW5jZS0xMCkrInB4Ijt2YXIgbj1wJiZ2b2lkIDAhPT1wLnBhZGRpbmc/cC5wYWRkaW5nOmIsbz0ibnVtYmVyIj09dHlwZW9mIG4scz1lKHt0b3A6bz9uOm4udG9wLGJvdHRvbTpvP246bi5ib3R0b20sbGVmdDpvP246bi5sZWZ0LHJpZ2h0Om8/bjpuLnJpZ2h0fSwhbyYmbik7c1thXT1vP24rai5wcm9wcy5kaXN0YW5jZTooblthXXx8MCkrai5wcm9wcy5kaXN0YW5jZSxqLnBvcHBlckluc3RhbmNlLm1vZGlmaWVycy5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuInByZXZlbnRPdmVyZmxvdyI9PT10Lm5hbWV9KVswXS5wYWRkaW5nPXMsWD1zfXZhciBjPWUoe2V2ZW50c0VuYWJsZWQ6ITEscGxhY2VtZW50OmoucHJvcHMucGxhY2VtZW50fSxyLHttb2RpZmllcnM6ZSh7fSxyP3IubW9kaWZpZXJzOnt9LHtwcmV2ZW50T3ZlcmZsb3c6ZSh7Ym91bmRhcmllc0VsZW1lbnQ6ai5wcm9wcy5ib3VuZGFyeSxwYWRkaW5nOmJ9LHApLGFycm93OmUoe2VsZW1lbnQ6byxlbmFibGVkOiEhb30scShyLCJhcnJvdyIpKSxmbGlwOmUoe2VuYWJsZWQ6ai5wcm9wcy5mbGlwLHBhZGRpbmc6ai5wcm9wcy5kaXN0YW5jZStiLGJlaGF2aW9yOmoucHJvcHMuZmxpcEJlaGF2aW9yfSxxKHIsImZsaXAiKSksb2Zmc2V0OmUoe29mZnNldDpqLnByb3BzLm9mZnNldH0scShyLCJvZmZzZXQiKSl9KSxvbkNyZWF0ZTpmdW5jdGlvbih0KXtzKHQpLEF0KCksciYmci5vbkNyZWF0ZSYmci5vbkNyZWF0ZSh0KX0sb25VcGRhdGU6ZnVuY3Rpb24odCl7cyh0KSxBdCgpLHImJnIub25VcGRhdGUmJnIub25VcGRhdGUodCl9fSk7ai5wb3BwZXJJbnN0YW5jZT1uZXcgdChhLFYsYyl9ZnVuY3Rpb24gWHQodCxhKXtpZihMdCgpLCFqLnN0YXRlLmlzVmlzaWJsZSl7aWYoai5wcm9wcy50YXJnZXQpcmV0dXJuIGZ1bmN0aW9uKHQpe2lmKHQpe3ZhciBhPWYodC50YXJnZXQsai5wcm9wcy50YXJnZXQpO2EmJiFhLl90aXBweSYmZnQoYSxlKHt9LGoucHJvcHMse2NvbnRlbnQ6VShyLmNvbnRlbnQsW2FdKSxhcHBlbmRUbzpyLmFwcGVuZFRvLHRhcmdldDoiIixzaG93T25Jbml0OiEwfSkpfX0odCk7aWYoTD0hMCx0JiYhYSYmai5wcm9wcy5vblRyaWdnZXIoaix0KSxqLnByb3BzLndhaXQpcmV0dXJuIGoucHJvcHMud2FpdChqLHQpO3J0KCkmJiFqLnN0YXRlLmlzTW91bnRlZCYmKGoucG9wcGVySW5zdGFuY2V8fEV0KCksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIixidCkpLGV0KCk7dmFyIG49UChqLnByb3BzLmRlbGF5LDAscC5kZWxheSk7bj9jPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtJdCgpfSxuKTpJdCgpfX1mdW5jdGlvbiBZdCgpe2lmKEx0KCksIWouc3RhdGUuaXNWaXNpYmxlKXJldHVybiBSKCk7TD0hMTt2YXIgdD1QKGoucHJvcHMuZGVsYXksMSxwLmRlbGF5KTt0P2g9c2V0VGltZW91dChmdW5jdGlvbigpe2ouc3RhdGUuaXNWaXNpYmxlJiZTdCgpfSx0KTpnPXJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe1N0KCl9KX1mdW5jdGlvbiBDdCh0KXtpZighai5wcm9wcy5pbnRlcmFjdGl2ZXx8IVYuY29udGFpbnModC50YXJnZXQpKXtpZigkKCkuY29udGFpbnModC50YXJnZXQpKXtpZihPKXJldHVybjtpZihqLnN0YXRlLmlzVmlzaWJsZSYmQihqLnByb3BzLnRyaWdnZXIsImNsaWNrIikpcmV0dXJufSEwPT09ai5wcm9wcy5oaWRlT25DbGljayYmKEx0KCksU3QoKSl9fWZ1bmN0aW9uIEx0KCl7Y2xlYXJUaW1lb3V0KGMpLGNsZWFyVGltZW91dChoKSxjYW5jZWxBbmltYXRpb25GcmFtZShnKX1mdW5jdGlvbiBUdCh0KXtRKHQ9dHx8e30scCksdXQoKTt2YXIgcj1qLnByb3BzLG49SyhhLGUoe30sai5wcm9wcyx0LHtpZ25vcmVBdHRyaWJ1dGVzOiEwfSkpO24uaWdub3JlQXR0cmlidXRlcz1OKHQsImlnbm9yZUF0dHJpYnV0ZXMiKT90Lmlnbm9yZUF0dHJpYnV0ZXN8fCExOnIuaWdub3JlQXR0cmlidXRlcyxqLnByb3BzPW4sbXQoKSxaKCksTT1EKHZ0LG4uaW50ZXJhY3RpdmVEZWJvdW5jZSksY3QoVixyLG4pLGoucG9wcGVyQ2hpbGRyZW49dHQoViksai5wb3BwZXJJbnN0YW5jZSYmKHMuc29tZShmdW5jdGlvbihlKXtyZXR1cm4gTih0LGUpJiZ0W2VdIT09cltlXX0pPyhqLnBvcHBlckluc3RhbmNlLmRlc3Ryb3koKSxFdCgpLGouc3RhdGUuaXNWaXNpYmxlJiZqLnBvcHBlckluc3RhbmNlLmVuYWJsZUV2ZW50TGlzdGVuZXJzKCksai5wcm9wcy5mb2xsb3dDdXJzb3ImJm8mJmJ0KG8pKTpqLnBvcHBlckluc3RhbmNlLnVwZGF0ZSgpKX1mdW5jdGlvbiBJdCgpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTpQKGoucHJvcHMuZHVyYXRpb24sMCxwLmR1cmF0aW9uWzFdKTtpZighai5zdGF0ZS5pc0Rlc3Ryb3llZCYmai5zdGF0ZS5pc0VuYWJsZWQmJighT3x8ai5wcm9wcy50b3VjaCkmJiEkKCkuaGFzQXR0cmlidXRlKCJkaXNhYmxlZCIpJiYhMSE9PWoucHJvcHMub25TaG93KGopKXtldCgpLFYuc3R5bGUudmlzaWJpbGl0eT0idmlzaWJsZSIsai5zdGF0ZS5pc1Zpc2libGU9ITAsai5wcm9wcy5pbnRlcmFjdGl2ZSYmJCgpLmNsYXNzTGlzdC5hZGQoeCk7dmFyIGU9YXQoKTtKKGUuY29uY2F0KFYpLDApLEE9ZnVuY3Rpb24oKXtpZihqLnN0YXRlLmlzVmlzaWJsZSl7dmFyIGE9cnQoKTthJiZvP2J0KG8pOmF8fGoucG9wcGVySW5zdGFuY2UudXBkYXRlKCksai5wb3BwZXJDaGlsZHJlbi5iYWNrZHJvcCYmKGoucG9wcGVyQ2hpbGRyZW4uY29udGVudC5zdHlsZS50cmFuc2l0aW9uRGVsYXk9TWF0aC5yb3VuZCh0LzEyKSsibXMiKSxqLnByb3BzLnN0aWNreSYmKEooW1ZdLG4/MDpqLnByb3BzLnVwZGF0ZUR1cmF0aW9uKSxmdW5jdGlvbiB0KCl7ai5wb3BwZXJJbnN0YW5jZS5zY2hlZHVsZVVwZGF0ZSgpLGouc3RhdGUuaXNNb3VudGVkP3JlcXVlc3RBbmltYXRpb25GcmFtZSh0KTpKKFtWXSwwKX0oKSksSihbVl0sai5wcm9wcy51cGRhdGVEdXJhdGlvbiksSihlLHQpLEcoZSwidmlzaWJsZSIpLGZ1bmN0aW9uKHQsZSl7bnQodCxlKX0odCxmdW5jdGlvbigpe2oucHJvcHMuYXJpYSYmJCgpLnNldEF0dHJpYnV0ZSgiYXJpYS0iLmNvbmNhdChqLnByb3BzLmFyaWEpLFYuaWQpLGoucHJvcHMub25TaG93bihqKSxqLnN0YXRlLmlzU2hvd249ITB9KX19LGZ1bmN0aW9uKCl7Uz0hMTt2YXIgdD1ydCgpO2oucG9wcGVySW5zdGFuY2U/KFcoai5wb3BwZXJJbnN0YW5jZS5tb2RpZmllcnMsai5wcm9wcy5mbGlwKSx0fHwoai5wb3BwZXJJbnN0YW5jZS5yZWZlcmVuY2U9YSxqLnBvcHBlckluc3RhbmNlLmVuYWJsZUV2ZW50TGlzdGVuZXJzKCkpLGoucG9wcGVySW5zdGFuY2Uuc2NoZWR1bGVVcGRhdGUoKSk6KEV0KCksdHx8ai5wb3BwZXJJbnN0YW5jZS5lbmFibGVFdmVudExpc3RlbmVycygpKTt2YXIgZT1qLnByb3BzLmFwcGVuZFRvLHI9InBhcmVudCI9PT1lP2EucGFyZW50Tm9kZTpVKGUsW2FdKTtyLmNvbnRhaW5zKFYpfHwoci5hcHBlbmRDaGlsZChWKSxqLnByb3BzLm9uTW91bnQoaiksai5zdGF0ZS5pc01vdW50ZWQ9ITApfSgpfX1mdW5jdGlvbiBTdCgpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTpQKGoucHJvcHMuZHVyYXRpb24sMSxwLmR1cmF0aW9uWzFdKTtpZighai5zdGF0ZS5pc0Rlc3Ryb3llZCYmKGouc3RhdGUuaXNFbmFibGVkfHxUKSYmKCExIT09ai5wcm9wcy5vbkhpZGUoail8fFQpKXtkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJjbGljayIsQ3QsITApLFYuc3R5bGUudmlzaWJpbGl0eT0iaGlkZGVuIixqLnN0YXRlLmlzVmlzaWJsZT0hMSxqLnN0YXRlLmlzU2hvd249ITEsST0hMSxqLnByb3BzLmludGVyYWN0aXZlJiYkKCkuY2xhc3NMaXN0LnJlbW92ZSh4KTt2YXIgZT1hdCgpO0ooZSx0KSxHKGUsImhpZGRlbiIpLGZ1bmN0aW9uKHQsZSl7bnQodCxmdW5jdGlvbigpeyFqLnN0YXRlLmlzVmlzaWJsZSYmVi5wYXJlbnROb2RlJiZWLnBhcmVudE5vZGUuY29udGFpbnMoVikmJmUoKX0pfSh0LGZ1bmN0aW9uKCl7THx8UigpLGoucHJvcHMuYXJpYSYmJCgpLnJlbW92ZUF0dHJpYnV0ZSgiYXJpYS0iLmNvbmNhdChqLnByb3BzLmFyaWEpKSxqLnBvcHBlckluc3RhbmNlLmRpc2FibGVFdmVudExpc3RlbmVycygpLGoucG9wcGVySW5zdGFuY2Uub3B0aW9ucy5wbGFjZW1lbnQ9ai5wcm9wcy5wbGFjZW1lbnQsVi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKFYpLGoucHJvcHMub25IaWRkZW4oaiksai5zdGF0ZS5pc01vdW50ZWQ9ITF9KX19fXZhciBtdD0hMTtmdW5jdGlvbiB1dCh0LGEpe1EoYXx8e30scCksbXR8fChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaHN0YXJ0Iix6LHUpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJibHVyIixWKSxtdD0hMCk7dmFyIHIsbj1lKHt9LHAsYSk7cj10LCJbb2JqZWN0IE9iamVjdF0iIT09e30udG9TdHJpbmcuY2FsbChyKXx8ci5hZGRFdmVudExpc3RlbmVyfHxmdW5jdGlvbih0KXt2YXIgZT17aXNWaXJ0dWFsOiEwLGF0dHJpYnV0ZXM6dC5hdHRyaWJ1dGVzfHx7fSxjb250YWluczpmdW5jdGlvbigpe30sc2V0QXR0cmlidXRlOmZ1bmN0aW9uKGUsYSl7dC5hdHRyaWJ1dGVzW2VdPWF9LGdldEF0dHJpYnV0ZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5hdHRyaWJ1dGVzW2VdfSxyZW1vdmVBdHRyaWJ1dGU6ZnVuY3Rpb24oZSl7ZGVsZXRlIHQuYXR0cmlidXRlc1tlXX0saGFzQXR0cmlidXRlOmZ1bmN0aW9uKGUpe3JldHVybiBlIGluIHQuYXR0cmlidXRlc30sYWRkRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbigpe30scmVtb3ZlRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbigpe30sY2xhc3NMaXN0OntjbGFzc05hbWVzOnt9LGFkZDpmdW5jdGlvbihlKXt0LmNsYXNzTGlzdC5jbGFzc05hbWVzW2VdPSEwfSxyZW1vdmU6ZnVuY3Rpb24oZSl7ZGVsZXRlIHQuY2xhc3NMaXN0LmNsYXNzTmFtZXNbZV19LGNvbnRhaW5zOmZ1bmN0aW9uKGUpe3JldHVybiBlIGluIHQuY2xhc3NMaXN0LmNsYXNzTmFtZXN9fX07Zm9yKHZhciBhIGluIGUpdFthXT1lW2FdfSh0KTt2YXIgaT1mdW5jdGlvbih0KXtpZihqKHQpKXJldHVyblt0XTtpZih0IGluc3RhbmNlb2YgTm9kZUxpc3QpcmV0dXJuIGQodCk7aWYoQXJyYXkuaXNBcnJheSh0KSlyZXR1cm4gdDt0cnl7cmV0dXJuIGQoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0KSl9Y2F0Y2godCl7cmV0dXJuW119fSh0KS5yZWR1Y2UoZnVuY3Rpb24odCxlKXt2YXIgYT1lJiZmdChlLG4pO3JldHVybiBhJiZ0LnB1c2goYSksdH0sW10pO3JldHVybiBqKHQpP2lbMF06aX1yZXR1cm4gdXQudmVyc2lvbj0iNC4zLjQiLHV0LmRlZmF1bHRzPXAsdXQuc2V0RGVmYXVsdHM9ZnVuY3Rpb24odCl7T2JqZWN0LmtleXModCkuZm9yRWFjaChmdW5jdGlvbihlKXtwW2VdPXRbZV19KX0sdXQuaGlkZUFsbD1mdW5jdGlvbigpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTp7fSxlPXQuZXhjbHVkZSxhPXQuZHVyYXRpb247ZChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFkpKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciByLG49dC5fdGlwcHk7aWYobil7dmFyIGk9ITE7ZSYmKGk9KHI9ZSkuX3RpcHB5JiYhbC5jYWxsKHIsWSk/bi5yZWZlcmVuY2U9PT1lOnQ9PT1lLnBvcHBlciksaXx8bi5oaWRlKGEpfX0pfSx1dC5ncm91cD1mdW5jdGlvbih0KXt2YXIgYT1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06e30scj1hLmRlbGF5LG49dm9pZCAwPT09cj90WzBdLnByb3BzLmRlbGF5OnIsaT1hLmR1cmF0aW9uLG89dm9pZCAwPT09aT8wOmkscD0hMTtmdW5jdGlvbiBzKHQpe3A9dCxmKCl9ZnVuY3Rpb24gYyhlKXtlLl9vcmlnaW5hbFByb3BzLm9uU2hvdyhlKSx0LmZvckVhY2goZnVuY3Rpb24odCl7dC5zZXQoe2R1cmF0aW9uOm99KSx0LnN0YXRlLmlzVmlzaWJsZSYmdC5oaWRlKCl9KSxzKCEwKX1mdW5jdGlvbiBsKHQpe3QuX29yaWdpbmFsUHJvcHMub25IaWRlKHQpLHMoITEpfWZ1bmN0aW9uIGQodCl7dC5fb3JpZ2luYWxQcm9wcy5vblNob3duKHQpLHQuc2V0KHtkdXJhdGlvbjp0Ll9vcmlnaW5hbFByb3BzLmR1cmF0aW9ufSl9ZnVuY3Rpb24gZigpe3QuZm9yRWFjaChmdW5jdGlvbih0KXt0LnNldCh7b25TaG93OmMsb25TaG93bjpkLG9uSGlkZTpsLGRlbGF5OnA/WzAsQXJyYXkuaXNBcnJheShuKT9uWzFdOm5dOm4sZHVyYXRpb246cD9vOnQuX29yaWdpbmFsUHJvcHMuZHVyYXRpb259KX0pfXQuZm9yRWFjaChmdW5jdGlvbih0KXt0Ll9vcmlnaW5hbFByb3BzP3Quc2V0KHQuX29yaWdpbmFsUHJvcHMpOnQuX29yaWdpbmFsUHJvcHM9ZSh7fSx0LnByb3BzKX0pLGYoKX0sYSYmc2V0VGltZW91dChmdW5jdGlvbigpe2QoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiW2RhdGEtdGlwcHldIikpLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGU9dC5nZXRBdHRyaWJ1dGUoImRhdGEtdGlwcHkiKTtlJiZ1dCh0LHtjb250ZW50OmV9KX0pfSksZnVuY3Rpb24odCl7aWYoYSl7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3R5bGUiKTtlLnR5cGU9InRleHQvY3NzIixlLnRleHRDb250ZW50PXQsZS5zZXRBdHRyaWJ1dGUoImRhdGEtdGlwcHktc3R5bGVzaGVldCIsIiIpO3ZhciByPWRvY3VtZW50LmhlYWQsbj1yLmZpcnN0Q2hpbGQ7bj9yLmluc2VydEJlZm9yZShlLG4pOnIuYXBwZW5kQ2hpbGQoZSl9fSgnLnRpcHB5LWlPU3tjdXJzb3I6cG9pbnRlciFpbXBvcnRhbnQ7LXdlYmtpdC10YXAtaGlnaGxpZ2h0LWNvbG9yOnRyYW5zcGFyZW50fS50aXBweS1wb3BwZXJ7dHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKC4xNjUsLjg0LC40NCwxKTttYXgtd2lkdGg6Y2FsYygxMDAlIC0gOHB4KTtwb2ludGVyLWV2ZW50czpub25lO291dGxpbmU6MH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1iYWNrZHJvcHtib3JkZXItcmFkaXVzOjQwJSA0MCUgMCAwfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gLnRpcHB5LXJvdW5kYXJyb3d7Ym90dG9tOi03cHg7Ym90dG9tOi02LjVweDstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46NTAlIDA7dHJhbnNmb3JtLW9yaWdpbjo1MCUgMDttYXJnaW46MCAzcHh9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49dG9wXSAudGlwcHktcm91bmRhcnJvdyBzdmd7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgxODBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMTgwZGVnKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1hcnJvd3tib3JkZXItdG9wOjhweCBzb2xpZCAjMzMzO2JvcmRlci1yaWdodDo4cHggc29saWQgdHJhbnNwYXJlbnQ7Ym9yZGVyLWxlZnQ6OHB4IHNvbGlkIHRyYW5zcGFyZW50O2JvdHRvbTotN3B4O21hcmdpbjowIDNweDstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46NTAlIDA7dHJhbnNmb3JtLW9yaWdpbjo1MCUgMH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1iYWNrZHJvcHstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46MCAyNSU7dHJhbnNmb3JtLW9yaWdpbjowIDI1JX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1iYWNrZHJvcFtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgtNTAlLC01NSUpO3RyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNTUlKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1iYWNrZHJvcFtkYXRhLXN0YXRlPWhpZGRlbl17LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoLjIpIHRyYW5zbGF0ZSgtNTAlLC00NSUpO3RyYW5zZm9ybTpzY2FsZSguMikgdHJhbnNsYXRlKC01MCUsLTQ1JSk7b3BhY2l0eTowfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LXRvd2FyZF1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKC0xMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49dG9wXSBbZGF0YS1hbmltYXRpb249c2hpZnQtdG93YXJkXVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTIwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0yMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1wZXJzcGVjdGl2ZV17LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOmJvdHRvbTt0cmFuc2Zvcm0tb3JpZ2luOmJvdHRvbX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1wZXJzcGVjdGl2ZV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTpwZXJzcGVjdGl2ZSg3MDBweCkgdHJhbnNsYXRlWSgtMTBweCkgcm90YXRlWCgwKTt0cmFuc2Zvcm06cGVyc3BlY3RpdmUoNzAwcHgpIHRyYW5zbGF0ZVkoLTEwcHgpIHJvdGF0ZVgoMCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49dG9wXSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06cGVyc3BlY3RpdmUoNzAwcHgpIHRyYW5zbGF0ZVkoMCkgcm90YXRlWCg2MGRlZyk7dHJhbnNmb3JtOnBlcnNwZWN0aXZlKDcwMHB4KSB0cmFuc2xhdGVZKDApIHJvdGF0ZVgoNjBkZWcpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPWZhZGVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPWZhZGVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LWF3YXldW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LWF3YXldW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgwKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgwKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV17LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOmJvdHRvbTt0cmFuc2Zvcm0tb3JpZ2luOmJvdHRvbX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKC0xMHB4KSBzY2FsZSgxKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCkgc2NhbGUoMSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49dG9wXSBbZGF0YS1hbmltYXRpb249c2NhbGVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCkgc2NhbGUoLjUpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0xMHB4KSBzY2FsZSguNSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktYmFja2Ryb3B7Ym9yZGVyLXJhZGl1czowIDAgMzAlIDMwJX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1yb3VuZGFycm93e3RvcDotN3B4Oy13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjo1MCUgMTAwJTt0cmFuc2Zvcm0tb3JpZ2luOjUwJSAxMDAlO21hcmdpbjowIDNweH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1yb3VuZGFycm93IHN2Z3twb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDApO3RyYW5zZm9ybTpyb3RhdGUoMCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktYXJyb3d7Ym9yZGVyLWJvdHRvbTo4cHggc29saWQgIzMzMztib3JkZXItcmlnaHQ6OHB4IHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1sZWZ0OjhweCBzb2xpZCB0cmFuc3BhcmVudDt0b3A6LTdweDttYXJnaW46MCAzcHg7LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOjUwJSAxMDAlO3RyYW5zZm9ybS1vcmlnaW46NTAlIDEwMCV9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktYmFja2Ryb3B7LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOjAgLTUwJTt0cmFuc2Zvcm0tb3JpZ2luOjAgLTUwJX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1iYWNrZHJvcFtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgtNTAlLC00NSUpO3RyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNDUlKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1iYWNrZHJvcFtkYXRhLXN0YXRlPWhpZGRlbl17LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoLjIpIHRyYW5zbGF0ZSgtNTAlKTt0cmFuc2Zvcm06c2NhbGUoLjIpIHRyYW5zbGF0ZSgtNTAlKTtvcGFjaXR5OjB9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249c2hpZnQtdG93YXJkXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249c2hpZnQtdG93YXJkXVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMjBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMjBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdey13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjp0b3A7dHJhbnNmb3JtLW9yaWdpbjp0b3B9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06cGVyc3BlY3RpdmUoNzAwcHgpIHRyYW5zbGF0ZVkoMTBweCkgcm90YXRlWCgwKTt0cmFuc2Zvcm06cGVyc3BlY3RpdmUoNzAwcHgpIHRyYW5zbGF0ZVkoMTBweCkgcm90YXRlWCgwKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIFtkYXRhLWFuaW1hdGlvbj1wZXJzcGVjdGl2ZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTpwZXJzcGVjdGl2ZSg3MDBweCkgdHJhbnNsYXRlWSgwKSByb3RhdGVYKC02MGRlZyk7dHJhbnNmb3JtOnBlcnNwZWN0aXZlKDcwMHB4KSB0cmFuc2xhdGVZKDApIHJvdGF0ZVgoLTYwZGVnKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIFtkYXRhLWFuaW1hdGlvbj1mYWRlXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249ZmFkZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKDEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWJvdHRvbV0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LWF3YXldW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIFtkYXRhLWFuaW1hdGlvbj1zaGlmdC1hd2F5XVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249c2NhbGVdey13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjp0b3A7dHJhbnNmb3JtLW9yaWdpbjp0b3B9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249c2NhbGVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KSBzY2FsZSgxKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KSBzY2FsZSgxKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKDEwcHgpIHNjYWxlKC41KTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KSBzY2FsZSguNSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LWJhY2tkcm9we2JvcmRlci1yYWRpdXM6NTAlIDAgMCA1MCV9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LXJvdW5kYXJyb3d7cmlnaHQ6LTEycHg7LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOjMzLjMzMzMzMzMzJSA1MCU7dHJhbnNmb3JtLW9yaWdpbjozMy4zMzMzMzMzMyUgNTAlO21hcmdpbjozcHggMH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktcm91bmRhcnJvdyBzdmd7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSg5MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSg5MGRlZyl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LWFycm93e2JvcmRlci1sZWZ0OjhweCBzb2xpZCAjMzMzO2JvcmRlci10b3A6OHB4IHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1ib3R0b206OHB4IHNvbGlkIHRyYW5zcGFyZW50O3JpZ2h0Oi03cHg7bWFyZ2luOjNweCAwOy13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjowIDUwJTt0cmFuc2Zvcm0tb3JpZ2luOjAgNTAlfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIC50aXBweS1iYWNrZHJvcHstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46NTAlIDA7dHJhbnNmb3JtLW9yaWdpbjo1MCUgMH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktYmFja2Ryb3BbZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNTAlKTt0cmFuc2Zvcm06c2NhbGUoMSkgdHJhbnNsYXRlKC01MCUsLTUwJSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LWJhY2tkcm9wW2RhdGEtc3RhdGU9aGlkZGVuXXstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSguMikgdHJhbnNsYXRlKC03NSUsLTUwJSk7dHJhbnNmb3JtOnNjYWxlKC4yKSB0cmFuc2xhdGUoLTc1JSwtNTAlKTtvcGFjaXR5OjB9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LXRvd2FyZF1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LXRvd2FyZF1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKC0yMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtMjBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gW2RhdGEtYW5pbWF0aW9uPXBlcnNwZWN0aXZlXXstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46cmlnaHQ7dHJhbnNmb3JtLW9yaWdpbjpyaWdodH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06cGVyc3BlY3RpdmUoNzAwcHgpIHRyYW5zbGF0ZVgoLTEwcHgpIHJvdGF0ZVkoMCk7dHJhbnNmb3JtOnBlcnNwZWN0aXZlKDcwMHB4KSB0cmFuc2xhdGVYKC0xMHB4KSByb3RhdGVZKDApfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIFtkYXRhLWFuaW1hdGlvbj1wZXJzcGVjdGl2ZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTpwZXJzcGVjdGl2ZSg3MDBweCkgdHJhbnNsYXRlWCgwKSByb3RhdGVZKC02MGRlZyk7dHJhbnNmb3JtOnBlcnNwZWN0aXZlKDcwMHB4KSB0cmFuc2xhdGVYKDApIHJvdGF0ZVkoLTYwZGVnKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249ZmFkZV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gW2RhdGEtYW5pbWF0aW9uPWZhZGVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgtMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIFtkYXRhLWFuaW1hdGlvbj1zaGlmdC1hd2F5XVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249c2hpZnQtYXdheV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDApO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDApfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV17LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOnJpZ2h0O3RyYW5zZm9ybS1vcmlnaW46cmlnaHR9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gW2RhdGEtYW5pbWF0aW9uPXNjYWxlXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTEwcHgpIHNjYWxlKDEpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KSBzY2FsZSgxKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249c2NhbGVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgtMTBweCkgc2NhbGUoLjUpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KSBzY2FsZSguNSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1iYWNrZHJvcHtib3JkZXItcmFkaXVzOjAgNTAlIDUwJSAwfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSAudGlwcHktcm91bmRhcnJvd3tsZWZ0Oi0xMnB4Oy13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjo2Ni42NjY2NjY2NiUgNTAlO3RyYW5zZm9ybS1vcmlnaW46NjYuNjY2NjY2NjYlIDUwJTttYXJnaW46M3B4IDB9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1yb3VuZGFycm93IHN2Z3twb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKC05MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgtOTBkZWcpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSAudGlwcHktYXJyb3d7Ym9yZGVyLXJpZ2h0OjhweCBzb2xpZCAjMzMzO2JvcmRlci10b3A6OHB4IHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1ib3R0b206OHB4IHNvbGlkIHRyYW5zcGFyZW50O2xlZnQ6LTdweDttYXJnaW46M3B4IDA7LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOjEwMCUgNTAlO3RyYW5zZm9ybS1vcmlnaW46MTAwJSA1MCV9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1iYWNrZHJvcHstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46LTUwJSAwO3RyYW5zZm9ybS1vcmlnaW46LTUwJSAwfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSAudGlwcHktYmFja2Ryb3BbZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNTAlKTt0cmFuc2Zvcm06c2NhbGUoMSkgdHJhbnNsYXRlKC01MCUsLTUwJSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1iYWNrZHJvcFtkYXRhLXN0YXRlPWhpZGRlbl17LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoLjIpIHRyYW5zbGF0ZSgtMjUlLC01MCUpO3RyYW5zZm9ybTpzY2FsZSguMikgdHJhbnNsYXRlKC0yNSUsLTUwJSk7b3BhY2l0eTowfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249c2hpZnQtdG93YXJkXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIFtkYXRhLWFuaW1hdGlvbj1zaGlmdC10b3dhcmRdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgyMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgyMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gW2RhdGEtYW5pbWF0aW9uPXBlcnNwZWN0aXZlXXstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46bGVmdDt0cmFuc2Zvcm0tb3JpZ2luOmxlZnR9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIFtkYXRhLWFuaW1hdGlvbj1wZXJzcGVjdGl2ZV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTpwZXJzcGVjdGl2ZSg3MDBweCkgdHJhbnNsYXRlWCgxMHB4KSByb3RhdGVZKDApO3RyYW5zZm9ybTpwZXJzcGVjdGl2ZSg3MDBweCkgdHJhbnNsYXRlWCgxMHB4KSByb3RhdGVZKDApfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06cGVyc3BlY3RpdmUoNzAwcHgpIHRyYW5zbGF0ZVgoMCkgcm90YXRlWSg2MGRlZyk7dHJhbnNmb3JtOnBlcnNwZWN0aXZlKDcwMHB4KSB0cmFuc2xhdGVYKDApIHJvdGF0ZVkoNjBkZWcpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249ZmFkZV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249ZmFkZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249c2hpZnQtYXdheV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249c2hpZnQtYXdheV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDApO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDApfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249c2NhbGVdey13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjpsZWZ0O3RyYW5zZm9ybS1vcmlnaW46bGVmdH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gW2RhdGEtYW5pbWF0aW9uPXNjYWxlXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoMTBweCkgc2NhbGUoMSk7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoMTBweCkgc2NhbGUoMSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpIHNjYWxlKC41KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgxMHB4KSBzY2FsZSguNSl9LnRpcHB5LXRvb2x0aXB7cG9zaXRpb246cmVsYXRpdmU7Y29sb3I6I2ZmZjtib3JkZXItcmFkaXVzOi4yNXJlbTtmb250LXNpemU6Ljg3NXJlbTtwYWRkaW5nOi4zMTI1cmVtIC41NjI1cmVtO2xpbmUtaGVpZ2h0OjEuNDt0ZXh0LWFsaWduOmNlbnRlcjtiYWNrZ3JvdW5kLWNvbG9yOiMzMzN9LnRpcHB5LXRvb2x0aXBbZGF0YS1zaXplPXNtYWxsXXtwYWRkaW5nOi4xODc1cmVtIC4zNzVyZW07Zm9udC1zaXplOi43NXJlbX0udGlwcHktdG9vbHRpcFtkYXRhLXNpemU9bGFyZ2Vde3BhZGRpbmc6LjM3NXJlbSAuNzVyZW07Zm9udC1zaXplOjFyZW19LnRpcHB5LXRvb2x0aXBbZGF0YS1hbmltYXRlZmlsbF17b3ZlcmZsb3c6aGlkZGVuO2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnR9LnRpcHB5LXRvb2x0aXBbZGF0YS1pbnRlcmFjdGl2ZV0sLnRpcHB5LXRvb2x0aXBbZGF0YS1pbnRlcmFjdGl2ZV0gLnRpcHB5LXJvdW5kYXJyb3cgcGF0aHtwb2ludGVyLWV2ZW50czphdXRvfS50aXBweS10b29sdGlwW2RhdGEtaW5lcnRpYV1bZGF0YS1zdGF0ZT12aXNpYmxlXXt0cmFuc2l0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoLjU0LDEuNSwuMzgsMS4xMSl9LnRpcHB5LXRvb2x0aXBbZGF0YS1pbmVydGlhXVtkYXRhLXN0YXRlPWhpZGRlbl17dHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb246ZWFzZX0udGlwcHktYXJyb3csLnRpcHB5LXJvdW5kYXJyb3d7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MDtoZWlnaHQ6MH0udGlwcHktcm91bmRhcnJvd3t3aWR0aDoxOHB4O2hlaWdodDo3cHg7ZmlsbDojMzMzO3BvaW50ZXItZXZlbnRzOm5vbmV9LnRpcHB5LWJhY2tkcm9we3Bvc2l0aW9uOmFic29sdXRlO2JhY2tncm91bmQtY29sb3I6IzMzMztib3JkZXItcmFkaXVzOjUwJTt3aWR0aDpjYWxjKDExMCUgKyAycmVtKTtsZWZ0OjUwJTt0b3A6NTAlO3otaW5kZXg6LTE7dHJhbnNpdGlvbjphbGwgY3ViaWMtYmV6aWVyKC40NiwuMSwuNTIsLjk4KTstd2Via2l0LWJhY2tmYWNlLXZpc2liaWxpdHk6aGlkZGVuO2JhY2tmYWNlLXZpc2liaWxpdHk6aGlkZGVufS50aXBweS1iYWNrZHJvcDphZnRlcntjb250ZW50OiIiO2Zsb2F0OmxlZnQ7cGFkZGluZy10b3A6MTAwJX0udGlwcHktYmFja2Ryb3ArLnRpcHB5LWNvbnRlbnR7dHJhbnNpdGlvbi1wcm9wZXJ0eTpvcGFjaXR5O3dpbGwtY2hhbmdlOm9wYWNpdHl9LnRpcHB5LWJhY2tkcm9wKy50aXBweS1jb250ZW50W2RhdGEtc3RhdGU9dmlzaWJsZV17b3BhY2l0eToxfS50aXBweS1iYWNrZHJvcCsudGlwcHktY29udGVudFtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowfScpLHV0fSk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmFsbC5taW4uanMubWFwCg=="
                                },
                                {
                                    "id": "presentation/tippy-tooltip.js",
                                    "source": "Y2xhc3MgVGlwcHlUb29sdGlwIGV4dGVuZHMgUHJlc2VudGF0aW9uIHsNCiAgICBjb25zdHJ1Y3RvcihmdW5jdGlvbkluZm8sIHVzZXJJbnRlcmZhY2UsIGNvbmZpZ3VyYXRpb24pIHsNCiAgICAgICAgc3VwZXIoZnVuY3Rpb25JbmZvLCB1c2VySW50ZXJmYWNlLCBjb25maWd1cmF0aW9uKTsNCg0KICAgIH0NCg0KICAgIHJlbmRlclJlc3VsdChyZXF1ZXN0LCByZXN1bHQpIHsNCg0KICAgICAgICBsZXQgaW9SZXMgPSBpb1R5cGVVdGlscy50b0lPVHlwZUluc3RhbmNlKHJlc3VsdC5yZXN1bHQpOw0KICAgICAgICBsZXQgcmVzdWx0SFRNTCA9IGlvUmVzLnRvSHRtbCgpOw0KICAgICAgICBsZXQgcmVxdWVzdElEID0gdGhpcy5jcmVhdGVSZXF1ZXN0SWQoKTsNCg0KICAgICAgICBpZiAocmVxdWVzdC5pbnB1dFR5cGUgaW5zdGFuY2VvZiBXb3JkKSB7DQoNCg0KDQogICAgICAgICAgICAvL2xldCBjbGFzc05hbWUgPSAiZWFzeS1yZWFkaW5nLXRpcHB5LXRvb2x0aXAtIit0aGlzLnJlcXVlc3RDb3VudGVyOw0KICAgICAgICAgICAgLy9wYWdlVXRpbHMud3JhcFdvcmRJbihyZXF1ZXN0LmlucHV0LCAic3BhbiIsdGhpcy5jcmVhdGVSZXF1ZXN0SWQoKSwiZWFzeS1yZWFkaW5nLXJlc3VsdCBlYXN5LXJlYWRpbmctdGlwcHktdG9vbHRpcCAiK2NsYXNzTmFtZSk7DQoNCiAgICAgICAgICAgIGxldCBzcGFuID0gcGFnZVV0aWxzLndyYXBXb3JkSW4ocmVxdWVzdC5pbnB1dCwgInNwYW4iLCByZXF1ZXN0SUQrIiBlYXN5LXJlYWRpbmctdGlwcHktdG9vbHRpcCAiICsgdGhpcy5nZXRSZXN1bHRDbGFzcygpLCB0aGlzLmdldFByZXNlbnRhdGlvbkFuZFJlcXVlc3RJZGVudGlmaWVyKHJlcXVlc3RJRCkpOw0KDQogICAgICAgICAgICBpZiAoaW9SZXMgaW5zdGFuY2VvZiBJbWFnZUlPVHlwZSkgew0KICAgICAgICAgICAgICAgIGNvbnN0IElOSVRJQUxfQ09OVEVOVCA9ICdMb2FkaW5nLi4uJzsNCg0KICAgICAgICAgICAgICAgIGNvbnN0IHN0YXRlID0gew0KICAgICAgICAgICAgICAgICAgICBpc0ZldGNoaW5nOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgY2FuRmV0Y2g6IHRydWUNCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAgICAgdGlwcHkoIi4iICsgcmVxdWVzdElELCB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IElOSVRJQUxfQ09OVEVOVCwNCiAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdsaWdodC1ib3JkZXInLA0KICAgICAgICAgICAgICAgICAgICBhc3luYyBvblNob3codGlwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuaXNGZXRjaGluZyB8fCAhc3RhdGUuY2FuRmV0Y2gpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuaXNGZXRjaGluZyA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5jYW5GZXRjaCA9IGZhbHNlOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB0cnkgew0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZG93bmxvYWRpbmdJbWFnZSA9IG5ldyBJbWFnZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkaW5nSW1hZ2Uub25sb2FkID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGlwLnN0YXRlLmlzVmlzaWJsZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IDEwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpcC5zZXRDb250ZW50KHRoaXMpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkaW5nSW1hZ2Uuc3JjID0gcmVzdWx0LnJlc3VsdC51cmw7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXAuc2V0Q29udGVudChgRmV0Y2ggZmFpbGVkLiAke2V9YCkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuaXNGZXRjaGluZyA9IGZhbHNlDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIG9uSGlkZGVuKHRpcCkgew0KDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aXBweSgiLiIgKyByZXF1ZXN0SUQsIHsNCiAgICAgICAgICAgICAgICAgICAgY29udGVudDogcmVzdWx0SFRNTCwNCiAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdsaWdodC1ib3JkZXInLA0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0gZWxzZSBpZiAocmVxdWVzdC5pbnB1dFR5cGUgaW5zdGFuY2VvZiBQYXJhZ3JhcGgpIHsNCg0KICAgICAgICAgICAgbGV0IGRpdiA9ICQoIHJlcXVlc3QuaW5wdXQuZWxlbWVudCkud3JhcCggIjxkaXYgY2xhc3M9JyIrIHJlcXVlc3RJRCsiIGVhc3ktcmVhZGluZy10aXBweS10b29sdGlwICIrdGhpcy5nZXRSZXN1bHRDbGFzcygpKyInICIrdGhpcy5nZXRQcmVzZW50YXRpb25BbmRSZXF1ZXN0SWRlbnRpZmllcihyZXF1ZXN0SUQpKyI+PC9kaXY+IiApOw0KDQogICAgICAgICAgICB0aXBweSgiLiIgKyByZXF1ZXN0SUQsIHsNCiAgICAgICAgICAgICAgICBjb250ZW50OiByZXN1bHRIVE1MLA0KICAgICAgICAgICAgICAgIHRoZW1lOiAnbGlnaHQtYm9yZGVyJywNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgIH0NCg0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLnByZXNlbnRhdGlvbkZpbmlzaGVkKHRoaXMpOw0KDQogICAgfQ0KDQogICAgdW5kbygpIHsNCg0KICAgIH0NCiAgICByZW1vdmVSZXN1bHQocmVxdWVzdElEKXsNCg0KICAgICAgICBjb25zdCB0b29sdGlwRWxlbWVudCA9ICQoIi4iK3JlcXVlc3RJRCk7DQogICAgICAgIGlmKHRvb2x0aXBFbGVtZW50Lmxlbmd0aCl7DQogICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IHRpcHB5KHRvb2x0aXBFbGVtZW50WzBdKTsNCiAgICAgICAgICAgIGlmKGluc3RhbmNlKXsNCiAgICAgICAgICAgICAgICBpbnN0YW5jZS5kZXN0cm95KHRydWUpOw0KICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgaWYodG9vbHRpcEVsZW1lbnRbMF0uX3RpcHB5KXsNCiAgICAgICAgICAgICAgICAgICAgdG9vbHRpcEVsZW1lbnRbMF0uX3RpcHB5LmRlc3Ryb3kodHJ1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBsZXQgcGFyZW50ID0gdG9vbHRpcEVsZW1lbnQucGFyZW50KCk7DQogICAgICAgICAgICB0b29sdGlwRWxlbWVudC5jb250ZW50cygpLnVud3JhcCgpOw0KICAgICAgICAgICAgaWYocGFyZW50Lmxlbmd0aCl7DQogICAgICAgICAgICAgICAgcGFyZW50LmdldCgwKS5ub3JtYWxpemUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgfQ0KDQoNCn0="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "presentation/light-border.css",
                                    "css": "LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1le2JhY2tncm91bmQtY29sb3I6I2ZmZjtiYWNrZ3JvdW5kLWNsaXA6cGFkZGluZy1ib3g7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDAsOCwxNiwuMTUpO2NvbG9yOiMyNjMyM2Q7Ym94LXNoYWRvdzowIDNweCAxNHB4IC0uNXB4IHJnYmEoMCw4LDE2LC4wOCl9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lIC50aXBweS1iYWNrZHJvcHtiYWNrZ3JvdW5kLWNvbG9yOiNmZmZ9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lIC50aXBweS1hcnJvdzphZnRlciwudGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWUgLnRpcHB5LWFycm93OmJlZm9yZSwudGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWUgLnRpcHB5LXJvdW5kYXJyb3c6YWZ0ZXIsLnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lIC50aXBweS1yb3VuZGFycm93OmJlZm9yZXtjb250ZW50OiIiO3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6LTF9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lIC50aXBweS1yb3VuZGFycm93e2ZpbGw6I2ZmZn0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWUgLnRpcHB5LXJvdW5kYXJyb3c6YWZ0ZXJ7YmFja2dyb3VuZC1pbWFnZTp1cmwoZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCamJHbHdMWEoxYkdVOUltVjJaVzV2WkdRaUlHWnBiR3d0Y25Wc1pUMGlaWFpsYm05a1pDSWdjM1J5YjJ0bExXeHBibVZxYjJsdVBTSnliM1Z1WkNJZ2MzUnliMnRsTFcxcGRHVnliR2x0YVhROUlqRXVOREUwSWlCMmFXVjNRbTk0UFNJd0lEQWdNVGdnTnlJZ2VHMXNibk05SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpJd01EQXZjM1puSWo0OGNHRjBhQ0JrUFNKTk1DQTNjekl1TURJeExTNHdNVFVnTlM0eU5UTXROQzR5TVRoRE5pNDFPRFFnTVM0d05URWdOeTQzT1RjdU1EQTNJRGtnTUdNeExqSXdNeTB1TURBM0lESXVOREUySURFdU1ETTFJRE11TnpZeElESXVOemd5UXpFMkxqQXhNaUEzTGpBd05TQXhPQ0EzSURFNElEZDZJaUJtYVd4c1BTSWpNek16SWlCbWFXeHNMVzl3WVdOcGRIazlJaTR5TXpVaUlHWnBiR3d0Y25Wc1pUMGlibTl1ZW1WeWJ5SXZQand2YzNablBnPT0pO2JhY2tncm91bmQtc2l6ZToxOHB4IDdweDt3aWR0aDoxOHB4O2hlaWdodDo3cHg7bGVmdDowO3RvcDowO2ZpbGw6cmdiYSgwLDgsMTYsLjE1KX0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePXRvcF0gLnRpcHB5LXJvdW5kYXJyb3c6YWZ0ZXJ7dG9wOjFweDstd2Via2l0LXRyYW5zZm9ybTpyb3RhdGUoMTgwZGVnKTt0cmFuc2Zvcm06cm90YXRlKDE4MGRlZyl9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1hcnJvd3tib3JkZXItdG9wLWNvbG9yOiNmZmZ9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1hcnJvdzphZnRlcntib3JkZXItdG9wOjdweCBzb2xpZCAjZmZmO3RvcDotN3B4fS50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49dG9wXSAudGlwcHktYXJyb3c6YmVmb3Jle2JvcmRlci10b3A6N3B4IHNvbGlkIHJnYmEoMCw4LDE2LC4yKTtib3R0b206LTFweH0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePWJvdHRvbV0gLnRpcHB5LXJvdW5kYXJyb3c6YWZ0ZXJ7dG9wOi0xcHh9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1hcnJvd3tib3JkZXItYm90dG9tLWNvbG9yOiNmZmZ9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1hcnJvdzphZnRlcntib3JkZXItYm90dG9tOjdweCBzb2xpZCAjZmZmO2JvdHRvbTotN3B4fS50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktYXJyb3c6YmVmb3Jle2JvcmRlci1ib3R0b206N3B4IHNvbGlkIHJnYmEoMCw4LDE2LC4yKTtib3R0b206LTZweH0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePWxlZnRdIC50aXBweS1yb3VuZGFycm93OmFmdGVye2xlZnQ6MXB4O3RvcDowOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSg5MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSg5MGRlZyl9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktYXJyb3d7Ym9yZGVyLWxlZnQtY29sb3I6I2ZmZn0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePWxlZnRdIC50aXBweS1hcnJvdzphZnRlcntib3JkZXItbGVmdDo3cHggc29saWQgI2ZmZjtsZWZ0Oi03cHh9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktYXJyb3c6YmVmb3Jle2JvcmRlci1sZWZ0OjdweCBzb2xpZCByZ2JhKDAsOCwxNiwuMik7bGVmdDotNnB4fS50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1yb3VuZGFycm93OmFmdGVye2xlZnQ6LTFweDt0b3A6MDstd2Via2l0LXRyYW5zZm9ybTpyb3RhdGUoLTkwZGVnKTt0cmFuc2Zvcm06cm90YXRlKC05MGRlZyl9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1yaWdodF0gLnRpcHB5LWFycm93e2JvcmRlci1yaWdodC1jb2xvcjojZmZmfS50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1hcnJvdzphZnRlcntib3JkZXItcmlnaHQ6N3B4IHNvbGlkICNmZmY7cmlnaHQ6LTdweH0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePXJpZ2h0XSAudGlwcHktYXJyb3c6YmVmb3Jle2JvcmRlci1yaWdodDo3cHggc29saWQgcmdiYSgwLDgsMTYsLjIpO3JpZ2h0Oi02cHh9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1hcnJvdywudGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePWJvdHRvbV0gLnRpcHB5LXJvdW5kYXJyb3csLnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1hcnJvdywudGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePXRvcF0gLnRpcHB5LXJvdW5kYXJyb3d7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgtMXB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtMXB4KX0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePWJvdHRvbV0gLnRpcHB5LWFycm93OmFmdGVyLC50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktYXJyb3c6YmVmb3JlLC50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49dG9wXSAudGlwcHktYXJyb3c6YWZ0ZXIsLnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1hcnJvdzpiZWZvcmV7bGVmdDotN3B4O2JvcmRlci1sZWZ0OjdweCBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItcmlnaHQ6N3B4IHNvbGlkIHRyYW5zcGFyZW50fS50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LWFycm93LC50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LXJvdW5kYXJyb3csLnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1yaWdodF0gLnRpcHB5LWFycm93LC50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1yb3VuZGFycm93ey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTFweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTFweCl9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktYXJyb3c6YWZ0ZXIsLnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktYXJyb3c6YmVmb3JlLC50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1hcnJvdzphZnRlciwudGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePXJpZ2h0XSAudGlwcHktYXJyb3c6YmVmb3Jle3RvcDotN3B4O2JvcmRlci10b3A6N3B4IHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1ib3R0b206N3B4IHNvbGlkIHRyYW5zcGFyZW50fQ=="
                                },
                                {
                                    "id": "presentation/tippy-tooltip.css",
                                    "css": "LmVhc3ktcmVhZGluZy10aXBweS10b29sdGlwIHsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBkb3R0ZWQgYmxhY2s7DQp9DQoNCg=="
                                }
                            ]
                        },
                        "configuration": {
                            "remoteAssetDirectory": "https://localhost:8080//components/presentation/tippy-tooltip/1.0/presentation/images"
                        }
                    }
                },
                {
                    "function": {
                        "source": {
                            "id": "increaseLineHeight",
                            "engine": {
                                "id": "line-spacing-tool",
                                "version": "1.0",
                                "debugMode": false
                            },
                            "debugMode": false,
                            "name": "Line spacing tool",
                            "description": "Increases or decreases line spacing",
                            "inputTypes": [
                                {
                                    "inputType": "VoidIOType"
                                }
                            ],
                            "outputTypes": [
                                {
                                    "outputType": "VoidIOType"
                                }
                            ],
                            "defaultIcon": "assets/increaseLineHeight.png",
                            "defaultIconURL": "https://localhost:8080/components/engines/line-spacing-tool/1.0/assets/increaseLineHeight.png",
                            "remoteBaseDirectory": "components/engines/line-spacing-tool/1.0/",
                            "type": "LocalFunction",
                            "entryPoint": "increaseLineHeight",
                            "remoteAssetDirectory": "",
                            "contentScripts": [
                                {
                                    "id": "line-spacing-tool/1.0/js/line-spacing-tool.js",
                                    "source": "bGV0IHpvb20gPSAwOw0KbGV0IHpvb21Jbml0ID0gZmFsc2U7DQoNCmZ1bmN0aW9uIGluaXRGb250TWFnbmlmaWNhdGlvbigpIHsNCiAgICBpZiAoIXpvb21Jbml0KSB7DQogICAgICAgICQoJyonKS5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGxldCBlbCA9ICQodGhpcyk7DQogICAgICAgICAgICBsZXQgc2l6ZSA9IHBhcnNlSW50KGVsLmNzcygnZm9udC1zaXplJykpOw0KICAgICAgICAgICAgZWwuZGF0YSgnZm9udC1zaXplJywgc2l6ZSk7DQoNCg0KICAgICAgICB9KTsNCiAgICAgICAgem9vbUluaXQgPSB0cnVlOw0KICAgIH0NCg0KfQ0KDQpmdW5jdGlvbiBtYWduaWZ5Rm9udChyZXEsIGNvbmZpZyx3aWRnZXQpIHsNCiAgICBpbml0Rm9udE1hZ25pZmljYXRpb24oKTsNCiAgICB6b29tKys7DQogICAgJCgnKicpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICBpZighJCh0aGlzKS5wYXJlbnRzKCcuZWFzeS1yZWFkaW5nLWludGVyZmFjZScpLmxlbmd0aCl7DQogICAgICAgICAgICBsZXQgZWwgPSAkKHRoaXMpOw0KICAgICAgICAgICAgbGV0IHNpemUgPSBlbC5kYXRhKCdmb250LXNpemUnKTsNCiAgICAgICAgICAgIGVsLmNzcygnZm9udC1zaXplJywgTWF0aC5tYXgoc2l6ZSArIHpvb20sIDApICsgJ3B4Jyk7DQogICAgICAgIH0NCg0KICAgIH0pOw0KDQoNCn0NCg0KZnVuY3Rpb24gc2hyaW5rRm9udChyZXEsIGNvbmZpZykgew0KICAgIGluaXRGb250TWFnbmlmaWNhdGlvbigpOw0KICAgIHpvb20tLTsNCiAgICAkKCcqJykuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgIGlmKCEkKHRoaXMpLnBhcmVudHMoJy5lYXN5LXJlYWRpbmctaW50ZXJmYWNlJykubGVuZ3RoKXsNCiAgICAgICAgICAgIGxldCBlbCA9ICQodGhpcyk7DQogICAgICAgICAgICBsZXQgc2l6ZSA9IGVsLmRhdGEoJ2ZvbnQtc2l6ZScpOw0KICAgICAgICAgICAgZWwuY3NzKCdmb250LXNpemUnLCBNYXRoLm1heChzaXplICsgem9vbSwgMCkgKyAncHgnKTsNCiAgICAgICAgfQ0KDQogICAgfSk7DQp9DQoNCg0KDQovLy9MSU5FIEhFSUdIVA0KbGV0IGxpbmVIZWlnaHQgPSAwOw0KbGV0IGxpbmVIZWlnaHRJbml0ID0gZmFsc2U7DQoNCmZ1bmN0aW9uIGluaXRMaW5lSGVpZ2h0KCkgew0KICAgIGlmICghbGluZUhlaWdodEluaXQpIHsNCiAgICAgICAgJCgnKicpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgbGV0IGVsID0gJCh0aGlzKTsNCiAgICAgICAgICAgIGxldCBzaXplID0gcGFyc2VJbnQoZWwuY3NzKCdsaW5lLWhlaWdodCcpKTsNCiAgICAgICAgICAgIGVsLmRhdGEoJ2xpbmUtaGVpZ2h0Jywgc2l6ZSk7DQoNCiAgICAgICAgfSk7DQogICAgICAgIGxpbmVIZWlnaHRJbml0ID0gdHJ1ZTsNCiAgICB9DQoNCn0NCg0KZnVuY3Rpb24gaW5jcmVhc2VMaW5lSGVpZ2h0KHJlcSwgY29uZmlnKSB7DQogICAgaW5pdExpbmVIZWlnaHQoKTsNCiAgICBsaW5lSGVpZ2h0Kys7DQogICAgJCgnKicpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICBpZighJCh0aGlzKS5wYXJlbnRzKCcuZWFzeS1yZWFkaW5nLWludGVyZmFjZScpLmxlbmd0aCl7DQogICAgICAgICAgICBsZXQgZWwgPSAkKHRoaXMpOw0KICAgICAgICAgICAgbGV0IHNpemUgPSBlbC5kYXRhKCdsaW5lLWhlaWdodCcpOw0KICAgICAgICAgICAgZWwuY3NzKCdsaW5lLWhlaWdodCcsIE1hdGgubWF4KHNpemUgKyBsaW5lSGVpZ2h0LCAwKSArICdweCcpOw0KICAgICAgICB9DQoNCiAgICB9KTsNCg0KDQp9DQoNCmZ1bmN0aW9uIGRlY3JlYXNlTGluZUhlaWdodChyZXEsIGNvbmZpZykgew0KICAgIGluaXRMaW5lSGVpZ2h0KCk7DQogICAgbGluZUhlaWdodC0tOw0KICAgICQoJyonKS5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaWYoISQodGhpcykucGFyZW50cygnLmVhc3ktcmVhZGluZy1pbnRlcmZhY2UnKS5sZW5ndGgpew0KICAgICAgICAgICAgbGV0IGVsID0gJCh0aGlzKTsNCiAgICAgICAgICAgIGxldCBzaXplID0gZWwuZGF0YSgnbGluZS1oZWlnaHQnKTsNCiAgICAgICAgICAgIGVsLmNzcygnbGluZS1oZWlnaHQnLCBNYXRoLm1heChzaXplICsgbGluZUhlaWdodCwgMCkgKyAncHgnKTsNCiAgICAgICAgfQ0KDQogICAgfSk7DQp9"
                                }
                            ],
                            "contentCSS": []
                        }
                    },
                    "widget": {
                        "source": {
                            "id": "button",
                            "name": "Simple Button",
                            "description": "A simple button.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "",
                            "remoteBaseDirectory": "components/widget/button/1.0/",
                            "implementationClass": "Button",
                            "contentScripts": [
                                {
                                    "id": "widget/button.js",
                                    "source": "Y2xhc3MgQnV0dG9uIGV4dGVuZHMgV2lkZ2V0QmFzZSB7DQoNCiAgICBjb25zdHJ1Y3RvcihmdW5jdGlvbkluZm8sIHVzZXJJbnRlcmZhY2UsdGFyZ2V0SUQsIGNvbmZpZ3VyYXRpb24pew0KICAgICAgICBzdXBlcihmdW5jdGlvbkluZm8sdXNlckludGVyZmFjZSx0YXJnZXRJRCxjb25maWd1cmF0aW9uKTsNCg0KICAgICAgICB0aGlzLndpZGdldElEID0gJ2VyX2J1dHRvbl8nK3RoaXMud2lkZ2V0SUQ7DQogICAgICAgICQoIiMiK3RhcmdldElEKS5hcHBlbmQoIjxidXR0b24gaWQ9JyIrdGhpcy53aWRnZXRJRCsiJyBjbGFzcz0nZWFzeS1yZWFkaW5nLWJ1dHRvbic+PGltZyBzcmM9JyIrZnVuY3Rpb25JbmZvLnNvdXJjZS5kZWZhdWx0SWNvblVSTCsiJyB0aXRsZT0nIitmdW5jdGlvbkluZm8uc291cmNlLm5hbWUrIjogIitmdW5jdGlvbkluZm8uc291cmNlLmRlc2NyaXB0aW9uKyInPiA8L2J1dHRvbj4iKTsNCiAgICAgICAgdGhpcy5lbmFibGUoKTsNCiAgICB9DQoNCiAgICBlbmFibGUoKXsNCiAgICAgICAgJCgiIyIrdGhpcy53aWRnZXRJRCkub24oICJjbGljayIsdGhpcywgdGhpcy5idXR0b25DbGlja2VkKTsNCg0KICAgIH0NCg0KICAgIGRpc2FibGUoKXsNCiAgICAgICAgJCgiIyIrdGhpcy53aWRnZXRJRCkub2ZmKCAiY2xpY2siLHRoaXMsIHRoaXMuYnV0dG9uQ2xpY2tlZCk7DQogICAgfQ0KDQogICAgYnV0dG9uQ2xpY2tlZChlKXsNCiAgICAgICAgbGV0IHZvaWRJbnB1dCA9IHsNCiAgICAgICAgICAgIHR5cGU6ICJWb2lkIiwNCiAgICAgICAgfTsNCiAgICAgICAgcmVxdWVzdE1hbmFnZXIuY3JlYXRlUmVxdWVzdChlLmRhdGEsIHZvaWRJbnB1dCwgZSk7DQogICAgfQ0KDQogICAgcmVtb3ZlKCl7DQogICAgICAgICQoIiMiK3RoaXMud2lkZ2V0SUQpLnJlbW92ZSgpOw0KICAgIH0NCn0NCg=="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "widget/button.css",
                                    "css": "LmVhc3ktcmVhZGluZy1idXR0b24+aW1new0KICAgIG1heC13aWR0aDogMTAwJTsNCn0NCg0KLmVhc3ktcmVhZGluZy1idXR0b257DQogICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lICFpbXBvcnRhbnQ7DQogICAgLXdlYmtpdC1ib3JkZXItcmFkaXVzOiAwICFpbXBvcnRhbnQ7DQogICAgcGFkZGluZzogMCAhaW1wb3J0YW50Ow0KfQ=="
                                }
                            ]
                        }
                    }
                },
                {
                    "function": {
                        "source": {
                            "id": "decreaseLineHeight",
                            "engine": {
                                "id": "line-spacing-tool",
                                "version": "1.0",
                                "debugMode": false
                            },
                            "debugMode": false,
                            "name": "Decrease line height",
                            "description": "Decreases the line height",
                            "inputTypes": [
                                {
                                    "inputType": "VoidIOType"
                                }
                            ],
                            "outputTypes": [
                                {
                                    "outputType": "VoidIOType"
                                }
                            ],
                            "defaultIcon": "assets/decreaseLineHeight.png",
                            "defaultIconURL": "https://localhost:8080/components/engines/line-spacing-tool/1.0/assets/decreaseLineHeight.png",
                            "remoteBaseDirectory": "components/engines/line-spacing-tool/1.0/",
                            "type": "LocalFunction",
                            "entryPoint": "decreaseLineHeight",
                            "remoteAssetDirectory": "",
                            "contentScripts": [
                                {
                                    "id": "line-spacing-tool/1.0/js/line-spacing-tool.js",
                                    "source": "bGV0IHpvb20gPSAwOw0KbGV0IHpvb21Jbml0ID0gZmFsc2U7DQoNCmZ1bmN0aW9uIGluaXRGb250TWFnbmlmaWNhdGlvbigpIHsNCiAgICBpZiAoIXpvb21Jbml0KSB7DQogICAgICAgICQoJyonKS5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGxldCBlbCA9ICQodGhpcyk7DQogICAgICAgICAgICBsZXQgc2l6ZSA9IHBhcnNlSW50KGVsLmNzcygnZm9udC1zaXplJykpOw0KICAgICAgICAgICAgZWwuZGF0YSgnZm9udC1zaXplJywgc2l6ZSk7DQoNCg0KICAgICAgICB9KTsNCiAgICAgICAgem9vbUluaXQgPSB0cnVlOw0KICAgIH0NCg0KfQ0KDQpmdW5jdGlvbiBtYWduaWZ5Rm9udChyZXEsIGNvbmZpZyx3aWRnZXQpIHsNCiAgICBpbml0Rm9udE1hZ25pZmljYXRpb24oKTsNCiAgICB6b29tKys7DQogICAgJCgnKicpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICBpZighJCh0aGlzKS5wYXJlbnRzKCcuZWFzeS1yZWFkaW5nLWludGVyZmFjZScpLmxlbmd0aCl7DQogICAgICAgICAgICBsZXQgZWwgPSAkKHRoaXMpOw0KICAgICAgICAgICAgbGV0IHNpemUgPSBlbC5kYXRhKCdmb250LXNpemUnKTsNCiAgICAgICAgICAgIGVsLmNzcygnZm9udC1zaXplJywgTWF0aC5tYXgoc2l6ZSArIHpvb20sIDApICsgJ3B4Jyk7DQogICAgICAgIH0NCg0KICAgIH0pOw0KDQoNCn0NCg0KZnVuY3Rpb24gc2hyaW5rRm9udChyZXEsIGNvbmZpZykgew0KICAgIGluaXRGb250TWFnbmlmaWNhdGlvbigpOw0KICAgIHpvb20tLTsNCiAgICAkKCcqJykuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgIGlmKCEkKHRoaXMpLnBhcmVudHMoJy5lYXN5LXJlYWRpbmctaW50ZXJmYWNlJykubGVuZ3RoKXsNCiAgICAgICAgICAgIGxldCBlbCA9ICQodGhpcyk7DQogICAgICAgICAgICBsZXQgc2l6ZSA9IGVsLmRhdGEoJ2ZvbnQtc2l6ZScpOw0KICAgICAgICAgICAgZWwuY3NzKCdmb250LXNpemUnLCBNYXRoLm1heChzaXplICsgem9vbSwgMCkgKyAncHgnKTsNCiAgICAgICAgfQ0KDQogICAgfSk7DQp9DQoNCg0KDQovLy9MSU5FIEhFSUdIVA0KbGV0IGxpbmVIZWlnaHQgPSAwOw0KbGV0IGxpbmVIZWlnaHRJbml0ID0gZmFsc2U7DQoNCmZ1bmN0aW9uIGluaXRMaW5lSGVpZ2h0KCkgew0KICAgIGlmICghbGluZUhlaWdodEluaXQpIHsNCiAgICAgICAgJCgnKicpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgbGV0IGVsID0gJCh0aGlzKTsNCiAgICAgICAgICAgIGxldCBzaXplID0gcGFyc2VJbnQoZWwuY3NzKCdsaW5lLWhlaWdodCcpKTsNCiAgICAgICAgICAgIGVsLmRhdGEoJ2xpbmUtaGVpZ2h0Jywgc2l6ZSk7DQoNCiAgICAgICAgfSk7DQogICAgICAgIGxpbmVIZWlnaHRJbml0ID0gdHJ1ZTsNCiAgICB9DQoNCn0NCg0KZnVuY3Rpb24gaW5jcmVhc2VMaW5lSGVpZ2h0KHJlcSwgY29uZmlnKSB7DQogICAgaW5pdExpbmVIZWlnaHQoKTsNCiAgICBsaW5lSGVpZ2h0Kys7DQogICAgJCgnKicpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICBpZighJCh0aGlzKS5wYXJlbnRzKCcuZWFzeS1yZWFkaW5nLWludGVyZmFjZScpLmxlbmd0aCl7DQogICAgICAgICAgICBsZXQgZWwgPSAkKHRoaXMpOw0KICAgICAgICAgICAgbGV0IHNpemUgPSBlbC5kYXRhKCdsaW5lLWhlaWdodCcpOw0KICAgICAgICAgICAgZWwuY3NzKCdsaW5lLWhlaWdodCcsIE1hdGgubWF4KHNpemUgKyBsaW5lSGVpZ2h0LCAwKSArICdweCcpOw0KICAgICAgICB9DQoNCiAgICB9KTsNCg0KDQp9DQoNCmZ1bmN0aW9uIGRlY3JlYXNlTGluZUhlaWdodChyZXEsIGNvbmZpZykgew0KICAgIGluaXRMaW5lSGVpZ2h0KCk7DQogICAgbGluZUhlaWdodC0tOw0KICAgICQoJyonKS5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaWYoISQodGhpcykucGFyZW50cygnLmVhc3ktcmVhZGluZy1pbnRlcmZhY2UnKS5sZW5ndGgpew0KICAgICAgICAgICAgbGV0IGVsID0gJCh0aGlzKTsNCiAgICAgICAgICAgIGxldCBzaXplID0gZWwuZGF0YSgnbGluZS1oZWlnaHQnKTsNCiAgICAgICAgICAgIGVsLmNzcygnbGluZS1oZWlnaHQnLCBNYXRoLm1heChzaXplICsgbGluZUhlaWdodCwgMCkgKyAncHgnKTsNCiAgICAgICAgfQ0KDQogICAgfSk7DQp9"
                                }
                            ],
                            "contentCSS": []
                        }
                    },
                    "widget": {
                        "source": {
                            "id": "button",
                            "name": "Simple Button",
                            "description": "A simple button.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "",
                            "remoteBaseDirectory": "components/widget/button/1.0/",
                            "implementationClass": "Button",
                            "contentScripts": [
                                {
                                    "id": "widget/button.js",
                                    "source": "Y2xhc3MgQnV0dG9uIGV4dGVuZHMgV2lkZ2V0QmFzZSB7DQoNCiAgICBjb25zdHJ1Y3RvcihmdW5jdGlvbkluZm8sIHVzZXJJbnRlcmZhY2UsdGFyZ2V0SUQsIGNvbmZpZ3VyYXRpb24pew0KICAgICAgICBzdXBlcihmdW5jdGlvbkluZm8sdXNlckludGVyZmFjZSx0YXJnZXRJRCxjb25maWd1cmF0aW9uKTsNCg0KICAgICAgICB0aGlzLndpZGdldElEID0gJ2VyX2J1dHRvbl8nK3RoaXMud2lkZ2V0SUQ7DQogICAgICAgICQoIiMiK3RhcmdldElEKS5hcHBlbmQoIjxidXR0b24gaWQ9JyIrdGhpcy53aWRnZXRJRCsiJyBjbGFzcz0nZWFzeS1yZWFkaW5nLWJ1dHRvbic+PGltZyBzcmM9JyIrZnVuY3Rpb25JbmZvLnNvdXJjZS5kZWZhdWx0SWNvblVSTCsiJyB0aXRsZT0nIitmdW5jdGlvbkluZm8uc291cmNlLm5hbWUrIjogIitmdW5jdGlvbkluZm8uc291cmNlLmRlc2NyaXB0aW9uKyInPiA8L2J1dHRvbj4iKTsNCiAgICAgICAgdGhpcy5lbmFibGUoKTsNCiAgICB9DQoNCiAgICBlbmFibGUoKXsNCiAgICAgICAgJCgiIyIrdGhpcy53aWRnZXRJRCkub24oICJjbGljayIsdGhpcywgdGhpcy5idXR0b25DbGlja2VkKTsNCg0KICAgIH0NCg0KICAgIGRpc2FibGUoKXsNCiAgICAgICAgJCgiIyIrdGhpcy53aWRnZXRJRCkub2ZmKCAiY2xpY2siLHRoaXMsIHRoaXMuYnV0dG9uQ2xpY2tlZCk7DQogICAgfQ0KDQogICAgYnV0dG9uQ2xpY2tlZChlKXsNCiAgICAgICAgbGV0IHZvaWRJbnB1dCA9IHsNCiAgICAgICAgICAgIHR5cGU6ICJWb2lkIiwNCiAgICAgICAgfTsNCiAgICAgICAgcmVxdWVzdE1hbmFnZXIuY3JlYXRlUmVxdWVzdChlLmRhdGEsIHZvaWRJbnB1dCwgZSk7DQogICAgfQ0KDQogICAgcmVtb3ZlKCl7DQogICAgICAgICQoIiMiK3RoaXMud2lkZ2V0SUQpLnJlbW92ZSgpOw0KICAgIH0NCn0NCg=="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "widget/button.css",
                                    "css": "LmVhc3ktcmVhZGluZy1idXR0b24+aW1new0KICAgIG1heC13aWR0aDogMTAwJTsNCn0NCg0KLmVhc3ktcmVhZGluZy1idXR0b257DQogICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lICFpbXBvcnRhbnQ7DQogICAgLXdlYmtpdC1ib3JkZXItcmFkaXVzOiAwICFpbXBvcnRhbnQ7DQogICAgcGFkZGluZzogMCAhaW1wb3J0YW50Ow0KfQ=="
                                }
                            ]
                        }
                    }
                },
                {
                    "function": {
                        "source": {
                            "id": "readability",
                            "engine": {
                                "id": "readability",
                                "version": "1.0",
                                "debugMode": false
                            },
                            "debugMode": false,
                            "name": "Readability",
                            "description": "Gets Main Content",
                            "inputTypes": [
                                {
                                    "inputType": "VoidIOType"
                                }
                            ],
                            "outputTypes": [
                                {
                                    "outputType": "VoidIOType"
                                }
                            ],
                            "defaultIcon": "assets/readability.png",
                            "defaultIconURL": "https://localhost:8080/components/engines/readability/1.0/assets/readability.png",
                            "remoteBaseDirectory": "components/engines/readability/1.0/",
                            "type": "LocalFunction",
                            "entryPoint": "readability",
                            "remoteAssetDirectory": "",
                            "contentScripts": [
                                {
                                    "id": "readability/1.0/js/Readability.js",
                                    "source": "Lyplc2xpbnQtZW52IGVzNjpmYWxzZSovDQovKg0KICogQ29weXJpZ2h0IChjKSAyMDEwIEFyYzkwIEluYw0KICoNCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLg0KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQogKg0KICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KICoNCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUNCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4NCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQNCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICovDQoNCi8qDQogKiBUaGlzIGNvZGUgaXMgaGVhdmlseSBiYXNlZCBvbiBBcmM5MCdzIHJlYWRhYmlsaXR5LmpzICgxLjcuMSkgc2NyaXB0DQogKiBhdmFpbGFibGUgYXQ6IGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9hcmM5MGxhYnMtcmVhZGFiaWxpdHkNCiAqLw0KDQovKioNCiAqIFB1YmxpYyBjb25zdHJ1Y3Rvci4NCiAqIEBwYXJhbSB7SFRNTERvY3VtZW50fSBkb2MgICAgIFRoZSBkb2N1bWVudCB0byBwYXJzZS4NCiAqIEBwYXJhbSB7T2JqZWN0fSAgICAgICBvcHRpb25zIFRoZSBvcHRpb25zIG9iamVjdC4NCiAqLw0KZnVuY3Rpb24gUmVhZGFiaWxpdHkoZG9jLCBvcHRpb25zKSB7DQogIC8vIEluIHNvbWUgb2xkZXIgdmVyc2lvbnMsIHBlb3BsZSBwYXNzZWQgYSBVUkkgYXMgdGhlIGZpcnN0IGFyZ3VtZW50LiBDb3BlOg0KICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmRvY3VtZW50RWxlbWVudCkgew0KICAgIGRvYyA9IG9wdGlvbnM7DQogICAgb3B0aW9ucyA9IGFyZ3VtZW50c1syXTsNCiAgfSBlbHNlIGlmICghZG9jIHx8ICFkb2MuZG9jdW1lbnRFbGVtZW50KSB7DQogICAgdGhyb3cgbmV3IEVycm9yKCJGaXJzdCBhcmd1bWVudCB0byBSZWFkYWJpbGl0eSBjb25zdHJ1Y3RvciBzaG91bGQgYmUgYSBkb2N1bWVudCBvYmplY3QuIik7DQogIH0NCiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307DQoNCiAgdGhpcy5fZG9jID0gZG9jOw0KICB0aGlzLl9hcnRpY2xlVGl0bGUgPSBudWxsOw0KICB0aGlzLl9hcnRpY2xlQnlsaW5lID0gbnVsbDsNCiAgdGhpcy5fYXJ0aWNsZURpciA9IG51bGw7DQogIHRoaXMuX2FydGljbGVTaXRlTmFtZSA9IG51bGw7DQogIHRoaXMuX2F0dGVtcHRzID0gW107DQoNCiAgLy8gQ29uZmlndXJhYmxlIG9wdGlvbnMNCiAgdGhpcy5fZGVidWcgPSAhIW9wdGlvbnMuZGVidWc7DQogIHRoaXMuX21heEVsZW1zVG9QYXJzZSA9IG9wdGlvbnMubWF4RWxlbXNUb1BhcnNlIHx8IHRoaXMuREVGQVVMVF9NQVhfRUxFTVNfVE9fUEFSU0U7DQogIHRoaXMuX25iVG9wQ2FuZGlkYXRlcyA9IG9wdGlvbnMubmJUb3BDYW5kaWRhdGVzIHx8IHRoaXMuREVGQVVMVF9OX1RPUF9DQU5ESURBVEVTOw0KICB0aGlzLl9jaGFyVGhyZXNob2xkID0gb3B0aW9ucy5jaGFyVGhyZXNob2xkIHx8IHRoaXMuREVGQVVMVF9DSEFSX1RIUkVTSE9MRDsNCiAgdGhpcy5fY2xhc3Nlc1RvUHJlc2VydmUgPSB0aGlzLkNMQVNTRVNfVE9fUFJFU0VSVkUuY29uY2F0KG9wdGlvbnMuY2xhc3Nlc1RvUHJlc2VydmUgfHwgW10pOw0KICB0aGlzLl9rZWVwQ2xhc3NlcyA9ICEhb3B0aW9ucy5rZWVwQ2xhc3NlczsNCg0KICAvLyBTdGFydCB3aXRoIGFsbCBmbGFncyBzZXQNCiAgdGhpcy5fZmxhZ3MgPSB0aGlzLkZMQUdfU1RSSVBfVU5MSUtFTFlTIHwNCiAgICAgICAgICAgICAgICB0aGlzLkZMQUdfV0VJR0hUX0NMQVNTRVMgfA0KICAgICAgICAgICAgICAgIHRoaXMuRkxBR19DTEVBTl9DT05ESVRJT05BTExZOw0KDQogIHZhciBsb2dFbDsNCg0KICAvLyBDb250cm9sIHdoZXRoZXIgbG9nIG1lc3NhZ2VzIGFyZSBzZW50IHRvIHRoZSBjb25zb2xlDQogIGlmICh0aGlzLl9kZWJ1Zykgew0KICAgIGxvZ0VsID0gZnVuY3Rpb24oZSkgew0KICAgICAgdmFyIHJ2ID0gZS5ub2RlTmFtZSArICIgIjsNCiAgICAgIGlmIChlLm5vZGVUeXBlID09IGUuVEVYVF9OT0RFKSB7DQogICAgICAgIHJldHVybiBydiArICcoIicgKyBlLnRleHRDb250ZW50ICsgJyIpJzsNCiAgICAgIH0NCiAgICAgIHZhciBjbGFzc0Rlc2MgPSBlLmNsYXNzTmFtZSAmJiAoIi4iICsgZS5jbGFzc05hbWUucmVwbGFjZSgvIC9nLCAiLiIpKTsNCiAgICAgIHZhciBlbERlc2MgPSAiIjsNCiAgICAgIGlmIChlLmlkKQ0KICAgICAgICBlbERlc2MgPSAiKCMiICsgZS5pZCArIGNsYXNzRGVzYyArICIpIjsNCiAgICAgIGVsc2UgaWYgKGNsYXNzRGVzYykNCiAgICAgICAgZWxEZXNjID0gIigiICsgY2xhc3NEZXNjICsgIikiOw0KICAgICAgcmV0dXJuIHJ2ICsgZWxEZXNjOw0KICAgIH07DQogICAgdGhpcy5sb2cgPSBmdW5jdGlvbiAoKSB7DQogICAgICBpZiAodHlwZW9mIGR1bXAgIT09ICJ1bmRlZmluZWQiKSB7DQogICAgICAgIHZhciBtc2cgPSBBcnJheS5wcm90b3R5cGUubWFwLmNhbGwoYXJndW1lbnRzLCBmdW5jdGlvbih4KSB7DQogICAgICAgICAgcmV0dXJuICh4ICYmIHgubm9kZU5hbWUpID8gbG9nRWwoeCkgOiB4Ow0KICAgICAgICB9KS5qb2luKCIgIik7DQogICAgICAgIGR1bXAoIlJlYWRlcjogKFJlYWRhYmlsaXR5KSAiICsgbXNnICsgIlxuIik7DQogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAidW5kZWZpbmVkIikgew0KICAgICAgICB2YXIgYXJncyA9IFsiUmVhZGVyOiAoUmVhZGFiaWxpdHkpICJdLmNvbmNhdChhcmd1bWVudHMpOw0KICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmdzKTsNCiAgICAgIH0NCiAgICB9Ow0KICB9IGVsc2Ugew0KICAgIHRoaXMubG9nID0gZnVuY3Rpb24gKCkge307DQogIH0NCn0NCg0KUmVhZGFiaWxpdHkucHJvdG90eXBlID0gew0KICBGTEFHX1NUUklQX1VOTElLRUxZUzogMHgxLA0KICBGTEFHX1dFSUdIVF9DTEFTU0VTOiAweDIsDQogIEZMQUdfQ0xFQU5fQ09ORElUSU9OQUxMWTogMHg0LA0KDQogIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Ob2RlL25vZGVUeXBlDQogIEVMRU1FTlRfTk9ERTogMSwNCiAgVEVYVF9OT0RFOiAzLA0KDQogIC8vIE1heCBudW1iZXIgb2Ygbm9kZXMgc3VwcG9ydGVkIGJ5IHRoaXMgcGFyc2VyLiBEZWZhdWx0OiAwIChubyBsaW1pdCkNCiAgREVGQVVMVF9NQVhfRUxFTVNfVE9fUEFSU0U6IDAsDQoNCiAgLy8gVGhlIG51bWJlciBvZiB0b3AgY2FuZGlkYXRlcyB0byBjb25zaWRlciB3aGVuIGFuYWx5c2luZyBob3cNCiAgLy8gdGlnaHQgdGhlIGNvbXBldGl0aW9uIGlzIGFtb25nIGNhbmRpZGF0ZXMuDQogIERFRkFVTFRfTl9UT1BfQ0FORElEQVRFUzogNSwNCg0KICAvLyBFbGVtZW50IHRhZ3MgdG8gc2NvcmUgYnkgZGVmYXVsdC4NCiAgREVGQVVMVF9UQUdTX1RPX1NDT1JFOiAic2VjdGlvbixoMixoMyxoNCxoNSxoNixwLHRkLHByZSIudG9VcHBlckNhc2UoKS5zcGxpdCgiLCIpLA0KDQogIC8vIFRoZSBkZWZhdWx0IG51bWJlciBvZiBjaGFycyBhbiBhcnRpY2xlIG11c3QgaGF2ZSBpbiBvcmRlciB0byByZXR1cm4gYSByZXN1bHQNCiAgREVGQVVMVF9DSEFSX1RIUkVTSE9MRDogNTAwLA0KDQogIC8vIEFsbCBvZiB0aGUgcmVndWxhciBleHByZXNzaW9ucyBpbiB1c2Ugd2l0aGluIHJlYWRhYmlsaXR5Lg0KICAvLyBEZWZpbmVkIHVwIGhlcmUgc28gd2UgZG9uJ3QgaW5zdGFudGlhdGUgdGhlbSByZXBlYXRlZGx5IGluIGxvb3BzLg0KICBSRUdFWFBTOiB7DQogICAgLy8gTk9URTogVGhlc2UgdHdvIHJlZ3VsYXIgZXhwcmVzc2lvbnMgYXJlIGR1cGxpY2F0ZWQgaW4NCiAgICAvLyBSZWFkYWJpbGl0eS1yZWFkZXJhYmxlLmpzLiBQbGVhc2Uga2VlcCBib3RoIGNvcGllcyBpbiBzeW5jLg0KICAgIHVubGlrZWx5Q2FuZGlkYXRlczogLy1hZC18YWkyaHRtbHxiYW5uZXJ8YnJlYWRjcnVtYnN8Y29tYnh8Y29tbWVudHxjb21tdW5pdHl8Y292ZXItd3JhcHxkaXNxdXN8ZXh0cmF8Zm9vdGVyfGdkcHJ8aGVhZGVyfGxlZ2VuZHN8bWVudXxyZWxhdGVkfHJlbWFya3xyZXBsaWVzfHJzc3xzaG91dGJveHxzaWRlYmFyfHNreXNjcmFwZXJ8c29jaWFsfHNwb25zb3J8c3VwcGxlbWVudGFsfGFkLWJyZWFrfGFnZWdhdGV8cGFnaW5hdGlvbnxwYWdlcnxwb3B1cHx5b20tcmVtb3RlL2ksDQogICAgb2tNYXliZUl0c0FDYW5kaWRhdGU6IC9hbmR8YXJ0aWNsZXxib2R5fGNvbHVtbnxtYWlufHNoYWRvdy9pLA0KDQogICAgcG9zaXRpdmU6IC9hcnRpY2xlfGJvZHl8Y29udGVudHxlbnRyeXxoZW50cnl8aC1lbnRyeXxtYWlufHBhZ2V8cGFnaW5hdGlvbnxwb3N0fHRleHR8YmxvZ3xzdG9yeS9pLA0KICAgIG5lZ2F0aXZlOiAvaGlkZGVufF5oaWQkfCBoaWQkfCBoaWQgfF5oaWQgfGJhbm5lcnxjb21ieHxjb21tZW50fGNvbS18Y29udGFjdHxmb290fGZvb3Rlcnxmb290bm90ZXxnZHByfG1hc3RoZWFkfG1lZGlhfG1ldGF8b3V0YnJhaW58cHJvbW98cmVsYXRlZHxzY3JvbGx8c2hhcmV8c2hvdXRib3h8c2lkZWJhcnxza3lzY3JhcGVyfHNwb25zb3J8c2hvcHBpbmd8dGFnc3x0b29sfHdpZGdldC9pLA0KICAgIGV4dHJhbmVvdXM6IC9wcmludHxhcmNoaXZlfGNvbW1lbnR8ZGlzY3Vzc3xlW1wtXT9tYWlsfHNoYXJlfHJlcGx5fGFsbHxsb2dpbnxzaWdufHNpbmdsZXx1dGlsaXR5L2ksDQogICAgYnlsaW5lOiAvYnlsaW5lfGF1dGhvcnxkYXRlbGluZXx3cml0dGVuYnl8cC1hdXRob3IvaSwNCiAgICByZXBsYWNlRm9udHM6IC88KFwvPylmb250W14+XSo+L2dpLA0KICAgIG5vcm1hbGl6ZTogL1xzezIsfS9nLA0KICAgIHZpZGVvczogL1wvXC8od3d3XC4pPygoZGFpbHltb3Rpb258eW91dHViZXx5b3V0dWJlLW5vY29va2llfHBsYXllclwudmltZW98dlwucXEpXC5jb218KGFyY2hpdmV8dXBsb2FkXC53aWtpbWVkaWEpXC5vcmd8cGxheWVyXC50d2l0Y2hcLnR2KS9pLA0KICAgIHNoYXJlRWxlbWVudHM6IC8oXGJ8Xykoc2hhcmV8c2hhcmVkYWRkeSkoXGJ8XykvaSwNCiAgICBuZXh0TGluazogLyhuZXh0fHdlaXRlcnxjb250aW51ZXw+KFteXHxdfCQpfMK7KFteXHxdfCQpKS9pLA0KICAgIHByZXZMaW5rOiAvKHByZXZ8ZWFybHxvbGR8bmV3fDx8wqspL2ksDQogICAgd2hpdGVzcGFjZTogL15ccyokLywNCiAgICBoYXNDb250ZW50OiAvXFMkLywNCiAgfSwNCg0KICBESVZfVE9fUF9FTEVNUzogWyAiQSIsICJCTE9DS1FVT1RFIiwgIkRMIiwgIkRJViIsICJJTUciLCAiT0wiLCAiUCIsICJQUkUiLCAiVEFCTEUiLCAiVUwiLCAiU0VMRUNUIiBdLA0KDQogIEFMVEVSX1RPX0RJVl9FWENFUFRJT05TOiBbIkRJViIsICJBUlRJQ0xFIiwgIlNFQ1RJT04iLCAiUCJdLA0KDQogIFBSRVNFTlRBVElPTkFMX0FUVFJJQlVURVM6IFsgImFsaWduIiwgImJhY2tncm91bmQiLCAiYmdjb2xvciIsICJib3JkZXIiLCAiY2VsbHBhZGRpbmciLCAiY2VsbHNwYWNpbmciLCAiZnJhbWUiLCAiaHNwYWNlIiwgInJ1bGVzIiwgInN0eWxlIiwgInZhbGlnbiIsICJ2c3BhY2UiIF0sDQoNCiAgREVQUkVDQVRFRF9TSVpFX0FUVFJJQlVURV9FTEVNUzogWyAiVEFCTEUiLCAiVEgiLCAiVEQiLCAiSFIiLCAiUFJFIiBdLA0KDQogIC8vIFRoZSBjb21tZW50ZWQgb3V0IGVsZW1lbnRzIHF1YWxpZnkgYXMgcGhyYXNpbmcgY29udGVudCBidXQgdGVuZCB0byBiZQ0KICAvLyByZW1vdmVkIGJ5IHJlYWRhYmlsaXR5IHdoZW4gcHV0IGludG8gcGFyYWdyYXBocywgc28gd2UgaWdub3JlIHRoZW0gaGVyZS4NCiAgUEhSQVNJTkdfRUxFTVM6IFsNCiAgICAvLyAiQ0FOVkFTIiwgIklGUkFNRSIsICJTVkciLCAiVklERU8iLA0KICAgICJBQkJSIiwgIkFVRElPIiwgIkIiLCAiQkRPIiwgIkJSIiwgIkJVVFRPTiIsICJDSVRFIiwgIkNPREUiLCAiREFUQSIsDQogICAgIkRBVEFMSVNUIiwgIkRGTiIsICJFTSIsICJFTUJFRCIsICJJIiwgIklNRyIsICJJTlBVVCIsICJLQkQiLCAiTEFCRUwiLA0KICAgICJNQVJLIiwgIk1BVEgiLCAiTUVURVIiLCAiTk9TQ1JJUFQiLCAiT0JKRUNUIiwgIk9VVFBVVCIsICJQUk9HUkVTUyIsICJRIiwNCiAgICAiUlVCWSIsICJTQU1QIiwgIlNDUklQVCIsICJTRUxFQ1QiLCAiU01BTEwiLCAiU1BBTiIsICJTVFJPTkciLCAiU1VCIiwNCiAgICAiU1VQIiwgIlRFWFRBUkVBIiwgIlRJTUUiLCAiVkFSIiwgIldCUiINCiAgXSwNCg0KICAvLyBUaGVzZSBhcmUgdGhlIGNsYXNzZXMgdGhhdCByZWFkYWJpbGl0eSBzZXRzIGl0c2VsZi4NCiAgQ0xBU1NFU19UT19QUkVTRVJWRTogWyAicGFnZSIgXSwNCg0KICAvKioNCiAgICogUnVuIGFueSBwb3N0LXByb2Nlc3MgbW9kaWZpY2F0aW9ucyB0byBhcnRpY2xlIGNvbnRlbnQgYXMgbmVjZXNzYXJ5Lg0KICAgKg0KICAgKiBAcGFyYW0gRWxlbWVudA0KICAgKiBAcmV0dXJuIHZvaWQNCiAgKiovDQogIF9wb3N0UHJvY2Vzc0NvbnRlbnQ6IGZ1bmN0aW9uKGFydGljbGVDb250ZW50KSB7DQogICAgLy8gUmVhZGFiaWxpdHkgY2Fubm90IG9wZW4gcmVsYXRpdmUgdXJpcyBzbyB3ZSBjb252ZXJ0IHRoZW0gdG8gYWJzb2x1dGUgdXJpcy4NCiAgICB0aGlzLl9maXhSZWxhdGl2ZVVyaXMoYXJ0aWNsZUNvbnRlbnQpOw0KDQogICAgaWYgKCF0aGlzLl9rZWVwQ2xhc3Nlcykgew0KICAgICAgLy8gUmVtb3ZlIGNsYXNzZXMuDQogICAgICB0aGlzLl9jbGVhbkNsYXNzZXMoYXJ0aWNsZUNvbnRlbnQpOw0KICAgIH0NCiAgfSwNCg0KICAvKioNCiAgICogSXRlcmF0ZXMgb3ZlciBhIE5vZGVMaXN0LCBjYWxscyBgZmlsdGVyRm5gIGZvciBlYWNoIG5vZGUgYW5kIHJlbW92ZXMgbm9kZQ0KICAgKiBpZiBmdW5jdGlvbiByZXR1cm5lZCBgdHJ1ZWAuDQogICAqDQogICAqIElmIGZ1bmN0aW9uIGlzIG5vdCBwYXNzZWQsIHJlbW92ZXMgYWxsIHRoZSBub2RlcyBpbiBub2RlIGxpc3QuDQogICAqDQogICAqIEBwYXJhbSBOb2RlTGlzdCBub2RlTGlzdCBUaGUgbm9kZXMgdG8gb3BlcmF0ZSBvbg0KICAgKiBAcGFyYW0gRnVuY3Rpb24gZmlsdGVyRm4gdGhlIGZ1bmN0aW9uIHRvIHVzZSBhcyBhIGZpbHRlcg0KICAgKiBAcmV0dXJuIHZvaWQNCiAgICovDQogIF9yZW1vdmVOb2RlczogZnVuY3Rpb24obm9kZUxpc3QsIGZpbHRlckZuKSB7DQogICAgZm9yICh2YXIgaSA9IG5vZGVMaXN0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7DQogICAgICB2YXIgbm9kZSA9IG5vZGVMaXN0W2ldOw0KICAgICAgdmFyIHBhcmVudE5vZGUgPSBub2RlLnBhcmVudE5vZGU7DQogICAgICBpZiAocGFyZW50Tm9kZSkgew0KICAgICAgICBpZiAoIWZpbHRlckZuIHx8IGZpbHRlckZuLmNhbGwodGhpcywgbm9kZSwgaSwgbm9kZUxpc3QpKSB7DQogICAgICAgICAgcGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfSwNCg0KICAvKioNCiAgICogSXRlcmF0ZXMgb3ZlciBhIE5vZGVMaXN0LCBhbmQgY2FsbHMgX3NldE5vZGVUYWcgZm9yIGVhY2ggbm9kZS4NCiAgICoNCiAgICogQHBhcmFtIE5vZGVMaXN0IG5vZGVMaXN0IFRoZSBub2RlcyB0byBvcGVyYXRlIG9uDQogICAqIEBwYXJhbSBTdHJpbmcgbmV3VGFnTmFtZSB0aGUgbmV3IHRhZyBuYW1lIHRvIHVzZQ0KICAgKiBAcmV0dXJuIHZvaWQNCiAgICovDQogIF9yZXBsYWNlTm9kZVRhZ3M6IGZ1bmN0aW9uKG5vZGVMaXN0LCBuZXdUYWdOYW1lKSB7DQogICAgZm9yICh2YXIgaSA9IG5vZGVMaXN0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7DQogICAgICB2YXIgbm9kZSA9IG5vZGVMaXN0W2ldOw0KICAgICAgdGhpcy5fc2V0Tm9kZVRhZyhub2RlLCBuZXdUYWdOYW1lKTsNCiAgICB9DQogIH0sDQoNCiAgLyoqDQogICAqIEl0ZXJhdGUgb3ZlciBhIE5vZGVMaXN0LCB3aGljaCBkb2Vzbid0IG5hdGl2ZWx5IGZ1bGx5IGltcGxlbWVudCB0aGUgQXJyYXkNCiAgICogaW50ZXJmYWNlLg0KICAgKg0KICAgKiBGb3IgY29udmVuaWVuY2UsIHRoZSBjdXJyZW50IG9iamVjdCBjb250ZXh0IGlzIGFwcGxpZWQgdG8gdGhlIHByb3ZpZGVkDQogICAqIGl0ZXJhdGUgZnVuY3Rpb24uDQogICAqDQogICAqIEBwYXJhbSAgTm9kZUxpc3Qgbm9kZUxpc3QgVGhlIE5vZGVMaXN0Lg0KICAgKiBAcGFyYW0gIEZ1bmN0aW9uIGZuICAgICAgIFRoZSBpdGVyYXRlIGZ1bmN0aW9uLg0KICAgKiBAcmV0dXJuIHZvaWQNCiAgICovDQogIF9mb3JFYWNoTm9kZTogZnVuY3Rpb24obm9kZUxpc3QsIGZuKSB7DQogICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChub2RlTGlzdCwgZm4sIHRoaXMpOw0KICB9LA0KDQogIC8qKg0KICAgKiBJdGVyYXRlIG92ZXIgYSBOb2RlTGlzdCwgcmV0dXJuIHRydWUgaWYgYW55IG9mIHRoZSBwcm92aWRlZCBpdGVyYXRlDQogICAqIGZ1bmN0aW9uIGNhbGxzIHJldHVybnMgdHJ1ZSwgZmFsc2Ugb3RoZXJ3aXNlLg0KICAgKg0KICAgKiBGb3IgY29udmVuaWVuY2UsIHRoZSBjdXJyZW50IG9iamVjdCBjb250ZXh0IGlzIGFwcGxpZWQgdG8gdGhlDQogICAqIHByb3ZpZGVkIGl0ZXJhdGUgZnVuY3Rpb24uDQogICAqDQogICAqIEBwYXJhbSAgTm9kZUxpc3Qgbm9kZUxpc3QgVGhlIE5vZGVMaXN0Lg0KICAgKiBAcGFyYW0gIEZ1bmN0aW9uIGZuICAgICAgIFRoZSBpdGVyYXRlIGZ1bmN0aW9uLg0KICAgKiBAcmV0dXJuIEJvb2xlYW4NCiAgICovDQogIF9zb21lTm9kZTogZnVuY3Rpb24obm9kZUxpc3QsIGZuKSB7DQogICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zb21lLmNhbGwobm9kZUxpc3QsIGZuLCB0aGlzKTsNCiAgfSwNCg0KICAvKioNCiAgICogSXRlcmF0ZSBvdmVyIGEgTm9kZUxpc3QsIHJldHVybiB0cnVlIGlmIGFsbCBvZiB0aGUgcHJvdmlkZWQgaXRlcmF0ZQ0KICAgKiBmdW5jdGlvbiBjYWxscyByZXR1cm4gdHJ1ZSwgZmFsc2Ugb3RoZXJ3aXNlLg0KICAgKg0KICAgKiBGb3IgY29udmVuaWVuY2UsIHRoZSBjdXJyZW50IG9iamVjdCBjb250ZXh0IGlzIGFwcGxpZWQgdG8gdGhlDQogICAqIHByb3ZpZGVkIGl0ZXJhdGUgZnVuY3Rpb24uDQogICAqDQogICAqIEBwYXJhbSAgTm9kZUxpc3Qgbm9kZUxpc3QgVGhlIE5vZGVMaXN0Lg0KICAgKiBAcGFyYW0gIEZ1bmN0aW9uIGZuICAgICAgIFRoZSBpdGVyYXRlIGZ1bmN0aW9uLg0KICAgKiBAcmV0dXJuIEJvb2xlYW4NCiAgICovDQogIF9ldmVyeU5vZGU6IGZ1bmN0aW9uKG5vZGVMaXN0LCBmbikgew0KICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuZXZlcnkuY2FsbChub2RlTGlzdCwgZm4sIHRoaXMpOw0KICB9LA0KDQogIC8qKg0KICAgKiBDb25jYXQgYWxsIG5vZGVsaXN0cyBwYXNzZWQgYXMgYXJndW1lbnRzLg0KICAgKg0KICAgKiBAcmV0dXJuIC4uLk5vZGVMaXN0DQogICAqIEByZXR1cm4gQXJyYXkNCiAgICovDQogIF9jb25jYXROb2RlTGlzdHM6IGZ1bmN0aW9uKCkgew0KICAgIHZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTsNCiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzKTsNCiAgICB2YXIgbm9kZUxpc3RzID0gYXJncy5tYXAoZnVuY3Rpb24obGlzdCkgew0KICAgICAgcmV0dXJuIHNsaWNlLmNhbGwobGlzdCk7DQogICAgfSk7DQogICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoW10sIG5vZGVMaXN0cyk7DQogIH0sDQoNCiAgX2dldEFsbE5vZGVzV2l0aFRhZzogZnVuY3Rpb24obm9kZSwgdGFnTmFtZXMpIHsNCiAgICBpZiAobm9kZS5xdWVyeVNlbGVjdG9yQWxsKSB7DQogICAgICByZXR1cm4gbm9kZS5xdWVyeVNlbGVjdG9yQWxsKHRhZ05hbWVzLmpvaW4oIiwiKSk7DQogICAgfQ0KICAgIHJldHVybiBbXS5jb25jYXQuYXBwbHkoW10sIHRhZ05hbWVzLm1hcChmdW5jdGlvbih0YWcpIHsNCiAgICAgIHZhciBjb2xsZWN0aW9uID0gbm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWcpOw0KICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoY29sbGVjdGlvbikgPyBjb2xsZWN0aW9uIDogQXJyYXkuZnJvbShjb2xsZWN0aW9uKTsNCiAgICB9KSk7DQogIH0sDQoNCiAgLyoqDQogICAqIFJlbW92ZXMgdGhlIGNsYXNzPSIiIGF0dHJpYnV0ZSBmcm9tIGV2ZXJ5IGVsZW1lbnQgaW4gdGhlIGdpdmVuDQogICAqIHN1YnRyZWUsIGV4Y2VwdCB0aG9zZSB0aGF0IG1hdGNoIENMQVNTRVNfVE9fUFJFU0VSVkUgYW5kDQogICAqIHRoZSBjbGFzc2VzVG9QcmVzZXJ2ZSBhcnJheSBmcm9tIHRoZSBvcHRpb25zIG9iamVjdC4NCiAgICoNCiAgICogQHBhcmFtIEVsZW1lbnQNCiAgICogQHJldHVybiB2b2lkDQogICAqLw0KICBfY2xlYW5DbGFzc2VzOiBmdW5jdGlvbihub2RlKSB7DQogICAgdmFyIGNsYXNzZXNUb1ByZXNlcnZlID0gdGhpcy5fY2xhc3Nlc1RvUHJlc2VydmU7DQogICAgdmFyIGNsYXNzTmFtZSA9IChub2RlLmdldEF0dHJpYnV0ZSgiY2xhc3MiKSB8fCAiIikNCiAgICAgIC5zcGxpdCgvXHMrLykNCiAgICAgIC5maWx0ZXIoZnVuY3Rpb24oY2xzKSB7DQogICAgICAgIHJldHVybiBjbGFzc2VzVG9QcmVzZXJ2ZS5pbmRleE9mKGNscykgIT0gLTE7DQogICAgICB9KQ0KICAgICAgLmpvaW4oIiAiKTsNCg0KICAgIGlmIChjbGFzc05hbWUpIHsNCiAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCJjbGFzcyIsIGNsYXNzTmFtZSk7DQogICAgfSBlbHNlIHsNCiAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKCJjbGFzcyIpOw0KICAgIH0NCg0KICAgIGZvciAobm9kZSA9IG5vZGUuZmlyc3RFbGVtZW50Q2hpbGQ7IG5vZGU7IG5vZGUgPSBub2RlLm5leHRFbGVtZW50U2libGluZykgew0KICAgICAgdGhpcy5fY2xlYW5DbGFzc2VzKG5vZGUpOw0KICAgIH0NCiAgfSwNCg0KICAvKioNCiAgICogQ29udmVydHMgZWFjaCA8YT4gYW5kIDxpbWc+IHVyaSBpbiB0aGUgZ2l2ZW4gZWxlbWVudCB0byBhbiBhYnNvbHV0ZSBVUkksDQogICAqIGlnbm9yaW5nICNyZWYgVVJJcy4NCiAgICoNCiAgICogQHBhcmFtIEVsZW1lbnQNCiAgICogQHJldHVybiB2b2lkDQogICAqLw0KICBfZml4UmVsYXRpdmVVcmlzOiBmdW5jdGlvbihhcnRpY2xlQ29udGVudCkgew0KICAgIHZhciBiYXNlVVJJID0gdGhpcy5fZG9jLmJhc2VVUkk7DQogICAgdmFyIGRvY3VtZW50VVJJID0gdGhpcy5fZG9jLmRvY3VtZW50VVJJOw0KICAgIGZ1bmN0aW9uIHRvQWJzb2x1dGVVUkkodXJpKSB7DQogICAgICAvLyBMZWF2ZSBoYXNoIGxpbmtzIGFsb25lIGlmIHRoZSBiYXNlIFVSSSBtYXRjaGVzIHRoZSBkb2N1bWVudCBVUkk6DQogICAgICBpZiAoYmFzZVVSSSA9PSBkb2N1bWVudFVSSSAmJiB1cmkuY2hhckF0KDApID09ICIjIikgew0KICAgICAgICByZXR1cm4gdXJpOw0KICAgICAgfQ0KICAgICAgLy8gT3RoZXJ3aXNlLCByZXNvbHZlIGFnYWluc3QgYmFzZSBVUkk6DQogICAgICB0cnkgew0KICAgICAgICByZXR1cm4gbmV3IFVSTCh1cmksIGJhc2VVUkkpLmhyZWY7DQogICAgICB9IGNhdGNoIChleCkgew0KICAgICAgICAvLyBTb21ldGhpbmcgd2VudCB3cm9uZywganVzdCByZXR1cm4gdGhlIG9yaWdpbmFsOg0KICAgICAgfQ0KICAgICAgcmV0dXJuIHVyaTsNCiAgICB9DQoNCiAgICB2YXIgbGlua3MgPSB0aGlzLl9nZXRBbGxOb2Rlc1dpdGhUYWcoYXJ0aWNsZUNvbnRlbnQsIFsiYSJdKTsNCiAgICB0aGlzLl9mb3JFYWNoTm9kZShsaW5rcywgZnVuY3Rpb24obGluaykgew0KICAgICAgdmFyIGhyZWYgPSBsaW5rLmdldEF0dHJpYnV0ZSgiaHJlZiIpOw0KICAgICAgaWYgKGhyZWYpIHsNCiAgICAgICAgLy8gUmVwbGFjZSBsaW5rcyB3aXRoIGphdmFzY3JpcHQ6IFVSSXMgd2l0aCB0ZXh0IGNvbnRlbnQsIHNpbmNlDQogICAgICAgIC8vIHRoZXkgd29uJ3Qgd29yayBhZnRlciBzY3JpcHRzIGhhdmUgYmVlbiByZW1vdmVkIGZyb20gdGhlIHBhZ2UuDQogICAgICAgIGlmIChocmVmLmluZGV4T2YoImphdmFzY3JpcHQ6IikgPT09IDApIHsNCiAgICAgICAgICB2YXIgdGV4dCA9IHRoaXMuX2RvYy5jcmVhdGVUZXh0Tm9kZShsaW5rLnRleHRDb250ZW50KTsNCiAgICAgICAgICBsaW5rLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHRleHQsIGxpbmspOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCJocmVmIiwgdG9BYnNvbHV0ZVVSSShocmVmKSk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9KTsNCg0KICAgIHZhciBpbWdzID0gdGhpcy5fZ2V0QWxsTm9kZXNXaXRoVGFnKGFydGljbGVDb250ZW50LCBbImltZyJdKTsNCiAgICB0aGlzLl9mb3JFYWNoTm9kZShpbWdzLCBmdW5jdGlvbihpbWcpIHsNCiAgICAgIHZhciBzcmMgPSBpbWcuZ2V0QXR0cmlidXRlKCJzcmMiKTsNCiAgICAgIGlmIChzcmMpIHsNCiAgICAgICAgaW1nLnNldEF0dHJpYnV0ZSgic3JjIiwgdG9BYnNvbHV0ZVVSSShzcmMpKTsNCiAgICAgIH0NCiAgICB9KTsNCiAgfSwNCg0KICAvKioNCiAgICogR2V0IHRoZSBhcnRpY2xlIHRpdGxlIGFzIGFuIEgxLg0KICAgKg0KICAgKiBAcmV0dXJuIHZvaWQNCiAgICoqLw0KICBfZ2V0QXJ0aWNsZVRpdGxlOiBmdW5jdGlvbigpIHsNCiAgICB2YXIgZG9jID0gdGhpcy5fZG9jOw0KICAgIHZhciBjdXJUaXRsZSA9ICIiOw0KICAgIHZhciBvcmlnVGl0bGUgPSAiIjsNCg0KICAgIHRyeSB7DQogICAgICBjdXJUaXRsZSA9IG9yaWdUaXRsZSA9IGRvYy50aXRsZS50cmltKCk7DQoNCiAgICAgIC8vIElmIHRoZXkgaGFkIGFuIGVsZW1lbnQgd2l0aCBpZCAidGl0bGUiIGluIHRoZWlyIEhUTUwNCiAgICAgIGlmICh0eXBlb2YgY3VyVGl0bGUgIT09ICJzdHJpbmciKQ0KICAgICAgICBjdXJUaXRsZSA9IG9yaWdUaXRsZSA9IHRoaXMuX2dldElubmVyVGV4dChkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRpdGxlIilbMF0pOw0KICAgIH0gY2F0Y2ggKGUpIHsvKiBpZ25vcmUgZXhjZXB0aW9ucyBzZXR0aW5nIHRoZSB0aXRsZS4gKi99DQoNCiAgICB2YXIgdGl0bGVIYWRIaWVyYXJjaGljYWxTZXBhcmF0b3JzID0gZmFsc2U7DQogICAgZnVuY3Rpb24gd29yZENvdW50KHN0cikgew0KICAgICAgcmV0dXJuIHN0ci5zcGxpdCgvXHMrLykubGVuZ3RoOw0KICAgIH0NCg0KICAgIC8vIElmIHRoZXJlJ3MgYSBzZXBhcmF0b3IgaW4gdGhlIHRpdGxlLCBmaXJzdCByZW1vdmUgdGhlIGZpbmFsIHBhcnQNCiAgICBpZiAoKC8gW1x8XC1cXFwvPsK7XSAvKS50ZXN0KGN1clRpdGxlKSkgew0KICAgICAgdGl0bGVIYWRIaWVyYXJjaGljYWxTZXBhcmF0b3JzID0gLyBbXFxcLz7Cu10gLy50ZXN0KGN1clRpdGxlKTsNCiAgICAgIGN1clRpdGxlID0gb3JpZ1RpdGxlLnJlcGxhY2UoLyguKilbXHxcLVxcXC8+wrtdIC4qL2dpLCAiJDEiKTsNCg0KICAgICAgLy8gSWYgdGhlIHJlc3VsdGluZyB0aXRsZSBpcyB0b28gc2hvcnQgKDMgd29yZHMgb3IgZmV3ZXIpLCByZW1vdmUNCiAgICAgIC8vIHRoZSBmaXJzdCBwYXJ0IGluc3RlYWQ6DQogICAgICBpZiAod29yZENvdW50KGN1clRpdGxlKSA8IDMpDQogICAgICAgIGN1clRpdGxlID0gb3JpZ1RpdGxlLnJlcGxhY2UoL1teXHxcLVxcXC8+wrtdKltcfFwtXFxcLz7Cu10oLiopL2dpLCAiJDEiKTsNCiAgICB9IGVsc2UgaWYgKGN1clRpdGxlLmluZGV4T2YoIjogIikgIT09IC0xKSB7DQogICAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGFuIGhlYWRpbmcgY29udGFpbmluZyB0aGlzIGV4YWN0IHN0cmluZywgc28gd2UNCiAgICAgIC8vIGNvdWxkIGFzc3VtZSBpdCdzIHRoZSBmdWxsIHRpdGxlLg0KICAgICAgdmFyIGhlYWRpbmdzID0gdGhpcy5fY29uY2F0Tm9kZUxpc3RzKA0KICAgICAgICBkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImgxIiksDQogICAgICAgIGRvYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaDIiKQ0KICAgICAgKTsNCiAgICAgIHZhciB0cmltbWVkVGl0bGUgPSBjdXJUaXRsZS50cmltKCk7DQogICAgICB2YXIgbWF0Y2ggPSB0aGlzLl9zb21lTm9kZShoZWFkaW5ncywgZnVuY3Rpb24oaGVhZGluZykgew0KICAgICAgICByZXR1cm4gaGVhZGluZy50ZXh0Q29udGVudC50cmltKCkgPT09IHRyaW1tZWRUaXRsZTsNCiAgICAgIH0pOw0KDQogICAgICAvLyBJZiB3ZSBkb24ndCwgbGV0J3MgZXh0cmFjdCB0aGUgdGl0bGUgb3V0IG9mIHRoZSBvcmlnaW5hbCB0aXRsZSBzdHJpbmcuDQogICAgICBpZiAoIW1hdGNoKSB7DQogICAgICAgIGN1clRpdGxlID0gb3JpZ1RpdGxlLnN1YnN0cmluZyhvcmlnVGl0bGUubGFzdEluZGV4T2YoIjoiKSArIDEpOw0KDQogICAgICAgIC8vIElmIHRoZSB0aXRsZSBpcyBub3cgdG9vIHNob3J0LCB0cnkgdGhlIGZpcnN0IGNvbG9uIGluc3RlYWQ6DQogICAgICAgIGlmICh3b3JkQ291bnQoY3VyVGl0bGUpIDwgMykgew0KICAgICAgICAgIGN1clRpdGxlID0gb3JpZ1RpdGxlLnN1YnN0cmluZyhvcmlnVGl0bGUuaW5kZXhPZigiOiIpICsgMSk7DQogICAgICAgICAgLy8gQnV0IGlmIHdlIGhhdmUgdG9vIG1hbnkgd29yZHMgYmVmb3JlIHRoZSBjb2xvbiB0aGVyZSdzIHNvbWV0aGluZyB3ZWlyZA0KICAgICAgICAgIC8vIHdpdGggdGhlIHRpdGxlcyBhbmQgdGhlIEggdGFncyBzbyBsZXQncyBqdXN0IHVzZSB0aGUgb3JpZ2luYWwgdGl0bGUgaW5zdGVhZA0KICAgICAgICB9IGVsc2UgaWYgKHdvcmRDb3VudChvcmlnVGl0bGUuc3Vic3RyKDAsIG9yaWdUaXRsZS5pbmRleE9mKCI6IikpKSA+IDUpIHsNCiAgICAgICAgICBjdXJUaXRsZSA9IG9yaWdUaXRsZTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0gZWxzZSBpZiAoY3VyVGl0bGUubGVuZ3RoID4gMTUwIHx8IGN1clRpdGxlLmxlbmd0aCA8IDE1KSB7DQogICAgICB2YXIgaE9uZXMgPSBkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImgxIik7DQoNCiAgICAgIGlmIChoT25lcy5sZW5ndGggPT09IDEpDQogICAgICAgIGN1clRpdGxlID0gdGhpcy5fZ2V0SW5uZXJUZXh0KGhPbmVzWzBdKTsNCiAgICB9DQoNCiAgICBjdXJUaXRsZSA9IGN1clRpdGxlLnRyaW0oKS5yZXBsYWNlKHRoaXMuUkVHRVhQUy5ub3JtYWxpemUsICIgIik7DQogICAgLy8gSWYgd2Ugbm93IGhhdmUgNCB3b3JkcyBvciBmZXdlciBhcyBvdXIgdGl0bGUsIGFuZCBlaXRoZXIgbm8NCiAgICAvLyAnaGllcmFyY2hpY2FsJyBzZXBhcmF0b3JzIChcLCAvLCA+IG9yIMK7KSB3ZXJlIGZvdW5kIGluIHRoZSBvcmlnaW5hbA0KICAgIC8vIHRpdGxlIG9yIHdlIGRlY3JlYXNlZCB0aGUgbnVtYmVyIG9mIHdvcmRzIGJ5IG1vcmUgdGhhbiAxIHdvcmQsIHVzZQ0KICAgIC8vIHRoZSBvcmlnaW5hbCB0aXRsZS4NCiAgICB2YXIgY3VyVGl0bGVXb3JkQ291bnQgPSB3b3JkQ291bnQoY3VyVGl0bGUpOw0KICAgIGlmIChjdXJUaXRsZVdvcmRDb3VudCA8PSA0ICYmDQogICAgICAgICghdGl0bGVIYWRIaWVyYXJjaGljYWxTZXBhcmF0b3JzIHx8DQogICAgICAgICBjdXJUaXRsZVdvcmRDb3VudCAhPSB3b3JkQ291bnQob3JpZ1RpdGxlLnJlcGxhY2UoL1tcfFwtXFxcLz7Cu10rL2csICIiKSkgLSAxKSkgew0KICAgICAgY3VyVGl0bGUgPSBvcmlnVGl0bGU7DQogICAgfQ0KDQogICAgcmV0dXJuIGN1clRpdGxlOw0KICB9LA0KDQogIC8qKg0KICAgKiBQcmVwYXJlIHRoZSBIVE1MIGRvY3VtZW50IGZvciByZWFkYWJpbGl0eSB0byBzY3JhcGUgaXQuDQogICAqIFRoaXMgaW5jbHVkZXMgdGhpbmdzIGxpa2Ugc3RyaXBwaW5nIGphdmFzY3JpcHQsIENTUywgYW5kIGhhbmRsaW5nIHRlcnJpYmxlIG1hcmt1cC4NCiAgICoNCiAgICogQHJldHVybiB2b2lkDQogICAqKi8NCiAgX3ByZXBEb2N1bWVudDogZnVuY3Rpb24oKSB7DQogICAgdmFyIGRvYyA9IHRoaXMuX2RvYzsNCg0KICAgIC8vIFJlbW92ZSBhbGwgc3R5bGUgdGFncyBpbiBoZWFkDQogICAgdGhpcy5fcmVtb3ZlTm9kZXMoZG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzdHlsZSIpKTsNCg0KICAgIGlmIChkb2MuYm9keSkgew0KICAgICAgdGhpcy5fcmVwbGFjZUJycyhkb2MuYm9keSk7DQogICAgfQ0KDQogICAgdGhpcy5fcmVwbGFjZU5vZGVUYWdzKGRvYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiZm9udCIpLCAiU1BBTiIpOw0KICB9LA0KDQogIC8qKg0KICAgKiBGaW5kcyB0aGUgbmV4dCBlbGVtZW50LCBzdGFydGluZyBmcm9tIHRoZSBnaXZlbiBub2RlLCBhbmQgaWdub3JpbmcNCiAgICogd2hpdGVzcGFjZSBpbiBiZXR3ZWVuLiBJZiB0aGUgZ2l2ZW4gbm9kZSBpcyBhbiBlbGVtZW50LCB0aGUgc2FtZSBub2RlIGlzDQogICAqIHJldHVybmVkLg0KICAgKi8NCiAgX25leHRFbGVtZW50OiBmdW5jdGlvbiAobm9kZSkgew0KICAgIHZhciBuZXh0ID0gbm9kZTsNCiAgICB3aGlsZSAobmV4dA0KICAgICAgICAmJiAobmV4dC5ub2RlVHlwZSAhPSB0aGlzLkVMRU1FTlRfTk9ERSkNCiAgICAgICAgJiYgdGhpcy5SRUdFWFBTLndoaXRlc3BhY2UudGVzdChuZXh0LnRleHRDb250ZW50KSkgew0KICAgICAgbmV4dCA9IG5leHQubmV4dFNpYmxpbmc7DQogICAgfQ0KICAgIHJldHVybiBuZXh0Ow0KICB9LA0KDQogIC8qKg0KICAgKiBSZXBsYWNlcyAyIG9yIG1vcmUgc3VjY2Vzc2l2ZSA8YnI+IGVsZW1lbnRzIHdpdGggYSBzaW5nbGUgPHA+Lg0KICAgKiBXaGl0ZXNwYWNlIGJldHdlZW4gPGJyPiBlbGVtZW50cyBhcmUgaWdub3JlZC4gRm9yIGV4YW1wbGU6DQogICAqICAgPGRpdj5mb288YnI+YmFyPGJyPiA8YnI+PGJyPmFiYzwvZGl2Pg0KICAgKiB3aWxsIGJlY29tZToNCiAgICogICA8ZGl2PmZvbzxicj5iYXI8cD5hYmM8L3A+PC9kaXY+DQogICAqLw0KICBfcmVwbGFjZUJyczogZnVuY3Rpb24gKGVsZW0pIHsNCiAgICB0aGlzLl9mb3JFYWNoTm9kZSh0aGlzLl9nZXRBbGxOb2Rlc1dpdGhUYWcoZWxlbSwgWyJiciJdKSwgZnVuY3Rpb24oYnIpIHsNCiAgICAgIHZhciBuZXh0ID0gYnIubmV4dFNpYmxpbmc7DQoNCiAgICAgIC8vIFdoZXRoZXIgMiBvciBtb3JlIDxicj4gZWxlbWVudHMgaGF2ZSBiZWVuIGZvdW5kIGFuZCByZXBsYWNlZCB3aXRoIGENCiAgICAgIC8vIDxwPiBibG9jay4NCiAgICAgIHZhciByZXBsYWNlZCA9IGZhbHNlOw0KDQogICAgICAvLyBJZiB3ZSBmaW5kIGEgPGJyPiBjaGFpbiwgcmVtb3ZlIHRoZSA8YnI+cyB1bnRpbCB3ZSBoaXQgYW5vdGhlciBlbGVtZW50DQogICAgICAvLyBvciBub24td2hpdGVzcGFjZS4gVGhpcyBsZWF2ZXMgYmVoaW5kIHRoZSBmaXJzdCA8YnI+IGluIHRoZSBjaGFpbg0KICAgICAgLy8gKHdoaWNoIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIDxwPiBsYXRlcikuDQogICAgICB3aGlsZSAoKG5leHQgPSB0aGlzLl9uZXh0RWxlbWVudChuZXh0KSkgJiYgKG5leHQudGFnTmFtZSA9PSAiQlIiKSkgew0KICAgICAgICByZXBsYWNlZCA9IHRydWU7DQogICAgICAgIHZhciBiclNpYmxpbmcgPSBuZXh0Lm5leHRTaWJsaW5nOw0KICAgICAgICBuZXh0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobmV4dCk7DQogICAgICAgIG5leHQgPSBiclNpYmxpbmc7DQogICAgICB9DQoNCiAgICAgIC8vIElmIHdlIHJlbW92ZWQgYSA8YnI+IGNoYWluLCByZXBsYWNlIHRoZSByZW1haW5pbmcgPGJyPiB3aXRoIGEgPHA+LiBBZGQNCiAgICAgIC8vIGFsbCBzaWJsaW5nIG5vZGVzIGFzIGNoaWxkcmVuIG9mIHRoZSA8cD4gdW50aWwgd2UgaGl0IGFub3RoZXIgPGJyPg0KICAgICAgLy8gY2hhaW4uDQogICAgICBpZiAocmVwbGFjZWQpIHsNCiAgICAgICAgdmFyIHAgPSB0aGlzLl9kb2MuY3JlYXRlRWxlbWVudCgicCIpOw0KICAgICAgICBici5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChwLCBicik7DQoNCiAgICAgICAgbmV4dCA9IHAubmV4dFNpYmxpbmc7DQogICAgICAgIHdoaWxlIChuZXh0KSB7DQogICAgICAgICAgLy8gSWYgd2UndmUgaGl0IGFub3RoZXIgPGJyPjxicj4sIHdlJ3JlIGRvbmUgYWRkaW5nIGNoaWxkcmVuIHRvIHRoaXMgPHA+Lg0KICAgICAgICAgIGlmIChuZXh0LnRhZ05hbWUgPT0gIkJSIikgew0KICAgICAgICAgICAgdmFyIG5leHRFbGVtID0gdGhpcy5fbmV4dEVsZW1lbnQobmV4dC5uZXh0U2libGluZyk7DQogICAgICAgICAgICBpZiAobmV4dEVsZW0gJiYgbmV4dEVsZW0udGFnTmFtZSA9PSAiQlIiKQ0KICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBpZiAoIXRoaXMuX2lzUGhyYXNpbmdDb250ZW50KG5leHQpKQ0KICAgICAgICAgICAgYnJlYWs7DQoNCiAgICAgICAgICAvLyBPdGhlcndpc2UsIG1ha2UgdGhpcyBub2RlIGEgY2hpbGQgb2YgdGhlIG5ldyA8cD4uDQogICAgICAgICAgdmFyIHNpYmxpbmcgPSBuZXh0Lm5leHRTaWJsaW5nOw0KICAgICAgICAgIHAuYXBwZW5kQ2hpbGQobmV4dCk7DQogICAgICAgICAgbmV4dCA9IHNpYmxpbmc7DQogICAgICAgIH0NCg0KICAgICAgICB3aGlsZSAocC5sYXN0Q2hpbGQgJiYgdGhpcy5faXNXaGl0ZXNwYWNlKHAubGFzdENoaWxkKSkgew0KICAgICAgICAgIHAucmVtb3ZlQ2hpbGQocC5sYXN0Q2hpbGQpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHAucGFyZW50Tm9kZS50YWdOYW1lID09PSAiUCIpDQogICAgICAgICAgdGhpcy5fc2V0Tm9kZVRhZyhwLnBhcmVudE5vZGUsICJESVYiKTsNCiAgICAgIH0NCiAgICB9KTsNCiAgfSwNCg0KICBfc2V0Tm9kZVRhZzogZnVuY3Rpb24gKG5vZGUsIHRhZykgew0KICAgIHRoaXMubG9nKCJfc2V0Tm9kZVRhZyIsIG5vZGUsIHRhZyk7DQogICAgaWYgKG5vZGUuX19KU0RPTVBhcnNlcl9fKSB7DQogICAgICBub2RlLmxvY2FsTmFtZSA9IHRhZy50b0xvd2VyQ2FzZSgpOw0KICAgICAgbm9kZS50YWdOYW1lID0gdGFnLnRvVXBwZXJDYXNlKCk7DQogICAgICByZXR1cm4gbm9kZTsNCiAgICB9DQoNCiAgICB2YXIgcmVwbGFjZW1lbnQgPSBub2RlLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpOw0KICAgIHdoaWxlIChub2RlLmZpcnN0Q2hpbGQpIHsNCiAgICAgIHJlcGxhY2VtZW50LmFwcGVuZENoaWxkKG5vZGUuZmlyc3RDaGlsZCk7DQogICAgfQ0KICAgIG5vZGUucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQocmVwbGFjZW1lbnQsIG5vZGUpOw0KICAgIGlmIChub2RlLnJlYWRhYmlsaXR5KQ0KICAgICAgcmVwbGFjZW1lbnQucmVhZGFiaWxpdHkgPSBub2RlLnJlYWRhYmlsaXR5Ow0KDQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgIHRyeSB7DQogICAgICAgIHJlcGxhY2VtZW50LnNldEF0dHJpYnV0ZShub2RlLmF0dHJpYnV0ZXNbaV0ubmFtZSwgbm9kZS5hdHRyaWJ1dGVzW2ldLnZhbHVlKTsNCiAgICAgIH0gY2F0Y2ggKGV4KSB7DQogICAgICAgIC8qIGl0J3MgcG9zc2libGUgZm9yIHNldEF0dHJpYnV0ZSgpIHRvIHRocm93IGlmIHRoZSBhdHRyaWJ1dGUgbmFtZQ0KICAgICAgICAgKiBpc24ndCBhIHZhbGlkIFhNTCBOYW1lLiBTdWNoIGF0dHJpYnV0ZXMgY2FuIGhvd2V2ZXIgYmUgcGFyc2VkIGZyb20NCiAgICAgICAgICogc291cmNlIGluIEhUTUwgZG9jcywgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93aGF0d2cvaHRtbC9pc3N1ZXMvNDI3NSwNCiAgICAgICAgICogc28gd2UgY2FuIGhpdCB0aGVtIGhlcmUgYW5kIHRoZW4gdGhyb3cuIFdlIGRvbid0IGNhcmUgYWJvdXQgc3VjaA0KICAgICAgICAgKiBhdHRyaWJ1dGVzIHNvIHdlIGlnbm9yZSB0aGVtLg0KICAgICAgICAgKi8NCiAgICAgIH0NCiAgICB9DQogICAgcmV0dXJuIHJlcGxhY2VtZW50Ow0KICB9LA0KDQogIC8qKg0KICAgKiBQcmVwYXJlIHRoZSBhcnRpY2xlIG5vZGUgZm9yIGRpc3BsYXkuIENsZWFuIG91dCBhbnkgaW5saW5lIHN0eWxlcywNCiAgICogaWZyYW1lcywgZm9ybXMsIHN0cmlwIGV4dHJhbmVvdXMgPHA+IHRhZ3MsIGV0Yy4NCiAgICoNCiAgICogQHBhcmFtIEVsZW1lbnQNCiAgICogQHJldHVybiB2b2lkDQogICAqKi8NCiAgX3ByZXBBcnRpY2xlOiBmdW5jdGlvbihhcnRpY2xlQ29udGVudCkgew0KICAgIHRoaXMuX2NsZWFuU3R5bGVzKGFydGljbGVDb250ZW50KTsNCg0KICAgIC8vIENoZWNrIGZvciBkYXRhIHRhYmxlcyBiZWZvcmUgd2UgY29udGludWUsIHRvIGF2b2lkIHJlbW92aW5nIGl0ZW1zIGluDQogICAgLy8gdGhvc2UgdGFibGVzLCB3aGljaCB3aWxsIG9mdGVuIGJlIGlzb2xhdGVkIGV2ZW4gdGhvdWdoIHRoZXkncmUNCiAgICAvLyB2aXN1YWxseSBsaW5rZWQgdG8gb3RoZXIgY29udGVudC1mdWwgZWxlbWVudHMgKHRleHQsIGltYWdlcywgZXRjLikuDQogICAgdGhpcy5fbWFya0RhdGFUYWJsZXMoYXJ0aWNsZUNvbnRlbnQpOw0KDQogICAgdGhpcy5fZml4TGF6eUltYWdlcyhhcnRpY2xlQ29udGVudCk7DQoNCiAgICAvLyBDbGVhbiBvdXQganVuayBmcm9tIHRoZSBhcnRpY2xlIGNvbnRlbnQNCiAgICB0aGlzLl9jbGVhbkNvbmRpdGlvbmFsbHkoYXJ0aWNsZUNvbnRlbnQsICJmb3JtIik7DQogICAgdGhpcy5fY2xlYW5Db25kaXRpb25hbGx5KGFydGljbGVDb250ZW50LCAiZmllbGRzZXQiKTsNCiAgICB0aGlzLl9jbGVhbihhcnRpY2xlQ29udGVudCwgIm9iamVjdCIpOw0KICAgIHRoaXMuX2NsZWFuKGFydGljbGVDb250ZW50LCAiZW1iZWQiKTsNCiAgICB0aGlzLl9jbGVhbihhcnRpY2xlQ29udGVudCwgImgxIik7DQogICAgdGhpcy5fY2xlYW4oYXJ0aWNsZUNvbnRlbnQsICJmb290ZXIiKTsNCiAgICB0aGlzLl9jbGVhbihhcnRpY2xlQ29udGVudCwgImxpbmsiKTsNCiAgICB0aGlzLl9jbGVhbihhcnRpY2xlQ29udGVudCwgImFzaWRlIik7DQoNCiAgICAvLyBDbGVhbiBvdXQgZWxlbWVudHMgd2l0aCBsaXR0bGUgY29udGVudCB0aGF0IGhhdmUgInNoYXJlIiBpbiB0aGVpciBpZC9jbGFzcyBjb21iaW5hdGlvbnMgZnJvbSBmaW5hbCB0b3AgY2FuZGlkYXRlcywNCiAgICAvLyB3aGljaCBtZWFucyB3ZSBkb24ndCByZW1vdmUgdGhlIHRvcCBjYW5kaWRhdGVzIGV2ZW4gdGhleSBoYXZlICJzaGFyZSIuDQoNCiAgICB2YXIgc2hhcmVFbGVtZW50VGhyZXNob2xkID0gdGhpcy5ERUZBVUxUX0NIQVJfVEhSRVNIT0xEOw0KDQogICAgdGhpcy5fZm9yRWFjaE5vZGUoYXJ0aWNsZUNvbnRlbnQuY2hpbGRyZW4sIGZ1bmN0aW9uICh0b3BDYW5kaWRhdGUpIHsNCiAgICAgIHRoaXMuX2NsZWFuTWF0Y2hlZE5vZGVzKHRvcENhbmRpZGF0ZSwgZnVuY3Rpb24gKG5vZGUsIG1hdGNoU3RyaW5nKSB7DQogICAgICAgIHJldHVybiB0aGlzLlJFR0VYUFMuc2hhcmVFbGVtZW50cy50ZXN0KG1hdGNoU3RyaW5nKSAmJiBub2RlLnRleHRDb250ZW50Lmxlbmd0aCA8IHNoYXJlRWxlbWVudFRocmVzaG9sZDsNCiAgICAgIH0pOw0KICAgIH0pOw0KDQogICAgLy8gSWYgdGhlcmUgaXMgb25seSBvbmUgaDIgYW5kIGl0cyB0ZXh0IGNvbnRlbnQgc3Vic3RhbnRpYWxseSBlcXVhbHMgYXJ0aWNsZSB0aXRsZSwNCiAgICAvLyB0aGV5IGFyZSBwcm9iYWJseSB1c2luZyBpdCBhcyBhIGhlYWRlciBhbmQgbm90IGEgc3ViaGVhZGVyLA0KICAgIC8vIHNvIHJlbW92ZSBpdCBzaW5jZSB3ZSBhbHJlYWR5IGV4dHJhY3QgdGhlIHRpdGxlIHNlcGFyYXRlbHkuDQogICAgdmFyIGgyID0gYXJ0aWNsZUNvbnRlbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImgyIik7DQogICAgaWYgKGgyLmxlbmd0aCA9PT0gMSkgew0KICAgICAgdmFyIGxlbmd0aFNpbWlsYXJSYXRlID0gKGgyWzBdLnRleHRDb250ZW50Lmxlbmd0aCAtIHRoaXMuX2FydGljbGVUaXRsZS5sZW5ndGgpIC8gdGhpcy5fYXJ0aWNsZVRpdGxlLmxlbmd0aDsNCiAgICAgIGlmIChNYXRoLmFicyhsZW5ndGhTaW1pbGFyUmF0ZSkgPCAwLjUpIHsNCiAgICAgICAgdmFyIHRpdGxlc01hdGNoID0gZmFsc2U7DQogICAgICAgIGlmIChsZW5ndGhTaW1pbGFyUmF0ZSA+IDApIHsNCiAgICAgICAgICB0aXRsZXNNYXRjaCA9IGgyWzBdLnRleHRDb250ZW50LmluY2x1ZGVzKHRoaXMuX2FydGljbGVUaXRsZSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGl0bGVzTWF0Y2ggPSB0aGlzLl9hcnRpY2xlVGl0bGUuaW5jbHVkZXMoaDJbMF0udGV4dENvbnRlbnQpOw0KICAgICAgICB9DQogICAgICAgIGlmICh0aXRsZXNNYXRjaCkgew0KICAgICAgICAgIHRoaXMuX2NsZWFuKGFydGljbGVDb250ZW50LCAiaDIiKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCg0KICAgIHRoaXMuX2NsZWFuKGFydGljbGVDb250ZW50LCAiaWZyYW1lIik7DQogICAgdGhpcy5fY2xlYW4oYXJ0aWNsZUNvbnRlbnQsICJpbnB1dCIpOw0KICAgIHRoaXMuX2NsZWFuKGFydGljbGVDb250ZW50LCAidGV4dGFyZWEiKTsNCiAgICB0aGlzLl9jbGVhbihhcnRpY2xlQ29udGVudCwgInNlbGVjdCIpOw0KICAgIHRoaXMuX2NsZWFuKGFydGljbGVDb250ZW50LCAiYnV0dG9uIik7DQogICAgdGhpcy5fY2xlYW5IZWFkZXJzKGFydGljbGVDb250ZW50KTsNCg0KICAgIC8vIERvIHRoZXNlIGxhc3QgYXMgdGhlIHByZXZpb3VzIHN0dWZmIG1heSBoYXZlIHJlbW92ZWQganVuaw0KICAgIC8vIHRoYXQgd2lsbCBhZmZlY3QgdGhlc2UNCiAgICB0aGlzLl9jbGVhbkNvbmRpdGlvbmFsbHkoYXJ0aWNsZUNvbnRlbnQsICJ0YWJsZSIpOw0KICAgIHRoaXMuX2NsZWFuQ29uZGl0aW9uYWxseShhcnRpY2xlQ29udGVudCwgInVsIik7DQogICAgdGhpcy5fY2xlYW5Db25kaXRpb25hbGx5KGFydGljbGVDb250ZW50LCAiZGl2Iik7DQoNCiAgICAvLyBSZW1vdmUgZXh0cmEgcGFyYWdyYXBocw0KICAgIHRoaXMuX3JlbW92ZU5vZGVzKGFydGljbGVDb250ZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJwIiksIGZ1bmN0aW9uIChwYXJhZ3JhcGgpIHsNCiAgICAgIHZhciBpbWdDb3VudCA9IHBhcmFncmFwaC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaW1nIikubGVuZ3RoOw0KICAgICAgdmFyIGVtYmVkQ291bnQgPSBwYXJhZ3JhcGguZ2V0RWxlbWVudHNCeVRhZ05hbWUoImVtYmVkIikubGVuZ3RoOw0KICAgICAgdmFyIG9iamVjdENvdW50ID0gcGFyYWdyYXBoLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJvYmplY3QiKS5sZW5ndGg7DQogICAgICAvLyBBdCB0aGlzIHBvaW50LCBuYXN0eSBpZnJhbWVzIGhhdmUgYmVlbiByZW1vdmVkLCBvbmx5IHJlbWFpbiBlbWJlZGRlZCB2aWRlbyBvbmVzLg0KICAgICAgdmFyIGlmcmFtZUNvdW50ID0gcGFyYWdyYXBoLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJpZnJhbWUiKS5sZW5ndGg7DQogICAgICB2YXIgdG90YWxDb3VudCA9IGltZ0NvdW50ICsgZW1iZWRDb3VudCArIG9iamVjdENvdW50ICsgaWZyYW1lQ291bnQ7DQoNCiAgICAgIHJldHVybiB0b3RhbENvdW50ID09PSAwICYmICF0aGlzLl9nZXRJbm5lclRleHQocGFyYWdyYXBoLCBmYWxzZSk7DQogICAgfSk7DQoNCiAgICB0aGlzLl9mb3JFYWNoTm9kZSh0aGlzLl9nZXRBbGxOb2Rlc1dpdGhUYWcoYXJ0aWNsZUNvbnRlbnQsIFsiYnIiXSksIGZ1bmN0aW9uKGJyKSB7DQogICAgICB2YXIgbmV4dCA9IHRoaXMuX25leHRFbGVtZW50KGJyLm5leHRTaWJsaW5nKTsNCiAgICAgIGlmIChuZXh0ICYmIG5leHQudGFnTmFtZSA9PSAiUCIpDQogICAgICAgIGJyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYnIpOw0KICAgIH0pOw0KDQogICAgLy8gUmVtb3ZlIHNpbmdsZS1jZWxsIHRhYmxlcw0KICAgIHRoaXMuX2ZvckVhY2hOb2RlKHRoaXMuX2dldEFsbE5vZGVzV2l0aFRhZyhhcnRpY2xlQ29udGVudCwgWyJ0YWJsZSJdKSwgZnVuY3Rpb24odGFibGUpIHsNCiAgICAgIHZhciB0Ym9keSA9IHRoaXMuX2hhc1NpbmdsZVRhZ0luc2lkZUVsZW1lbnQodGFibGUsICJUQk9EWSIpID8gdGFibGUuZmlyc3RFbGVtZW50Q2hpbGQgOiB0YWJsZTsNCiAgICAgIGlmICh0aGlzLl9oYXNTaW5nbGVUYWdJbnNpZGVFbGVtZW50KHRib2R5LCAiVFIiKSkgew0KICAgICAgICB2YXIgcm93ID0gdGJvZHkuZmlyc3RFbGVtZW50Q2hpbGQ7DQogICAgICAgIGlmICh0aGlzLl9oYXNTaW5nbGVUYWdJbnNpZGVFbGVtZW50KHJvdywgIlREIikpIHsNCiAgICAgICAgICB2YXIgY2VsbCA9IHJvdy5maXJzdEVsZW1lbnRDaGlsZDsNCiAgICAgICAgICBjZWxsID0gdGhpcy5fc2V0Tm9kZVRhZyhjZWxsLCB0aGlzLl9ldmVyeU5vZGUoY2VsbC5jaGlsZE5vZGVzLCB0aGlzLl9pc1BocmFzaW5nQ29udGVudCkgPyAiUCIgOiAiRElWIik7DQogICAgICAgICAgdGFibGUucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoY2VsbCwgdGFibGUpOw0KICAgICAgICB9DQogICAgICB9DQogICAgfSk7DQogIH0sDQoNCiAgLyoqDQogICAqIEluaXRpYWxpemUgYSBub2RlIHdpdGggdGhlIHJlYWRhYmlsaXR5IG9iamVjdC4gQWxzbyBjaGVja3MgdGhlDQogICAqIGNsYXNzTmFtZS9pZCBmb3Igc3BlY2lhbCBuYW1lcyB0byBhZGQgdG8gaXRzIHNjb3JlLg0KICAgKg0KICAgKiBAcGFyYW0gRWxlbWVudA0KICAgKiBAcmV0dXJuIHZvaWQNCiAgKiovDQogIF9pbml0aWFsaXplTm9kZTogZnVuY3Rpb24obm9kZSkgew0KICAgIG5vZGUucmVhZGFiaWxpdHkgPSB7ImNvbnRlbnRTY29yZSI6IDB9Ow0KDQogICAgc3dpdGNoIChub2RlLnRhZ05hbWUpIHsNCiAgICAgIGNhc2UgIkRJViI6DQogICAgICAgIG5vZGUucmVhZGFiaWxpdHkuY29udGVudFNjb3JlICs9IDU7DQogICAgICAgIGJyZWFrOw0KDQogICAgICBjYXNlICJQUkUiOg0KICAgICAgY2FzZSAiVEQiOg0KICAgICAgY2FzZSAiQkxPQ0tRVU9URSI6DQogICAgICAgIG5vZGUucmVhZGFiaWxpdHkuY29udGVudFNjb3JlICs9IDM7DQogICAgICAgIGJyZWFrOw0KDQogICAgICBjYXNlICJBRERSRVNTIjoNCiAgICAgIGNhc2UgIk9MIjoNCiAgICAgIGNhc2UgIlVMIjoNCiAgICAgIGNhc2UgIkRMIjoNCiAgICAgIGNhc2UgIkREIjoNCiAgICAgIGNhc2UgIkRUIjoNCiAgICAgIGNhc2UgIkxJIjoNCiAgICAgIGNhc2UgIkZPUk0iOg0KICAgICAgICBub2RlLnJlYWRhYmlsaXR5LmNvbnRlbnRTY29yZSAtPSAzOw0KICAgICAgICBicmVhazsNCg0KICAgICAgY2FzZSAiSDEiOg0KICAgICAgY2FzZSAiSDIiOg0KICAgICAgY2FzZSAiSDMiOg0KICAgICAgY2FzZSAiSDQiOg0KICAgICAgY2FzZSAiSDUiOg0KICAgICAgY2FzZSAiSDYiOg0KICAgICAgY2FzZSAiVEgiOg0KICAgICAgICBub2RlLnJlYWRhYmlsaXR5LmNvbnRlbnRTY29yZSAtPSA1Ow0KICAgICAgICBicmVhazsNCiAgICB9DQoNCiAgICBub2RlLnJlYWRhYmlsaXR5LmNvbnRlbnRTY29yZSArPSB0aGlzLl9nZXRDbGFzc1dlaWdodChub2RlKTsNCiAgfSwNCg0KICBfcmVtb3ZlQW5kR2V0TmV4dDogZnVuY3Rpb24obm9kZSkgew0KICAgIHZhciBuZXh0Tm9kZSA9IHRoaXMuX2dldE5leHROb2RlKG5vZGUsIHRydWUpOw0KICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTsNCiAgICByZXR1cm4gbmV4dE5vZGU7DQogIH0sDQoNCiAgLyoqDQogICAqIFRyYXZlcnNlIHRoZSBET00gZnJvbSBub2RlIHRvIG5vZGUsIHN0YXJ0aW5nIGF0IHRoZSBub2RlIHBhc3NlZCBpbi4NCiAgICogUGFzcyB0cnVlIGZvciB0aGUgc2Vjb25kIHBhcmFtZXRlciB0byBpbmRpY2F0ZSB0aGlzIG5vZGUgaXRzZWxmDQogICAqIChhbmQgaXRzIGtpZHMpIGFyZSBnb2luZyBhd2F5LCBhbmQgd2Ugd2FudCB0aGUgbmV4dCBub2RlIG92ZXIuDQogICAqDQogICAqIENhbGxpbmcgdGhpcyBpbiBhIGxvb3Agd2lsbCB0cmF2ZXJzZSB0aGUgRE9NIGRlcHRoLWZpcnN0Lg0KICAgKi8NCiAgX2dldE5leHROb2RlOiBmdW5jdGlvbihub2RlLCBpZ25vcmVTZWxmQW5kS2lkcykgew0KICAgIC8vIEZpcnN0IGNoZWNrIGZvciBraWRzIGlmIHRob3NlIGFyZW4ndCBiZWluZyBpZ25vcmVkDQogICAgaWYgKCFpZ25vcmVTZWxmQW5kS2lkcyAmJiBub2RlLmZpcnN0RWxlbWVudENoaWxkKSB7DQogICAgICByZXR1cm4gbm9kZS5maXJzdEVsZW1lbnRDaGlsZDsNCiAgICB9DQogICAgLy8gVGhlbiBmb3Igc2libGluZ3MuLi4NCiAgICBpZiAobm9kZS5uZXh0RWxlbWVudFNpYmxpbmcpIHsNCiAgICAgIHJldHVybiBub2RlLm5leHRFbGVtZW50U2libGluZzsNCiAgICB9DQogICAgLy8gQW5kIGZpbmFsbHksIG1vdmUgdXAgdGhlIHBhcmVudCBjaGFpbiAqYW5kKiBmaW5kIGEgc2libGluZw0KICAgIC8vIChiZWNhdXNlIHRoaXMgaXMgZGVwdGgtZmlyc3QgdHJhdmVyc2FsLCB3ZSB3aWxsIGhhdmUgYWxyZWFkeQ0KICAgIC8vIHNlZW4gdGhlIHBhcmVudCBub2RlcyB0aGVtc2VsdmVzKS4NCiAgICBkbyB7DQogICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlOw0KICAgIH0gd2hpbGUgKG5vZGUgJiYgIW5vZGUubmV4dEVsZW1lbnRTaWJsaW5nKTsNCiAgICByZXR1cm4gbm9kZSAmJiBub2RlLm5leHRFbGVtZW50U2libGluZzsNCiAgfSwNCg0KICBfY2hlY2tCeWxpbmU6IGZ1bmN0aW9uKG5vZGUsIG1hdGNoU3RyaW5nKSB7DQogICAgaWYgKHRoaXMuX2FydGljbGVCeWxpbmUpIHsNCiAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICBpZiAobm9kZS5nZXRBdHRyaWJ1dGUgIT09IHVuZGVmaW5lZCkgew0KICAgICAgdmFyIHJlbCA9IG5vZGUuZ2V0QXR0cmlidXRlKCJyZWwiKTsNCiAgICAgIHZhciBpdGVtcHJvcCA9IG5vZGUuZ2V0QXR0cmlidXRlKCJpdGVtcHJvcCIpOw0KICAgIH0NCg0KICAgIGlmICgocmVsID09PSAiYXV0aG9yIiB8fCAoaXRlbXByb3AgJiYgaXRlbXByb3AuaW5kZXhPZigiYXV0aG9yIikgIT09IC0xKSB8fCB0aGlzLlJFR0VYUFMuYnlsaW5lLnRlc3QobWF0Y2hTdHJpbmcpKSAmJiB0aGlzLl9pc1ZhbGlkQnlsaW5lKG5vZGUudGV4dENvbnRlbnQpKSB7DQogICAgICB0aGlzLl9hcnRpY2xlQnlsaW5lID0gbm9kZS50ZXh0Q29udGVudC50cmltKCk7DQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICByZXR1cm4gZmFsc2U7DQogIH0sDQoNCiAgX2dldE5vZGVBbmNlc3RvcnM6IGZ1bmN0aW9uKG5vZGUsIG1heERlcHRoKSB7DQogICAgbWF4RGVwdGggPSBtYXhEZXB0aCB8fCAwOw0KICAgIHZhciBpID0gMCwgYW5jZXN0b3JzID0gW107DQogICAgd2hpbGUgKG5vZGUucGFyZW50Tm9kZSkgew0KICAgICAgYW5jZXN0b3JzLnB1c2gobm9kZS5wYXJlbnROb2RlKTsNCiAgICAgIGlmIChtYXhEZXB0aCAmJiArK2kgPT09IG1heERlcHRoKQ0KICAgICAgICBicmVhazsNCiAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7DQogICAgfQ0KICAgIHJldHVybiBhbmNlc3RvcnM7DQogIH0sDQoNCiAgLyoqKg0KICAgKiBncmFiQXJ0aWNsZSAtIFVzaW5nIGEgdmFyaWV0eSBvZiBtZXRyaWNzIChjb250ZW50IHNjb3JlLCBjbGFzc25hbWUsIGVsZW1lbnQgdHlwZXMpLCBmaW5kIHRoZSBjb250ZW50IHRoYXQgaXMNCiAgICogICAgICAgICBtb3N0IGxpa2VseSB0byBiZSB0aGUgc3R1ZmYgYSB1c2VyIHdhbnRzIHRvIHJlYWQuIFRoZW4gcmV0dXJuIGl0IHdyYXBwZWQgdXAgaW4gYSBkaXYuDQogICAqDQogICAqIEBwYXJhbSBwYWdlIGEgZG9jdW1lbnQgdG8gcnVuIHVwb24uIE5lZWRzIHRvIGJlIGEgZnVsbCBkb2N1bWVudCwgY29tcGxldGUgd2l0aCBib2R5Lg0KICAgKiBAcmV0dXJuIEVsZW1lbnQNCiAgKiovDQogIF9ncmFiQXJ0aWNsZTogZnVuY3Rpb24gKHBhZ2UpIHsNCiAgICB0aGlzLmxvZygiKioqKiBncmFiQXJ0aWNsZSAqKioqIik7DQogICAgdmFyIGRvYyA9IHRoaXMuX2RvYzsNCiAgICB2YXIgaXNQYWdpbmcgPSAocGFnZSAhPT0gbnVsbCA/IHRydWU6IGZhbHNlKTsNCiAgICBwYWdlID0gcGFnZSA/IHBhZ2UgOiB0aGlzLl9kb2MuYm9keTsNCg0KICAgIC8vIFdlIGNhbid0IGdyYWIgYW4gYXJ0aWNsZSBpZiB3ZSBkb24ndCBoYXZlIGEgcGFnZSENCiAgICBpZiAoIXBhZ2UpIHsNCiAgICAgIHRoaXMubG9nKCJObyBib2R5IGZvdW5kIGluIGRvY3VtZW50LiBBYm9ydC4iKTsNCiAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCg0KICAgIHZhciBwYWdlQ2FjaGVIdG1sID0gcGFnZS5pbm5lckhUTUw7DQoNCiAgICB3aGlsZSAodHJ1ZSkgew0KICAgICAgdmFyIHN0cmlwVW5saWtlbHlDYW5kaWRhdGVzID0gdGhpcy5fZmxhZ0lzQWN0aXZlKHRoaXMuRkxBR19TVFJJUF9VTkxJS0VMWVMpOw0KDQogICAgICAvLyBGaXJzdCwgbm9kZSBwcmVwcGluZy4gVHJhc2ggbm9kZXMgdGhhdCBsb29rIGNydWRkeSAobGlrZSBvbmVzIHdpdGggdGhlDQogICAgICAvLyBjbGFzcyBuYW1lICJjb21tZW50IiwgZXRjKSwgYW5kIHR1cm4gZGl2cyBpbnRvIFAgdGFncyB3aGVyZSB0aGV5IGhhdmUgYmVlbg0KICAgICAgLy8gdXNlZCBpbmFwcHJvcHJpYXRlbHkgKGFzIGluLCB3aGVyZSB0aGV5IGNvbnRhaW4gbm8gb3RoZXIgYmxvY2sgbGV2ZWwgZWxlbWVudHMuKQ0KICAgICAgdmFyIGVsZW1lbnRzVG9TY29yZSA9IFtdOw0KICAgICAgdmFyIG5vZGUgPSB0aGlzLl9kb2MuZG9jdW1lbnRFbGVtZW50Ow0KDQogICAgICB3aGlsZSAobm9kZSkgew0KICAgICAgICB2YXIgbWF0Y2hTdHJpbmcgPSBub2RlLmNsYXNzTmFtZSArICIgIiArIG5vZGUuaWQ7DQoNCiAgICAgICAgaWYgKCF0aGlzLl9pc1Byb2JhYmx5VmlzaWJsZShub2RlKSkgew0KICAgICAgICAgIHRoaXMubG9nKCJSZW1vdmluZyBoaWRkZW4gbm9kZSAtICIgKyBtYXRjaFN0cmluZyk7DQogICAgICAgICAgbm9kZSA9IHRoaXMuX3JlbW92ZUFuZEdldE5leHQobm9kZSk7DQogICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhpcyBub2RlIGlzIGEgYnlsaW5lLCBhbmQgcmVtb3ZlIGl0IGlmIGl0IGlzLg0KICAgICAgICBpZiAodGhpcy5fY2hlY2tCeWxpbmUobm9kZSwgbWF0Y2hTdHJpbmcpKSB7DQogICAgICAgICAgbm9kZSA9IHRoaXMuX3JlbW92ZUFuZEdldE5leHQobm9kZSk7DQogICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBSZW1vdmUgdW5saWtlbHkgY2FuZGlkYXRlcw0KICAgICAgICBpZiAoc3RyaXBVbmxpa2VseUNhbmRpZGF0ZXMpIHsNCiAgICAgICAgICBpZiAodGhpcy5SRUdFWFBTLnVubGlrZWx5Q2FuZGlkYXRlcy50ZXN0KG1hdGNoU3RyaW5nKSAmJg0KICAgICAgICAgICAgICAhdGhpcy5SRUdFWFBTLm9rTWF5YmVJdHNBQ2FuZGlkYXRlLnRlc3QobWF0Y2hTdHJpbmcpICYmDQogICAgICAgICAgICAgICF0aGlzLl9oYXNBbmNlc3RvclRhZyhub2RlLCAidGFibGUiKSAmJg0KICAgICAgICAgICAgICBub2RlLnRhZ05hbWUgIT09ICJCT0RZIiAmJg0KICAgICAgICAgICAgICBub2RlLnRhZ05hbWUgIT09ICJBIikgew0KICAgICAgICAgICAgdGhpcy5sb2coIlJlbW92aW5nIHVubGlrZWx5IGNhbmRpZGF0ZSAtICIgKyBtYXRjaFN0cmluZyk7DQogICAgICAgICAgICBub2RlID0gdGhpcy5fcmVtb3ZlQW5kR2V0TmV4dChub2RlKTsNCiAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFJlbW92ZSBESVYsIFNFQ1RJT04sIGFuZCBIRUFERVIgbm9kZXMgd2l0aG91dCBhbnkgY29udGVudChlLmcuIHRleHQsIGltYWdlLCB2aWRlbywgb3IgaWZyYW1lKS4NCiAgICAgICAgaWYgKChub2RlLnRhZ05hbWUgPT09ICJESVYiIHx8IG5vZGUudGFnTmFtZSA9PT0gIlNFQ1RJT04iIHx8IG5vZGUudGFnTmFtZSA9PT0gIkhFQURFUiIgfHwNCiAgICAgICAgICAgICBub2RlLnRhZ05hbWUgPT09ICJIMSIgfHwgbm9kZS50YWdOYW1lID09PSAiSDIiIHx8IG5vZGUudGFnTmFtZSA9PT0gIkgzIiB8fA0KICAgICAgICAgICAgIG5vZGUudGFnTmFtZSA9PT0gIkg0IiB8fCBub2RlLnRhZ05hbWUgPT09ICJINSIgfHwgbm9kZS50YWdOYW1lID09PSAiSDYiKSAmJg0KICAgICAgICAgICAgdGhpcy5faXNFbGVtZW50V2l0aG91dENvbnRlbnQobm9kZSkpIHsNCiAgICAgICAgICBub2RlID0gdGhpcy5fcmVtb3ZlQW5kR2V0TmV4dChub2RlKTsNCiAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh0aGlzLkRFRkFVTFRfVEFHU19UT19TQ09SRS5pbmRleE9mKG5vZGUudGFnTmFtZSkgIT09IC0xKSB7DQogICAgICAgICAgZWxlbWVudHNUb1Njb3JlLnB1c2gobm9kZSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBUdXJuIGFsbCBkaXZzIHRoYXQgZG9uJ3QgaGF2ZSBjaGlsZHJlbiBibG9jayBsZXZlbCBlbGVtZW50cyBpbnRvIHAncw0KICAgICAgICBpZiAobm9kZS50YWdOYW1lID09PSAiRElWIikgew0KICAgICAgICAgIC8vIFB1dCBwaHJhc2luZyBjb250ZW50IGludG8gcGFyYWdyYXBocy4NCiAgICAgICAgICB2YXIgcCA9IG51bGw7DQogICAgICAgICAgdmFyIGNoaWxkTm9kZSA9IG5vZGUuZmlyc3RDaGlsZDsNCiAgICAgICAgICB3aGlsZSAoY2hpbGROb2RlKSB7DQogICAgICAgICAgICB2YXIgbmV4dFNpYmxpbmcgPSBjaGlsZE5vZGUubmV4dFNpYmxpbmc7DQogICAgICAgICAgICBpZiAodGhpcy5faXNQaHJhc2luZ0NvbnRlbnQoY2hpbGROb2RlKSkgew0KICAgICAgICAgICAgICBpZiAocCAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIHAuYXBwZW5kQ2hpbGQoY2hpbGROb2RlKTsNCiAgICAgICAgICAgICAgfSBlbHNlIGlmICghdGhpcy5faXNXaGl0ZXNwYWNlKGNoaWxkTm9kZSkpIHsNCiAgICAgICAgICAgICAgICBwID0gZG9jLmNyZWF0ZUVsZW1lbnQoInAiKTsNCiAgICAgICAgICAgICAgICBub2RlLnJlcGxhY2VDaGlsZChwLCBjaGlsZE5vZGUpOw0KICAgICAgICAgICAgICAgIHAuYXBwZW5kQ2hpbGQoY2hpbGROb2RlKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIGlmIChwICE9PSBudWxsKSB7DQogICAgICAgICAgICAgIHdoaWxlIChwLmxhc3RDaGlsZCAmJiB0aGlzLl9pc1doaXRlc3BhY2UocC5sYXN0Q2hpbGQpKSB7DQogICAgICAgICAgICAgICAgcC5yZW1vdmVDaGlsZChwLmxhc3RDaGlsZCk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgcCA9IG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjaGlsZE5vZGUgPSBuZXh0U2libGluZzsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvLyBTaXRlcyBsaWtlIGh0dHA6Ly9tb2JpbGUuc2xhdGUuY29tIGVuY2xvc2VzIGVhY2ggcGFyYWdyYXBoIHdpdGggYSBESVYNCiAgICAgICAgICAvLyBlbGVtZW50LiBESVZzIHdpdGggb25seSBhIFAgZWxlbWVudCBpbnNpZGUgYW5kIG5vIHRleHQgY29udGVudCBjYW4gYmUNCiAgICAgICAgICAvLyBzYWZlbHkgY29udmVydGVkIGludG8gcGxhaW4gUCBlbGVtZW50cyB0byBhdm9pZCBjb25mdXNpbmcgdGhlIHNjb3JpbmcNCiAgICAgICAgICAvLyBhbGdvcml0aG0gd2l0aCBESVZzIHdpdGggYXJlLCBpbiBwcmFjdGljZSwgcGFyYWdyYXBocy4NCiAgICAgICAgICBpZiAodGhpcy5faGFzU2luZ2xlVGFnSW5zaWRlRWxlbWVudChub2RlLCAiUCIpICYmIHRoaXMuX2dldExpbmtEZW5zaXR5KG5vZGUpIDwgMC4yNSkgew0KICAgICAgICAgICAgdmFyIG5ld05vZGUgPSBub2RlLmNoaWxkcmVuWzBdOw0KICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChuZXdOb2RlLCBub2RlKTsNCiAgICAgICAgICAgIG5vZGUgPSBuZXdOb2RlOw0KICAgICAgICAgICAgZWxlbWVudHNUb1Njb3JlLnB1c2gobm9kZSk7DQogICAgICAgICAgfSBlbHNlIGlmICghdGhpcy5faGFzQ2hpbGRCbG9ja0VsZW1lbnQobm9kZSkpIHsNCiAgICAgICAgICAgIG5vZGUgPSB0aGlzLl9zZXROb2RlVGFnKG5vZGUsICJQIik7DQogICAgICAgICAgICBlbGVtZW50c1RvU2NvcmUucHVzaChub2RlKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgbm9kZSA9IHRoaXMuX2dldE5leHROb2RlKG5vZGUpOw0KICAgICAgfQ0KDQogICAgICAvKioNCiAgICAgICAqIExvb3AgdGhyb3VnaCBhbGwgcGFyYWdyYXBocywgYW5kIGFzc2lnbiBhIHNjb3JlIHRvIHRoZW0gYmFzZWQgb24gaG93IGNvbnRlbnQteSB0aGV5IGxvb2suDQogICAgICAgKiBUaGVuIGFkZCB0aGVpciBzY29yZSB0byB0aGVpciBwYXJlbnQgbm9kZS4NCiAgICAgICAqDQogICAgICAgKiBBIHNjb3JlIGlzIGRldGVybWluZWQgYnkgdGhpbmdzIGxpa2UgbnVtYmVyIG9mIGNvbW1hcywgY2xhc3MgbmFtZXMsIGV0Yy4gTWF5YmUgZXZlbnR1YWxseSBsaW5rIGRlbnNpdHkuDQogICAgICAqKi8NCiAgICAgIHZhciBjYW5kaWRhdGVzID0gW107DQogICAgICB0aGlzLl9mb3JFYWNoTm9kZShlbGVtZW50c1RvU2NvcmUsIGZ1bmN0aW9uKGVsZW1lbnRUb1Njb3JlKSB7DQogICAgICAgIGlmICghZWxlbWVudFRvU2NvcmUucGFyZW50Tm9kZSB8fCB0eXBlb2YoZWxlbWVudFRvU2NvcmUucGFyZW50Tm9kZS50YWdOYW1lKSA9PT0gInVuZGVmaW5lZCIpDQogICAgICAgICAgcmV0dXJuOw0KDQogICAgICAgIC8vIElmIHRoaXMgcGFyYWdyYXBoIGlzIGxlc3MgdGhhbiAyNSBjaGFyYWN0ZXJzLCBkb24ndCBldmVuIGNvdW50IGl0Lg0KICAgICAgICB2YXIgaW5uZXJUZXh0ID0gdGhpcy5fZ2V0SW5uZXJUZXh0KGVsZW1lbnRUb1Njb3JlKTsNCiAgICAgICAgaWYgKGlubmVyVGV4dC5sZW5ndGggPCAyNSkNCiAgICAgICAgICByZXR1cm47DQoNCiAgICAgICAgLy8gRXhjbHVkZSBub2RlcyB3aXRoIG5vIGFuY2VzdG9yLg0KICAgICAgICB2YXIgYW5jZXN0b3JzID0gdGhpcy5fZ2V0Tm9kZUFuY2VzdG9ycyhlbGVtZW50VG9TY29yZSwgMyk7DQogICAgICAgIGlmIChhbmNlc3RvcnMubGVuZ3RoID09PSAwKQ0KICAgICAgICAgIHJldHVybjsNCg0KICAgICAgICB2YXIgY29udGVudFNjb3JlID0gMDsNCg0KICAgICAgICAvLyBBZGQgYSBwb2ludCBmb3IgdGhlIHBhcmFncmFwaCBpdHNlbGYgYXMgYSBiYXNlLg0KICAgICAgICBjb250ZW50U2NvcmUgKz0gMTsNCg0KICAgICAgICAvLyBBZGQgcG9pbnRzIGZvciBhbnkgY29tbWFzIHdpdGhpbiB0aGlzIHBhcmFncmFwaC4NCiAgICAgICAgY29udGVudFNjb3JlICs9IGlubmVyVGV4dC5zcGxpdCgiLCIpLmxlbmd0aDsNCg0KICAgICAgICAvLyBGb3IgZXZlcnkgMTAwIGNoYXJhY3RlcnMgaW4gdGhpcyBwYXJhZ3JhcGgsIGFkZCBhbm90aGVyIHBvaW50LiBVcCB0byAzIHBvaW50cy4NCiAgICAgICAgY29udGVudFNjb3JlICs9IE1hdGgubWluKE1hdGguZmxvb3IoaW5uZXJUZXh0Lmxlbmd0aCAvIDEwMCksIDMpOw0KDQogICAgICAgIC8vIEluaXRpYWxpemUgYW5kIHNjb3JlIGFuY2VzdG9ycy4NCiAgICAgICAgdGhpcy5fZm9yRWFjaE5vZGUoYW5jZXN0b3JzLCBmdW5jdGlvbihhbmNlc3RvciwgbGV2ZWwpIHsNCiAgICAgICAgICBpZiAoIWFuY2VzdG9yLnRhZ05hbWUgfHwgIWFuY2VzdG9yLnBhcmVudE5vZGUgfHwgdHlwZW9mKGFuY2VzdG9yLnBhcmVudE5vZGUudGFnTmFtZSkgPT09ICJ1bmRlZmluZWQiKQ0KICAgICAgICAgICAgcmV0dXJuOw0KDQogICAgICAgICAgaWYgKHR5cGVvZihhbmNlc3Rvci5yZWFkYWJpbGl0eSkgPT09ICJ1bmRlZmluZWQiKSB7DQogICAgICAgICAgICB0aGlzLl9pbml0aWFsaXplTm9kZShhbmNlc3Rvcik7DQogICAgICAgICAgICBjYW5kaWRhdGVzLnB1c2goYW5jZXN0b3IpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8vIE5vZGUgc2NvcmUgZGl2aWRlcjoNCiAgICAgICAgICAvLyAtIHBhcmVudDogICAgICAgICAgICAgMSAobm8gZGl2aXNpb24pDQogICAgICAgICAgLy8gLSBncmFuZHBhcmVudDogICAgICAgIDINCiAgICAgICAgICAvLyAtIGdyZWF0IGdyYW5kcGFyZW50KzogYW5jZXN0b3IgbGV2ZWwgKiAzDQogICAgICAgICAgaWYgKGxldmVsID09PSAwKQ0KICAgICAgICAgICAgdmFyIHNjb3JlRGl2aWRlciA9IDE7DQogICAgICAgICAgZWxzZSBpZiAobGV2ZWwgPT09IDEpDQogICAgICAgICAgICBzY29yZURpdmlkZXIgPSAyOw0KICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIHNjb3JlRGl2aWRlciA9IGxldmVsICogMzsNCiAgICAgICAgICBhbmNlc3Rvci5yZWFkYWJpbGl0eS5jb250ZW50U2NvcmUgKz0gY29udGVudFNjb3JlIC8gc2NvcmVEaXZpZGVyOw0KICAgICAgICB9KTsNCiAgICAgIH0pOw0KDQogICAgICAvLyBBZnRlciB3ZSd2ZSBjYWxjdWxhdGVkIHNjb3JlcywgbG9vcCB0aHJvdWdoIGFsbCBvZiB0aGUgcG9zc2libGUNCiAgICAgIC8vIGNhbmRpZGF0ZSBub2RlcyB3ZSBmb3VuZCBhbmQgZmluZCB0aGUgb25lIHdpdGggdGhlIGhpZ2hlc3Qgc2NvcmUuDQogICAgICB2YXIgdG9wQ2FuZGlkYXRlcyA9IFtdOw0KICAgICAgZm9yICh2YXIgYyA9IDAsIGNsID0gY2FuZGlkYXRlcy5sZW5ndGg7IGMgPCBjbDsgYyArPSAxKSB7DQogICAgICAgIHZhciBjYW5kaWRhdGUgPSBjYW5kaWRhdGVzW2NdOw0KDQogICAgICAgIC8vIFNjYWxlIHRoZSBmaW5hbCBjYW5kaWRhdGVzIHNjb3JlIGJhc2VkIG9uIGxpbmsgZGVuc2l0eS4gR29vZCBjb250ZW50DQogICAgICAgIC8vIHNob3VsZCBoYXZlIGEgcmVsYXRpdmVseSBzbWFsbCBsaW5rIGRlbnNpdHkgKDUlIG9yIGxlc3MpIGFuZCBiZSBtb3N0bHkNCiAgICAgICAgLy8gdW5hZmZlY3RlZCBieSB0aGlzIG9wZXJhdGlvbi4NCiAgICAgICAgdmFyIGNhbmRpZGF0ZVNjb3JlID0gY2FuZGlkYXRlLnJlYWRhYmlsaXR5LmNvbnRlbnRTY29yZSAqICgxIC0gdGhpcy5fZ2V0TGlua0RlbnNpdHkoY2FuZGlkYXRlKSk7DQogICAgICAgIGNhbmRpZGF0ZS5yZWFkYWJpbGl0eS5jb250ZW50U2NvcmUgPSBjYW5kaWRhdGVTY29yZTsNCg0KICAgICAgICB0aGlzLmxvZygiQ2FuZGlkYXRlOiIsIGNhbmRpZGF0ZSwgIndpdGggc2NvcmUgIiArIGNhbmRpZGF0ZVNjb3JlKTsNCg0KICAgICAgICBmb3IgKHZhciB0ID0gMDsgdCA8IHRoaXMuX25iVG9wQ2FuZGlkYXRlczsgdCsrKSB7DQogICAgICAgICAgdmFyIGFUb3BDYW5kaWRhdGUgPSB0b3BDYW5kaWRhdGVzW3RdOw0KDQogICAgICAgICAgaWYgKCFhVG9wQ2FuZGlkYXRlIHx8IGNhbmRpZGF0ZVNjb3JlID4gYVRvcENhbmRpZGF0ZS5yZWFkYWJpbGl0eS5jb250ZW50U2NvcmUpIHsNCiAgICAgICAgICAgIHRvcENhbmRpZGF0ZXMuc3BsaWNlKHQsIDAsIGNhbmRpZGF0ZSk7DQogICAgICAgICAgICBpZiAodG9wQ2FuZGlkYXRlcy5sZW5ndGggPiB0aGlzLl9uYlRvcENhbmRpZGF0ZXMpDQogICAgICAgICAgICAgIHRvcENhbmRpZGF0ZXMucG9wKCk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgdmFyIHRvcENhbmRpZGF0ZSA9IHRvcENhbmRpZGF0ZXNbMF0gfHwgbnVsbDsNCiAgICAgIHZhciBuZWVkZWRUb0NyZWF0ZVRvcENhbmRpZGF0ZSA9IGZhbHNlOw0KICAgICAgdmFyIHBhcmVudE9mVG9wQ2FuZGlkYXRlOw0KDQogICAgICAvLyBJZiB3ZSBzdGlsbCBoYXZlIG5vIHRvcCBjYW5kaWRhdGUsIGp1c3QgdXNlIHRoZSBib2R5IGFzIGEgbGFzdCByZXNvcnQuDQogICAgICAvLyBXZSBhbHNvIGhhdmUgdG8gY29weSB0aGUgYm9keSBub2RlIHNvIGl0IGlzIHNvbWV0aGluZyB3ZSBjYW4gbW9kaWZ5Lg0KICAgICAgaWYgKHRvcENhbmRpZGF0ZSA9PT0gbnVsbCB8fCB0b3BDYW5kaWRhdGUudGFnTmFtZSA9PT0gIkJPRFkiKSB7DQogICAgICAgIC8vIE1vdmUgYWxsIG9mIHRoZSBwYWdlJ3MgY2hpbGRyZW4gaW50byB0b3BDYW5kaWRhdGUNCiAgICAgICAgdG9wQ2FuZGlkYXRlID0gZG9jLmNyZWF0ZUVsZW1lbnQoIkRJViIpOw0KICAgICAgICBuZWVkZWRUb0NyZWF0ZVRvcENhbmRpZGF0ZSA9IHRydWU7DQogICAgICAgIC8vIE1vdmUgZXZlcnl0aGluZyAobm90IGp1c3QgZWxlbWVudHMsIGFsc28gdGV4dCBub2RlcyBldGMuKSBpbnRvIHRoZSBjb250YWluZXINCiAgICAgICAgLy8gc28gd2UgZXZlbiBpbmNsdWRlIHRleHQgZGlyZWN0bHkgaW4gdGhlIGJvZHk6DQogICAgICAgIHZhciBraWRzID0gcGFnZS5jaGlsZE5vZGVzOw0KICAgICAgICB3aGlsZSAoa2lkcy5sZW5ndGgpIHsNCiAgICAgICAgICB0aGlzLmxvZygiTW92aW5nIGNoaWxkIG91dDoiLCBraWRzWzBdKTsNCiAgICAgICAgICB0b3BDYW5kaWRhdGUuYXBwZW5kQ2hpbGQoa2lkc1swXSk7DQogICAgICAgIH0NCg0KICAgICAgICBwYWdlLmFwcGVuZENoaWxkKHRvcENhbmRpZGF0ZSk7DQoNCiAgICAgICAgdGhpcy5faW5pdGlhbGl6ZU5vZGUodG9wQ2FuZGlkYXRlKTsNCiAgICAgIH0gZWxzZSBpZiAodG9wQ2FuZGlkYXRlKSB7DQogICAgICAgIC8vIEZpbmQgYSBiZXR0ZXIgdG9wIGNhbmRpZGF0ZSBub2RlIGlmIGl0IGNvbnRhaW5zIChhdCBsZWFzdCB0aHJlZSkgbm9kZXMgd2hpY2ggYmVsb25nIHRvIGB0b3BDYW5kaWRhdGVzYCBhcnJheQ0KICAgICAgICAvLyBhbmQgd2hvc2Ugc2NvcmVzIGFyZSBxdWl0ZSBjbG9zZWQgd2l0aCBjdXJyZW50IGB0b3BDYW5kaWRhdGVgIG5vZGUuDQogICAgICAgIHZhciBhbHRlcm5hdGl2ZUNhbmRpZGF0ZUFuY2VzdG9ycyA9IFtdOw0KICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHRvcENhbmRpZGF0ZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICBpZiAodG9wQ2FuZGlkYXRlc1tpXS5yZWFkYWJpbGl0eS5jb250ZW50U2NvcmUgLyB0b3BDYW5kaWRhdGUucmVhZGFiaWxpdHkuY29udGVudFNjb3JlID49IDAuNzUpIHsNCiAgICAgICAgICAgIGFsdGVybmF0aXZlQ2FuZGlkYXRlQW5jZXN0b3JzLnB1c2godGhpcy5fZ2V0Tm9kZUFuY2VzdG9ycyh0b3BDYW5kaWRhdGVzW2ldKSk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHZhciBNSU5JTVVNX1RPUENBTkRJREFURVMgPSAzOw0KICAgICAgICBpZiAoYWx0ZXJuYXRpdmVDYW5kaWRhdGVBbmNlc3RvcnMubGVuZ3RoID49IE1JTklNVU1fVE9QQ0FORElEQVRFUykgew0KICAgICAgICAgIHBhcmVudE9mVG9wQ2FuZGlkYXRlID0gdG9wQ2FuZGlkYXRlLnBhcmVudE5vZGU7DQogICAgICAgICAgd2hpbGUgKHBhcmVudE9mVG9wQ2FuZGlkYXRlLnRhZ05hbWUgIT09ICJCT0RZIikgew0KICAgICAgICAgICAgdmFyIGxpc3RzQ29udGFpbmluZ1RoaXNBbmNlc3RvciA9IDA7DQogICAgICAgICAgICBmb3IgKHZhciBhbmNlc3RvckluZGV4ID0gMDsgYW5jZXN0b3JJbmRleCA8IGFsdGVybmF0aXZlQ2FuZGlkYXRlQW5jZXN0b3JzLmxlbmd0aCAmJiBsaXN0c0NvbnRhaW5pbmdUaGlzQW5jZXN0b3IgPCBNSU5JTVVNX1RPUENBTkRJREFURVM7IGFuY2VzdG9ySW5kZXgrKykgew0KICAgICAgICAgICAgICBsaXN0c0NvbnRhaW5pbmdUaGlzQW5jZXN0b3IgKz0gTnVtYmVyKGFsdGVybmF0aXZlQ2FuZGlkYXRlQW5jZXN0b3JzW2FuY2VzdG9ySW5kZXhdLmluY2x1ZGVzKHBhcmVudE9mVG9wQ2FuZGlkYXRlKSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAobGlzdHNDb250YWluaW5nVGhpc0FuY2VzdG9yID49IE1JTklNVU1fVE9QQ0FORElEQVRFUykgew0KICAgICAgICAgICAgICB0b3BDYW5kaWRhdGUgPSBwYXJlbnRPZlRvcENhbmRpZGF0ZTsNCiAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBwYXJlbnRPZlRvcENhbmRpZGF0ZSA9IHBhcmVudE9mVG9wQ2FuZGlkYXRlLnBhcmVudE5vZGU7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmICghdG9wQ2FuZGlkYXRlLnJlYWRhYmlsaXR5KSB7DQogICAgICAgICAgdGhpcy5faW5pdGlhbGl6ZU5vZGUodG9wQ2FuZGlkYXRlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEJlY2F1c2Ugb2Ygb3VyIGJvbnVzIHN5c3RlbSwgcGFyZW50cyBvZiBjYW5kaWRhdGVzIG1pZ2h0IGhhdmUgc2NvcmVzDQogICAgICAgIC8vIHRoZW1zZWx2ZXMuIFRoZXkgZ2V0IGhhbGYgb2YgdGhlIG5vZGUuIFRoZXJlIHdvbid0IGJlIG5vZGVzIHdpdGggaGlnaGVyDQogICAgICAgIC8vIHNjb3JlcyB0aGFuIG91ciB0b3BDYW5kaWRhdGUsIGJ1dCBpZiB3ZSBzZWUgdGhlIHNjb3JlIGdvaW5nICp1cCogaW4gdGhlIGZpcnN0DQogICAgICAgIC8vIGZldyBzdGVwcyB1cCB0aGUgdHJlZSwgdGhhdCdzIGEgZGVjZW50IHNpZ24gdGhhdCB0aGVyZSBtaWdodCBiZSBtb3JlIGNvbnRlbnQNCiAgICAgICAgLy8gbHVya2luZyBpbiBvdGhlciBwbGFjZXMgdGhhdCB3ZSB3YW50IHRvIHVuaWZ5IGluLiBUaGUgc2libGluZyBzdHVmZg0KICAgICAgICAvLyBiZWxvdyBkb2VzIHNvbWUgb2YgdGhhdCAtIGJ1dCBvbmx5IGlmIHdlJ3ZlIGxvb2tlZCBoaWdoIGVub3VnaCB1cCB0aGUgRE9NDQogICAgICAgIC8vIHRyZWUuDQogICAgICAgIHBhcmVudE9mVG9wQ2FuZGlkYXRlID0gdG9wQ2FuZGlkYXRlLnBhcmVudE5vZGU7DQogICAgICAgIHZhciBsYXN0U2NvcmUgPSB0b3BDYW5kaWRhdGUucmVhZGFiaWxpdHkuY29udGVudFNjb3JlOw0KICAgICAgICAvLyBUaGUgc2NvcmVzIHNob3VsZG4ndCBnZXQgdG9vIGxvdy4NCiAgICAgICAgdmFyIHNjb3JlVGhyZXNob2xkID0gbGFzdFNjb3JlIC8gMzsNCiAgICAgICAgd2hpbGUgKHBhcmVudE9mVG9wQ2FuZGlkYXRlLnRhZ05hbWUgIT09ICJCT0RZIikgew0KICAgICAgICAgIGlmICghcGFyZW50T2ZUb3BDYW5kaWRhdGUucmVhZGFiaWxpdHkpIHsNCiAgICAgICAgICAgIHBhcmVudE9mVG9wQ2FuZGlkYXRlID0gcGFyZW50T2ZUb3BDYW5kaWRhdGUucGFyZW50Tm9kZTsNCiAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgIH0NCiAgICAgICAgICB2YXIgcGFyZW50U2NvcmUgPSBwYXJlbnRPZlRvcENhbmRpZGF0ZS5yZWFkYWJpbGl0eS5jb250ZW50U2NvcmU7DQogICAgICAgICAgaWYgKHBhcmVudFNjb3JlIDwgc2NvcmVUaHJlc2hvbGQpDQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgICBpZiAocGFyZW50U2NvcmUgPiBsYXN0U2NvcmUpIHsNCiAgICAgICAgICAgIC8vIEFscmlnaHQhIFdlIGZvdW5kIGEgYmV0dGVyIHBhcmVudCB0byB1c2UuDQogICAgICAgICAgICB0b3BDYW5kaWRhdGUgPSBwYXJlbnRPZlRvcENhbmRpZGF0ZTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIH0NCiAgICAgICAgICBsYXN0U2NvcmUgPSBwYXJlbnRPZlRvcENhbmRpZGF0ZS5yZWFkYWJpbGl0eS5jb250ZW50U2NvcmU7DQogICAgICAgICAgcGFyZW50T2ZUb3BDYW5kaWRhdGUgPSBwYXJlbnRPZlRvcENhbmRpZGF0ZS5wYXJlbnROb2RlOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gSWYgdGhlIHRvcCBjYW5kaWRhdGUgaXMgdGhlIG9ubHkgY2hpbGQsIHVzZSBwYXJlbnQgaW5zdGVhZC4gVGhpcyB3aWxsIGhlbHAgc2libGluZw0KICAgICAgICAvLyBqb2luaW5nIGxvZ2ljIHdoZW4gYWRqYWNlbnQgY29udGVudCBpcyBhY3R1YWxseSBsb2NhdGVkIGluIHBhcmVudCdzIHNpYmxpbmcgbm9kZS4NCiAgICAgICAgcGFyZW50T2ZUb3BDYW5kaWRhdGUgPSB0b3BDYW5kaWRhdGUucGFyZW50Tm9kZTsNCiAgICAgICAgd2hpbGUgKHBhcmVudE9mVG9wQ2FuZGlkYXRlLnRhZ05hbWUgIT0gIkJPRFkiICYmIHBhcmVudE9mVG9wQ2FuZGlkYXRlLmNoaWxkcmVuLmxlbmd0aCA9PSAxKSB7DQogICAgICAgICAgdG9wQ2FuZGlkYXRlID0gcGFyZW50T2ZUb3BDYW5kaWRhdGU7DQogICAgICAgICAgcGFyZW50T2ZUb3BDYW5kaWRhdGUgPSB0b3BDYW5kaWRhdGUucGFyZW50Tm9kZTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIXRvcENhbmRpZGF0ZS5yZWFkYWJpbGl0eSkgew0KICAgICAgICAgIHRoaXMuX2luaXRpYWxpemVOb2RlKHRvcENhbmRpZGF0ZSk7DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgLy8gTm93IHRoYXQgd2UgaGF2ZSB0aGUgdG9wIGNhbmRpZGF0ZSwgbG9vayB0aHJvdWdoIGl0cyBzaWJsaW5ncyBmb3IgY29udGVudA0KICAgICAgLy8gdGhhdCBtaWdodCBhbHNvIGJlIHJlbGF0ZWQuIFRoaW5ncyBsaWtlIHByZWFtYmxlcywgY29udGVudCBzcGxpdCBieSBhZHMNCiAgICAgIC8vIHRoYXQgd2UgcmVtb3ZlZCwgZXRjLg0KICAgICAgdmFyIGFydGljbGVDb250ZW50ID0gZG9jLmNyZWF0ZUVsZW1lbnQoIkRJViIpOw0KICAgICAgaWYgKGlzUGFnaW5nKQ0KICAgICAgICBhcnRpY2xlQ29udGVudC5pZCA9ICJyZWFkYWJpbGl0eS1jb250ZW50IjsNCg0KICAgICAgdmFyIHNpYmxpbmdTY29yZVRocmVzaG9sZCA9IE1hdGgubWF4KDEwLCB0b3BDYW5kaWRhdGUucmVhZGFiaWxpdHkuY29udGVudFNjb3JlICogMC4yKTsNCiAgICAgIC8vIEtlZXAgcG90ZW50aWFsIHRvcCBjYW5kaWRhdGUncyBwYXJlbnQgbm9kZSB0byB0cnkgdG8gZ2V0IHRleHQgZGlyZWN0aW9uIG9mIGl0IGxhdGVyLg0KICAgICAgcGFyZW50T2ZUb3BDYW5kaWRhdGUgPSB0b3BDYW5kaWRhdGUucGFyZW50Tm9kZTsNCiAgICAgIHZhciBzaWJsaW5ncyA9IHBhcmVudE9mVG9wQ2FuZGlkYXRlLmNoaWxkcmVuOw0KDQogICAgICBmb3IgKHZhciBzID0gMCwgc2wgPSBzaWJsaW5ncy5sZW5ndGg7IHMgPCBzbDsgcysrKSB7DQogICAgICAgIHZhciBzaWJsaW5nID0gc2libGluZ3Nbc107DQogICAgICAgIHZhciBhcHBlbmQgPSBmYWxzZTsNCg0KICAgICAgICB0aGlzLmxvZygiTG9va2luZyBhdCBzaWJsaW5nIG5vZGU6Iiwgc2libGluZywgc2libGluZy5yZWFkYWJpbGl0eSA/ICgid2l0aCBzY29yZSAiICsgc2libGluZy5yZWFkYWJpbGl0eS5jb250ZW50U2NvcmUpIDogIiIpOw0KICAgICAgICB0aGlzLmxvZygiU2libGluZyBoYXMgc2NvcmUiLCBzaWJsaW5nLnJlYWRhYmlsaXR5ID8gc2libGluZy5yZWFkYWJpbGl0eS5jb250ZW50U2NvcmUgOiAiVW5rbm93biIpOw0KDQogICAgICAgIGlmIChzaWJsaW5nID09PSB0b3BDYW5kaWRhdGUpIHsNCiAgICAgICAgICBhcHBlbmQgPSB0cnVlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHZhciBjb250ZW50Qm9udXMgPSAwOw0KDQogICAgICAgICAgLy8gR2l2ZSBhIGJvbnVzIGlmIHNpYmxpbmcgbm9kZXMgYW5kIHRvcCBjYW5kaWRhdGVzIGhhdmUgdGhlIGV4YW1wbGUgc2FtZSBjbGFzc25hbWUNCiAgICAgICAgICBpZiAoc2libGluZy5jbGFzc05hbWUgPT09IHRvcENhbmRpZGF0ZS5jbGFzc05hbWUgJiYgdG9wQ2FuZGlkYXRlLmNsYXNzTmFtZSAhPT0gIiIpDQogICAgICAgICAgICBjb250ZW50Qm9udXMgKz0gdG9wQ2FuZGlkYXRlLnJlYWRhYmlsaXR5LmNvbnRlbnRTY29yZSAqIDAuMjsNCg0KICAgICAgICAgIGlmIChzaWJsaW5nLnJlYWRhYmlsaXR5ICYmDQogICAgICAgICAgICAgICgoc2libGluZy5yZWFkYWJpbGl0eS5jb250ZW50U2NvcmUgKyBjb250ZW50Qm9udXMpID49IHNpYmxpbmdTY29yZVRocmVzaG9sZCkpIHsNCiAgICAgICAgICAgIGFwcGVuZCA9IHRydWU7DQogICAgICAgICAgfSBlbHNlIGlmIChzaWJsaW5nLm5vZGVOYW1lID09PSAiUCIpIHsNCiAgICAgICAgICAgIHZhciBsaW5rRGVuc2l0eSA9IHRoaXMuX2dldExpbmtEZW5zaXR5KHNpYmxpbmcpOw0KICAgICAgICAgICAgdmFyIG5vZGVDb250ZW50ID0gdGhpcy5fZ2V0SW5uZXJUZXh0KHNpYmxpbmcpOw0KICAgICAgICAgICAgdmFyIG5vZGVMZW5ndGggPSBub2RlQ29udGVudC5sZW5ndGg7DQoNCiAgICAgICAgICAgIGlmIChub2RlTGVuZ3RoID4gODAgJiYgbGlua0RlbnNpdHkgPCAwLjI1KSB7DQogICAgICAgICAgICAgIGFwcGVuZCA9IHRydWU7DQogICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGVMZW5ndGggPCA4MCAmJiBub2RlTGVuZ3RoID4gMCAmJiBsaW5rRGVuc2l0eSA9PT0gMCAmJg0KICAgICAgICAgICAgICAgICAgICAgICBub2RlQ29udGVudC5zZWFyY2goL1wuKCB8JCkvKSAhPT0gLTEpIHsNCiAgICAgICAgICAgICAgYXBwZW5kID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoYXBwZW5kKSB7DQogICAgICAgICAgdGhpcy5sb2coIkFwcGVuZGluZyBub2RlOiIsIHNpYmxpbmcpOw0KDQogICAgICAgICAgaWYgKHRoaXMuQUxURVJfVE9fRElWX0VYQ0VQVElPTlMuaW5kZXhPZihzaWJsaW5nLm5vZGVOYW1lKSA9PT0gLTEpIHsNCiAgICAgICAgICAgIC8vIFdlIGhhdmUgYSBub2RlIHRoYXQgaXNuJ3QgYSBjb21tb24gYmxvY2sgbGV2ZWwgZWxlbWVudCwgbGlrZSBhIGZvcm0gb3IgdGQgdGFnLg0KICAgICAgICAgICAgLy8gVHVybiBpdCBpbnRvIGEgZGl2IHNvIGl0IGRvZXNuJ3QgZ2V0IGZpbHRlcmVkIG91dCBsYXRlciBieSBhY2NpZGVudC4NCiAgICAgICAgICAgIHRoaXMubG9nKCJBbHRlcmluZyBzaWJsaW5nOiIsIHNpYmxpbmcsICJ0byBkaXYuIik7DQoNCiAgICAgICAgICAgIHNpYmxpbmcgPSB0aGlzLl9zZXROb2RlVGFnKHNpYmxpbmcsICJESVYiKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBhcnRpY2xlQ29udGVudC5hcHBlbmRDaGlsZChzaWJsaW5nKTsNCiAgICAgICAgICAvLyBzaWJsaW5ncyBpcyBhIHJlZmVyZW5jZSB0byB0aGUgY2hpbGRyZW4gYXJyYXksIGFuZA0KICAgICAgICAgIC8vIHNpYmxpbmcgaXMgcmVtb3ZlZCBmcm9tIHRoZSBhcnJheSB3aGVuIHdlIGNhbGwgYXBwZW5kQ2hpbGQoKS4NCiAgICAgICAgICAvLyBBcyBhIHJlc3VsdCwgd2UgbXVzdCByZXZpc2l0IHRoaXMgaW5kZXggc2luY2UgdGhlIG5vZGVzDQogICAgICAgICAgLy8gaGF2ZSBiZWVuIHNoaWZ0ZWQuDQogICAgICAgICAgcyAtPSAxOw0KICAgICAgICAgIHNsIC09IDE7DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgaWYgKHRoaXMuX2RlYnVnKQ0KICAgICAgICB0aGlzLmxvZygiQXJ0aWNsZSBjb250ZW50IHByZS1wcmVwOiAiICsgYXJ0aWNsZUNvbnRlbnQuaW5uZXJIVE1MKTsNCiAgICAgIC8vIFNvIHdlIGhhdmUgYWxsIG9mIHRoZSBjb250ZW50IHRoYXQgd2UgbmVlZC4gTm93IHdlIGNsZWFuIGl0IHVwIGZvciBwcmVzZW50YXRpb24uDQogICAgICB0aGlzLl9wcmVwQXJ0aWNsZShhcnRpY2xlQ29udGVudCk7DQogICAgICBpZiAodGhpcy5fZGVidWcpDQogICAgICAgIHRoaXMubG9nKCJBcnRpY2xlIGNvbnRlbnQgcG9zdC1wcmVwOiAiICsgYXJ0aWNsZUNvbnRlbnQuaW5uZXJIVE1MKTsNCg0KICAgICAgaWYgKG5lZWRlZFRvQ3JlYXRlVG9wQ2FuZGlkYXRlKSB7DQogICAgICAgIC8vIFdlIGFscmVhZHkgY3JlYXRlZCBhIGZha2UgZGl2IHRoaW5nLCBhbmQgdGhlcmUgd291bGRuJ3QgaGF2ZSBiZWVuIGFueSBzaWJsaW5ncyBsZWZ0DQogICAgICAgIC8vIGZvciB0aGUgcHJldmlvdXMgbG9vcCwgc28gdGhlcmUncyBubyBwb2ludCB0cnlpbmcgdG8gY3JlYXRlIGEgbmV3IGRpdiwgYW5kIHRoZW4NCiAgICAgICAgLy8gbW92ZSBhbGwgdGhlIGNoaWxkcmVuIG92ZXIuIEp1c3QgYXNzaWduIElEcyBhbmQgY2xhc3MgbmFtZXMgaGVyZS4gTm8gbmVlZCB0byBhcHBlbmQNCiAgICAgICAgLy8gYmVjYXVzZSB0aGF0IGFscmVhZHkgaGFwcGVuZWQgYW55d2F5Lg0KICAgICAgICB0b3BDYW5kaWRhdGUuaWQgPSAicmVhZGFiaWxpdHktcGFnZS0xIjsNCiAgICAgICAgdG9wQ2FuZGlkYXRlLmNsYXNzTmFtZSA9ICJwYWdlIjsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHZhciBkaXYgPSBkb2MuY3JlYXRlRWxlbWVudCgiRElWIik7DQogICAgICAgIGRpdi5pZCA9ICJyZWFkYWJpbGl0eS1wYWdlLTEiOw0KICAgICAgICBkaXYuY2xhc3NOYW1lID0gInBhZ2UiOw0KICAgICAgICB2YXIgY2hpbGRyZW4gPSBhcnRpY2xlQ29udGVudC5jaGlsZE5vZGVzOw0KICAgICAgICB3aGlsZSAoY2hpbGRyZW4ubGVuZ3RoKSB7DQogICAgICAgICAgZGl2LmFwcGVuZENoaWxkKGNoaWxkcmVuWzBdKTsNCiAgICAgICAgfQ0KICAgICAgICBhcnRpY2xlQ29udGVudC5hcHBlbmRDaGlsZChkaXYpOw0KICAgICAgfQ0KDQogICAgICBpZiAodGhpcy5fZGVidWcpDQogICAgICAgIHRoaXMubG9nKCJBcnRpY2xlIGNvbnRlbnQgYWZ0ZXIgcGFnaW5nOiAiICsgYXJ0aWNsZUNvbnRlbnQuaW5uZXJIVE1MKTsNCg0KICAgICAgdmFyIHBhcnNlU3VjY2Vzc2Z1bCA9IHRydWU7DQoNCiAgICAgIC8vIE5vdyB0aGF0IHdlJ3ZlIGdvbmUgdGhyb3VnaCB0aGUgZnVsbCBhbGdvcml0aG0sIGNoZWNrIHRvIHNlZSBpZg0KICAgICAgLy8gd2UgZ290IGFueSBtZWFuaW5nZnVsIGNvbnRlbnQuIElmIHdlIGRpZG4ndCwgd2UgbWF5IG5lZWQgdG8gcmUtcnVuDQogICAgICAvLyBncmFiQXJ0aWNsZSB3aXRoIGRpZmZlcmVudCBmbGFncyBzZXQuIFRoaXMgZ2l2ZXMgdXMgYSBoaWdoZXIgbGlrZWxpaG9vZCBvZg0KICAgICAgLy8gZmluZGluZyB0aGUgY29udGVudCwgYW5kIHRoZSBzaWV2ZSBhcHByb2FjaCBnaXZlcyB1cyBhIGhpZ2hlciBsaWtlbGlob29kIG9mDQogICAgICAvLyBmaW5kaW5nIHRoZSAtcmlnaHQtIGNvbnRlbnQuDQogICAgICB2YXIgdGV4dExlbmd0aCA9IHRoaXMuX2dldElubmVyVGV4dChhcnRpY2xlQ29udGVudCwgdHJ1ZSkubGVuZ3RoOw0KICAgICAgaWYgKHRleHRMZW5ndGggPCB0aGlzLl9jaGFyVGhyZXNob2xkKSB7DQogICAgICAgIHBhcnNlU3VjY2Vzc2Z1bCA9IGZhbHNlOw0KICAgICAgICBwYWdlLmlubmVySFRNTCA9IHBhZ2VDYWNoZUh0bWw7DQoNCiAgICAgICAgaWYgKHRoaXMuX2ZsYWdJc0FjdGl2ZSh0aGlzLkZMQUdfU1RSSVBfVU5MSUtFTFlTKSkgew0KICAgICAgICAgIHRoaXMuX3JlbW92ZUZsYWcodGhpcy5GTEFHX1NUUklQX1VOTElLRUxZUyk7DQogICAgICAgICAgdGhpcy5fYXR0ZW1wdHMucHVzaCh7YXJ0aWNsZUNvbnRlbnQ6IGFydGljbGVDb250ZW50LCB0ZXh0TGVuZ3RoOiB0ZXh0TGVuZ3RofSk7DQogICAgICAgIH0gZWxzZSBpZiAodGhpcy5fZmxhZ0lzQWN0aXZlKHRoaXMuRkxBR19XRUlHSFRfQ0xBU1NFUykpIHsNCiAgICAgICAgICB0aGlzLl9yZW1vdmVGbGFnKHRoaXMuRkxBR19XRUlHSFRfQ0xBU1NFUyk7DQogICAgICAgICAgdGhpcy5fYXR0ZW1wdHMucHVzaCh7YXJ0aWNsZUNvbnRlbnQ6IGFydGljbGVDb250ZW50LCB0ZXh0TGVuZ3RoOiB0ZXh0TGVuZ3RofSk7DQogICAgICAgIH0gZWxzZSBpZiAodGhpcy5fZmxhZ0lzQWN0aXZlKHRoaXMuRkxBR19DTEVBTl9DT05ESVRJT05BTExZKSkgew0KICAgICAgICAgIHRoaXMuX3JlbW92ZUZsYWcodGhpcy5GTEFHX0NMRUFOX0NPTkRJVElPTkFMTFkpOw0KICAgICAgICAgIHRoaXMuX2F0dGVtcHRzLnB1c2goe2FydGljbGVDb250ZW50OiBhcnRpY2xlQ29udGVudCwgdGV4dExlbmd0aDogdGV4dExlbmd0aH0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuX2F0dGVtcHRzLnB1c2goe2FydGljbGVDb250ZW50OiBhcnRpY2xlQ29udGVudCwgdGV4dExlbmd0aDogdGV4dExlbmd0aH0pOw0KICAgICAgICAgIC8vIE5vIGx1Y2sgYWZ0ZXIgcmVtb3ZpbmcgZmxhZ3MsIGp1c3QgcmV0dXJuIHRoZSBsb25nZXN0IHRleHQgd2UgZm91bmQgZHVyaW5nIHRoZSBkaWZmZXJlbnQgbG9vcHMNCiAgICAgICAgICB0aGlzLl9hdHRlbXB0cy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7DQogICAgICAgICAgICByZXR1cm4gYi50ZXh0TGVuZ3RoIC0gYS50ZXh0TGVuZ3RoOw0KICAgICAgICAgIH0pOw0KDQogICAgICAgICAgLy8gQnV0IGZpcnN0IGNoZWNrIGlmIHdlIGFjdHVhbGx5IGhhdmUgc29tZXRoaW5nDQogICAgICAgICAgaWYgKCF0aGlzLl9hdHRlbXB0c1swXS50ZXh0TGVuZ3RoKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBhcnRpY2xlQ29udGVudCA9IHRoaXMuX2F0dGVtcHRzWzBdLmFydGljbGVDb250ZW50Ow0KICAgICAgICAgIHBhcnNlU3VjY2Vzc2Z1bCA9IHRydWU7DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgaWYgKHBhcnNlU3VjY2Vzc2Z1bCkgew0KICAgICAgICAvLyBGaW5kIG91dCB0ZXh0IGRpcmVjdGlvbiBmcm9tIGFuY2VzdG9ycyBvZiBmaW5hbCB0b3AgY2FuZGlkYXRlLg0KICAgICAgICB2YXIgYW5jZXN0b3JzID0gW3BhcmVudE9mVG9wQ2FuZGlkYXRlLCB0b3BDYW5kaWRhdGVdLmNvbmNhdCh0aGlzLl9nZXROb2RlQW5jZXN0b3JzKHBhcmVudE9mVG9wQ2FuZGlkYXRlKSk7DQogICAgICAgIHRoaXMuX3NvbWVOb2RlKGFuY2VzdG9ycywgZnVuY3Rpb24oYW5jZXN0b3IpIHsNCiAgICAgICAgICBpZiAoIWFuY2VzdG9yLnRhZ05hbWUpDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgdmFyIGFydGljbGVEaXIgPSBhbmNlc3Rvci5nZXRBdHRyaWJ1dGUoImRpciIpOw0KICAgICAgICAgIGlmIChhcnRpY2xlRGlyKSB7DQogICAgICAgICAgICB0aGlzLl9hcnRpY2xlRGlyID0gYXJ0aWNsZURpcjsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgIH0NCiAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm4gYXJ0aWNsZUNvbnRlbnQ7DQogICAgICB9DQogICAgfQ0KICB9LA0KDQogIC8qKg0KICAgKiBDaGVjayB3aGV0aGVyIHRoZSBpbnB1dCBzdHJpbmcgY291bGQgYmUgYSBieWxpbmUuDQogICAqIFRoaXMgdmVyaWZpZXMgdGhhdCB0aGUgaW5wdXQgaXMgYSBzdHJpbmcsIGFuZCB0aGF0IHRoZSBsZW5ndGgNCiAgICogaXMgbGVzcyB0aGFuIDEwMCBjaGFycy4NCiAgICoNCiAgICogQHBhcmFtIHBvc3NpYmxlQnlsaW5lIHtzdHJpbmd9IC0gYSBzdHJpbmcgdG8gY2hlY2sgd2hldGhlciBpdHMgYSBieWxpbmUuDQogICAqIEByZXR1cm4gQm9vbGVhbiAtIHdoZXRoZXIgdGhlIGlucHV0IHN0cmluZyBpcyBhIGJ5bGluZS4NCiAgICovDQogIF9pc1ZhbGlkQnlsaW5lOiBmdW5jdGlvbihieWxpbmUpIHsNCiAgICBpZiAodHlwZW9mIGJ5bGluZSA9PSAic3RyaW5nIiB8fCBieWxpbmUgaW5zdGFuY2VvZiBTdHJpbmcpIHsNCiAgICAgIGJ5bGluZSA9IGJ5bGluZS50cmltKCk7DQogICAgICByZXR1cm4gKGJ5bGluZS5sZW5ndGggPiAwKSAmJiAoYnlsaW5lLmxlbmd0aCA8IDEwMCk7DQogICAgfQ0KICAgIHJldHVybiBmYWxzZTsNCiAgfSwNCg0KICAvKioNCiAgICogQXR0ZW1wdHMgdG8gZ2V0IGV4Y2VycHQgYW5kIGJ5bGluZSBtZXRhZGF0YSBmb3IgdGhlIGFydGljbGUuDQogICAqDQogICAqIEByZXR1cm4gT2JqZWN0IHdpdGggb3B0aW9uYWwgImV4Y2VycHQiIGFuZCAiYnlsaW5lIiBwcm9wZXJ0aWVzDQogICAqLw0KICBfZ2V0QXJ0aWNsZU1ldGFkYXRhOiBmdW5jdGlvbigpIHsNCiAgICB2YXIgbWV0YWRhdGEgPSB7fTsNCiAgICB2YXIgdmFsdWVzID0ge307DQogICAgdmFyIG1ldGFFbGVtZW50cyA9IHRoaXMuX2RvYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgibWV0YSIpOw0KDQogICAgLy8gcHJvcGVydHkgaXMgYSBzcGFjZS1zZXBhcmF0ZWQgbGlzdCBvZiB2YWx1ZXMNCiAgICB2YXIgcHJvcGVydHlQYXR0ZXJuID0gL1xzKihkY3xkY3Rlcm18b2d8dHdpdHRlcilccyo6XHMqKGF1dGhvcnxjcmVhdG9yfGRlc2NyaXB0aW9ufHRpdGxlfHNpdGVfbmFtZSlccyovZ2k7DQoNCiAgICAvLyBuYW1lIGlzIGEgc2luZ2xlIHZhbHVlDQogICAgdmFyIG5hbWVQYXR0ZXJuID0gL15ccyooPzooZGN8ZGN0ZXJtfG9nfHR3aXR0ZXJ8d2VpYm86KGFydGljbGV8d2VicGFnZSkpXHMqW1wuOl1ccyopPyhhdXRob3J8Y3JlYXRvcnxkZXNjcmlwdGlvbnx0aXRsZXxzaXRlX25hbWUpXHMqJC9pOw0KDQogICAgLy8gRmluZCBkZXNjcmlwdGlvbiB0YWdzLg0KICAgIHRoaXMuX2ZvckVhY2hOb2RlKG1ldGFFbGVtZW50cywgZnVuY3Rpb24oZWxlbWVudCkgew0KICAgICAgdmFyIGVsZW1lbnROYW1lID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoIm5hbWUiKTsNCiAgICAgIHZhciBlbGVtZW50UHJvcGVydHkgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgicHJvcGVydHkiKTsNCiAgICAgIHZhciBjb250ZW50ID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoImNvbnRlbnQiKTsNCiAgICAgIGlmICghY29udGVudCkgew0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICB2YXIgbWF0Y2hlcyA9IG51bGw7DQogICAgICB2YXIgbmFtZSA9IG51bGw7DQoNCiAgICAgIGlmIChlbGVtZW50UHJvcGVydHkpIHsNCiAgICAgICAgbWF0Y2hlcyA9IGVsZW1lbnRQcm9wZXJ0eS5tYXRjaChwcm9wZXJ0eVBhdHRlcm4pOw0KICAgICAgICBpZiAobWF0Y2hlcykgew0KICAgICAgICAgIGZvciAodmFyIGkgPSBtYXRjaGVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7DQogICAgICAgICAgICAvLyBDb252ZXJ0IHRvIGxvd2VyY2FzZSwgYW5kIHJlbW92ZSBhbnkgd2hpdGVzcGFjZQ0KICAgICAgICAgICAgLy8gc28gd2UgY2FuIG1hdGNoIGJlbG93Lg0KICAgICAgICAgICAgbmFtZSA9IG1hdGNoZXNbaV0udG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9ccy9nLCAiIik7DQogICAgICAgICAgICAvLyBtdWx0aXBsZSBhdXRob3JzDQogICAgICAgICAgICB2YWx1ZXNbbmFtZV0gPSBjb250ZW50LnRyaW0oKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIGlmICghbWF0Y2hlcyAmJiBlbGVtZW50TmFtZSAmJiBuYW1lUGF0dGVybi50ZXN0KGVsZW1lbnROYW1lKSkgew0KICAgICAgICBuYW1lID0gZWxlbWVudE5hbWU7DQogICAgICAgIGlmIChjb250ZW50KSB7DQogICAgICAgICAgLy8gQ29udmVydCB0byBsb3dlcmNhc2UsIHJlbW92ZSBhbnkgd2hpdGVzcGFjZSwgYW5kIGNvbnZlcnQgZG90cw0KICAgICAgICAgIC8vIHRvIGNvbG9ucyBzbyB3ZSBjYW4gbWF0Y2ggYmVsb3cuDQogICAgICAgICAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9ccy9nLCAiIikucmVwbGFjZSgvXC4vZywgIjoiKTsNCiAgICAgICAgICB2YWx1ZXNbbmFtZV0gPSBjb250ZW50LnRyaW0oKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0pOw0KDQogICAgLy8gZ2V0IHRpdGxlDQogICAgbWV0YWRhdGEudGl0bGUgPSB2YWx1ZXNbImRjOnRpdGxlIl0gfHwNCiAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1siZGN0ZXJtOnRpdGxlIl0gfHwNCiAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1sib2c6dGl0bGUiXSB8fA0KICAgICAgICAgICAgICAgICAgICAgdmFsdWVzWyJ3ZWlibzphcnRpY2xlOnRpdGxlIl0gfHwNCiAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1sid2VpYm86d2VicGFnZTp0aXRsZSJdIHx8DQogICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbInRpdGxlIl0gfHwNCiAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1sidHdpdHRlcjp0aXRsZSJdOw0KDQogICAgaWYgKCFtZXRhZGF0YS50aXRsZSkgew0KICAgICAgbWV0YWRhdGEudGl0bGUgPSB0aGlzLl9nZXRBcnRpY2xlVGl0bGUoKTsNCiAgICB9DQoNCiAgICAvLyBnZXQgYXV0aG9yDQogICAgbWV0YWRhdGEuYnlsaW5lID0gdmFsdWVzWyJkYzpjcmVhdG9yIl0gfHwNCiAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbImRjdGVybTpjcmVhdG9yIl0gfHwNCiAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbImF1dGhvciJdOw0KDQogICAgLy8gZ2V0IGRlc2NyaXB0aW9uDQogICAgbWV0YWRhdGEuZXhjZXJwdCA9IHZhbHVlc1siZGM6ZGVzY3JpcHRpb24iXSB8fA0KICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbImRjdGVybTpkZXNjcmlwdGlvbiJdIHx8DQogICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1sib2c6ZGVzY3JpcHRpb24iXSB8fA0KICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbIndlaWJvOmFydGljbGU6ZGVzY3JpcHRpb24iXSB8fA0KICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbIndlaWJvOndlYnBhZ2U6ZGVzY3JpcHRpb24iXSB8fA0KICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbImRlc2NyaXB0aW9uIl0gfHwNCiAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzWyJ0d2l0dGVyOmRlc2NyaXB0aW9uIl07DQoNCiAgICAvLyBnZXQgc2l0ZSBuYW1lDQogICAgbWV0YWRhdGEuc2l0ZU5hbWUgPSB2YWx1ZXNbIm9nOnNpdGVfbmFtZSJdOw0KDQogICAgcmV0dXJuIG1ldGFkYXRhOw0KICB9LA0KDQogIC8qKg0KICAgKiBSZW1vdmVzIHNjcmlwdCB0YWdzIGZyb20gdGhlIGRvY3VtZW50Lg0KICAgKg0KICAgKiBAcGFyYW0gRWxlbWVudA0KICAqKi8NCiAgX3JlbW92ZVNjcmlwdHM6IGZ1bmN0aW9uKGRvYykgew0KICAgIHRoaXMuX3JlbW92ZU5vZGVzKGRvYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgic2NyaXB0IiksIGZ1bmN0aW9uKHNjcmlwdE5vZGUpIHsNCiAgICAgIHNjcmlwdE5vZGUubm9kZVZhbHVlID0gIiI7DQogICAgICBzY3JpcHROb2RlLnJlbW92ZUF0dHJpYnV0ZSgic3JjIik7DQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9KTsNCiAgICB0aGlzLl9yZW1vdmVOb2Rlcyhkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIm5vc2NyaXB0IikpOw0KICB9LA0KDQogIC8qKg0KICAgKiBDaGVjayBpZiB0aGlzIG5vZGUgaGFzIG9ubHkgd2hpdGVzcGFjZSBhbmQgYSBzaW5nbGUgZWxlbWVudCB3aXRoIGdpdmVuIHRhZw0KICAgKiBSZXR1cm5zIGZhbHNlIGlmIHRoZSBESVYgbm9kZSBjb250YWlucyBub24tZW1wdHkgdGV4dCBub2Rlcw0KICAgKiBvciBpZiBpdCBjb250YWlucyBubyBlbGVtZW50IHdpdGggZ2l2ZW4gdGFnIG9yIG1vcmUgdGhhbiAxIGVsZW1lbnQuDQogICAqDQogICAqIEBwYXJhbSBFbGVtZW50DQogICAqIEBwYXJhbSBzdHJpbmcgdGFnIG9mIGNoaWxkIGVsZW1lbnQNCiAgKiovDQogIF9oYXNTaW5nbGVUYWdJbnNpZGVFbGVtZW50OiBmdW5jdGlvbihlbGVtZW50LCB0YWcpIHsNCiAgICAvLyBUaGVyZSBzaG91bGQgYmUgZXhhY3RseSAxIGVsZW1lbnQgY2hpbGQgd2l0aCBnaXZlbiB0YWcNCiAgICBpZiAoZWxlbWVudC5jaGlsZHJlbi5sZW5ndGggIT0gMSB8fCBlbGVtZW50LmNoaWxkcmVuWzBdLnRhZ05hbWUgIT09IHRhZykgew0KICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8vIEFuZCB0aGVyZSBzaG91bGQgYmUgbm8gdGV4dCBub2RlcyB3aXRoIHJlYWwgY29udGVudA0KICAgIHJldHVybiAhdGhpcy5fc29tZU5vZGUoZWxlbWVudC5jaGlsZE5vZGVzLCBmdW5jdGlvbihub2RlKSB7DQogICAgICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PT0gdGhpcy5URVhUX05PREUgJiYNCiAgICAgICAgICAgICB0aGlzLlJFR0VYUFMuaGFzQ29udGVudC50ZXN0KG5vZGUudGV4dENvbnRlbnQpOw0KICAgIH0pOw0KICB9LA0KDQogIF9pc0VsZW1lbnRXaXRob3V0Q29udGVudDogZnVuY3Rpb24obm9kZSkgew0KICAgIHJldHVybiBub2RlLm5vZGVUeXBlID09PSB0aGlzLkVMRU1FTlRfTk9ERSAmJg0KICAgICAgbm9kZS50ZXh0Q29udGVudC50cmltKCkubGVuZ3RoID09IDAgJiYNCiAgICAgIChub2RlLmNoaWxkcmVuLmxlbmd0aCA9PSAwIHx8DQogICAgICAgbm9kZS5jaGlsZHJlbi5sZW5ndGggPT0gbm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYnIiKS5sZW5ndGggKyBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJociIpLmxlbmd0aCk7DQogIH0sDQoNCiAgLyoqDQogICAqIERldGVybWluZSB3aGV0aGVyIGVsZW1lbnQgaGFzIGFueSBjaGlsZHJlbiBibG9jayBsZXZlbCBlbGVtZW50cy4NCiAgICoNCiAgICogQHBhcmFtIEVsZW1lbnQNCiAgICovDQogIF9oYXNDaGlsZEJsb2NrRWxlbWVudDogZnVuY3Rpb24gKGVsZW1lbnQpIHsNCiAgICByZXR1cm4gdGhpcy5fc29tZU5vZGUoZWxlbWVudC5jaGlsZE5vZGVzLCBmdW5jdGlvbihub2RlKSB7DQogICAgICByZXR1cm4gdGhpcy5ESVZfVE9fUF9FTEVNUy5pbmRleE9mKG5vZGUudGFnTmFtZSkgIT09IC0xIHx8DQogICAgICAgICAgICAgdGhpcy5faGFzQ2hpbGRCbG9ja0VsZW1lbnQobm9kZSk7DQogICAgfSk7DQogIH0sDQoNCiAgLyoqKg0KICAgKiBEZXRlcm1pbmUgaWYgYSBub2RlIHF1YWxpZmllcyBhcyBwaHJhc2luZyBjb250ZW50Lg0KICAgKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9HdWlkZS9IVE1ML0NvbnRlbnRfY2F0ZWdvcmllcyNQaHJhc2luZ19jb250ZW50DQogICoqLw0KICBfaXNQaHJhc2luZ0NvbnRlbnQ6IGZ1bmN0aW9uKG5vZGUpIHsNCiAgICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PT0gdGhpcy5URVhUX05PREUgfHwgdGhpcy5QSFJBU0lOR19FTEVNUy5pbmRleE9mKG5vZGUudGFnTmFtZSkgIT09IC0xIHx8DQogICAgICAoKG5vZGUudGFnTmFtZSA9PT0gIkEiIHx8IG5vZGUudGFnTmFtZSA9PT0gIkRFTCIgfHwgbm9kZS50YWdOYW1lID09PSAiSU5TIikgJiYNCiAgICAgICAgdGhpcy5fZXZlcnlOb2RlKG5vZGUuY2hpbGROb2RlcywgdGhpcy5faXNQaHJhc2luZ0NvbnRlbnQpKTsNCiAgfSwNCg0KICBfaXNXaGl0ZXNwYWNlOiBmdW5jdGlvbihub2RlKSB7DQogICAgcmV0dXJuIChub2RlLm5vZGVUeXBlID09PSB0aGlzLlRFWFRfTk9ERSAmJiBub2RlLnRleHRDb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHx8DQogICAgICAgICAgIChub2RlLm5vZGVUeXBlID09PSB0aGlzLkVMRU1FTlRfTk9ERSAmJiBub2RlLnRhZ05hbWUgPT09ICJCUiIpOw0KICB9LA0KDQogIC8qKg0KICAgKiBHZXQgdGhlIGlubmVyIHRleHQgb2YgYSBub2RlIC0gY3Jvc3MgYnJvd3NlciBjb21wYXRpYmx5Lg0KICAgKiBUaGlzIGFsc28gc3RyaXBzIG91dCBhbnkgZXhjZXNzIHdoaXRlc3BhY2UgdG8gYmUgZm91bmQuDQogICAqDQogICAqIEBwYXJhbSBFbGVtZW50DQogICAqIEBwYXJhbSBCb29sZWFuIG5vcm1hbGl6ZVNwYWNlcyAoZGVmYXVsdDogdHJ1ZSkNCiAgICogQHJldHVybiBzdHJpbmcNCiAgKiovDQogIF9nZXRJbm5lclRleHQ6IGZ1bmN0aW9uKGUsIG5vcm1hbGl6ZVNwYWNlcykgew0KICAgIG5vcm1hbGl6ZVNwYWNlcyA9ICh0eXBlb2Ygbm9ybWFsaXplU3BhY2VzID09PSAidW5kZWZpbmVkIikgPyB0cnVlIDogbm9ybWFsaXplU3BhY2VzOw0KICAgIHZhciB0ZXh0Q29udGVudCA9IGUudGV4dENvbnRlbnQudHJpbSgpOw0KDQogICAgaWYgKG5vcm1hbGl6ZVNwYWNlcykgew0KICAgICAgcmV0dXJuIHRleHRDb250ZW50LnJlcGxhY2UodGhpcy5SRUdFWFBTLm5vcm1hbGl6ZSwgIiAiKTsNCiAgICB9DQogICAgcmV0dXJuIHRleHRDb250ZW50Ow0KICB9LA0KDQogIC8qKg0KICAgKiBHZXQgdGhlIG51bWJlciBvZiB0aW1lcyBhIHN0cmluZyBzIGFwcGVhcnMgaW4gdGhlIG5vZGUgZS4NCiAgICoNCiAgICogQHBhcmFtIEVsZW1lbnQNCiAgICogQHBhcmFtIHN0cmluZyAtIHdoYXQgdG8gc3BsaXQgb24uIERlZmF1bHQgaXMgIiwiDQogICAqIEByZXR1cm4gbnVtYmVyIChpbnRlZ2VyKQ0KICAqKi8NCiAgX2dldENoYXJDb3VudDogZnVuY3Rpb24oZSwgcykgew0KICAgIHMgPSBzIHx8ICIsIjsNCiAgICByZXR1cm4gdGhpcy5fZ2V0SW5uZXJUZXh0KGUpLnNwbGl0KHMpLmxlbmd0aCAtIDE7DQogIH0sDQoNCiAgLyoqDQogICAqIFJlbW92ZSB0aGUgc3R5bGUgYXR0cmlidXRlIG9uIGV2ZXJ5IGUgYW5kIHVuZGVyLg0KICAgKiBUT0RPOiBUZXN0IGlmIGdldEVsZW1lbnRzQnlUYWdOYW1lKCopIGlzIGZhc3Rlci4NCiAgICoNCiAgICogQHBhcmFtIEVsZW1lbnQNCiAgICogQHJldHVybiB2b2lkDQogICoqLw0KICBfY2xlYW5TdHlsZXM6IGZ1bmN0aW9uKGUpIHsNCiAgICBpZiAoIWUgfHwgZS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJzdmciKQ0KICAgICAgcmV0dXJuOw0KDQogICAgLy8gUmVtb3ZlIGBzdHlsZWAgYW5kIGRlcHJlY2F0ZWQgcHJlc2VudGF0aW9uYWwgYXR0cmlidXRlcw0KICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5QUkVTRU5UQVRJT05BTF9BVFRSSUJVVEVTLmxlbmd0aDsgaSsrKSB7DQogICAgICBlLnJlbW92ZUF0dHJpYnV0ZSh0aGlzLlBSRVNFTlRBVElPTkFMX0FUVFJJQlVURVNbaV0pOw0KICAgIH0NCg0KICAgIGlmICh0aGlzLkRFUFJFQ0FURURfU0laRV9BVFRSSUJVVEVfRUxFTVMuaW5kZXhPZihlLnRhZ05hbWUpICE9PSAtMSkgew0KICAgICAgZS5yZW1vdmVBdHRyaWJ1dGUoIndpZHRoIik7DQogICAgICBlLnJlbW92ZUF0dHJpYnV0ZSgiaGVpZ2h0Iik7DQogICAgfQ0KDQogICAgdmFyIGN1ciA9IGUuZmlyc3RFbGVtZW50Q2hpbGQ7DQogICAgd2hpbGUgKGN1ciAhPT0gbnVsbCkgew0KICAgICAgdGhpcy5fY2xlYW5TdHlsZXMoY3VyKTsNCiAgICAgIGN1ciA9IGN1ci5uZXh0RWxlbWVudFNpYmxpbmc7DQogICAgfQ0KICB9LA0KDQogIC8qKg0KICAgKiBHZXQgdGhlIGRlbnNpdHkgb2YgbGlua3MgYXMgYSBwZXJjZW50YWdlIG9mIHRoZSBjb250ZW50DQogICAqIFRoaXMgaXMgdGhlIGFtb3VudCBvZiB0ZXh0IHRoYXQgaXMgaW5zaWRlIGEgbGluayBkaXZpZGVkIGJ5IHRoZSB0b3RhbCB0ZXh0IGluIHRoZSBub2RlLg0KICAgKg0KICAgKiBAcGFyYW0gRWxlbWVudA0KICAgKiBAcmV0dXJuIG51bWJlciAoZmxvYXQpDQogICoqLw0KICBfZ2V0TGlua0RlbnNpdHk6IGZ1bmN0aW9uKGVsZW1lbnQpIHsNCiAgICB2YXIgdGV4dExlbmd0aCA9IHRoaXMuX2dldElubmVyVGV4dChlbGVtZW50KS5sZW5ndGg7DQogICAgaWYgKHRleHRMZW5ndGggPT09IDApDQogICAgICByZXR1cm4gMDsNCg0KICAgIHZhciBsaW5rTGVuZ3RoID0gMDsNCg0KICAgIC8vIFhYWCBpbXBsZW1lbnQgX3JlZHVjZU5vZGVMaXN0Pw0KICAgIHRoaXMuX2ZvckVhY2hOb2RlKGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImEiKSwgZnVuY3Rpb24obGlua05vZGUpIHsNCiAgICAgIGxpbmtMZW5ndGggKz0gdGhpcy5fZ2V0SW5uZXJUZXh0KGxpbmtOb2RlKS5sZW5ndGg7DQogICAgfSk7DQoNCiAgICByZXR1cm4gbGlua0xlbmd0aCAvIHRleHRMZW5ndGg7DQogIH0sDQoNCiAgLyoqDQogICAqIEdldCBhbiBlbGVtZW50cyBjbGFzcy9pZCB3ZWlnaHQuIFVzZXMgcmVndWxhciBleHByZXNzaW9ucyB0byB0ZWxsIGlmIHRoaXMNCiAgICogZWxlbWVudCBsb29rcyBnb29kIG9yIGJhZC4NCiAgICoNCiAgICogQHBhcmFtIEVsZW1lbnQNCiAgICogQHJldHVybiBudW1iZXIgKEludGVnZXIpDQogICoqLw0KICBfZ2V0Q2xhc3NXZWlnaHQ6IGZ1bmN0aW9uKGUpIHsNCiAgICBpZiAoIXRoaXMuX2ZsYWdJc0FjdGl2ZSh0aGlzLkZMQUdfV0VJR0hUX0NMQVNTRVMpKQ0KICAgICAgcmV0dXJuIDA7DQoNCiAgICB2YXIgd2VpZ2h0ID0gMDsNCg0KICAgIC8vIExvb2sgZm9yIGEgc3BlY2lhbCBjbGFzc25hbWUNCiAgICBpZiAodHlwZW9mKGUuY2xhc3NOYW1lKSA9PT0gInN0cmluZyIgJiYgZS5jbGFzc05hbWUgIT09ICIiKSB7DQogICAgICBpZiAodGhpcy5SRUdFWFBTLm5lZ2F0aXZlLnRlc3QoZS5jbGFzc05hbWUpKQ0KICAgICAgICB3ZWlnaHQgLT0gMjU7DQoNCiAgICAgIGlmICh0aGlzLlJFR0VYUFMucG9zaXRpdmUudGVzdChlLmNsYXNzTmFtZSkpDQogICAgICAgIHdlaWdodCArPSAyNTsNCiAgICB9DQoNCiAgICAvLyBMb29rIGZvciBhIHNwZWNpYWwgSUQNCiAgICBpZiAodHlwZW9mKGUuaWQpID09PSAic3RyaW5nIiAmJiBlLmlkICE9PSAiIikgew0KICAgICAgaWYgKHRoaXMuUkVHRVhQUy5uZWdhdGl2ZS50ZXN0KGUuaWQpKQ0KICAgICAgICB3ZWlnaHQgLT0gMjU7DQoNCiAgICAgIGlmICh0aGlzLlJFR0VYUFMucG9zaXRpdmUudGVzdChlLmlkKSkNCiAgICAgICAgd2VpZ2h0ICs9IDI1Ow0KICAgIH0NCg0KICAgIHJldHVybiB3ZWlnaHQ7DQogIH0sDQoNCiAgLyoqDQogICAqIENsZWFuIGEgbm9kZSBvZiBhbGwgZWxlbWVudHMgb2YgdHlwZSAidGFnIi4NCiAgICogKFVubGVzcyBpdCdzIGEgeW91dHViZS92aW1lbyB2aWRlby4gUGVvcGxlIGxvdmUgbW92aWVzLikNCiAgICoNCiAgICogQHBhcmFtIEVsZW1lbnQNCiAgICogQHBhcmFtIHN0cmluZyB0YWcgdG8gY2xlYW4NCiAgICogQHJldHVybiB2b2lkDQogICAqKi8NCiAgX2NsZWFuOiBmdW5jdGlvbihlLCB0YWcpIHsNCiAgICB2YXIgaXNFbWJlZCA9IFsib2JqZWN0IiwgImVtYmVkIiwgImlmcmFtZSJdLmluZGV4T2YodGFnKSAhPT0gLTE7DQoNCiAgICB0aGlzLl9yZW1vdmVOb2RlcyhlLmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZyksIGZ1bmN0aW9uKGVsZW1lbnQpIHsNCiAgICAgIC8vIEFsbG93IHlvdXR1YmUgYW5kIHZpbWVvIHZpZGVvcyB0aHJvdWdoIGFzIHBlb3BsZSB1c3VhbGx5IHdhbnQgdG8gc2VlIHRob3NlLg0KICAgICAgaWYgKGlzRW1iZWQpIHsNCiAgICAgICAgLy8gRmlyc3QsIGNoZWNrIHRoZSBlbGVtZW50cyBhdHRyaWJ1dGVzIHRvIHNlZSBpZiBhbnkgb2YgdGhlbSBjb250YWluIHlvdXR1YmUgb3IgdmltZW8NCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50LmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICBpZiAodGhpcy5SRUdFWFBTLnZpZGVvcy50ZXN0KGVsZW1lbnQuYXR0cmlidXRlc1tpXS52YWx1ZSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyBGb3IgZW1iZWQgd2l0aCA8b2JqZWN0PiB0YWcsIGNoZWNrIGlubmVyIEhUTUwgYXMgd2VsbC4NCiAgICAgICAgaWYgKGVsZW1lbnQudGFnTmFtZSA9PT0gIm9iamVjdCIgJiYgdGhpcy5SRUdFWFBTLnZpZGVvcy50ZXN0KGVsZW1lbnQuaW5uZXJIVE1MKSkgew0KICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9KTsNCiAgfSwNCg0KICAvKioNCiAgICogQ2hlY2sgaWYgYSBnaXZlbiBub2RlIGhhcyBvbmUgb2YgaXRzIGFuY2VzdG9yIHRhZyBuYW1lIG1hdGNoaW5nIHRoZQ0KICAgKiBwcm92aWRlZCBvbmUuDQogICAqIEBwYXJhbSAgSFRNTEVsZW1lbnQgbm9kZQ0KICAgKiBAcGFyYW0gIFN0cmluZyAgICAgIHRhZ05hbWUNCiAgICogQHBhcmFtICBOdW1iZXIgICAgICBtYXhEZXB0aA0KICAgKiBAcGFyYW0gIEZ1bmN0aW9uICAgIGZpbHRlckZuIGEgZmlsdGVyIHRvIGludm9rZSB0byBkZXRlcm1pbmUgd2hldGhlciB0aGlzIG5vZGUgJ2NvdW50cycNCiAgICogQHJldHVybiBCb29sZWFuDQogICAqLw0KICBfaGFzQW5jZXN0b3JUYWc6IGZ1bmN0aW9uKG5vZGUsIHRhZ05hbWUsIG1heERlcHRoLCBmaWx0ZXJGbikgew0KICAgIG1heERlcHRoID0gbWF4RGVwdGggfHwgMzsNCiAgICB0YWdOYW1lID0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpOw0KICAgIHZhciBkZXB0aCA9IDA7DQogICAgd2hpbGUgKG5vZGUucGFyZW50Tm9kZSkgew0KICAgICAgaWYgKG1heERlcHRoID4gMCAmJiBkZXB0aCA+IG1heERlcHRoKQ0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICBpZiAobm9kZS5wYXJlbnROb2RlLnRhZ05hbWUgPT09IHRhZ05hbWUgJiYgKCFmaWx0ZXJGbiB8fCBmaWx0ZXJGbihub2RlLnBhcmVudE5vZGUpKSkNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlOw0KICAgICAgZGVwdGgrKzsNCiAgICB9DQogICAgcmV0dXJuIGZhbHNlOw0KICB9LA0KDQogIC8qKg0KICAgKiBSZXR1cm4gYW4gb2JqZWN0IGluZGljYXRpbmcgaG93IG1hbnkgcm93cyBhbmQgY29sdW1ucyB0aGlzIHRhYmxlIGhhcy4NCiAgICovDQogIF9nZXRSb3dBbmRDb2x1bW5Db3VudDogZnVuY3Rpb24odGFibGUpIHsNCiAgICB2YXIgcm93cyA9IDA7DQogICAgdmFyIGNvbHVtbnMgPSAwOw0KICAgIHZhciB0cnMgPSB0YWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgidHIiKTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRycy5sZW5ndGg7IGkrKykgew0KICAgICAgdmFyIHJvd3NwYW4gPSB0cnNbaV0uZ2V0QXR0cmlidXRlKCJyb3dzcGFuIikgfHwgMDsNCiAgICAgIGlmIChyb3dzcGFuKSB7DQogICAgICAgIHJvd3NwYW4gPSBwYXJzZUludChyb3dzcGFuLCAxMCk7DQogICAgICB9DQogICAgICByb3dzICs9IChyb3dzcGFuIHx8IDEpOw0KDQogICAgICAvLyBOb3cgbG9vayBmb3IgY29sdW1uLXJlbGF0ZWQgaW5mbw0KICAgICAgdmFyIGNvbHVtbnNJblRoaXNSb3cgPSAwOw0KICAgICAgdmFyIGNlbGxzID0gdHJzW2ldLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ZCIpOw0KICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjZWxscy5sZW5ndGg7IGorKykgew0KICAgICAgICB2YXIgY29sc3BhbiA9IGNlbGxzW2pdLmdldEF0dHJpYnV0ZSgiY29sc3BhbiIpIHx8IDA7DQogICAgICAgIGlmIChjb2xzcGFuKSB7DQogICAgICAgICAgY29sc3BhbiA9IHBhcnNlSW50KGNvbHNwYW4sIDEwKTsNCiAgICAgICAgfQ0KICAgICAgICBjb2x1bW5zSW5UaGlzUm93ICs9IChjb2xzcGFuIHx8IDEpOw0KICAgICAgfQ0KICAgICAgY29sdW1ucyA9IE1hdGgubWF4KGNvbHVtbnMsIGNvbHVtbnNJblRoaXNSb3cpOw0KICAgIH0NCiAgICByZXR1cm4ge3Jvd3M6IHJvd3MsIGNvbHVtbnM6IGNvbHVtbnN9Ow0KICB9LA0KDQogIC8qKg0KICAgKiBMb29rIGZvciAnZGF0YScgKGFzIG9wcG9zZWQgdG8gJ2xheW91dCcpIHRhYmxlcywgZm9yIHdoaWNoIHdlIHVzZQ0KICAgKiBzaW1pbGFyIGNoZWNrcyBhcw0KICAgKiBodHRwczovL2R4ci5tb3ppbGxhLm9yZy9tb3ppbGxhLWNlbnRyYWwvcmV2LzcxMjI0MDQ5YzBiNTJhYjE5MDU2NGQzZWEwZWFiMDg5YTE1OWE0Y2YvYWNjZXNzaWJsZS9odG1sL0hUTUxUYWJsZUFjY2Vzc2libGUuY3BwIzkyMA0KICAgKi8NCiAgX21hcmtEYXRhVGFibGVzOiBmdW5jdGlvbihyb290KSB7DQogICAgdmFyIHRhYmxlcyA9IHJvb3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRhYmxlIik7DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgIHZhciB0YWJsZSA9IHRhYmxlc1tpXTsNCiAgICAgIHZhciByb2xlID0gdGFibGUuZ2V0QXR0cmlidXRlKCJyb2xlIik7DQogICAgICBpZiAocm9sZSA9PSAicHJlc2VudGF0aW9uIikgew0KICAgICAgICB0YWJsZS5fcmVhZGFiaWxpdHlEYXRhVGFibGUgPSBmYWxzZTsNCiAgICAgICAgY29udGludWU7DQogICAgICB9DQogICAgICB2YXIgZGF0YXRhYmxlID0gdGFibGUuZ2V0QXR0cmlidXRlKCJkYXRhdGFibGUiKTsNCiAgICAgIGlmIChkYXRhdGFibGUgPT0gIjAiKSB7DQogICAgICAgIHRhYmxlLl9yZWFkYWJpbGl0eURhdGFUYWJsZSA9IGZhbHNlOw0KICAgICAgICBjb250aW51ZTsNCiAgICAgIH0NCiAgICAgIHZhciBzdW1tYXJ5ID0gdGFibGUuZ2V0QXR0cmlidXRlKCJzdW1tYXJ5Iik7DQogICAgICBpZiAoc3VtbWFyeSkgew0KICAgICAgICB0YWJsZS5fcmVhZGFiaWxpdHlEYXRhVGFibGUgPSB0cnVlOw0KICAgICAgICBjb250aW51ZTsNCiAgICAgIH0NCg0KICAgICAgdmFyIGNhcHRpb24gPSB0YWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiY2FwdGlvbiIpWzBdOw0KICAgICAgaWYgKGNhcHRpb24gJiYgY2FwdGlvbi5jaGlsZE5vZGVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgdGFibGUuX3JlYWRhYmlsaXR5RGF0YVRhYmxlID0gdHJ1ZTsNCiAgICAgICAgY29udGludWU7DQogICAgICB9DQoNCiAgICAgIC8vIElmIHRoZSB0YWJsZSBoYXMgYSBkZXNjZW5kYW50IHdpdGggYW55IG9mIHRoZXNlIHRhZ3MsIGNvbnNpZGVyIGEgZGF0YSB0YWJsZToNCiAgICAgIHZhciBkYXRhVGFibGVEZXNjZW5kYW50cyA9IFsiY29sIiwgImNvbGdyb3VwIiwgInRmb290IiwgInRoZWFkIiwgInRoIl07DQogICAgICB2YXIgZGVzY2VuZGFudEV4aXN0cyA9IGZ1bmN0aW9uKHRhZykgew0KICAgICAgICByZXR1cm4gISF0YWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWcpWzBdOw0KICAgICAgfTsNCiAgICAgIGlmIChkYXRhVGFibGVEZXNjZW5kYW50cy5zb21lKGRlc2NlbmRhbnRFeGlzdHMpKSB7DQogICAgICAgIHRoaXMubG9nKCJEYXRhIHRhYmxlIGJlY2F1c2UgZm91bmQgZGF0YS15IGRlc2NlbmRhbnQiKTsNCiAgICAgICAgdGFibGUuX3JlYWRhYmlsaXR5RGF0YVRhYmxlID0gdHJ1ZTsNCiAgICAgICAgY29udGludWU7DQogICAgICB9DQoNCiAgICAgIC8vIE5lc3RlZCB0YWJsZXMgaW5kaWNhdGUgYSBsYXlvdXQgdGFibGU6DQogICAgICBpZiAodGFibGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRhYmxlIilbMF0pIHsNCiAgICAgICAgdGFibGUuX3JlYWRhYmlsaXR5RGF0YVRhYmxlID0gZmFsc2U7DQogICAgICAgIGNvbnRpbnVlOw0KICAgICAgfQ0KDQogICAgICB2YXIgc2l6ZUluZm8gPSB0aGlzLl9nZXRSb3dBbmRDb2x1bW5Db3VudCh0YWJsZSk7DQogICAgICBpZiAoc2l6ZUluZm8ucm93cyA+PSAxMCB8fCBzaXplSW5mby5jb2x1bW5zID4gNCkgew0KICAgICAgICB0YWJsZS5fcmVhZGFiaWxpdHlEYXRhVGFibGUgPSB0cnVlOw0KICAgICAgICBjb250aW51ZTsNCiAgICAgIH0NCiAgICAgIC8vIE5vdyBqdXN0IGdvIGJ5IHNpemUgZW50aXJlbHk6DQogICAgICB0YWJsZS5fcmVhZGFiaWxpdHlEYXRhVGFibGUgPSBzaXplSW5mby5yb3dzICogc2l6ZUluZm8uY29sdW1ucyA+IDEwOw0KICAgIH0NCiAgfSwNCg0KICAvKiBjb252ZXJ0IGltYWdlcyBhbmQgZmlndXJlcyB0aGF0IGhhdmUgcHJvcGVydGllcyBsaWtlIGRhdGEtc3JjIGludG8gaW1hZ2VzIHRoYXQgY2FuIGJlIGxvYWRlZCB3aXRob3V0IEpTICovDQogIF9maXhMYXp5SW1hZ2VzOiBmdW5jdGlvbiAocm9vdCkgew0KICAgIHRoaXMuX2ZvckVhY2hOb2RlKHRoaXMuX2dldEFsbE5vZGVzV2l0aFRhZyhyb290LCBbImltZyIsICJwaWN0dXJlIiwgImZpZ3VyZSJdKSwgZnVuY3Rpb24gKGVsZW0pIHsNCiAgICAgIC8vIGFsc28gY2hlY2sgZm9yICJudWxsIiB0byB3b3JrIGFyb3VuZCBodHRwczovL2dpdGh1Yi5jb20vanNkb20vanNkb20vaXNzdWVzLzI1ODANCiAgICAgIGlmICgoIWVsZW0uc3JjICYmICghZWxlbS5zcmNzZXQgfHwgZWxlbS5zcmNzZXQgPT0gIm51bGwiKSkgfHwgZWxlbS5jbGFzc05hbWUudG9Mb3dlckNhc2UoKS5pbmRleE9mKCJsYXp5IikgIT09IC0xKSB7DQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbS5hdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgdmFyIGF0dHIgPSBlbGVtLmF0dHJpYnV0ZXNbaV07DQogICAgICAgICAgaWYgKGF0dHIubmFtZSA9PT0gInNyYyIgfHwgYXR0ci5uYW1lID09PSAic3Jjc2V0Iikgew0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgfQ0KICAgICAgICAgIHZhciBjb3B5VG8gPSBudWxsOw0KICAgICAgICAgIGlmICgvXC4oanBnfGpwZWd8cG5nfHdlYnApXHMrXGQvLnRlc3QoYXR0ci52YWx1ZSkpIHsNCiAgICAgICAgICAgIGNvcHlUbyA9ICJzcmNzZXQiOw0KICAgICAgICAgIH0gZWxzZSBpZiAoL15ccypcUytcLihqcGd8anBlZ3xwbmd8d2VicClcUypccyokLy50ZXN0KGF0dHIudmFsdWUpKSB7DQogICAgICAgICAgICBjb3B5VG8gPSAic3JjIjsNCiAgICAgICAgICB9DQogICAgICAgICAgaWYgKGNvcHlUbykgew0KICAgICAgICAgICAgLy9pZiB0aGlzIGlzIGFuIGltZyBvciBwaWN0dXJlLCBzZXQgdGhlIGF0dHJpYnV0ZSBkaXJlY3RseQ0KICAgICAgICAgICAgaWYgKGVsZW0udGFnTmFtZSA9PT0gIklNRyIgfHwgZWxlbS50YWdOYW1lID09PSAiUElDVFVSRSIpIHsNCiAgICAgICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoY29weVRvLCBhdHRyLnZhbHVlKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbS50YWdOYW1lID09PSAiRklHVVJFIiAmJiAhdGhpcy5fZ2V0QWxsTm9kZXNXaXRoVGFnKGVsZW0sIFsiaW1nIiwgInBpY3R1cmUiXSkubGVuZ3RoKSB7DQogICAgICAgICAgICAgIC8vaWYgdGhlIGl0ZW0gaXMgYSA8ZmlndXJlPiB0aGF0IGRvZXMgbm90IGNvbnRhaW4gYW4gaW1hZ2Ugb3IgcGljdHVyZSwgY3JlYXRlIG9uZSBhbmQgcGxhY2UgaXQgaW5zaWRlIHRoZSBmaWd1cmUNCiAgICAgICAgICAgICAgLy9zZWUgdGhlIG55dGltZXMtMyB0ZXN0Y2FzZSBmb3IgYW4gZXhhbXBsZQ0KICAgICAgICAgICAgICB2YXIgaW1nID0gdGhpcy5fZG9jLmNyZWF0ZUVsZW1lbnQoImltZyIpOw0KICAgICAgICAgICAgICBpbWcuc2V0QXR0cmlidXRlKGNvcHlUbywgYXR0ci52YWx1ZSk7DQogICAgICAgICAgICAgIGVsZW0uYXBwZW5kQ2hpbGQoaW1nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9KTsNCiAgfSwNCg0KICAvKioNCiAgICogQ2xlYW4gYW4gZWxlbWVudCBvZiBhbGwgdGFncyBvZiB0eXBlICJ0YWciIGlmIHRoZXkgbG9vayBmaXNoeS4NCiAgICogIkZpc2h5IiBpcyBhbiBhbGdvcml0aG0gYmFzZWQgb24gY29udGVudCBsZW5ndGgsIGNsYXNzbmFtZXMsIGxpbmsgZGVuc2l0eSwgbnVtYmVyIG9mIGltYWdlcyAmIGVtYmVkcywgZXRjLg0KICAgKg0KICAgKiBAcmV0dXJuIHZvaWQNCiAgICoqLw0KICBfY2xlYW5Db25kaXRpb25hbGx5OiBmdW5jdGlvbihlLCB0YWcpIHsNCiAgICBpZiAoIXRoaXMuX2ZsYWdJc0FjdGl2ZSh0aGlzLkZMQUdfQ0xFQU5fQ09ORElUSU9OQUxMWSkpDQogICAgICByZXR1cm47DQoNCiAgICB2YXIgaXNMaXN0ID0gdGFnID09PSAidWwiIHx8IHRhZyA9PT0gIm9sIjsNCg0KICAgIC8vIEdhdGhlciBjb3VudHMgZm9yIG90aGVyIHR5cGljYWwgZWxlbWVudHMgZW1iZWRkZWQgd2l0aGluLg0KICAgIC8vIFRyYXZlcnNlIGJhY2t3YXJkcyBzbyB3ZSBjYW4gcmVtb3ZlIG5vZGVzIGF0IHRoZSBzYW1lIHRpbWUNCiAgICAvLyB3aXRob3V0IGVmZmVjdGluZyB0aGUgdHJhdmVyc2FsLg0KICAgIC8vDQogICAgLy8gVE9ETzogQ29uc2lkZXIgdGFraW5nIGludG8gYWNjb3VudCBvcmlnaW5hbCBjb250ZW50U2NvcmUgaGVyZS4NCiAgICB0aGlzLl9yZW1vdmVOb2RlcyhlLmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZyksIGZ1bmN0aW9uKG5vZGUpIHsNCiAgICAgIC8vIEZpcnN0IGNoZWNrIGlmIHRoaXMgbm9kZSBJUyBkYXRhIHRhYmxlLCBpbiB3aGljaCBjYXNlIGRvbid0IHJlbW92ZSBpdC4NCiAgICAgIHZhciBpc0RhdGFUYWJsZSA9IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgcmV0dXJuIHQuX3JlYWRhYmlsaXR5RGF0YVRhYmxlOw0KICAgICAgfTsNCg0KICAgICAgaWYgKHRhZyA9PT0gInRhYmxlIiAmJiBpc0RhdGFUYWJsZShub2RlKSkgew0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICB9DQoNCiAgICAgIC8vIE5leHQgY2hlY2sgaWYgd2UncmUgaW5zaWRlIGEgZGF0YSB0YWJsZSwgaW4gd2hpY2ggY2FzZSBkb24ndCByZW1vdmUgaXQgYXMgd2VsbC4NCiAgICAgIGlmICh0aGlzLl9oYXNBbmNlc3RvclRhZyhub2RlLCAidGFibGUiLCAtMSwgaXNEYXRhVGFibGUpKSB7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0NCg0KICAgICAgdmFyIHdlaWdodCA9IHRoaXMuX2dldENsYXNzV2VpZ2h0KG5vZGUpOw0KICAgICAgdmFyIGNvbnRlbnRTY29yZSA9IDA7DQoNCiAgICAgIHRoaXMubG9nKCJDbGVhbmluZyBDb25kaXRpb25hbGx5Iiwgbm9kZSk7DQoNCiAgICAgIGlmICh3ZWlnaHQgKyBjb250ZW50U2NvcmUgPCAwKSB7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgfQ0KDQogICAgICBpZiAodGhpcy5fZ2V0Q2hhckNvdW50KG5vZGUsICIsIikgPCAxMCkgew0KICAgICAgICAvLyBJZiB0aGVyZSBhcmUgbm90IHZlcnkgbWFueSBjb21tYXMsIGFuZCB0aGUgbnVtYmVyIG9mDQogICAgICAgIC8vIG5vbi1wYXJhZ3JhcGggZWxlbWVudHMgaXMgbW9yZSB0aGFuIHBhcmFncmFwaHMgb3Igb3RoZXINCiAgICAgICAgLy8gb21pbm91cyBzaWducywgcmVtb3ZlIHRoZSBlbGVtZW50Lg0KICAgICAgICB2YXIgcCA9IG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInAiKS5sZW5ndGg7DQogICAgICAgIHZhciBpbWcgPSBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJpbWciKS5sZW5ndGg7DQogICAgICAgIHZhciBsaSA9IG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImxpIikubGVuZ3RoIC0gMTAwOw0KICAgICAgICB2YXIgaW5wdXQgPSBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJpbnB1dCIpLmxlbmd0aDsNCg0KICAgICAgICB2YXIgZW1iZWRDb3VudCA9IDA7DQogICAgICAgIHZhciBlbWJlZHMgPSB0aGlzLl9jb25jYXROb2RlTGlzdHMoDQogICAgICAgICAgbm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgib2JqZWN0IiksDQogICAgICAgICAgbm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiZW1iZWQiKSwNCiAgICAgICAgICBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJpZnJhbWUiKSk7DQoNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbWJlZHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAvLyBJZiB0aGlzIGVtYmVkIGhhcyBhdHRyaWJ1dGUgdGhhdCBtYXRjaGVzIHZpZGVvIHJlZ2V4LCBkb24ndCBkZWxldGUgaXQuDQogICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBlbWJlZHNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykgew0KICAgICAgICAgICAgaWYgKHRoaXMuUkVHRVhQUy52aWRlb3MudGVzdChlbWJlZHNbaV0uYXR0cmlidXRlc1tqXS52YWx1ZSkpIHsNCiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8vIEZvciBlbWJlZCB3aXRoIDxvYmplY3Q+IHRhZywgY2hlY2sgaW5uZXIgSFRNTCBhcyB3ZWxsLg0KICAgICAgICAgIGlmIChlbWJlZHNbaV0udGFnTmFtZSA9PT0gIm9iamVjdCIgJiYgdGhpcy5SRUdFWFBTLnZpZGVvcy50ZXN0KGVtYmVkc1tpXS5pbm5lckhUTUwpKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgZW1iZWRDb3VudCsrOw0KICAgICAgICB9DQoNCiAgICAgICAgdmFyIGxpbmtEZW5zaXR5ID0gdGhpcy5fZ2V0TGlua0RlbnNpdHkobm9kZSk7DQogICAgICAgIHZhciBjb250ZW50TGVuZ3RoID0gdGhpcy5fZ2V0SW5uZXJUZXh0KG5vZGUpLmxlbmd0aDsNCg0KICAgICAgICB2YXIgaGF2ZVRvUmVtb3ZlID0NCiAgICAgICAgICAoaW1nID4gMSAmJiBwIC8gaW1nIDwgMC41ICYmICF0aGlzLl9oYXNBbmNlc3RvclRhZyhub2RlLCAiZmlndXJlIikpIHx8DQogICAgICAgICAgKCFpc0xpc3QgJiYgbGkgPiBwKSB8fA0KICAgICAgICAgIChpbnB1dCA+IE1hdGguZmxvb3IocC8zKSkgfHwNCiAgICAgICAgICAoIWlzTGlzdCAmJiBjb250ZW50TGVuZ3RoIDwgMjUgJiYgKGltZyA9PT0gMCB8fCBpbWcgPiAyKSAmJiAhdGhpcy5faGFzQW5jZXN0b3JUYWcobm9kZSwgImZpZ3VyZSIpKSB8fA0KICAgICAgICAgICghaXNMaXN0ICYmIHdlaWdodCA8IDI1ICYmIGxpbmtEZW5zaXR5ID4gMC4yKSB8fA0KICAgICAgICAgICh3ZWlnaHQgPj0gMjUgJiYgbGlua0RlbnNpdHkgPiAwLjUpIHx8DQogICAgICAgICAgKChlbWJlZENvdW50ID09PSAxICYmIGNvbnRlbnRMZW5ndGggPCA3NSkgfHwgZW1iZWRDb3VudCA+IDEpOw0KICAgICAgICByZXR1cm4gaGF2ZVRvUmVtb3ZlOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0pOw0KICB9LA0KDQogIC8qKg0KICAgKiBDbGVhbiBvdXQgZWxlbWVudHMgdGhhdCBtYXRjaCB0aGUgc3BlY2lmaWVkIGNvbmRpdGlvbnMNCiAgICoNCiAgICogQHBhcmFtIEVsZW1lbnQNCiAgICogQHBhcmFtIEZ1bmN0aW9uIGRldGVybWluZXMgd2hldGhlciBhIG5vZGUgc2hvdWxkIGJlIHJlbW92ZWQNCiAgICogQHJldHVybiB2b2lkDQogICAqKi8NCiAgX2NsZWFuTWF0Y2hlZE5vZGVzOiBmdW5jdGlvbihlLCBmaWx0ZXIpIHsNCiAgICB2YXIgZW5kT2ZTZWFyY2hNYXJrZXJOb2RlID0gdGhpcy5fZ2V0TmV4dE5vZGUoZSwgdHJ1ZSk7DQogICAgdmFyIG5leHQgPSB0aGlzLl9nZXROZXh0Tm9kZShlKTsNCiAgICB3aGlsZSAobmV4dCAmJiBuZXh0ICE9IGVuZE9mU2VhcmNoTWFya2VyTm9kZSkgew0KICAgICAgaWYgKGZpbHRlci5jYWxsKHRoaXMsIG5leHQsIG5leHQuY2xhc3NOYW1lICsgIiAiICsgbmV4dC5pZCkpIHsNCiAgICAgICAgbmV4dCA9IHRoaXMuX3JlbW92ZUFuZEdldE5leHQobmV4dCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBuZXh0ID0gdGhpcy5fZ2V0TmV4dE5vZGUobmV4dCk7DQogICAgICB9DQogICAgfQ0KICB9LA0KDQogIC8qKg0KICAgKiBDbGVhbiBvdXQgc3B1cmlvdXMgaGVhZGVycyBmcm9tIGFuIEVsZW1lbnQuIENoZWNrcyB0aGluZ3MgbGlrZSBjbGFzc25hbWVzIGFuZCBsaW5rIGRlbnNpdHkuDQogICAqDQogICAqIEBwYXJhbSBFbGVtZW50DQogICAqIEByZXR1cm4gdm9pZA0KICAqKi8NCiAgX2NsZWFuSGVhZGVyczogZnVuY3Rpb24oZSkgew0KICAgIGZvciAodmFyIGhlYWRlckluZGV4ID0gMTsgaGVhZGVySW5kZXggPCAzOyBoZWFkZXJJbmRleCArPSAxKSB7DQogICAgICB0aGlzLl9yZW1vdmVOb2RlcyhlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJoIiArIGhlYWRlckluZGV4KSwgZnVuY3Rpb24gKGhlYWRlcikgew0KICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Q2xhc3NXZWlnaHQoaGVhZGVyKSA8IDA7DQogICAgICB9KTsNCiAgICB9DQogIH0sDQoNCiAgX2ZsYWdJc0FjdGl2ZTogZnVuY3Rpb24oZmxhZykgew0KICAgIHJldHVybiAodGhpcy5fZmxhZ3MgJiBmbGFnKSA+IDA7DQogIH0sDQoNCiAgX3JlbW92ZUZsYWc6IGZ1bmN0aW9uKGZsYWcpIHsNCiAgICB0aGlzLl9mbGFncyA9IHRoaXMuX2ZsYWdzICYgfmZsYWc7DQogIH0sDQoNCiAgX2lzUHJvYmFibHlWaXNpYmxlOiBmdW5jdGlvbihub2RlKSB7DQogICAgcmV0dXJuICghbm9kZS5zdHlsZSB8fCBub2RlLnN0eWxlLmRpc3BsYXkgIT0gIm5vbmUiKQ0KICAgICAgJiYgIW5vZGUuaGFzQXR0cmlidXRlKCJoaWRkZW4iKQ0KICAgICAgJiYgKCFub2RlLmhhc0F0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iKSB8fCBub2RlLmdldEF0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iKSAhPSAidHJ1ZSIpOw0KICB9LA0KDQogIC8qKg0KICAgKiBSdW5zIHJlYWRhYmlsaXR5Lg0KICAgKg0KICAgKiBXb3JrZmxvdzoNCiAgICogIDEuIFByZXAgdGhlIGRvY3VtZW50IGJ5IHJlbW92aW5nIHNjcmlwdCB0YWdzLCBjc3MsIGV0Yy4NCiAgICogIDIuIEJ1aWxkIHJlYWRhYmlsaXR5J3MgRE9NIHRyZWUuDQogICAqICAzLiBHcmFiIHRoZSBhcnRpY2xlIGNvbnRlbnQgZnJvbSB0aGUgY3VycmVudCBkb20gdHJlZS4NCiAgICogIDQuIFJlcGxhY2UgdGhlIGN1cnJlbnQgRE9NIHRyZWUgd2l0aCB0aGUgbmV3IG9uZS4NCiAgICogIDUuIFJlYWQgcGVhY2VmdWxseS4NCiAgICoNCiAgICogQHJldHVybiB2b2lkDQogICAqKi8NCiAgcGFyc2U6IGZ1bmN0aW9uICgpIHsNCiAgICAvLyBBdm9pZCBwYXJzaW5nIHRvbyBsYXJnZSBkb2N1bWVudHMsIGFzIHBlciBjb25maWd1cmF0aW9uIG9wdGlvbg0KICAgIGlmICh0aGlzLl9tYXhFbGVtc1RvUGFyc2UgPiAwKSB7DQogICAgICB2YXIgbnVtVGFncyA9IHRoaXMuX2RvYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLmxlbmd0aDsNCiAgICAgIGlmIChudW1UYWdzID4gdGhpcy5fbWF4RWxlbXNUb1BhcnNlKSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcigiQWJvcnRpbmcgcGFyc2luZyBkb2N1bWVudDsgIiArIG51bVRhZ3MgKyAiIGVsZW1lbnRzIGZvdW5kIik7DQogICAgICB9DQogICAgfQ0KDQogICAgLy8gUmVtb3ZlIHNjcmlwdCB0YWdzIGZyb20gdGhlIGRvY3VtZW50Lg0KICAgIHRoaXMuX3JlbW92ZVNjcmlwdHModGhpcy5fZG9jKTsNCg0KICAgIHRoaXMuX3ByZXBEb2N1bWVudCgpOw0KDQogICAgdmFyIG1ldGFkYXRhID0gdGhpcy5fZ2V0QXJ0aWNsZU1ldGFkYXRhKCk7DQogICAgdGhpcy5fYXJ0aWNsZVRpdGxlID0gbWV0YWRhdGEudGl0bGU7DQoNCiAgICB2YXIgYXJ0aWNsZUNvbnRlbnQgPSB0aGlzLl9ncmFiQXJ0aWNsZSgpOw0KICAgIGlmICghYXJ0aWNsZUNvbnRlbnQpDQogICAgICByZXR1cm4gbnVsbDsNCg0KICAgIHRoaXMubG9nKCJHcmFiYmVkOiAiICsgYXJ0aWNsZUNvbnRlbnQuaW5uZXJIVE1MKTsNCg0KICAgIHRoaXMuX3Bvc3RQcm9jZXNzQ29udGVudChhcnRpY2xlQ29udGVudCk7DQoNCiAgICAvLyBJZiB3ZSBoYXZlbid0IGZvdW5kIGFuIGV4Y2VycHQgaW4gdGhlIGFydGljbGUncyBtZXRhZGF0YSwgdXNlIHRoZSBhcnRpY2xlJ3MNCiAgICAvLyBmaXJzdCBwYXJhZ3JhcGggYXMgdGhlIGV4Y2VycHQuIFRoaXMgaXMgdXNlZCBmb3IgZGlzcGxheWluZyBhIHByZXZpZXcgb2YNCiAgICAvLyB0aGUgYXJ0aWNsZSdzIGNvbnRlbnQuDQogICAgaWYgKCFtZXRhZGF0YS5leGNlcnB0KSB7DQogICAgICB2YXIgcGFyYWdyYXBocyA9IGFydGljbGVDb250ZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJwIik7DQogICAgICBpZiAocGFyYWdyYXBocy5sZW5ndGggPiAwKSB7DQogICAgICAgIG1ldGFkYXRhLmV4Y2VycHQgPSBwYXJhZ3JhcGhzWzBdLnRleHRDb250ZW50LnRyaW0oKTsNCiAgICAgIH0NCiAgICB9DQoNCiAgICB2YXIgdGV4dENvbnRlbnQgPSBhcnRpY2xlQ29udGVudC50ZXh0Q29udGVudDsNCiAgICByZXR1cm4gew0KICAgICAgdGl0bGU6IHRoaXMuX2FydGljbGVUaXRsZSwNCiAgICAgIGJ5bGluZTogbWV0YWRhdGEuYnlsaW5lIHx8IHRoaXMuX2FydGljbGVCeWxpbmUsDQogICAgICBkaXI6IHRoaXMuX2FydGljbGVEaXIsDQogICAgICBjb250ZW50OiBhcnRpY2xlQ29udGVudC5pbm5lckhUTUwsDQogICAgICB0ZXh0Q29udGVudDogdGV4dENvbnRlbnQsDQogICAgICBsZW5ndGg6IHRleHRDb250ZW50Lmxlbmd0aCwNCiAgICAgIGV4Y2VycHQ6IG1ldGFkYXRhLmV4Y2VycHQsDQogICAgICBzaXRlTmFtZTogbWV0YWRhdGEuc2l0ZU5hbWUgfHwgdGhpcy5fYXJ0aWNsZVNpdGVOYW1lDQogICAgfTsNCiAgfQ0KfTsNCg0KaWYgKHR5cGVvZiBtb2R1bGUgPT09ICJvYmplY3QiKSB7DQogIG1vZHVsZS5leHBvcnRzID0gUmVhZGFiaWxpdHk7DQp9DQo="
                                },
                                {
                                    "id": "readability/1.0/js/Readability-readerable.js",
                                    "source": "LyogZXNsaW50LWVudiBlczY6ZmFsc2UgKi8NCi8qIGdsb2JhbHMgZXhwb3J0cyAqLw0KLyoNCiAqIENvcHlyaWdodCAoYykgMjAxMCBBcmM5MCBJbmMNCiAqDQogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsNCiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KICoNCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQogKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLA0KICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuDQogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQogKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4NCiAqLw0KDQovKg0KICogVGhpcyBjb2RlIGlzIGhlYXZpbHkgYmFzZWQgb24gQXJjOTAncyByZWFkYWJpbGl0eS5qcyAoMS43LjEpIHNjcmlwdA0KICogYXZhaWxhYmxlIGF0OiBodHRwOi8vY29kZS5nb29nbGUuY29tL3AvYXJjOTBsYWJzLXJlYWRhYmlsaXR5DQogKi8NCg0KdmFyIFJFR0VYUFMgPSB7DQogICAgLy8gTk9URTogVGhlc2UgdHdvIHJlZ3VsYXIgZXhwcmVzc2lvbnMgYXJlIGR1cGxpY2F0ZWQgaW4NCiAgICAvLyBSZWFkYWJpbGl0eS5qcy4gUGxlYXNlIGtlZXAgYm90aCBjb3BpZXMgaW4gc3luYy4NCiAgICB1bmxpa2VseUNhbmRpZGF0ZXM6IC8tYWQtfGFpMmh0bWx8YmFubmVyfGJyZWFkY3J1bWJzfGNvbWJ4fGNvbW1lbnR8Y29tbXVuaXR5fGNvdmVyLXdyYXB8ZGlzcXVzfGV4dHJhfGZvb3RlcnxnZHByfGhlYWRlcnxsZWdlbmRzfG1lbnV8cmVsYXRlZHxyZW1hcmt8cmVwbGllc3xyc3N8c2hvdXRib3h8c2lkZWJhcnxza3lzY3JhcGVyfHNvY2lhbHxzcG9uc29yfHN1cHBsZW1lbnRhbHxhZC1icmVha3xhZ2VnYXRlfHBhZ2luYXRpb258cGFnZXJ8cG9wdXB8eW9tLXJlbW90ZS9pLA0KICAgIG9rTWF5YmVJdHNBQ2FuZGlkYXRlOiAvYW5kfGFydGljbGV8Ym9keXxjb2x1bW58bWFpbnxzaGFkb3cvaSwNCn07DQoNCmZ1bmN0aW9uIGlzTm9kZVZpc2libGUobm9kZSkgew0KICAgIC8vIEhhdmUgdG8gbnVsbC1jaGVjayBub2RlLnN0eWxlIHRvIGRlYWwgd2l0aCBTVkcgYW5kIE1hdGhNTCBub2Rlcy4NCiAgICByZXR1cm4gKCFub2RlLnN0eWxlIHx8IG5vZGUuc3R5bGUuZGlzcGxheSAhPSAibm9uZSIpICYmICFub2RlLmhhc0F0dHJpYnV0ZSgiaGlkZGVuIikNCiAgICAgICAgJiYgKCFub2RlLmhhc0F0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iKSB8fCBub2RlLmdldEF0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iKSAhPSAidHJ1ZSIpOw0KfQ0KDQovKioNCiAqIERlY2lkZXMgd2hldGhlciBvciBub3QgdGhlIGRvY3VtZW50IGlzIHJlYWRlci1hYmxlIHdpdGhvdXQgcGFyc2luZyB0aGUgd2hvbGUgdGhpbmcuDQogKg0KICogQHJldHVybiBib29sZWFuIFdoZXRoZXIgb3Igbm90IHdlIHN1c3BlY3QgUmVhZGFiaWxpdHkucGFyc2UoKSB3aWxsIHN1Y2VlZWQgYXQgcmV0dXJuaW5nIGFuIGFydGljbGUgb2JqZWN0Lg0KICovDQpmdW5jdGlvbiBpc1Byb2JhYmx5UmVhZGVyYWJsZShkb2MsIGlzVmlzaWJsZSkgew0KICAgIGlmICghaXNWaXNpYmxlKSB7DQogICAgICAgIGlzVmlzaWJsZSA9IGlzTm9kZVZpc2libGU7DQogICAgfQ0KDQogICAgdmFyIG5vZGVzID0gZG9jLnF1ZXJ5U2VsZWN0b3JBbGwoInAsIHByZSIpOw0KDQogICAgLy8gR2V0IDxkaXY+IG5vZGVzIHdoaWNoIGhhdmUgPGJyPiBub2RlKHMpIGFuZCBhcHBlbmQgdGhlbSBpbnRvIHRoZSBgbm9kZXNgIHZhcmlhYmxlLg0KICAgIC8vIFNvbWUgYXJ0aWNsZXMnIERPTSBzdHJ1Y3R1cmVzIG1pZ2h0IGxvb2sgbGlrZQ0KICAgIC8vIDxkaXY+DQogICAgLy8gICBTZW50ZW5jZXM8YnI+DQogICAgLy8gICA8YnI+DQogICAgLy8gICBTZW50ZW5jZXM8YnI+DQogICAgLy8gPC9kaXY+DQogICAgdmFyIGJyTm9kZXMgPSBkb2MucXVlcnlTZWxlY3RvckFsbCgiZGl2ID4gYnIiKTsNCiAgICBpZiAoYnJOb2Rlcy5sZW5ndGgpIHsNCiAgICAgICAgdmFyIHNldCA9IG5ldyBTZXQobm9kZXMpOw0KICAgICAgICBbXS5mb3JFYWNoLmNhbGwoYnJOb2RlcywgZnVuY3Rpb24obm9kZSkgew0KICAgICAgICAgICAgc2V0LmFkZChub2RlLnBhcmVudE5vZGUpOw0KICAgICAgICB9KTsNCiAgICAgICAgbm9kZXMgPSBBcnJheS5mcm9tKHNldCk7DQogICAgfQ0KDQogICAgdmFyIHNjb3JlID0gMDsNCiAgICAvLyBUaGlzIGlzIGEgbGl0dGxlIGNoZWVreSwgd2UgdXNlIHRoZSBhY2N1bXVsYXRvciAnc2NvcmUnIHRvIGRlY2lkZSB3aGF0IHRvIHJldHVybiBmcm9tDQogICAgLy8gdGhpcyBjYWxsYmFjazoNCiAgICByZXR1cm4gW10uc29tZS5jYWxsKG5vZGVzLCBmdW5jdGlvbihub2RlKSB7DQogICAgICAgIGlmICghaXNWaXNpYmxlKG5vZGUpKQ0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KDQogICAgICAgIHZhciBtYXRjaFN0cmluZyA9IG5vZGUuY2xhc3NOYW1lICsgIiAiICsgbm9kZS5pZDsNCiAgICAgICAgaWYgKFJFR0VYUFMudW5saWtlbHlDYW5kaWRhdGVzLnRlc3QobWF0Y2hTdHJpbmcpICYmDQogICAgICAgICAgICAhUkVHRVhQUy5va01heWJlSXRzQUNhbmRpZGF0ZS50ZXN0KG1hdGNoU3RyaW5nKSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG5vZGUubWF0Y2hlcygibGkgcCIpKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICB2YXIgdGV4dENvbnRlbnRMZW5ndGggPSBub2RlLnRleHRDb250ZW50LnRyaW0oKS5sZW5ndGg7DQogICAgICAgIGlmICh0ZXh0Q29udGVudExlbmd0aCA8IDE0MCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgc2NvcmUgKz0gTWF0aC5zcXJ0KHRleHRDb250ZW50TGVuZ3RoIC0gMTQwKTsNCg0KICAgICAgICAvL09sZCB2YWx1ZSB3YXMgMjANCiAgICAgICAgaWYgKHNjb3JlID4gMzApIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9KTsNCn0="
                                },
                                {
                                    "id": "readability/1.0/js/readabilityController.js",
                                    "source": "bGV0IGVyUmVhZGFiaWxpdHlBY3RpdmUgPSBmYWxzZTsNCg0KZnVuY3Rpb24gcmVhZGFiaWxpdHkocmVxLCBjb25maWcsd2lkZ2V0KSB7DQoNCiAgICBjb25maWcgPSB7DQogICAgICAgIGNvbnRlbnRXaWR0aDogNTAsDQogICAgICAgIGZvbnRTaXplOiAyNCwNCiAgICAgICAgbGluZVNwYWNpbmc6IDIuNSwNCiAgICB9Ow0KDQogICAgaWYoZXJSZWFkYWJpbGl0eUFjdGl2ZSl7DQoNCiAgICAgICAgJCgiLmVyLXJlYWRhYmlsaXR5LWhpZGRlbiIpLnJlbW92ZUNsYXNzKCJlci1yZWFkYWJpbGl0eS1oaWRkZW4iKTsNCiAgICAgICAgJCgiI2VyLXJlYWRhYmlsaXR5LWNvbnRhaW5lciIpLnJlbW92ZSgpOw0KICAgICAgICAkKCJib2R5IikucmVtb3ZlQ2xhc3MoImVyLXJlYWRhYmlsaXR5LWJvZHkiKTsNCiAgICB9ZWxzZXsNCiAgICAgICAgbGV0IHNlbnRlbmNlVG9rZW5pemVyID0gbmV3IFNlbnRlbmNlVG9rZW5pemVyKCk7DQogICAgICAgIGlmKGlzUHJvYmFibHlSZWFkZXJhYmxlKGRvY3VtZW50KSl7DQoNCiAgICAgICAgICAgIGxldCBvcHRpb25zID0gew0KICAgICAgICAgICAgICAgICJuZXdsaW5lX2JvdW5kYXJpZXMiIDogZmFsc2UsDQogICAgICAgICAgICAgICAgImh0bWxfYm91bmRhcmllcyIgICAgOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAic2FuaXRpemUiICAgICAgICAgICA6IGZhbHNlLA0KICAgICAgICAgICAgICAgICJhbGxvd2VkX3RhZ3MiICAgICAgIDogZmFsc2UsDQogICAgICAgICAgICAgICAgInByZXNlcnZlX3doaXRlc3BhY2UiIDogdHJ1ZSwNCiAgICAgICAgICAgICAgICAiYWJicmV2aWF0aW9ucyIgICAgICA6IG51bGwNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICBsZXQgZG9jdW1lbnRDbG9uZSA9IGRvY3VtZW50LmNsb25lTm9kZSh0cnVlKTsNCiAgICAgICAgICAgIGxldCBhcnRpY2xlID0gbmV3IFJlYWRhYmlsaXR5KGRvY3VtZW50Q2xvbmUpLnBhcnNlKCk7DQoNCg0KICAgICAgICAgICAgbGV0IHRpdGxlID0gIjxoMT4iK2FydGljbGUudGl0bGUrIjwvaDE+IjsNCiAgICAgICAgICAgIGxldCByZWFkYWJpbGl0eUNvbnRlbnQgPSAkLnBhcnNlSFRNTCh0aXRsZSthcnRpY2xlLmNvbnRlbnQpOw0KDQogICAgICAgICAgICBsZXQgY29udGFpbmVyID0gJC5wYXJzZUhUTUwoIjxkaXYgY2xhc3M9J2VyLXJlYWRhYmlsaXR5LWJhY2tncm91bmQnPiIgKw0KICAgICAgICAgICAgICAgICIgICA8ZGl2IGNsYXNzPSdlci1yZWFkYWJpbGl0eS1jb250YWluZXInIGlkPSdlci1yZWFkYWJpbGl0eS1jb250YWluZXInPiIgKw0KICAgICAgICAgICAgICAgICIgICA8L2Rpdj4iICsNCiAgICAgICAgICAgICAgICAiPC9kaXY+Iik7DQogICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKGNvbnRhaW5lcik7DQogICAgICAgICAgICAkKCcjZXItcmVhZGFiaWxpdHktY29udGFpbmVyJykuYXBwZW5kKHJlYWRhYmlsaXR5Q29udGVudCk7DQoNCg0KICAgICAgICAgICAgJCgnI2VyLXJlYWRhYmlsaXR5LWNvbnRhaW5lciAqOmVtcHR5JyApLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIGlmKCQodGhpcykuaXMoImltZyIpKXsNCg0KICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KDQoNCiAgICAgICAgICAgIGxldCB3aGl0ZWxpc3QgPSBbInNyYyIsImFsdCIsInRpdGxlIiwiaHJlZiIsImNvbHNwYW4iLCJyb3dzcGFuIiwic2NvcGUiLCJsYW5nIl07DQogICAgICAgICAgICAkKCcjZXItcmVhZGFiaWxpdHktY29udGFpbmVyIConKS5lYWNoKGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzOw0KICAgICAgICAgICAgICAgIHZhciBpID0gYXR0cmlidXRlcy5sZW5ndGg7DQogICAgICAgICAgICAgICAgd2hpbGUoIGktLSApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHIgPSBhdHRyaWJ1dGVzW2ldOw0KICAgICAgICAgICAgICAgICAgICBpZiggJC5pbkFycmF5KGF0dHIubmFtZSx3aGl0ZWxpc3QpID09IC0xICkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlTm9kZShhdHRyKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgJCgnI2VyLXJlYWRhYmlsaXR5LWNvbnRhaW5lciBwJykuZWFjaChmdW5jdGlvbiAoKSB7DQoNCiAgICAgICAgICAgICAgICBsZXQgaHRtbCA9ICQodGhpcykuaHRtbCgpOw0KICAgICAgICAgICAgICAgIGxldCBzZW50ZW5jZXMgPSBlcl90b2tlbml6ZXIuc2VudGVuY2VzKGh0bWwsb3B0aW9ucyk7DQogICAgICAgICAgICAgICAgbGV0IHNlbnRlbmNlc1dpdGhCUiA9ICIiOw0KICAgICAgICAgICAgICAgIGZvcihsZXQgaT0wOyBpIDwgc2VudGVuY2VzLmxlbmd0aDsgaSsrKXsNCg0KICAgICAgICAgICAgICAgICAgICBzZW50ZW5jZXNXaXRoQlIrPXNlbnRlbmNlc1tpXTsNCiAgICAgICAgICAgICAgICAgICAgaWYoaSA8IHNlbnRlbmNlcy5sZW5ndGgtMSl7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW50ZW5jZXNXaXRoQlIrPSI8YnI+IjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAkKHRoaXMpLmh0bWwoc2VudGVuY2VzV2l0aEJSKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgJCgnYm9keScpLmNoaWxkcmVuKCkuZWFjaChmdW5jdGlvbiAoKSB7DQoNCiAgICAgICAgICAgICAgICBpZigkKHRoaXMpLmhhc0NsYXNzKCJlYXN5LXJlYWRpbmctaW50ZXJmYWNlIikgfHwgJCh0aGlzKS5oYXNDbGFzcygiZXItcmVhZGFiaWxpdHktYmFja2dyb3VuZCIpKXsNCg0KICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdlci1yZWFkYWJpbGl0eS1oaWRkZW4nKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgJCgiYm9keSIpLmFkZENsYXNzKCJlci1yZWFkYWJpbGl0eS1ib2R5Iik7DQogICAgICAgICAgICAkKCcjZXItcmVhZGFiaWxpdHktY29udGFpbmVyIConKS5hZGRDbGFzcygiZXItcmVhZGFiaWxpdHktc3R5bGUtcmV2ZXJ0Iik7DQoNCiAgICAgICAgICAgICQoIi5lci1yZWFkYWJpbGl0eS1jb250YWluZXIiKS5jc3MoIm1heC13aWR0aCIsIGNvbmZpZy5jb250ZW50V2lkdGgrIiUiKTsNCiAgICAgICAgICAgICQoIi5lci1yZWFkYWJpbGl0eS1jb250YWluZXIiKS5jc3MoImZvbnQtc2l6ZSIsIGNvbmZpZy5mb250U2l6ZSk7DQogICAgICAgICAgICAkKCIuZXItcmVhZGFiaWxpdHktY29udGFpbmVyIikuY3NzKCJsaW5lLWhlaWdodCIsIGNvbmZpZy5saW5lU3BhY2luZyk7DQoNCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgICBhbGVydE1hbmFnZXIuc2hvd0Vycm9yQWxlcnQoIlNvcnJ5IEkgY291bGQgbm90IGRldGVjdCB0aGUgY29udGVudCBvZiB0aGUgcGFnZS4iKTsNCg0KICAgICAgICAgICAgd2lkZ2V0LnJlcXVlc3RGYWlsZWQocmVxLGNvbmZpZyk7DQogICAgICAgIH0NCg0KDQogICAgfQ0KDQogICAgZXJSZWFkYWJpbGl0eUFjdGl2ZSA9ICFlclJlYWRhYmlsaXR5QWN0aXZlOw0KDQoNCg0KDQoNCn0="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "readability/1.0/css/style.css",
                                    "css": "DQouZXItcmVhZGFiaWxpdHktYmFja2dyb3VuZHsNCiAgICBhbGw6IHJldmVydDsNCg0KfQ0KDQouZXItcmVhZGFiaWxpdHktc3R5bGUtcmV2ZXJ0ew0KICAgIGFsbDogcmV2ZXJ0Ow0KfQ0KDQouZXItcmVhZGFiaWxpdHktYm9keXsNCiAgICBhbGw6cmV2ZXJ0ICFpbXBvcnRhbnQ7DQp9DQoNCi5lci1yZWFkYWJpbGl0eS1oaWRkZW57DQogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Ow0KfQ0KDQouZXItcmVhZGFiaWxpdHktY29udGFpbmVyIHsNCiAgICBtYXgtd2lkdGg6IDQwJTsNCiAgICBtYXJnaW46IDAgYXV0bzsNCiAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsNCiAgICBmb250LXNpemU6IDI0cHg7DQogICAgbGluZS1oZWlnaHQ6IDIuMmVtOw0KICAgIGhlaWdodDogYXV0bzsNCn0NCg0KDQouZXItcmVhZGFiaWxpdHktY29udGFpbmVyIHRhYmxlIHsNCiAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOw0KfQ0KDQouZXItcmVhZGFiaWxpdHktY29udGFpbmVyIHRhYmxlLCAuZXItcmVhZGFiaWxpdHktY29udGFpbmVyIHRoLC5lci1yZWFkYWJpbGl0eS1jb250YWluZXIgdGQgew0KICAgIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrOw0KfQ0KDQouZXItcmVhZGFiaWxpdHktY29udGFpbmVyIGJyew0KDQogICAgbWFyZ2luLWJvdHRvbTogMjBweDsNCn0NCg0KLmVyLXJlYWRhYmlsaXR5LWNvbnRhaW5lciBwew0KDQogICAgbWFyZ2luLWJvdHRvbTogMzBweDsNCn0="
                                }
                            ]
                        }
                    },
                    "widget": {
                        "source": {
                            "id": "two-state-button",
                            "name": "Two state button",
                            "description": "A simple two state button.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "",
                            "remoteBaseDirectory": "components/widget/two-state-button/1.0/",
                            "implementationClass": "TwoStateButton",
                            "contentScripts": [
                                {
                                    "id": "widget/two-state-button.js",
                                    "source": "Y2xhc3MgVHdvU3RhdGVCdXR0b24gZXh0ZW5kcyBXaWRnZXRCYXNlew0KDQogICAgY29uc3RydWN0b3IoZnVuY3Rpb25JbmZvLCB1c2VySW50ZXJmYWNlLHRhcmdldElELCBjb25maWd1cmF0aW9uKXsNCiAgICAgICAgc3VwZXIoZnVuY3Rpb25JbmZvLHVzZXJJbnRlcmZhY2UsdGFyZ2V0SUQsY29uZmlndXJhdGlvbik7DQoNCiAgICAgICAgY29uc29sZS5sb2codGhpcy53aWRnZXRJRCApOw0KICAgICAgICB0aGlzLndpZGdldElEID0gJ2VyX2J1dHRvbl8nK3RoaXMud2lkZ2V0SUQ7DQogICAgICAgICQoIiMiK3RhcmdldElEKS5hcHBlbmQoIjxidXR0b24gaWQ9JyIrdGhpcy53aWRnZXRJRCsiJyBjbGFzcz0nZWFzeS1yZWFkaW5nLXR3by1zdGF0ZS1idXR0b24nPjxpbWcgc3JjPSciK2Z1bmN0aW9uSW5mby5zb3VyY2UuZGVmYXVsdEljb25VUkwrIicgdGl0bGU9JyIrZnVuY3Rpb25JbmZvLnNvdXJjZS5uYW1lKyI6ICIrZnVuY3Rpb25JbmZvLnNvdXJjZS5kZXNjcmlwdGlvbisiJz4gPC9idXR0b24+Iik7DQogICAgICAgIHRoaXMuZW5hYmxlKCk7DQogICAgICAgIHRoaXMucHJlc3NlZCA9IGZhbHNlOw0KICAgIH0NCg0KICAgIGVuYWJsZSgpew0KICAgICAgICAkKCIjIit0aGlzLndpZGdldElEKS5vbiggImNsaWNrIix0aGlzLCB0aGlzLmJ1dHRvbkNsaWNrZWQpOw0KDQogICAgfQ0KDQogICAgZGlzYWJsZSgpew0KICAgICAgICAkKCIjIit0aGlzLndpZGdldElEKS5vZmYoICJjbGljayIsdGhpcywgdGhpcy5idXR0b25DbGlja2VkKTsNCg0KDQogICAgfQ0KDQogICAgYnV0dG9uQ2xpY2tlZChlKXsNCiAgICAgICAgZS5kYXRhLnByZXNzZWQgPSAhZS5kYXRhLnByZXNzZWQ7DQogICAgICAgICQoIiMiK2UuZGF0YS53aWRnZXRJRCkudG9nZ2xlQ2xhc3MoICJlci1idXR0b24tYWN0aXZlIiApOw0KICAgICAgICBsZXQgdm9pZElucHV0ID0gew0KICAgICAgICAgICAgdHlwZTogIlZvaWQiLA0KICAgICAgICB9Ow0KICAgICAgICByZXF1ZXN0TWFuYWdlci5jcmVhdGVSZXF1ZXN0KGUuZGF0YSwgdm9pZElucHV0LCBlKTsNCiAgICB9DQoNCiAgICByZW1vdmUoKXsNCiAgICAgICAgJCgiIyIrdGhpcy53aWRnZXRJRCkucmVtb3ZlKCk7DQoNCg0KICAgIH0NCg0KICAgIHJlcXVlc3RGYWlsZWQocmVxLGNvbmZpZyl7DQogICAgICAgICQoIiMiK3RoaXMud2lkZ2V0SUQpLnJlbW92ZUNsYXNzKCAiZXItYnV0dG9uLWFjdGl2ZSIgKTsNCiAgICAgICAgdGhpcy5wcmVzc2VkID0gZmFsc2U7DQogICAgfQ0KfQ0K"
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "widget/two-state-button.css",
                                    "css": "LmVhc3ktcmVhZGluZy10d28tc3RhdGUtYnV0dG9uPmltZ3sNCiAgICBtYXgtd2lkdGg6IDEwMCU7DQp9DQoNCi5lYXN5LXJlYWRpbmctdHdvLXN0YXRlLWJ1dHRvbnsNCiAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmUgIWltcG9ydGFudDsNCiAgICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDAgIWltcG9ydGFudDsNCiAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7DQp9DQo="
                                }
                            ]
                        }
                    }
                },
                {
                    "function": {
                        "source": {
                            "id": "screen-ruler",
                            "engine": {
                                "id": "screen-ruler",
                                "version": "1.0",
                                "debugMode": false
                            },
                            "debugMode": false,
                            "name": "Screen ruler",
                            "description": "Creates a screenruler for better reading",
                            "inputTypes": [
                                {
                                    "inputType": "VoidIOType"
                                }
                            ],
                            "outputTypes": [
                                {
                                    "outputType": "VoidIOType"
                                }
                            ],
                            "defaultIcon": "assets/screen-ruler.png",
                            "defaultIconURL": "https://localhost:8080/components/engines/screen-ruler/1.0/assets/screen-ruler.png",
                            "remoteBaseDirectory": "components/engines/screen-ruler/1.0/",
                            "type": "LocalFunction",
                            "entryPoint": "easyReadingScreenRuler",
                            "remoteAssetDirectory": "",
                            "contentScripts": [
                                {
                                    "id": "screen-ruler/1.0/js/screen-ruler.js",
                                    "source": "bGV0IGVhc3lSZWFkaW5nU2NyZWVuUnVsZXJWaXNpYmxlID0gZmFsc2U7DQpsZXQgZWFzeVJlYWRpbmdTY3JlZW5SdWxlckN1cnJlbnRDbGllbnRZID0gMDsNCg0KZnVuY3Rpb24gZWFzeVJlYWRpbmdTY3JlZW5SdWxlcihyZXEsIGNvbmZpZyx3aWRnZXQpIHsNCg0KICAgIGlmKGVhc3lSZWFkaW5nU2NyZWVuUnVsZXJWaXNpYmxlKXsNCiAgICAgICAgaGlkZUVhc3lSZWFkaW5nU2NyZWVuUnVsZXIoKTsNCiAgICB9ZWxzZXsNCiAgICAgICAgc2hvd0Vhc3lSZWFkaW5nU2NyZWVuUnVsZXIoKTsNCiAgICB9DQogICAgZWFzeVJlYWRpbmdTY3JlZW5SdWxlclZpc2libGUgPSAhZWFzeVJlYWRpbmdTY3JlZW5SdWxlclZpc2libGU7DQp9DQoNCmxldCBsaXN0ZW5lciA9IGZ1bmN0aW9uKGV2ZW50KXsNCiAgICBpZihlYXN5UmVhZGluZ1NjcmVlblJ1bGVyVmlzaWJsZSl7DQogICAgICAgICQoIiNvdmVybGF5LXRvcCIpLmNzcygiYm90dG9tIiwgJCh3aW5kb3cpLmhlaWdodCgpIC1ldmVudC5jbGllbnRZICsyMCk7DQogICAgICAgICQoIiNvdmVybGF5LWJvdHRvbSIpLmNzcygidG9wIiwgZXZlbnQuY2xpZW50WSArMjApOw0KICAgIH0NCg0KICAgIGVhc3lSZWFkaW5nU2NyZWVuUnVsZXJDdXJyZW50Q2xpZW50WSA9IGV2ZW50LmNsaWVudFk7DQp9Ow0KDQpmdW5jdGlvbiBzaG93RWFzeVJlYWRpbmdTY3JlZW5SdWxlcigpIHsNCg0KICAgICQoJ2JvZHknKS5hcHBlbmQoJzxkaXYgaWQ9Im92ZXJsYXktdG9wIj48L2Rpdj48ZGl2IGlkPSJvdmVybGF5LWJvdHRvbSI+PC9kaXY+Jyk7DQogICAgJCgiI292ZXJsYXktdG9wIikuY3NzKCJib3R0b20iLCAkKHdpbmRvdykuaGVpZ2h0KCkgLWVhc3lSZWFkaW5nU2NyZWVuUnVsZXJDdXJyZW50Q2xpZW50WSArMjApOw0KICAgICQoIiNvdmVybGF5LWJvdHRvbSIpLmNzcygidG9wIixlYXN5UmVhZGluZ1NjcmVlblJ1bGVyQ3VycmVudENsaWVudFkgKzIwKTsNCn0NCg0KZnVuY3Rpb24gaGlkZUVhc3lSZWFkaW5nU2NyZWVuUnVsZXIoKXsNCiAgICAkKCIjb3ZlcmxheS10b3AiKS5yZW1vdmUoKTsNCiAgICAkKCIjb3ZlcmxheS1ib3R0b20iKS5yZW1vdmUoKTsNCn0NCmxldCBlYXN5UmVhZGluZ1NjcmVlblJ1bGVyRG9jdW1lbnRSZWFkeSA9ICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHsNCiAgICAkKGRvY3VtZW50KS5tb3VzZW1vdmUobGlzdGVuZXIpOw0KfSk7"
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "screen-ruler/1.0/css/screen-ruler.css",
                                    "css": "I292ZXJsYXktdG9wLCNvdmVybGF5LWJvdHRvbSB7DQogICAgcG9zaXRpb246IGZpeGVkICFpbXBvcnRhbnQ7DQogICAgdG9wOiAwOw0KICAgIGxlZnQ6IDAgIWltcG9ydGFudDsNCiAgICByaWdodDogMCAhaW1wb3J0YW50Ow0KICAgIGJvdHRvbTogMDsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsMCwwLDAuNSkgIWltcG9ydGFudDsNCiAgICB6LWluZGV4OiA5OTk5Ow0KICAgIGRpc3BsYXk6IGJsb2NrOw0KfQ=="
                                }
                            ]
                        }
                    },
                    "widget": {
                        "source": {
                            "id": "two-state-button",
                            "name": "Two state button",
                            "description": "A simple two state button.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "",
                            "remoteBaseDirectory": "components/widget/two-state-button/1.0/",
                            "implementationClass": "TwoStateButton",
                            "contentScripts": [
                                {
                                    "id": "widget/two-state-button.js",
                                    "source": "Y2xhc3MgVHdvU3RhdGVCdXR0b24gZXh0ZW5kcyBXaWRnZXRCYXNlew0KDQogICAgY29uc3RydWN0b3IoZnVuY3Rpb25JbmZvLCB1c2VySW50ZXJmYWNlLHRhcmdldElELCBjb25maWd1cmF0aW9uKXsNCiAgICAgICAgc3VwZXIoZnVuY3Rpb25JbmZvLHVzZXJJbnRlcmZhY2UsdGFyZ2V0SUQsY29uZmlndXJhdGlvbik7DQoNCiAgICAgICAgY29uc29sZS5sb2codGhpcy53aWRnZXRJRCApOw0KICAgICAgICB0aGlzLndpZGdldElEID0gJ2VyX2J1dHRvbl8nK3RoaXMud2lkZ2V0SUQ7DQogICAgICAgICQoIiMiK3RhcmdldElEKS5hcHBlbmQoIjxidXR0b24gaWQ9JyIrdGhpcy53aWRnZXRJRCsiJyBjbGFzcz0nZWFzeS1yZWFkaW5nLXR3by1zdGF0ZS1idXR0b24nPjxpbWcgc3JjPSciK2Z1bmN0aW9uSW5mby5zb3VyY2UuZGVmYXVsdEljb25VUkwrIicgdGl0bGU9JyIrZnVuY3Rpb25JbmZvLnNvdXJjZS5uYW1lKyI6ICIrZnVuY3Rpb25JbmZvLnNvdXJjZS5kZXNjcmlwdGlvbisiJz4gPC9idXR0b24+Iik7DQogICAgICAgIHRoaXMuZW5hYmxlKCk7DQogICAgICAgIHRoaXMucHJlc3NlZCA9IGZhbHNlOw0KICAgIH0NCg0KICAgIGVuYWJsZSgpew0KICAgICAgICAkKCIjIit0aGlzLndpZGdldElEKS5vbiggImNsaWNrIix0aGlzLCB0aGlzLmJ1dHRvbkNsaWNrZWQpOw0KDQogICAgfQ0KDQogICAgZGlzYWJsZSgpew0KICAgICAgICAkKCIjIit0aGlzLndpZGdldElEKS5vZmYoICJjbGljayIsdGhpcywgdGhpcy5idXR0b25DbGlja2VkKTsNCg0KDQogICAgfQ0KDQogICAgYnV0dG9uQ2xpY2tlZChlKXsNCiAgICAgICAgZS5kYXRhLnByZXNzZWQgPSAhZS5kYXRhLnByZXNzZWQ7DQogICAgICAgICQoIiMiK2UuZGF0YS53aWRnZXRJRCkudG9nZ2xlQ2xhc3MoICJlci1idXR0b24tYWN0aXZlIiApOw0KICAgICAgICBsZXQgdm9pZElucHV0ID0gew0KICAgICAgICAgICAgdHlwZTogIlZvaWQiLA0KICAgICAgICB9Ow0KICAgICAgICByZXF1ZXN0TWFuYWdlci5jcmVhdGVSZXF1ZXN0KGUuZGF0YSwgdm9pZElucHV0LCBlKTsNCiAgICB9DQoNCiAgICByZW1vdmUoKXsNCiAgICAgICAgJCgiIyIrdGhpcy53aWRnZXRJRCkucmVtb3ZlKCk7DQoNCg0KICAgIH0NCg0KICAgIHJlcXVlc3RGYWlsZWQocmVxLGNvbmZpZyl7DQogICAgICAgICQoIiMiK3RoaXMud2lkZ2V0SUQpLnJlbW92ZUNsYXNzKCAiZXItYnV0dG9uLWFjdGl2ZSIgKTsNCiAgICAgICAgdGhpcy5wcmVzc2VkID0gZmFsc2U7DQogICAgfQ0KfQ0K"
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "widget/two-state-button.css",
                                    "css": "LmVhc3ktcmVhZGluZy10d28tc3RhdGUtYnV0dG9uPmltZ3sNCiAgICBtYXgtd2lkdGg6IDEwMCU7DQp9DQoNCi5lYXN5LXJlYWRpbmctdHdvLXN0YXRlLWJ1dHRvbnsNCiAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmUgIWltcG9ydGFudDsNCiAgICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDAgIWltcG9ydGFudDsNCiAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7DQp9DQo="
                                }
                            ]
                        }
                    }
                },
                {
                    "function": {
                        "source": {
                            "id": "wiktionary_dict",
                            "engine": {
                                "id": "word-definition",
                                "version": "1.0",
                                "debugMode": false
                            },
                            "debugMode": false,
                            "name": "Wiktionary: Word Definition",
                            "description": "Definition of a word",
                            "inputTypes": [
                                {
                                    "inputType": "Word",
                                    "name": "Input word",
                                    "description": "Word to find a definition"
                                }
                            ],
                            "outputTypes": [
                                {
                                    "outputType": "Word",
                                    "name": "Definition",
                                    "description": "Definition of the word"
                                }
                            ],
                            "defaultIcon": "assets/word-definition.png",
                            "defaultIconURL": "https://localhost:8080/components/engines/word-definition/1.0/assets/word-definition.png",
                            "remoteBaseDirectory": "components/engines/word-definition/1.0/",
                            "type": "RemoteFunction",
                            "entryPoint": "findDefinitionForWord"
                        }
                    },
                    "widget": {
                        "source": {
                            "id": "single-choice-button",
                            "name": "Single Choice Button",
                            "description": "A simple button.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "",
                            "remoteBaseDirectory": "components/widget/single-choice-button/1.0/",
                            "implementationClass": "SingleChoiceButton",
                            "contentScripts": [
                                {
                                    "id": "widget/single-choice-button.js",
                                    "source": "Y2xhc3MgU2luZ2xlQ2hvaWNlQnV0dG9uIGV4dGVuZHMgV2lkZ2V0QmFzZSB7DQoNCiAgICBjb25zdHJ1Y3RvcihmdW5jdGlvbkluZm8sIHVzZXJJbnRlcmZhY2UsIHRhcmdldElELCBjb25maWd1cmF0aW9uKSB7DQogICAgICAgIHN1cGVyKGZ1bmN0aW9uSW5mbywgdXNlckludGVyZmFjZSwgdGFyZ2V0SUQsIGNvbmZpZ3VyYXRpb24pOw0KDQogICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7DQogICAgICAgIHRoaXMub3V0cHV0VHlwZUNsYXNzID0gbnVsbDsNCiAgICAgICAgdGhpcy5yZXF1ZXN0SW5Qcm9ncmVzcyA9IGZhbHNlOw0KICAgICAgICB0aGlzLndpZGdldElEID0gJ2VyX3NpbmdsZV9jaG9pY2VfYnV0dG9uXycgKyB0aGlzLndpZGdldElEOw0KICAgICAgICAkKCIjIiArIHRhcmdldElEKS5hcHBlbmQoIjxidXR0b24gaWQ9JyIgKyB0aGlzLndpZGdldElEICsgIicgY2xhc3M9J2Vhc3ktcmVhZGluZy1zaW5nbGUtY2hvaWNlIGVhc3ktcmVhZGluZy1idXR0b24nPjxpbWcgc3JjPSciICsgZnVuY3Rpb25JbmZvLnNvdXJjZS5kZWZhdWx0SWNvblVSTCArICInIHRpdGxlPSciICsgZnVuY3Rpb25JbmZvLnNvdXJjZS5uYW1lICsgIjogIiArIGZ1bmN0aW9uSW5mby5zb3VyY2UuZGVzY3JpcHRpb24gKyAiJz4gPC9idXR0b24+Iik7DQoNCiAgICAgLy8gICAkKCIjIiArIHRoaXMud2lkZ2V0SUQpLmNzcygnY3NzVGV4dCcsICdiYWNrZ3JvdW5kLWNvbG9yOiAnK2NvbmZpZ3VyYXRpb24uYmFja2dyb3VuZENvbG9yQnV0dG9uQWN0aXZlKycgIWltcG9ydGFudCcpOw0KICAgICAgICB0aGlzLmVuYWJsZSgpOw0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFkZFdpZGdldEFjdGl2YXRlZExpc3RlbmVycyh0aGlzKTsNCiAgICB9DQoNCg0KICAgIGVuYWJsZSgpIHsNCiAgICAgICAgJCgiIyIgKyB0aGlzLndpZGdldElEKS5vbigiY2xpY2siLCB0aGlzLCB0aGlzLnNpbmdsZUNob2ljZUJ1dHRvbkNsaWNrZWQpOw0KDQogICAgfQ0KDQogICAgZGlzYWJsZSgpIHsNCiAgICAgICAgJCgiIyIgKyB0aGlzLndpZGdldElEKS5vZmYoImNsaWNrIiwgdGhpcywgdGhpcy5zaW5nbGVDaG9pY2VCdXR0b25DbGlja2VkKTsNCiAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5yZW1vdmVXaWRnZXRBY3RpdmF0ZWRMaXN0ZW5lcnModGhpcyk7DQoNCiAgICB9DQoNCiAgICBhY3RpdmF0ZVdpZGdldCgpew0KICAgICAgICBjb25zb2xlLmxvZygiU2luZ2xlIENob2ljZSBCdXR0b24gQWN0aXZlIik7DQogICAgICAgICQoIiMiICsgdGhpcy53aWRnZXRJRCkuYWRkQ2xhc3MoImVhc3ktcmVhZGluZy1zaW5nbGUtY2hvaWNlLWFjdGl2ZSIpOw0KICAgICAgICBpZih0aGlzLmZ1bmN0aW9uSW5mby5zb3VyY2UuaW5wdXRUeXBlcy5sZW5ndGggPiAwKXsNCiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5mdW5jdGlvbkluZm8uc291cmNlLmlucHV0VHlwZXNbMF0uaW5wdXRUeXBlKSB7DQoNCiAgICAgICAgICAgICAgICBjYXNlIFBhcmFncmFwaC5jbGFzc05hbWU6DQogICAgICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWRkUGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcih0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoNCiAgICAgICAgICAgICAgICBjYXNlIFdvcmQuY2xhc3NOYW1lOg0KICAgICAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFkZFdvcmRDbGlja0xpc3RlbmVyKHRoaXMpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCg0KICAgICAgICAgICAgICAgIGNhc2UgQW5ub3RhdGVkUGFyYWdyYXBoLmNsYXNzTmFtZToNCiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hZGRQYXJhZ3JhcGhDbGlja0xpc3RlbmVyKHRoaXMpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMub3V0cHV0VHlwZUNsYXNzID0gdGhpcy5mdW5jdGlvbkluZm8uc291cmNlLmlucHV0VHlwZXNbMF0uaW5wdXRUeXBlOw0KICAgICAgICB9DQoNCiAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci53aWRnZXRBY3RpdmF0ZWQodGhpcyk7DQoNCiAgICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlOw0KDQogICAgfQ0KDQogICAgZGVhY3RpdmF0ZVdpZGdldChtYW51YWw9dHJ1ZSl7DQogICAgICAgIHN1cGVyLmRlYWN0aXZhdGVXaWRnZXQobWFudWFsKTsNCiAgICAgICAgY29uc29sZS5sb2coIlNpbmdsZSBDaG9pY2UgQnV0dG9uIE5vdCBBY3RpdmUiKTsNCiAgICAgICAgJCgiIyIgKyB0aGlzLndpZGdldElEKS5yZW1vdmVDbGFzcygiZWFzeS1yZWFkaW5nLXNpbmdsZS1jaG9pY2UtYWN0aXZlIik7DQoNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZ1bmN0aW9uSW5mby5zb3VyY2UuaW5wdXRUeXBlcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgc3dpdGNoICh0aGlzLmZ1bmN0aW9uSW5mby5zb3VyY2UuaW5wdXRUeXBlc1tpXS5pbnB1dFR5cGUpIHsNCiAgICAgICAgICAgICAgICBjYXNlIFdvcmQuY2xhc3NOYW1lOg0KICAgICAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLnJlbW92ZVdvcmRDbGlja0xpc3RlbmVyKHRoaXMpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIFBhcmFncmFwaC5jbGFzc05hbWU6DQogICAgICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIucmVtb3ZlUGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcih0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSBBbm5vdGF0ZWRQYXJhZ3JhcGguY2xhc3NOYW1lOg0KICAgICAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLnJlbW92ZVBhcmFncmFwaENsaWNrTGlzdGVuZXIodGhpcyk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KDQoNCg0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlOw0KICAgIH0NCg0KICAgIHNpbmdsZUNob2ljZUJ1dHRvbkNsaWNrZWQoZSkgew0KICAgICAgICBpZihlLmRhdGEuYWN0aXZlKXsNCiAgICAgICAgICAgIGUuZGF0YS5kZWFjdGl2YXRlV2lkZ2V0KHRydWUpOw0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIGUuZGF0YS5hY3RpdmF0ZVdpZGdldCgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgb25Xb3JkQ2xpY2sod29yZCwgZSkgew0KICAgICAgICBpZih0aGlzLnJlcXVlc3RJblByb2dyZXNzKXsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLnJlcXVlc3RJblByb2dyZXNzID0gdHJ1ZTsNCiAgICAgICAgZWFzeVJlYWRpbmcuYnVzeUFuaW1hdGlvbi5zdGFydEFuaW1hdGlvbigpOw0KICAgICAgICBpZighdGhpcy5maWx0ZXJVc2VySW50ZXJmYWNlRWxlbWVudHMod29yZCkpew0KICAgICAgICAgICAgcmVxdWVzdE1hbmFnZXIuY3JlYXRlUmVxdWVzdCh0aGlzLCB3b3JkLCBlKTsNCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgb25QYXJhZ3JhcGhDTGljayhwYXJhZ3JhcGgsIGUpIHsNCiAgICAgICAgaWYodGhpcy5yZXF1ZXN0SW5Qcm9ncmVzcyl7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5yZXF1ZXN0SW5Qcm9ncmVzcyA9IHRydWU7DQogICAgICAgIGVhc3lSZWFkaW5nLmJ1c3lBbmltYXRpb24uc3RhcnRBbmltYXRpb24oKTsNCiAgICAgICAgaWYoIXRoaXMuZmlsdGVyVXNlckludGVyZmFjZUVsZW1lbnRzKHBhcmFncmFwaCkpew0KICAgICAgICAgICAgaWYodGhpcy5vdXRwdXRUeXBlQ2xhc3MgPT09IFBhcmFncmFwaC5jbGFzc05hbWUpew0KICAgICAgICAgICAgICAgIHJlcXVlc3RNYW5hZ2VyLmNyZWF0ZVJlcXVlc3QodGhpcywgcGFyYWdyYXBoLCBlKTsNCiAgICAgICAgICAgIH1lbHNlIGlmKHRoaXMub3V0cHV0VHlwZUNsYXNzID09PSBBbm5vdGF0ZWRQYXJhZ3JhcGguY2xhc3NOYW1lKXsNCiAgICAgICAgICAgICAgICBwYXJhZ3JhcGgudHlwZSA9IEFubm90YXRlZFBhcmFncmFwaC5jbGFzc05hbWU7DQogICAgICAgICAgICAgICAgcmVxdWVzdE1hbmFnZXIuY3JlYXRlUmVxdWVzdCh0aGlzLCBwYXJhZ3JhcGgsIGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZmlsdGVyVXNlckludGVyZmFjZUVsZW1lbnRzKGVsZW1lbnQpew0KICAgICAgICByZXR1cm4gJChlbGVtZW50KS5wYXJlbnRzKCcuZWFzeS1yZWFkaW5nLWludGVyZmFjZScpLmxlbmd0aDsNCiAgICB9DQoNCg0KICAgIHJlcXVlc3RGaW5pc2hlZCgpew0KICAgICAgICBzdXBlci5yZXF1ZXN0RmluaXNoZWQoKTsNCiAgICAgICAgZWFzeVJlYWRpbmcuYnVzeUFuaW1hdGlvbi5zdG9wQW5pbWF0aW9uKCk7DQogICAgICAgIHRoaXMucmVxdWVzdEluUHJvZ3Jlc3MgPSBmYWxzZTsNCiAgICB9DQoNCiAgICByZW1vdmUoKXsNCiAgICAgICAgaWYodGhpcy5hY3RpdmUpew0KICAgICAgICAgICAgdGhpcy5kZWFjdGl2YXRlV2lkZ2V0KGZhbHNlKTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLmRpc2FibGUoKTsNCiAgICAgICAgJCgiIyIgKyB0aGlzLndpZGdldElEKS5yZW1vdmUoKTsNCg0KICAgIH0NCn0="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "widget/single-choice-button.css",
                                    "css": "LmVhc3ktcmVhZGluZy1zaW5nbGUtY2hvaWNlPmltZ3sNCiAgICBtYXgtd2lkdGg6IDEwMCUgIWltcG9ydGFudDsNCn0NCg0KLmVhc3ktcmVhZGluZy1zaW5nbGUtY2hvaWNlLWFjdGl2ZXsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZjNjc5ICFpbXBvcnRhbnQ7DQp9DQoNCi5lYXN5LXJlYWRpbmctc2luZ2xlLWNob2ljZXsNCiAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmUgIWltcG9ydGFudDsNCiAgICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDAgIWltcG9ydGFudDsNCiAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7DQp9"
                                }
                            ]
                        }
                    },
                    "presentation": {
                        "source": {
                            "id": "tippy-tooltip",
                            "name": "TippyTooltip",
                            "description": "Renders the result within a tooltip based on tippy.",
                            "version": "1.0",
                            "versionDescription": "Initial Version",
                            "debugMode": false,
                            "remoteAssetDirectory": "/components/presentation/tippy-tooltip/1.0/presentation/images",
                            "remoteBaseDirectory": "components/presentation/tippy-tooltip/1.0/",
                            "implementationClass": "TippyTooltip",
                            "contentScripts": [
                                {
                                    "id": "presentation/popper.min.js",
                                    "source": "LyoKIENvcHlyaWdodCAoQykgRmVkZXJpY28gWml2b2xvIDIwMTkKIERpc3RyaWJ1dGVkIHVuZGVyIHRoZSBNSVQgTGljZW5zZSAobGljZW5zZSB0ZXJtcyBhcmUgYXQgaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVCkuCiAqLyhmdW5jdGlvbihlLHQpeydvYmplY3QnPT10eXBlb2YgZXhwb3J0cyYmJ3VuZGVmaW5lZCchPXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9dCgpOidmdW5jdGlvbic9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKHQpOmUuUG9wcGVyPXQoKX0pKHRoaXMsZnVuY3Rpb24oKXsndXNlIHN0cmljdCc7ZnVuY3Rpb24gZShlKXtyZXR1cm4gZSYmJ1tvYmplY3QgRnVuY3Rpb25dJz09PXt9LnRvU3RyaW5nLmNhbGwoZSl9ZnVuY3Rpb24gdChlLHQpe2lmKDEhPT1lLm5vZGVUeXBlKXJldHVybltdO3ZhciBvPWUub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldyxuPW8uZ2V0Q29tcHV0ZWRTdHlsZShlLG51bGwpO3JldHVybiB0P25bdF06bn1mdW5jdGlvbiBvKGUpe3JldHVybidIVE1MJz09PWUubm9kZU5hbWU/ZTplLnBhcmVudE5vZGV8fGUuaG9zdH1mdW5jdGlvbiBuKGUpe2lmKCFlKXJldHVybiBkb2N1bWVudC5ib2R5O3N3aXRjaChlLm5vZGVOYW1lKXtjYXNlJ0hUTUwnOmNhc2UnQk9EWSc6cmV0dXJuIGUub3duZXJEb2N1bWVudC5ib2R5O2Nhc2UnI2RvY3VtZW50JzpyZXR1cm4gZS5ib2R5O312YXIgaT10KGUpLHI9aS5vdmVyZmxvdyxwPWkub3ZlcmZsb3dYLHM9aS5vdmVyZmxvd1k7cmV0dXJuIC8oYXV0b3xzY3JvbGx8b3ZlcmxheSkvLnRlc3QocitzK3ApP2U6bihvKGUpKX1mdW5jdGlvbiByKGUpe3JldHVybiAxMT09PWU/cGU6MTA9PT1lP3NlOnBlfHxzZX1mdW5jdGlvbiBwKGUpe2lmKCFlKXJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7Zm9yKHZhciBvPXIoMTApP2RvY3VtZW50LmJvZHk6bnVsbCxuPWUub2Zmc2V0UGFyZW50fHxudWxsO249PT1vJiZlLm5leHRFbGVtZW50U2libGluZzspbj0oZT1lLm5leHRFbGVtZW50U2libGluZykub2Zmc2V0UGFyZW50O3ZhciBpPW4mJm4ubm9kZU5hbWU7cmV0dXJuIGkmJidCT0RZJyE9PWkmJidIVE1MJyE9PWk/LTEhPT1bJ1RIJywnVEQnLCdUQUJMRSddLmluZGV4T2Yobi5ub2RlTmFtZSkmJidzdGF0aWMnPT09dChuLCdwb3NpdGlvbicpP3Aobik6bjplP2Uub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ6ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50fWZ1bmN0aW9uIHMoZSl7dmFyIHQ9ZS5ub2RlTmFtZTtyZXR1cm4nQk9EWSchPT10JiYoJ0hUTUwnPT09dHx8cChlLmZpcnN0RWxlbWVudENoaWxkKT09PWUpfWZ1bmN0aW9uIGQoZSl7cmV0dXJuIG51bGw9PT1lLnBhcmVudE5vZGU/ZTpkKGUucGFyZW50Tm9kZSl9ZnVuY3Rpb24gYShlLHQpe2lmKCFlfHwhZS5ub2RlVHlwZXx8IXR8fCF0Lm5vZGVUeXBlKXJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7dmFyIG89ZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbih0KSZOb2RlLkRPQ1VNRU5UX1BPU0lUSU9OX0ZPTExPV0lORyxuPW8/ZTp0LGk9bz90OmUscj1kb2N1bWVudC5jcmVhdGVSYW5nZSgpO3Iuc2V0U3RhcnQobiwwKSxyLnNldEVuZChpLDApO3ZhciBsPXIuY29tbW9uQW5jZXN0b3JDb250YWluZXI7aWYoZSE9PWwmJnQhPT1sfHxuLmNvbnRhaW5zKGkpKXJldHVybiBzKGwpP2w6cChsKTt2YXIgZj1kKGUpO3JldHVybiBmLmhvc3Q/YShmLmhvc3QsdCk6YShlLGQodCkuaG9zdCl9ZnVuY3Rpb24gbChlKXt2YXIgdD0xPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06J3RvcCcsbz0ndG9wJz09PXQ/J3Njcm9sbFRvcCc6J3Njcm9sbExlZnQnLG49ZS5ub2RlTmFtZTtpZignQk9EWSc9PT1ufHwnSFRNTCc9PT1uKXt2YXIgaT1lLm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LHI9ZS5vd25lckRvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnR8fGk7cmV0dXJuIHJbb119cmV0dXJuIGVbb119ZnVuY3Rpb24gZihlLHQpe3ZhciBvPTI8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzJdJiZhcmd1bWVudHNbMl0sbj1sKHQsJ3RvcCcpLGk9bCh0LCdsZWZ0Jykscj1vPy0xOjE7cmV0dXJuIGUudG9wKz1uKnIsZS5ib3R0b20rPW4qcixlLmxlZnQrPWkqcixlLnJpZ2h0Kz1pKnIsZX1mdW5jdGlvbiBtKGUsdCl7dmFyIG89J3gnPT09dD8nTGVmdCc6J1RvcCcsbj0nTGVmdCc9PW8/J1JpZ2h0JzonQm90dG9tJztyZXR1cm4gcGFyc2VGbG9hdChlWydib3JkZXInK28rJ1dpZHRoJ10sMTApK3BhcnNlRmxvYXQoZVsnYm9yZGVyJytuKydXaWR0aCddLDEwKX1mdW5jdGlvbiBoKGUsdCxvLG4pe3JldHVybiBlZSh0WydvZmZzZXQnK2VdLHRbJ3Njcm9sbCcrZV0sb1snY2xpZW50JytlXSxvWydvZmZzZXQnK2VdLG9bJ3Njcm9sbCcrZV0scigxMCk/cGFyc2VJbnQob1snb2Zmc2V0JytlXSkrcGFyc2VJbnQoblsnbWFyZ2luJysoJ0hlaWdodCc9PT1lPydUb3AnOidMZWZ0JyldKStwYXJzZUludChuWydtYXJnaW4nKygnSGVpZ2h0Jz09PWU/J0JvdHRvbSc6J1JpZ2h0JyldKTowKX1mdW5jdGlvbiBjKGUpe3ZhciB0PWUuYm9keSxvPWUuZG9jdW1lbnRFbGVtZW50LG49cigxMCkmJmdldENvbXB1dGVkU3R5bGUobyk7cmV0dXJue2hlaWdodDpoKCdIZWlnaHQnLHQsbyxuKSx3aWR0aDpoKCdXaWR0aCcsdCxvLG4pfX1mdW5jdGlvbiBnKGUpe3JldHVybiBmZSh7fSxlLHtyaWdodDplLmxlZnQrZS53aWR0aCxib3R0b206ZS50b3ArZS5oZWlnaHR9KX1mdW5jdGlvbiB1KGUpe3ZhciBvPXt9O3RyeXtpZihyKDEwKSl7bz1lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3ZhciBuPWwoZSwndG9wJyksaT1sKGUsJ2xlZnQnKTtvLnRvcCs9bixvLmxlZnQrPWksby5ib3R0b20rPW4sby5yaWdodCs9aX1lbHNlIG89ZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKX1jYXRjaCh0KXt9dmFyIHA9e2xlZnQ6by5sZWZ0LHRvcDpvLnRvcCx3aWR0aDpvLnJpZ2h0LW8ubGVmdCxoZWlnaHQ6by5ib3R0b20tby50b3B9LHM9J0hUTUwnPT09ZS5ub2RlTmFtZT9jKGUub3duZXJEb2N1bWVudCk6e30sZD1zLndpZHRofHxlLmNsaWVudFdpZHRofHxwLnJpZ2h0LXAubGVmdCxhPXMuaGVpZ2h0fHxlLmNsaWVudEhlaWdodHx8cC5ib3R0b20tcC50b3AsZj1lLm9mZnNldFdpZHRoLWQsaD1lLm9mZnNldEhlaWdodC1hO2lmKGZ8fGgpe3ZhciB1PXQoZSk7Zi09bSh1LCd4JyksaC09bSh1LCd5JykscC53aWR0aC09ZixwLmhlaWdodC09aH1yZXR1cm4gZyhwKX1mdW5jdGlvbiBiKGUsbyl7dmFyIGk9Mjxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0mJmFyZ3VtZW50c1syXSxwPXIoMTApLHM9J0hUTUwnPT09by5ub2RlTmFtZSxkPXUoZSksYT11KG8pLGw9bihlKSxtPXQobyksaD1wYXJzZUZsb2F0KG0uYm9yZGVyVG9wV2lkdGgsMTApLGM9cGFyc2VGbG9hdChtLmJvcmRlckxlZnRXaWR0aCwxMCk7aSYmcyYmKGEudG9wPWVlKGEudG9wLDApLGEubGVmdD1lZShhLmxlZnQsMCkpO3ZhciBiPWcoe3RvcDpkLnRvcC1hLnRvcC1oLGxlZnQ6ZC5sZWZ0LWEubGVmdC1jLHdpZHRoOmQud2lkdGgsaGVpZ2h0OmQuaGVpZ2h0fSk7aWYoYi5tYXJnaW5Ub3A9MCxiLm1hcmdpbkxlZnQ9MCwhcCYmcyl7dmFyIHc9cGFyc2VGbG9hdChtLm1hcmdpblRvcCwxMCkseT1wYXJzZUZsb2F0KG0ubWFyZ2luTGVmdCwxMCk7Yi50b3AtPWgtdyxiLmJvdHRvbS09aC13LGIubGVmdC09Yy15LGIucmlnaHQtPWMteSxiLm1hcmdpblRvcD13LGIubWFyZ2luTGVmdD15fXJldHVybihwJiYhaT9vLmNvbnRhaW5zKGwpOm89PT1sJiYnQk9EWSchPT1sLm5vZGVOYW1lKSYmKGI9ZihiLG8pKSxifWZ1bmN0aW9uIHcoZSl7dmFyIHQ9MTxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0mJmFyZ3VtZW50c1sxXSxvPWUub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsbj1iKGUsbyksaT1lZShvLmNsaWVudFdpZHRoLHdpbmRvdy5pbm5lcldpZHRofHwwKSxyPWVlKG8uY2xpZW50SGVpZ2h0LHdpbmRvdy5pbm5lckhlaWdodHx8MCkscD10PzA6bChvKSxzPXQ/MDpsKG8sJ2xlZnQnKSxkPXt0b3A6cC1uLnRvcCtuLm1hcmdpblRvcCxsZWZ0OnMtbi5sZWZ0K24ubWFyZ2luTGVmdCx3aWR0aDppLGhlaWdodDpyfTtyZXR1cm4gZyhkKX1mdW5jdGlvbiB5KGUpe3ZhciBuPWUubm9kZU5hbWU7aWYoJ0JPRFknPT09bnx8J0hUTUwnPT09bilyZXR1cm4hMTtpZignZml4ZWQnPT09dChlLCdwb3NpdGlvbicpKXJldHVybiEwO3ZhciBpPW8oZSk7cmV0dXJuISFpJiZ5KGkpfWZ1bmN0aW9uIEUoZSl7aWYoIWV8fCFlLnBhcmVudEVsZW1lbnR8fHIoKSlyZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O2Zvcih2YXIgbz1lLnBhcmVudEVsZW1lbnQ7byYmJ25vbmUnPT09dChvLCd0cmFuc2Zvcm0nKTspbz1vLnBhcmVudEVsZW1lbnQ7cmV0dXJuIG98fGRvY3VtZW50LmRvY3VtZW50RWxlbWVudH1mdW5jdGlvbiB2KGUsdCxpLHIpe3ZhciBwPTQ8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzRdJiZhcmd1bWVudHNbNF0scz17dG9wOjAsbGVmdDowfSxkPXA/RShlKTphKGUsdCk7aWYoJ3ZpZXdwb3J0Jz09PXIpcz13KGQscCk7ZWxzZXt2YXIgbDsnc2Nyb2xsUGFyZW50Jz09PXI/KGw9bihvKHQpKSwnQk9EWSc9PT1sLm5vZGVOYW1lJiYobD1lLm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSk6J3dpbmRvdyc9PT1yP2w9ZS5vd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudDpsPXI7dmFyIGY9YihsLGQscCk7aWYoJ0hUTUwnPT09bC5ub2RlTmFtZSYmIXkoZCkpe3ZhciBtPWMoZS5vd25lckRvY3VtZW50KSxoPW0uaGVpZ2h0LGc9bS53aWR0aDtzLnRvcCs9Zi50b3AtZi5tYXJnaW5Ub3Ascy5ib3R0b209aCtmLnRvcCxzLmxlZnQrPWYubGVmdC1mLm1hcmdpbkxlZnQscy5yaWdodD1nK2YubGVmdH1lbHNlIHM9Zn1pPWl8fDA7dmFyIHU9J251bWJlcic9PXR5cGVvZiBpO3JldHVybiBzLmxlZnQrPXU/aTppLmxlZnR8fDAscy50b3ArPXU/aTppLnRvcHx8MCxzLnJpZ2h0LT11P2k6aS5yaWdodHx8MCxzLmJvdHRvbS09dT9pOmkuYm90dG9tfHwwLHN9ZnVuY3Rpb24geChlKXt2YXIgdD1lLndpZHRoLG89ZS5oZWlnaHQ7cmV0dXJuIHQqb31mdW5jdGlvbiBPKGUsdCxvLG4saSl7dmFyIHI9NTxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbNV0/YXJndW1lbnRzWzVdOjA7aWYoLTE9PT1lLmluZGV4T2YoJ2F1dG8nKSlyZXR1cm4gZTt2YXIgcD12KG8sbixyLGkpLHM9e3RvcDp7d2lkdGg6cC53aWR0aCxoZWlnaHQ6dC50b3AtcC50b3B9LHJpZ2h0Ont3aWR0aDpwLnJpZ2h0LXQucmlnaHQsaGVpZ2h0OnAuaGVpZ2h0fSxib3R0b206e3dpZHRoOnAud2lkdGgsaGVpZ2h0OnAuYm90dG9tLXQuYm90dG9tfSxsZWZ0Ont3aWR0aDp0LmxlZnQtcC5sZWZ0LGhlaWdodDpwLmhlaWdodH19LGQ9T2JqZWN0LmtleXMocykubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBmZSh7a2V5OmV9LHNbZV0se2FyZWE6eChzW2VdKX0pfSkuc29ydChmdW5jdGlvbihlLHQpe3JldHVybiB0LmFyZWEtZS5hcmVhfSksYT1kLmZpbHRlcihmdW5jdGlvbihlKXt2YXIgdD1lLndpZHRoLG49ZS5oZWlnaHQ7cmV0dXJuIHQ+PW8uY2xpZW50V2lkdGgmJm4+PW8uY2xpZW50SGVpZ2h0fSksbD0wPGEubGVuZ3RoP2FbMF0ua2V5OmRbMF0ua2V5LGY9ZS5zcGxpdCgnLScpWzFdO3JldHVybiBsKyhmPyctJytmOicnKX1mdW5jdGlvbiBMKGUsdCxvKXt2YXIgbj0zPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1szXT9hcmd1bWVudHNbM106bnVsbCxpPW4/RSh0KTphKHQsbyk7cmV0dXJuIGIobyxpLG4pfWZ1bmN0aW9uIFMoZSl7dmFyIHQ9ZS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LG89dC5nZXRDb21wdXRlZFN0eWxlKGUpLG49cGFyc2VGbG9hdChvLm1hcmdpblRvcHx8MCkrcGFyc2VGbG9hdChvLm1hcmdpbkJvdHRvbXx8MCksaT1wYXJzZUZsb2F0KG8ubWFyZ2luTGVmdHx8MCkrcGFyc2VGbG9hdChvLm1hcmdpblJpZ2h0fHwwKSxyPXt3aWR0aDplLm9mZnNldFdpZHRoK2ksaGVpZ2h0OmUub2Zmc2V0SGVpZ2h0K259O3JldHVybiByfWZ1bmN0aW9uIFQoZSl7dmFyIHQ9e2xlZnQ6J3JpZ2h0JyxyaWdodDonbGVmdCcsYm90dG9tOid0b3AnLHRvcDonYm90dG9tJ307cmV0dXJuIGUucmVwbGFjZSgvbGVmdHxyaWdodHxib3R0b218dG9wL2csZnVuY3Rpb24oZSl7cmV0dXJuIHRbZV19KX1mdW5jdGlvbiBDKGUsdCxvKXtvPW8uc3BsaXQoJy0nKVswXTt2YXIgbj1TKGUpLGk9e3dpZHRoOm4ud2lkdGgsaGVpZ2h0Om4uaGVpZ2h0fSxyPS0xIT09WydyaWdodCcsJ2xlZnQnXS5pbmRleE9mKG8pLHA9cj8ndG9wJzonbGVmdCcscz1yPydsZWZ0JzondG9wJyxkPXI/J2hlaWdodCc6J3dpZHRoJyxhPXI/J3dpZHRoJzonaGVpZ2h0JztyZXR1cm4gaVtwXT10W3BdK3RbZF0vMi1uW2RdLzIsaVtzXT1vPT09cz90W3NdLW5bYV06dFtUKHMpXSxpfWZ1bmN0aW9uIEQoZSx0KXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLmZpbmQ/ZS5maW5kKHQpOmUuZmlsdGVyKHQpWzBdfWZ1bmN0aW9uIE4oZSx0LG8pe2lmKEFycmF5LnByb3RvdHlwZS5maW5kSW5kZXgpcmV0dXJuIGUuZmluZEluZGV4KGZ1bmN0aW9uKGUpe3JldHVybiBlW3RdPT09b30pO3ZhciBuPUQoZSxmdW5jdGlvbihlKXtyZXR1cm4gZVt0XT09PW99KTtyZXR1cm4gZS5pbmRleE9mKG4pfWZ1bmN0aW9uIFAodCxvLG4pe3ZhciBpPXZvaWQgMD09PW4/dDp0LnNsaWNlKDAsTih0LCduYW1lJyxuKSk7cmV0dXJuIGkuZm9yRWFjaChmdW5jdGlvbih0KXt0WydmdW5jdGlvbiddJiZjb25zb2xlLndhcm4oJ2Btb2RpZmllci5mdW5jdGlvbmAgaXMgZGVwcmVjYXRlZCwgdXNlIGBtb2RpZmllci5mbmAhJyk7dmFyIG49dFsnZnVuY3Rpb24nXXx8dC5mbjt0LmVuYWJsZWQmJmUobikmJihvLm9mZnNldHMucG9wcGVyPWcoby5vZmZzZXRzLnBvcHBlciksby5vZmZzZXRzLnJlZmVyZW5jZT1nKG8ub2Zmc2V0cy5yZWZlcmVuY2UpLG89bihvLHQpKX0pLG99ZnVuY3Rpb24gaygpe2lmKCF0aGlzLnN0YXRlLmlzRGVzdHJveWVkKXt2YXIgZT17aW5zdGFuY2U6dGhpcyxzdHlsZXM6e30sYXJyb3dTdHlsZXM6e30sYXR0cmlidXRlczp7fSxmbGlwcGVkOiExLG9mZnNldHM6e319O2Uub2Zmc2V0cy5yZWZlcmVuY2U9TCh0aGlzLnN0YXRlLHRoaXMucG9wcGVyLHRoaXMucmVmZXJlbmNlLHRoaXMub3B0aW9ucy5wb3NpdGlvbkZpeGVkKSxlLnBsYWNlbWVudD1PKHRoaXMub3B0aW9ucy5wbGFjZW1lbnQsZS5vZmZzZXRzLnJlZmVyZW5jZSx0aGlzLnBvcHBlcix0aGlzLnJlZmVyZW5jZSx0aGlzLm9wdGlvbnMubW9kaWZpZXJzLmZsaXAuYm91bmRhcmllc0VsZW1lbnQsdGhpcy5vcHRpb25zLm1vZGlmaWVycy5mbGlwLnBhZGRpbmcpLGUub3JpZ2luYWxQbGFjZW1lbnQ9ZS5wbGFjZW1lbnQsZS5wb3NpdGlvbkZpeGVkPXRoaXMub3B0aW9ucy5wb3NpdGlvbkZpeGVkLGUub2Zmc2V0cy5wb3BwZXI9Qyh0aGlzLnBvcHBlcixlLm9mZnNldHMucmVmZXJlbmNlLGUucGxhY2VtZW50KSxlLm9mZnNldHMucG9wcGVyLnBvc2l0aW9uPXRoaXMub3B0aW9ucy5wb3NpdGlvbkZpeGVkPydmaXhlZCc6J2Fic29sdXRlJyxlPVAodGhpcy5tb2RpZmllcnMsZSksdGhpcy5zdGF0ZS5pc0NyZWF0ZWQ/dGhpcy5vcHRpb25zLm9uVXBkYXRlKGUpOih0aGlzLnN0YXRlLmlzQ3JlYXRlZD0hMCx0aGlzLm9wdGlvbnMub25DcmVhdGUoZSkpfX1mdW5jdGlvbiBXKGUsdCl7cmV0dXJuIGUuc29tZShmdW5jdGlvbihlKXt2YXIgbz1lLm5hbWUsbj1lLmVuYWJsZWQ7cmV0dXJuIG4mJm89PT10fSl9ZnVuY3Rpb24gQihlKXtmb3IodmFyIHQ9WyExLCdtcycsJ1dlYmtpdCcsJ01veicsJ08nXSxvPWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrZS5zbGljZSgxKSxuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciBpPXRbbl0scj1pPycnK2krbzplO2lmKCd1bmRlZmluZWQnIT10eXBlb2YgZG9jdW1lbnQuYm9keS5zdHlsZVtyXSlyZXR1cm4gcn1yZXR1cm4gbnVsbH1mdW5jdGlvbiBIKCl7cmV0dXJuIHRoaXMuc3RhdGUuaXNEZXN0cm95ZWQ9ITAsVyh0aGlzLm1vZGlmaWVycywnYXBwbHlTdHlsZScpJiYodGhpcy5wb3BwZXIucmVtb3ZlQXR0cmlidXRlKCd4LXBsYWNlbWVudCcpLHRoaXMucG9wcGVyLnN0eWxlLnBvc2l0aW9uPScnLHRoaXMucG9wcGVyLnN0eWxlLnRvcD0nJyx0aGlzLnBvcHBlci5zdHlsZS5sZWZ0PScnLHRoaXMucG9wcGVyLnN0eWxlLnJpZ2h0PScnLHRoaXMucG9wcGVyLnN0eWxlLmJvdHRvbT0nJyx0aGlzLnBvcHBlci5zdHlsZS53aWxsQ2hhbmdlPScnLHRoaXMucG9wcGVyLnN0eWxlW0IoJ3RyYW5zZm9ybScpXT0nJyksdGhpcy5kaXNhYmxlRXZlbnRMaXN0ZW5lcnMoKSx0aGlzLm9wdGlvbnMucmVtb3ZlT25EZXN0cm95JiZ0aGlzLnBvcHBlci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMucG9wcGVyKSx0aGlzfWZ1bmN0aW9uIEEoZSl7dmFyIHQ9ZS5vd25lckRvY3VtZW50O3JldHVybiB0P3QuZGVmYXVsdFZpZXc6d2luZG93fWZ1bmN0aW9uIE0oZSx0LG8saSl7dmFyIHI9J0JPRFknPT09ZS5ub2RlTmFtZSxwPXI/ZS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3OmU7cC5hZGRFdmVudExpc3RlbmVyKHQsbyx7cGFzc2l2ZTohMH0pLHJ8fE0obihwLnBhcmVudE5vZGUpLHQsbyxpKSxpLnB1c2gocCl9ZnVuY3Rpb24gRihlLHQsbyxpKXtvLnVwZGF0ZUJvdW5kPWksQShlKS5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLG8udXBkYXRlQm91bmQse3Bhc3NpdmU6ITB9KTt2YXIgcj1uKGUpO3JldHVybiBNKHIsJ3Njcm9sbCcsby51cGRhdGVCb3VuZCxvLnNjcm9sbFBhcmVudHMpLG8uc2Nyb2xsRWxlbWVudD1yLG8uZXZlbnRzRW5hYmxlZD0hMCxvfWZ1bmN0aW9uIEkoKXt0aGlzLnN0YXRlLmV2ZW50c0VuYWJsZWR8fCh0aGlzLnN0YXRlPUYodGhpcy5yZWZlcmVuY2UsdGhpcy5vcHRpb25zLHRoaXMuc3RhdGUsdGhpcy5zY2hlZHVsZVVwZGF0ZSkpfWZ1bmN0aW9uIFIoZSx0KXtyZXR1cm4gQShlKS5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLHQudXBkYXRlQm91bmQpLHQuc2Nyb2xsUGFyZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJyx0LnVwZGF0ZUJvdW5kKX0pLHQudXBkYXRlQm91bmQ9bnVsbCx0LnNjcm9sbFBhcmVudHM9W10sdC5zY3JvbGxFbGVtZW50PW51bGwsdC5ldmVudHNFbmFibGVkPSExLHR9ZnVuY3Rpb24gVSgpe3RoaXMuc3RhdGUuZXZlbnRzRW5hYmxlZCYmKGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuc2NoZWR1bGVVcGRhdGUpLHRoaXMuc3RhdGU9Uih0aGlzLnJlZmVyZW5jZSx0aGlzLnN0YXRlKSl9ZnVuY3Rpb24gWShlKXtyZXR1cm4nJyE9PWUmJiFpc05hTihwYXJzZUZsb2F0KGUpKSYmaXNGaW5pdGUoZSl9ZnVuY3Rpb24gVihlLHQpe09iamVjdC5rZXlzKHQpLmZvckVhY2goZnVuY3Rpb24obyl7dmFyIG49Jyc7LTEhPT1bJ3dpZHRoJywnaGVpZ2h0JywndG9wJywncmlnaHQnLCdib3R0b20nLCdsZWZ0J10uaW5kZXhPZihvKSYmWSh0W29dKSYmKG49J3B4JyksZS5zdHlsZVtvXT10W29dK259KX1mdW5jdGlvbiBqKGUsdCl7T2JqZWN0LmtleXModCkuZm9yRWFjaChmdW5jdGlvbihvKXt2YXIgbj10W29dOyExPT09bj9lLnJlbW92ZUF0dHJpYnV0ZShvKTplLnNldEF0dHJpYnV0ZShvLHRbb10pfSl9ZnVuY3Rpb24gcShlLHQpe3ZhciBvPWUub2Zmc2V0cyxuPW8ucG9wcGVyLGk9by5yZWZlcmVuY2Uscj0kLHA9ZnVuY3Rpb24oZSl7cmV0dXJuIGV9LHM9cihpLndpZHRoKSxkPXIobi53aWR0aCksYT0tMSE9PVsnbGVmdCcsJ3JpZ2h0J10uaW5kZXhPZihlLnBsYWNlbWVudCksbD0tMSE9PWUucGxhY2VtZW50LmluZGV4T2YoJy0nKSxmPXQ/YXx8bHx8cyUyPT1kJTI/cjpaOnAsbT10P3I6cDtyZXR1cm57bGVmdDpmKDE9PXMlMiYmMT09ZCUyJiYhbCYmdD9uLmxlZnQtMTpuLmxlZnQpLHRvcDptKG4udG9wKSxib3R0b206bShuLmJvdHRvbSkscmlnaHQ6ZihuLnJpZ2h0KX19ZnVuY3Rpb24gSyhlLHQsbyl7dmFyIG49RChlLGZ1bmN0aW9uKGUpe3ZhciBvPWUubmFtZTtyZXR1cm4gbz09PXR9KSxpPSEhbiYmZS5zb21lKGZ1bmN0aW9uKGUpe3JldHVybiBlLm5hbWU9PT1vJiZlLmVuYWJsZWQmJmUub3JkZXI8bi5vcmRlcn0pO2lmKCFpKXt2YXIgcj0nYCcrdCsnYCc7Y29uc29sZS53YXJuKCdgJytvKydgJysnIG1vZGlmaWVyIGlzIHJlcXVpcmVkIGJ5ICcrcisnIG1vZGlmaWVyIGluIG9yZGVyIHRvIHdvcmssIGJlIHN1cmUgdG8gaW5jbHVkZSBpdCBiZWZvcmUgJytyKychJyl9cmV0dXJuIGl9ZnVuY3Rpb24geihlKXtyZXR1cm4nZW5kJz09PWU/J3N0YXJ0Jzonc3RhcnQnPT09ZT8nZW5kJzplfWZ1bmN0aW9uIEcoZSl7dmFyIHQ9MTxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0mJmFyZ3VtZW50c1sxXSxvPWNlLmluZGV4T2YoZSksbj1jZS5zbGljZShvKzEpLmNvbmNhdChjZS5zbGljZSgwLG8pKTtyZXR1cm4gdD9uLnJldmVyc2UoKTpufWZ1bmN0aW9uIF8oZSx0LG8sbil7dmFyIGk9ZS5tYXRjaCgvKCg/OlwtfFwrKT9cZCpcLj9cZCopKC4qKS8pLHI9K2lbMV0scD1pWzJdO2lmKCFyKXJldHVybiBlO2lmKDA9PT1wLmluZGV4T2YoJyUnKSl7dmFyIHM7c3dpdGNoKHApe2Nhc2UnJXAnOnM9bzticmVhaztjYXNlJyUnOmNhc2UnJXInOmRlZmF1bHQ6cz1uO312YXIgZD1nKHMpO3JldHVybiBkW3RdLzEwMCpyfWlmKCd2aCc9PT1wfHwndncnPT09cCl7dmFyIGE7cmV0dXJuIGE9J3ZoJz09PXA/ZWUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCx3aW5kb3cuaW5uZXJIZWlnaHR8fDApOmVlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCx3aW5kb3cuaW5uZXJXaWR0aHx8MCksYS8xMDAqcn1yZXR1cm4gcn1mdW5jdGlvbiBYKGUsdCxvLG4pe3ZhciBpPVswLDBdLHI9LTEhPT1bJ3JpZ2h0JywnbGVmdCddLmluZGV4T2YobikscD1lLnNwbGl0KC8oXCt8XC0pLykubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBlLnRyaW0oKX0pLHM9cC5pbmRleE9mKEQocCxmdW5jdGlvbihlKXtyZXR1cm4tMSE9PWUuc2VhcmNoKC8sfFxzLyl9KSk7cFtzXSYmLTE9PT1wW3NdLmluZGV4T2YoJywnKSYmY29uc29sZS53YXJuKCdPZmZzZXRzIHNlcGFyYXRlZCBieSB3aGl0ZSBzcGFjZShzKSBhcmUgZGVwcmVjYXRlZCwgdXNlIGEgY29tbWEgKCwpIGluc3RlYWQuJyk7dmFyIGQ9L1xzKixccyp8XHMrLyxhPS0xPT09cz9bcF06W3Auc2xpY2UoMCxzKS5jb25jYXQoW3Bbc10uc3BsaXQoZClbMF1dKSxbcFtzXS5zcGxpdChkKVsxXV0uY29uY2F0KHAuc2xpY2UocysxKSldO3JldHVybiBhPWEubWFwKGZ1bmN0aW9uKGUsbil7dmFyIGk9KDE9PT1uPyFyOnIpPydoZWlnaHQnOid3aWR0aCcscD0hMTtyZXR1cm4gZS5yZWR1Y2UoZnVuY3Rpb24oZSx0KXtyZXR1cm4nJz09PWVbZS5sZW5ndGgtMV0mJi0xIT09WycrJywnLSddLmluZGV4T2YodCk/KGVbZS5sZW5ndGgtMV09dCxwPSEwLGUpOnA/KGVbZS5sZW5ndGgtMV0rPXQscD0hMSxlKTplLmNvbmNhdCh0KX0sW10pLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gXyhlLGksdCxvKX0pfSksYS5mb3JFYWNoKGZ1bmN0aW9uKGUsdCl7ZS5mb3JFYWNoKGZ1bmN0aW9uKG8sbil7WShvKSYmKGlbdF0rPW8qKCctJz09PWVbbi0xXT8tMToxKSl9KX0pLGl9ZnVuY3Rpb24gSihlLHQpe3ZhciBvLG49dC5vZmZzZXQsaT1lLnBsYWNlbWVudCxyPWUub2Zmc2V0cyxwPXIucG9wcGVyLHM9ci5yZWZlcmVuY2UsZD1pLnNwbGl0KCctJylbMF07cmV0dXJuIG89WSgrbik/WytuLDBdOlgobixwLHMsZCksJ2xlZnQnPT09ZD8ocC50b3ArPW9bMF0scC5sZWZ0LT1vWzFdKToncmlnaHQnPT09ZD8ocC50b3ArPW9bMF0scC5sZWZ0Kz1vWzFdKTondG9wJz09PWQ/KHAubGVmdCs9b1swXSxwLnRvcC09b1sxXSk6J2JvdHRvbSc9PT1kJiYocC5sZWZ0Kz1vWzBdLHAudG9wKz1vWzFdKSxlLnBvcHBlcj1wLGV9Zm9yKHZhciBRPU1hdGgubWluLFo9TWF0aC5mbG9vciwkPU1hdGgucm91bmQsZWU9TWF0aC5tYXgsdGU9J3VuZGVmaW5lZCchPXR5cGVvZiB3aW5kb3cmJid1bmRlZmluZWQnIT10eXBlb2YgZG9jdW1lbnQsb2U9WydFZGdlJywnVHJpZGVudCcsJ0ZpcmVmb3gnXSxuZT0wLGllPTA7aWU8b2UubGVuZ3RoO2llKz0xKWlmKHRlJiYwPD1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2Yob2VbaWVdKSl7bmU9MTticmVha312YXIgaT10ZSYmd2luZG93LlByb21pc2UscmU9aT9mdW5jdGlvbihlKXt2YXIgdD0hMTtyZXR1cm4gZnVuY3Rpb24oKXt0fHwodD0hMCx3aW5kb3cuUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpe3Q9ITEsZSgpfSkpfX06ZnVuY3Rpb24oZSl7dmFyIHQ9ITE7cmV0dXJuIGZ1bmN0aW9uKCl7dHx8KHQ9ITAsc2V0VGltZW91dChmdW5jdGlvbigpe3Q9ITEsZSgpfSxuZSkpfX0scGU9dGUmJiEhKHdpbmRvdy5NU0lucHV0TWV0aG9kQ29udGV4dCYmZG9jdW1lbnQuZG9jdW1lbnRNb2RlKSxzZT10ZSYmL01TSUUgMTAvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksZGU9ZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKX0sYWU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7Zm9yKHZhciBvLG49MDtuPHQubGVuZ3RoO24rKylvPXRbbl0sby5lbnVtZXJhYmxlPW8uZW51bWVyYWJsZXx8ITEsby5jb25maWd1cmFibGU9ITAsJ3ZhbHVlJ2luIG8mJihvLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxvLmtleSxvKX1yZXR1cm4gZnVuY3Rpb24odCxvLG4pe3JldHVybiBvJiZlKHQucHJvdG90eXBlLG8pLG4mJmUodCxuKSx0fX0oKSxsZT1mdW5jdGlvbihlLHQsbyl7cmV0dXJuIHQgaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHt2YWx1ZTpvLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVt0XT1vLGV9LGZlPU9iamVjdC5hc3NpZ258fGZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxvPTE7bzxhcmd1bWVudHMubGVuZ3RoO28rKylmb3IodmFyIG4gaW4gdD1hcmd1bWVudHNbb10sdClPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxuKSYmKGVbbl09dFtuXSk7cmV0dXJuIGV9LG1lPXRlJiYvRmlyZWZveC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksaGU9WydhdXRvLXN0YXJ0JywnYXV0bycsJ2F1dG8tZW5kJywndG9wLXN0YXJ0JywndG9wJywndG9wLWVuZCcsJ3JpZ2h0LXN0YXJ0JywncmlnaHQnLCdyaWdodC1lbmQnLCdib3R0b20tZW5kJywnYm90dG9tJywnYm90dG9tLXN0YXJ0JywnbGVmdC1lbmQnLCdsZWZ0JywnbGVmdC1zdGFydCddLGNlPWhlLnNsaWNlKDMpLGdlPXtGTElQOidmbGlwJyxDTE9DS1dJU0U6J2Nsb2Nrd2lzZScsQ09VTlRFUkNMT0NLV0lTRTonY291bnRlcmNsb2Nrd2lzZSd9LHVlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChvLG4pe3ZhciBpPXRoaXMscj0yPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1syXT9hcmd1bWVudHNbMl06e307ZGUodGhpcyx0KSx0aGlzLnNjaGVkdWxlVXBkYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHJlcXVlc3RBbmltYXRpb25GcmFtZShpLnVwZGF0ZSl9LHRoaXMudXBkYXRlPXJlKHRoaXMudXBkYXRlLmJpbmQodGhpcykpLHRoaXMub3B0aW9ucz1mZSh7fSx0LkRlZmF1bHRzLHIpLHRoaXMuc3RhdGU9e2lzRGVzdHJveWVkOiExLGlzQ3JlYXRlZDohMSxzY3JvbGxQYXJlbnRzOltdfSx0aGlzLnJlZmVyZW5jZT1vJiZvLmpxdWVyeT9vWzBdOm8sdGhpcy5wb3BwZXI9biYmbi5qcXVlcnk/blswXTpuLHRoaXMub3B0aW9ucy5tb2RpZmllcnM9e30sT2JqZWN0LmtleXMoZmUoe30sdC5EZWZhdWx0cy5tb2RpZmllcnMsci5tb2RpZmllcnMpKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2kub3B0aW9ucy5tb2RpZmllcnNbZV09ZmUoe30sdC5EZWZhdWx0cy5tb2RpZmllcnNbZV18fHt9LHIubW9kaWZpZXJzP3IubW9kaWZpZXJzW2VdOnt9KX0pLHRoaXMubW9kaWZpZXJzPU9iamVjdC5rZXlzKHRoaXMub3B0aW9ucy5tb2RpZmllcnMpLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gZmUoe25hbWU6ZX0saS5vcHRpb25zLm1vZGlmaWVyc1tlXSl9KS5zb3J0KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUub3JkZXItdC5vcmRlcn0pLHRoaXMubW9kaWZpZXJzLmZvckVhY2goZnVuY3Rpb24odCl7dC5lbmFibGVkJiZlKHQub25Mb2FkKSYmdC5vbkxvYWQoaS5yZWZlcmVuY2UsaS5wb3BwZXIsaS5vcHRpb25zLHQsaS5zdGF0ZSl9KSx0aGlzLnVwZGF0ZSgpO3ZhciBwPXRoaXMub3B0aW9ucy5ldmVudHNFbmFibGVkO3AmJnRoaXMuZW5hYmxlRXZlbnRMaXN0ZW5lcnMoKSx0aGlzLnN0YXRlLmV2ZW50c0VuYWJsZWQ9cH1yZXR1cm4gYWUodCxbe2tleTondXBkYXRlJyx2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBrLmNhbGwodGhpcyl9fSx7a2V5OidkZXN0cm95Jyx2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBILmNhbGwodGhpcyl9fSx7a2V5OidlbmFibGVFdmVudExpc3RlbmVycycsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gSS5jYWxsKHRoaXMpfX0se2tleTonZGlzYWJsZUV2ZW50TGlzdGVuZXJzJyx2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBVLmNhbGwodGhpcyl9fV0pLHR9KCk7cmV0dXJuIHVlLlV0aWxzPSgndW5kZWZpbmVkJz09dHlwZW9mIHdpbmRvdz9nbG9iYWw6d2luZG93KS5Qb3BwZXJVdGlscyx1ZS5wbGFjZW1lbnRzPWhlLHVlLkRlZmF1bHRzPXtwbGFjZW1lbnQ6J2JvdHRvbScscG9zaXRpb25GaXhlZDohMSxldmVudHNFbmFibGVkOiEwLHJlbW92ZU9uRGVzdHJveTohMSxvbkNyZWF0ZTpmdW5jdGlvbigpe30sb25VcGRhdGU6ZnVuY3Rpb24oKXt9LG1vZGlmaWVyczp7c2hpZnQ6e29yZGVyOjEwMCxlbmFibGVkOiEwLGZuOmZ1bmN0aW9uKGUpe3ZhciB0PWUucGxhY2VtZW50LG89dC5zcGxpdCgnLScpWzBdLG49dC5zcGxpdCgnLScpWzFdO2lmKG4pe3ZhciBpPWUub2Zmc2V0cyxyPWkucmVmZXJlbmNlLHA9aS5wb3BwZXIscz0tMSE9PVsnYm90dG9tJywndG9wJ10uaW5kZXhPZihvKSxkPXM/J2xlZnQnOid0b3AnLGE9cz8nd2lkdGgnOidoZWlnaHQnLGw9e3N0YXJ0OmxlKHt9LGQscltkXSksZW5kOmxlKHt9LGQscltkXStyW2FdLXBbYV0pfTtlLm9mZnNldHMucG9wcGVyPWZlKHt9LHAsbFtuXSl9cmV0dXJuIGV9fSxvZmZzZXQ6e29yZGVyOjIwMCxlbmFibGVkOiEwLGZuOkosb2Zmc2V0OjB9LHByZXZlbnRPdmVyZmxvdzp7b3JkZXI6MzAwLGVuYWJsZWQ6ITAsZm46ZnVuY3Rpb24oZSx0KXt2YXIgbz10LmJvdW5kYXJpZXNFbGVtZW50fHxwKGUuaW5zdGFuY2UucG9wcGVyKTtlLmluc3RhbmNlLnJlZmVyZW5jZT09PW8mJihvPXAobykpO3ZhciBuPUIoJ3RyYW5zZm9ybScpLGk9ZS5pbnN0YW5jZS5wb3BwZXIuc3R5bGUscj1pLnRvcCxzPWkubGVmdCxkPWlbbl07aS50b3A9JycsaS5sZWZ0PScnLGlbbl09Jyc7dmFyIGE9dihlLmluc3RhbmNlLnBvcHBlcixlLmluc3RhbmNlLnJlZmVyZW5jZSx0LnBhZGRpbmcsbyxlLnBvc2l0aW9uRml4ZWQpO2kudG9wPXIsaS5sZWZ0PXMsaVtuXT1kLHQuYm91bmRhcmllcz1hO3ZhciBsPXQucHJpb3JpdHksZj1lLm9mZnNldHMucG9wcGVyLG09e3ByaW1hcnk6ZnVuY3Rpb24oZSl7dmFyIG89ZltlXTtyZXR1cm4gZltlXTxhW2VdJiYhdC5lc2NhcGVXaXRoUmVmZXJlbmNlJiYobz1lZShmW2VdLGFbZV0pKSxsZSh7fSxlLG8pfSxzZWNvbmRhcnk6ZnVuY3Rpb24oZSl7dmFyIG89J3JpZ2h0Jz09PWU/J2xlZnQnOid0b3AnLG49ZltvXTtyZXR1cm4gZltlXT5hW2VdJiYhdC5lc2NhcGVXaXRoUmVmZXJlbmNlJiYobj1RKGZbb10sYVtlXS0oJ3JpZ2h0Jz09PWU/Zi53aWR0aDpmLmhlaWdodCkpKSxsZSh7fSxvLG4pfX07cmV0dXJuIGwuZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgdD0tMT09PVsnbGVmdCcsJ3RvcCddLmluZGV4T2YoZSk/J3NlY29uZGFyeSc6J3ByaW1hcnknO2Y9ZmUoe30sZixtW3RdKGUpKX0pLGUub2Zmc2V0cy5wb3BwZXI9ZixlfSxwcmlvcml0eTpbJ2xlZnQnLCdyaWdodCcsJ3RvcCcsJ2JvdHRvbSddLHBhZGRpbmc6NSxib3VuZGFyaWVzRWxlbWVudDonc2Nyb2xsUGFyZW50J30sa2VlcFRvZ2V0aGVyOntvcmRlcjo0MDAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbihlKXt2YXIgdD1lLm9mZnNldHMsbz10LnBvcHBlcixuPXQucmVmZXJlbmNlLGk9ZS5wbGFjZW1lbnQuc3BsaXQoJy0nKVswXSxyPVoscD0tMSE9PVsndG9wJywnYm90dG9tJ10uaW5kZXhPZihpKSxzPXA/J3JpZ2h0JzonYm90dG9tJyxkPXA/J2xlZnQnOid0b3AnLGE9cD8nd2lkdGgnOidoZWlnaHQnO3JldHVybiBvW3NdPHIobltkXSkmJihlLm9mZnNldHMucG9wcGVyW2RdPXIobltkXSktb1thXSksb1tkXT5yKG5bc10pJiYoZS5vZmZzZXRzLnBvcHBlcltkXT1yKG5bc10pKSxlfX0sYXJyb3c6e29yZGVyOjUwMCxlbmFibGVkOiEwLGZuOmZ1bmN0aW9uKGUsbyl7dmFyIG47aWYoIUsoZS5pbnN0YW5jZS5tb2RpZmllcnMsJ2Fycm93Jywna2VlcFRvZ2V0aGVyJykpcmV0dXJuIGU7dmFyIGk9by5lbGVtZW50O2lmKCdzdHJpbmcnPT10eXBlb2YgaSl7aWYoaT1lLmluc3RhbmNlLnBvcHBlci5xdWVyeVNlbGVjdG9yKGkpLCFpKXJldHVybiBlO31lbHNlIGlmKCFlLmluc3RhbmNlLnBvcHBlci5jb250YWlucyhpKSlyZXR1cm4gY29uc29sZS53YXJuKCdXQVJOSU5HOiBgYXJyb3cuZWxlbWVudGAgbXVzdCBiZSBjaGlsZCBvZiBpdHMgcG9wcGVyIGVsZW1lbnQhJyksZTt2YXIgcj1lLnBsYWNlbWVudC5zcGxpdCgnLScpWzBdLHA9ZS5vZmZzZXRzLHM9cC5wb3BwZXIsZD1wLnJlZmVyZW5jZSxhPS0xIT09WydsZWZ0JywncmlnaHQnXS5pbmRleE9mKHIpLGw9YT8naGVpZ2h0Jzond2lkdGgnLGY9YT8nVG9wJzonTGVmdCcsbT1mLnRvTG93ZXJDYXNlKCksaD1hPydsZWZ0JzondG9wJyxjPWE/J2JvdHRvbSc6J3JpZ2h0Jyx1PVMoaSlbbF07ZFtjXS11PHNbbV0mJihlLm9mZnNldHMucG9wcGVyW21dLT1zW21dLShkW2NdLXUpKSxkW21dK3U+c1tjXSYmKGUub2Zmc2V0cy5wb3BwZXJbbV0rPWRbbV0rdS1zW2NdKSxlLm9mZnNldHMucG9wcGVyPWcoZS5vZmZzZXRzLnBvcHBlcik7dmFyIGI9ZFttXStkW2xdLzItdS8yLHc9dChlLmluc3RhbmNlLnBvcHBlcikseT1wYXJzZUZsb2F0KHdbJ21hcmdpbicrZl0sMTApLEU9cGFyc2VGbG9hdCh3Wydib3JkZXInK2YrJ1dpZHRoJ10sMTApLHY9Yi1lLm9mZnNldHMucG9wcGVyW21dLXktRTtyZXR1cm4gdj1lZShRKHNbbF0tdSx2KSwwKSxlLmFycm93RWxlbWVudD1pLGUub2Zmc2V0cy5hcnJvdz0obj17fSxsZShuLG0sJCh2KSksbGUobixoLCcnKSxuKSxlfSxlbGVtZW50OidbeC1hcnJvd10nfSxmbGlwOntvcmRlcjo2MDAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbihlLHQpe2lmKFcoZS5pbnN0YW5jZS5tb2RpZmllcnMsJ2lubmVyJykpcmV0dXJuIGU7aWYoZS5mbGlwcGVkJiZlLnBsYWNlbWVudD09PWUub3JpZ2luYWxQbGFjZW1lbnQpcmV0dXJuIGU7dmFyIG89dihlLmluc3RhbmNlLnBvcHBlcixlLmluc3RhbmNlLnJlZmVyZW5jZSx0LnBhZGRpbmcsdC5ib3VuZGFyaWVzRWxlbWVudCxlLnBvc2l0aW9uRml4ZWQpLG49ZS5wbGFjZW1lbnQuc3BsaXQoJy0nKVswXSxpPVQobikscj1lLnBsYWNlbWVudC5zcGxpdCgnLScpWzFdfHwnJyxwPVtdO3N3aXRjaCh0LmJlaGF2aW9yKXtjYXNlIGdlLkZMSVA6cD1bbixpXTticmVhaztjYXNlIGdlLkNMT0NLV0lTRTpwPUcobik7YnJlYWs7Y2FzZSBnZS5DT1VOVEVSQ0xPQ0tXSVNFOnA9RyhuLCEwKTticmVhaztkZWZhdWx0OnA9dC5iZWhhdmlvcjt9cmV0dXJuIHAuZm9yRWFjaChmdW5jdGlvbihzLGQpe2lmKG4hPT1zfHxwLmxlbmd0aD09PWQrMSlyZXR1cm4gZTtuPWUucGxhY2VtZW50LnNwbGl0KCctJylbMF0saT1UKG4pO3ZhciBhPWUub2Zmc2V0cy5wb3BwZXIsbD1lLm9mZnNldHMucmVmZXJlbmNlLGY9WixtPSdsZWZ0Jz09PW4mJmYoYS5yaWdodCk+ZihsLmxlZnQpfHwncmlnaHQnPT09biYmZihhLmxlZnQpPGYobC5yaWdodCl8fCd0b3AnPT09biYmZihhLmJvdHRvbSk+ZihsLnRvcCl8fCdib3R0b20nPT09biYmZihhLnRvcCk8ZihsLmJvdHRvbSksaD1mKGEubGVmdCk8ZihvLmxlZnQpLGM9ZihhLnJpZ2h0KT5mKG8ucmlnaHQpLGc9ZihhLnRvcCk8ZihvLnRvcCksdT1mKGEuYm90dG9tKT5mKG8uYm90dG9tKSxiPSdsZWZ0Jz09PW4mJmh8fCdyaWdodCc9PT1uJiZjfHwndG9wJz09PW4mJmd8fCdib3R0b20nPT09biYmdSx3PS0xIT09Wyd0b3AnLCdib3R0b20nXS5pbmRleE9mKG4pLHk9ISF0LmZsaXBWYXJpYXRpb25zJiYodyYmJ3N0YXJ0Jz09PXImJmh8fHcmJidlbmQnPT09ciYmY3x8IXcmJidzdGFydCc9PT1yJiZnfHwhdyYmJ2VuZCc9PT1yJiZ1KSxFPSEhdC5mbGlwVmFyaWF0aW9uc0J5Q29udGVudCYmKHcmJidzdGFydCc9PT1yJiZjfHx3JiYnZW5kJz09PXImJmh8fCF3JiYnc3RhcnQnPT09ciYmdXx8IXcmJidlbmQnPT09ciYmZyksdj15fHxFOyhtfHxifHx2KSYmKGUuZmxpcHBlZD0hMCwobXx8YikmJihuPXBbZCsxXSksdiYmKHI9eihyKSksZS5wbGFjZW1lbnQ9bisocj8nLScrcjonJyksZS5vZmZzZXRzLnBvcHBlcj1mZSh7fSxlLm9mZnNldHMucG9wcGVyLEMoZS5pbnN0YW5jZS5wb3BwZXIsZS5vZmZzZXRzLnJlZmVyZW5jZSxlLnBsYWNlbWVudCkpLGU9UChlLmluc3RhbmNlLm1vZGlmaWVycyxlLCdmbGlwJykpfSksZX0sYmVoYXZpb3I6J2ZsaXAnLHBhZGRpbmc6NSxib3VuZGFyaWVzRWxlbWVudDondmlld3BvcnQnLGZsaXBWYXJpYXRpb25zOiExLGZsaXBWYXJpYXRpb25zQnlDb250ZW50OiExfSxpbm5lcjp7b3JkZXI6NzAwLGVuYWJsZWQ6ITEsZm46ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wbGFjZW1lbnQsbz10LnNwbGl0KCctJylbMF0sbj1lLm9mZnNldHMsaT1uLnBvcHBlcixyPW4ucmVmZXJlbmNlLHA9LTEhPT1bJ2xlZnQnLCdyaWdodCddLmluZGV4T2Yobykscz0tMT09PVsndG9wJywnbGVmdCddLmluZGV4T2Yobyk7cmV0dXJuIGlbcD8nbGVmdCc6J3RvcCddPXJbb10tKHM/aVtwPyd3aWR0aCc6J2hlaWdodCddOjApLGUucGxhY2VtZW50PVQodCksZS5vZmZzZXRzLnBvcHBlcj1nKGkpLGV9fSxoaWRlOntvcmRlcjo4MDAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbihlKXtpZighSyhlLmluc3RhbmNlLm1vZGlmaWVycywnaGlkZScsJ3ByZXZlbnRPdmVyZmxvdycpKXJldHVybiBlO3ZhciB0PWUub2Zmc2V0cy5yZWZlcmVuY2Usbz1EKGUuaW5zdGFuY2UubW9kaWZpZXJzLGZ1bmN0aW9uKGUpe3JldHVybidwcmV2ZW50T3ZlcmZsb3cnPT09ZS5uYW1lfSkuYm91bmRhcmllcztpZih0LmJvdHRvbTxvLnRvcHx8dC5sZWZ0Pm8ucmlnaHR8fHQudG9wPm8uYm90dG9tfHx0LnJpZ2h0PG8ubGVmdCl7aWYoITA9PT1lLmhpZGUpcmV0dXJuIGU7ZS5oaWRlPSEwLGUuYXR0cmlidXRlc1sneC1vdXQtb2YtYm91bmRhcmllcyddPScnfWVsc2V7aWYoITE9PT1lLmhpZGUpcmV0dXJuIGU7ZS5oaWRlPSExLGUuYXR0cmlidXRlc1sneC1vdXQtb2YtYm91bmRhcmllcyddPSExfXJldHVybiBlfX0sY29tcHV0ZVN0eWxlOntvcmRlcjo4NTAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbihlLHQpe3ZhciBvPXQueCxuPXQueSxpPWUub2Zmc2V0cy5wb3BwZXIscj1EKGUuaW5zdGFuY2UubW9kaWZpZXJzLGZ1bmN0aW9uKGUpe3JldHVybidhcHBseVN0eWxlJz09PWUubmFtZX0pLmdwdUFjY2VsZXJhdGlvbjt2b2lkIDAhPT1yJiZjb25zb2xlLndhcm4oJ1dBUk5JTkc6IGBncHVBY2NlbGVyYXRpb25gIG9wdGlvbiBtb3ZlZCB0byBgY29tcHV0ZVN0eWxlYCBtb2RpZmllciBhbmQgd2lsbCBub3QgYmUgc3VwcG9ydGVkIGluIGZ1dHVyZSB2ZXJzaW9ucyBvZiBQb3BwZXIuanMhJyk7dmFyIHMsZCxhPXZvaWQgMD09PXI/dC5ncHVBY2NlbGVyYXRpb246cixsPXAoZS5pbnN0YW5jZS5wb3BwZXIpLGY9dShsKSxtPXtwb3NpdGlvbjppLnBvc2l0aW9ufSxoPXEoZSwyPndpbmRvdy5kZXZpY2VQaXhlbFJhdGlvfHwhbWUpLGM9J2JvdHRvbSc9PT1vPyd0b3AnOidib3R0b20nLGc9J3JpZ2h0Jz09PW4/J2xlZnQnOidyaWdodCcsYj1CKCd0cmFuc2Zvcm0nKTtpZihkPSdib3R0b20nPT1jPydIVE1MJz09PWwubm9kZU5hbWU/LWwuY2xpZW50SGVpZ2h0K2guYm90dG9tOi1mLmhlaWdodCtoLmJvdHRvbTpoLnRvcCxzPSdyaWdodCc9PWc/J0hUTUwnPT09bC5ub2RlTmFtZT8tbC5jbGllbnRXaWR0aCtoLnJpZ2h0Oi1mLndpZHRoK2gucmlnaHQ6aC5sZWZ0LGEmJmIpbVtiXT0ndHJhbnNsYXRlM2QoJytzKydweCwgJytkKydweCwgMCknLG1bY109MCxtW2ddPTAsbS53aWxsQ2hhbmdlPSd0cmFuc2Zvcm0nO2Vsc2V7dmFyIHc9J2JvdHRvbSc9PWM/LTE6MSx5PSdyaWdodCc9PWc/LTE6MTttW2NdPWQqdyxtW2ddPXMqeSxtLndpbGxDaGFuZ2U9YysnLCAnK2d9dmFyIEU9eyJ4LXBsYWNlbWVudCI6ZS5wbGFjZW1lbnR9O3JldHVybiBlLmF0dHJpYnV0ZXM9ZmUoe30sRSxlLmF0dHJpYnV0ZXMpLGUuc3R5bGVzPWZlKHt9LG0sZS5zdHlsZXMpLGUuYXJyb3dTdHlsZXM9ZmUoe30sZS5vZmZzZXRzLmFycm93LGUuYXJyb3dTdHlsZXMpLGV9LGdwdUFjY2VsZXJhdGlvbjohMCx4Oidib3R0b20nLHk6J3JpZ2h0J30sYXBwbHlTdHlsZTp7b3JkZXI6OTAwLGVuYWJsZWQ6ITAsZm46ZnVuY3Rpb24oZSl7cmV0dXJuIFYoZS5pbnN0YW5jZS5wb3BwZXIsZS5zdHlsZXMpLGooZS5pbnN0YW5jZS5wb3BwZXIsZS5hdHRyaWJ1dGVzKSxlLmFycm93RWxlbWVudCYmT2JqZWN0LmtleXMoZS5hcnJvd1N0eWxlcykubGVuZ3RoJiZWKGUuYXJyb3dFbGVtZW50LGUuYXJyb3dTdHlsZXMpLGV9LG9uTG9hZDpmdW5jdGlvbihlLHQsbyxuLGkpe3ZhciByPUwoaSx0LGUsby5wb3NpdGlvbkZpeGVkKSxwPU8oby5wbGFjZW1lbnQscix0LGUsby5tb2RpZmllcnMuZmxpcC5ib3VuZGFyaWVzRWxlbWVudCxvLm1vZGlmaWVycy5mbGlwLnBhZGRpbmcpO3JldHVybiB0LnNldEF0dHJpYnV0ZSgneC1wbGFjZW1lbnQnLHApLFYodCx7cG9zaXRpb246by5wb3NpdGlvbkZpeGVkPydmaXhlZCc6J2Fic29sdXRlJ30pLG99LGdwdUFjY2VsZXJhdGlvbjp2b2lkIDB9fX0sdWV9KTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9cG9wcGVyLm1pbi5qcy5tYXAK"
                                },
                                {
                                    "id": "presentation/tippy.min.js",
                                    "source": "IWZ1bmN0aW9uKHQsZSl7Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzJiYidW5kZWZpbmVkIiE9dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz1lKHJlcXVpcmUoInBvcHBlci5qcyIpKToiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbInBvcHBlci5qcyJdLGUpOih0PXR8fHNlbGYpLnRpcHB5PWUodC5Qb3BwZXIpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt0PXQmJnQuaGFzT3duUHJvcGVydHkoImRlZmF1bHQiKT90LmRlZmF1bHQ6dDtmdW5jdGlvbiBlKCl7cmV0dXJuKGU9T2JqZWN0LmFzc2lnbnx8ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTE7ZTxhcmd1bWVudHMubGVuZ3RoO2UrKyl7dmFyIGE9YXJndW1lbnRzW2VdO2Zvcih2YXIgciBpbiBhKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhLHIpJiYodFtyXT1hW3JdKX1yZXR1cm4gdH0pLmFwcGx5KHRoaXMsYXJndW1lbnRzKX12YXIgYT0idW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmInVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudCxyPWE/bmF2aWdhdG9yLnVzZXJBZ2VudDoiIixuPS9NU0lFIHxUcmlkZW50XC8vLnRlc3QociksaT0vVUNCcm93c2VyXC8vLnRlc3Qociksbz1hJiYvaVBob25lfGlQYWR8aVBvZC8udGVzdChuYXZpZ2F0b3IucGxhdGZvcm0pJiYhd2luZG93Lk1TU3RyZWFtLHA9e2ExMXk6ITAsYWxsb3dIVE1MOiEwLGFuaW1hdGVGaWxsOiEwLGFuaW1hdGlvbjoic2hpZnQtYXdheSIsYXBwZW5kVG86ZnVuY3Rpb24oKXtyZXR1cm4gZG9jdW1lbnQuYm9keX0sYXJpYToiZGVzY3JpYmVkYnkiLGFycm93OiExLGFycm93VHlwZToic2hhcnAiLGJvdW5kYXJ5OiJzY3JvbGxQYXJlbnQiLGNvbnRlbnQ6IiIsZGVsYXk6MCxkaXN0YW5jZToxMCxkdXJhdGlvbjpbMzI1LDI3NV0sZmxpcDohMCxmbGlwQmVoYXZpb3I6ImZsaXAiLGZsaXBPblVwZGF0ZTohMSxmb2xsb3dDdXJzb3I6ITEsaGlkZU9uQ2xpY2s6ITAsaWdub3JlQXR0cmlidXRlczohMSxpbmVydGlhOiExLGludGVyYWN0aXZlOiExLGludGVyYWN0aXZlQm9yZGVyOjIsaW50ZXJhY3RpdmVEZWJvdW5jZTowLGxhenk6ITAsbWF4V2lkdGg6MzUwLG11bHRpcGxlOiExLG9mZnNldDowLG9uSGlkZGVuOmZ1bmN0aW9uKCl7fSxvbkhpZGU6ZnVuY3Rpb24oKXt9LG9uTW91bnQ6ZnVuY3Rpb24oKXt9LG9uU2hvdzpmdW5jdGlvbigpe30sb25TaG93bjpmdW5jdGlvbigpe30sb25UcmlnZ2VyOmZ1bmN0aW9uKCl7fSxwbGFjZW1lbnQ6InRvcCIscG9wcGVyT3B0aW9uczp7fSxyb2xlOiJ0b29sdGlwIixzaG93T25Jbml0OiExLHNpemU6InJlZ3VsYXIiLHN0aWNreTohMSx0YXJnZXQ6IiIsdGhlbWU6ImRhcmsiLHRvdWNoOiEwLHRvdWNoSG9sZDohMSx0cmlnZ2VyOiJtb3VzZWVudGVyIGZvY3VzIix0cmlnZ2VyVGFyZ2V0Om51bGwsdXBkYXRlRHVyYXRpb246MCx3YWl0Om51bGwsekluZGV4Ojk5OTl9LHM9WyJhcnJvdyIsImFycm93VHlwZSIsImJvdW5kYXJ5IiwiZGlzdGFuY2UiLCJmbGlwIiwiZmxpcEJlaGF2aW9yIiwiZmxpcE9uVXBkYXRlIiwib2Zmc2V0IiwicGxhY2VtZW50IiwicG9wcGVyT3B0aW9ucyJdLGM9YT9FbGVtZW50LnByb3RvdHlwZTp7fSxsPWMubWF0Y2hlc3x8Yy5tYXRjaGVzU2VsZWN0b3J8fGMud2Via2l0TWF0Y2hlc1NlbGVjdG9yfHxjLm1vek1hdGNoZXNTZWxlY3Rvcnx8Yy5tc01hdGNoZXNTZWxlY3RvcjtmdW5jdGlvbiBkKHQpe3JldHVybltdLnNsaWNlLmNhbGwodCl9ZnVuY3Rpb24gZih0LGUpe3JldHVybiBtKHQsZnVuY3Rpb24odCl7cmV0dXJuIGwuY2FsbCh0LGUpfSl9ZnVuY3Rpb24gbSh0LGUpe2Zvcig7dDspe2lmKGUodCkpcmV0dXJuIHQ7dD10LnBhcmVudEVsZW1lbnR9cmV0dXJuIG51bGx9dmFyIHU9e3Bhc3NpdmU6ITB9LGI9NCx5PSJ4LXBsYWNlbWVudCIsdj0ieC1vdXQtb2YtYm91bmRhcmllcyIsaD0idGlwcHktaU9TIix4PSJ0aXBweS1hY3RpdmUiLGc9InRpcHB5LXBvcHBlciIsdz0idGlwcHktdG9vbHRpcCIsaz0idGlwcHktY29udGVudCIsQT0idGlwcHktYmFja2Ryb3AiLEU9InRpcHB5LWFycm93IixYPSJ0aXBweS1yb3VuZGFycm93IixZPSIuIi5jb25jYXQoZyksQz0iLiIuY29uY2F0KHcpLEw9Ii4iLmNvbmNhdChrKSxUPSIuIi5jb25jYXQoQSksST0iLiIuY29uY2F0KEUpLFM9Ii4iLmNvbmNhdChYKSxPPSExO2Z1bmN0aW9uIHooKXtPfHwoTz0hMCxvJiZkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoaCksd2luZG93LnBlcmZvcm1hbmNlJiZkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLEgpKX12YXIgTT0wO2Z1bmN0aW9uIEgoKXt2YXIgdD1wZXJmb3JtYW5jZS5ub3coKTt0LU08MjAmJihPPSExLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsSCksb3x8ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKGgpKSxNPXR9ZnVuY3Rpb24gVigpe3ZhciB0PWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7dCYmdC5ibHVyJiZ0Ll90aXBweSYmdC5ibHVyKCl9dmFyIF89T2JqZWN0LmtleXMocCk7ZnVuY3Rpb24gTih0LGUpe3JldHVybnt9Lmhhc093blByb3BlcnR5LmNhbGwodCxlKX1mdW5jdGlvbiBQKHQsZSxhKXtpZihBcnJheS5pc0FycmF5KHQpKXt2YXIgcj10W2VdO3JldHVybiBudWxsPT1yP2E6cn1yZXR1cm4gdH1mdW5jdGlvbiBEKHQsZSl7cmV0dXJuIDA9PT1lP3Q6ZnVuY3Rpb24ocil7Y2xlYXJUaW1lb3V0KGEpLGE9c2V0VGltZW91dChmdW5jdGlvbigpe3Qocil9LGUpfTt2YXIgYX1mdW5jdGlvbiBxKHQsZSl7cmV0dXJuIHQmJnQubW9kaWZpZXJzJiZ0Lm1vZGlmaWVyc1tlXX1mdW5jdGlvbiBCKHQsZSl7cmV0dXJuIHQuaW5kZXhPZihlKT4tMX1mdW5jdGlvbiBGKHQpe3JldHVybiB0IGluc3RhbmNlb2YgRWxlbWVudH1mdW5jdGlvbiBqKHQpe3JldHVybiEoIXR8fCFOKHQsImlzVmlydHVhbCIpKXx8Rih0KX1mdW5jdGlvbiBVKHQsZSl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIHQ/dC5hcHBseShudWxsLGUpOnR9ZnVuY3Rpb24gVyh0LGUpe3QuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiJmbGlwIj09PXQubmFtZX0pWzBdLmVuYWJsZWQ9ZX1mdW5jdGlvbiBSKCl7cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpfWZ1bmN0aW9uIEoodCxlKXt0LmZvckVhY2goZnVuY3Rpb24odCl7dCYmKHQuc3R5bGUudHJhbnNpdGlvbkR1cmF0aW9uPSIiLmNvbmNhdChlLCJtcyIpKX0pfWZ1bmN0aW9uIEcodCxlKXt0LmZvckVhY2goZnVuY3Rpb24odCl7dCYmdC5zZXRBdHRyaWJ1dGUoImRhdGEtc3RhdGUiLGUpfSl9ZnVuY3Rpb24gSyh0LGEpe3ZhciByPWUoe30sYSx7Y29udGVudDpVKGEuY29udGVudCxbdF0pfSxhLmlnbm9yZUF0dHJpYnV0ZXM/e306ZnVuY3Rpb24odCl7cmV0dXJuIF8ucmVkdWNlKGZ1bmN0aW9uKGUsYSl7dmFyIHI9KHQuZ2V0QXR0cmlidXRlKCJkYXRhLXRpcHB5LSIuY29uY2F0KGEpKXx8IiIpLnRyaW0oKTtpZighcilyZXR1cm4gZTtpZigiY29udGVudCI9PT1hKWVbYV09cjtlbHNlIHRyeXtlW2FdPUpTT04ucGFyc2Uocil9Y2F0Y2godCl7ZVthXT1yfXJldHVybiBlfSx7fSl9KHQpKTtyZXR1cm4oci5hcnJvd3x8aSkmJihyLmFuaW1hdGVGaWxsPSExKSxyfWZ1bmN0aW9uIFEodCxlKXtPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2lmKCFOKGUsdCkpdGhyb3cgbmV3IEVycm9yKCJbdGlwcHldOiBgIi5jb25jYXQodCwiYCBpcyBub3QgYSB2YWxpZCBvcHRpb24iKSl9KX1mdW5jdGlvbiBaKHQsZSl7dC5pbm5lckhUTUw9RihlKT9lLmlubmVySFRNTDplfWZ1bmN0aW9uICQodCxlKXtpZihGKGUuY29udGVudCkpWih0LCIiKSx0LmFwcGVuZENoaWxkKGUuY29udGVudCk7ZWxzZSBpZigiZnVuY3Rpb24iIT10eXBlb2YgZS5jb250ZW50KXt0W2UuYWxsb3dIVE1MPyJpbm5lckhUTUwiOiJ0ZXh0Q29udGVudCJdPWUuY29udGVudH19ZnVuY3Rpb24gdHQodCl7cmV0dXJue3Rvb2x0aXA6dC5xdWVyeVNlbGVjdG9yKEMpLGJhY2tkcm9wOnQucXVlcnlTZWxlY3RvcihUKSxjb250ZW50OnQucXVlcnlTZWxlY3RvcihMKSxhcnJvdzp0LnF1ZXJ5U2VsZWN0b3IoSSl8fHQucXVlcnlTZWxlY3RvcihTKX19ZnVuY3Rpb24gZXQodCl7dC5zZXRBdHRyaWJ1dGUoImRhdGEtaW5lcnRpYSIsIiIpfWZ1bmN0aW9uIGF0KHQpe3ZhciBlPVIoKTtyZXR1cm4icm91bmQiPT09dD8oZS5jbGFzc05hbWU9WCxaKGUsJzxzdmcgdmlld0JveD0iMCAwIDE4IDciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTAgN3MyLjAyMS0uMDE1IDUuMjUzLTQuMjE4QzYuNTg0IDEuMDUxIDcuNzk3LjAwNyA5IDBjMS4yMDMtLjAwNyAyLjQxNiAxLjAzNSAzLjc2MSAyLjc4MkMxNi4wMTIgNy4wMDUgMTggNyAxOCA3SDB6Ii8+PC9zdmc+JykpOmUuY2xhc3NOYW1lPUUsZX1mdW5jdGlvbiBydCgpe3ZhciB0PVIoKTtyZXR1cm4gdC5jbGFzc05hbWU9QSx0LnNldEF0dHJpYnV0ZSgiZGF0YS1zdGF0ZSIsImhpZGRlbiIpLHR9ZnVuY3Rpb24gbnQodCxlKXt0LnNldEF0dHJpYnV0ZSgidGFiaW5kZXgiLCItMSIpLGUuc2V0QXR0cmlidXRlKCJkYXRhLWludGVyYWN0aXZlIiwiIil9ZnVuY3Rpb24gaXQodCxlLGEpe3ZhciByPWkmJnZvaWQgMCE9PWRvY3VtZW50LmJvZHkuc3R5bGUud2Via2l0VHJhbnNpdGlvbj8id2Via2l0VHJhbnNpdGlvbkVuZCI6InRyYW5zaXRpb25lbmQiO3RbZSsiRXZlbnRMaXN0ZW5lciJdKHIsYSl9ZnVuY3Rpb24gb3QodCl7dmFyIGU9dC5nZXRBdHRyaWJ1dGUoeSk7cmV0dXJuIGU/ZS5zcGxpdCgiLSIpWzBdOiIifWZ1bmN0aW9uIHB0KHQsZSxhKXthLnNwbGl0KCIgIikuZm9yRWFjaChmdW5jdGlvbihhKXt0LmNsYXNzTGlzdFtlXShhKyItdGhlbWUiKX0pfWZ1bmN0aW9uIHN0KHQsZSl7dmFyIGE9UigpO2EuY2xhc3NOYW1lPWcsYS5pZD0idGlwcHktIi5jb25jYXQodCksYS5zdHlsZS56SW5kZXg9IiIrZS56SW5kZXgsYS5zdHlsZS5wb3NpdGlvbj0iYWJzb2x1dGUiLGEuc3R5bGUudG9wPSIwIixhLnN0eWxlLmxlZnQ9IjAiLGUucm9sZSYmYS5zZXRBdHRyaWJ1dGUoInJvbGUiLGUucm9sZSk7dmFyIHI9UigpO3IuY2xhc3NOYW1lPXcsci5zdHlsZS5tYXhXaWR0aD1lLm1heFdpZHRoKygibnVtYmVyIj09dHlwZW9mIGUubWF4V2lkdGg/InB4IjoiIiksci5zZXRBdHRyaWJ1dGUoImRhdGEtc2l6ZSIsZS5zaXplKSxyLnNldEF0dHJpYnV0ZSgiZGF0YS1hbmltYXRpb24iLGUuYW5pbWF0aW9uKSxyLnNldEF0dHJpYnV0ZSgiZGF0YS1zdGF0ZSIsImhpZGRlbiIpLHB0KHIsImFkZCIsZS50aGVtZSk7dmFyIG49UigpO3JldHVybiBuLmNsYXNzTmFtZT1rLG4uc2V0QXR0cmlidXRlKCJkYXRhLXN0YXRlIiwiaGlkZGVuIiksZS5pbnRlcmFjdGl2ZSYmbnQoYSxyKSxlLmFycm93JiZyLmFwcGVuZENoaWxkKGF0KGUuYXJyb3dUeXBlKSksZS5hbmltYXRlRmlsbCYmKHIuYXBwZW5kQ2hpbGQocnQoKSksci5zZXRBdHRyaWJ1dGUoImRhdGEtYW5pbWF0ZWZpbGwiLCIiKSksZS5pbmVydGlhJiZldChyKSwkKG4sZSksci5hcHBlbmRDaGlsZChuKSxhLmFwcGVuZENoaWxkKHIpLGF9ZnVuY3Rpb24gY3QodCxlLGEpe3ZhciByPXR0KHQpLG49ci50b29sdGlwLGk9ci5jb250ZW50LG89ci5iYWNrZHJvcCxwPXIuYXJyb3c7dC5zdHlsZS56SW5kZXg9IiIrYS56SW5kZXgsbi5zZXRBdHRyaWJ1dGUoImRhdGEtc2l6ZSIsYS5zaXplKSxuLnNldEF0dHJpYnV0ZSgiZGF0YS1hbmltYXRpb24iLGEuYW5pbWF0aW9uKSxuLnN0eWxlLm1heFdpZHRoPWEubWF4V2lkdGgrKCJudW1iZXIiPT10eXBlb2YgYS5tYXhXaWR0aD8icHgiOiIiKSxhLnJvbGU/dC5zZXRBdHRyaWJ1dGUoInJvbGUiLGEucm9sZSk6dC5yZW1vdmVBdHRyaWJ1dGUoInJvbGUiKSxlLmNvbnRlbnQhPT1hLmNvbnRlbnQmJiQoaSxhKSwhZS5hbmltYXRlRmlsbCYmYS5hbmltYXRlRmlsbD8obi5hcHBlbmRDaGlsZChydCgpKSxuLnNldEF0dHJpYnV0ZSgiZGF0YS1hbmltYXRlZmlsbCIsIiIpKTplLmFuaW1hdGVGaWxsJiYhYS5hbmltYXRlRmlsbCYmKG4ucmVtb3ZlQ2hpbGQobyksbi5yZW1vdmVBdHRyaWJ1dGUoImRhdGEtYW5pbWF0ZWZpbGwiKSksIWUuYXJyb3cmJmEuYXJyb3c/bi5hcHBlbmRDaGlsZChhdChhLmFycm93VHlwZSkpOmUuYXJyb3cmJiFhLmFycm93JiZuLnJlbW92ZUNoaWxkKHApLGUuYXJyb3cmJmEuYXJyb3cmJmUuYXJyb3dUeXBlIT09YS5hcnJvd1R5cGUmJm4ucmVwbGFjZUNoaWxkKGF0KGEuYXJyb3dUeXBlKSxwKSwhZS5pbnRlcmFjdGl2ZSYmYS5pbnRlcmFjdGl2ZT9udCh0LG4pOmUuaW50ZXJhY3RpdmUmJiFhLmludGVyYWN0aXZlJiZmdW5jdGlvbih0LGUpe3QucmVtb3ZlQXR0cmlidXRlKCJ0YWJpbmRleCIpLGUucmVtb3ZlQXR0cmlidXRlKCJkYXRhLWludGVyYWN0aXZlIil9KHQsbiksIWUuaW5lcnRpYSYmYS5pbmVydGlhP2V0KG4pOmUuaW5lcnRpYSYmIWEuaW5lcnRpYSYmZnVuY3Rpb24odCl7dC5yZW1vdmVBdHRyaWJ1dGUoImRhdGEtaW5lcnRpYSIpfShuKSxlLnRoZW1lIT09YS50aGVtZSYmKHB0KG4sInJlbW92ZSIsZS50aGVtZSkscHQobiwiYWRkIixhLnRoZW1lKSl9dmFyIGx0PTEsZHQ9W107ZnVuY3Rpb24gZnQoYSxyKXt2YXIgaSxvLGMsaCxnLHc9SyhhLHIpO2lmKCF3Lm11bHRpcGxlJiZhLl90aXBweSlyZXR1cm4gbnVsbDt2YXIgayxBLEUsWCxDLEw9ITEsVD0hMSxJPSExLFM9ITEsej1bXSxNPUQodnQsdy5pbnRlcmFjdGl2ZURlYm91bmNlKSxIPWx0KyssVj1zdChILHcpLF89dHQoViksaj17aWQ6SCxyZWZlcmVuY2U6YSxwb3BwZXI6Vixwb3BwZXJDaGlsZHJlbjpfLHBvcHBlckluc3RhbmNlOm51bGwscHJvcHM6dyxzdGF0ZTp7aXNFbmFibGVkOiEwLGlzVmlzaWJsZTohMSxpc0Rlc3Ryb3llZDohMSxpc01vdW50ZWQ6ITEsaXNTaG93bjohMX0sY2xlYXJEZWxheVRpbWVvdXRzOkx0LHNldDpUdCxzZXRDb250ZW50OmZ1bmN0aW9uKHQpe1R0KHtjb250ZW50OnR9KX0sc2hvdzpJdCxoaWRlOlN0LGVuYWJsZTpmdW5jdGlvbigpe2ouc3RhdGUuaXNFbmFibGVkPSEwfSxkaXNhYmxlOmZ1bmN0aW9uKCl7ai5zdGF0ZS5pc0VuYWJsZWQ9ITF9LGRlc3Ryb3k6ZnVuY3Rpb24odCl7aWYoai5zdGF0ZS5pc0Rlc3Ryb3llZClyZXR1cm47VD0hMCxqLnN0YXRlLmlzTW91bnRlZCYmU3QoMCk7dXQoKSxkZWxldGUgYS5fdGlwcHk7dmFyIGU9ai5wcm9wcy50YXJnZXQ7ZSYmdCYmRihhKSYmZChhLnF1ZXJ5U2VsZWN0b3JBbGwoZSkpLmZvckVhY2goZnVuY3Rpb24odCl7dC5fdGlwcHkmJnQuX3RpcHB5LmRlc3Ryb3koKX0pO2oucG9wcGVySW5zdGFuY2UmJmoucG9wcGVySW5zdGFuY2UuZGVzdHJveSgpO1Q9ITEsai5zdGF0ZS5pc0Rlc3Ryb3llZD0hMH19O3JldHVybiBhLl90aXBweT1qLFYuX3RpcHB5PWosbXQoKSx3Lmxhenl8fEV0KCksdy5zaG93T25Jbml0JiZYdCgpLCF3LmExMXl8fHcudGFyZ2V0fHwoIUYoQz0kKCkpfHxsLmNhbGwoQywiYVtocmVmXSxhcmVhW2hyZWZdLGJ1dHRvbixkZXRhaWxzLGlucHV0LHRleHRhcmVhLHNlbGVjdCxpZnJhbWUsW3RhYmluZGV4XSIpJiYhQy5oYXNBdHRyaWJ1dGUoImRpc2FibGVkIikpfHwkKCkuc2V0QXR0cmlidXRlKCJ0YWJpbmRleCIsIjAiKSxWLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZW50ZXIiLGZ1bmN0aW9uKHQpe2oucHJvcHMuaW50ZXJhY3RpdmUmJmouc3RhdGUuaXNWaXNpYmxlJiYibW91c2VlbnRlciI9PT1pJiZYdCh0LCEwKX0pLFYuYWRkRXZlbnRMaXN0ZW5lcigibW91c2VsZWF2ZSIsZnVuY3Rpb24oKXtqLnByb3BzLmludGVyYWN0aXZlJiYibW91c2VlbnRlciI9PT1pJiZkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLE0pfSksajtmdW5jdGlvbiBSKCl7ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIixidCl9ZnVuY3Rpb24gWigpe2RvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcigibW91c2VsZWF2ZSIsWXQpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsTSksZHQ9ZHQuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiB0IT09TX0pfWZ1bmN0aW9uICQoKXtyZXR1cm4gai5wcm9wcy50cmlnZ2VyVGFyZ2V0fHxhfWZ1bmN0aW9uIGV0KCl7ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLEN0LCEwKX1mdW5jdGlvbiBhdCgpe3JldHVybltqLnBvcHBlckNoaWxkcmVuLnRvb2x0aXAsai5wb3BwZXJDaGlsZHJlbi5iYWNrZHJvcCxqLnBvcHBlckNoaWxkcmVuLmNvbnRlbnRdfWZ1bmN0aW9uIHJ0KCl7dmFyIHQ9ai5wcm9wcy5mb2xsb3dDdXJzb3I7cmV0dXJuIHQmJiJmb2N1cyIhPT1pfHxPJiYiaW5pdGlhbCI9PT10fWZ1bmN0aW9uIG50KHQsZSl7dmFyIGE9ai5wb3BwZXJDaGlsZHJlbi50b29sdGlwO2Z1bmN0aW9uIHIodCl7dC50YXJnZXQ9PT1hJiYoaXQoYSwicmVtb3ZlIixyKSxlKCkpfWlmKDA9PT10KXJldHVybiBlKCk7aXQoYSwicmVtb3ZlIixFKSxpdChhLCJhZGQiLHIpLEU9cn1mdW5jdGlvbiBwdCh0LGUpe3ZhciBhPWFyZ3VtZW50cy5sZW5ndGg+MiYmdm9pZCAwIT09YXJndW1lbnRzWzJdJiZhcmd1bWVudHNbMl07JCgpLmFkZEV2ZW50TGlzdGVuZXIodCxlLGEpLHoucHVzaCh7ZXZlbnRUeXBlOnQsaGFuZGxlcjplLG9wdGlvbnM6YX0pfWZ1bmN0aW9uIG10KCl7ai5wcm9wcy50b3VjaEhvbGQmJiFqLnByb3BzLnRhcmdldCYmKHB0KCJ0b3VjaHN0YXJ0Iix5dCx1KSxwdCgidG91Y2hlbmQiLGh0LHUpKSxqLnByb3BzLnRyaWdnZXIudHJpbSgpLnNwbGl0KCIgIikuZm9yRWFjaChmdW5jdGlvbih0KXtpZigibWFudWFsIiE9PXQpaWYoai5wcm9wcy50YXJnZXQpc3dpdGNoKHQpe2Nhc2UibW91c2VlbnRlciI6cHQoIm1vdXNlb3ZlciIsZ3QpLHB0KCJtb3VzZW91dCIsd3QpO2JyZWFrO2Nhc2UiZm9jdXMiOnB0KCJmb2N1c2luIixndCkscHQoImZvY3Vzb3V0Iix3dCk7YnJlYWs7Y2FzZSJjbGljayI6cHQodCxndCl9ZWxzZSBzd2l0Y2gocHQodCx5dCksdCl7Y2FzZSJtb3VzZWVudGVyIjpwdCgibW91c2VsZWF2ZSIsaHQpO2JyZWFrO2Nhc2UiZm9jdXMiOnB0KG4/ImZvY3Vzb3V0IjoiYmx1ciIseHQpfX0pfWZ1bmN0aW9uIHV0KCl7ei5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBlPXQuZXZlbnRUeXBlLGE9dC5oYW5kbGVyLHI9dC5vcHRpb25zOyQoKS5yZW1vdmVFdmVudExpc3RlbmVyKGUsYSxyKX0pLHo9W119ZnVuY3Rpb24gYnQodCl7dmFyIHI9bz10LG49ci5jbGllbnRYLGk9ci5jbGllbnRZO2lmKFgpe3ZhciBwPW0odC50YXJnZXQsZnVuY3Rpb24odCl7cmV0dXJuIHQ9PT1hfSkscz1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGM9ai5wcm9wcy5mb2xsb3dDdXJzb3IsbD0iaG9yaXpvbnRhbCI9PT1jLGQ9InZlcnRpY2FsIj09PWMsZj1CKFsidG9wIiwiYm90dG9tIl0sb3QoVikpLHU9Vi5nZXRBdHRyaWJ1dGUoeSksYj0hIXUmJiEhdS5zcGxpdCgiLSIpWzFdLHY9Zj9WLm9mZnNldFdpZHRoOlYub2Zmc2V0SGVpZ2h0LGg9di8yLHg9Zj8wOmI/djpoLGc9Zj9iP3Y6aDowOyFwJiZqLnByb3BzLmludGVyYWN0aXZlfHwoai5wb3BwZXJJbnN0YW5jZS5yZWZlcmVuY2U9ZSh7fSxqLnBvcHBlckluc3RhbmNlLnJlZmVyZW5jZSx7Y2xpZW50V2lkdGg6MCxjbGllbnRIZWlnaHQ6MCxnZXRCb3VuZGluZ0NsaWVudFJlY3Q6ZnVuY3Rpb24oKXtyZXR1cm57d2lkdGg6Zj92OjAsaGVpZ2h0OmY/MDp2LHRvcDoobD9zLnRvcDppKS14LGJvdHRvbToobD9zLmJvdHRvbTppKSt4LGxlZnQ6KGQ/cy5sZWZ0Om4pLWcscmlnaHQ6KGQ/cy5yaWdodDpuKStnfX19KSxqLnBvcHBlckluc3RhbmNlLnVwZGF0ZSgpKSwiaW5pdGlhbCI9PT1jJiZqLnN0YXRlLmlzVmlzaWJsZSYmUigpfX1mdW5jdGlvbiB5dCh0KXtqLnN0YXRlLmlzRW5hYmxlZCYmIWt0KHQpJiYoai5zdGF0ZS5pc1Zpc2libGV8fChpPXQudHlwZSx0IGluc3RhbmNlb2YgTW91c2VFdmVudCYmKG89dCxkdC5mb3JFYWNoKGZ1bmN0aW9uKGUpe3JldHVybiBlKHQpfSkpKSwiY2xpY2siPT09dC50eXBlJiYhMSE9PWoucHJvcHMuaGlkZU9uQ2xpY2smJmouc3RhdGUuaXNWaXNpYmxlP1l0KCk6WHQodCkpfWZ1bmN0aW9uIHZ0KHQpe3ZhciBlPWYodC50YXJnZXQsWSk9PT1WLHI9bSh0LnRhcmdldCxmdW5jdGlvbih0KXtyZXR1cm4gdD09PWF9KTtlfHxyfHxmdW5jdGlvbih0LGUsYSxyKXtpZighdClyZXR1cm4hMDt2YXIgbj1hLmNsaWVudFgsaT1hLmNsaWVudFksbz1yLmludGVyYWN0aXZlQm9yZGVyLHA9ci5kaXN0YW5jZSxzPWUudG9wLWk+KCJ0b3AiPT09dD9vK3A6byksYz1pLWUuYm90dG9tPigiYm90dG9tIj09PXQ/bytwOm8pLGw9ZS5sZWZ0LW4+KCJsZWZ0Ij09PXQ/bytwOm8pLGQ9bi1lLnJpZ2h0PigicmlnaHQiPT09dD9vK3A6byk7cmV0dXJuIHN8fGN8fGx8fGR9KG90KFYpLFYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksdCxqLnByb3BzKSYmKFooKSxZdCgpKX1mdW5jdGlvbiBodCh0KXtpZigha3QodCkpcmV0dXJuIGoucHJvcHMuaW50ZXJhY3RpdmU/KGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigibW91c2VsZWF2ZSIsWXQpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsTSksdm9pZCBkdC5wdXNoKE0pKTp2b2lkIFl0KCl9ZnVuY3Rpb24geHQodCl7dC50YXJnZXQ9PT0kKCkmJihqLnByb3BzLmludGVyYWN0aXZlJiZ0LnJlbGF0ZWRUYXJnZXQmJlYuY29udGFpbnModC5yZWxhdGVkVGFyZ2V0KXx8WXQoKSl9ZnVuY3Rpb24gZ3QodCl7Zih0LnRhcmdldCxqLnByb3BzLnRhcmdldCkmJlh0KHQpfWZ1bmN0aW9uIHd0KHQpe2YodC50YXJnZXQsai5wcm9wcy50YXJnZXQpJiZZdCgpfWZ1bmN0aW9uIGt0KHQpe3ZhciBlPSJvbnRvdWNoc3RhcnQiaW4gd2luZG93LGE9Qih0LnR5cGUsInRvdWNoIikscj1qLnByb3BzLnRvdWNoSG9sZDtyZXR1cm4gZSYmTyYmciYmIWF8fE8mJiFyJiZhfWZ1bmN0aW9uIEF0KCl7IVMmJkEmJihTPSEwLGZ1bmN0aW9uKHQpe3Qub2Zmc2V0SGVpZ2h0fShWKSxBKCkpfWZ1bmN0aW9uIEV0KCl7dmFyIHI9ai5wcm9wcy5wb3BwZXJPcHRpb25zLG49ai5wb3BwZXJDaGlsZHJlbixpPW4udG9vbHRpcCxvPW4uYXJyb3cscD1xKHIsInByZXZlbnRPdmVyZmxvdyIpO2Z1bmN0aW9uIHModCl7ai5wcm9wcy5mbGlwJiYhai5wcm9wcy5mbGlwT25VcGRhdGUmJih0LmZsaXBwZWQmJihqLnBvcHBlckluc3RhbmNlLm9wdGlvbnMucGxhY2VtZW50PXQucGxhY2VtZW50KSxXKGoucG9wcGVySW5zdGFuY2UubW9kaWZpZXJzLCExKSksaS5zZXRBdHRyaWJ1dGUoeSx0LnBsYWNlbWVudCksITEhPT10LmF0dHJpYnV0ZXNbdl0/aS5zZXRBdHRyaWJ1dGUodiwiIik6aS5yZW1vdmVBdHRyaWJ1dGUodiksayYmayE9PXQucGxhY2VtZW50JiZJJiYoaS5zdHlsZS50cmFuc2l0aW9uPSJub25lIixyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXtpLnN0eWxlLnRyYW5zaXRpb249IiJ9KSksaz10LnBsYWNlbWVudCxJPWouc3RhdGUuaXNWaXNpYmxlO3ZhciBhPW90KFYpLHI9aS5zdHlsZTtyLnRvcD1yLmJvdHRvbT1yLmxlZnQ9ci5yaWdodD0iIixyW2FdPS0oai5wcm9wcy5kaXN0YW5jZS0xMCkrInB4Ijt2YXIgbj1wJiZ2b2lkIDAhPT1wLnBhZGRpbmc/cC5wYWRkaW5nOmIsbz0ibnVtYmVyIj09dHlwZW9mIG4scz1lKHt0b3A6bz9uOm4udG9wLGJvdHRvbTpvP246bi5ib3R0b20sbGVmdDpvP246bi5sZWZ0LHJpZ2h0Om8/bjpuLnJpZ2h0fSwhbyYmbik7c1thXT1vP24rai5wcm9wcy5kaXN0YW5jZTooblthXXx8MCkrai5wcm9wcy5kaXN0YW5jZSxqLnBvcHBlckluc3RhbmNlLm1vZGlmaWVycy5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuInByZXZlbnRPdmVyZmxvdyI9PT10Lm5hbWV9KVswXS5wYWRkaW5nPXMsWD1zfXZhciBjPWUoe2V2ZW50c0VuYWJsZWQ6ITEscGxhY2VtZW50OmoucHJvcHMucGxhY2VtZW50fSxyLHttb2RpZmllcnM6ZSh7fSxyP3IubW9kaWZpZXJzOnt9LHtwcmV2ZW50T3ZlcmZsb3c6ZSh7Ym91bmRhcmllc0VsZW1lbnQ6ai5wcm9wcy5ib3VuZGFyeSxwYWRkaW5nOmJ9LHApLGFycm93OmUoe2VsZW1lbnQ6byxlbmFibGVkOiEhb30scShyLCJhcnJvdyIpKSxmbGlwOmUoe2VuYWJsZWQ6ai5wcm9wcy5mbGlwLHBhZGRpbmc6ai5wcm9wcy5kaXN0YW5jZStiLGJlaGF2aW9yOmoucHJvcHMuZmxpcEJlaGF2aW9yfSxxKHIsImZsaXAiKSksb2Zmc2V0OmUoe29mZnNldDpqLnByb3BzLm9mZnNldH0scShyLCJvZmZzZXQiKSl9KSxvbkNyZWF0ZTpmdW5jdGlvbih0KXtzKHQpLEF0KCksciYmci5vbkNyZWF0ZSYmci5vbkNyZWF0ZSh0KX0sb25VcGRhdGU6ZnVuY3Rpb24odCl7cyh0KSxBdCgpLHImJnIub25VcGRhdGUmJnIub25VcGRhdGUodCl9fSk7ai5wb3BwZXJJbnN0YW5jZT1uZXcgdChhLFYsYyl9ZnVuY3Rpb24gWHQodCxhKXtpZihMdCgpLCFqLnN0YXRlLmlzVmlzaWJsZSl7aWYoai5wcm9wcy50YXJnZXQpcmV0dXJuIGZ1bmN0aW9uKHQpe2lmKHQpe3ZhciBhPWYodC50YXJnZXQsai5wcm9wcy50YXJnZXQpO2EmJiFhLl90aXBweSYmZnQoYSxlKHt9LGoucHJvcHMse2NvbnRlbnQ6VShyLmNvbnRlbnQsW2FdKSxhcHBlbmRUbzpyLmFwcGVuZFRvLHRhcmdldDoiIixzaG93T25Jbml0OiEwfSkpfX0odCk7aWYoTD0hMCx0JiYhYSYmai5wcm9wcy5vblRyaWdnZXIoaix0KSxqLnByb3BzLndhaXQpcmV0dXJuIGoucHJvcHMud2FpdChqLHQpO3J0KCkmJiFqLnN0YXRlLmlzTW91bnRlZCYmKGoucG9wcGVySW5zdGFuY2V8fEV0KCksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIixidCkpLGV0KCk7dmFyIG49UChqLnByb3BzLmRlbGF5LDAscC5kZWxheSk7bj9jPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtJdCgpfSxuKTpJdCgpfX1mdW5jdGlvbiBZdCgpe2lmKEx0KCksIWouc3RhdGUuaXNWaXNpYmxlKXJldHVybiBSKCk7TD0hMTt2YXIgdD1QKGoucHJvcHMuZGVsYXksMSxwLmRlbGF5KTt0P2g9c2V0VGltZW91dChmdW5jdGlvbigpe2ouc3RhdGUuaXNWaXNpYmxlJiZTdCgpfSx0KTpnPXJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe1N0KCl9KX1mdW5jdGlvbiBDdCh0KXtpZighai5wcm9wcy5pbnRlcmFjdGl2ZXx8IVYuY29udGFpbnModC50YXJnZXQpKXtpZigkKCkuY29udGFpbnModC50YXJnZXQpKXtpZihPKXJldHVybjtpZihqLnN0YXRlLmlzVmlzaWJsZSYmQihqLnByb3BzLnRyaWdnZXIsImNsaWNrIikpcmV0dXJufSEwPT09ai5wcm9wcy5oaWRlT25DbGljayYmKEx0KCksU3QoKSl9fWZ1bmN0aW9uIEx0KCl7Y2xlYXJUaW1lb3V0KGMpLGNsZWFyVGltZW91dChoKSxjYW5jZWxBbmltYXRpb25GcmFtZShnKX1mdW5jdGlvbiBUdCh0KXtRKHQ9dHx8e30scCksdXQoKTt2YXIgcj1qLnByb3BzLG49SyhhLGUoe30sai5wcm9wcyx0LHtpZ25vcmVBdHRyaWJ1dGVzOiEwfSkpO24uaWdub3JlQXR0cmlidXRlcz1OKHQsImlnbm9yZUF0dHJpYnV0ZXMiKT90Lmlnbm9yZUF0dHJpYnV0ZXN8fCExOnIuaWdub3JlQXR0cmlidXRlcyxqLnByb3BzPW4sbXQoKSxaKCksTT1EKHZ0LG4uaW50ZXJhY3RpdmVEZWJvdW5jZSksY3QoVixyLG4pLGoucG9wcGVyQ2hpbGRyZW49dHQoViksai5wb3BwZXJJbnN0YW5jZSYmKHMuc29tZShmdW5jdGlvbihlKXtyZXR1cm4gTih0LGUpJiZ0W2VdIT09cltlXX0pPyhqLnBvcHBlckluc3RhbmNlLmRlc3Ryb3koKSxFdCgpLGouc3RhdGUuaXNWaXNpYmxlJiZqLnBvcHBlckluc3RhbmNlLmVuYWJsZUV2ZW50TGlzdGVuZXJzKCksai5wcm9wcy5mb2xsb3dDdXJzb3ImJm8mJmJ0KG8pKTpqLnBvcHBlckluc3RhbmNlLnVwZGF0ZSgpKX1mdW5jdGlvbiBJdCgpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTpQKGoucHJvcHMuZHVyYXRpb24sMCxwLmR1cmF0aW9uWzFdKTtpZighai5zdGF0ZS5pc0Rlc3Ryb3llZCYmai5zdGF0ZS5pc0VuYWJsZWQmJighT3x8ai5wcm9wcy50b3VjaCkmJiEkKCkuaGFzQXR0cmlidXRlKCJkaXNhYmxlZCIpJiYhMSE9PWoucHJvcHMub25TaG93KGopKXtldCgpLFYuc3R5bGUudmlzaWJpbGl0eT0idmlzaWJsZSIsai5zdGF0ZS5pc1Zpc2libGU9ITAsai5wcm9wcy5pbnRlcmFjdGl2ZSYmJCgpLmNsYXNzTGlzdC5hZGQoeCk7dmFyIGU9YXQoKTtKKGUuY29uY2F0KFYpLDApLEE9ZnVuY3Rpb24oKXtpZihqLnN0YXRlLmlzVmlzaWJsZSl7dmFyIGE9cnQoKTthJiZvP2J0KG8pOmF8fGoucG9wcGVySW5zdGFuY2UudXBkYXRlKCksai5wb3BwZXJDaGlsZHJlbi5iYWNrZHJvcCYmKGoucG9wcGVyQ2hpbGRyZW4uY29udGVudC5zdHlsZS50cmFuc2l0aW9uRGVsYXk9TWF0aC5yb3VuZCh0LzEyKSsibXMiKSxqLnByb3BzLnN0aWNreSYmKEooW1ZdLG4/MDpqLnByb3BzLnVwZGF0ZUR1cmF0aW9uKSxmdW5jdGlvbiB0KCl7ai5wb3BwZXJJbnN0YW5jZS5zY2hlZHVsZVVwZGF0ZSgpLGouc3RhdGUuaXNNb3VudGVkP3JlcXVlc3RBbmltYXRpb25GcmFtZSh0KTpKKFtWXSwwKX0oKSksSihbVl0sai5wcm9wcy51cGRhdGVEdXJhdGlvbiksSihlLHQpLEcoZSwidmlzaWJsZSIpLGZ1bmN0aW9uKHQsZSl7bnQodCxlKX0odCxmdW5jdGlvbigpe2oucHJvcHMuYXJpYSYmJCgpLnNldEF0dHJpYnV0ZSgiYXJpYS0iLmNvbmNhdChqLnByb3BzLmFyaWEpLFYuaWQpLGoucHJvcHMub25TaG93bihqKSxqLnN0YXRlLmlzU2hvd249ITB9KX19LGZ1bmN0aW9uKCl7Uz0hMTt2YXIgdD1ydCgpO2oucG9wcGVySW5zdGFuY2U/KFcoai5wb3BwZXJJbnN0YW5jZS5tb2RpZmllcnMsai5wcm9wcy5mbGlwKSx0fHwoai5wb3BwZXJJbnN0YW5jZS5yZWZlcmVuY2U9YSxqLnBvcHBlckluc3RhbmNlLmVuYWJsZUV2ZW50TGlzdGVuZXJzKCkpLGoucG9wcGVySW5zdGFuY2Uuc2NoZWR1bGVVcGRhdGUoKSk6KEV0KCksdHx8ai5wb3BwZXJJbnN0YW5jZS5lbmFibGVFdmVudExpc3RlbmVycygpKTt2YXIgZT1qLnByb3BzLmFwcGVuZFRvLHI9InBhcmVudCI9PT1lP2EucGFyZW50Tm9kZTpVKGUsW2FdKTtyLmNvbnRhaW5zKFYpfHwoci5hcHBlbmRDaGlsZChWKSxqLnByb3BzLm9uTW91bnQoaiksai5zdGF0ZS5pc01vdW50ZWQ9ITApfSgpfX1mdW5jdGlvbiBTdCgpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTpQKGoucHJvcHMuZHVyYXRpb24sMSxwLmR1cmF0aW9uWzFdKTtpZighai5zdGF0ZS5pc0Rlc3Ryb3llZCYmKGouc3RhdGUuaXNFbmFibGVkfHxUKSYmKCExIT09ai5wcm9wcy5vbkhpZGUoail8fFQpKXtkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJjbGljayIsQ3QsITApLFYuc3R5bGUudmlzaWJpbGl0eT0iaGlkZGVuIixqLnN0YXRlLmlzVmlzaWJsZT0hMSxqLnN0YXRlLmlzU2hvd249ITEsST0hMSxqLnByb3BzLmludGVyYWN0aXZlJiYkKCkuY2xhc3NMaXN0LnJlbW92ZSh4KTt2YXIgZT1hdCgpO0ooZSx0KSxHKGUsImhpZGRlbiIpLGZ1bmN0aW9uKHQsZSl7bnQodCxmdW5jdGlvbigpeyFqLnN0YXRlLmlzVmlzaWJsZSYmVi5wYXJlbnROb2RlJiZWLnBhcmVudE5vZGUuY29udGFpbnMoVikmJmUoKX0pfSh0LGZ1bmN0aW9uKCl7THx8UigpLGoucHJvcHMuYXJpYSYmJCgpLnJlbW92ZUF0dHJpYnV0ZSgiYXJpYS0iLmNvbmNhdChqLnByb3BzLmFyaWEpKSxqLnBvcHBlckluc3RhbmNlLmRpc2FibGVFdmVudExpc3RlbmVycygpLGoucG9wcGVySW5zdGFuY2Uub3B0aW9ucy5wbGFjZW1lbnQ9ai5wcm9wcy5wbGFjZW1lbnQsVi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKFYpLGoucHJvcHMub25IaWRkZW4oaiksai5zdGF0ZS5pc01vdW50ZWQ9ITF9KX19fXZhciBtdD0hMTtmdW5jdGlvbiB1dCh0LGEpe1EoYXx8e30scCksbXR8fChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaHN0YXJ0Iix6LHUpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJibHVyIixWKSxtdD0hMCk7dmFyIHIsbj1lKHt9LHAsYSk7cj10LCJbb2JqZWN0IE9iamVjdF0iIT09e30udG9TdHJpbmcuY2FsbChyKXx8ci5hZGRFdmVudExpc3RlbmVyfHxmdW5jdGlvbih0KXt2YXIgZT17aXNWaXJ0dWFsOiEwLGF0dHJpYnV0ZXM6dC5hdHRyaWJ1dGVzfHx7fSxjb250YWluczpmdW5jdGlvbigpe30sc2V0QXR0cmlidXRlOmZ1bmN0aW9uKGUsYSl7dC5hdHRyaWJ1dGVzW2VdPWF9LGdldEF0dHJpYnV0ZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5hdHRyaWJ1dGVzW2VdfSxyZW1vdmVBdHRyaWJ1dGU6ZnVuY3Rpb24oZSl7ZGVsZXRlIHQuYXR0cmlidXRlc1tlXX0saGFzQXR0cmlidXRlOmZ1bmN0aW9uKGUpe3JldHVybiBlIGluIHQuYXR0cmlidXRlc30sYWRkRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbigpe30scmVtb3ZlRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbigpe30sY2xhc3NMaXN0OntjbGFzc05hbWVzOnt9LGFkZDpmdW5jdGlvbihlKXt0LmNsYXNzTGlzdC5jbGFzc05hbWVzW2VdPSEwfSxyZW1vdmU6ZnVuY3Rpb24oZSl7ZGVsZXRlIHQuY2xhc3NMaXN0LmNsYXNzTmFtZXNbZV19LGNvbnRhaW5zOmZ1bmN0aW9uKGUpe3JldHVybiBlIGluIHQuY2xhc3NMaXN0LmNsYXNzTmFtZXN9fX07Zm9yKHZhciBhIGluIGUpdFthXT1lW2FdfSh0KTt2YXIgaT1mdW5jdGlvbih0KXtpZihqKHQpKXJldHVyblt0XTtpZih0IGluc3RhbmNlb2YgTm9kZUxpc3QpcmV0dXJuIGQodCk7aWYoQXJyYXkuaXNBcnJheSh0KSlyZXR1cm4gdDt0cnl7cmV0dXJuIGQoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0KSl9Y2F0Y2godCl7cmV0dXJuW119fSh0KS5yZWR1Y2UoZnVuY3Rpb24odCxlKXt2YXIgYT1lJiZmdChlLG4pO3JldHVybiBhJiZ0LnB1c2goYSksdH0sW10pO3JldHVybiBqKHQpP2lbMF06aX1yZXR1cm4gdXQudmVyc2lvbj0iNC4zLjQiLHV0LmRlZmF1bHRzPXAsdXQuc2V0RGVmYXVsdHM9ZnVuY3Rpb24odCl7T2JqZWN0LmtleXModCkuZm9yRWFjaChmdW5jdGlvbihlKXtwW2VdPXRbZV19KX0sdXQuaGlkZUFsbD1mdW5jdGlvbigpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTp7fSxlPXQuZXhjbHVkZSxhPXQuZHVyYXRpb247ZChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFkpKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciByLG49dC5fdGlwcHk7aWYobil7dmFyIGk9ITE7ZSYmKGk9KHI9ZSkuX3RpcHB5JiYhbC5jYWxsKHIsWSk/bi5yZWZlcmVuY2U9PT1lOnQ9PT1lLnBvcHBlciksaXx8bi5oaWRlKGEpfX0pfSx1dC5ncm91cD1mdW5jdGlvbih0KXt2YXIgYT1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06e30scj1hLmRlbGF5LG49dm9pZCAwPT09cj90WzBdLnByb3BzLmRlbGF5OnIsaT1hLmR1cmF0aW9uLG89dm9pZCAwPT09aT8wOmkscD0hMTtmdW5jdGlvbiBzKHQpe3A9dCxmKCl9ZnVuY3Rpb24gYyhlKXtlLl9vcmlnaW5hbFByb3BzLm9uU2hvdyhlKSx0LmZvckVhY2goZnVuY3Rpb24odCl7dC5zZXQoe2R1cmF0aW9uOm99KSx0LnN0YXRlLmlzVmlzaWJsZSYmdC5oaWRlKCl9KSxzKCEwKX1mdW5jdGlvbiBsKHQpe3QuX29yaWdpbmFsUHJvcHMub25IaWRlKHQpLHMoITEpfWZ1bmN0aW9uIGQodCl7dC5fb3JpZ2luYWxQcm9wcy5vblNob3duKHQpLHQuc2V0KHtkdXJhdGlvbjp0Ll9vcmlnaW5hbFByb3BzLmR1cmF0aW9ufSl9ZnVuY3Rpb24gZigpe3QuZm9yRWFjaChmdW5jdGlvbih0KXt0LnNldCh7b25TaG93OmMsb25TaG93bjpkLG9uSGlkZTpsLGRlbGF5OnA/WzAsQXJyYXkuaXNBcnJheShuKT9uWzFdOm5dOm4sZHVyYXRpb246cD9vOnQuX29yaWdpbmFsUHJvcHMuZHVyYXRpb259KX0pfXQuZm9yRWFjaChmdW5jdGlvbih0KXt0Ll9vcmlnaW5hbFByb3BzP3Quc2V0KHQuX29yaWdpbmFsUHJvcHMpOnQuX29yaWdpbmFsUHJvcHM9ZSh7fSx0LnByb3BzKX0pLGYoKX0sYSYmc2V0VGltZW91dChmdW5jdGlvbigpe2QoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiW2RhdGEtdGlwcHldIikpLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGU9dC5nZXRBdHRyaWJ1dGUoImRhdGEtdGlwcHkiKTtlJiZ1dCh0LHtjb250ZW50OmV9KX0pfSksZnVuY3Rpb24odCl7aWYoYSl7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3R5bGUiKTtlLnR5cGU9InRleHQvY3NzIixlLnRleHRDb250ZW50PXQsZS5zZXRBdHRyaWJ1dGUoImRhdGEtdGlwcHktc3R5bGVzaGVldCIsIiIpO3ZhciByPWRvY3VtZW50LmhlYWQsbj1yLmZpcnN0Q2hpbGQ7bj9yLmluc2VydEJlZm9yZShlLG4pOnIuYXBwZW5kQ2hpbGQoZSl9fSgnLnRpcHB5LWlPU3tjdXJzb3I6cG9pbnRlciFpbXBvcnRhbnQ7LXdlYmtpdC10YXAtaGlnaGxpZ2h0LWNvbG9yOnRyYW5zcGFyZW50fS50aXBweS1wb3BwZXJ7dHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKC4xNjUsLjg0LC40NCwxKTttYXgtd2lkdGg6Y2FsYygxMDAlIC0gOHB4KTtwb2ludGVyLWV2ZW50czpub25lO291dGxpbmU6MH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1iYWNrZHJvcHtib3JkZXItcmFkaXVzOjQwJSA0MCUgMCAwfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gLnRpcHB5LXJvdW5kYXJyb3d7Ym90dG9tOi03cHg7Ym90dG9tOi02LjVweDstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46NTAlIDA7dHJhbnNmb3JtLW9yaWdpbjo1MCUgMDttYXJnaW46MCAzcHh9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49dG9wXSAudGlwcHktcm91bmRhcnJvdyBzdmd7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgxODBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMTgwZGVnKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1hcnJvd3tib3JkZXItdG9wOjhweCBzb2xpZCAjMzMzO2JvcmRlci1yaWdodDo4cHggc29saWQgdHJhbnNwYXJlbnQ7Ym9yZGVyLWxlZnQ6OHB4IHNvbGlkIHRyYW5zcGFyZW50O2JvdHRvbTotN3B4O21hcmdpbjowIDNweDstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46NTAlIDA7dHJhbnNmb3JtLW9yaWdpbjo1MCUgMH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1iYWNrZHJvcHstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46MCAyNSU7dHJhbnNmb3JtLW9yaWdpbjowIDI1JX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1iYWNrZHJvcFtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgtNTAlLC01NSUpO3RyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNTUlKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1iYWNrZHJvcFtkYXRhLXN0YXRlPWhpZGRlbl17LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoLjIpIHRyYW5zbGF0ZSgtNTAlLC00NSUpO3RyYW5zZm9ybTpzY2FsZSguMikgdHJhbnNsYXRlKC01MCUsLTQ1JSk7b3BhY2l0eTowfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LXRvd2FyZF1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKC0xMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49dG9wXSBbZGF0YS1hbmltYXRpb249c2hpZnQtdG93YXJkXVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTIwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0yMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1wZXJzcGVjdGl2ZV17LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOmJvdHRvbTt0cmFuc2Zvcm0tb3JpZ2luOmJvdHRvbX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1wZXJzcGVjdGl2ZV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTpwZXJzcGVjdGl2ZSg3MDBweCkgdHJhbnNsYXRlWSgtMTBweCkgcm90YXRlWCgwKTt0cmFuc2Zvcm06cGVyc3BlY3RpdmUoNzAwcHgpIHRyYW5zbGF0ZVkoLTEwcHgpIHJvdGF0ZVgoMCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49dG9wXSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06cGVyc3BlY3RpdmUoNzAwcHgpIHRyYW5zbGF0ZVkoMCkgcm90YXRlWCg2MGRlZyk7dHJhbnNmb3JtOnBlcnNwZWN0aXZlKDcwMHB4KSB0cmFuc2xhdGVZKDApIHJvdGF0ZVgoNjBkZWcpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPWZhZGVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPWZhZGVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LWF3YXldW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LWF3YXldW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgwKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgwKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV17LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOmJvdHRvbTt0cmFuc2Zvcm0tb3JpZ2luOmJvdHRvbX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKC0xMHB4KSBzY2FsZSgxKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCkgc2NhbGUoMSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49dG9wXSBbZGF0YS1hbmltYXRpb249c2NhbGVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCkgc2NhbGUoLjUpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0xMHB4KSBzY2FsZSguNSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktYmFja2Ryb3B7Ym9yZGVyLXJhZGl1czowIDAgMzAlIDMwJX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1yb3VuZGFycm93e3RvcDotN3B4Oy13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjo1MCUgMTAwJTt0cmFuc2Zvcm0tb3JpZ2luOjUwJSAxMDAlO21hcmdpbjowIDNweH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1yb3VuZGFycm93IHN2Z3twb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDApO3RyYW5zZm9ybTpyb3RhdGUoMCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktYXJyb3d7Ym9yZGVyLWJvdHRvbTo4cHggc29saWQgIzMzMztib3JkZXItcmlnaHQ6OHB4IHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1sZWZ0OjhweCBzb2xpZCB0cmFuc3BhcmVudDt0b3A6LTdweDttYXJnaW46MCAzcHg7LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOjUwJSAxMDAlO3RyYW5zZm9ybS1vcmlnaW46NTAlIDEwMCV9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktYmFja2Ryb3B7LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOjAgLTUwJTt0cmFuc2Zvcm0tb3JpZ2luOjAgLTUwJX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1iYWNrZHJvcFtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgtNTAlLC00NSUpO3RyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNDUlKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1iYWNrZHJvcFtkYXRhLXN0YXRlPWhpZGRlbl17LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoLjIpIHRyYW5zbGF0ZSgtNTAlKTt0cmFuc2Zvcm06c2NhbGUoLjIpIHRyYW5zbGF0ZSgtNTAlKTtvcGFjaXR5OjB9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249c2hpZnQtdG93YXJkXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249c2hpZnQtdG93YXJkXVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMjBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMjBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdey13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjp0b3A7dHJhbnNmb3JtLW9yaWdpbjp0b3B9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06cGVyc3BlY3RpdmUoNzAwcHgpIHRyYW5zbGF0ZVkoMTBweCkgcm90YXRlWCgwKTt0cmFuc2Zvcm06cGVyc3BlY3RpdmUoNzAwcHgpIHRyYW5zbGF0ZVkoMTBweCkgcm90YXRlWCgwKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIFtkYXRhLWFuaW1hdGlvbj1wZXJzcGVjdGl2ZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTpwZXJzcGVjdGl2ZSg3MDBweCkgdHJhbnNsYXRlWSgwKSByb3RhdGVYKC02MGRlZyk7dHJhbnNmb3JtOnBlcnNwZWN0aXZlKDcwMHB4KSB0cmFuc2xhdGVZKDApIHJvdGF0ZVgoLTYwZGVnKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIFtkYXRhLWFuaW1hdGlvbj1mYWRlXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249ZmFkZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKDEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWJvdHRvbV0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LWF3YXldW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIFtkYXRhLWFuaW1hdGlvbj1zaGlmdC1hd2F5XVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249c2NhbGVdey13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjp0b3A7dHJhbnNmb3JtLW9yaWdpbjp0b3B9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249c2NhbGVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KSBzY2FsZSgxKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KSBzY2FsZSgxKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKDEwcHgpIHNjYWxlKC41KTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KSBzY2FsZSguNSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LWJhY2tkcm9we2JvcmRlci1yYWRpdXM6NTAlIDAgMCA1MCV9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LXJvdW5kYXJyb3d7cmlnaHQ6LTEycHg7LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOjMzLjMzMzMzMzMzJSA1MCU7dHJhbnNmb3JtLW9yaWdpbjozMy4zMzMzMzMzMyUgNTAlO21hcmdpbjozcHggMH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktcm91bmRhcnJvdyBzdmd7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSg5MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSg5MGRlZyl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LWFycm93e2JvcmRlci1sZWZ0OjhweCBzb2xpZCAjMzMzO2JvcmRlci10b3A6OHB4IHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1ib3R0b206OHB4IHNvbGlkIHRyYW5zcGFyZW50O3JpZ2h0Oi03cHg7bWFyZ2luOjNweCAwOy13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjowIDUwJTt0cmFuc2Zvcm0tb3JpZ2luOjAgNTAlfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIC50aXBweS1iYWNrZHJvcHstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46NTAlIDA7dHJhbnNmb3JtLW9yaWdpbjo1MCUgMH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktYmFja2Ryb3BbZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNTAlKTt0cmFuc2Zvcm06c2NhbGUoMSkgdHJhbnNsYXRlKC01MCUsLTUwJSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LWJhY2tkcm9wW2RhdGEtc3RhdGU9aGlkZGVuXXstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSguMikgdHJhbnNsYXRlKC03NSUsLTUwJSk7dHJhbnNmb3JtOnNjYWxlKC4yKSB0cmFuc2xhdGUoLTc1JSwtNTAlKTtvcGFjaXR5OjB9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LXRvd2FyZF1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LXRvd2FyZF1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKC0yMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtMjBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gW2RhdGEtYW5pbWF0aW9uPXBlcnNwZWN0aXZlXXstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46cmlnaHQ7dHJhbnNmb3JtLW9yaWdpbjpyaWdodH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06cGVyc3BlY3RpdmUoNzAwcHgpIHRyYW5zbGF0ZVgoLTEwcHgpIHJvdGF0ZVkoMCk7dHJhbnNmb3JtOnBlcnNwZWN0aXZlKDcwMHB4KSB0cmFuc2xhdGVYKC0xMHB4KSByb3RhdGVZKDApfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIFtkYXRhLWFuaW1hdGlvbj1wZXJzcGVjdGl2ZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTpwZXJzcGVjdGl2ZSg3MDBweCkgdHJhbnNsYXRlWCgwKSByb3RhdGVZKC02MGRlZyk7dHJhbnNmb3JtOnBlcnNwZWN0aXZlKDcwMHB4KSB0cmFuc2xhdGVYKDApIHJvdGF0ZVkoLTYwZGVnKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249ZmFkZV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gW2RhdGEtYW5pbWF0aW9uPWZhZGVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgtMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIFtkYXRhLWFuaW1hdGlvbj1zaGlmdC1hd2F5XVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249c2hpZnQtYXdheV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDApO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDApfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV17LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOnJpZ2h0O3RyYW5zZm9ybS1vcmlnaW46cmlnaHR9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gW2RhdGEtYW5pbWF0aW9uPXNjYWxlXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTEwcHgpIHNjYWxlKDEpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KSBzY2FsZSgxKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249c2NhbGVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgtMTBweCkgc2NhbGUoLjUpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KSBzY2FsZSguNSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1iYWNrZHJvcHtib3JkZXItcmFkaXVzOjAgNTAlIDUwJSAwfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSAudGlwcHktcm91bmRhcnJvd3tsZWZ0Oi0xMnB4Oy13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjo2Ni42NjY2NjY2NiUgNTAlO3RyYW5zZm9ybS1vcmlnaW46NjYuNjY2NjY2NjYlIDUwJTttYXJnaW46M3B4IDB9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1yb3VuZGFycm93IHN2Z3twb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKC05MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgtOTBkZWcpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSAudGlwcHktYXJyb3d7Ym9yZGVyLXJpZ2h0OjhweCBzb2xpZCAjMzMzO2JvcmRlci10b3A6OHB4IHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1ib3R0b206OHB4IHNvbGlkIHRyYW5zcGFyZW50O2xlZnQ6LTdweDttYXJnaW46M3B4IDA7LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOjEwMCUgNTAlO3RyYW5zZm9ybS1vcmlnaW46MTAwJSA1MCV9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1iYWNrZHJvcHstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46LTUwJSAwO3RyYW5zZm9ybS1vcmlnaW46LTUwJSAwfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSAudGlwcHktYmFja2Ryb3BbZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNTAlKTt0cmFuc2Zvcm06c2NhbGUoMSkgdHJhbnNsYXRlKC01MCUsLTUwJSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1iYWNrZHJvcFtkYXRhLXN0YXRlPWhpZGRlbl17LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoLjIpIHRyYW5zbGF0ZSgtMjUlLC01MCUpO3RyYW5zZm9ybTpzY2FsZSguMikgdHJhbnNsYXRlKC0yNSUsLTUwJSk7b3BhY2l0eTowfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249c2hpZnQtdG93YXJkXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIFtkYXRhLWFuaW1hdGlvbj1zaGlmdC10b3dhcmRdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgyMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgyMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gW2RhdGEtYW5pbWF0aW9uPXBlcnNwZWN0aXZlXXstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46bGVmdDt0cmFuc2Zvcm0tb3JpZ2luOmxlZnR9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIFtkYXRhLWFuaW1hdGlvbj1wZXJzcGVjdGl2ZV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTpwZXJzcGVjdGl2ZSg3MDBweCkgdHJhbnNsYXRlWCgxMHB4KSByb3RhdGVZKDApO3RyYW5zZm9ybTpwZXJzcGVjdGl2ZSg3MDBweCkgdHJhbnNsYXRlWCgxMHB4KSByb3RhdGVZKDApfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06cGVyc3BlY3RpdmUoNzAwcHgpIHRyYW5zbGF0ZVgoMCkgcm90YXRlWSg2MGRlZyk7dHJhbnNmb3JtOnBlcnNwZWN0aXZlKDcwMHB4KSB0cmFuc2xhdGVYKDApIHJvdGF0ZVkoNjBkZWcpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249ZmFkZV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249ZmFkZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249c2hpZnQtYXdheV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249c2hpZnQtYXdheV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDApO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDApfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249c2NhbGVdey13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjpsZWZ0O3RyYW5zZm9ybS1vcmlnaW46bGVmdH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gW2RhdGEtYW5pbWF0aW9uPXNjYWxlXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoMTBweCkgc2NhbGUoMSk7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoMTBweCkgc2NhbGUoMSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpIHNjYWxlKC41KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgxMHB4KSBzY2FsZSguNSl9LnRpcHB5LXRvb2x0aXB7cG9zaXRpb246cmVsYXRpdmU7Y29sb3I6I2ZmZjtib3JkZXItcmFkaXVzOi4yNXJlbTtmb250LXNpemU6Ljg3NXJlbTtwYWRkaW5nOi4zMTI1cmVtIC41NjI1cmVtO2xpbmUtaGVpZ2h0OjEuNDt0ZXh0LWFsaWduOmNlbnRlcjtiYWNrZ3JvdW5kLWNvbG9yOiMzMzN9LnRpcHB5LXRvb2x0aXBbZGF0YS1zaXplPXNtYWxsXXtwYWRkaW5nOi4xODc1cmVtIC4zNzVyZW07Zm9udC1zaXplOi43NXJlbX0udGlwcHktdG9vbHRpcFtkYXRhLXNpemU9bGFyZ2Vde3BhZGRpbmc6LjM3NXJlbSAuNzVyZW07Zm9udC1zaXplOjFyZW19LnRpcHB5LXRvb2x0aXBbZGF0YS1hbmltYXRlZmlsbF17b3ZlcmZsb3c6aGlkZGVuO2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnR9LnRpcHB5LXRvb2x0aXBbZGF0YS1pbnRlcmFjdGl2ZV0sLnRpcHB5LXRvb2x0aXBbZGF0YS1pbnRlcmFjdGl2ZV0gLnRpcHB5LXJvdW5kYXJyb3cgcGF0aHtwb2ludGVyLWV2ZW50czphdXRvfS50aXBweS10b29sdGlwW2RhdGEtaW5lcnRpYV1bZGF0YS1zdGF0ZT12aXNpYmxlXXt0cmFuc2l0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoLjU0LDEuNSwuMzgsMS4xMSl9LnRpcHB5LXRvb2x0aXBbZGF0YS1pbmVydGlhXVtkYXRhLXN0YXRlPWhpZGRlbl17dHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb246ZWFzZX0udGlwcHktYXJyb3csLnRpcHB5LXJvdW5kYXJyb3d7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MDtoZWlnaHQ6MH0udGlwcHktcm91bmRhcnJvd3t3aWR0aDoxOHB4O2hlaWdodDo3cHg7ZmlsbDojMzMzO3BvaW50ZXItZXZlbnRzOm5vbmV9LnRpcHB5LWJhY2tkcm9we3Bvc2l0aW9uOmFic29sdXRlO2JhY2tncm91bmQtY29sb3I6IzMzMztib3JkZXItcmFkaXVzOjUwJTt3aWR0aDpjYWxjKDExMCUgKyAycmVtKTtsZWZ0OjUwJTt0b3A6NTAlO3otaW5kZXg6LTE7dHJhbnNpdGlvbjphbGwgY3ViaWMtYmV6aWVyKC40NiwuMSwuNTIsLjk4KTstd2Via2l0LWJhY2tmYWNlLXZpc2liaWxpdHk6aGlkZGVuO2JhY2tmYWNlLXZpc2liaWxpdHk6aGlkZGVufS50aXBweS1iYWNrZHJvcDphZnRlcntjb250ZW50OiIiO2Zsb2F0OmxlZnQ7cGFkZGluZy10b3A6MTAwJX0udGlwcHktYmFja2Ryb3ArLnRpcHB5LWNvbnRlbnR7dHJhbnNpdGlvbi1wcm9wZXJ0eTpvcGFjaXR5O3dpbGwtY2hhbmdlOm9wYWNpdHl9LnRpcHB5LWJhY2tkcm9wKy50aXBweS1jb250ZW50W2RhdGEtc3RhdGU9dmlzaWJsZV17b3BhY2l0eToxfS50aXBweS1iYWNrZHJvcCsudGlwcHktY29udGVudFtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowfScpLHV0fSk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmFsbC5taW4uanMubWFwCg=="
                                },
                                {
                                    "id": "presentation/tippy-tooltip.js",
                                    "source": "Y2xhc3MgVGlwcHlUb29sdGlwIGV4dGVuZHMgUHJlc2VudGF0aW9uIHsNCiAgICBjb25zdHJ1Y3RvcihmdW5jdGlvbkluZm8sIHVzZXJJbnRlcmZhY2UsIGNvbmZpZ3VyYXRpb24pIHsNCiAgICAgICAgc3VwZXIoZnVuY3Rpb25JbmZvLCB1c2VySW50ZXJmYWNlLCBjb25maWd1cmF0aW9uKTsNCg0KICAgIH0NCg0KICAgIHJlbmRlclJlc3VsdChyZXF1ZXN0LCByZXN1bHQpIHsNCg0KICAgICAgICBsZXQgaW9SZXMgPSBpb1R5cGVVdGlscy50b0lPVHlwZUluc3RhbmNlKHJlc3VsdC5yZXN1bHQpOw0KICAgICAgICBsZXQgcmVzdWx0SFRNTCA9IGlvUmVzLnRvSHRtbCgpOw0KICAgICAgICBsZXQgcmVxdWVzdElEID0gdGhpcy5jcmVhdGVSZXF1ZXN0SWQoKTsNCg0KICAgICAgICBpZiAocmVxdWVzdC5pbnB1dFR5cGUgaW5zdGFuY2VvZiBXb3JkKSB7DQoNCg0KDQogICAgICAgICAgICAvL2xldCBjbGFzc05hbWUgPSAiZWFzeS1yZWFkaW5nLXRpcHB5LXRvb2x0aXAtIit0aGlzLnJlcXVlc3RDb3VudGVyOw0KICAgICAgICAgICAgLy9wYWdlVXRpbHMud3JhcFdvcmRJbihyZXF1ZXN0LmlucHV0LCAic3BhbiIsdGhpcy5jcmVhdGVSZXF1ZXN0SWQoKSwiZWFzeS1yZWFkaW5nLXJlc3VsdCBlYXN5LXJlYWRpbmctdGlwcHktdG9vbHRpcCAiK2NsYXNzTmFtZSk7DQoNCiAgICAgICAgICAgIGxldCBzcGFuID0gcGFnZVV0aWxzLndyYXBXb3JkSW4ocmVxdWVzdC5pbnB1dCwgInNwYW4iLCByZXF1ZXN0SUQrIiBlYXN5LXJlYWRpbmctdGlwcHktdG9vbHRpcCAiICsgdGhpcy5nZXRSZXN1bHRDbGFzcygpLCB0aGlzLmdldFByZXNlbnRhdGlvbkFuZFJlcXVlc3RJZGVudGlmaWVyKHJlcXVlc3RJRCkpOw0KDQogICAgICAgICAgICBpZiAoaW9SZXMgaW5zdGFuY2VvZiBJbWFnZUlPVHlwZSkgew0KICAgICAgICAgICAgICAgIGNvbnN0IElOSVRJQUxfQ09OVEVOVCA9ICdMb2FkaW5nLi4uJzsNCg0KICAgICAgICAgICAgICAgIGNvbnN0IHN0YXRlID0gew0KICAgICAgICAgICAgICAgICAgICBpc0ZldGNoaW5nOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgY2FuRmV0Y2g6IHRydWUNCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAgICAgdGlwcHkoIi4iICsgcmVxdWVzdElELCB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IElOSVRJQUxfQ09OVEVOVCwNCiAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdsaWdodC1ib3JkZXInLA0KICAgICAgICAgICAgICAgICAgICBhc3luYyBvblNob3codGlwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuaXNGZXRjaGluZyB8fCAhc3RhdGUuY2FuRmV0Y2gpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuaXNGZXRjaGluZyA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5jYW5GZXRjaCA9IGZhbHNlOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB0cnkgew0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZG93bmxvYWRpbmdJbWFnZSA9IG5ldyBJbWFnZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkaW5nSW1hZ2Uub25sb2FkID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGlwLnN0YXRlLmlzVmlzaWJsZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IDEwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpcC5zZXRDb250ZW50KHRoaXMpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkaW5nSW1hZ2Uuc3JjID0gcmVzdWx0LnJlc3VsdC51cmw7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXAuc2V0Q29udGVudChgRmV0Y2ggZmFpbGVkLiAke2V9YCkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuaXNGZXRjaGluZyA9IGZhbHNlDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIG9uSGlkZGVuKHRpcCkgew0KDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aXBweSgiLiIgKyByZXF1ZXN0SUQsIHsNCiAgICAgICAgICAgICAgICAgICAgY29udGVudDogcmVzdWx0SFRNTCwNCiAgICAgICAgICAgICAgICAgICAgdGhlbWU6ICdsaWdodC1ib3JkZXInLA0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0gZWxzZSBpZiAocmVxdWVzdC5pbnB1dFR5cGUgaW5zdGFuY2VvZiBQYXJhZ3JhcGgpIHsNCg0KICAgICAgICAgICAgbGV0IGRpdiA9ICQoIHJlcXVlc3QuaW5wdXQuZWxlbWVudCkud3JhcCggIjxkaXYgY2xhc3M9JyIrIHJlcXVlc3RJRCsiIGVhc3ktcmVhZGluZy10aXBweS10b29sdGlwICIrdGhpcy5nZXRSZXN1bHRDbGFzcygpKyInICIrdGhpcy5nZXRQcmVzZW50YXRpb25BbmRSZXF1ZXN0SWRlbnRpZmllcihyZXF1ZXN0SUQpKyI+PC9kaXY+IiApOw0KDQogICAgICAgICAgICB0aXBweSgiLiIgKyByZXF1ZXN0SUQsIHsNCiAgICAgICAgICAgICAgICBjb250ZW50OiByZXN1bHRIVE1MLA0KICAgICAgICAgICAgICAgIHRoZW1lOiAnbGlnaHQtYm9yZGVyJywNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgIH0NCg0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLnByZXNlbnRhdGlvbkZpbmlzaGVkKHRoaXMpOw0KDQogICAgfQ0KDQogICAgdW5kbygpIHsNCg0KICAgIH0NCiAgICByZW1vdmVSZXN1bHQocmVxdWVzdElEKXsNCg0KICAgICAgICBjb25zdCB0b29sdGlwRWxlbWVudCA9ICQoIi4iK3JlcXVlc3RJRCk7DQogICAgICAgIGlmKHRvb2x0aXBFbGVtZW50Lmxlbmd0aCl7DQogICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IHRpcHB5KHRvb2x0aXBFbGVtZW50WzBdKTsNCiAgICAgICAgICAgIGlmKGluc3RhbmNlKXsNCiAgICAgICAgICAgICAgICBpbnN0YW5jZS5kZXN0cm95KHRydWUpOw0KICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgaWYodG9vbHRpcEVsZW1lbnRbMF0uX3RpcHB5KXsNCiAgICAgICAgICAgICAgICAgICAgdG9vbHRpcEVsZW1lbnRbMF0uX3RpcHB5LmRlc3Ryb3kodHJ1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBsZXQgcGFyZW50ID0gdG9vbHRpcEVsZW1lbnQucGFyZW50KCk7DQogICAgICAgICAgICB0b29sdGlwRWxlbWVudC5jb250ZW50cygpLnVud3JhcCgpOw0KICAgICAgICAgICAgaWYocGFyZW50Lmxlbmd0aCl7DQogICAgICAgICAgICAgICAgcGFyZW50LmdldCgwKS5ub3JtYWxpemUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgfQ0KDQoNCn0="
                                }
                            ],
                            "contentCSS": [
                                {
                                    "id": "presentation/light-border.css",
                                    "css": "LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1le2JhY2tncm91bmQtY29sb3I6I2ZmZjtiYWNrZ3JvdW5kLWNsaXA6cGFkZGluZy1ib3g7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDAsOCwxNiwuMTUpO2NvbG9yOiMyNjMyM2Q7Ym94LXNoYWRvdzowIDNweCAxNHB4IC0uNXB4IHJnYmEoMCw4LDE2LC4wOCl9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lIC50aXBweS1iYWNrZHJvcHtiYWNrZ3JvdW5kLWNvbG9yOiNmZmZ9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lIC50aXBweS1hcnJvdzphZnRlciwudGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWUgLnRpcHB5LWFycm93OmJlZm9yZSwudGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWUgLnRpcHB5LXJvdW5kYXJyb3c6YWZ0ZXIsLnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lIC50aXBweS1yb3VuZGFycm93OmJlZm9yZXtjb250ZW50OiIiO3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6LTF9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lIC50aXBweS1yb3VuZGFycm93e2ZpbGw6I2ZmZn0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWUgLnRpcHB5LXJvdW5kYXJyb3c6YWZ0ZXJ7YmFja2dyb3VuZC1pbWFnZTp1cmwoZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCamJHbHdMWEoxYkdVOUltVjJaVzV2WkdRaUlHWnBiR3d0Y25Wc1pUMGlaWFpsYm05a1pDSWdjM1J5YjJ0bExXeHBibVZxYjJsdVBTSnliM1Z1WkNJZ2MzUnliMnRsTFcxcGRHVnliR2x0YVhROUlqRXVOREUwSWlCMmFXVjNRbTk0UFNJd0lEQWdNVGdnTnlJZ2VHMXNibk05SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpJd01EQXZjM1puSWo0OGNHRjBhQ0JrUFNKTk1DQTNjekl1TURJeExTNHdNVFVnTlM0eU5UTXROQzR5TVRoRE5pNDFPRFFnTVM0d05URWdOeTQzT1RjdU1EQTNJRGtnTUdNeExqSXdNeTB1TURBM0lESXVOREUySURFdU1ETTFJRE11TnpZeElESXVOemd5UXpFMkxqQXhNaUEzTGpBd05TQXhPQ0EzSURFNElEZDZJaUJtYVd4c1BTSWpNek16SWlCbWFXeHNMVzl3WVdOcGRIazlJaTR5TXpVaUlHWnBiR3d0Y25Wc1pUMGlibTl1ZW1WeWJ5SXZQand2YzNablBnPT0pO2JhY2tncm91bmQtc2l6ZToxOHB4IDdweDt3aWR0aDoxOHB4O2hlaWdodDo3cHg7bGVmdDowO3RvcDowO2ZpbGw6cmdiYSgwLDgsMTYsLjE1KX0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePXRvcF0gLnRpcHB5LXJvdW5kYXJyb3c6YWZ0ZXJ7dG9wOjFweDstd2Via2l0LXRyYW5zZm9ybTpyb3RhdGUoMTgwZGVnKTt0cmFuc2Zvcm06cm90YXRlKDE4MGRlZyl9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1hcnJvd3tib3JkZXItdG9wLWNvbG9yOiNmZmZ9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1hcnJvdzphZnRlcntib3JkZXItdG9wOjdweCBzb2xpZCAjZmZmO3RvcDotN3B4fS50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49dG9wXSAudGlwcHktYXJyb3c6YmVmb3Jle2JvcmRlci10b3A6N3B4IHNvbGlkIHJnYmEoMCw4LDE2LC4yKTtib3R0b206LTFweH0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePWJvdHRvbV0gLnRpcHB5LXJvdW5kYXJyb3c6YWZ0ZXJ7dG9wOi0xcHh9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1hcnJvd3tib3JkZXItYm90dG9tLWNvbG9yOiNmZmZ9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1hcnJvdzphZnRlcntib3JkZXItYm90dG9tOjdweCBzb2xpZCAjZmZmO2JvdHRvbTotN3B4fS50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktYXJyb3c6YmVmb3Jle2JvcmRlci1ib3R0b206N3B4IHNvbGlkIHJnYmEoMCw4LDE2LC4yKTtib3R0b206LTZweH0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePWxlZnRdIC50aXBweS1yb3VuZGFycm93OmFmdGVye2xlZnQ6MXB4O3RvcDowOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSg5MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSg5MGRlZyl9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktYXJyb3d7Ym9yZGVyLWxlZnQtY29sb3I6I2ZmZn0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePWxlZnRdIC50aXBweS1hcnJvdzphZnRlcntib3JkZXItbGVmdDo3cHggc29saWQgI2ZmZjtsZWZ0Oi03cHh9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktYXJyb3c6YmVmb3Jle2JvcmRlci1sZWZ0OjdweCBzb2xpZCByZ2JhKDAsOCwxNiwuMik7bGVmdDotNnB4fS50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1yb3VuZGFycm93OmFmdGVye2xlZnQ6LTFweDt0b3A6MDstd2Via2l0LXRyYW5zZm9ybTpyb3RhdGUoLTkwZGVnKTt0cmFuc2Zvcm06cm90YXRlKC05MGRlZyl9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1yaWdodF0gLnRpcHB5LWFycm93e2JvcmRlci1yaWdodC1jb2xvcjojZmZmfS50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1hcnJvdzphZnRlcntib3JkZXItcmlnaHQ6N3B4IHNvbGlkICNmZmY7cmlnaHQ6LTdweH0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePXJpZ2h0XSAudGlwcHktYXJyb3c6YmVmb3Jle2JvcmRlci1yaWdodDo3cHggc29saWQgcmdiYSgwLDgsMTYsLjIpO3JpZ2h0Oi02cHh9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1hcnJvdywudGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePWJvdHRvbV0gLnRpcHB5LXJvdW5kYXJyb3csLnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1hcnJvdywudGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePXRvcF0gLnRpcHB5LXJvdW5kYXJyb3d7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgtMXB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtMXB4KX0udGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePWJvdHRvbV0gLnRpcHB5LWFycm93OmFmdGVyLC50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktYXJyb3c6YmVmb3JlLC50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49dG9wXSAudGlwcHktYXJyb3c6YWZ0ZXIsLnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1hcnJvdzpiZWZvcmV7bGVmdDotN3B4O2JvcmRlci1sZWZ0OjdweCBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItcmlnaHQ6N3B4IHNvbGlkIHRyYW5zcGFyZW50fS50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LWFycm93LC50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LXJvdW5kYXJyb3csLnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1yaWdodF0gLnRpcHB5LWFycm93LC50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1yb3VuZGFycm93ey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTFweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTFweCl9LnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktYXJyb3c6YWZ0ZXIsLnRpcHB5LXRvb2x0aXAubGlnaHQtYm9yZGVyLXRoZW1lW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktYXJyb3c6YmVmb3JlLC50aXBweS10b29sdGlwLmxpZ2h0LWJvcmRlci10aGVtZVt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1hcnJvdzphZnRlciwudGlwcHktdG9vbHRpcC5saWdodC1ib3JkZXItdGhlbWVbeC1wbGFjZW1lbnRePXJpZ2h0XSAudGlwcHktYXJyb3c6YmVmb3Jle3RvcDotN3B4O2JvcmRlci10b3A6N3B4IHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1ib3R0b206N3B4IHNvbGlkIHRyYW5zcGFyZW50fQ=="
                                },
                                {
                                    "id": "presentation/tippy-tooltip.css",
                                    "css": "LmVhc3ktcmVhZGluZy10aXBweS10b29sdGlwIHsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBkb3R0ZWQgYmxhY2s7DQp9DQoNCg=="
                                }
                            ]
                        },
                        "configuration": {
                            "remoteAssetDirectory": "https://localhost:8080//components/presentation/tippy-tooltip/1.0/presentation/images"
                        }
                    }
                }
            ]
        }
    ],
    "plugins": [
        {
            "source": {
                "id": "texthelp-analytics",
                "name": "Texthelp analytics",
                "description": "Google Analytics of Texthelp",
                "version": "1.0",
                "versionDescription": "Initial Version",
                "debugMode": false,
                "remoteAssetDirectory": "",
                "remoteBaseDirectory": "components/plugin/texthelp-analytics/1.0/",
                "implementationClass": "TestPlugin",
                "contentScripts": [
                    {
                        "id": "plugin/assets/js/analytics.js",
                        "source": "JC5nZXRTY3JpcHQoICJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbS9ndGFnL2pzP2lkPVVBLTEyNDkwNDUxNi0yIiwgZnVuY3Rpb24oIGRhdGEsIHRleHRTdGF0dXMsIGpxeGhyICkgew0KICAgIGlmKGpxeGhyLnN0YXR1cyA9PT0gMjAwKXsNCiAgICAgICAgd2luZG93LmRhdGFMYXllciA9IHdpbmRvdy5kYXRhTGF5ZXIgfHwgW107DQogICAgICAgIGZ1bmN0aW9uIGd0YWcoKXtkYXRhTGF5ZXIucHVzaChhcmd1bWVudHMpO30NCiAgICAgICAgZ3RhZygnanMnLCBuZXcgRGF0ZSgpKTsNCiAgICAgICAgZ3RhZygnY29uZmlnJywgJ1VBLTEyNDkwNDUxNi0yJyk7DQoNCg0KICAgICAgICBjb25zb2xlLmxvZygidGV4dGhlbHAtYW5hbHl0aWNzIGxvYWRlZCIpOw0KDQogICAgfQ0KfSk7DQoNCg=="
                    }
                ],
                "contentCSS": []
            }
        }
    ],
    "userInterfaceCollectionID": 38,
    "uuid": "pbkdf2$10000$0c2661b06b1f8d202eab17fbf4bfd66f5e003f5dc52532e4ac1117d5c4b918db6f2e2918b002064b48a99b0c671587754fd0310193130d6e49d2c1b917fcc8e2$",
    "webSocketConnection": null,
    "roles": [
        "client",
        "anonym"
    ],
    "debugMode": false,
    "static": [
        "LyohIGpRdWVyeSB2My4zLjEgfCAoYykgSlMgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzIHwganF1ZXJ5Lm9yZy9saWNlbnNlICovDQohZnVuY3Rpb24oZSx0KXsidXNlIHN0cmljdCI7Im9iamVjdCI9PXR5cGVvZiBtb2R1bGUmJiJvYmplY3QiPT10eXBlb2YgbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZS5kb2N1bWVudD90KGUsITApOmZ1bmN0aW9uKGUpe2lmKCFlLmRvY3VtZW50KXRocm93IG5ldyBFcnJvcigialF1ZXJ5IHJlcXVpcmVzIGEgd2luZG93IHdpdGggYSBkb2N1bWVudCIpO3JldHVybiB0KGUpfTp0KGUpfSgidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6dGhpcyxmdW5jdGlvbihlLHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1bXSxyPWUuZG9jdW1lbnQsaT1PYmplY3QuZ2V0UHJvdG90eXBlT2Ysbz1uLnNsaWNlLGE9bi5jb25jYXQscz1uLnB1c2gsdT1uLmluZGV4T2YsbD17fSxjPWwudG9TdHJpbmcsZj1sLmhhc093blByb3BlcnR5LHA9Zi50b1N0cmluZyxkPXAuY2FsbChPYmplY3QpLGg9e30sZz1mdW5jdGlvbiBlKHQpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiB0JiYibnVtYmVyIiE9dHlwZW9mIHQubm9kZVR5cGV9LHk9ZnVuY3Rpb24gZSh0KXtyZXR1cm4gbnVsbCE9dCYmdD09PXQud2luZG93fSx2PXt0eXBlOiEwLHNyYzohMCxub01vZHVsZTohMH07ZnVuY3Rpb24gbShlLHQsbil7dmFyIGksbz0odD10fHxyKS5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTtpZihvLnRleHQ9ZSxuKWZvcihpIGluIHYpbltpXSYmKG9baV09bltpXSk7dC5oZWFkLmFwcGVuZENoaWxkKG8pLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobyl9ZnVuY3Rpb24geChlKXtyZXR1cm4gbnVsbD09ZT9lKyIiOiJvYmplY3QiPT10eXBlb2YgZXx8ImZ1bmN0aW9uIj09dHlwZW9mIGU/bFtjLmNhbGwoZSldfHwib2JqZWN0Ijp0eXBlb2YgZX12YXIgYj0iMy4zLjEiLHc9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbmV3IHcuZm4uaW5pdChlLHQpfSxUPS9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZzt3LmZuPXcucHJvdG90eXBlPXtqcXVlcnk6IjMuMy4xIixjb25zdHJ1Y3Rvcjp3LGxlbmd0aDowLHRvQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gby5jYWxsKHRoaXMpfSxnZXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PWU/by5jYWxsKHRoaXMpOmU8MD90aGlzW2UrdGhpcy5sZW5ndGhdOnRoaXNbZV19LHB1c2hTdGFjazpmdW5jdGlvbihlKXt2YXIgdD13Lm1lcmdlKHRoaXMuY29uc3RydWN0b3IoKSxlKTtyZXR1cm4gdC5wcmV2T2JqZWN0PXRoaXMsdH0sZWFjaDpmdW5jdGlvbihlKXtyZXR1cm4gdy5lYWNoKHRoaXMsZSl9LG1hcDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2sody5tYXAodGhpcyxmdW5jdGlvbih0LG4pe3JldHVybiBlLmNhbGwodCxuLHQpfSkpfSxzbGljZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnB1c2hTdGFjayhvLmFwcGx5KHRoaXMsYXJndW1lbnRzKSl9LGZpcnN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXEoMCl9LGxhc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgtMSl9LGVxOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMubGVuZ3RoLG49K2UrKGU8MD90OjApO3JldHVybiB0aGlzLnB1c2hTdGFjayhuPj0wJiZuPHQ/W3RoaXNbbl1dOltdKX0sZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJldk9iamVjdHx8dGhpcy5jb25zdHJ1Y3RvcigpfSxwdXNoOnMsc29ydDpuLnNvcnQsc3BsaWNlOm4uc3BsaWNlfSx3LmV4dGVuZD13LmZuLmV4dGVuZD1mdW5jdGlvbigpe3ZhciBlLHQsbixyLGksbyxhPWFyZ3VtZW50c1swXXx8e30scz0xLHU9YXJndW1lbnRzLmxlbmd0aCxsPSExO2ZvcigiYm9vbGVhbiI9PXR5cGVvZiBhJiYobD1hLGE9YXJndW1lbnRzW3NdfHx7fSxzKyspLCJvYmplY3QiPT10eXBlb2YgYXx8ZyhhKXx8KGE9e30pLHM9PT11JiYoYT10aGlzLHMtLSk7czx1O3MrKylpZihudWxsIT0oZT1hcmd1bWVudHNbc10pKWZvcih0IGluIGUpbj1hW3RdLGEhPT0ocj1lW3RdKSYmKGwmJnImJih3LmlzUGxhaW5PYmplY3Qocil8fChpPUFycmF5LmlzQXJyYXkocikpKT8oaT8oaT0hMSxvPW4mJkFycmF5LmlzQXJyYXkobik/bjpbXSk6bz1uJiZ3LmlzUGxhaW5PYmplY3Qobik/bjp7fSxhW3RdPXcuZXh0ZW5kKGwsbyxyKSk6dm9pZCAwIT09ciYmKGFbdF09cikpO3JldHVybiBhfSx3LmV4dGVuZCh7ZXhwYW5kbzoialF1ZXJ5IisoIjMuMy4xIitNYXRoLnJhbmRvbSgpKS5yZXBsYWNlKC9cRC9nLCIiKSxpc1JlYWR5OiEwLGVycm9yOmZ1bmN0aW9uKGUpe3Rocm93IG5ldyBFcnJvcihlKX0sbm9vcDpmdW5jdGlvbigpe30saXNQbGFpbk9iamVjdDpmdW5jdGlvbihlKXt2YXIgdCxuO3JldHVybiEoIWV8fCJbb2JqZWN0IE9iamVjdF0iIT09Yy5jYWxsKGUpKSYmKCEodD1pKGUpKXx8ImZ1bmN0aW9uIj09dHlwZW9mKG49Zi5jYWxsKHQsImNvbnN0cnVjdG9yIikmJnQuY29uc3RydWN0b3IpJiZwLmNhbGwobik9PT1kKX0saXNFbXB0eU9iamVjdDpmdW5jdGlvbihlKXt2YXIgdDtmb3IodCBpbiBlKXJldHVybiExO3JldHVybiEwfSxnbG9iYWxFdmFsOmZ1bmN0aW9uKGUpe20oZSl9LGVhY2g6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPTA7aWYoQyhlKSl7Zm9yKG49ZS5sZW5ndGg7cjxuO3IrKylpZighMT09PXQuY2FsbChlW3JdLHIsZVtyXSkpYnJlYWt9ZWxzZSBmb3IociBpbiBlKWlmKCExPT09dC5jYWxsKGVbcl0scixlW3JdKSlicmVhaztyZXR1cm4gZX0sdHJpbTpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZT8iIjooZSsiIikucmVwbGFjZShULCIiKX0sbWFrZUFycmF5OmZ1bmN0aW9uKGUsdCl7dmFyIG49dHx8W107cmV0dXJuIG51bGwhPWUmJihDKE9iamVjdChlKSk/dy5tZXJnZShuLCJzdHJpbmciPT10eXBlb2YgZT9bZV06ZSk6cy5jYWxsKG4sZSkpLG59LGluQXJyYXk6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBudWxsPT10Py0xOnUuY2FsbCh0LGUsbil9LG1lcmdlOmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPSt0Lmxlbmd0aCxyPTAsaT1lLmxlbmd0aDtyPG47cisrKWVbaSsrXT10W3JdO3JldHVybiBlLmxlbmd0aD1pLGV9LGdyZXA6ZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcixpPVtdLG89MCxhPWUubGVuZ3RoLHM9IW47bzxhO28rKykocj0hdChlW29dLG8pKSE9PXMmJmkucHVzaChlW29dKTtyZXR1cm4gaX0sbWFwOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89MCxzPVtdO2lmKEMoZSkpZm9yKHI9ZS5sZW5ndGg7bzxyO28rKyludWxsIT0oaT10KGVbb10sbyxuKSkmJnMucHVzaChpKTtlbHNlIGZvcihvIGluIGUpbnVsbCE9KGk9dChlW29dLG8sbikpJiZzLnB1c2goaSk7cmV0dXJuIGEuYXBwbHkoW10scyl9LGd1aWQ6MSxzdXBwb3J0Omh9KSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYody5mbltTeW1ib2wuaXRlcmF0b3JdPW5bU3ltYm9sLml0ZXJhdG9yXSksdy5lYWNoKCJCb29sZWFuIE51bWJlciBTdHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0IEVycm9yIFN5bWJvbCIuc3BsaXQoIiAiKSxmdW5jdGlvbihlLHQpe2xbIltvYmplY3QgIit0KyJdIl09dC50b0xvd2VyQ2FzZSgpfSk7ZnVuY3Rpb24gQyhlKXt2YXIgdD0hIWUmJiJsZW5ndGgiaW4gZSYmZS5sZW5ndGgsbj14KGUpO3JldHVybiFnKGUpJiYheShlKSYmKCJhcnJheSI9PT1ufHwwPT09dHx8Im51bWJlciI9PXR5cGVvZiB0JiZ0PjAmJnQtMSBpbiBlKX12YXIgRT1mdW5jdGlvbihlKXt2YXIgdCxuLHIsaSxvLGEscyx1LGwsYyxmLHAsZCxoLGcseSx2LG0seCxiPSJzaXp6bGUiKzEqbmV3IERhdGUsdz1lLmRvY3VtZW50LFQ9MCxDPTAsRT1hZSgpLGs9YWUoKSxTPWFlKCksRD1mdW5jdGlvbihlLHQpe3JldHVybiBlPT09dCYmKGY9ITApLDB9LE49e30uaGFzT3duUHJvcGVydHksQT1bXSxqPUEucG9wLHE9QS5wdXNoLEw9QS5wdXNoLEg9QS5zbGljZSxPPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTAscj1lLmxlbmd0aDtuPHI7bisrKWlmKGVbbl09PT10KXJldHVybiBuO3JldHVybi0xfSxQPSJjaGVja2VkfHNlbGVjdGVkfGFzeW5jfGF1dG9mb2N1c3xhdXRvcGxheXxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58aXNtYXB8bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZCIsTT0iW1xceDIwXFx0XFxyXFxuXFxmXSIsUj0iKD86XFxcXC58W1xcdy1dfFteXDAtXFx4YTBdKSsiLEk9IlxcWyIrTSsiKigiK1IrIikoPzoiK00rIiooWypeJHwhfl0/PSkiK00rIiooPzonKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcInwoIitSKyIpKXwpIitNKyIqXFxdIixXPSI6KCIrUisiKSg/OlxcKCgoJygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCIpfCgoPzpcXFxcLnxbXlxcXFwoKVtcXF1dfCIrSSsiKSopfC4qKVxcKXwpIiwkPW5ldyBSZWdFeHAoTSsiKyIsImciKSxCPW5ldyBSZWdFeHAoIl4iK00rIit8KCg/Ol58W15cXFxcXSkoPzpcXFxcLikqKSIrTSsiKyQiLCJnIiksRj1uZXcgUmVnRXhwKCJeIitNKyIqLCIrTSsiKiIpLF89bmV3IFJlZ0V4cCgiXiIrTSsiKihbPit+XXwiK00rIikiK00rIioiKSx6PW5ldyBSZWdFeHAoIj0iK00rIiooW15cXF0nXCJdKj8pIitNKyIqXFxdIiwiZyIpLFg9bmV3IFJlZ0V4cChXKSxVPW5ldyBSZWdFeHAoIl4iK1IrIiQiKSxWPXtJRDpuZXcgUmVnRXhwKCJeIygiK1IrIikiKSxDTEFTUzpuZXcgUmVnRXhwKCJeXFwuKCIrUisiKSIpLFRBRzpuZXcgUmVnRXhwKCJeKCIrUisifFsqXSkiKSxBVFRSOm5ldyBSZWdFeHAoIl4iK0kpLFBTRVVETzpuZXcgUmVnRXhwKCJeIitXKSxDSElMRDpuZXcgUmVnRXhwKCJeOihvbmx5fGZpcnN0fGxhc3R8bnRofG50aC1sYXN0KS0oY2hpbGR8b2YtdHlwZSkoPzpcXCgiK00rIiooZXZlbnxvZGR8KChbKy1dfCkoXFxkKilufCkiK00rIiooPzooWystXXwpIitNKyIqKFxcZCspfCkpIitNKyIqXFwpfCkiLCJpIiksYm9vbDpuZXcgUmVnRXhwKCJeKD86IitQKyIpJCIsImkiKSxuZWVkc0NvbnRleHQ6bmV3IFJlZ0V4cCgiXiIrTSsiKls+K35dfDooZXZlbnxvZGR8ZXF8Z3R8bHR8bnRofGZpcnN0fGxhc3QpKD86XFwoIitNKyIqKCg/Oi1cXGQpP1xcZCopIitNKyIqXFwpfCkoPz1bXi1dfCQpIiwiaSIpfSxHPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksWT0vXmhcZCQvaSxRPS9eW157XStce1xzKlxbbmF0aXZlIFx3LyxKPS9eKD86IyhbXHctXSspfChcdyspfFwuKFtcdy1dKykpJC8sSz0vWyt+XS8sWj1uZXcgUmVnRXhwKCJcXFxcKFtcXGRhLWZdezEsNn0iK00rIj98KCIrTSsiKXwuKSIsImlnIiksZWU9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPSIweCIrdC02NTUzNjtyZXR1cm4gciE9PXJ8fG4/dDpyPDA/U3RyaW5nLmZyb21DaGFyQ29kZShyKzY1NTM2KTpTdHJpbmcuZnJvbUNoYXJDb2RlKHI+PjEwfDU1Mjk2LDEwMjMmcnw1NjMyMCl9LHRlPS8oW1wwLVx4MWZceDdmXXxeLT9cZCl8Xi0kfFteXDAtXHgxZlx4N2YtXHVGRkZGXHctXS9nLG5lPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ/IlwwIj09PWU/Ilx1ZmZmZCI6ZS5zbGljZSgwLC0xKSsiXFwiK2UuY2hhckNvZGVBdChlLmxlbmd0aC0xKS50b1N0cmluZygxNikrIiAiOiJcXCIrZX0scmU9ZnVuY3Rpb24oKXtwKCl9LGllPW1lKGZ1bmN0aW9uKGUpe3JldHVybiEwPT09ZS5kaXNhYmxlZCYmKCJmb3JtImluIGV8fCJsYWJlbCJpbiBlKX0se2RpcjoicGFyZW50Tm9kZSIsbmV4dDoibGVnZW5kIn0pO3RyeXtMLmFwcGx5KEE9SC5jYWxsKHcuY2hpbGROb2Rlcyksdy5jaGlsZE5vZGVzKSxBW3cuY2hpbGROb2Rlcy5sZW5ndGhdLm5vZGVUeXBlfWNhdGNoKGUpe0w9e2FwcGx5OkEubGVuZ3RoP2Z1bmN0aW9uKGUsdCl7cS5hcHBseShlLEguY2FsbCh0KSl9OmZ1bmN0aW9uKGUsdCl7dmFyIG49ZS5sZW5ndGgscj0wO3doaWxlKGVbbisrXT10W3IrK10pO2UubGVuZ3RoPW4tMX19fWZ1bmN0aW9uIG9lKGUsdCxyLGkpe3ZhciBvLHMsbCxjLGYsaCx2LG09dCYmdC5vd25lckRvY3VtZW50LFQ9dD90Lm5vZGVUeXBlOjk7aWYocj1yfHxbXSwic3RyaW5nIiE9dHlwZW9mIGV8fCFlfHwxIT09VCYmOSE9PVQmJjExIT09VClyZXR1cm4gcjtpZighaSYmKCh0P3Qub3duZXJEb2N1bWVudHx8dDp3KSE9PWQmJnAodCksdD10fHxkLGcpKXtpZigxMSE9PVQmJihmPUouZXhlYyhlKSkpaWYobz1mWzFdKXtpZig5PT09VCl7aWYoIShsPXQuZ2V0RWxlbWVudEJ5SWQobykpKXJldHVybiByO2lmKGwuaWQ9PT1vKXJldHVybiByLnB1c2gobCkscn1lbHNlIGlmKG0mJihsPW0uZ2V0RWxlbWVudEJ5SWQobykpJiZ4KHQsbCkmJmwuaWQ9PT1vKXJldHVybiByLnB1c2gobCkscn1lbHNle2lmKGZbMl0pcmV0dXJuIEwuYXBwbHkocix0LmdldEVsZW1lbnRzQnlUYWdOYW1lKGUpKSxyO2lmKChvPWZbM10pJiZuLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSlyZXR1cm4gTC5hcHBseShyLHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShvKSkscn1pZihuLnFzYSYmIVNbZSsiICJdJiYoIXl8fCF5LnRlc3QoZSkpKXtpZigxIT09VCltPXQsdj1lO2Vsc2UgaWYoIm9iamVjdCIhPT10Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpeyhjPXQuZ2V0QXR0cmlidXRlKCJpZCIpKT9jPWMucmVwbGFjZSh0ZSxuZSk6dC5zZXRBdHRyaWJ1dGUoImlkIixjPWIpLHM9KGg9YShlKSkubGVuZ3RoO3doaWxlKHMtLSloW3NdPSIjIitjKyIgIit2ZShoW3NdKTt2PWguam9pbigiLCIpLG09Sy50ZXN0KGUpJiZnZSh0LnBhcmVudE5vZGUpfHx0fWlmKHYpdHJ5e3JldHVybiBMLmFwcGx5KHIsbS5xdWVyeVNlbGVjdG9yQWxsKHYpKSxyfWNhdGNoKGUpe31maW5hbGx5e2M9PT1iJiZ0LnJlbW92ZUF0dHJpYnV0ZSgiaWQiKX19fXJldHVybiB1KGUucmVwbGFjZShCLCIkMSIpLHQscixpKX1mdW5jdGlvbiBhZSgpe3ZhciBlPVtdO2Z1bmN0aW9uIHQobixpKXtyZXR1cm4gZS5wdXNoKG4rIiAiKT5yLmNhY2hlTGVuZ3RoJiZkZWxldGUgdFtlLnNoaWZ0KCldLHRbbisiICJdPWl9cmV0dXJuIHR9ZnVuY3Rpb24gc2UoZSl7cmV0dXJuIGVbYl09ITAsZX1mdW5jdGlvbiB1ZShlKXt2YXIgdD1kLmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0Iik7dHJ5e3JldHVybiEhZSh0KX1jYXRjaChlKXtyZXR1cm4hMX1maW5hbGx5e3QucGFyZW50Tm9kZSYmdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHQpLHQ9bnVsbH19ZnVuY3Rpb24gbGUoZSx0KXt2YXIgbj1lLnNwbGl0KCJ8IiksaT1uLmxlbmd0aDt3aGlsZShpLS0pci5hdHRySGFuZGxlW25baV1dPXR9ZnVuY3Rpb24gY2UoZSx0KXt2YXIgbj10JiZlLHI9biYmMT09PWUubm9kZVR5cGUmJjE9PT10Lm5vZGVUeXBlJiZlLnNvdXJjZUluZGV4LXQuc291cmNlSW5kZXg7aWYocilyZXR1cm4gcjtpZihuKXdoaWxlKG49bi5uZXh0U2libGluZylpZihuPT09dClyZXR1cm4tMTtyZXR1cm4gZT8xOi0xfWZ1bmN0aW9uIGZlKGUpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4iaW5wdXQiPT09dC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpJiZ0LnR5cGU9PT1lfX1mdW5jdGlvbiBwZShlKXtyZXR1cm4gZnVuY3Rpb24odCl7dmFyIG49dC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVybigiaW5wdXQiPT09bnx8ImJ1dHRvbiI9PT1uKSYmdC50eXBlPT09ZX19ZnVuY3Rpb24gZGUoZSl7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiJmb3JtImluIHQ/dC5wYXJlbnROb2RlJiYhMT09PXQuZGlzYWJsZWQ/ImxhYmVsImluIHQ/ImxhYmVsImluIHQucGFyZW50Tm9kZT90LnBhcmVudE5vZGUuZGlzYWJsZWQ9PT1lOnQuZGlzYWJsZWQ9PT1lOnQuaXNEaXNhYmxlZD09PWV8fHQuaXNEaXNhYmxlZCE9PSFlJiZpZSh0KT09PWU6dC5kaXNhYmxlZD09PWU6ImxhYmVsImluIHQmJnQuZGlzYWJsZWQ9PT1lfX1mdW5jdGlvbiBoZShlKXtyZXR1cm4gc2UoZnVuY3Rpb24odCl7cmV0dXJuIHQ9K3Qsc2UoZnVuY3Rpb24obixyKXt2YXIgaSxvPWUoW10sbi5sZW5ndGgsdCksYT1vLmxlbmd0aDt3aGlsZShhLS0pbltpPW9bYV1dJiYobltpXT0hKHJbaV09bltpXSkpfSl9KX1mdW5jdGlvbiBnZShlKXtyZXR1cm4gZSYmInVuZGVmaW5lZCIhPXR5cGVvZiBlLmdldEVsZW1lbnRzQnlUYWdOYW1lJiZlfW49b2Uuc3VwcG9ydD17fSxvPW9lLmlzWE1MPWZ1bmN0aW9uKGUpe3ZhciB0PWUmJihlLm93bmVyRG9jdW1lbnR8fGUpLmRvY3VtZW50RWxlbWVudDtyZXR1cm4hIXQmJiJIVE1MIiE9PXQubm9kZU5hbWV9LHA9b2Uuc2V0RG9jdW1lbnQ9ZnVuY3Rpb24oZSl7dmFyIHQsaSxhPWU/ZS5vd25lckRvY3VtZW50fHxlOnc7cmV0dXJuIGEhPT1kJiY5PT09YS5ub2RlVHlwZSYmYS5kb2N1bWVudEVsZW1lbnQ/KGQ9YSxoPWQuZG9jdW1lbnRFbGVtZW50LGc9IW8oZCksdyE9PWQmJihpPWQuZGVmYXVsdFZpZXcpJiZpLnRvcCE9PWkmJihpLmFkZEV2ZW50TGlzdGVuZXI/aS5hZGRFdmVudExpc3RlbmVyKCJ1bmxvYWQiLHJlLCExKTppLmF0dGFjaEV2ZW50JiZpLmF0dGFjaEV2ZW50KCJvbnVubG9hZCIscmUpKSxuLmF0dHJpYnV0ZXM9dWUoZnVuY3Rpb24oZSl7cmV0dXJuIGUuY2xhc3NOYW1lPSJpIiwhZS5nZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIpfSksbi5nZXRFbGVtZW50c0J5VGFnTmFtZT11ZShmdW5jdGlvbihlKXtyZXR1cm4gZS5hcHBlbmRDaGlsZChkLmNyZWF0ZUNvbW1lbnQoIiIpKSwhZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLmxlbmd0aH0pLG4uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZT1RLnRlc3QoZC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKSxuLmdldEJ5SWQ9dWUoZnVuY3Rpb24oZSl7cmV0dXJuIGguYXBwZW5kQ2hpbGQoZSkuaWQ9YiwhZC5nZXRFbGVtZW50c0J5TmFtZXx8IWQuZ2V0RWxlbWVudHNCeU5hbWUoYikubGVuZ3RofSksbi5nZXRCeUlkPyhyLmZpbHRlci5JRD1mdW5jdGlvbihlKXt2YXIgdD1lLnJlcGxhY2UoWixlZSk7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBlLmdldEF0dHJpYnV0ZSgiaWQiKT09PXR9fSxyLmZpbmQuSUQ9ZnVuY3Rpb24oZSx0KXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHQuZ2V0RWxlbWVudEJ5SWQmJmcpe3ZhciBuPXQuZ2V0RWxlbWVudEJ5SWQoZSk7cmV0dXJuIG4/W25dOltdfX0pOihyLmZpbHRlci5JRD1mdW5jdGlvbihlKXt2YXIgdD1lLnJlcGxhY2UoWixlZSk7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciBuPSJ1bmRlZmluZWQiIT10eXBlb2YgZS5nZXRBdHRyaWJ1dGVOb2RlJiZlLmdldEF0dHJpYnV0ZU5vZGUoImlkIik7cmV0dXJuIG4mJm4udmFsdWU9PT10fX0sci5maW5kLklEPWZ1bmN0aW9uKGUsdCl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB0LmdldEVsZW1lbnRCeUlkJiZnKXt2YXIgbixyLGksbz10LmdldEVsZW1lbnRCeUlkKGUpO2lmKG8pe2lmKChuPW8uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKSkmJm4udmFsdWU9PT1lKXJldHVybltvXTtpPXQuZ2V0RWxlbWVudHNCeU5hbWUoZSkscj0wO3doaWxlKG89aVtyKytdKWlmKChuPW8uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKSkmJm4udmFsdWU9PT1lKXJldHVybltvXX1yZXR1cm5bXX19KSxyLmZpbmQuVEFHPW4uZ2V0RWxlbWVudHNCeVRhZ05hbWU/ZnVuY3Rpb24oZSx0KXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIHQuZ2V0RWxlbWVudHNCeVRhZ05hbWU/dC5nZXRFbGVtZW50c0J5VGFnTmFtZShlKTpuLnFzYT90LnF1ZXJ5U2VsZWN0b3JBbGwoZSk6dm9pZCAwfTpmdW5jdGlvbihlLHQpe3ZhciBuLHI9W10saT0wLG89dC5nZXRFbGVtZW50c0J5VGFnTmFtZShlKTtpZigiKiI9PT1lKXt3aGlsZShuPW9baSsrXSkxPT09bi5ub2RlVHlwZSYmci5wdXNoKG4pO3JldHVybiByfXJldHVybiBvfSxyLmZpbmQuQ0xBU1M9bi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZmdW5jdGlvbihlLHQpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgdC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZnKXJldHVybiB0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoZSl9LHY9W10seT1bXSwobi5xc2E9US50ZXN0KGQucXVlcnlTZWxlY3RvckFsbCkpJiYodWUoZnVuY3Rpb24oZSl7aC5hcHBlbmRDaGlsZChlKS5pbm5lckhUTUw9IjxhIGlkPSciK2IrIic+PC9hPjxzZWxlY3QgaWQ9JyIrYisiLVxyXFwnIG1zYWxsb3djYXB0dXJlPScnPjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+IixlLnF1ZXJ5U2VsZWN0b3JBbGwoIlttc2FsbG93Y2FwdHVyZV49JyddIikubGVuZ3RoJiZ5LnB1c2goIlsqXiRdPSIrTSsiKig/OicnfFwiXCIpIiksZS5xdWVyeVNlbGVjdG9yQWxsKCJbc2VsZWN0ZWRdIikubGVuZ3RofHx5LnB1c2goIlxcWyIrTSsiKig/OnZhbHVlfCIrUCsiKSIpLGUucXVlcnlTZWxlY3RvckFsbCgiW2lkfj0iK2IrIi1dIikubGVuZ3RofHx5LnB1c2goIn49IiksZS5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aHx8eS5wdXNoKCI6Y2hlY2tlZCIpLGUucXVlcnlTZWxlY3RvckFsbCgiYSMiK2IrIisqIikubGVuZ3RofHx5LnB1c2goIi4jLitbK35dIil9KSx1ZShmdW5jdGlvbihlKXtlLmlubmVySFRNTD0iPGEgaHJlZj0nJyBkaXNhYmxlZD0nZGlzYWJsZWQnPjwvYT48c2VsZWN0IGRpc2FibGVkPSdkaXNhYmxlZCc+PG9wdGlvbi8+PC9zZWxlY3Q+Ijt2YXIgdD1kLmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7dC5zZXRBdHRyaWJ1dGUoInR5cGUiLCJoaWRkZW4iKSxlLmFwcGVuZENoaWxkKHQpLnNldEF0dHJpYnV0ZSgibmFtZSIsIkQiKSxlLnF1ZXJ5U2VsZWN0b3JBbGwoIltuYW1lPWRdIikubGVuZ3RoJiZ5LnB1c2goIm5hbWUiK00rIipbKl4kfCF+XT89IiksMiE9PWUucXVlcnlTZWxlY3RvckFsbCgiOmVuYWJsZWQiKS5sZW5ndGgmJnkucHVzaCgiOmVuYWJsZWQiLCI6ZGlzYWJsZWQiKSxoLmFwcGVuZENoaWxkKGUpLmRpc2FibGVkPSEwLDIhPT1lLnF1ZXJ5U2VsZWN0b3JBbGwoIjpkaXNhYmxlZCIpLmxlbmd0aCYmeS5wdXNoKCI6ZW5hYmxlZCIsIjpkaXNhYmxlZCIpLGUucXVlcnlTZWxlY3RvckFsbCgiKiw6eCIpLHkucHVzaCgiLC4qOiIpfSkpLChuLm1hdGNoZXNTZWxlY3Rvcj1RLnRlc3QobT1oLm1hdGNoZXN8fGgud2Via2l0TWF0Y2hlc1NlbGVjdG9yfHxoLm1vek1hdGNoZXNTZWxlY3Rvcnx8aC5vTWF0Y2hlc1NlbGVjdG9yfHxoLm1zTWF0Y2hlc1NlbGVjdG9yKSkmJnVlKGZ1bmN0aW9uKGUpe24uZGlzY29ubmVjdGVkTWF0Y2g9bS5jYWxsKGUsIioiKSxtLmNhbGwoZSwiW3MhPScnXTp4Iiksdi5wdXNoKCIhPSIsVyl9KSx5PXkubGVuZ3RoJiZuZXcgUmVnRXhwKHkuam9pbigifCIpKSx2PXYubGVuZ3RoJiZuZXcgUmVnRXhwKHYuam9pbigifCIpKSx0PVEudGVzdChoLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKSx4PXR8fFEudGVzdChoLmNvbnRhaW5zKT9mdW5jdGlvbihlLHQpe3ZhciBuPTk9PT1lLm5vZGVUeXBlP2UuZG9jdW1lbnRFbGVtZW50OmUscj10JiZ0LnBhcmVudE5vZGU7cmV0dXJuIGU9PT1yfHwhKCFyfHwxIT09ci5ub2RlVHlwZXx8IShuLmNvbnRhaW5zP24uY29udGFpbnMocik6ZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiYmMTYmZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihyKSkpfTpmdW5jdGlvbihlLHQpe2lmKHQpd2hpbGUodD10LnBhcmVudE5vZGUpaWYodD09PWUpcmV0dXJuITA7cmV0dXJuITF9LEQ9dD9mdW5jdGlvbihlLHQpe2lmKGU9PT10KXJldHVybiBmPSEwLDA7dmFyIHI9IWUuY29tcGFyZURvY3VtZW50UG9zaXRpb24tIXQuY29tcGFyZURvY3VtZW50UG9zaXRpb247cmV0dXJuIHJ8fCgxJihyPShlLm93bmVyRG9jdW1lbnR8fGUpPT09KHQub3duZXJEb2N1bWVudHx8dCk/ZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbih0KToxKXx8IW4uc29ydERldGFjaGVkJiZ0LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGUpPT09cj9lPT09ZHx8ZS5vd25lckRvY3VtZW50PT09dyYmeCh3LGUpPy0xOnQ9PT1kfHx0Lm93bmVyRG9jdW1lbnQ9PT13JiZ4KHcsdCk/MTpjP08oYyxlKS1PKGMsdCk6MDo0JnI/LTE6MSl9OmZ1bmN0aW9uKGUsdCl7aWYoZT09PXQpcmV0dXJuIGY9ITAsMDt2YXIgbixyPTAsaT1lLnBhcmVudE5vZGUsbz10LnBhcmVudE5vZGUsYT1bZV0scz1bdF07aWYoIWl8fCFvKXJldHVybiBlPT09ZD8tMTp0PT09ZD8xOmk/LTE6bz8xOmM/TyhjLGUpLU8oYyx0KTowO2lmKGk9PT1vKXJldHVybiBjZShlLHQpO249ZTt3aGlsZShuPW4ucGFyZW50Tm9kZSlhLnVuc2hpZnQobik7bj10O3doaWxlKG49bi5wYXJlbnROb2RlKXMudW5zaGlmdChuKTt3aGlsZShhW3JdPT09c1tyXSlyKys7cmV0dXJuIHI/Y2UoYVtyXSxzW3JdKTphW3JdPT09dz8tMTpzW3JdPT09dz8xOjB9LGQpOmR9LG9lLm1hdGNoZXM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gb2UoZSxudWxsLG51bGwsdCl9LG9lLm1hdGNoZXNTZWxlY3Rvcj1mdW5jdGlvbihlLHQpe2lmKChlLm93bmVyRG9jdW1lbnR8fGUpIT09ZCYmcChlKSx0PXQucmVwbGFjZSh6LCI9JyQxJ10iKSxuLm1hdGNoZXNTZWxlY3RvciYmZyYmIVNbdCsiICJdJiYoIXZ8fCF2LnRlc3QodCkpJiYoIXl8fCF5LnRlc3QodCkpKXRyeXt2YXIgcj1tLmNhbGwoZSx0KTtpZihyfHxuLmRpc2Nvbm5lY3RlZE1hdGNofHxlLmRvY3VtZW50JiYxMSE9PWUuZG9jdW1lbnQubm9kZVR5cGUpcmV0dXJuIHJ9Y2F0Y2goZSl7fXJldHVybiBvZSh0LGQsbnVsbCxbZV0pLmxlbmd0aD4wfSxvZS5jb250YWlucz1mdW5jdGlvbihlLHQpe3JldHVybihlLm93bmVyRG9jdW1lbnR8fGUpIT09ZCYmcChlKSx4KGUsdCl9LG9lLmF0dHI9ZnVuY3Rpb24oZSx0KXsoZS5vd25lckRvY3VtZW50fHxlKSE9PWQmJnAoZSk7dmFyIGk9ci5hdHRySGFuZGxlW3QudG9Mb3dlckNhc2UoKV0sbz1pJiZOLmNhbGwoci5hdHRySGFuZGxlLHQudG9Mb3dlckNhc2UoKSk/aShlLHQsIWcpOnZvaWQgMDtyZXR1cm4gdm9pZCAwIT09bz9vOm4uYXR0cmlidXRlc3x8IWc/ZS5nZXRBdHRyaWJ1dGUodCk6KG89ZS5nZXRBdHRyaWJ1dGVOb2RlKHQpKSYmby5zcGVjaWZpZWQ/by52YWx1ZTpudWxsfSxvZS5lc2NhcGU9ZnVuY3Rpb24oZSl7cmV0dXJuKGUrIiIpLnJlcGxhY2UodGUsbmUpfSxvZS5lcnJvcj1mdW5jdGlvbihlKXt0aHJvdyBuZXcgRXJyb3IoIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIrZSl9LG9lLnVuaXF1ZVNvcnQ9ZnVuY3Rpb24oZSl7dmFyIHQscj1bXSxpPTAsbz0wO2lmKGY9IW4uZGV0ZWN0RHVwbGljYXRlcyxjPSFuLnNvcnRTdGFibGUmJmUuc2xpY2UoMCksZS5zb3J0KEQpLGYpe3doaWxlKHQ9ZVtvKytdKXQ9PT1lW29dJiYoaT1yLnB1c2gobykpO3doaWxlKGktLSllLnNwbGljZShyW2ldLDEpfXJldHVybiBjPW51bGwsZX0saT1vZS5nZXRUZXh0PWZ1bmN0aW9uKGUpe3ZhciB0LG49IiIscj0wLG89ZS5ub2RlVHlwZTtpZihvKXtpZigxPT09b3x8OT09PW98fDExPT09byl7aWYoInN0cmluZyI9PXR5cGVvZiBlLnRleHRDb250ZW50KXJldHVybiBlLnRleHRDb250ZW50O2ZvcihlPWUuZmlyc3RDaGlsZDtlO2U9ZS5uZXh0U2libGluZyluKz1pKGUpfWVsc2UgaWYoMz09PW98fDQ9PT1vKXJldHVybiBlLm5vZGVWYWx1ZX1lbHNlIHdoaWxlKHQ9ZVtyKytdKW4rPWkodCk7cmV0dXJuIG59LChyPW9lLnNlbGVjdG9ycz17Y2FjaGVMZW5ndGg6NTAsY3JlYXRlUHNldWRvOnNlLG1hdGNoOlYsYXR0ckhhbmRsZTp7fSxmaW5kOnt9LHJlbGF0aXZlOnsiPiI6e2RpcjoicGFyZW50Tm9kZSIsZmlyc3Q6ITB9LCIgIjp7ZGlyOiJwYXJlbnROb2RlIn0sIisiOntkaXI6InByZXZpb3VzU2libGluZyIsZmlyc3Q6ITB9LCJ+Ijp7ZGlyOiJwcmV2aW91c1NpYmxpbmcifX0scHJlRmlsdGVyOntBVFRSOmZ1bmN0aW9uKGUpe3JldHVybiBlWzFdPWVbMV0ucmVwbGFjZShaLGVlKSxlWzNdPShlWzNdfHxlWzRdfHxlWzVdfHwiIikucmVwbGFjZShaLGVlKSwifj0iPT09ZVsyXSYmKGVbM109IiAiK2VbM10rIiAiKSxlLnNsaWNlKDAsNCl9LENISUxEOmZ1bmN0aW9uKGUpe3JldHVybiBlWzFdPWVbMV0udG9Mb3dlckNhc2UoKSwibnRoIj09PWVbMV0uc2xpY2UoMCwzKT8oZVszXXx8b2UuZXJyb3IoZVswXSksZVs0XT0rKGVbNF0/ZVs1XSsoZVs2XXx8MSk6MiooImV2ZW4iPT09ZVszXXx8Im9kZCI9PT1lWzNdKSksZVs1XT0rKGVbN10rZVs4XXx8Im9kZCI9PT1lWzNdKSk6ZVszXSYmb2UuZXJyb3IoZVswXSksZX0sUFNFVURPOmZ1bmN0aW9uKGUpe3ZhciB0LG49IWVbNl0mJmVbMl07cmV0dXJuIFYuQ0hJTEQudGVzdChlWzBdKT9udWxsOihlWzNdP2VbMl09ZVs0XXx8ZVs1XXx8IiI6biYmWC50ZXN0KG4pJiYodD1hKG4sITApKSYmKHQ9bi5pbmRleE9mKCIpIixuLmxlbmd0aC10KS1uLmxlbmd0aCkmJihlWzBdPWVbMF0uc2xpY2UoMCx0KSxlWzJdPW4uc2xpY2UoMCx0KSksZS5zbGljZSgwLDMpKX19LGZpbHRlcjp7VEFHOmZ1bmN0aW9uKGUpe3ZhciB0PWUucmVwbGFjZShaLGVlKS50b0xvd2VyQ2FzZSgpO3JldHVybiIqIj09PWU/ZnVuY3Rpb24oKXtyZXR1cm4hMH06ZnVuY3Rpb24oZSl7cmV0dXJuIGUubm9kZU5hbWUmJmUubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXR9fSxDTEFTUzpmdW5jdGlvbihlKXt2YXIgdD1FW2UrIiAiXTtyZXR1cm4gdHx8KHQ9bmV3IFJlZ0V4cCgiKF58IitNKyIpIitlKyIoIitNKyJ8JCkiKSkmJkUoZSxmdW5jdGlvbihlKXtyZXR1cm4gdC50ZXN0KCJzdHJpbmciPT10eXBlb2YgZS5jbGFzc05hbWUmJmUuY2xhc3NOYW1lfHwidW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0QXR0cmlidXRlJiZlLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiIpfSl9LEFUVFI6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBmdW5jdGlvbihyKXt2YXIgaT1vZS5hdHRyKHIsZSk7cmV0dXJuIG51bGw9PWk/IiE9Ij09PXQ6IXR8fChpKz0iIiwiPSI9PT10P2k9PT1uOiIhPSI9PT10P2khPT1uOiJePSI9PT10P24mJjA9PT1pLmluZGV4T2Yobik6Iio9Ij09PXQ/biYmaS5pbmRleE9mKG4pPi0xOiIkPSI9PT10P24mJmkuc2xpY2UoLW4ubGVuZ3RoKT09PW46In49Ij09PXQ/KCIgIitpLnJlcGxhY2UoJCwiICIpKyIgIikuaW5kZXhPZihuKT4tMToifD0iPT09dCYmKGk9PT1ufHxpLnNsaWNlKDAsbi5sZW5ndGgrMSk9PT1uKyItIikpfX0sQ0hJTEQ6ZnVuY3Rpb24oZSx0LG4scixpKXt2YXIgbz0ibnRoIiE9PWUuc2xpY2UoMCwzKSxhPSJsYXN0IiE9PWUuc2xpY2UoLTQpLHM9Im9mLXR5cGUiPT09dDtyZXR1cm4gMT09PXImJjA9PT1pP2Z1bmN0aW9uKGUpe3JldHVybiEhZS5wYXJlbnROb2RlfTpmdW5jdGlvbih0LG4sdSl7dmFyIGwsYyxmLHAsZCxoLGc9byE9PWE/Im5leHRTaWJsaW5nIjoicHJldmlvdXNTaWJsaW5nIix5PXQucGFyZW50Tm9kZSx2PXMmJnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxtPSF1JiYhcyx4PSExO2lmKHkpe2lmKG8pe3doaWxlKGcpe3A9dDt3aGlsZShwPXBbZ10paWYocz9wLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT12OjE9PT1wLm5vZGVUeXBlKXJldHVybiExO2g9Zz0ib25seSI9PT1lJiYhaCYmIm5leHRTaWJsaW5nIn1yZXR1cm4hMH1pZihoPVthP3kuZmlyc3RDaGlsZDp5Lmxhc3RDaGlsZF0sYSYmbSl7eD0oZD0obD0oYz0oZj0ocD15KVtiXXx8KHBbYl09e30pKVtwLnVuaXF1ZUlEXXx8KGZbcC51bmlxdWVJRF09e30pKVtlXXx8W10pWzBdPT09VCYmbFsxXSkmJmxbMl0scD1kJiZ5LmNoaWxkTm9kZXNbZF07d2hpbGUocD0rK2QmJnAmJnBbZ118fCh4PWQ9MCl8fGgucG9wKCkpaWYoMT09PXAubm9kZVR5cGUmJisreCYmcD09PXQpe2NbZV09W1QsZCx4XTticmVha319ZWxzZSBpZihtJiYoeD1kPShsPShjPShmPShwPXQpW2JdfHwocFtiXT17fSkpW3AudW5pcXVlSURdfHwoZltwLnVuaXF1ZUlEXT17fSkpW2VdfHxbXSlbMF09PT1UJiZsWzFdKSwhMT09PXgpd2hpbGUocD0rK2QmJnAmJnBbZ118fCh4PWQ9MCl8fGgucG9wKCkpaWYoKHM/cC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09djoxPT09cC5ub2RlVHlwZSkmJisreCYmKG0mJigoYz0oZj1wW2JdfHwocFtiXT17fSkpW3AudW5pcXVlSURdfHwoZltwLnVuaXF1ZUlEXT17fSkpW2VdPVtULHhdKSxwPT09dCkpYnJlYWs7cmV0dXJuKHgtPWkpPT09cnx8eCVyPT0wJiZ4L3I+PTB9fX0sUFNFVURPOmZ1bmN0aW9uKGUsdCl7dmFyIG4saT1yLnBzZXVkb3NbZV18fHIuc2V0RmlsdGVyc1tlLnRvTG93ZXJDYXNlKCldfHxvZS5lcnJvcigidW5zdXBwb3J0ZWQgcHNldWRvOiAiK2UpO3JldHVybiBpW2JdP2kodCk6aS5sZW5ndGg+MT8obj1bZSxlLCIiLHRdLHIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eShlLnRvTG93ZXJDYXNlKCkpP3NlKGZ1bmN0aW9uKGUsbil7dmFyIHIsbz1pKGUsdCksYT1vLmxlbmd0aDt3aGlsZShhLS0pZVtyPU8oZSxvW2FdKV09IShuW3JdPW9bYV0pfSk6ZnVuY3Rpb24oZSl7cmV0dXJuIGkoZSwwLG4pfSk6aX19LHBzZXVkb3M6e25vdDpzZShmdW5jdGlvbihlKXt2YXIgdD1bXSxuPVtdLHI9cyhlLnJlcGxhY2UoQiwiJDEiKSk7cmV0dXJuIHJbYl0/c2UoZnVuY3Rpb24oZSx0LG4saSl7dmFyIG8sYT1yKGUsbnVsbCxpLFtdKSxzPWUubGVuZ3RoO3doaWxlKHMtLSkobz1hW3NdKSYmKGVbc109ISh0W3NdPW8pKX0pOmZ1bmN0aW9uKGUsaSxvKXtyZXR1cm4gdFswXT1lLHIodCxudWxsLG8sbiksdFswXT1udWxsLCFuLnBvcCgpfX0pLGhhczpzZShmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIG9lKGUsdCkubGVuZ3RoPjB9fSksY29udGFpbnM6c2UoZnVuY3Rpb24oZSl7cmV0dXJuIGU9ZS5yZXBsYWNlKFosZWUpLGZ1bmN0aW9uKHQpe3JldHVybih0LnRleHRDb250ZW50fHx0LmlubmVyVGV4dHx8aSh0KSkuaW5kZXhPZihlKT4tMX19KSxsYW5nOnNlKGZ1bmN0aW9uKGUpe3JldHVybiBVLnRlc3QoZXx8IiIpfHxvZS5lcnJvcigidW5zdXBwb3J0ZWQgbGFuZzogIitlKSxlPWUucmVwbGFjZShaLGVlKS50b0xvd2VyQ2FzZSgpLGZ1bmN0aW9uKHQpe3ZhciBuO2Rve2lmKG49Zz90Lmxhbmc6dC5nZXRBdHRyaWJ1dGUoInhtbDpsYW5nIil8fHQuZ2V0QXR0cmlidXRlKCJsYW5nIikpcmV0dXJuKG49bi50b0xvd2VyQ2FzZSgpKT09PWV8fDA9PT1uLmluZGV4T2YoZSsiLSIpfXdoaWxlKCh0PXQucGFyZW50Tm9kZSkmJjE9PT10Lm5vZGVUeXBlKTtyZXR1cm4hMX19KSx0YXJnZXQ6ZnVuY3Rpb24odCl7dmFyIG49ZS5sb2NhdGlvbiYmZS5sb2NhdGlvbi5oYXNoO3JldHVybiBuJiZuLnNsaWNlKDEpPT09dC5pZH0scm9vdDpmdW5jdGlvbihlKXtyZXR1cm4gZT09PWh9LGZvY3VzOmZ1bmN0aW9uKGUpe3JldHVybiBlPT09ZC5hY3RpdmVFbGVtZW50JiYoIWQuaGFzRm9jdXN8fGQuaGFzRm9jdXMoKSkmJiEhKGUudHlwZXx8ZS5ocmVmfHx+ZS50YWJJbmRleCl9LGVuYWJsZWQ6ZGUoITEpLGRpc2FibGVkOmRlKCEwKSxjaGVja2VkOmZ1bmN0aW9uKGUpe3ZhciB0PWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09dCYmISFlLmNoZWNrZWR8fCJvcHRpb24iPT09dCYmISFlLnNlbGVjdGVkfSxzZWxlY3RlZDpmdW5jdGlvbihlKXtyZXR1cm4gZS5wYXJlbnROb2RlJiZlLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCwhMD09PWUuc2VsZWN0ZWR9LGVtcHR5OmZ1bmN0aW9uKGUpe2ZvcihlPWUuZmlyc3RDaGlsZDtlO2U9ZS5uZXh0U2libGluZylpZihlLm5vZGVUeXBlPDYpcmV0dXJuITE7cmV0dXJuITB9LHBhcmVudDpmdW5jdGlvbihlKXtyZXR1cm4hci5wc2V1ZG9zLmVtcHR5KGUpfSxoZWFkZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIFkudGVzdChlLm5vZGVOYW1lKX0saW5wdXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIEcudGVzdChlLm5vZGVOYW1lKX0sYnV0dG9uOmZ1bmN0aW9uKGUpe3ZhciB0PWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09dCYmImJ1dHRvbiI9PT1lLnR5cGV8fCJidXR0b24iPT09dH0sdGV4dDpmdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4iaW5wdXQiPT09ZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpJiYidGV4dCI9PT1lLnR5cGUmJihudWxsPT0odD1lLmdldEF0dHJpYnV0ZSgidHlwZSIpKXx8InRleHQiPT09dC50b0xvd2VyQ2FzZSgpKX0sZmlyc3Q6aGUoZnVuY3Rpb24oKXtyZXR1cm5bMF19KSxsYXN0OmhlKGZ1bmN0aW9uKGUsdCl7cmV0dXJuW3QtMV19KSxlcTpoZShmdW5jdGlvbihlLHQsbil7cmV0dXJuW248MD9uK3Q6bl19KSxldmVuOmhlKGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTA7bjx0O24rPTIpZS5wdXNoKG4pO3JldHVybiBlfSksb2RkOmhlKGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTE7bjx0O24rPTIpZS5wdXNoKG4pO3JldHVybiBlfSksbHQ6aGUoZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcj1uPDA/bit0Om47LS1yPj0wOyllLnB1c2gocik7cmV0dXJuIGV9KSxndDpoZShmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPW48MD9uK3Q6bjsrK3I8dDspZS5wdXNoKHIpO3JldHVybiBlfSl9fSkucHNldWRvcy5udGg9ci5wc2V1ZG9zLmVxO2Zvcih0IGlue3JhZGlvOiEwLGNoZWNrYm94OiEwLGZpbGU6ITAscGFzc3dvcmQ6ITAsaW1hZ2U6ITB9KXIucHNldWRvc1t0XT1mZSh0KTtmb3IodCBpbntzdWJtaXQ6ITAscmVzZXQ6ITB9KXIucHNldWRvc1t0XT1wZSh0KTtmdW5jdGlvbiB5ZSgpe315ZS5wcm90b3R5cGU9ci5maWx0ZXJzPXIucHNldWRvcyxyLnNldEZpbHRlcnM9bmV3IHllLGE9b2UudG9rZW5pemU9ZnVuY3Rpb24oZSx0KXt2YXIgbixpLG8sYSxzLHUsbCxjPWtbZSsiICJdO2lmKGMpcmV0dXJuIHQ/MDpjLnNsaWNlKDApO3M9ZSx1PVtdLGw9ci5wcmVGaWx0ZXI7d2hpbGUocyl7biYmIShpPUYuZXhlYyhzKSl8fChpJiYocz1zLnNsaWNlKGlbMF0ubGVuZ3RoKXx8cyksdS5wdXNoKG89W10pKSxuPSExLChpPV8uZXhlYyhzKSkmJihuPWkuc2hpZnQoKSxvLnB1c2goe3ZhbHVlOm4sdHlwZTppWzBdLnJlcGxhY2UoQiwiICIpfSkscz1zLnNsaWNlKG4ubGVuZ3RoKSk7Zm9yKGEgaW4gci5maWx0ZXIpIShpPVZbYV0uZXhlYyhzKSl8fGxbYV0mJiEoaT1sW2FdKGkpKXx8KG49aS5zaGlmdCgpLG8ucHVzaCh7dmFsdWU6bix0eXBlOmEsbWF0Y2hlczppfSkscz1zLnNsaWNlKG4ubGVuZ3RoKSk7aWYoIW4pYnJlYWt9cmV0dXJuIHQ/cy5sZW5ndGg6cz9vZS5lcnJvcihlKTprKGUsdSkuc2xpY2UoMCl9O2Z1bmN0aW9uIHZlKGUpe2Zvcih2YXIgdD0wLG49ZS5sZW5ndGgscj0iIjt0PG47dCsrKXIrPWVbdF0udmFsdWU7cmV0dXJuIHJ9ZnVuY3Rpb24gbWUoZSx0LG4pe3ZhciByPXQuZGlyLGk9dC5uZXh0LG89aXx8cixhPW4mJiJwYXJlbnROb2RlIj09PW8scz1DKys7cmV0dXJuIHQuZmlyc3Q/ZnVuY3Rpb24odCxuLGkpe3doaWxlKHQ9dFtyXSlpZigxPT09dC5ub2RlVHlwZXx8YSlyZXR1cm4gZSh0LG4saSk7cmV0dXJuITF9OmZ1bmN0aW9uKHQsbix1KXt2YXIgbCxjLGYscD1bVCxzXTtpZih1KXt3aGlsZSh0PXRbcl0paWYoKDE9PT10Lm5vZGVUeXBlfHxhKSYmZSh0LG4sdSkpcmV0dXJuITB9ZWxzZSB3aGlsZSh0PXRbcl0paWYoMT09PXQubm9kZVR5cGV8fGEpaWYoZj10W2JdfHwodFtiXT17fSksYz1mW3QudW5pcXVlSURdfHwoZlt0LnVuaXF1ZUlEXT17fSksaSYmaT09PXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSl0PXRbcl18fHQ7ZWxzZXtpZigobD1jW29dKSYmbFswXT09PVQmJmxbMV09PT1zKXJldHVybiBwWzJdPWxbMl07aWYoY1tvXT1wLHBbMl09ZSh0LG4sdSkpcmV0dXJuITB9cmV0dXJuITF9fWZ1bmN0aW9uIHhlKGUpe3JldHVybiBlLmxlbmd0aD4xP2Z1bmN0aW9uKHQsbixyKXt2YXIgaT1lLmxlbmd0aDt3aGlsZShpLS0paWYoIWVbaV0odCxuLHIpKXJldHVybiExO3JldHVybiEwfTplWzBdfWZ1bmN0aW9uIGJlKGUsdCxuKXtmb3IodmFyIHI9MCxpPXQubGVuZ3RoO3I8aTtyKyspb2UoZSx0W3JdLG4pO3JldHVybiBufWZ1bmN0aW9uIHdlKGUsdCxuLHIsaSl7Zm9yKHZhciBvLGE9W10scz0wLHU9ZS5sZW5ndGgsbD1udWxsIT10O3M8dTtzKyspKG89ZVtzXSkmJihuJiYhbihvLHIsaSl8fChhLnB1c2gobyksbCYmdC5wdXNoKHMpKSk7cmV0dXJuIGF9ZnVuY3Rpb24gVGUoZSx0LG4scixpLG8pe3JldHVybiByJiYhcltiXSYmKHI9VGUocikpLGkmJiFpW2JdJiYoaT1UZShpLG8pKSxzZShmdW5jdGlvbihvLGEscyx1KXt2YXIgbCxjLGYscD1bXSxkPVtdLGg9YS5sZW5ndGgsZz1vfHxiZSh0fHwiKiIscy5ub2RlVHlwZT9bc106cyxbXSkseT0hZXx8IW8mJnQ/Zzp3ZShnLHAsZSxzLHUpLHY9bj9pfHwobz9lOmh8fHIpP1tdOmE6eTtpZihuJiZuKHksdixzLHUpLHIpe2w9d2UodixkKSxyKGwsW10scyx1KSxjPWwubGVuZ3RoO3doaWxlKGMtLSkoZj1sW2NdKSYmKHZbZFtjXV09ISh5W2RbY11dPWYpKX1pZihvKXtpZihpfHxlKXtpZihpKXtsPVtdLGM9di5sZW5ndGg7d2hpbGUoYy0tKShmPXZbY10pJiZsLnB1c2goeVtjXT1mKTtpKG51bGwsdj1bXSxsLHUpfWM9di5sZW5ndGg7d2hpbGUoYy0tKShmPXZbY10pJiYobD1pP08obyxmKTpwW2NdKT4tMSYmKG9bbF09IShhW2xdPWYpKX19ZWxzZSB2PXdlKHY9PT1hP3Yuc3BsaWNlKGgsdi5sZW5ndGgpOnYpLGk/aShudWxsLGEsdix1KTpMLmFwcGx5KGEsdil9KX1mdW5jdGlvbiBDZShlKXtmb3IodmFyIHQsbixpLG89ZS5sZW5ndGgsYT1yLnJlbGF0aXZlW2VbMF0udHlwZV0scz1hfHxyLnJlbGF0aXZlWyIgIl0sdT1hPzE6MCxjPW1lKGZ1bmN0aW9uKGUpe3JldHVybiBlPT09dH0scywhMCksZj1tZShmdW5jdGlvbihlKXtyZXR1cm4gTyh0LGUpPi0xfSxzLCEwKSxwPVtmdW5jdGlvbihlLG4scil7dmFyIGk9IWEmJihyfHxuIT09bCl8fCgodD1uKS5ub2RlVHlwZT9jKGUsbixyKTpmKGUsbixyKSk7cmV0dXJuIHQ9bnVsbCxpfV07dTxvO3UrKylpZihuPXIucmVsYXRpdmVbZVt1XS50eXBlXSlwPVttZSh4ZShwKSxuKV07ZWxzZXtpZigobj1yLmZpbHRlcltlW3VdLnR5cGVdLmFwcGx5KG51bGwsZVt1XS5tYXRjaGVzKSlbYl0pe2ZvcihpPSsrdTtpPG87aSsrKWlmKHIucmVsYXRpdmVbZVtpXS50eXBlXSlicmVhaztyZXR1cm4gVGUodT4xJiZ4ZShwKSx1PjEmJnZlKGUuc2xpY2UoMCx1LTEpLmNvbmNhdCh7dmFsdWU6IiAiPT09ZVt1LTJdLnR5cGU/IioiOiIifSkpLnJlcGxhY2UoQiwiJDEiKSxuLHU8aSYmQ2UoZS5zbGljZSh1LGkpKSxpPG8mJkNlKGU9ZS5zbGljZShpKSksaTxvJiZ2ZShlKSl9cC5wdXNoKG4pfXJldHVybiB4ZShwKX1mdW5jdGlvbiBFZShlLHQpe3ZhciBuPXQubGVuZ3RoPjAsaT1lLmxlbmd0aD4wLG89ZnVuY3Rpb24obyxhLHMsdSxjKXt2YXIgZixoLHksdj0wLG09IjAiLHg9byYmW10sYj1bXSx3PWwsQz1vfHxpJiZyLmZpbmQuVEFHKCIqIixjKSxFPVQrPW51bGw9PXc/MTpNYXRoLnJhbmRvbSgpfHwuMSxrPUMubGVuZ3RoO2ZvcihjJiYobD1hPT09ZHx8YXx8Yyk7bSE9PWsmJm51bGwhPShmPUNbbV0pO20rKyl7aWYoaSYmZil7aD0wLGF8fGYub3duZXJEb2N1bWVudD09PWR8fChwKGYpLHM9IWcpO3doaWxlKHk9ZVtoKytdKWlmKHkoZixhfHxkLHMpKXt1LnB1c2goZik7YnJlYWt9YyYmKFQ9RSl9biYmKChmPSF5JiZmKSYmdi0tLG8mJngucHVzaChmKSl9aWYodis9bSxuJiZtIT09dil7aD0wO3doaWxlKHk9dFtoKytdKXkoeCxiLGEscyk7aWYobyl7aWYodj4wKXdoaWxlKG0tLSl4W21dfHxiW21dfHwoYlttXT1qLmNhbGwodSkpO2I9d2UoYil9TC5hcHBseSh1LGIpLGMmJiFvJiZiLmxlbmd0aD4wJiZ2K3QubGVuZ3RoPjEmJm9lLnVuaXF1ZVNvcnQodSl9cmV0dXJuIGMmJihUPUUsbD13KSx4fTtyZXR1cm4gbj9zZShvKTpvfXJldHVybiBzPW9lLmNvbXBpbGU9ZnVuY3Rpb24oZSx0KXt2YXIgbixyPVtdLGk9W10sbz1TW2UrIiAiXTtpZighbyl7dHx8KHQ9YShlKSksbj10Lmxlbmd0aDt3aGlsZShuLS0pKG89Q2UodFtuXSkpW2JdP3IucHVzaChvKTppLnB1c2gobyk7KG89UyhlLEVlKGkscikpKS5zZWxlY3Rvcj1lfXJldHVybiBvfSx1PW9lLnNlbGVjdD1mdW5jdGlvbihlLHQsbixpKXt2YXIgbyx1LGwsYyxmLHA9ImZ1bmN0aW9uIj09dHlwZW9mIGUmJmUsZD0haSYmYShlPXAuc2VsZWN0b3J8fGUpO2lmKG49bnx8W10sMT09PWQubGVuZ3RoKXtpZigodT1kWzBdPWRbMF0uc2xpY2UoMCkpLmxlbmd0aD4yJiYiSUQiPT09KGw9dVswXSkudHlwZSYmOT09PXQubm9kZVR5cGUmJmcmJnIucmVsYXRpdmVbdVsxXS50eXBlXSl7aWYoISh0PShyLmZpbmQuSUQobC5tYXRjaGVzWzBdLnJlcGxhY2UoWixlZSksdCl8fFtdKVswXSkpcmV0dXJuIG47cCYmKHQ9dC5wYXJlbnROb2RlKSxlPWUuc2xpY2UodS5zaGlmdCgpLnZhbHVlLmxlbmd0aCl9bz1WLm5lZWRzQ29udGV4dC50ZXN0KGUpPzA6dS5sZW5ndGg7d2hpbGUoby0tKXtpZihsPXVbb10sci5yZWxhdGl2ZVtjPWwudHlwZV0pYnJlYWs7aWYoKGY9ci5maW5kW2NdKSYmKGk9ZihsLm1hdGNoZXNbMF0ucmVwbGFjZShaLGVlKSxLLnRlc3QodVswXS50eXBlKSYmZ2UodC5wYXJlbnROb2RlKXx8dCkpKXtpZih1LnNwbGljZShvLDEpLCEoZT1pLmxlbmd0aCYmdmUodSkpKXJldHVybiBMLmFwcGx5KG4saSksbjticmVha319fXJldHVybihwfHxzKGUsZCkpKGksdCwhZyxuLCF0fHxLLnRlc3QoZSkmJmdlKHQucGFyZW50Tm9kZSl8fHQpLG59LG4uc29ydFN0YWJsZT1iLnNwbGl0KCIiKS5zb3J0KEQpLmpvaW4oIiIpPT09YixuLmRldGVjdER1cGxpY2F0ZXM9ISFmLHAoKSxuLnNvcnREZXRhY2hlZD11ZShmdW5jdGlvbihlKXtyZXR1cm4gMSZlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGQuY3JlYXRlRWxlbWVudCgiZmllbGRzZXQiKSl9KSx1ZShmdW5jdGlvbihlKXtyZXR1cm4gZS5pbm5lckhUTUw9IjxhIGhyZWY9JyMnPjwvYT4iLCIjIj09PWUuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoImhyZWYiKX0pfHxsZSgidHlwZXxocmVmfGhlaWdodHx3aWR0aCIsZnVuY3Rpb24oZSx0LG4pe2lmKCFuKXJldHVybiBlLmdldEF0dHJpYnV0ZSh0LCJ0eXBlIj09PXQudG9Mb3dlckNhc2UoKT8xOjIpfSksbi5hdHRyaWJ1dGVzJiZ1ZShmdW5jdGlvbihlKXtyZXR1cm4gZS5pbm5lckhUTUw9IjxpbnB1dC8+IixlLmZpcnN0Q2hpbGQuc2V0QXR0cmlidXRlKCJ2YWx1ZSIsIiIpLCIiPT09ZS5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgidmFsdWUiKX0pfHxsZSgidmFsdWUiLGZ1bmN0aW9uKGUsdCxuKXtpZighbiYmImlucHV0Ij09PWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSlyZXR1cm4gZS5kZWZhdWx0VmFsdWV9KSx1ZShmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZS5nZXRBdHRyaWJ1dGUoImRpc2FibGVkIil9KXx8bGUoUCxmdW5jdGlvbihlLHQsbil7dmFyIHI7aWYoIW4pcmV0dXJuITA9PT1lW3RdP3QudG9Mb3dlckNhc2UoKToocj1lLmdldEF0dHJpYnV0ZU5vZGUodCkpJiZyLnNwZWNpZmllZD9yLnZhbHVlOm51bGx9KSxvZX0oZSk7dy5maW5kPUUsdy5leHByPUUuc2VsZWN0b3JzLHcuZXhwclsiOiJdPXcuZXhwci5wc2V1ZG9zLHcudW5pcXVlU29ydD13LnVuaXF1ZT1FLnVuaXF1ZVNvcnQsdy50ZXh0PUUuZ2V0VGV4dCx3LmlzWE1MRG9jPUUuaXNYTUwsdy5jb250YWlucz1FLmNvbnRhaW5zLHcuZXNjYXBlU2VsZWN0b3I9RS5lc2NhcGU7dmFyIGs9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPVtdLGk9dm9pZCAwIT09bjt3aGlsZSgoZT1lW3RdKSYmOSE9PWUubm9kZVR5cGUpaWYoMT09PWUubm9kZVR5cGUpe2lmKGkmJncoZSkuaXMobikpYnJlYWs7ci5wdXNoKGUpfXJldHVybiByfSxTPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPVtdO2U7ZT1lLm5leHRTaWJsaW5nKTE9PT1lLm5vZGVUeXBlJiZlIT09dCYmbi5wdXNoKGUpO3JldHVybiBufSxEPXcuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQ7ZnVuY3Rpb24gTihlLHQpe3JldHVybiBlLm5vZGVOYW1lJiZlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT10LnRvTG93ZXJDYXNlKCl9dmFyIEE9L148KFthLXpdW15cL1wwPjpceDIwXHRcclxuXGZdKilbXHgyMFx0XHJcblxmXSpcLz8+KD86PFwvXDE+fCkkL2k7ZnVuY3Rpb24gaihlLHQsbil7cmV0dXJuIGcodCk/dy5ncmVwKGUsZnVuY3Rpb24oZSxyKXtyZXR1cm4hIXQuY2FsbChlLHIsZSkhPT1ufSk6dC5ub2RlVHlwZT93LmdyZXAoZSxmdW5jdGlvbihlKXtyZXR1cm4gZT09PXQhPT1ufSk6InN0cmluZyIhPXR5cGVvZiB0P3cuZ3JlcChlLGZ1bmN0aW9uKGUpe3JldHVybiB1LmNhbGwodCxlKT4tMSE9PW59KTp3LmZpbHRlcih0LGUsbil9dy5maWx0ZXI9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPXRbMF07cmV0dXJuIG4mJihlPSI6bm90KCIrZSsiKSIpLDE9PT10Lmxlbmd0aCYmMT09PXIubm9kZVR5cGU/dy5maW5kLm1hdGNoZXNTZWxlY3RvcihyLGUpP1tyXTpbXTp3LmZpbmQubWF0Y2hlcyhlLHcuZ3JlcCh0LGZ1bmN0aW9uKGUpe3JldHVybiAxPT09ZS5ub2RlVHlwZX0pKX0sdy5mbi5leHRlbmQoe2ZpbmQ6ZnVuY3Rpb24oZSl7dmFyIHQsbixyPXRoaXMubGVuZ3RoLGk9dGhpcztpZigic3RyaW5nIiE9dHlwZW9mIGUpcmV0dXJuIHRoaXMucHVzaFN0YWNrKHcoZSkuZmlsdGVyKGZ1bmN0aW9uKCl7Zm9yKHQ9MDt0PHI7dCsrKWlmKHcuY29udGFpbnMoaVt0XSx0aGlzKSlyZXR1cm4hMH0pKTtmb3Iobj10aGlzLnB1c2hTdGFjayhbXSksdD0wO3Q8cjt0Kyspdy5maW5kKGUsaVt0XSxuKTtyZXR1cm4gcj4xP3cudW5pcXVlU29ydChuKTpufSxmaWx0ZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGoodGhpcyxlfHxbXSwhMSkpfSxub3Q6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGoodGhpcyxlfHxbXSwhMCkpfSxpczpmdW5jdGlvbihlKXtyZXR1cm4hIWoodGhpcywic3RyaW5nIj09dHlwZW9mIGUmJkQudGVzdChlKT93KGUpOmV8fFtdLCExKS5sZW5ndGh9fSk7dmFyIHEsTD0vXig/OlxzKig8W1x3XFddKz4pW14+XSp8IyhbXHctXSspKSQvOyh3LmZuLmluaXQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciBpLG87aWYoIWUpcmV0dXJuIHRoaXM7aWYobj1ufHxxLCJzdHJpbmciPT10eXBlb2YgZSl7aWYoIShpPSI8Ij09PWVbMF0mJiI+Ij09PWVbZS5sZW5ndGgtMV0mJmUubGVuZ3RoPj0zP1tudWxsLGUsbnVsbF06TC5leGVjKGUpKXx8IWlbMV0mJnQpcmV0dXJuIXR8fHQuanF1ZXJ5Pyh0fHxuKS5maW5kKGUpOnRoaXMuY29uc3RydWN0b3IodCkuZmluZChlKTtpZihpWzFdKXtpZih0PXQgaW5zdGFuY2VvZiB3P3RbMF06dCx3Lm1lcmdlKHRoaXMsdy5wYXJzZUhUTUwoaVsxXSx0JiZ0Lm5vZGVUeXBlP3Qub3duZXJEb2N1bWVudHx8dDpyLCEwKSksQS50ZXN0KGlbMV0pJiZ3LmlzUGxhaW5PYmplY3QodCkpZm9yKGkgaW4gdClnKHRoaXNbaV0pP3RoaXNbaV0odFtpXSk6dGhpcy5hdHRyKGksdFtpXSk7cmV0dXJuIHRoaXN9cmV0dXJuKG89ci5nZXRFbGVtZW50QnlJZChpWzJdKSkmJih0aGlzWzBdPW8sdGhpcy5sZW5ndGg9MSksdGhpc31yZXR1cm4gZS5ub2RlVHlwZT8odGhpc1swXT1lLHRoaXMubGVuZ3RoPTEsdGhpcyk6ZyhlKT92b2lkIDAhPT1uLnJlYWR5P24ucmVhZHkoZSk6ZSh3KTp3Lm1ha2VBcnJheShlLHRoaXMpfSkucHJvdG90eXBlPXcuZm4scT13KHIpO3ZhciBIPS9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLE89e2NoaWxkcmVuOiEwLGNvbnRlbnRzOiEwLG5leHQ6ITAscHJldjohMH07dy5mbi5leHRlbmQoe2hhczpmdW5jdGlvbihlKXt2YXIgdD13KGUsdGhpcyksbj10Lmxlbmd0aDtyZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oKXtmb3IodmFyIGU9MDtlPG47ZSsrKWlmKHcuY29udGFpbnModGhpcyx0W2VdKSlyZXR1cm4hMH0pfSxjbG9zZXN0OmZ1bmN0aW9uKGUsdCl7dmFyIG4scj0wLGk9dGhpcy5sZW5ndGgsbz1bXSxhPSJzdHJpbmciIT10eXBlb2YgZSYmdyhlKTtpZighRC50ZXN0KGUpKWZvcig7cjxpO3IrKylmb3Iobj10aGlzW3JdO24mJm4hPT10O249bi5wYXJlbnROb2RlKWlmKG4ubm9kZVR5cGU8MTEmJihhP2EuaW5kZXgobik+LTE6MT09PW4ubm9kZVR5cGUmJncuZmluZC5tYXRjaGVzU2VsZWN0b3IobixlKSkpe28ucHVzaChuKTticmVha31yZXR1cm4gdGhpcy5wdXNoU3RhY2soby5sZW5ndGg+MT93LnVuaXF1ZVNvcnQobyk6byl9LGluZGV4OmZ1bmN0aW9uKGUpe3JldHVybiBlPyJzdHJpbmciPT10eXBlb2YgZT91LmNhbGwodyhlKSx0aGlzWzBdKTp1LmNhbGwodGhpcyxlLmpxdWVyeT9lWzBdOmUpOnRoaXNbMF0mJnRoaXNbMF0ucGFyZW50Tm9kZT90aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aDotMX0sYWRkOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHcudW5pcXVlU29ydCh3Lm1lcmdlKHRoaXMuZ2V0KCksdyhlLHQpKSkpfSxhZGRCYWNrOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmFkZChudWxsPT1lP3RoaXMucHJldk9iamVjdDp0aGlzLnByZXZPYmplY3QuZmlsdGVyKGUpKX19KTtmdW5jdGlvbiBQKGUsdCl7d2hpbGUoKGU9ZVt0XSkmJjEhPT1lLm5vZGVUeXBlKTtyZXR1cm4gZX13LmVhY2goe3BhcmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLnBhcmVudE5vZGU7cmV0dXJuIHQmJjExIT09dC5ub2RlVHlwZT90Om51bGx9LHBhcmVudHM6ZnVuY3Rpb24oZSl7cmV0dXJuIGsoZSwicGFyZW50Tm9kZSIpfSxwYXJlbnRzVW50aWw6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBrKGUsInBhcmVudE5vZGUiLG4pfSxuZXh0OmZ1bmN0aW9uKGUpe3JldHVybiBQKGUsIm5leHRTaWJsaW5nIil9LHByZXY6ZnVuY3Rpb24oZSl7cmV0dXJuIFAoZSwicHJldmlvdXNTaWJsaW5nIil9LG5leHRBbGw6ZnVuY3Rpb24oZSl7cmV0dXJuIGsoZSwibmV4dFNpYmxpbmciKX0scHJldkFsbDpmdW5jdGlvbihlKXtyZXR1cm4gayhlLCJwcmV2aW91c1NpYmxpbmciKX0sbmV4dFVudGlsOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gayhlLCJuZXh0U2libGluZyIsbil9LHByZXZVbnRpbDpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGsoZSwicHJldmlvdXNTaWJsaW5nIixuKX0sc2libGluZ3M6ZnVuY3Rpb24oZSl7cmV0dXJuIFMoKGUucGFyZW50Tm9kZXx8e30pLmZpcnN0Q2hpbGQsZSl9LGNoaWxkcmVuOmZ1bmN0aW9uKGUpe3JldHVybiBTKGUuZmlyc3RDaGlsZCl9LGNvbnRlbnRzOmZ1bmN0aW9uKGUpe3JldHVybiBOKGUsImlmcmFtZSIpP2UuY29udGVudERvY3VtZW50OihOKGUsInRlbXBsYXRlIikmJihlPWUuY29udGVudHx8ZSksdy5tZXJnZShbXSxlLmNoaWxkTm9kZXMpKX19LGZ1bmN0aW9uKGUsdCl7dy5mbltlXT1mdW5jdGlvbihuLHIpe3ZhciBpPXcubWFwKHRoaXMsdCxuKTtyZXR1cm4iVW50aWwiIT09ZS5zbGljZSgtNSkmJihyPW4pLHImJiJzdHJpbmciPT10eXBlb2YgciYmKGk9dy5maWx0ZXIocixpKSksdGhpcy5sZW5ndGg+MSYmKE9bZV18fHcudW5pcXVlU29ydChpKSxILnRlc3QoZSkmJmkucmV2ZXJzZSgpKSx0aGlzLnB1c2hTdGFjayhpKX19KTt2YXIgTT0vW15ceDIwXHRcclxuXGZdKy9nO2Z1bmN0aW9uIFIoZSl7dmFyIHQ9e307cmV0dXJuIHcuZWFjaChlLm1hdGNoKE0pfHxbXSxmdW5jdGlvbihlLG4pe3Rbbl09ITB9KSx0fXcuQ2FsbGJhY2tzPWZ1bmN0aW9uKGUpe2U9InN0cmluZyI9PXR5cGVvZiBlP1IoZSk6dy5leHRlbmQoe30sZSk7dmFyIHQsbixyLGksbz1bXSxhPVtdLHM9LTEsdT1mdW5jdGlvbigpe2ZvcihpPWl8fGUub25jZSxyPXQ9ITA7YS5sZW5ndGg7cz0tMSl7bj1hLnNoaWZ0KCk7d2hpbGUoKytzPG8ubGVuZ3RoKSExPT09b1tzXS5hcHBseShuWzBdLG5bMV0pJiZlLnN0b3BPbkZhbHNlJiYocz1vLmxlbmd0aCxuPSExKX1lLm1lbW9yeXx8KG49ITEpLHQ9ITEsaSYmKG89bj9bXToiIil9LGw9e2FkZDpmdW5jdGlvbigpe3JldHVybiBvJiYobiYmIXQmJihzPW8ubGVuZ3RoLTEsYS5wdXNoKG4pKSxmdW5jdGlvbiB0KG4pe3cuZWFjaChuLGZ1bmN0aW9uKG4scil7ZyhyKT9lLnVuaXF1ZSYmbC5oYXMocil8fG8ucHVzaChyKTpyJiZyLmxlbmd0aCYmInN0cmluZyIhPT14KHIpJiZ0KHIpfSl9KGFyZ3VtZW50cyksbiYmIXQmJnUoKSksdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIHcuZWFjaChhcmd1bWVudHMsZnVuY3Rpb24oZSx0KXt2YXIgbjt3aGlsZSgobj13LmluQXJyYXkodCxvLG4pKT4tMSlvLnNwbGljZShuLDEpLG48PXMmJnMtLX0pLHRoaXN9LGhhczpmdW5jdGlvbihlKXtyZXR1cm4gZT93LmluQXJyYXkoZSxvKT4tMTpvLmxlbmd0aD4wfSxlbXB0eTpmdW5jdGlvbigpe3JldHVybiBvJiYobz1bXSksdGhpc30sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiBpPWE9W10sbz1uPSIiLHRoaXN9LGRpc2FibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIW99LGxvY2s6ZnVuY3Rpb24oKXtyZXR1cm4gaT1hPVtdLG58fHR8fChvPW49IiIpLHRoaXN9LGxvY2tlZDpmdW5jdGlvbigpe3JldHVybiEhaX0sZmlyZVdpdGg6ZnVuY3Rpb24oZSxuKXtyZXR1cm4gaXx8KG49W2UsKG49bnx8W10pLnNsaWNlP24uc2xpY2UoKTpuXSxhLnB1c2gobiksdHx8dSgpKSx0aGlzfSxmaXJlOmZ1bmN0aW9uKCl7cmV0dXJuIGwuZmlyZVdpdGgodGhpcyxhcmd1bWVudHMpLHRoaXN9LGZpcmVkOmZ1bmN0aW9uKCl7cmV0dXJuISFyfX07cmV0dXJuIGx9O2Z1bmN0aW9uIEkoZSl7cmV0dXJuIGV9ZnVuY3Rpb24gVyhlKXt0aHJvdyBlfWZ1bmN0aW9uICQoZSx0LG4scil7dmFyIGk7dHJ5e2UmJmcoaT1lLnByb21pc2UpP2kuY2FsbChlKS5kb25lKHQpLmZhaWwobik6ZSYmZyhpPWUudGhlbik/aS5jYWxsKGUsdCxuKTp0LmFwcGx5KHZvaWQgMCxbZV0uc2xpY2UocikpfWNhdGNoKGUpe24uYXBwbHkodm9pZCAwLFtlXSl9fXcuZXh0ZW5kKHtEZWZlcnJlZDpmdW5jdGlvbih0KXt2YXIgbj1bWyJub3RpZnkiLCJwcm9ncmVzcyIsdy5DYWxsYmFja3MoIm1lbW9yeSIpLHcuQ2FsbGJhY2tzKCJtZW1vcnkiKSwyXSxbInJlc29sdmUiLCJkb25lIix3LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSx3LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwwLCJyZXNvbHZlZCJdLFsicmVqZWN0IiwiZmFpbCIsdy5DYWxsYmFja3MoIm9uY2UgbWVtb3J5Iiksdy5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksMSwicmVqZWN0ZWQiXV0scj0icGVuZGluZyIsaT17c3RhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gcn0sYWx3YXlzOmZ1bmN0aW9uKCl7cmV0dXJuIG8uZG9uZShhcmd1bWVudHMpLmZhaWwoYXJndW1lbnRzKSx0aGlzfSwiY2F0Y2giOmZ1bmN0aW9uKGUpe3JldHVybiBpLnRoZW4obnVsbCxlKX0scGlwZTpmdW5jdGlvbigpe3ZhciBlPWFyZ3VtZW50cztyZXR1cm4gdy5EZWZlcnJlZChmdW5jdGlvbih0KXt3LmVhY2gobixmdW5jdGlvbihuLHIpe3ZhciBpPWcoZVtyWzRdXSkmJmVbcls0XV07b1tyWzFdXShmdW5jdGlvbigpe3ZhciBlPWkmJmkuYXBwbHkodGhpcyxhcmd1bWVudHMpO2UmJmcoZS5wcm9taXNlKT9lLnByb21pc2UoKS5wcm9ncmVzcyh0Lm5vdGlmeSkuZG9uZSh0LnJlc29sdmUpLmZhaWwodC5yZWplY3QpOnRbclswXSsiV2l0aCJdKHRoaXMsaT9bZV06YXJndW1lbnRzKX0pfSksZT1udWxsfSkucHJvbWlzZSgpfSx0aGVuOmZ1bmN0aW9uKHQscixpKXt2YXIgbz0wO2Z1bmN0aW9uIGEodCxuLHIsaSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHM9dGhpcyx1PWFyZ3VtZW50cyxsPWZ1bmN0aW9uKCl7dmFyIGUsbDtpZighKHQ8bykpe2lmKChlPXIuYXBwbHkocyx1KSk9PT1uLnByb21pc2UoKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJUaGVuYWJsZSBzZWxmLXJlc29sdXRpb24iKTtsPWUmJigib2JqZWN0Ij09dHlwZW9mIGV8fCJmdW5jdGlvbiI9PXR5cGVvZiBlKSYmZS50aGVuLGcobCk/aT9sLmNhbGwoZSxhKG8sbixJLGkpLGEobyxuLFcsaSkpOihvKyssbC5jYWxsKGUsYShvLG4sSSxpKSxhKG8sbixXLGkpLGEobyxuLEksbi5ub3RpZnlXaXRoKSkpOihyIT09SSYmKHM9dm9pZCAwLHU9W2VdKSwoaXx8bi5yZXNvbHZlV2l0aCkocyx1KSl9fSxjPWk/bDpmdW5jdGlvbigpe3RyeXtsKCl9Y2F0Y2goZSl7dy5EZWZlcnJlZC5leGNlcHRpb25Ib29rJiZ3LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2soZSxjLnN0YWNrVHJhY2UpLHQrMT49byYmKHIhPT1XJiYocz12b2lkIDAsdT1bZV0pLG4ucmVqZWN0V2l0aChzLHUpKX19O3Q/YygpOih3LkRlZmVycmVkLmdldFN0YWNrSG9vayYmKGMuc3RhY2tUcmFjZT13LkRlZmVycmVkLmdldFN0YWNrSG9vaygpKSxlLnNldFRpbWVvdXQoYykpfX1yZXR1cm4gdy5EZWZlcnJlZChmdW5jdGlvbihlKXtuWzBdWzNdLmFkZChhKDAsZSxnKGkpP2k6SSxlLm5vdGlmeVdpdGgpKSxuWzFdWzNdLmFkZChhKDAsZSxnKHQpP3Q6SSkpLG5bMl1bM10uYWRkKGEoMCxlLGcocik/cjpXKSl9KS5wcm9taXNlKCl9LHByb21pc2U6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWU/dy5leHRlbmQoZSxpKTppfX0sbz17fTtyZXR1cm4gdy5lYWNoKG4sZnVuY3Rpb24oZSx0KXt2YXIgYT10WzJdLHM9dFs1XTtpW3RbMV1dPWEuYWRkLHMmJmEuYWRkKGZ1bmN0aW9uKCl7cj1zfSxuWzMtZV1bMl0uZGlzYWJsZSxuWzMtZV1bM10uZGlzYWJsZSxuWzBdWzJdLmxvY2ssblswXVszXS5sb2NrKSxhLmFkZCh0WzNdLmZpcmUpLG9bdFswXV09ZnVuY3Rpb24oKXtyZXR1cm4gb1t0WzBdKyJXaXRoIl0odGhpcz09PW8/dm9pZCAwOnRoaXMsYXJndW1lbnRzKSx0aGlzfSxvW3RbMF0rIldpdGgiXT1hLmZpcmVXaXRofSksaS5wcm9taXNlKG8pLHQmJnQuY2FsbChvLG8pLG99LHdoZW46ZnVuY3Rpb24oZSl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aCxuPXQscj1BcnJheShuKSxpPW8uY2FsbChhcmd1bWVudHMpLGE9dy5EZWZlcnJlZCgpLHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKG4pe3JbZV09dGhpcyxpW2VdPWFyZ3VtZW50cy5sZW5ndGg+MT9vLmNhbGwoYXJndW1lbnRzKTpuLC0tdHx8YS5yZXNvbHZlV2l0aChyLGkpfX07aWYodDw9MSYmKCQoZSxhLmRvbmUocyhuKSkucmVzb2x2ZSxhLnJlamVjdCwhdCksInBlbmRpbmciPT09YS5zdGF0ZSgpfHxnKGlbbl0mJmlbbl0udGhlbikpKXJldHVybiBhLnRoZW4oKTt3aGlsZShuLS0pJChpW25dLHMobiksYS5yZWplY3QpO3JldHVybiBhLnByb21pc2UoKX19KTt2YXIgQj0vXihFdmFsfEludGVybmFsfFJhbmdlfFJlZmVyZW5jZXxTeW50YXh8VHlwZXxVUkkpRXJyb3IkLzt3LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2s9ZnVuY3Rpb24odCxuKXtlLmNvbnNvbGUmJmUuY29uc29sZS53YXJuJiZ0JiZCLnRlc3QodC5uYW1lKSYmZS5jb25zb2xlLndhcm4oImpRdWVyeS5EZWZlcnJlZCBleGNlcHRpb246ICIrdC5tZXNzYWdlLHQuc3RhY2ssbil9LHcucmVhZHlFeGNlcHRpb249ZnVuY3Rpb24odCl7ZS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dGhyb3cgdH0pfTt2YXIgRj13LkRlZmVycmVkKCk7dy5mbi5yZWFkeT1mdW5jdGlvbihlKXtyZXR1cm4gRi50aGVuKGUpWyJjYXRjaCJdKGZ1bmN0aW9uKGUpe3cucmVhZHlFeGNlcHRpb24oZSl9KSx0aGlzfSx3LmV4dGVuZCh7aXNSZWFkeTohMSxyZWFkeVdhaXQ6MSxyZWFkeTpmdW5jdGlvbihlKXsoITA9PT1lPy0tdy5yZWFkeVdhaXQ6dy5pc1JlYWR5KXx8KHcuaXNSZWFkeT0hMCwhMCE9PWUmJi0tdy5yZWFkeVdhaXQ+MHx8Ri5yZXNvbHZlV2l0aChyLFt3XSkpfX0pLHcucmVhZHkudGhlbj1GLnRoZW47ZnVuY3Rpb24gXygpe3IucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsXyksZS5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixfKSx3LnJlYWR5KCl9ImNvbXBsZXRlIj09PXIucmVhZHlTdGF0ZXx8ImxvYWRpbmciIT09ci5yZWFkeVN0YXRlJiYhci5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGw/ZS5zZXRUaW1lb3V0KHcucmVhZHkpOihyLmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLF8pLGUuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsXykpO3ZhciB6PWZ1bmN0aW9uKGUsdCxuLHIsaSxvLGEpe3ZhciBzPTAsdT1lLmxlbmd0aCxsPW51bGw9PW47aWYoIm9iamVjdCI9PT14KG4pKXtpPSEwO2ZvcihzIGluIG4peihlLHQscyxuW3NdLCEwLG8sYSl9ZWxzZSBpZih2b2lkIDAhPT1yJiYoaT0hMCxnKHIpfHwoYT0hMCksbCYmKGE/KHQuY2FsbChlLHIpLHQ9bnVsbCk6KGw9dCx0PWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gbC5jYWxsKHcoZSksbil9KSksdCkpZm9yKDtzPHU7cysrKXQoZVtzXSxuLGE/cjpyLmNhbGwoZVtzXSxzLHQoZVtzXSxuKSkpO3JldHVybiBpP2U6bD90LmNhbGwoZSk6dT90KGVbMF0sbik6b30sWD0vXi1tcy0vLFU9Ly0oW2Etel0pL2c7ZnVuY3Rpb24gVihlLHQpe3JldHVybiB0LnRvVXBwZXJDYXNlKCl9ZnVuY3Rpb24gRyhlKXtyZXR1cm4gZS5yZXBsYWNlKFgsIm1zLSIpLnJlcGxhY2UoVSxWKX12YXIgWT1mdW5jdGlvbihlKXtyZXR1cm4gMT09PWUubm9kZVR5cGV8fDk9PT1lLm5vZGVUeXBlfHwhK2Uubm9kZVR5cGV9O2Z1bmN0aW9uIFEoKXt0aGlzLmV4cGFuZG89dy5leHBhbmRvK1EudWlkKyt9US51aWQ9MSxRLnByb3RvdHlwZT17Y2FjaGU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZVt0aGlzLmV4cGFuZG9dO3JldHVybiB0fHwodD17fSxZKGUpJiYoZS5ub2RlVHlwZT9lW3RoaXMuZXhwYW5kb109dDpPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0aGlzLmV4cGFuZG8se3ZhbHVlOnQsY29uZmlndXJhYmxlOiEwfSkpKSx0fSxzZXQ6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGk9dGhpcy5jYWNoZShlKTtpZigic3RyaW5nIj09dHlwZW9mIHQpaVtHKHQpXT1uO2Vsc2UgZm9yKHIgaW4gdClpW0cocildPXRbcl07cmV0dXJuIGl9LGdldDpmdW5jdGlvbihlLHQpe3JldHVybiB2b2lkIDA9PT10P3RoaXMuY2FjaGUoZSk6ZVt0aGlzLmV4cGFuZG9dJiZlW3RoaXMuZXhwYW5kb11bRyh0KV19LGFjY2VzczpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHZvaWQgMD09PXR8fHQmJiJzdHJpbmciPT10eXBlb2YgdCYmdm9pZCAwPT09bj90aGlzLmdldChlLHQpOih0aGlzLnNldChlLHQsbiksdm9pZCAwIT09bj9uOnQpfSxyZW1vdmU6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPWVbdGhpcy5leHBhbmRvXTtpZih2b2lkIDAhPT1yKXtpZih2b2lkIDAhPT10KXtuPSh0PUFycmF5LmlzQXJyYXkodCk/dC5tYXAoRyk6KHQ9Ryh0KSlpbiByP1t0XTp0Lm1hdGNoKE0pfHxbXSkubGVuZ3RoO3doaWxlKG4tLSlkZWxldGUgclt0W25dXX0odm9pZCAwPT09dHx8dy5pc0VtcHR5T2JqZWN0KHIpKSYmKGUubm9kZVR5cGU/ZVt0aGlzLmV4cGFuZG9dPXZvaWQgMDpkZWxldGUgZVt0aGlzLmV4cGFuZG9dKX19LGhhc0RhdGE6ZnVuY3Rpb24oZSl7dmFyIHQ9ZVt0aGlzLmV4cGFuZG9dO3JldHVybiB2b2lkIDAhPT10JiYhdy5pc0VtcHR5T2JqZWN0KHQpfX07dmFyIEo9bmV3IFEsSz1uZXcgUSxaPS9eKD86XHtbXHdcV10qXH18XFtbXHdcV10qXF0pJC8sZWU9L1tBLVpdL2c7ZnVuY3Rpb24gdGUoZSl7cmV0dXJuInRydWUiPT09ZXx8ImZhbHNlIiE9PWUmJigibnVsbCI9PT1lP251bGw6ZT09PStlKyIiPytlOloudGVzdChlKT9KU09OLnBhcnNlKGUpOmUpfWZ1bmN0aW9uIG5lKGUsdCxuKXt2YXIgcjtpZih2b2lkIDA9PT1uJiYxPT09ZS5ub2RlVHlwZSlpZihyPSJkYXRhLSIrdC5yZXBsYWNlKGVlLCItJCYiKS50b0xvd2VyQ2FzZSgpLCJzdHJpbmciPT10eXBlb2Yobj1lLmdldEF0dHJpYnV0ZShyKSkpe3RyeXtuPXRlKG4pfWNhdGNoKGUpe31LLnNldChlLHQsbil9ZWxzZSBuPXZvaWQgMDtyZXR1cm4gbn13LmV4dGVuZCh7aGFzRGF0YTpmdW5jdGlvbihlKXtyZXR1cm4gSy5oYXNEYXRhKGUpfHxKLmhhc0RhdGEoZSl9LGRhdGE6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBLLmFjY2VzcyhlLHQsbil9LHJlbW92ZURhdGE6ZnVuY3Rpb24oZSx0KXtLLnJlbW92ZShlLHQpfSxfZGF0YTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIEouYWNjZXNzKGUsdCxuKX0sX3JlbW92ZURhdGE6ZnVuY3Rpb24oZSx0KXtKLnJlbW92ZShlLHQpfX0pLHcuZm4uZXh0ZW5kKHtkYXRhOmZ1bmN0aW9uKGUsdCl7dmFyIG4scixpLG89dGhpc1swXSxhPW8mJm8uYXR0cmlidXRlcztpZih2b2lkIDA9PT1lKXtpZih0aGlzLmxlbmd0aCYmKGk9Sy5nZXQobyksMT09PW8ubm9kZVR5cGUmJiFKLmdldChvLCJoYXNEYXRhQXR0cnMiKSkpe249YS5sZW5ndGg7d2hpbGUobi0tKWFbbl0mJjA9PT0ocj1hW25dLm5hbWUpLmluZGV4T2YoImRhdGEtIikmJihyPUcoci5zbGljZSg1KSksbmUobyxyLGlbcl0pKTtKLnNldChvLCJoYXNEYXRhQXR0cnMiLCEwKX1yZXR1cm4gaX1yZXR1cm4ib2JqZWN0Ij09dHlwZW9mIGU/dGhpcy5lYWNoKGZ1bmN0aW9uKCl7Sy5zZXQodGhpcyxlKX0pOnoodGhpcyxmdW5jdGlvbih0KXt2YXIgbjtpZihvJiZ2b2lkIDA9PT10KXtpZih2b2lkIDAhPT0obj1LLmdldChvLGUpKSlyZXR1cm4gbjtpZih2b2lkIDAhPT0obj1uZShvLGUpKSlyZXR1cm4gbn1lbHNlIHRoaXMuZWFjaChmdW5jdGlvbigpe0suc2V0KHRoaXMsZSx0KX0pfSxudWxsLHQsYXJndW1lbnRzLmxlbmd0aD4xLG51bGwsITApfSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtLLnJlbW92ZSh0aGlzLGUpfSl9fSksdy5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcjtpZihlKXJldHVybiB0PSh0fHwiZngiKSsicXVldWUiLHI9Si5nZXQoZSx0KSxuJiYoIXJ8fEFycmF5LmlzQXJyYXkobik/cj1KLmFjY2VzcyhlLHQsdy5tYWtlQXJyYXkobikpOnIucHVzaChuKSkscnx8W119LGRlcXVldWU6ZnVuY3Rpb24oZSx0KXt0PXR8fCJmeCI7dmFyIG49dy5xdWV1ZShlLHQpLHI9bi5sZW5ndGgsaT1uLnNoaWZ0KCksbz13Ll9xdWV1ZUhvb2tzKGUsdCksYT1mdW5jdGlvbigpe3cuZGVxdWV1ZShlLHQpfTsiaW5wcm9ncmVzcyI9PT1pJiYoaT1uLnNoaWZ0KCksci0tKSxpJiYoImZ4Ij09PXQmJm4udW5zaGlmdCgiaW5wcm9ncmVzcyIpLGRlbGV0ZSBvLnN0b3AsaS5jYWxsKGUsYSxvKSksIXImJm8mJm8uZW1wdHkuZmlyZSgpfSxfcXVldWVIb29rczpmdW5jdGlvbihlLHQpe3ZhciBuPXQrInF1ZXVlSG9va3MiO3JldHVybiBKLmdldChlLG4pfHxKLmFjY2VzcyhlLG4se2VtcHR5OncuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLmFkZChmdW5jdGlvbigpe0oucmVtb3ZlKGUsW3QrInF1ZXVlIixuXSl9KX0pfX0pLHcuZm4uZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPTI7cmV0dXJuInN0cmluZyIhPXR5cGVvZiBlJiYodD1lLGU9ImZ4IixuLS0pLGFyZ3VtZW50cy5sZW5ndGg8bj93LnF1ZXVlKHRoaXNbMF0sZSk6dm9pZCAwPT09dD90aGlzOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBuPXcucXVldWUodGhpcyxlLHQpO3cuX3F1ZXVlSG9va3ModGhpcyxlKSwiZngiPT09ZSYmImlucHJvZ3Jlc3MiIT09blswXSYmdy5kZXF1ZXVlKHRoaXMsZSl9KX0sZGVxdWV1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dy5kZXF1ZXVlKHRoaXMsZSl9KX0sY2xlYXJRdWV1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5xdWV1ZShlfHwiZngiLFtdKX0scHJvbWlzZTpmdW5jdGlvbihlLHQpe3ZhciBuLHI9MSxpPXcuRGVmZXJyZWQoKSxvPXRoaXMsYT10aGlzLmxlbmd0aCxzPWZ1bmN0aW9uKCl7LS1yfHxpLnJlc29sdmVXaXRoKG8sW29dKX07InN0cmluZyIhPXR5cGVvZiBlJiYodD1lLGU9dm9pZCAwKSxlPWV8fCJmeCI7d2hpbGUoYS0tKShuPUouZ2V0KG9bYV0sZSsicXVldWVIb29rcyIpKSYmbi5lbXB0eSYmKHIrKyxuLmVtcHR5LmFkZChzKSk7cmV0dXJuIHMoKSxpLnByb21pc2UodCl9fSk7dmFyIHJlPS9bKy1dPyg/OlxkKlwufClcZCsoPzpbZUVdWystXT9cZCt8KS8uc291cmNlLGllPW5ldyBSZWdFeHAoIl4oPzooWystXSk9fCkoIityZSsiKShbYS16JV0qKSQiLCJpIiksb2U9WyJUb3AiLCJSaWdodCIsIkJvdHRvbSIsIkxlZnQiXSxhZT1mdW5jdGlvbihlLHQpe3JldHVybiJub25lIj09PShlPXR8fGUpLnN0eWxlLmRpc3BsYXl8fCIiPT09ZS5zdHlsZS5kaXNwbGF5JiZ3LmNvbnRhaW5zKGUub3duZXJEb2N1bWVudCxlKSYmIm5vbmUiPT09dy5jc3MoZSwiZGlzcGxheSIpfSxzZT1mdW5jdGlvbihlLHQsbixyKXt2YXIgaSxvLGE9e307Zm9yKG8gaW4gdClhW29dPWUuc3R5bGVbb10sZS5zdHlsZVtvXT10W29dO2k9bi5hcHBseShlLHJ8fFtdKTtmb3IobyBpbiB0KWUuc3R5bGVbb109YVtvXTtyZXR1cm4gaX07ZnVuY3Rpb24gdWUoZSx0LG4scil7dmFyIGksbyxhPTIwLHM9cj9mdW5jdGlvbigpe3JldHVybiByLmN1cigpfTpmdW5jdGlvbigpe3JldHVybiB3LmNzcyhlLHQsIiIpfSx1PXMoKSxsPW4mJm5bM118fCh3LmNzc051bWJlclt0XT8iIjoicHgiKSxjPSh3LmNzc051bWJlclt0XXx8InB4IiE9PWwmJit1KSYmaWUuZXhlYyh3LmNzcyhlLHQpKTtpZihjJiZjWzNdIT09bCl7dS89MixsPWx8fGNbM10sYz0rdXx8MTt3aGlsZShhLS0pdy5zdHlsZShlLHQsYytsKSwoMS1vKSooMS0obz1zKCkvdXx8LjUpKTw9MCYmKGE9MCksYy89bztjKj0yLHcuc3R5bGUoZSx0LGMrbCksbj1ufHxbXX1yZXR1cm4gbiYmKGM9K2N8fCt1fHwwLGk9blsxXT9jKyhuWzFdKzEpKm5bMl06K25bMl0sciYmKHIudW5pdD1sLHIuc3RhcnQ9YyxyLmVuZD1pKSksaX12YXIgbGU9e307ZnVuY3Rpb24gY2UoZSl7dmFyIHQsbj1lLm93bmVyRG9jdW1lbnQscj1lLm5vZGVOYW1lLGk9bGVbcl07cmV0dXJuIGl8fCh0PW4uYm9keS5hcHBlbmRDaGlsZChuLmNyZWF0ZUVsZW1lbnQocikpLGk9dy5jc3ModCwiZGlzcGxheSIpLHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KSwibm9uZSI9PT1pJiYoaT0iYmxvY2siKSxsZVtyXT1pLGkpfWZ1bmN0aW9uIGZlKGUsdCl7Zm9yKHZhciBuLHIsaT1bXSxvPTAsYT1lLmxlbmd0aDtvPGE7bysrKShyPWVbb10pLnN0eWxlJiYobj1yLnN0eWxlLmRpc3BsYXksdD8oIm5vbmUiPT09biYmKGlbb109Si5nZXQociwiZGlzcGxheSIpfHxudWxsLGlbb118fChyLnN0eWxlLmRpc3BsYXk9IiIpKSwiIj09PXIuc3R5bGUuZGlzcGxheSYmYWUocikmJihpW29dPWNlKHIpKSk6Im5vbmUiIT09biYmKGlbb109Im5vbmUiLEouc2V0KHIsImRpc3BsYXkiLG4pKSk7Zm9yKG89MDtvPGE7bysrKW51bGwhPWlbb10mJihlW29dLnN0eWxlLmRpc3BsYXk9aVtvXSk7cmV0dXJuIGV9dy5mbi5leHRlbmQoe3Nob3c6ZnVuY3Rpb24oKXtyZXR1cm4gZmUodGhpcywhMCl9LGhpZGU6ZnVuY3Rpb24oKXtyZXR1cm4gZmUodGhpcyl9LHRvZ2dsZTpmdW5jdGlvbihlKXtyZXR1cm4iYm9vbGVhbiI9PXR5cGVvZiBlP2U/dGhpcy5zaG93KCk6dGhpcy5oaWRlKCk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7YWUodGhpcyk/dyh0aGlzKS5zaG93KCk6dyh0aGlzKS5oaWRlKCl9KX19KTt2YXIgcGU9L14oPzpjaGVja2JveHxyYWRpbykkL2ksZGU9LzwoW2Etel1bXlwvXDA+XHgyMFx0XHJcblxmXSspL2ksaGU9L14kfF5tb2R1bGUkfFwvKD86amF2YXxlY21hKXNjcmlwdC9pLGdlPXtvcHRpb246WzEsIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz4iLCI8L3NlbGVjdD4iXSx0aGVhZDpbMSwiPHRhYmxlPiIsIjwvdGFibGU+Il0sY29sOlsyLCI8dGFibGU+PGNvbGdyb3VwPiIsIjwvY29sZ3JvdXA+PC90YWJsZT4iXSx0cjpbMiwiPHRhYmxlPjx0Ym9keT4iLCI8L3Rib2R5PjwvdGFibGU+Il0sdGQ6WzMsIjx0YWJsZT48dGJvZHk+PHRyPiIsIjwvdHI+PC90Ym9keT48L3RhYmxlPiJdLF9kZWZhdWx0OlswLCIiLCIiXX07Z2Uub3B0Z3JvdXA9Z2Uub3B0aW9uLGdlLnRib2R5PWdlLnRmb290PWdlLmNvbGdyb3VwPWdlLmNhcHRpb249Z2UudGhlYWQsZ2UudGg9Z2UudGQ7ZnVuY3Rpb24geWUoZSx0KXt2YXIgbjtyZXR1cm4gbj0idW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0RWxlbWVudHNCeVRhZ05hbWU/ZS5nZXRFbGVtZW50c0J5VGFnTmFtZSh0fHwiKiIpOiJ1bmRlZmluZWQiIT10eXBlb2YgZS5xdWVyeVNlbGVjdG9yQWxsP2UucXVlcnlTZWxlY3RvckFsbCh0fHwiKiIpOltdLHZvaWQgMD09PXR8fHQmJk4oZSx0KT93Lm1lcmdlKFtlXSxuKTpufWZ1bmN0aW9uIHZlKGUsdCl7Zm9yKHZhciBuPTAscj1lLmxlbmd0aDtuPHI7bisrKUouc2V0KGVbbl0sImdsb2JhbEV2YWwiLCF0fHxKLmdldCh0W25dLCJnbG9iYWxFdmFsIikpfXZhciBtZT0vPHwmIz9cdys7LztmdW5jdGlvbiB4ZShlLHQsbixyLGkpe2Zvcih2YXIgbyxhLHMsdSxsLGMsZj10LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxwPVtdLGQ9MCxoPWUubGVuZ3RoO2Q8aDtkKyspaWYoKG89ZVtkXSl8fDA9PT1vKWlmKCJvYmplY3QiPT09eChvKSl3Lm1lcmdlKHAsby5ub2RlVHlwZT9bb106byk7ZWxzZSBpZihtZS50ZXN0KG8pKXthPWF8fGYuYXBwZW5kQ2hpbGQodC5jcmVhdGVFbGVtZW50KCJkaXYiKSkscz0oZGUuZXhlYyhvKXx8WyIiLCIiXSlbMV0udG9Mb3dlckNhc2UoKSx1PWdlW3NdfHxnZS5fZGVmYXVsdCxhLmlubmVySFRNTD11WzFdK3cuaHRtbFByZWZpbHRlcihvKSt1WzJdLGM9dVswXTt3aGlsZShjLS0pYT1hLmxhc3RDaGlsZDt3Lm1lcmdlKHAsYS5jaGlsZE5vZGVzKSwoYT1mLmZpcnN0Q2hpbGQpLnRleHRDb250ZW50PSIifWVsc2UgcC5wdXNoKHQuY3JlYXRlVGV4dE5vZGUobykpO2YudGV4dENvbnRlbnQ9IiIsZD0wO3doaWxlKG89cFtkKytdKWlmKHImJncuaW5BcnJheShvLHIpPi0xKWkmJmkucHVzaChvKTtlbHNlIGlmKGw9dy5jb250YWlucyhvLm93bmVyRG9jdW1lbnQsbyksYT15ZShmLmFwcGVuZENoaWxkKG8pLCJzY3JpcHQiKSxsJiZ2ZShhKSxuKXtjPTA7d2hpbGUobz1hW2MrK10paGUudGVzdChvLnR5cGV8fCIiKSYmbi5wdXNoKG8pfXJldHVybiBmfSFmdW5jdGlvbigpe3ZhciBlPXIuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLmFwcGVuZENoaWxkKHIuY3JlYXRlRWxlbWVudCgiZGl2IikpLHQ9ci5jcmVhdGVFbGVtZW50KCJpbnB1dCIpO3Quc2V0QXR0cmlidXRlKCJ0eXBlIiwicmFkaW8iKSx0LnNldEF0dHJpYnV0ZSgiY2hlY2tlZCIsImNoZWNrZWQiKSx0LnNldEF0dHJpYnV0ZSgibmFtZSIsInQiKSxlLmFwcGVuZENoaWxkKHQpLGguY2hlY2tDbG9uZT1lLmNsb25lTm9kZSghMCkuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuY2hlY2tlZCxlLmlubmVySFRNTD0iPHRleHRhcmVhPng8L3RleHRhcmVhPiIsaC5ub0Nsb25lQ2hlY2tlZD0hIWUuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlfSgpO3ZhciBiZT1yLmRvY3VtZW50RWxlbWVudCx3ZT0vXmtleS8sVGU9L14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51fGRyYWd8ZHJvcCl8Y2xpY2svLENlPS9eKFteLl0qKSg/OlwuKC4rKXwpLztmdW5jdGlvbiBFZSgpe3JldHVybiEwfWZ1bmN0aW9uIGtlKCl7cmV0dXJuITF9ZnVuY3Rpb24gU2UoKXt0cnl7cmV0dXJuIHIuYWN0aXZlRWxlbWVudH1jYXRjaChlKXt9fWZ1bmN0aW9uIERlKGUsdCxuLHIsaSxvKXt2YXIgYSxzO2lmKCJvYmplY3QiPT10eXBlb2YgdCl7InN0cmluZyIhPXR5cGVvZiBuJiYocj1yfHxuLG49dm9pZCAwKTtmb3IocyBpbiB0KURlKGUscyxuLHIsdFtzXSxvKTtyZXR1cm4gZX1pZihudWxsPT1yJiZudWxsPT1pPyhpPW4scj1uPXZvaWQgMCk6bnVsbD09aSYmKCJzdHJpbmciPT10eXBlb2Ygbj8oaT1yLHI9dm9pZCAwKTooaT1yLHI9bixuPXZvaWQgMCkpLCExPT09aSlpPWtlO2Vsc2UgaWYoIWkpcmV0dXJuIGU7cmV0dXJuIDE9PT1vJiYoYT1pLChpPWZ1bmN0aW9uKGUpe3JldHVybiB3KCkub2ZmKGUpLGEuYXBwbHkodGhpcyxhcmd1bWVudHMpfSkuZ3VpZD1hLmd1aWR8fChhLmd1aWQ9dy5ndWlkKyspKSxlLmVhY2goZnVuY3Rpb24oKXt3LmV2ZW50LmFkZCh0aGlzLHQsaSxyLG4pfSl9dy5ldmVudD17Z2xvYmFsOnt9LGFkZDpmdW5jdGlvbihlLHQsbixyLGkpe3ZhciBvLGEscyx1LGwsYyxmLHAsZCxoLGcseT1KLmdldChlKTtpZih5KXtuLmhhbmRsZXImJihuPShvPW4pLmhhbmRsZXIsaT1vLnNlbGVjdG9yKSxpJiZ3LmZpbmQubWF0Y2hlc1NlbGVjdG9yKGJlLGkpLG4uZ3VpZHx8KG4uZ3VpZD13Lmd1aWQrKyksKHU9eS5ldmVudHMpfHwodT15LmV2ZW50cz17fSksKGE9eS5oYW5kbGUpfHwoYT15LmhhbmRsZT1mdW5jdGlvbih0KXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIHcmJncuZXZlbnQudHJpZ2dlcmVkIT09dC50eXBlP3cuZXZlbnQuZGlzcGF0Y2guYXBwbHkoZSxhcmd1bWVudHMpOnZvaWQgMH0pLGw9KHQ9KHR8fCIiKS5tYXRjaChNKXx8WyIiXSkubGVuZ3RoO3doaWxlKGwtLSlkPWc9KHM9Q2UuZXhlYyh0W2xdKXx8W10pWzFdLGg9KHNbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxkJiYoZj13LmV2ZW50LnNwZWNpYWxbZF18fHt9LGQ9KGk/Zi5kZWxlZ2F0ZVR5cGU6Zi5iaW5kVHlwZSl8fGQsZj13LmV2ZW50LnNwZWNpYWxbZF18fHt9LGM9dy5leHRlbmQoe3R5cGU6ZCxvcmlnVHlwZTpnLGRhdGE6cixoYW5kbGVyOm4sZ3VpZDpuLmd1aWQsc2VsZWN0b3I6aSxuZWVkc0NvbnRleHQ6aSYmdy5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KGkpLG5hbWVzcGFjZTpoLmpvaW4oIi4iKX0sbyksKHA9dVtkXSl8fCgocD11W2RdPVtdKS5kZWxlZ2F0ZUNvdW50PTAsZi5zZXR1cCYmITEhPT1mLnNldHVwLmNhbGwoZSxyLGgsYSl8fGUuYWRkRXZlbnRMaXN0ZW5lciYmZS5hZGRFdmVudExpc3RlbmVyKGQsYSkpLGYuYWRkJiYoZi5hZGQuY2FsbChlLGMpLGMuaGFuZGxlci5ndWlkfHwoYy5oYW5kbGVyLmd1aWQ9bi5ndWlkKSksaT9wLnNwbGljZShwLmRlbGVnYXRlQ291bnQrKywwLGMpOnAucHVzaChjKSx3LmV2ZW50Lmdsb2JhbFtkXT0hMCl9fSxyZW1vdmU6ZnVuY3Rpb24oZSx0LG4scixpKXt2YXIgbyxhLHMsdSxsLGMsZixwLGQsaCxnLHk9Si5oYXNEYXRhKGUpJiZKLmdldChlKTtpZih5JiYodT15LmV2ZW50cykpe2w9KHQ9KHR8fCIiKS5tYXRjaChNKXx8WyIiXSkubGVuZ3RoO3doaWxlKGwtLSlpZihzPUNlLmV4ZWModFtsXSl8fFtdLGQ9Zz1zWzFdLGg9KHNbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxkKXtmPXcuZXZlbnQuc3BlY2lhbFtkXXx8e30scD11W2Q9KHI/Zi5kZWxlZ2F0ZVR5cGU6Zi5iaW5kVHlwZSl8fGRdfHxbXSxzPXNbMl0mJm5ldyBSZWdFeHAoIihefFxcLikiK2guam9pbigiXFwuKD86LipcXC58KSIpKyIoXFwufCQpIiksYT1vPXAubGVuZ3RoO3doaWxlKG8tLSljPXBbb10sIWkmJmchPT1jLm9yaWdUeXBlfHxuJiZuLmd1aWQhPT1jLmd1aWR8fHMmJiFzLnRlc3QoYy5uYW1lc3BhY2UpfHxyJiZyIT09Yy5zZWxlY3RvciYmKCIqKiIhPT1yfHwhYy5zZWxlY3Rvcil8fChwLnNwbGljZShvLDEpLGMuc2VsZWN0b3ImJnAuZGVsZWdhdGVDb3VudC0tLGYucmVtb3ZlJiZmLnJlbW92ZS5jYWxsKGUsYykpO2EmJiFwLmxlbmd0aCYmKGYudGVhcmRvd24mJiExIT09Zi50ZWFyZG93bi5jYWxsKGUsaCx5LmhhbmRsZSl8fHcucmVtb3ZlRXZlbnQoZSxkLHkuaGFuZGxlKSxkZWxldGUgdVtkXSl9ZWxzZSBmb3IoZCBpbiB1KXcuZXZlbnQucmVtb3ZlKGUsZCt0W2xdLG4sciwhMCk7dy5pc0VtcHR5T2JqZWN0KHUpJiZKLnJlbW92ZShlLCJoYW5kbGUgZXZlbnRzIil9fSxkaXNwYXRjaDpmdW5jdGlvbihlKXt2YXIgdD13LmV2ZW50LmZpeChlKSxuLHIsaSxvLGEscyx1PW5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKSxsPShKLmdldCh0aGlzLCJldmVudHMiKXx8e30pW3QudHlwZV18fFtdLGM9dy5ldmVudC5zcGVjaWFsW3QudHlwZV18fHt9O2Zvcih1WzBdPXQsbj0xO248YXJndW1lbnRzLmxlbmd0aDtuKyspdVtuXT1hcmd1bWVudHNbbl07aWYodC5kZWxlZ2F0ZVRhcmdldD10aGlzLCFjLnByZURpc3BhdGNofHwhMSE9PWMucHJlRGlzcGF0Y2guY2FsbCh0aGlzLHQpKXtzPXcuZXZlbnQuaGFuZGxlcnMuY2FsbCh0aGlzLHQsbCksbj0wO3doaWxlKChvPXNbbisrXSkmJiF0LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpe3QuY3VycmVudFRhcmdldD1vLmVsZW0scj0wO3doaWxlKChhPW8uaGFuZGxlcnNbcisrXSkmJiF0LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpdC5ybmFtZXNwYWNlJiYhdC5ybmFtZXNwYWNlLnRlc3QoYS5uYW1lc3BhY2UpfHwodC5oYW5kbGVPYmo9YSx0LmRhdGE9YS5kYXRhLHZvaWQgMCE9PShpPSgody5ldmVudC5zcGVjaWFsW2Eub3JpZ1R5cGVdfHx7fSkuaGFuZGxlfHxhLmhhbmRsZXIpLmFwcGx5KG8uZWxlbSx1KSkmJiExPT09KHQucmVzdWx0PWkpJiYodC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCkpKX1yZXR1cm4gYy5wb3N0RGlzcGF0Y2gmJmMucG9zdERpc3BhdGNoLmNhbGwodGhpcyx0KSx0LnJlc3VsdH19LGhhbmRsZXJzOmZ1bmN0aW9uKGUsdCl7dmFyIG4scixpLG8sYSxzPVtdLHU9dC5kZWxlZ2F0ZUNvdW50LGw9ZS50YXJnZXQ7aWYodSYmbC5ub2RlVHlwZSYmISgiY2xpY2siPT09ZS50eXBlJiZlLmJ1dHRvbj49MSkpZm9yKDtsIT09dGhpcztsPWwucGFyZW50Tm9kZXx8dGhpcylpZigxPT09bC5ub2RlVHlwZSYmKCJjbGljayIhPT1lLnR5cGV8fCEwIT09bC5kaXNhYmxlZCkpe2ZvcihvPVtdLGE9e30sbj0wO248dTtuKyspdm9pZCAwPT09YVtpPShyPXRbbl0pLnNlbGVjdG9yKyIgIl0mJihhW2ldPXIubmVlZHNDb250ZXh0P3coaSx0aGlzKS5pbmRleChsKT4tMTp3LmZpbmQoaSx0aGlzLG51bGwsW2xdKS5sZW5ndGgpLGFbaV0mJm8ucHVzaChyKTtvLmxlbmd0aCYmcy5wdXNoKHtlbGVtOmwsaGFuZGxlcnM6b30pfXJldHVybiBsPXRoaXMsdTx0Lmxlbmd0aCYmcy5wdXNoKHtlbGVtOmwsaGFuZGxlcnM6dC5zbGljZSh1KX0pLHN9LGFkZFByb3A6ZnVuY3Rpb24oZSx0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkody5FdmVudC5wcm90b3R5cGUsZSx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsZ2V0OmcodCk/ZnVuY3Rpb24oKXtpZih0aGlzLm9yaWdpbmFsRXZlbnQpcmV0dXJuIHQodGhpcy5vcmlnaW5hbEV2ZW50KX06ZnVuY3Rpb24oKXtpZih0aGlzLm9yaWdpbmFsRXZlbnQpcmV0dXJuIHRoaXMub3JpZ2luYWxFdmVudFtlXX0sc2V0OmZ1bmN0aW9uKHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLGUse2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOnR9KX19KX0sZml4OmZ1bmN0aW9uKGUpe3JldHVybiBlW3cuZXhwYW5kb10/ZTpuZXcgdy5FdmVudChlKX0sc3BlY2lhbDp7bG9hZDp7bm9CdWJibGU6ITB9LGZvY3VzOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7aWYodGhpcyE9PVNlKCkmJnRoaXMuZm9jdXMpcmV0dXJuIHRoaXMuZm9jdXMoKSwhMX0sZGVsZWdhdGVUeXBlOiJmb2N1c2luIn0sYmx1cjp7dHJpZ2dlcjpmdW5jdGlvbigpe2lmKHRoaXM9PT1TZSgpJiZ0aGlzLmJsdXIpcmV0dXJuIHRoaXMuYmx1cigpLCExfSxkZWxlZ2F0ZVR5cGU6ImZvY3Vzb3V0In0sY2xpY2s6e3RyaWdnZXI6ZnVuY3Rpb24oKXtpZigiY2hlY2tib3giPT09dGhpcy50eXBlJiZ0aGlzLmNsaWNrJiZOKHRoaXMsImlucHV0IikpcmV0dXJuIHRoaXMuY2xpY2soKSwhMX0sX2RlZmF1bHQ6ZnVuY3Rpb24oZSl7cmV0dXJuIE4oZS50YXJnZXQsImEiKX19LGJlZm9yZXVubG9hZDp7cG9zdERpc3BhdGNoOmZ1bmN0aW9uKGUpe3ZvaWQgMCE9PWUucmVzdWx0JiZlLm9yaWdpbmFsRXZlbnQmJihlLm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWU9ZS5yZXN1bHQpfX19fSx3LnJlbW92ZUV2ZW50PWZ1bmN0aW9uKGUsdCxuKXtlLnJlbW92ZUV2ZW50TGlzdGVuZXImJmUucmVtb3ZlRXZlbnRMaXN0ZW5lcih0LG4pfSx3LkV2ZW50PWZ1bmN0aW9uKGUsdCl7aWYoISh0aGlzIGluc3RhbmNlb2Ygdy5FdmVudCkpcmV0dXJuIG5ldyB3LkV2ZW50KGUsdCk7ZSYmZS50eXBlPyh0aGlzLm9yaWdpbmFsRXZlbnQ9ZSx0aGlzLnR5cGU9ZS50eXBlLHRoaXMuaXNEZWZhdWx0UHJldmVudGVkPWUuZGVmYXVsdFByZXZlbnRlZHx8dm9pZCAwPT09ZS5kZWZhdWx0UHJldmVudGVkJiYhMT09PWUucmV0dXJuVmFsdWU/RWU6a2UsdGhpcy50YXJnZXQ9ZS50YXJnZXQmJjM9PT1lLnRhcmdldC5ub2RlVHlwZT9lLnRhcmdldC5wYXJlbnROb2RlOmUudGFyZ2V0LHRoaXMuY3VycmVudFRhcmdldD1lLmN1cnJlbnRUYXJnZXQsdGhpcy5yZWxhdGVkVGFyZ2V0PWUucmVsYXRlZFRhcmdldCk6dGhpcy50eXBlPWUsdCYmdy5leHRlbmQodGhpcyx0KSx0aGlzLnRpbWVTdGFtcD1lJiZlLnRpbWVTdGFtcHx8RGF0ZS5ub3coKSx0aGlzW3cuZXhwYW5kb109ITB9LHcuRXZlbnQucHJvdG90eXBlPXtjb25zdHJ1Y3Rvcjp3LkV2ZW50LGlzRGVmYXVsdFByZXZlbnRlZDprZSxpc1Byb3BhZ2F0aW9uU3RvcHBlZDprZSxpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDprZSxpc1NpbXVsYXRlZDohMSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD1FZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5wcmV2ZW50RGVmYXVsdCgpfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD1FZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5zdG9wUHJvcGFnYXRpb24oKX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9RWUsZSYmIXRoaXMuaXNTaW11bGF0ZWQmJmUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5zdG9wUHJvcGFnYXRpb24oKX19LHcuZWFjaCh7YWx0S2V5OiEwLGJ1YmJsZXM6ITAsY2FuY2VsYWJsZTohMCxjaGFuZ2VkVG91Y2hlczohMCxjdHJsS2V5OiEwLGRldGFpbDohMCxldmVudFBoYXNlOiEwLG1ldGFLZXk6ITAscGFnZVg6ITAscGFnZVk6ITAsc2hpZnRLZXk6ITAsdmlldzohMCwiY2hhciI6ITAsY2hhckNvZGU6ITAsa2V5OiEwLGtleUNvZGU6ITAsYnV0dG9uOiEwLGJ1dHRvbnM6ITAsY2xpZW50WDohMCxjbGllbnRZOiEwLG9mZnNldFg6ITAsb2Zmc2V0WTohMCxwb2ludGVySWQ6ITAscG9pbnRlclR5cGU6ITAsc2NyZWVuWDohMCxzY3JlZW5ZOiEwLHRhcmdldFRvdWNoZXM6ITAsdG9FbGVtZW50OiEwLHRvdWNoZXM6ITAsd2hpY2g6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5idXR0b247cmV0dXJuIG51bGw9PWUud2hpY2gmJndlLnRlc3QoZS50eXBlKT9udWxsIT1lLmNoYXJDb2RlP2UuY2hhckNvZGU6ZS5rZXlDb2RlOiFlLndoaWNoJiZ2b2lkIDAhPT10JiZUZS50ZXN0KGUudHlwZSk/MSZ0PzE6MiZ0PzM6NCZ0PzI6MDplLndoaWNofX0sdy5ldmVudC5hZGRQcm9wKSx3LmVhY2goe21vdXNlZW50ZXI6Im1vdXNlb3ZlciIsbW91c2VsZWF2ZToibW91c2VvdXQiLHBvaW50ZXJlbnRlcjoicG9pbnRlcm92ZXIiLHBvaW50ZXJsZWF2ZToicG9pbnRlcm91dCJ9LGZ1bmN0aW9uKGUsdCl7dy5ldmVudC5zcGVjaWFsW2VdPXtkZWxlZ2F0ZVR5cGU6dCxiaW5kVHlwZTp0LGhhbmRsZTpmdW5jdGlvbihlKXt2YXIgbixyPXRoaXMsaT1lLnJlbGF0ZWRUYXJnZXQsbz1lLmhhbmRsZU9iajtyZXR1cm4gaSYmKGk9PT1yfHx3LmNvbnRhaW5zKHIsaSkpfHwoZS50eXBlPW8ub3JpZ1R5cGUsbj1vLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLGUudHlwZT10KSxufX19KSx3LmZuLmV4dGVuZCh7b246ZnVuY3Rpb24oZSx0LG4scil7cmV0dXJuIERlKHRoaXMsZSx0LG4scil9LG9uZTpmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gRGUodGhpcyxlLHQsbixyLDEpfSxvZmY6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGk7aWYoZSYmZS5wcmV2ZW50RGVmYXVsdCYmZS5oYW5kbGVPYmopcmV0dXJuIHI9ZS5oYW5kbGVPYmosdyhlLmRlbGVnYXRlVGFyZ2V0KS5vZmYoci5uYW1lc3BhY2U/ci5vcmlnVHlwZSsiLiIrci5uYW1lc3BhY2U6ci5vcmlnVHlwZSxyLnNlbGVjdG9yLHIuaGFuZGxlciksdGhpcztpZigib2JqZWN0Ij09dHlwZW9mIGUpe2ZvcihpIGluIGUpdGhpcy5vZmYoaSx0LGVbaV0pO3JldHVybiB0aGlzfXJldHVybiExIT09dCYmImZ1bmN0aW9uIiE9dHlwZW9mIHR8fChuPXQsdD12b2lkIDApLCExPT09biYmKG49a2UpLHRoaXMuZWFjaChmdW5jdGlvbigpe3cuZXZlbnQucmVtb3ZlKHRoaXMsZSxuLHQpfSl9fSk7dmFyIE5lPS88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFthLXpdW15cL1wwPlx4MjBcdFxyXG5cZl0qKVtePl0qKVwvPi9naSxBZT0vPHNjcmlwdHw8c3R5bGV8PGxpbmsvaSxqZT0vY2hlY2tlZFxzKig/OltePV18PVxzKi5jaGVja2VkLikvaSxxZT0vXlxzKjwhKD86XFtDREFUQVxbfC0tKXwoPzpcXVxdfC0tKT5ccyokL2c7ZnVuY3Rpb24gTGUoZSx0KXtyZXR1cm4gTihlLCJ0YWJsZSIpJiZOKDExIT09dC5ub2RlVHlwZT90OnQuZmlyc3RDaGlsZCwidHIiKT93KGUpLmNoaWxkcmVuKCJ0Ym9keSIpWzBdfHxlOmV9ZnVuY3Rpb24gSGUoZSl7cmV0dXJuIGUudHlwZT0obnVsbCE9PWUuZ2V0QXR0cmlidXRlKCJ0eXBlIikpKyIvIitlLnR5cGUsZX1mdW5jdGlvbiBPZShlKXtyZXR1cm4idHJ1ZS8iPT09KGUudHlwZXx8IiIpLnNsaWNlKDAsNSk/ZS50eXBlPWUudHlwZS5zbGljZSg1KTplLnJlbW92ZUF0dHJpYnV0ZSgidHlwZSIpLGV9ZnVuY3Rpb24gUGUoZSx0KXt2YXIgbixyLGksbyxhLHMsdSxsO2lmKDE9PT10Lm5vZGVUeXBlKXtpZihKLmhhc0RhdGEoZSkmJihvPUouYWNjZXNzKGUpLGE9Si5zZXQodCxvKSxsPW8uZXZlbnRzKSl7ZGVsZXRlIGEuaGFuZGxlLGEuZXZlbnRzPXt9O2ZvcihpIGluIGwpZm9yKG49MCxyPWxbaV0ubGVuZ3RoO248cjtuKyspdy5ldmVudC5hZGQodCxpLGxbaV1bbl0pfUsuaGFzRGF0YShlKSYmKHM9Sy5hY2Nlc3MoZSksdT13LmV4dGVuZCh7fSxzKSxLLnNldCh0LHUpKX19ZnVuY3Rpb24gTWUoZSx0KXt2YXIgbj10Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7ImlucHV0Ij09PW4mJnBlLnRlc3QoZS50eXBlKT90LmNoZWNrZWQ9ZS5jaGVja2VkOiJpbnB1dCIhPT1uJiYidGV4dGFyZWEiIT09bnx8KHQuZGVmYXVsdFZhbHVlPWUuZGVmYXVsdFZhbHVlKX1mdW5jdGlvbiBSZShlLHQsbixyKXt0PWEuYXBwbHkoW10sdCk7dmFyIGksbyxzLHUsbCxjLGY9MCxwPWUubGVuZ3RoLGQ9cC0xLHk9dFswXSx2PWcoeSk7aWYodnx8cD4xJiYic3RyaW5nIj09dHlwZW9mIHkmJiFoLmNoZWNrQ2xvbmUmJmplLnRlc3QoeSkpcmV0dXJuIGUuZWFjaChmdW5jdGlvbihpKXt2YXIgbz1lLmVxKGkpO3YmJih0WzBdPXkuY2FsbCh0aGlzLGksby5odG1sKCkpKSxSZShvLHQsbixyKX0pO2lmKHAmJihpPXhlKHQsZVswXS5vd25lckRvY3VtZW50LCExLGUsciksbz1pLmZpcnN0Q2hpbGQsMT09PWkuY2hpbGROb2Rlcy5sZW5ndGgmJihpPW8pLG98fHIpKXtmb3IodT0ocz13Lm1hcCh5ZShpLCJzY3JpcHQiKSxIZSkpLmxlbmd0aDtmPHA7ZisrKWw9aSxmIT09ZCYmKGw9dy5jbG9uZShsLCEwLCEwKSx1JiZ3Lm1lcmdlKHMseWUobCwic2NyaXB0IikpKSxuLmNhbGwoZVtmXSxsLGYpO2lmKHUpZm9yKGM9c1tzLmxlbmd0aC0xXS5vd25lckRvY3VtZW50LHcubWFwKHMsT2UpLGY9MDtmPHU7ZisrKWw9c1tmXSxoZS50ZXN0KGwudHlwZXx8IiIpJiYhSi5hY2Nlc3MobCwiZ2xvYmFsRXZhbCIpJiZ3LmNvbnRhaW5zKGMsbCkmJihsLnNyYyYmIm1vZHVsZSIhPT0obC50eXBlfHwiIikudG9Mb3dlckNhc2UoKT93Ll9ldmFsVXJsJiZ3Ll9ldmFsVXJsKGwuc3JjKTptKGwudGV4dENvbnRlbnQucmVwbGFjZShxZSwiIiksYyxsKSl9cmV0dXJuIGV9ZnVuY3Rpb24gSWUoZSx0LG4pe2Zvcih2YXIgcixpPXQ/dy5maWx0ZXIodCxlKTplLG89MDtudWxsIT0ocj1pW29dKTtvKyspbnx8MSE9PXIubm9kZVR5cGV8fHcuY2xlYW5EYXRhKHllKHIpKSxyLnBhcmVudE5vZGUmJihuJiZ3LmNvbnRhaW5zKHIub3duZXJEb2N1bWVudCxyKSYmdmUoeWUociwic2NyaXB0IikpLHIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyKSk7cmV0dXJuIGV9dy5leHRlbmQoe2h0bWxQcmVmaWx0ZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIGUucmVwbGFjZShOZSwiPCQxPjwvJDI+Iil9LGNsb25lOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYSxzPWUuY2xvbmVOb2RlKCEwKSx1PXcuY29udGFpbnMoZS5vd25lckRvY3VtZW50LGUpO2lmKCEoaC5ub0Nsb25lQ2hlY2tlZHx8MSE9PWUubm9kZVR5cGUmJjExIT09ZS5ub2RlVHlwZXx8dy5pc1hNTERvYyhlKSkpZm9yKGE9eWUocykscj0wLGk9KG89eWUoZSkpLmxlbmd0aDtyPGk7cisrKU1lKG9bcl0sYVtyXSk7aWYodClpZihuKWZvcihvPW98fHllKGUpLGE9YXx8eWUocykscj0wLGk9by5sZW5ndGg7cjxpO3IrKylQZShvW3JdLGFbcl0pO2Vsc2UgUGUoZSxzKTtyZXR1cm4oYT15ZShzLCJzY3JpcHQiKSkubGVuZ3RoPjAmJnZlKGEsIXUmJnllKGUsInNjcmlwdCIpKSxzfSxjbGVhbkRhdGE6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG4scixpPXcuZXZlbnQuc3BlY2lhbCxvPTA7dm9pZCAwIT09KG49ZVtvXSk7bysrKWlmKFkobikpe2lmKHQ9bltKLmV4cGFuZG9dKXtpZih0LmV2ZW50cylmb3IociBpbiB0LmV2ZW50cylpW3JdP3cuZXZlbnQucmVtb3ZlKG4scik6dy5yZW1vdmVFdmVudChuLHIsdC5oYW5kbGUpO25bSi5leHBhbmRvXT12b2lkIDB9bltLLmV4cGFuZG9dJiYobltLLmV4cGFuZG9dPXZvaWQgMCl9fX0pLHcuZm4uZXh0ZW5kKHtkZXRhY2g6ZnVuY3Rpb24oZSl7cmV0dXJuIEllKHRoaXMsZSwhMCl9LHJlbW92ZTpmdW5jdGlvbihlKXtyZXR1cm4gSWUodGhpcyxlKX0sdGV4dDpmdW5jdGlvbihlKXtyZXR1cm4geih0aGlzLGZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lP3cudGV4dCh0aGlzKTp0aGlzLmVtcHR5KCkuZWFjaChmdW5jdGlvbigpezEhPT10aGlzLm5vZGVUeXBlJiYxMSE9PXRoaXMubm9kZVR5cGUmJjkhPT10aGlzLm5vZGVUeXBlfHwodGhpcy50ZXh0Q29udGVudD1lKX0pfSxudWxsLGUsYXJndW1lbnRzLmxlbmd0aCl9LGFwcGVuZDpmdW5jdGlvbigpe3JldHVybiBSZSh0aGlzLGFyZ3VtZW50cyxmdW5jdGlvbihlKXsxIT09dGhpcy5ub2RlVHlwZSYmMTEhPT10aGlzLm5vZGVUeXBlJiY5IT09dGhpcy5ub2RlVHlwZXx8TGUodGhpcyxlKS5hcHBlbmRDaGlsZChlKX0pfSxwcmVwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIFJlKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpe2lmKDE9PT10aGlzLm5vZGVUeXBlfHwxMT09PXRoaXMubm9kZVR5cGV8fDk9PT10aGlzLm5vZGVUeXBlKXt2YXIgdD1MZSh0aGlzLGUpO3QuaW5zZXJ0QmVmb3JlKGUsdC5maXJzdENoaWxkKX19KX0sYmVmb3JlOmZ1bmN0aW9uKCl7cmV0dXJuIFJlKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpe3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLHRoaXMpfSl9LGFmdGVyOmZ1bmN0aW9uKCl7cmV0dXJuIFJlKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpe3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLHRoaXMubmV4dFNpYmxpbmcpfSl9LGVtcHR5OmZ1bmN0aW9uKCl7Zm9yKHZhciBlLHQ9MDtudWxsIT0oZT10aGlzW3RdKTt0KyspMT09PWUubm9kZVR5cGUmJih3LmNsZWFuRGF0YSh5ZShlLCExKSksZS50ZXh0Q29udGVudD0iIik7cmV0dXJuIHRoaXN9LGNsb25lOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU9bnVsbCE9ZSYmZSx0PW51bGw9PXQ/ZTp0LHRoaXMubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIHcuY2xvbmUodGhpcyxlLHQpfSl9LGh0bWw6ZnVuY3Rpb24oZSl7cmV0dXJuIHoodGhpcyxmdW5jdGlvbihlKXt2YXIgdD10aGlzWzBdfHx7fSxuPTAscj10aGlzLmxlbmd0aDtpZih2b2lkIDA9PT1lJiYxPT09dC5ub2RlVHlwZSlyZXR1cm4gdC5pbm5lckhUTUw7aWYoInN0cmluZyI9PXR5cGVvZiBlJiYhQWUudGVzdChlKSYmIWdlWyhkZS5leGVjKGUpfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpXSl7ZT13Lmh0bWxQcmVmaWx0ZXIoZSk7dHJ5e2Zvcig7bjxyO24rKykxPT09KHQ9dGhpc1tuXXx8e30pLm5vZGVUeXBlJiYody5jbGVhbkRhdGEoeWUodCwhMSkpLHQuaW5uZXJIVE1MPWUpO3Q9MH1jYXRjaChlKXt9fXQmJnRoaXMuZW1wdHkoKS5hcHBlbmQoZSl9LG51bGwsZSxhcmd1bWVudHMubGVuZ3RoKX0scmVwbGFjZVdpdGg6ZnVuY3Rpb24oKXt2YXIgZT1bXTtyZXR1cm4gUmUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24odCl7dmFyIG49dGhpcy5wYXJlbnROb2RlO3cuaW5BcnJheSh0aGlzLGUpPDAmJih3LmNsZWFuRGF0YSh5ZSh0aGlzKSksbiYmbi5yZXBsYWNlQ2hpbGQodCx0aGlzKSl9LGUpfX0pLHcuZWFjaCh7YXBwZW5kVG86ImFwcGVuZCIscHJlcGVuZFRvOiJwcmVwZW5kIixpbnNlcnRCZWZvcmU6ImJlZm9yZSIsaW5zZXJ0QWZ0ZXI6ImFmdGVyIixyZXBsYWNlQWxsOiJyZXBsYWNlV2l0aCJ9LGZ1bmN0aW9uKGUsdCl7dy5mbltlXT1mdW5jdGlvbihlKXtmb3IodmFyIG4scj1bXSxpPXcoZSksbz1pLmxlbmd0aC0xLGE9MDthPD1vO2ErKyluPWE9PT1vP3RoaXM6dGhpcy5jbG9uZSghMCksdyhpW2FdKVt0XShuKSxzLmFwcGx5KHIsbi5nZXQoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHIpfX0pO3ZhciBXZT1uZXcgUmVnRXhwKCJeKCIrcmUrIikoPyFweClbYS16JV0rJCIsImkiKSwkZT1mdW5jdGlvbih0KXt2YXIgbj10Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc7cmV0dXJuIG4mJm4ub3BlbmVyfHwobj1lKSxuLmdldENvbXB1dGVkU3R5bGUodCl9LEJlPW5ldyBSZWdFeHAob2Uuam9pbigifCIpLCJpIik7IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe2lmKGMpe2wuc3R5bGUuY3NzVGV4dD0icG9zaXRpb246YWJzb2x1dGU7bGVmdDotMTExMTFweDt3aWR0aDo2MHB4O21hcmdpbi10b3A6MXB4O3BhZGRpbmc6MDtib3JkZXI6MCIsYy5zdHlsZS5jc3NUZXh0PSJwb3NpdGlvbjpyZWxhdGl2ZTtkaXNwbGF5OmJsb2NrO2JveC1zaXppbmc6Ym9yZGVyLWJveDtvdmVyZmxvdzpzY3JvbGw7bWFyZ2luOmF1dG87Ym9yZGVyOjFweDtwYWRkaW5nOjFweDt3aWR0aDo2MCU7dG9wOjElIixiZS5hcHBlbmRDaGlsZChsKS5hcHBlbmRDaGlsZChjKTt2YXIgdD1lLmdldENvbXB1dGVkU3R5bGUoYyk7aT0iMSUiIT09dC50b3AsdT0xMj09PW4odC5tYXJnaW5MZWZ0KSxjLnN0eWxlLnJpZ2h0PSI2MCUiLHM9MzY9PT1uKHQucmlnaHQpLG89MzY9PT1uKHQud2lkdGgpLGMuc3R5bGUucG9zaXRpb249ImFic29sdXRlIixhPTM2PT09Yy5vZmZzZXRXaWR0aHx8ImFic29sdXRlIixiZS5yZW1vdmVDaGlsZChsKSxjPW51bGx9fWZ1bmN0aW9uIG4oZSl7cmV0dXJuIE1hdGgucm91bmQocGFyc2VGbG9hdChlKSl9dmFyIGksbyxhLHMsdSxsPXIuY3JlYXRlRWxlbWVudCgiZGl2IiksYz1yLmNyZWF0ZUVsZW1lbnQoImRpdiIpO2Muc3R5bGUmJihjLnN0eWxlLmJhY2tncm91bmRDbGlwPSJjb250ZW50LWJveCIsYy5jbG9uZU5vZGUoITApLnN0eWxlLmJhY2tncm91bmRDbGlwPSIiLGguY2xlYXJDbG9uZVN0eWxlPSJjb250ZW50LWJveCI9PT1jLnN0eWxlLmJhY2tncm91bmRDbGlwLHcuZXh0ZW5kKGgse2JveFNpemluZ1JlbGlhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIHQoKSxvfSxwaXhlbEJveFN0eWxlczpmdW5jdGlvbigpe3JldHVybiB0KCksc30scGl4ZWxQb3NpdGlvbjpmdW5jdGlvbigpe3JldHVybiB0KCksaX0scmVsaWFibGVNYXJnaW5MZWZ0OmZ1bmN0aW9uKCl7cmV0dXJuIHQoKSx1fSxzY3JvbGxib3hTaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHQoKSxhfX0pKX0oKTtmdW5jdGlvbiBGZShlLHQsbil7dmFyIHIsaSxvLGEscz1lLnN0eWxlO3JldHVybihuPW58fCRlKGUpKSYmKCIiIT09KGE9bi5nZXRQcm9wZXJ0eVZhbHVlKHQpfHxuW3RdKXx8dy5jb250YWlucyhlLm93bmVyRG9jdW1lbnQsZSl8fChhPXcuc3R5bGUoZSx0KSksIWgucGl4ZWxCb3hTdHlsZXMoKSYmV2UudGVzdChhKSYmQmUudGVzdCh0KSYmKHI9cy53aWR0aCxpPXMubWluV2lkdGgsbz1zLm1heFdpZHRoLHMubWluV2lkdGg9cy5tYXhXaWR0aD1zLndpZHRoPWEsYT1uLndpZHRoLHMud2lkdGg9cixzLm1pbldpZHRoPWkscy5tYXhXaWR0aD1vKSksdm9pZCAwIT09YT9hKyIiOmF9ZnVuY3Rpb24gX2UoZSx0KXtyZXR1cm57Z2V0OmZ1bmN0aW9uKCl7aWYoIWUoKSlyZXR1cm4odGhpcy5nZXQ9dCkuYXBwbHkodGhpcyxhcmd1bWVudHMpO2RlbGV0ZSB0aGlzLmdldH19fXZhciB6ZT0vXihub25lfHRhYmxlKD8hLWNbZWFdKS4rKS8sWGU9L14tLS8sVWU9e3Bvc2l0aW9uOiJhYnNvbHV0ZSIsdmlzaWJpbGl0eToiaGlkZGVuIixkaXNwbGF5OiJibG9jayJ9LFZlPXtsZXR0ZXJTcGFjaW5nOiIwIixmb250V2VpZ2h0OiI0MDAifSxHZT1bIldlYmtpdCIsIk1veiIsIm1zIl0sWWU9ci5jcmVhdGVFbGVtZW50KCJkaXYiKS5zdHlsZTtmdW5jdGlvbiBRZShlKXtpZihlIGluIFllKXJldHVybiBlO3ZhciB0PWVbMF0udG9VcHBlckNhc2UoKStlLnNsaWNlKDEpLG49R2UubGVuZ3RoO3doaWxlKG4tLSlpZigoZT1HZVtuXSt0KWluIFllKXJldHVybiBlfWZ1bmN0aW9uIEplKGUpe3ZhciB0PXcuY3NzUHJvcHNbZV07cmV0dXJuIHR8fCh0PXcuY3NzUHJvcHNbZV09UWUoZSl8fGUpLHR9ZnVuY3Rpb24gS2UoZSx0LG4pe3ZhciByPWllLmV4ZWModCk7cmV0dXJuIHI/TWF0aC5tYXgoMCxyWzJdLShufHwwKSkrKHJbM118fCJweCIpOnR9ZnVuY3Rpb24gWmUoZSx0LG4scixpLG8pe3ZhciBhPSJ3aWR0aCI9PT10PzE6MCxzPTAsdT0wO2lmKG49PT0ocj8iYm9yZGVyIjoiY29udGVudCIpKXJldHVybiAwO2Zvcig7YTw0O2ErPTIpIm1hcmdpbiI9PT1uJiYodSs9dy5jc3MoZSxuK29lW2FdLCEwLGkpKSxyPygiY29udGVudCI9PT1uJiYodS09dy5jc3MoZSwicGFkZGluZyIrb2VbYV0sITAsaSkpLCJtYXJnaW4iIT09biYmKHUtPXcuY3NzKGUsImJvcmRlciIrb2VbYV0rIldpZHRoIiwhMCxpKSkpOih1Kz13LmNzcyhlLCJwYWRkaW5nIitvZVthXSwhMCxpKSwicGFkZGluZyIhPT1uP3UrPXcuY3NzKGUsImJvcmRlciIrb2VbYV0rIldpZHRoIiwhMCxpKTpzKz13LmNzcyhlLCJib3JkZXIiK29lW2FdKyJXaWR0aCIsITAsaSkpO3JldHVybiFyJiZvPj0wJiYodSs9TWF0aC5tYXgoMCxNYXRoLmNlaWwoZVsib2Zmc2V0Iit0WzBdLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKV0tby11LXMtLjUpKSksdX1mdW5jdGlvbiBldChlLHQsbil7dmFyIHI9JGUoZSksaT1GZShlLHQsciksbz0iYm9yZGVyLWJveCI9PT13LmNzcyhlLCJib3hTaXppbmciLCExLHIpLGE9bztpZihXZS50ZXN0KGkpKXtpZighbilyZXR1cm4gaTtpPSJhdXRvIn1yZXR1cm4gYT1hJiYoaC5ib3hTaXppbmdSZWxpYWJsZSgpfHxpPT09ZS5zdHlsZVt0XSksKCJhdXRvIj09PWl8fCFwYXJzZUZsb2F0KGkpJiYiaW5saW5lIj09PXcuY3NzKGUsImRpc3BsYXkiLCExLHIpKSYmKGk9ZVsib2Zmc2V0Iit0WzBdLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKV0sYT0hMCksKGk9cGFyc2VGbG9hdChpKXx8MCkrWmUoZSx0LG58fChvPyJib3JkZXIiOiJjb250ZW50IiksYSxyLGkpKyJweCJ9dy5leHRlbmQoe2Nzc0hvb2tzOntvcGFjaXR5OntnZXQ6ZnVuY3Rpb24oZSx0KXtpZih0KXt2YXIgbj1GZShlLCJvcGFjaXR5Iik7cmV0dXJuIiI9PT1uPyIxIjpufX19fSxjc3NOdW1iZXI6e2FuaW1hdGlvbkl0ZXJhdGlvbkNvdW50OiEwLGNvbHVtbkNvdW50OiEwLGZpbGxPcGFjaXR5OiEwLGZsZXhHcm93OiEwLGZsZXhTaHJpbms6ITAsZm9udFdlaWdodDohMCxsaW5lSGVpZ2h0OiEwLG9wYWNpdHk6ITAsb3JkZXI6ITAsb3JwaGFuczohMCx3aWRvd3M6ITAsekluZGV4OiEwLHpvb206ITB9LGNzc1Byb3BzOnt9LHN0eWxlOmZ1bmN0aW9uKGUsdCxuLHIpe2lmKGUmJjMhPT1lLm5vZGVUeXBlJiY4IT09ZS5ub2RlVHlwZSYmZS5zdHlsZSl7dmFyIGksbyxhLHM9Ryh0KSx1PVhlLnRlc3QodCksbD1lLnN0eWxlO2lmKHV8fCh0PUplKHMpKSxhPXcuY3NzSG9va3NbdF18fHcuY3NzSG9va3Nbc10sdm9pZCAwPT09bilyZXR1cm4gYSYmImdldCJpbiBhJiZ2b2lkIDAhPT0oaT1hLmdldChlLCExLHIpKT9pOmxbdF07InN0cmluZyI9PShvPXR5cGVvZiBuKSYmKGk9aWUuZXhlYyhuKSkmJmlbMV0mJihuPXVlKGUsdCxpKSxvPSJudW1iZXIiKSxudWxsIT1uJiZuPT09biYmKCJudW1iZXIiPT09byYmKG4rPWkmJmlbM118fCh3LmNzc051bWJlcltzXT8iIjoicHgiKSksaC5jbGVhckNsb25lU3R5bGV8fCIiIT09bnx8MCE9PXQuaW5kZXhPZigiYmFja2dyb3VuZCIpfHwobFt0XT0iaW5oZXJpdCIpLGEmJiJzZXQiaW4gYSYmdm9pZCAwPT09KG49YS5zZXQoZSxuLHIpKXx8KHU/bC5zZXRQcm9wZXJ0eSh0LG4pOmxbdF09bikpfX0sY3NzOmZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBpLG8sYSxzPUcodCk7cmV0dXJuIFhlLnRlc3QodCl8fCh0PUplKHMpKSwoYT13LmNzc0hvb2tzW3RdfHx3LmNzc0hvb2tzW3NdKSYmImdldCJpbiBhJiYoaT1hLmdldChlLCEwLG4pKSx2b2lkIDA9PT1pJiYoaT1GZShlLHQscikpLCJub3JtYWwiPT09aSYmdCBpbiBWZSYmKGk9VmVbdF0pLCIiPT09bnx8bj8obz1wYXJzZUZsb2F0KGkpLCEwPT09bnx8aXNGaW5pdGUobyk/b3x8MDppKTppfX0pLHcuZWFjaChbImhlaWdodCIsIndpZHRoIl0sZnVuY3Rpb24oZSx0KXt3LmNzc0hvb2tzW3RdPXtnZXQ6ZnVuY3Rpb24oZSxuLHIpe2lmKG4pcmV0dXJuIXplLnRlc3Qody5jc3MoZSwiZGlzcGxheSIpKXx8ZS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCYmZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aD9ldChlLHQscik6c2UoZSxVZSxmdW5jdGlvbigpe3JldHVybiBldChlLHQscil9KX0sc2V0OmZ1bmN0aW9uKGUsbixyKXt2YXIgaSxvPSRlKGUpLGE9ImJvcmRlci1ib3giPT09dy5jc3MoZSwiYm94U2l6aW5nIiwhMSxvKSxzPXImJlplKGUsdCxyLGEsbyk7cmV0dXJuIGEmJmguc2Nyb2xsYm94U2l6ZSgpPT09by5wb3NpdGlvbiYmKHMtPU1hdGguY2VpbChlWyJvZmZzZXQiK3RbMF0udG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpXS1wYXJzZUZsb2F0KG9bdF0pLVplKGUsdCwiYm9yZGVyIiwhMSxvKS0uNSkpLHMmJihpPWllLmV4ZWMobikpJiYicHgiIT09KGlbM118fCJweCIpJiYoZS5zdHlsZVt0XT1uLG49dy5jc3MoZSx0KSksS2UoZSxuLHMpfX19KSx3LmNzc0hvb2tzLm1hcmdpbkxlZnQ9X2UoaC5yZWxpYWJsZU1hcmdpbkxlZnQsZnVuY3Rpb24oZSx0KXtpZih0KXJldHVybihwYXJzZUZsb2F0KEZlKGUsIm1hcmdpbkxlZnQiKSl8fGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdC1zZShlLHttYXJnaW5MZWZ0OjB9LGZ1bmN0aW9uKCl7cmV0dXJuIGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdH0pKSsicHgifSksdy5lYWNoKHttYXJnaW46IiIscGFkZGluZzoiIixib3JkZXI6IldpZHRoIn0sZnVuY3Rpb24oZSx0KXt3LmNzc0hvb2tzW2UrdF09e2V4cGFuZDpmdW5jdGlvbihuKXtmb3IodmFyIHI9MCxpPXt9LG89InN0cmluZyI9PXR5cGVvZiBuP24uc3BsaXQoIiAiKTpbbl07cjw0O3IrKylpW2Urb2Vbcl0rdF09b1tyXXx8b1tyLTJdfHxvWzBdO3JldHVybiBpfX0sIm1hcmdpbiIhPT1lJiYody5jc3NIb29rc1tlK3RdLnNldD1LZSl9KSx3LmZuLmV4dGVuZCh7Y3NzOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHoodGhpcyxmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvPXt9LGE9MDtpZihBcnJheS5pc0FycmF5KHQpKXtmb3Iocj0kZShlKSxpPXQubGVuZ3RoO2E8aTthKyspb1t0W2FdXT13LmNzcyhlLHRbYV0sITEscik7cmV0dXJuIG99cmV0dXJuIHZvaWQgMCE9PW4/dy5zdHlsZShlLHQsbik6dy5jc3MoZSx0KX0sZSx0LGFyZ3VtZW50cy5sZW5ndGg+MSl9fSk7ZnVuY3Rpb24gdHQoZSx0LG4scixpKXtyZXR1cm4gbmV3IHR0LnByb3RvdHlwZS5pbml0KGUsdCxuLHIsaSl9dy5Ud2Vlbj10dCx0dC5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOnR0LGluaXQ6ZnVuY3Rpb24oZSx0LG4scixpLG8pe3RoaXMuZWxlbT1lLHRoaXMucHJvcD1uLHRoaXMuZWFzaW5nPWl8fHcuZWFzaW5nLl9kZWZhdWx0LHRoaXMub3B0aW9ucz10LHRoaXMuc3RhcnQ9dGhpcy5ub3c9dGhpcy5jdXIoKSx0aGlzLmVuZD1yLHRoaXMudW5pdD1vfHwody5jc3NOdW1iZXJbbl0/IiI6InB4Iil9LGN1cjpmdW5jdGlvbigpe3ZhciBlPXR0LnByb3BIb29rc1t0aGlzLnByb3BdO3JldHVybiBlJiZlLmdldD9lLmdldCh0aGlzKTp0dC5wcm9wSG9va3MuX2RlZmF1bHQuZ2V0KHRoaXMpfSxydW46ZnVuY3Rpb24oZSl7dmFyIHQsbj10dC5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gdGhpcy5vcHRpb25zLmR1cmF0aW9uP3RoaXMucG9zPXQ9dy5lYXNpbmdbdGhpcy5lYXNpbmddKGUsdGhpcy5vcHRpb25zLmR1cmF0aW9uKmUsMCwxLHRoaXMub3B0aW9ucy5kdXJhdGlvbik6dGhpcy5wb3M9dD1lLHRoaXMubm93PSh0aGlzLmVuZC10aGlzLnN0YXJ0KSp0K3RoaXMuc3RhcnQsdGhpcy5vcHRpb25zLnN0ZXAmJnRoaXMub3B0aW9ucy5zdGVwLmNhbGwodGhpcy5lbGVtLHRoaXMubm93LHRoaXMpLG4mJm4uc2V0P24uc2V0KHRoaXMpOnR0LnByb3BIb29rcy5fZGVmYXVsdC5zZXQodGhpcyksdGhpc319LHR0LnByb3RvdHlwZS5pbml0LnByb3RvdHlwZT10dC5wcm90b3R5cGUsdHQucHJvcEhvb2tzPXtfZGVmYXVsdDp7Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiAxIT09ZS5lbGVtLm5vZGVUeXBlfHxudWxsIT1lLmVsZW1bZS5wcm9wXSYmbnVsbD09ZS5lbGVtLnN0eWxlW2UucHJvcF0/ZS5lbGVtW2UucHJvcF06KHQ9dy5jc3MoZS5lbGVtLGUucHJvcCwiIikpJiYiYXV0byIhPT10P3Q6MH0sc2V0OmZ1bmN0aW9uKGUpe3cuZnguc3RlcFtlLnByb3BdP3cuZnguc3RlcFtlLnByb3BdKGUpOjEhPT1lLmVsZW0ubm9kZVR5cGV8fG51bGw9PWUuZWxlbS5zdHlsZVt3LmNzc1Byb3BzW2UucHJvcF1dJiYhdy5jc3NIb29rc1tlLnByb3BdP2UuZWxlbVtlLnByb3BdPWUubm93Oncuc3R5bGUoZS5lbGVtLGUucHJvcCxlLm5vdytlLnVuaXQpfX19LHR0LnByb3BIb29rcy5zY3JvbGxUb3A9dHQucHJvcEhvb2tzLnNjcm9sbExlZnQ9e3NldDpmdW5jdGlvbihlKXtlLmVsZW0ubm9kZVR5cGUmJmUuZWxlbS5wYXJlbnROb2RlJiYoZS5lbGVtW2UucHJvcF09ZS5ub3cpfX0sdy5lYXNpbmc9e2xpbmVhcjpmdW5jdGlvbihlKXtyZXR1cm4gZX0sc3dpbmc6ZnVuY3Rpb24oZSl7cmV0dXJuLjUtTWF0aC5jb3MoZSpNYXRoLlBJKS8yfSxfZGVmYXVsdDoic3dpbmcifSx3LmZ4PXR0LnByb3RvdHlwZS5pbml0LHcuZnguc3RlcD17fTt2YXIgbnQscnQsaXQ9L14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLG90PS9xdWV1ZUhvb2tzJC87ZnVuY3Rpb24gYXQoKXtydCYmKCExPT09ci5oaWRkZW4mJmUucmVxdWVzdEFuaW1hdGlvbkZyYW1lP2UucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGF0KTplLnNldFRpbWVvdXQoYXQsdy5meC5pbnRlcnZhbCksdy5meC50aWNrKCkpfWZ1bmN0aW9uIHN0KCl7cmV0dXJuIGUuc2V0VGltZW91dChmdW5jdGlvbigpe250PXZvaWQgMH0pLG50PURhdGUubm93KCl9ZnVuY3Rpb24gdXQoZSx0KXt2YXIgbixyPTAsaT17aGVpZ2h0OmV9O2Zvcih0PXQ/MTowO3I8NDtyKz0yLXQpaVsibWFyZ2luIisobj1vZVtyXSldPWlbInBhZGRpbmciK25dPWU7cmV0dXJuIHQmJihpLm9wYWNpdHk9aS53aWR0aD1lKSxpfWZ1bmN0aW9uIGx0KGUsdCxuKXtmb3IodmFyIHIsaT0ocHQudHdlZW5lcnNbdF18fFtdKS5jb25jYXQocHQudHdlZW5lcnNbIioiXSksbz0wLGE9aS5sZW5ndGg7bzxhO28rKylpZihyPWlbb10uY2FsbChuLHQsZSkpcmV0dXJuIHJ9ZnVuY3Rpb24gY3QoZSx0LG4pe3ZhciByLGksbyxhLHMsdSxsLGMsZj0id2lkdGgiaW4gdHx8ImhlaWdodCJpbiB0LHA9dGhpcyxkPXt9LGg9ZS5zdHlsZSxnPWUubm9kZVR5cGUmJmFlKGUpLHk9Si5nZXQoZSwiZnhzaG93Iik7bi5xdWV1ZXx8KG51bGw9PShhPXcuX3F1ZXVlSG9va3MoZSwiZngiKSkudW5xdWV1ZWQmJihhLnVucXVldWVkPTAscz1hLmVtcHR5LmZpcmUsYS5lbXB0eS5maXJlPWZ1bmN0aW9uKCl7YS51bnF1ZXVlZHx8cygpfSksYS51bnF1ZXVlZCsrLHAuYWx3YXlzKGZ1bmN0aW9uKCl7cC5hbHdheXMoZnVuY3Rpb24oKXthLnVucXVldWVkLS0sdy5xdWV1ZShlLCJmeCIpLmxlbmd0aHx8YS5lbXB0eS5maXJlKCl9KX0pKTtmb3IociBpbiB0KWlmKGk9dFtyXSxpdC50ZXN0KGkpKXtpZihkZWxldGUgdFtyXSxvPW98fCJ0b2dnbGUiPT09aSxpPT09KGc/ImhpZGUiOiJzaG93Iikpe2lmKCJzaG93IiE9PWl8fCF5fHx2b2lkIDA9PT15W3JdKWNvbnRpbnVlO2c9ITB9ZFtyXT15JiZ5W3JdfHx3LnN0eWxlKGUscil9aWYoKHU9IXcuaXNFbXB0eU9iamVjdCh0KSl8fCF3LmlzRW1wdHlPYmplY3QoZCkpe2YmJjE9PT1lLm5vZGVUeXBlJiYobi5vdmVyZmxvdz1baC5vdmVyZmxvdyxoLm92ZXJmbG93WCxoLm92ZXJmbG93WV0sbnVsbD09KGw9eSYmeS5kaXNwbGF5KSYmKGw9Si5nZXQoZSwiZGlzcGxheSIpKSwibm9uZSI9PT0oYz13LmNzcyhlLCJkaXNwbGF5IikpJiYobD9jPWw6KGZlKFtlXSwhMCksbD1lLnN0eWxlLmRpc3BsYXl8fGwsYz13LmNzcyhlLCJkaXNwbGF5IiksZmUoW2VdKSkpLCgiaW5saW5lIj09PWN8fCJpbmxpbmUtYmxvY2siPT09YyYmbnVsbCE9bCkmJiJub25lIj09PXcuY3NzKGUsImZsb2F0IikmJih1fHwocC5kb25lKGZ1bmN0aW9uKCl7aC5kaXNwbGF5PWx9KSxudWxsPT1sJiYoYz1oLmRpc3BsYXksbD0ibm9uZSI9PT1jPyIiOmMpKSxoLmRpc3BsYXk9ImlubGluZS1ibG9jayIpKSxuLm92ZXJmbG93JiYoaC5vdmVyZmxvdz0iaGlkZGVuIixwLmFsd2F5cyhmdW5jdGlvbigpe2gub3ZlcmZsb3c9bi5vdmVyZmxvd1swXSxoLm92ZXJmbG93WD1uLm92ZXJmbG93WzFdLGgub3ZlcmZsb3dZPW4ub3ZlcmZsb3dbMl19KSksdT0hMTtmb3IociBpbiBkKXV8fCh5PyJoaWRkZW4iaW4geSYmKGc9eS5oaWRkZW4pOnk9Si5hY2Nlc3MoZSwiZnhzaG93Iix7ZGlzcGxheTpsfSksbyYmKHkuaGlkZGVuPSFnKSxnJiZmZShbZV0sITApLHAuZG9uZShmdW5jdGlvbigpe2d8fGZlKFtlXSksSi5yZW1vdmUoZSwiZnhzaG93Iik7Zm9yKHIgaW4gZCl3LnN0eWxlKGUscixkW3JdKX0pKSx1PWx0KGc/eVtyXTowLHIscCksciBpbiB5fHwoeVtyXT11LnN0YXJ0LGcmJih1LmVuZD11LnN0YXJ0LHUuc3RhcnQ9MCkpfX1mdW5jdGlvbiBmdChlLHQpe3ZhciBuLHIsaSxvLGE7Zm9yKG4gaW4gZSlpZihyPUcobiksaT10W3JdLG89ZVtuXSxBcnJheS5pc0FycmF5KG8pJiYoaT1vWzFdLG89ZVtuXT1vWzBdKSxuIT09ciYmKGVbcl09byxkZWxldGUgZVtuXSksKGE9dy5jc3NIb29rc1tyXSkmJiJleHBhbmQiaW4gYSl7bz1hLmV4cGFuZChvKSxkZWxldGUgZVtyXTtmb3IobiBpbiBvKW4gaW4gZXx8KGVbbl09b1tuXSx0W25dPWkpfWVsc2UgdFtyXT1pfWZ1bmN0aW9uIHB0KGUsdCxuKXt2YXIgcixpLG89MCxhPXB0LnByZWZpbHRlcnMubGVuZ3RoLHM9dy5EZWZlcnJlZCgpLmFsd2F5cyhmdW5jdGlvbigpe2RlbGV0ZSB1LmVsZW19KSx1PWZ1bmN0aW9uKCl7aWYoaSlyZXR1cm4hMTtmb3IodmFyIHQ9bnR8fHN0KCksbj1NYXRoLm1heCgwLGwuc3RhcnRUaW1lK2wuZHVyYXRpb24tdCkscj0xLShuL2wuZHVyYXRpb258fDApLG89MCxhPWwudHdlZW5zLmxlbmd0aDtvPGE7bysrKWwudHdlZW5zW29dLnJ1bihyKTtyZXR1cm4gcy5ub3RpZnlXaXRoKGUsW2wscixuXSkscjwxJiZhP246KGF8fHMubm90aWZ5V2l0aChlLFtsLDEsMF0pLHMucmVzb2x2ZVdpdGgoZSxbbF0pLCExKX0sbD1zLnByb21pc2Uoe2VsZW06ZSxwcm9wczp3LmV4dGVuZCh7fSx0KSxvcHRzOncuZXh0ZW5kKCEwLHtzcGVjaWFsRWFzaW5nOnt9LGVhc2luZzp3LmVhc2luZy5fZGVmYXVsdH0sbiksb3JpZ2luYWxQcm9wZXJ0aWVzOnQsb3JpZ2luYWxPcHRpb25zOm4sc3RhcnRUaW1lOm50fHxzdCgpLGR1cmF0aW9uOm4uZHVyYXRpb24sdHdlZW5zOltdLGNyZWF0ZVR3ZWVuOmZ1bmN0aW9uKHQsbil7dmFyIHI9dy5Ud2VlbihlLGwub3B0cyx0LG4sbC5vcHRzLnNwZWNpYWxFYXNpbmdbdF18fGwub3B0cy5lYXNpbmcpO3JldHVybiBsLnR3ZWVucy5wdXNoKHIpLHJ9LHN0b3A6ZnVuY3Rpb24odCl7dmFyIG49MCxyPXQ/bC50d2VlbnMubGVuZ3RoOjA7aWYoaSlyZXR1cm4gdGhpcztmb3IoaT0hMDtuPHI7bisrKWwudHdlZW5zW25dLnJ1bigxKTtyZXR1cm4gdD8ocy5ub3RpZnlXaXRoKGUsW2wsMSwwXSkscy5yZXNvbHZlV2l0aChlLFtsLHRdKSk6cy5yZWplY3RXaXRoKGUsW2wsdF0pLHRoaXN9fSksYz1sLnByb3BzO2ZvcihmdChjLGwub3B0cy5zcGVjaWFsRWFzaW5nKTtvPGE7bysrKWlmKHI9cHQucHJlZmlsdGVyc1tvXS5jYWxsKGwsZSxjLGwub3B0cykpcmV0dXJuIGcoci5zdG9wKSYmKHcuX3F1ZXVlSG9va3MobC5lbGVtLGwub3B0cy5xdWV1ZSkuc3RvcD1yLnN0b3AuYmluZChyKSkscjtyZXR1cm4gdy5tYXAoYyxsdCxsKSxnKGwub3B0cy5zdGFydCkmJmwub3B0cy5zdGFydC5jYWxsKGUsbCksbC5wcm9ncmVzcyhsLm9wdHMucHJvZ3Jlc3MpLmRvbmUobC5vcHRzLmRvbmUsbC5vcHRzLmNvbXBsZXRlKS5mYWlsKGwub3B0cy5mYWlsKS5hbHdheXMobC5vcHRzLmFsd2F5cyksdy5meC50aW1lcih3LmV4dGVuZCh1LHtlbGVtOmUsYW5pbTpsLHF1ZXVlOmwub3B0cy5xdWV1ZX0pKSxsfXcuQW5pbWF0aW9uPXcuZXh0ZW5kKHB0LHt0d2VlbmVyczp7IioiOltmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMuY3JlYXRlVHdlZW4oZSx0KTtyZXR1cm4gdWUobi5lbGVtLGUsaWUuZXhlYyh0KSxuKSxufV19LHR3ZWVuZXI6ZnVuY3Rpb24oZSx0KXtnKGUpPyh0PWUsZT1bIioiXSk6ZT1lLm1hdGNoKE0pO2Zvcih2YXIgbixyPTAsaT1lLmxlbmd0aDtyPGk7cisrKW49ZVtyXSxwdC50d2VlbmVyc1tuXT1wdC50d2VlbmVyc1tuXXx8W10scHQudHdlZW5lcnNbbl0udW5zaGlmdCh0KX0scHJlZmlsdGVyczpbY3RdLHByZWZpbHRlcjpmdW5jdGlvbihlLHQpe3Q/cHQucHJlZmlsdGVycy51bnNoaWZ0KGUpOnB0LnByZWZpbHRlcnMucHVzaChlKX19KSx3LnNwZWVkPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1lJiYib2JqZWN0Ij09dHlwZW9mIGU/dy5leHRlbmQoe30sZSk6e2NvbXBsZXRlOm58fCFuJiZ0fHxnKGUpJiZlLGR1cmF0aW9uOmUsZWFzaW5nOm4mJnR8fHQmJiFnKHQpJiZ0fTtyZXR1cm4gdy5meC5vZmY/ci5kdXJhdGlvbj0wOiJudW1iZXIiIT10eXBlb2Ygci5kdXJhdGlvbiYmKHIuZHVyYXRpb24gaW4gdy5meC5zcGVlZHM/ci5kdXJhdGlvbj13LmZ4LnNwZWVkc1tyLmR1cmF0aW9uXTpyLmR1cmF0aW9uPXcuZnguc3BlZWRzLl9kZWZhdWx0KSxudWxsIT1yLnF1ZXVlJiYhMCE9PXIucXVldWV8fChyLnF1ZXVlPSJmeCIpLHIub2xkPXIuY29tcGxldGUsci5jb21wbGV0ZT1mdW5jdGlvbigpe2coci5vbGQpJiZyLm9sZC5jYWxsKHRoaXMpLHIucXVldWUmJncuZGVxdWV1ZSh0aGlzLHIucXVldWUpfSxyfSx3LmZuLmV4dGVuZCh7ZmFkZVRvOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiB0aGlzLmZpbHRlcihhZSkuY3NzKCJvcGFjaXR5IiwwKS5zaG93KCkuZW5kKCkuYW5pbWF0ZSh7b3BhY2l0eTp0fSxlLG4scil9LGFuaW1hdGU6ZnVuY3Rpb24oZSx0LG4scil7dmFyIGk9dy5pc0VtcHR5T2JqZWN0KGUpLG89dy5zcGVlZCh0LG4sciksYT1mdW5jdGlvbigpe3ZhciB0PXB0KHRoaXMsdy5leHRlbmQoe30sZSksbyk7KGl8fEouZ2V0KHRoaXMsImZpbmlzaCIpKSYmdC5zdG9wKCEwKX07cmV0dXJuIGEuZmluaXNoPWEsaXx8ITE9PT1vLnF1ZXVlP3RoaXMuZWFjaChhKTp0aGlzLnF1ZXVlKG8ucXVldWUsYSl9LHN0b3A6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPWZ1bmN0aW9uKGUpe3ZhciB0PWUuc3RvcDtkZWxldGUgZS5zdG9wLHQobil9O3JldHVybiJzdHJpbmciIT10eXBlb2YgZSYmKG49dCx0PWUsZT12b2lkIDApLHQmJiExIT09ZSYmdGhpcy5xdWV1ZShlfHwiZngiLFtdKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD0hMCxpPW51bGwhPWUmJmUrInF1ZXVlSG9va3MiLG89dy50aW1lcnMsYT1KLmdldCh0aGlzKTtpZihpKWFbaV0mJmFbaV0uc3RvcCYmcihhW2ldKTtlbHNlIGZvcihpIGluIGEpYVtpXSYmYVtpXS5zdG9wJiZvdC50ZXN0KGkpJiZyKGFbaV0pO2ZvcihpPW8ubGVuZ3RoO2ktLTspb1tpXS5lbGVtIT09dGhpc3x8bnVsbCE9ZSYmb1tpXS5xdWV1ZSE9PWV8fChvW2ldLmFuaW0uc3RvcChuKSx0PSExLG8uc3BsaWNlKGksMSkpOyF0JiZufHx3LmRlcXVldWUodGhpcyxlKX0pfSxmaW5pc2g6ZnVuY3Rpb24oZSl7cmV0dXJuITEhPT1lJiYoZT1lfHwiZngiKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdCxuPUouZ2V0KHRoaXMpLHI9bltlKyJxdWV1ZSJdLGk9bltlKyJxdWV1ZUhvb2tzIl0sbz13LnRpbWVycyxhPXI/ci5sZW5ndGg6MDtmb3Iobi5maW5pc2g9ITAsdy5xdWV1ZSh0aGlzLGUsW10pLGkmJmkuc3RvcCYmaS5zdG9wLmNhbGwodGhpcywhMCksdD1vLmxlbmd0aDt0LS07KW9bdF0uZWxlbT09PXRoaXMmJm9bdF0ucXVldWU9PT1lJiYob1t0XS5hbmltLnN0b3AoITApLG8uc3BsaWNlKHQsMSkpO2Zvcih0PTA7dDxhO3QrKylyW3RdJiZyW3RdLmZpbmlzaCYmclt0XS5maW5pc2guY2FsbCh0aGlzKTtkZWxldGUgbi5maW5pc2h9KX19KSx3LmVhY2goWyJ0b2dnbGUiLCJzaG93IiwiaGlkZSJdLGZ1bmN0aW9uKGUsdCl7dmFyIG49dy5mblt0XTt3LmZuW3RdPWZ1bmN0aW9uKGUscixpKXtyZXR1cm4gbnVsbD09ZXx8ImJvb2xlYW4iPT10eXBlb2YgZT9uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTp0aGlzLmFuaW1hdGUodXQodCwhMCksZSxyLGkpfX0pLHcuZWFjaCh7c2xpZGVEb3duOnV0KCJzaG93Iiksc2xpZGVVcDp1dCgiaGlkZSIpLHNsaWRlVG9nZ2xlOnV0KCJ0b2dnbGUiKSxmYWRlSW46e29wYWNpdHk6InNob3cifSxmYWRlT3V0OntvcGFjaXR5OiJoaWRlIn0sZmFkZVRvZ2dsZTp7b3BhY2l0eToidG9nZ2xlIn19LGZ1bmN0aW9uKGUsdCl7dy5mbltlXT1mdW5jdGlvbihlLG4scil7cmV0dXJuIHRoaXMuYW5pbWF0ZSh0LGUsbixyKX19KSx3LnRpbWVycz1bXSx3LmZ4LnRpY2s9ZnVuY3Rpb24oKXt2YXIgZSx0PTAsbj13LnRpbWVycztmb3IobnQ9RGF0ZS5ub3coKTt0PG4ubGVuZ3RoO3QrKykoZT1uW3RdKSgpfHxuW3RdIT09ZXx8bi5zcGxpY2UodC0tLDEpO24ubGVuZ3RofHx3LmZ4LnN0b3AoKSxudD12b2lkIDB9LHcuZngudGltZXI9ZnVuY3Rpb24oZSl7dy50aW1lcnMucHVzaChlKSx3LmZ4LnN0YXJ0KCl9LHcuZnguaW50ZXJ2YWw9MTMsdy5meC5zdGFydD1mdW5jdGlvbigpe3J0fHwocnQ9ITAsYXQoKSl9LHcuZnguc3RvcD1mdW5jdGlvbigpe3J0PW51bGx9LHcuZnguc3BlZWRzPXtzbG93OjYwMCxmYXN0OjIwMCxfZGVmYXVsdDo0MDB9LHcuZm4uZGVsYXk9ZnVuY3Rpb24odCxuKXtyZXR1cm4gdD13LmZ4P3cuZnguc3BlZWRzW3RdfHx0OnQsbj1ufHwiZngiLHRoaXMucXVldWUobixmdW5jdGlvbihuLHIpe3ZhciBpPWUuc2V0VGltZW91dChuLHQpO3Iuc3RvcD1mdW5jdGlvbigpe2UuY2xlYXJUaW1lb3V0KGkpfX0pfSxmdW5jdGlvbigpe3ZhciBlPXIuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSx0PXIuY3JlYXRlRWxlbWVudCgic2VsZWN0IikuYXBwZW5kQ2hpbGQoci5jcmVhdGVFbGVtZW50KCJvcHRpb24iKSk7ZS50eXBlPSJjaGVja2JveCIsaC5jaGVja09uPSIiIT09ZS52YWx1ZSxoLm9wdFNlbGVjdGVkPXQuc2VsZWN0ZWQsKGU9ci5jcmVhdGVFbGVtZW50KCJpbnB1dCIpKS52YWx1ZT0idCIsZS50eXBlPSJyYWRpbyIsaC5yYWRpb1ZhbHVlPSJ0Ij09PWUudmFsdWV9KCk7dmFyIGR0LGh0PXcuZXhwci5hdHRySGFuZGxlO3cuZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHoodGhpcyx3LmF0dHIsZSx0LGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZUF0dHI6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3cucmVtb3ZlQXR0cih0aGlzLGUpfSl9fSksdy5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbz1lLm5vZGVUeXBlO2lmKDMhPT1vJiY4IT09byYmMiE9PW8pcmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBlLmdldEF0dHJpYnV0ZT93LnByb3AoZSx0LG4pOigxPT09byYmdy5pc1hNTERvYyhlKXx8KGk9dy5hdHRySG9va3NbdC50b0xvd2VyQ2FzZSgpXXx8KHcuZXhwci5tYXRjaC5ib29sLnRlc3QodCk/ZHQ6dm9pZCAwKSksdm9pZCAwIT09bj9udWxsPT09bj92b2lkIHcucmVtb3ZlQXR0cihlLHQpOmkmJiJzZXQiaW4gaSYmdm9pZCAwIT09KHI9aS5zZXQoZSxuLHQpKT9yOihlLnNldEF0dHJpYnV0ZSh0LG4rIiIpLG4pOmkmJiJnZXQiaW4gaSYmbnVsbCE9PShyPWkuZ2V0KGUsdCkpP3I6bnVsbD09KHI9dy5maW5kLmF0dHIoZSx0KSk/dm9pZCAwOnIpfSxhdHRySG9va3M6e3R5cGU6e3NldDpmdW5jdGlvbihlLHQpe2lmKCFoLnJhZGlvVmFsdWUmJiJyYWRpbyI9PT10JiZOKGUsImlucHV0Iikpe3ZhciBuPWUudmFsdWU7cmV0dXJuIGUuc2V0QXR0cmlidXRlKCJ0eXBlIix0KSxuJiYoZS52YWx1ZT1uKSx0fX19fSxyZW1vdmVBdHRyOmZ1bmN0aW9uKGUsdCl7dmFyIG4scj0wLGk9dCYmdC5tYXRjaChNKTtpZihpJiYxPT09ZS5ub2RlVHlwZSl3aGlsZShuPWlbcisrXSllLnJlbW92ZUF0dHJpYnV0ZShuKX19KSxkdD17c2V0OmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4hMT09PXQ/dy5yZW1vdmVBdHRyKGUsbik6ZS5zZXRBdHRyaWJ1dGUobixuKSxufX0sdy5lYWNoKHcuZXhwci5tYXRjaC5ib29sLnNvdXJjZS5tYXRjaCgvXHcrL2cpLGZ1bmN0aW9uKGUsdCl7dmFyIG49aHRbdF18fHcuZmluZC5hdHRyO2h0W3RdPWZ1bmN0aW9uKGUsdCxyKXt2YXIgaSxvLGE9dC50b0xvd2VyQ2FzZSgpO3JldHVybiByfHwobz1odFthXSxodFthXT1pLGk9bnVsbCE9bihlLHQscik/YTpudWxsLGh0W2FdPW8pLGl9fSk7dmFyIGd0PS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2kseXQ9L14oPzphfGFyZWEpJC9pO3cuZm4uZXh0ZW5kKHtwcm9wOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHoodGhpcyx3LnByb3AsZSx0LGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZVByb3A6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2RlbGV0ZSB0aGlzW3cucHJvcEZpeFtlXXx8ZV19KX19KSx3LmV4dGVuZCh7cHJvcDpmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvPWUubm9kZVR5cGU7aWYoMyE9PW8mJjghPT1vJiYyIT09bylyZXR1cm4gMT09PW8mJncuaXNYTUxEb2MoZSl8fCh0PXcucHJvcEZpeFt0XXx8dCxpPXcucHJvcEhvb2tzW3RdKSx2b2lkIDAhPT1uP2kmJiJzZXQiaW4gaSYmdm9pZCAwIT09KHI9aS5zZXQoZSxuLHQpKT9yOmVbdF09bjppJiYiZ2V0ImluIGkmJm51bGwhPT0ocj1pLmdldChlLHQpKT9yOmVbdF19LHByb3BIb29rczp7dGFiSW5kZXg6e2dldDpmdW5jdGlvbihlKXt2YXIgdD13LmZpbmQuYXR0cihlLCJ0YWJpbmRleCIpO3JldHVybiB0P3BhcnNlSW50KHQsMTApOmd0LnRlc3QoZS5ub2RlTmFtZSl8fHl0LnRlc3QoZS5ub2RlTmFtZSkmJmUuaHJlZj8wOi0xfX19LHByb3BGaXg6eyJmb3IiOiJodG1sRm9yIiwiY2xhc3MiOiJjbGFzc05hbWUifX0pLGgub3B0U2VsZWN0ZWR8fCh3LnByb3BIb29rcy5zZWxlY3RlZD17Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0PWUucGFyZW50Tm9kZTtyZXR1cm4gdCYmdC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCxudWxsfSxzZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJlbnROb2RlO3QmJih0LnNlbGVjdGVkSW5kZXgsdC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCl9fSksdy5lYWNoKFsidGFiSW5kZXgiLCJyZWFkT25seSIsIm1heExlbmd0aCIsImNlbGxTcGFjaW5nIiwiY2VsbFBhZGRpbmciLCJyb3dTcGFuIiwiY29sU3BhbiIsInVzZU1hcCIsImZyYW1lQm9yZGVyIiwiY29udGVudEVkaXRhYmxlIl0sZnVuY3Rpb24oKXt3LnByb3BGaXhbdGhpcy50b0xvd2VyQ2FzZSgpXT10aGlzfSk7ZnVuY3Rpb24gdnQoZSl7cmV0dXJuKGUubWF0Y2goTSl8fFtdKS5qb2luKCIgIil9ZnVuY3Rpb24gbXQoZSl7cmV0dXJuIGUuZ2V0QXR0cmlidXRlJiZlLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiJ9ZnVuY3Rpb24geHQoZSl7cmV0dXJuIEFycmF5LmlzQXJyYXkoZSk/ZToic3RyaW5nIj09dHlwZW9mIGU/ZS5tYXRjaChNKXx8W106W119dy5mbi5leHRlbmQoe2FkZENsYXNzOmZ1bmN0aW9uKGUpe3ZhciB0LG4scixpLG8sYSxzLHU9MDtpZihnKGUpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24odCl7dyh0aGlzKS5hZGRDbGFzcyhlLmNhbGwodGhpcyx0LG10KHRoaXMpKSl9KTtpZigodD14dChlKSkubGVuZ3RoKXdoaWxlKG49dGhpc1t1KytdKWlmKGk9bXQobikscj0xPT09bi5ub2RlVHlwZSYmIiAiK3Z0KGkpKyIgIil7YT0wO3doaWxlKG89dFthKytdKXIuaW5kZXhPZigiICIrbysiICIpPDAmJihyKz1vKyIgIik7aSE9PShzPXZ0KHIpKSYmbi5zZXRBdHRyaWJ1dGUoImNsYXNzIixzKX1yZXR1cm4gdGhpc30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oZSl7dmFyIHQsbixyLGksbyxhLHMsdT0wO2lmKGcoZSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbih0KXt3KHRoaXMpLnJlbW92ZUNsYXNzKGUuY2FsbCh0aGlzLHQsbXQodGhpcykpKX0pO2lmKCFhcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLmF0dHIoImNsYXNzIiwiIik7aWYoKHQ9eHQoZSkpLmxlbmd0aCl3aGlsZShuPXRoaXNbdSsrXSlpZihpPW10KG4pLHI9MT09PW4ubm9kZVR5cGUmJiIgIit2dChpKSsiICIpe2E9MDt3aGlsZShvPXRbYSsrXSl3aGlsZShyLmluZGV4T2YoIiAiK28rIiAiKT4tMSlyPXIucmVwbGFjZSgiICIrbysiICIsIiAiKTtpIT09KHM9dnQocikpJiZuLnNldEF0dHJpYnV0ZSgiY2xhc3MiLHMpfXJldHVybiB0aGlzfSx0b2dnbGVDbGFzczpmdW5jdGlvbihlLHQpe3ZhciBuPXR5cGVvZiBlLHI9InN0cmluZyI9PT1ufHxBcnJheS5pc0FycmF5KGUpO3JldHVybiJib29sZWFuIj09dHlwZW9mIHQmJnI/dD90aGlzLmFkZENsYXNzKGUpOnRoaXMucmVtb3ZlQ2xhc3MoZSk6ZyhlKT90aGlzLmVhY2goZnVuY3Rpb24obil7dyh0aGlzKS50b2dnbGVDbGFzcyhlLmNhbGwodGhpcyxuLG10KHRoaXMpLHQpLHQpfSk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQsaSxvLGE7aWYocil7aT0wLG89dyh0aGlzKSxhPXh0KGUpO3doaWxlKHQ9YVtpKytdKW8uaGFzQ2xhc3ModCk/by5yZW1vdmVDbGFzcyh0KTpvLmFkZENsYXNzKHQpfWVsc2Ugdm9pZCAwIT09ZSYmImJvb2xlYW4iIT09bnx8KCh0PW10KHRoaXMpKSYmSi5zZXQodGhpcywiX19jbGFzc05hbWVfXyIsdCksdGhpcy5zZXRBdHRyaWJ1dGUmJnRoaXMuc2V0QXR0cmlidXRlKCJjbGFzcyIsdHx8ITE9PT1lPyIiOkouZ2V0KHRoaXMsIl9fY2xhc3NOYW1lX18iKXx8IiIpKX0pfSxoYXNDbGFzczpmdW5jdGlvbihlKXt2YXIgdCxuLHI9MDt0PSIgIitlKyIgIjt3aGlsZShuPXRoaXNbcisrXSlpZigxPT09bi5ub2RlVHlwZSYmKCIgIit2dChtdChuKSkrIiAiKS5pbmRleE9mKHQpPi0xKXJldHVybiEwO3JldHVybiExfX0pO3ZhciBidD0vXHIvZzt3LmZuLmV4dGVuZCh7dmFsOmZ1bmN0aW9uKGUpe3ZhciB0LG4scixpPXRoaXNbMF07e2lmKGFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHI9ZyhlKSx0aGlzLmVhY2goZnVuY3Rpb24obil7dmFyIGk7MT09PXRoaXMubm9kZVR5cGUmJihudWxsPT0oaT1yP2UuY2FsbCh0aGlzLG4sdyh0aGlzKS52YWwoKSk6ZSk/aT0iIjoibnVtYmVyIj09dHlwZW9mIGk/aSs9IiI6QXJyYXkuaXNBcnJheShpKSYmKGk9dy5tYXAoaSxmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZT8iIjplKyIifSkpLCh0PXcudmFsSG9va3NbdGhpcy50eXBlXXx8dy52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSYmInNldCJpbiB0JiZ2b2lkIDAhPT10LnNldCh0aGlzLGksInZhbHVlIil8fCh0aGlzLnZhbHVlPWkpKX0pO2lmKGkpcmV0dXJuKHQ9dy52YWxIb29rc1tpLnR5cGVdfHx3LnZhbEhvb2tzW2kubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0pJiYiZ2V0ImluIHQmJnZvaWQgMCE9PShuPXQuZ2V0KGksInZhbHVlIikpP246InN0cmluZyI9PXR5cGVvZihuPWkudmFsdWUpP24ucmVwbGFjZShidCwiIik6bnVsbD09bj8iIjpufX19KSx3LmV4dGVuZCh7dmFsSG9va3M6e29wdGlvbjp7Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0PXcuZmluZC5hdHRyKGUsInZhbHVlIik7cmV0dXJuIG51bGwhPXQ/dDp2dCh3LnRleHQoZSkpfX0sc2VsZWN0OntnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQsbixyLGk9ZS5vcHRpb25zLG89ZS5zZWxlY3RlZEluZGV4LGE9InNlbGVjdC1vbmUiPT09ZS50eXBlLHM9YT9udWxsOltdLHU9YT9vKzE6aS5sZW5ndGg7Zm9yKHI9bzwwP3U6YT9vOjA7cjx1O3IrKylpZigoKG49aVtyXSkuc2VsZWN0ZWR8fHI9PT1vKSYmIW4uZGlzYWJsZWQmJighbi5wYXJlbnROb2RlLmRpc2FibGVkfHwhTihuLnBhcmVudE5vZGUsIm9wdGdyb3VwIikpKXtpZih0PXcobikudmFsKCksYSlyZXR1cm4gdDtzLnB1c2godCl9cmV0dXJuIHN9LHNldDpmdW5jdGlvbihlLHQpe3ZhciBuLHIsaT1lLm9wdGlvbnMsbz13Lm1ha2VBcnJheSh0KSxhPWkubGVuZ3RoO3doaWxlKGEtLSkoKHI9aVthXSkuc2VsZWN0ZWQ9dy5pbkFycmF5KHcudmFsSG9va3Mub3B0aW9uLmdldChyKSxvKT4tMSkmJihuPSEwKTtyZXR1cm4gbnx8KGUuc2VsZWN0ZWRJbmRleD0tMSksb319fX0pLHcuZWFjaChbInJhZGlvIiwiY2hlY2tib3giXSxmdW5jdGlvbigpe3cudmFsSG9va3NbdGhpc109e3NldDpmdW5jdGlvbihlLHQpe2lmKEFycmF5LmlzQXJyYXkodCkpcmV0dXJuIGUuY2hlY2tlZD13LmluQXJyYXkodyhlKS52YWwoKSx0KT4tMX19LGguY2hlY2tPbnx8KHcudmFsSG9va3NbdGhpc10uZ2V0PWZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT09ZS5nZXRBdHRyaWJ1dGUoInZhbHVlIik/Im9uIjplLnZhbHVlfSl9KSxoLmZvY3VzaW49Im9uZm9jdXNpbiJpbiBlO3ZhciB3dD0vXig/OmZvY3VzaW5mb2N1c3xmb2N1c291dGJsdXIpJC8sVHQ9ZnVuY3Rpb24oZSl7ZS5zdG9wUHJvcGFnYXRpb24oKX07dy5leHRlbmQody5ldmVudCx7dHJpZ2dlcjpmdW5jdGlvbih0LG4saSxvKXt2YXIgYSxzLHUsbCxjLHAsZCxoLHY9W2l8fHJdLG09Zi5jYWxsKHQsInR5cGUiKT90LnR5cGU6dCx4PWYuY2FsbCh0LCJuYW1lc3BhY2UiKT90Lm5hbWVzcGFjZS5zcGxpdCgiLiIpOltdO2lmKHM9aD11PWk9aXx8ciwzIT09aS5ub2RlVHlwZSYmOCE9PWkubm9kZVR5cGUmJiF3dC50ZXN0KG0rdy5ldmVudC50cmlnZ2VyZWQpJiYobS5pbmRleE9mKCIuIik+LTEmJihtPSh4PW0uc3BsaXQoIi4iKSkuc2hpZnQoKSx4LnNvcnQoKSksYz1tLmluZGV4T2YoIjoiKTwwJiYib24iK20sdD10W3cuZXhwYW5kb10/dDpuZXcgdy5FdmVudChtLCJvYmplY3QiPT10eXBlb2YgdCYmdCksdC5pc1RyaWdnZXI9bz8yOjMsdC5uYW1lc3BhY2U9eC5qb2luKCIuIiksdC5ybmFtZXNwYWNlPXQubmFtZXNwYWNlP25ldyBSZWdFeHAoIihefFxcLikiK3guam9pbigiXFwuKD86LipcXC58KSIpKyIoXFwufCQpIik6bnVsbCx0LnJlc3VsdD12b2lkIDAsdC50YXJnZXR8fCh0LnRhcmdldD1pKSxuPW51bGw9PW4/W3RdOncubWFrZUFycmF5KG4sW3RdKSxkPXcuZXZlbnQuc3BlY2lhbFttXXx8e30sb3x8IWQudHJpZ2dlcnx8ITEhPT1kLnRyaWdnZXIuYXBwbHkoaSxuKSkpe2lmKCFvJiYhZC5ub0J1YmJsZSYmIXkoaSkpe2ZvcihsPWQuZGVsZWdhdGVUeXBlfHxtLHd0LnRlc3QobCttKXx8KHM9cy5wYXJlbnROb2RlKTtzO3M9cy5wYXJlbnROb2RlKXYucHVzaChzKSx1PXM7dT09PShpLm93bmVyRG9jdW1lbnR8fHIpJiZ2LnB1c2godS5kZWZhdWx0Vmlld3x8dS5wYXJlbnRXaW5kb3d8fGUpfWE9MDt3aGlsZSgocz12W2ErK10pJiYhdC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKWg9cyx0LnR5cGU9YT4xP2w6ZC5iaW5kVHlwZXx8bSwocD0oSi5nZXQocywiZXZlbnRzIil8fHt9KVt0LnR5cGVdJiZKLmdldChzLCJoYW5kbGUiKSkmJnAuYXBwbHkocyxuKSwocD1jJiZzW2NdKSYmcC5hcHBseSYmWShzKSYmKHQucmVzdWx0PXAuYXBwbHkocyxuKSwhMT09PXQucmVzdWx0JiZ0LnByZXZlbnREZWZhdWx0KCkpO3JldHVybiB0LnR5cGU9bSxvfHx0LmlzRGVmYXVsdFByZXZlbnRlZCgpfHxkLl9kZWZhdWx0JiYhMSE9PWQuX2RlZmF1bHQuYXBwbHkodi5wb3AoKSxuKXx8IVkoaSl8fGMmJmcoaVttXSkmJiF5KGkpJiYoKHU9aVtjXSkmJihpW2NdPW51bGwpLHcuZXZlbnQudHJpZ2dlcmVkPW0sdC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpJiZoLmFkZEV2ZW50TGlzdGVuZXIobSxUdCksaVttXSgpLHQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSYmaC5yZW1vdmVFdmVudExpc3RlbmVyKG0sVHQpLHcuZXZlbnQudHJpZ2dlcmVkPXZvaWQgMCx1JiYoaVtjXT11KSksdC5yZXN1bHR9fSxzaW11bGF0ZTpmdW5jdGlvbihlLHQsbil7dmFyIHI9dy5leHRlbmQobmV3IHcuRXZlbnQsbix7dHlwZTplLGlzU2ltdWxhdGVkOiEwfSk7dy5ldmVudC50cmlnZ2VyKHIsbnVsbCx0KX19KSx3LmZuLmV4dGVuZCh7dHJpZ2dlcjpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt3LmV2ZW50LnRyaWdnZXIoZSx0LHRoaXMpfSl9LHRyaWdnZXJIYW5kbGVyOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpc1swXTtpZihuKXJldHVybiB3LmV2ZW50LnRyaWdnZXIoZSx0LG4sITApfX0pLGguZm9jdXNpbnx8dy5lYWNoKHtmb2N1czoiZm9jdXNpbiIsYmx1cjoiZm9jdXNvdXQifSxmdW5jdGlvbihlLHQpe3ZhciBuPWZ1bmN0aW9uKGUpe3cuZXZlbnQuc2ltdWxhdGUodCxlLnRhcmdldCx3LmV2ZW50LmZpeChlKSl9O3cuZXZlbnQuc3BlY2lhbFt0XT17c2V0dXA6ZnVuY3Rpb24oKXt2YXIgcj10aGlzLm93bmVyRG9jdW1lbnR8fHRoaXMsaT1KLmFjY2VzcyhyLHQpO2l8fHIuYWRkRXZlbnRMaXN0ZW5lcihlLG4sITApLEouYWNjZXNzKHIsdCwoaXx8MCkrMSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7dmFyIHI9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLGk9Si5hY2Nlc3Mocix0KS0xO2k/Si5hY2Nlc3Mocix0LGkpOihyLnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxuLCEwKSxKLnJlbW92ZShyLHQpKX19fSk7dmFyIEN0PWUubG9jYXRpb24sRXQ9RGF0ZS5ub3coKSxrdD0vXD8vO3cucGFyc2VYTUw9ZnVuY3Rpb24odCl7dmFyIG47aWYoIXR8fCJzdHJpbmciIT10eXBlb2YgdClyZXR1cm4gbnVsbDt0cnl7bj0obmV3IGUuRE9NUGFyc2VyKS5wYXJzZUZyb21TdHJpbmcodCwidGV4dC94bWwiKX1jYXRjaChlKXtuPXZvaWQgMH1yZXR1cm4gbiYmIW4uZ2V0RWxlbWVudHNCeVRhZ05hbWUoInBhcnNlcmVycm9yIikubGVuZ3RofHx3LmVycm9yKCJJbnZhbGlkIFhNTDogIit0KSxufTt2YXIgU3Q9L1xbXF0kLyxEdD0vXHI/XG4vZyxOdD0vXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2ksQXQ9L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8a2V5Z2VuKS9pO2Z1bmN0aW9uIGp0KGUsdCxuLHIpe3ZhciBpO2lmKEFycmF5LmlzQXJyYXkodCkpdy5lYWNoKHQsZnVuY3Rpb24odCxpKXtufHxTdC50ZXN0KGUpP3IoZSxpKTpqdChlKyJbIisoIm9iamVjdCI9PXR5cGVvZiBpJiZudWxsIT1pP3Q6IiIpKyJdIixpLG4scil9KTtlbHNlIGlmKG58fCJvYmplY3QiIT09eCh0KSlyKGUsdCk7ZWxzZSBmb3IoaSBpbiB0KWp0KGUrIlsiK2krIl0iLHRbaV0sbixyKX13LnBhcmFtPWZ1bmN0aW9uKGUsdCl7dmFyIG4scj1bXSxpPWZ1bmN0aW9uKGUsdCl7dmFyIG49Zyh0KT90KCk6dDtyW3IubGVuZ3RoXT1lbmNvZGVVUklDb21wb25lbnQoZSkrIj0iK2VuY29kZVVSSUNvbXBvbmVudChudWxsPT1uPyIiOm4pfTtpZihBcnJheS5pc0FycmF5KGUpfHxlLmpxdWVyeSYmIXcuaXNQbGFpbk9iamVjdChlKSl3LmVhY2goZSxmdW5jdGlvbigpe2kodGhpcy5uYW1lLHRoaXMudmFsdWUpfSk7ZWxzZSBmb3IobiBpbiBlKWp0KG4sZVtuXSx0LGkpO3JldHVybiByLmpvaW4oIiYiKX0sdy5mbi5leHRlbmQoe3NlcmlhbGl6ZTpmdW5jdGlvbigpe3JldHVybiB3LnBhcmFtKHRoaXMuc2VyaWFsaXplQXJyYXkoKSl9LHNlcmlhbGl6ZUFycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7dmFyIGU9dy5wcm9wKHRoaXMsImVsZW1lbnRzIik7cmV0dXJuIGU/dy5tYWtlQXJyYXkoZSk6dGhpc30pLmZpbHRlcihmdW5jdGlvbigpe3ZhciBlPXRoaXMudHlwZTtyZXR1cm4gdGhpcy5uYW1lJiYhdyh0aGlzKS5pcygiOmRpc2FibGVkIikmJkF0LnRlc3QodGhpcy5ub2RlTmFtZSkmJiFOdC50ZXN0KGUpJiYodGhpcy5jaGVja2VkfHwhcGUudGVzdChlKSl9KS5tYXAoZnVuY3Rpb24oZSx0KXt2YXIgbj13KHRoaXMpLnZhbCgpO3JldHVybiBudWxsPT1uP251bGw6QXJyYXkuaXNBcnJheShuKT93Lm1hcChuLGZ1bmN0aW9uKGUpe3JldHVybntuYW1lOnQubmFtZSx2YWx1ZTplLnJlcGxhY2UoRHQsIlxyXG4iKX19KTp7bmFtZTp0Lm5hbWUsdmFsdWU6bi5yZXBsYWNlKER0LCJcclxuIil9fSkuZ2V0KCl9fSk7dmFyIHF0PS8lMjAvZyxMdD0vIy4qJC8sSHQ9LyhbPyZdKV89W14mXSovLE90PS9eKC4qPyk6WyBcdF0qKFteXHJcbl0qKSQvZ20sUHQ9L14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8sTXQ9L14oPzpHRVR8SEVBRCkkLyxSdD0vXlwvXC8vLEl0PXt9LFd0PXt9LCR0PSIqLyIuY29uY2F0KCIqIiksQnQ9ci5jcmVhdGVFbGVtZW50KCJhIik7QnQuaHJlZj1DdC5ocmVmO2Z1bmN0aW9uIEZ0KGUpe3JldHVybiBmdW5jdGlvbih0LG4peyJzdHJpbmciIT10eXBlb2YgdCYmKG49dCx0PSIqIik7dmFyIHIsaT0wLG89dC50b0xvd2VyQ2FzZSgpLm1hdGNoKE0pfHxbXTtpZihnKG4pKXdoaWxlKHI9b1tpKytdKSIrIj09PXJbMF0/KHI9ci5zbGljZSgxKXx8IioiLChlW3JdPWVbcl18fFtdKS51bnNoaWZ0KG4pKTooZVtyXT1lW3JdfHxbXSkucHVzaChuKX19ZnVuY3Rpb24gX3QoZSx0LG4scil7dmFyIGk9e30sbz1lPT09V3Q7ZnVuY3Rpb24gYShzKXt2YXIgdTtyZXR1cm4gaVtzXT0hMCx3LmVhY2goZVtzXXx8W10sZnVuY3Rpb24oZSxzKXt2YXIgbD1zKHQsbixyKTtyZXR1cm4ic3RyaW5nIiE9dHlwZW9mIGx8fG98fGlbbF0/bz8hKHU9bCk6dm9pZCAwOih0LmRhdGFUeXBlcy51bnNoaWZ0KGwpLGEobCksITEpfSksdX1yZXR1cm4gYSh0LmRhdGFUeXBlc1swXSl8fCFpWyIqIl0mJmEoIioiKX1mdW5jdGlvbiB6dChlLHQpe3ZhciBuLHIsaT13LmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9uc3x8e307Zm9yKG4gaW4gdCl2b2lkIDAhPT10W25dJiYoKGlbbl0/ZTpyfHwocj17fSkpW25dPXRbbl0pO3JldHVybiByJiZ3LmV4dGVuZCghMCxlLHIpLGV9ZnVuY3Rpb24gWHQoZSx0LG4pe3ZhciByLGksbyxhLHM9ZS5jb250ZW50cyx1PWUuZGF0YVR5cGVzO3doaWxlKCIqIj09PXVbMF0pdS5zaGlmdCgpLHZvaWQgMD09PXImJihyPWUubWltZVR5cGV8fHQuZ2V0UmVzcG9uc2VIZWFkZXIoIkNvbnRlbnQtVHlwZSIpKTtpZihyKWZvcihpIGluIHMpaWYoc1tpXSYmc1tpXS50ZXN0KHIpKXt1LnVuc2hpZnQoaSk7YnJlYWt9aWYodVswXWluIG4pbz11WzBdO2Vsc2V7Zm9yKGkgaW4gbil7aWYoIXVbMF18fGUuY29udmVydGVyc1tpKyIgIit1WzBdXSl7bz1pO2JyZWFrfWF8fChhPWkpfW89b3x8YX1pZihvKXJldHVybiBvIT09dVswXSYmdS51bnNoaWZ0KG8pLG5bb119ZnVuY3Rpb24gVXQoZSx0LG4scil7dmFyIGksbyxhLHMsdSxsPXt9LGM9ZS5kYXRhVHlwZXMuc2xpY2UoKTtpZihjWzFdKWZvcihhIGluIGUuY29udmVydGVycylsW2EudG9Mb3dlckNhc2UoKV09ZS5jb252ZXJ0ZXJzW2FdO289Yy5zaGlmdCgpO3doaWxlKG8paWYoZS5yZXNwb25zZUZpZWxkc1tvXSYmKG5bZS5yZXNwb25zZUZpZWxkc1tvXV09dCksIXUmJnImJmUuZGF0YUZpbHRlciYmKHQ9ZS5kYXRhRmlsdGVyKHQsZS5kYXRhVHlwZSkpLHU9byxvPWMuc2hpZnQoKSlpZigiKiI9PT1vKW89dTtlbHNlIGlmKCIqIiE9PXUmJnUhPT1vKXtpZighKGE9bFt1KyIgIitvXXx8bFsiKiAiK29dKSlmb3IoaSBpbiBsKWlmKChzPWkuc3BsaXQoIiAiKSlbMV09PT1vJiYoYT1sW3UrIiAiK3NbMF1dfHxsWyIqICIrc1swXV0pKXshMD09PWE/YT1sW2ldOiEwIT09bFtpXSYmKG89c1swXSxjLnVuc2hpZnQoc1sxXSkpO2JyZWFrfWlmKCEwIT09YSlpZihhJiZlWyJ0aHJvd3MiXSl0PWEodCk7ZWxzZSB0cnl7dD1hKHQpfWNhdGNoKGUpe3JldHVybntzdGF0ZToicGFyc2VyZXJyb3IiLGVycm9yOmE/ZToiTm8gY29udmVyc2lvbiBmcm9tICIrdSsiIHRvICIrb319fXJldHVybntzdGF0ZToic3VjY2VzcyIsZGF0YTp0fX13LmV4dGVuZCh7YWN0aXZlOjAsbGFzdE1vZGlmaWVkOnt9LGV0YWc6e30sYWpheFNldHRpbmdzOnt1cmw6Q3QuaHJlZix0eXBlOiJHRVQiLGlzTG9jYWw6UHQudGVzdChDdC5wcm90b2NvbCksZ2xvYmFsOiEwLHByb2Nlc3NEYXRhOiEwLGFzeW5jOiEwLGNvbnRlbnRUeXBlOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLGFjY2VwdHM6eyIqIjokdCx0ZXh0OiJ0ZXh0L3BsYWluIixodG1sOiJ0ZXh0L2h0bWwiLHhtbDoiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCIsanNvbjoiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0In0sY29udGVudHM6e3htbDovXGJ4bWxcYi8saHRtbDovXGJodG1sLyxqc29uOi9cYmpzb25cYi99LHJlc3BvbnNlRmllbGRzOnt4bWw6InJlc3BvbnNlWE1MIix0ZXh0OiJyZXNwb25zZVRleHQiLGpzb246InJlc3BvbnNlSlNPTiJ9LGNvbnZlcnRlcnM6eyIqIHRleHQiOlN0cmluZywidGV4dCBodG1sIjohMCwidGV4dCBqc29uIjpKU09OLnBhcnNlLCJ0ZXh0IHhtbCI6dy5wYXJzZVhNTH0sZmxhdE9wdGlvbnM6e3VybDohMCxjb250ZXh0OiEwfX0sYWpheFNldHVwOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ/enQoenQoZSx3LmFqYXhTZXR0aW5ncyksdCk6enQody5hamF4U2V0dGluZ3MsZSl9LGFqYXhQcmVmaWx0ZXI6RnQoSXQpLGFqYXhUcmFuc3BvcnQ6RnQoV3QpLGFqYXg6ZnVuY3Rpb24odCxuKXsib2JqZWN0Ij09dHlwZW9mIHQmJihuPXQsdD12b2lkIDApLG49bnx8e307dmFyIGksbyxhLHMsdSxsLGMsZixwLGQsaD13LmFqYXhTZXR1cCh7fSxuKSxnPWguY29udGV4dHx8aCx5PWguY29udGV4dCYmKGcubm9kZVR5cGV8fGcuanF1ZXJ5KT93KGcpOncuZXZlbnQsdj13LkRlZmVycmVkKCksbT13LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSx4PWguc3RhdHVzQ29kZXx8e30sYj17fSxUPXt9LEM9ImNhbmNlbGVkIixFPXtyZWFkeVN0YXRlOjAsZ2V0UmVzcG9uc2VIZWFkZXI6ZnVuY3Rpb24oZSl7dmFyIHQ7aWYoYyl7aWYoIXMpe3M9e307d2hpbGUodD1PdC5leGVjKGEpKXNbdFsxXS50b0xvd2VyQ2FzZSgpXT10WzJdfXQ9c1tlLnRvTG93ZXJDYXNlKCldfXJldHVybiBudWxsPT10P251bGw6dH0sZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOmZ1bmN0aW9uKCl7cmV0dXJuIGM/YTpudWxsfSxzZXRSZXF1ZXN0SGVhZGVyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIG51bGw9PWMmJihlPVRbZS50b0xvd2VyQ2FzZSgpXT1UW2UudG9Mb3dlckNhc2UoKV18fGUsYltlXT10KSx0aGlzfSxvdmVycmlkZU1pbWVUeXBlOmZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT1jJiYoaC5taW1lVHlwZT1lKSx0aGlzfSxzdGF0dXNDb2RlOmZ1bmN0aW9uKGUpe3ZhciB0O2lmKGUpaWYoYylFLmFsd2F5cyhlW0Uuc3RhdHVzXSk7ZWxzZSBmb3IodCBpbiBlKXhbdF09W3hbdF0sZVt0XV07cmV0dXJuIHRoaXN9LGFib3J0OmZ1bmN0aW9uKGUpe3ZhciB0PWV8fEM7cmV0dXJuIGkmJmkuYWJvcnQodCksaygwLHQpLHRoaXN9fTtpZih2LnByb21pc2UoRSksaC51cmw9KCh0fHxoLnVybHx8Q3QuaHJlZikrIiIpLnJlcGxhY2UoUnQsQ3QucHJvdG9jb2wrIi8vIiksaC50eXBlPW4ubWV0aG9kfHxuLnR5cGV8fGgubWV0aG9kfHxoLnR5cGUsaC5kYXRhVHlwZXM9KGguZGF0YVR5cGV8fCIqIikudG9Mb3dlckNhc2UoKS5tYXRjaChNKXx8WyIiXSxudWxsPT1oLmNyb3NzRG9tYWluKXtsPXIuY3JlYXRlRWxlbWVudCgiYSIpO3RyeXtsLmhyZWY9aC51cmwsbC5ocmVmPWwuaHJlZixoLmNyb3NzRG9tYWluPUJ0LnByb3RvY29sKyIvLyIrQnQuaG9zdCE9bC5wcm90b2NvbCsiLy8iK2wuaG9zdH1jYXRjaChlKXtoLmNyb3NzRG9tYWluPSEwfX1pZihoLmRhdGEmJmgucHJvY2Vzc0RhdGEmJiJzdHJpbmciIT10eXBlb2YgaC5kYXRhJiYoaC5kYXRhPXcucGFyYW0oaC5kYXRhLGgudHJhZGl0aW9uYWwpKSxfdChJdCxoLG4sRSksYylyZXR1cm4gRTsoZj13LmV2ZW50JiZoLmdsb2JhbCkmJjA9PXcuYWN0aXZlKysmJncuZXZlbnQudHJpZ2dlcigiYWpheFN0YXJ0IiksaC50eXBlPWgudHlwZS50b1VwcGVyQ2FzZSgpLGguaGFzQ29udGVudD0hTXQudGVzdChoLnR5cGUpLG89aC51cmwucmVwbGFjZShMdCwiIiksaC5oYXNDb250ZW50P2guZGF0YSYmaC5wcm9jZXNzRGF0YSYmMD09PShoLmNvbnRlbnRUeXBlfHwiIikuaW5kZXhPZigiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikmJihoLmRhdGE9aC5kYXRhLnJlcGxhY2UocXQsIisiKSk6KGQ9aC51cmwuc2xpY2Uoby5sZW5ndGgpLGguZGF0YSYmKGgucHJvY2Vzc0RhdGF8fCJzdHJpbmciPT10eXBlb2YgaC5kYXRhKSYmKG8rPShrdC50ZXN0KG8pPyImIjoiPyIpK2guZGF0YSxkZWxldGUgaC5kYXRhKSwhMT09PWguY2FjaGUmJihvPW8ucmVwbGFjZShIdCwiJDEiKSxkPShrdC50ZXN0KG8pPyImIjoiPyIpKyJfPSIrRXQrKytkKSxoLnVybD1vK2QpLGguaWZNb2RpZmllZCYmKHcubGFzdE1vZGlmaWVkW29dJiZFLnNldFJlcXVlc3RIZWFkZXIoIklmLU1vZGlmaWVkLVNpbmNlIix3Lmxhc3RNb2RpZmllZFtvXSksdy5ldGFnW29dJiZFLnNldFJlcXVlc3RIZWFkZXIoIklmLU5vbmUtTWF0Y2giLHcuZXRhZ1tvXSkpLChoLmRhdGEmJmguaGFzQ29udGVudCYmITEhPT1oLmNvbnRlbnRUeXBlfHxuLmNvbnRlbnRUeXBlKSYmRS5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLGguY29udGVudFR5cGUpLEUuc2V0UmVxdWVzdEhlYWRlcigiQWNjZXB0IixoLmRhdGFUeXBlc1swXSYmaC5hY2NlcHRzW2guZGF0YVR5cGVzWzBdXT9oLmFjY2VwdHNbaC5kYXRhVHlwZXNbMF1dKygiKiIhPT1oLmRhdGFUeXBlc1swXT8iLCAiKyR0KyI7IHE9MC4wMSI6IiIpOmguYWNjZXB0c1siKiJdKTtmb3IocCBpbiBoLmhlYWRlcnMpRS5zZXRSZXF1ZXN0SGVhZGVyKHAsaC5oZWFkZXJzW3BdKTtpZihoLmJlZm9yZVNlbmQmJighMT09PWguYmVmb3JlU2VuZC5jYWxsKGcsRSxoKXx8YykpcmV0dXJuIEUuYWJvcnQoKTtpZihDPSJhYm9ydCIsbS5hZGQoaC5jb21wbGV0ZSksRS5kb25lKGguc3VjY2VzcyksRS5mYWlsKGguZXJyb3IpLGk9X3QoV3QsaCxuLEUpKXtpZihFLnJlYWR5U3RhdGU9MSxmJiZ5LnRyaWdnZXIoImFqYXhTZW5kIixbRSxoXSksYylyZXR1cm4gRTtoLmFzeW5jJiZoLnRpbWVvdXQ+MCYmKHU9ZS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7RS5hYm9ydCgidGltZW91dCIpfSxoLnRpbWVvdXQpKTt0cnl7Yz0hMSxpLnNlbmQoYixrKX1jYXRjaChlKXtpZihjKXRocm93IGU7aygtMSxlKX19ZWxzZSBrKC0xLCJObyBUcmFuc3BvcnQiKTtmdW5jdGlvbiBrKHQsbixyLHMpe3ZhciBsLHAsZCxiLFQsQz1uO2N8fChjPSEwLHUmJmUuY2xlYXJUaW1lb3V0KHUpLGk9dm9pZCAwLGE9c3x8IiIsRS5yZWFkeVN0YXRlPXQ+MD80OjAsbD10Pj0yMDAmJnQ8MzAwfHwzMDQ9PT10LHImJihiPVh0KGgsRSxyKSksYj1VdChoLGIsRSxsKSxsPyhoLmlmTW9kaWZpZWQmJigoVD1FLmdldFJlc3BvbnNlSGVhZGVyKCJMYXN0LU1vZGlmaWVkIikpJiYody5sYXN0TW9kaWZpZWRbb109VCksKFQ9RS5nZXRSZXNwb25zZUhlYWRlcigiZXRhZyIpKSYmKHcuZXRhZ1tvXT1UKSksMjA0PT09dHx8IkhFQUQiPT09aC50eXBlP0M9Im5vY29udGVudCI6MzA0PT09dD9DPSJub3Rtb2RpZmllZCI6KEM9Yi5zdGF0ZSxwPWIuZGF0YSxsPSEoZD1iLmVycm9yKSkpOihkPUMsIXQmJkN8fChDPSJlcnJvciIsdDwwJiYodD0wKSkpLEUuc3RhdHVzPXQsRS5zdGF0dXNUZXh0PShufHxDKSsiIixsP3YucmVzb2x2ZVdpdGgoZyxbcCxDLEVdKTp2LnJlamVjdFdpdGgoZyxbRSxDLGRdKSxFLnN0YXR1c0NvZGUoeCkseD12b2lkIDAsZiYmeS50cmlnZ2VyKGw/ImFqYXhTdWNjZXNzIjoiYWpheEVycm9yIixbRSxoLGw/cDpkXSksbS5maXJlV2l0aChnLFtFLENdKSxmJiYoeS50cmlnZ2VyKCJhamF4Q29tcGxldGUiLFtFLGhdKSwtLXcuYWN0aXZlfHx3LmV2ZW50LnRyaWdnZXIoImFqYXhTdG9wIikpKX1yZXR1cm4gRX0sZ2V0SlNPTjpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHcuZ2V0KGUsdCxuLCJqc29uIil9LGdldFNjcmlwdDpmdW5jdGlvbihlLHQpe3JldHVybiB3LmdldChlLHZvaWQgMCx0LCJzY3JpcHQiKX19KSx3LmVhY2goWyJnZXQiLCJwb3N0Il0sZnVuY3Rpb24oZSx0KXt3W3RdPWZ1bmN0aW9uKGUsbixyLGkpe3JldHVybiBnKG4pJiYoaT1pfHxyLHI9bixuPXZvaWQgMCksdy5hamF4KHcuZXh0ZW5kKHt1cmw6ZSx0eXBlOnQsZGF0YVR5cGU6aSxkYXRhOm4sc3VjY2VzczpyfSx3LmlzUGxhaW5PYmplY3QoZSkmJmUpKX19KSx3Ll9ldmFsVXJsPWZ1bmN0aW9uKGUpe3JldHVybiB3LmFqYXgoe3VybDplLHR5cGU6IkdFVCIsZGF0YVR5cGU6InNjcmlwdCIsY2FjaGU6ITAsYXN5bmM6ITEsZ2xvYmFsOiExLCJ0aHJvd3MiOiEwfSl9LHcuZm4uZXh0ZW5kKHt3cmFwQWxsOmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiB0aGlzWzBdJiYoZyhlKSYmKGU9ZS5jYWxsKHRoaXNbMF0pKSx0PXcoZSx0aGlzWzBdLm93bmVyRG9jdW1lbnQpLmVxKDApLmNsb25lKCEwKSx0aGlzWzBdLnBhcmVudE5vZGUmJnQuaW5zZXJ0QmVmb3JlKHRoaXNbMF0pLHQubWFwKGZ1bmN0aW9uKCl7dmFyIGU9dGhpczt3aGlsZShlLmZpcnN0RWxlbWVudENoaWxkKWU9ZS5maXJzdEVsZW1lbnRDaGlsZDtyZXR1cm4gZX0pLmFwcGVuZCh0aGlzKSksdGhpc30sd3JhcElubmVyOmZ1bmN0aW9uKGUpe3JldHVybiBnKGUpP3RoaXMuZWFjaChmdW5jdGlvbih0KXt3KHRoaXMpLndyYXBJbm5lcihlLmNhbGwodGhpcyx0KSl9KTp0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD13KHRoaXMpLG49dC5jb250ZW50cygpO24ubGVuZ3RoP24ud3JhcEFsbChlKTp0LmFwcGVuZChlKX0pfSx3cmFwOmZ1bmN0aW9uKGUpe3ZhciB0PWcoZSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihuKXt3KHRoaXMpLndyYXBBbGwodD9lLmNhbGwodGhpcyxuKTplKX0pfSx1bndyYXA6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucGFyZW50KGUpLm5vdCgiYm9keSIpLmVhY2goZnVuY3Rpb24oKXt3KHRoaXMpLnJlcGxhY2VXaXRoKHRoaXMuY2hpbGROb2Rlcyl9KSx0aGlzfX0pLHcuZXhwci5wc2V1ZG9zLmhpZGRlbj1mdW5jdGlvbihlKXtyZXR1cm4hdy5leHByLnBzZXVkb3MudmlzaWJsZShlKX0sdy5leHByLnBzZXVkb3MudmlzaWJsZT1mdW5jdGlvbihlKXtyZXR1cm4hIShlLm9mZnNldFdpZHRofHxlLm9mZnNldEhlaWdodHx8ZS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCl9LHcuYWpheFNldHRpbmdzLnhocj1mdW5jdGlvbigpe3RyeXtyZXR1cm4gbmV3IGUuWE1MSHR0cFJlcXVlc3R9Y2F0Y2goZSl7fX07dmFyIFZ0PXswOjIwMCwxMjIzOjIwNH0sR3Q9dy5hamF4U2V0dGluZ3MueGhyKCk7aC5jb3JzPSEhR3QmJiJ3aXRoQ3JlZGVudGlhbHMiaW4gR3QsaC5hamF4PUd0PSEhR3Qsdy5hamF4VHJhbnNwb3J0KGZ1bmN0aW9uKHQpe3ZhciBuLHI7aWYoaC5jb3JzfHxHdCYmIXQuY3Jvc3NEb21haW4pcmV0dXJue3NlbmQ6ZnVuY3Rpb24oaSxvKXt2YXIgYSxzPXQueGhyKCk7aWYocy5vcGVuKHQudHlwZSx0LnVybCx0LmFzeW5jLHQudXNlcm5hbWUsdC5wYXNzd29yZCksdC54aHJGaWVsZHMpZm9yKGEgaW4gdC54aHJGaWVsZHMpc1thXT10LnhockZpZWxkc1thXTt0Lm1pbWVUeXBlJiZzLm92ZXJyaWRlTWltZVR5cGUmJnMub3ZlcnJpZGVNaW1lVHlwZSh0Lm1pbWVUeXBlKSx0LmNyb3NzRG9tYWlufHxpWyJYLVJlcXVlc3RlZC1XaXRoIl18fChpWyJYLVJlcXVlc3RlZC1XaXRoIl09IlhNTEh0dHBSZXF1ZXN0Iik7Zm9yKGEgaW4gaSlzLnNldFJlcXVlc3RIZWFkZXIoYSxpW2FdKTtuPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbigpe24mJihuPXI9cy5vbmxvYWQ9cy5vbmVycm9yPXMub25hYm9ydD1zLm9udGltZW91dD1zLm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsLCJhYm9ydCI9PT1lP3MuYWJvcnQoKToiZXJyb3IiPT09ZT8ibnVtYmVyIiE9dHlwZW9mIHMuc3RhdHVzP28oMCwiZXJyb3IiKTpvKHMuc3RhdHVzLHMuc3RhdHVzVGV4dCk6byhWdFtzLnN0YXR1c118fHMuc3RhdHVzLHMuc3RhdHVzVGV4dCwidGV4dCIhPT0ocy5yZXNwb25zZVR5cGV8fCJ0ZXh0Iil8fCJzdHJpbmciIT10eXBlb2Ygcy5yZXNwb25zZVRleHQ/e2JpbmFyeTpzLnJlc3BvbnNlfTp7dGV4dDpzLnJlc3BvbnNlVGV4dH0scy5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkpfX0scy5vbmxvYWQ9bigpLHI9cy5vbmVycm9yPXMub250aW1lb3V0PW4oImVycm9yIiksdm9pZCAwIT09cy5vbmFib3J0P3Mub25hYm9ydD1yOnMub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ND09PXMucmVhZHlTdGF0ZSYmZS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7biYmcigpfSl9LG49bigiYWJvcnQiKTt0cnl7cy5zZW5kKHQuaGFzQ29udGVudCYmdC5kYXRhfHxudWxsKX1jYXRjaChlKXtpZihuKXRocm93IGV9fSxhYm9ydDpmdW5jdGlvbigpe24mJm4oKX19fSksdy5hamF4UHJlZmlsdGVyKGZ1bmN0aW9uKGUpe2UuY3Jvc3NEb21haW4mJihlLmNvbnRlbnRzLnNjcmlwdD0hMSl9KSx3LmFqYXhTZXR1cCh7YWNjZXB0czp7c2NyaXB0OiJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdCJ9LGNvbnRlbnRzOntzY3JpcHQ6L1xiKD86amF2YXxlY21hKXNjcmlwdFxiL30sY29udmVydGVyczp7InRleHQgc2NyaXB0IjpmdW5jdGlvbihlKXtyZXR1cm4gdy5nbG9iYWxFdmFsKGUpLGV9fX0pLHcuYWpheFByZWZpbHRlcigic2NyaXB0IixmdW5jdGlvbihlKXt2b2lkIDA9PT1lLmNhY2hlJiYoZS5jYWNoZT0hMSksZS5jcm9zc0RvbWFpbiYmKGUudHlwZT0iR0VUIil9KSx3LmFqYXhUcmFuc3BvcnQoInNjcmlwdCIsZnVuY3Rpb24oZSl7aWYoZS5jcm9zc0RvbWFpbil7dmFyIHQsbjtyZXR1cm57c2VuZDpmdW5jdGlvbihpLG8pe3Q9dygiPHNjcmlwdD4iKS5wcm9wKHtjaGFyc2V0OmUuc2NyaXB0Q2hhcnNldCxzcmM6ZS51cmx9KS5vbigibG9hZCBlcnJvciIsbj1mdW5jdGlvbihlKXt0LnJlbW92ZSgpLG49bnVsbCxlJiZvKCJlcnJvciI9PT1lLnR5cGU/NDA0OjIwMCxlLnR5cGUpfSksci5oZWFkLmFwcGVuZENoaWxkKHRbMF0pfSxhYm9ydDpmdW5jdGlvbigpe24mJm4oKX19fX0pO3ZhciBZdD1bXSxRdD0vKD0pXD8oPz0mfCQpfFw/XD8vO3cuYWpheFNldHVwKHtqc29ucDoiY2FsbGJhY2siLGpzb25wQ2FsbGJhY2s6ZnVuY3Rpb24oKXt2YXIgZT1ZdC5wb3AoKXx8dy5leHBhbmRvKyJfIitFdCsrO3JldHVybiB0aGlzW2VdPSEwLGV9fSksdy5hamF4UHJlZmlsdGVyKCJqc29uIGpzb25wIixmdW5jdGlvbih0LG4scil7dmFyIGksbyxhLHM9ITEhPT10Lmpzb25wJiYoUXQudGVzdCh0LnVybCk/InVybCI6InN0cmluZyI9PXR5cGVvZiB0LmRhdGEmJjA9PT0odC5jb250ZW50VHlwZXx8IiIpLmluZGV4T2YoImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpJiZRdC50ZXN0KHQuZGF0YSkmJiJkYXRhIik7aWYoc3x8Impzb25wIj09PXQuZGF0YVR5cGVzWzBdKXJldHVybiBpPXQuanNvbnBDYWxsYmFjaz1nKHQuanNvbnBDYWxsYmFjayk/dC5qc29ucENhbGxiYWNrKCk6dC5qc29ucENhbGxiYWNrLHM/dFtzXT10W3NdLnJlcGxhY2UoUXQsIiQxIitpKTohMSE9PXQuanNvbnAmJih0LnVybCs9KGt0LnRlc3QodC51cmwpPyImIjoiPyIpK3QuanNvbnArIj0iK2kpLHQuY29udmVydGVyc1sic2NyaXB0IGpzb24iXT1mdW5jdGlvbigpe3JldHVybiBhfHx3LmVycm9yKGkrIiB3YXMgbm90IGNhbGxlZCIpLGFbMF19LHQuZGF0YVR5cGVzWzBdPSJqc29uIixvPWVbaV0sZVtpXT1mdW5jdGlvbigpe2E9YXJndW1lbnRzfSxyLmFsd2F5cyhmdW5jdGlvbigpe3ZvaWQgMD09PW8/dyhlKS5yZW1vdmVQcm9wKGkpOmVbaV09byx0W2ldJiYodC5qc29ucENhbGxiYWNrPW4uanNvbnBDYWxsYmFjayxZdC5wdXNoKGkpKSxhJiZnKG8pJiZvKGFbMF0pLGE9bz12b2lkIDB9KSwic2NyaXB0In0pLGguY3JlYXRlSFRNTERvY3VtZW50PWZ1bmN0aW9uKCl7dmFyIGU9ci5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoIiIpLmJvZHk7cmV0dXJuIGUuaW5uZXJIVE1MPSI8Zm9ybT48L2Zvcm0+PGZvcm0+PC9mb3JtPiIsMj09PWUuY2hpbGROb2Rlcy5sZW5ndGh9KCksdy5wYXJzZUhUTUw9ZnVuY3Rpb24oZSx0LG4pe2lmKCJzdHJpbmciIT10eXBlb2YgZSlyZXR1cm5bXTsiYm9vbGVhbiI9PXR5cGVvZiB0JiYobj10LHQ9ITEpO3ZhciBpLG8sYTtyZXR1cm4gdHx8KGguY3JlYXRlSFRNTERvY3VtZW50PygoaT0odD1yLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikpLmNyZWF0ZUVsZW1lbnQoImJhc2UiKSkuaHJlZj1yLmxvY2F0aW9uLmhyZWYsdC5oZWFkLmFwcGVuZENoaWxkKGkpKTp0PXIpLG89QS5leGVjKGUpLGE9IW4mJltdLG8/W3QuY3JlYXRlRWxlbWVudChvWzFdKV06KG89eGUoW2VdLHQsYSksYSYmYS5sZW5ndGgmJncoYSkucmVtb3ZlKCksdy5tZXJnZShbXSxvLmNoaWxkTm9kZXMpKX0sdy5mbi5sb2FkPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYT10aGlzLHM9ZS5pbmRleE9mKCIgIik7cmV0dXJuIHM+LTEmJihyPXZ0KGUuc2xpY2UocykpLGU9ZS5zbGljZSgwLHMpKSxnKHQpPyhuPXQsdD12b2lkIDApOnQmJiJvYmplY3QiPT10eXBlb2YgdCYmKGk9IlBPU1QiKSxhLmxlbmd0aD4wJiZ3LmFqYXgoe3VybDplLHR5cGU6aXx8IkdFVCIsZGF0YVR5cGU6Imh0bWwiLGRhdGE6dH0pLmRvbmUoZnVuY3Rpb24oZSl7bz1hcmd1bWVudHMsYS5odG1sKHI/dygiPGRpdj4iKS5hcHBlbmQody5wYXJzZUhUTUwoZSkpLmZpbmQocik6ZSl9KS5hbHdheXMobiYmZnVuY3Rpb24oZSx0KXthLmVhY2goZnVuY3Rpb24oKXtuLmFwcGx5KHRoaXMsb3x8W2UucmVzcG9uc2VUZXh0LHQsZV0pfSl9KSx0aGlzfSx3LmVhY2goWyJhamF4U3RhcnQiLCJhamF4U3RvcCIsImFqYXhDb21wbGV0ZSIsImFqYXhFcnJvciIsImFqYXhTdWNjZXNzIiwiYWpheFNlbmQiXSxmdW5jdGlvbihlLHQpe3cuZm5bdF09ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMub24odCxlKX19KSx3LmV4cHIucHNldWRvcy5hbmltYXRlZD1mdW5jdGlvbihlKXtyZXR1cm4gdy5ncmVwKHcudGltZXJzLGZ1bmN0aW9uKHQpe3JldHVybiBlPT09dC5lbGVtfSkubGVuZ3RofSx3Lm9mZnNldD17c2V0T2Zmc2V0OmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYSxzLHUsbCxjPXcuY3NzKGUsInBvc2l0aW9uIiksZj13KGUpLHA9e307InN0YXRpYyI9PT1jJiYoZS5zdHlsZS5wb3NpdGlvbj0icmVsYXRpdmUiKSxzPWYub2Zmc2V0KCksbz13LmNzcyhlLCJ0b3AiKSx1PXcuY3NzKGUsImxlZnQiKSwobD0oImFic29sdXRlIj09PWN8fCJmaXhlZCI9PT1jKSYmKG8rdSkuaW5kZXhPZigiYXV0byIpPi0xKT8oYT0ocj1mLnBvc2l0aW9uKCkpLnRvcCxpPXIubGVmdCk6KGE9cGFyc2VGbG9hdChvKXx8MCxpPXBhcnNlRmxvYXQodSl8fDApLGcodCkmJih0PXQuY2FsbChlLG4sdy5leHRlbmQoe30scykpKSxudWxsIT10LnRvcCYmKHAudG9wPXQudG9wLXMudG9wK2EpLG51bGwhPXQubGVmdCYmKHAubGVmdD10LmxlZnQtcy5sZWZ0K2kpLCJ1c2luZyJpbiB0P3QudXNpbmcuY2FsbChlLHApOmYuY3NzKHApfX0sdy5mbi5leHRlbmQoe29mZnNldDpmdW5jdGlvbihlKXtpZihhcmd1bWVudHMubGVuZ3RoKXJldHVybiB2b2lkIDA9PT1lP3RoaXM6dGhpcy5lYWNoKGZ1bmN0aW9uKHQpe3cub2Zmc2V0LnNldE9mZnNldCh0aGlzLGUsdCl9KTt2YXIgdCxuLHI9dGhpc1swXTtpZihyKXJldHVybiByLmdldENsaWVudFJlY3RzKCkubGVuZ3RoPyh0PXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksbj1yLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcse3RvcDp0LnRvcCtuLnBhZ2VZT2Zmc2V0LGxlZnQ6dC5sZWZ0K24ucGFnZVhPZmZzZXR9KTp7dG9wOjAsbGVmdDowfX0scG9zaXRpb246ZnVuY3Rpb24oKXtpZih0aGlzWzBdKXt2YXIgZSx0LG4scj10aGlzWzBdLGk9e3RvcDowLGxlZnQ6MH07aWYoImZpeGVkIj09PXcuY3NzKHIsInBvc2l0aW9uIikpdD1yLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO2Vsc2V7dD10aGlzLm9mZnNldCgpLG49ci5vd25lckRvY3VtZW50LGU9ci5vZmZzZXRQYXJlbnR8fG4uZG9jdW1lbnRFbGVtZW50O3doaWxlKGUmJihlPT09bi5ib2R5fHxlPT09bi5kb2N1bWVudEVsZW1lbnQpJiYic3RhdGljIj09PXcuY3NzKGUsInBvc2l0aW9uIikpZT1lLnBhcmVudE5vZGU7ZSYmZSE9PXImJjE9PT1lLm5vZGVUeXBlJiYoKGk9dyhlKS5vZmZzZXQoKSkudG9wKz13LmNzcyhlLCJib3JkZXJUb3BXaWR0aCIsITApLGkubGVmdCs9dy5jc3MoZSwiYm9yZGVyTGVmdFdpZHRoIiwhMCkpfXJldHVybnt0b3A6dC50b3AtaS50b3Atdy5jc3MociwibWFyZ2luVG9wIiwhMCksbGVmdDp0LmxlZnQtaS5sZWZ0LXcuY3NzKHIsIm1hcmdpbkxlZnQiLCEwKX19fSxvZmZzZXRQYXJlbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9mZnNldFBhcmVudDt3aGlsZShlJiYic3RhdGljIj09PXcuY3NzKGUsInBvc2l0aW9uIikpZT1lLm9mZnNldFBhcmVudDtyZXR1cm4gZXx8YmV9KX19KSx3LmVhY2goe3Njcm9sbExlZnQ6InBhZ2VYT2Zmc2V0IixzY3JvbGxUb3A6InBhZ2VZT2Zmc2V0In0sZnVuY3Rpb24oZSx0KXt2YXIgbj0icGFnZVlPZmZzZXQiPT09dDt3LmZuW2VdPWZ1bmN0aW9uKHIpe3JldHVybiB6KHRoaXMsZnVuY3Rpb24oZSxyLGkpe3ZhciBvO2lmKHkoZSk/bz1lOjk9PT1lLm5vZGVUeXBlJiYobz1lLmRlZmF1bHRWaWV3KSx2b2lkIDA9PT1pKXJldHVybiBvP29bdF06ZVtyXTtvP28uc2Nyb2xsVG8obj9vLnBhZ2VYT2Zmc2V0Omksbj9pOm8ucGFnZVlPZmZzZXQpOmVbcl09aX0sZSxyLGFyZ3VtZW50cy5sZW5ndGgpfX0pLHcuZWFjaChbInRvcCIsImxlZnQiXSxmdW5jdGlvbihlLHQpe3cuY3NzSG9va3NbdF09X2UoaC5waXhlbFBvc2l0aW9uLGZ1bmN0aW9uKGUsbil7aWYobilyZXR1cm4gbj1GZShlLHQpLFdlLnRlc3Qobik/dyhlKS5wb3NpdGlvbigpW3RdKyJweCI6bn0pfSksdy5lYWNoKHtIZWlnaHQ6ImhlaWdodCIsV2lkdGg6IndpZHRoIn0sZnVuY3Rpb24oZSx0KXt3LmVhY2goe3BhZGRpbmc6ImlubmVyIitlLGNvbnRlbnQ6dCwiIjoib3V0ZXIiK2V9LGZ1bmN0aW9uKG4scil7dy5mbltyXT1mdW5jdGlvbihpLG8pe3ZhciBhPWFyZ3VtZW50cy5sZW5ndGgmJihufHwiYm9vbGVhbiIhPXR5cGVvZiBpKSxzPW58fCghMD09PWl8fCEwPT09bz8ibWFyZ2luIjoiYm9yZGVyIik7cmV0dXJuIHoodGhpcyxmdW5jdGlvbih0LG4saSl7dmFyIG87cmV0dXJuIHkodCk/MD09PXIuaW5kZXhPZigib3V0ZXIiKT90WyJpbm5lciIrZV06dC5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbImNsaWVudCIrZV06OT09PXQubm9kZVR5cGU/KG89dC5kb2N1bWVudEVsZW1lbnQsTWF0aC5tYXgodC5ib2R5WyJzY3JvbGwiK2VdLG9bInNjcm9sbCIrZV0sdC5ib2R5WyJvZmZzZXQiK2VdLG9bIm9mZnNldCIrZV0sb1siY2xpZW50IitlXSkpOnZvaWQgMD09PWk/dy5jc3ModCxuLHMpOncuc3R5bGUodCxuLGkscyl9LHQsYT9pOnZvaWQgMCxhKX19KX0pLHcuZWFjaCgiYmx1ciBmb2N1cyBmb2N1c2luIGZvY3Vzb3V0IHJlc2l6ZSBzY3JvbGwgY2xpY2sgZGJsY2xpY2sgbW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgY2hhbmdlIHNlbGVjdCBzdWJtaXQga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBjb250ZXh0bWVudSIuc3BsaXQoIiAiKSxmdW5jdGlvbihlLHQpe3cuZm5bdF09ZnVuY3Rpb24oZSxuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD4wP3RoaXMub24odCxudWxsLGUsbik6dGhpcy50cmlnZ2VyKHQpfX0pLHcuZm4uZXh0ZW5kKHtob3ZlcjpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLm1vdXNlZW50ZXIoZSkubW91c2VsZWF2ZSh0fHxlKX19KSx3LmZuLmV4dGVuZCh7YmluZDpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHRoaXMub24oZSxudWxsLHQsbil9LHVuYmluZDpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLm9mZihlLG51bGwsdCl9LGRlbGVnYXRlOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiB0aGlzLm9uKHQsZSxuLHIpfSx1bmRlbGVnYXRlOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gMT09PWFyZ3VtZW50cy5sZW5ndGg/dGhpcy5vZmYoZSwiKioiKTp0aGlzLm9mZih0LGV8fCIqKiIsbil9fSksdy5wcm94eT1mdW5jdGlvbihlLHQpe3ZhciBuLHIsaTtpZigic3RyaW5nIj09dHlwZW9mIHQmJihuPWVbdF0sdD1lLGU9biksZyhlKSlyZXR1cm4gcj1vLmNhbGwoYXJndW1lbnRzLDIpLGk9ZnVuY3Rpb24oKXtyZXR1cm4gZS5hcHBseSh0fHx0aGlzLHIuY29uY2F0KG8uY2FsbChhcmd1bWVudHMpKSl9LGkuZ3VpZD1lLmd1aWQ9ZS5ndWlkfHx3Lmd1aWQrKyxpfSx3LmhvbGRSZWFkeT1mdW5jdGlvbihlKXtlP3cucmVhZHlXYWl0Kys6dy5yZWFkeSghMCl9LHcuaXNBcnJheT1BcnJheS5pc0FycmF5LHcucGFyc2VKU09OPUpTT04ucGFyc2Usdy5ub2RlTmFtZT1OLHcuaXNGdW5jdGlvbj1nLHcuaXNXaW5kb3c9eSx3LmNhbWVsQ2FzZT1HLHcudHlwZT14LHcubm93PURhdGUubm93LHcuaXNOdW1lcmljPWZ1bmN0aW9uKGUpe3ZhciB0PXcudHlwZShlKTtyZXR1cm4oIm51bWJlciI9PT10fHwic3RyaW5nIj09PXQpJiYhaXNOYU4oZS1wYXJzZUZsb2F0KGUpKX0sImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZCYmZGVmaW5lKCJqcXVlcnkiLFtdLGZ1bmN0aW9uKCl7cmV0dXJuIHd9KTt2YXIgSnQ9ZS5qUXVlcnksS3Q9ZS4kO3JldHVybiB3Lm5vQ29uZmxpY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIGUuJD09PXcmJihlLiQ9S3QpLHQmJmUualF1ZXJ5PT09dyYmKGUualF1ZXJ5PUp0KSx3fSx0fHwoZS5qUXVlcnk9ZS4kPXcpLHd9KTsNCg==",
        "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuWFJlZ0V4cCA9IGYoKX19KShmdW5jdGlvbigpe3ZhciBkZWZpbmUsbW9kdWxlLGV4cG9ydHM7cmV0dXJuIChmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPSJmdW5jdGlvbiI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIraSsiJyIpO3Rocm93IGEuY29kZT0iTU9EVUxFX05PVF9GT1VORCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PSJmdW5jdGlvbiI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSh7MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQoidXNlIHN0cmljdCI7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwOw0KDQovKiENCiAqIFhSZWdFeHAuYnVpbGQgNC4yLjANCiAqIDx4cmVnZXhwLmNvbT4NCiAqIFN0ZXZlbiBMZXZpdGhhbiAoYykgMjAxMi1wcmVzZW50IE1JVCBMaWNlbnNlDQogKi8NCnZhciBfZGVmYXVsdCA9IGZ1bmN0aW9uIF9kZWZhdWx0KFhSZWdFeHApIHsNCiAgdmFyIFJFR0VYX0RBVEEgPSAneHJlZ2V4cCc7DQogIHZhciBzdWJQYXJ0cyA9IC8oXCgpKD8hXD8pfFxcKFsxLTldXGQqKXxcXFtcc1xTXXxcWyg/OlteXFxcXV18XFxbXHNcU10pKlxdL2c7DQogIHZhciBwYXJ0cyA9IFhSZWdFeHAudW5pb24oWy9cKHt7KFtcdyRdKyl9fVwpfHt7KFtcdyRdKyl9fS8sIHN1YlBhcnRzXSwgJ2cnLCB7DQogICAgY29uanVuY3Rpb246ICdvcicNCiAgfSk7DQogIC8qKg0KICAgKiBTdHJpcHMgYSBsZWFkaW5nIGBeYCBhbmQgdHJhaWxpbmcgdW5lc2NhcGVkIGAkYCwgaWYgYm90aCBhcmUgcHJlc2VudC4NCiAgICoNCiAgICogQHByaXZhdGUNCiAgICogQHBhcmFtIHtTdHJpbmd9IHBhdHRlcm4gUGF0dGVybiB0byBwcm9jZXNzLg0KICAgKiBAcmV0dXJucyB7U3RyaW5nfSBQYXR0ZXJuIHdpdGggZWRnZSBhbmNob3JzIHJlbW92ZWQuDQogICAqLw0KDQogIGZ1bmN0aW9uIGRlYW5jaG9yKHBhdHRlcm4pIHsNCiAgICAvLyBBbGxvdyBhbnkgbnVtYmVyIG9mIGVtcHR5IG5vbmNhcHR1cmluZyBncm91cHMgYmVmb3JlL2FmdGVyIGFuY2hvcnMsIGJlY2F1c2UgcmVnZXhlcw0KICAgIC8vIGJ1aWx0L2dlbmVyYXRlZCBieSBYUmVnRXhwIHNvbWV0aW1lcyBpbmNsdWRlIHRoZW0NCiAgICB2YXIgbGVhZGluZ0FuY2hvciA9IC9eKD86XChcPzpcKSkqXF4vOw0KICAgIHZhciB0cmFpbGluZ0FuY2hvciA9IC9cJCg/OlwoXD86XCkpKiQvOw0KDQogICAgaWYgKGxlYWRpbmdBbmNob3IudGVzdChwYXR0ZXJuKSAmJiB0cmFpbGluZ0FuY2hvci50ZXN0KHBhdHRlcm4pICYmIC8vIEVuc3VyZSB0aGF0IHRoZSB0cmFpbGluZyBgJGAgaXNuJ3QgZXNjYXBlZA0KICAgIHRyYWlsaW5nQW5jaG9yLnRlc3QocGF0dGVybi5yZXBsYWNlKC9cXFtcc1xTXS9nLCAnJykpKSB7DQogICAgICByZXR1cm4gcGF0dGVybi5yZXBsYWNlKGxlYWRpbmdBbmNob3IsICcnKS5yZXBsYWNlKHRyYWlsaW5nQW5jaG9yLCAnJyk7DQogICAgfQ0KDQogICAgcmV0dXJuIHBhdHRlcm47DQogIH0NCiAgLyoqDQogICAqIENvbnZlcnRzIHRoZSBwcm92aWRlZCB2YWx1ZSB0byBhbiBYUmVnRXhwLiBOYXRpdmUgUmVnRXhwIGZsYWdzIGFyZSBub3QgcHJlc2VydmVkLg0KICAgKg0KICAgKiBAcHJpdmF0ZQ0KICAgKiBAcGFyYW0ge1N0cmluZ3xSZWdFeHB9IHZhbHVlIFZhbHVlIHRvIGNvbnZlcnQuDQogICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2FkZEZsYWdYXSBXaGV0aGVyIHRvIGFwcGx5IHRoZSBgeGAgZmxhZyBpbiBjYXNlcyB3aGVuIGB2YWx1ZWAgaXMgbm90DQogICAqICAgYWxyZWFkeSBhIHJlZ2V4IGdlbmVyYXRlZCBieSBYUmVnRXhwDQogICAqIEByZXR1cm5zIHtSZWdFeHB9IFhSZWdFeHAgb2JqZWN0IHdpdGggWFJlZ0V4cCBzeW50YXggYXBwbGllZC4NCiAgICovDQoNCg0KICBmdW5jdGlvbiBhc1hSZWdFeHAodmFsdWUsIGFkZEZsYWdYKSB7DQogICAgdmFyIGZsYWdzID0gYWRkRmxhZ1ggPyAneCcgOiAnJzsNCiAgICByZXR1cm4gWFJlZ0V4cC5pc1JlZ0V4cCh2YWx1ZSkgPyB2YWx1ZVtSRUdFWF9EQVRBXSAmJiB2YWx1ZVtSRUdFWF9EQVRBXS5jYXB0dXJlTmFtZXMgPyAvLyBEb24ndCByZWNvbXBpbGUsIHRvIHByZXNlcnZlIGNhcHR1cmUgbmFtZXMNCiAgICB2YWx1ZSA6IC8vIFJlY29tcGlsZSBhcyBYUmVnRXhwDQogICAgWFJlZ0V4cCh2YWx1ZS5zb3VyY2UsIGZsYWdzKSA6IC8vIENvbXBpbGUgc3RyaW5nIGFzIFhSZWdFeHANCiAgICBYUmVnRXhwKHZhbHVlLCBmbGFncyk7DQogIH0NCg0KICBmdW5jdGlvbiBpbnRlcnBvbGF0ZShzdWJzdGl0dXRpb24pIHsNCiAgICByZXR1cm4gc3Vic3RpdHV0aW9uIGluc3RhbmNlb2YgUmVnRXhwID8gc3Vic3RpdHV0aW9uIDogWFJlZ0V4cC5lc2NhcGUoc3Vic3RpdHV0aW9uKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHJlZHVjZVRvU3VicGF0dGVybnNPYmplY3Qoc3VicGF0dGVybnMsIGludGVycG9sYXRlZCwgc3VicGF0dGVybkluZGV4KSB7DQogICAgc3VicGF0dGVybnNbInN1YnBhdHRlcm4iLmNvbmNhdChzdWJwYXR0ZXJuSW5kZXgpXSA9IGludGVycG9sYXRlZDsNCiAgICByZXR1cm4gc3VicGF0dGVybnM7DQogIH0NCg0KICBmdW5jdGlvbiBlbWJlZFN1YnBhdHRlcm5BZnRlcihyYXcsIHN1YnBhdHRlcm5JbmRleCwgcmF3TGl0ZXJhbHMpIHsNCiAgICB2YXIgaGFzU3VicGF0dGVybiA9IHN1YnBhdHRlcm5JbmRleCA8IHJhd0xpdGVyYWxzLmxlbmd0aCAtIDE7DQogICAgcmV0dXJuIHJhdyArIChoYXNTdWJwYXR0ZXJuID8gInt7c3VicGF0dGVybiIuY29uY2F0KHN1YnBhdHRlcm5JbmRleCwgIn19IikgOiAnJyk7DQogIH0NCiAgLyoqDQogICAqIFByb3ZpZGVzIHRhZ2dlZCB0ZW1wbGF0ZSBsaXRlcmFscyB0aGF0IGNyZWF0ZSByZWdleGVzIHdpdGggWFJlZ0V4cCBzeW50YXggYW5kIGZsYWdzLiBUaGUNCiAgICogcHJvdmlkZWQgcGF0dGVybiBpcyBoYW5kbGVkIGFzIGEgcmF3IHN0cmluZywgc28gYmFja3NsYXNoZXMgZG9uJ3QgbmVlZCB0byBiZSBlc2NhcGVkLg0KICAgKg0KICAgKiBJbnRlcnBvbGF0aW9uIG9mIHN0cmluZ3MgYW5kIHJlZ2V4ZXMgc2hhcmVzIHRoZSBmZWF0dXJlcyBvZiBgWFJlZ0V4cC5idWlsZGAuIEludGVycG9sYXRlZA0KICAgKiBwYXR0ZXJucyBhcmUgdHJlYXRlZCBhcyBhdG9taWMgdW5pdHMgd2hlbiBxdWFudGlmaWVkLCBpbnRlcnBvbGF0ZWQgc3RyaW5ncyBoYXZlIHRoZWlyIHNwZWNpYWwNCiAgICogY2hhcmFjdGVycyBlc2NhcGVkLCBhIGxlYWRpbmcgYF5gIGFuZCB0cmFpbGluZyB1bmVzY2FwZWQgYCRgIGFyZSBzdHJpcHBlZCBmcm9tIGludGVycG9sYXRlZA0KICAgKiByZWdleGVzIGlmIGJvdGggYXJlIHByZXNlbnQsIGFuZCBhbnkgYmFja3JlZmVyZW5jZXMgd2l0aGluIGFuIGludGVycG9sYXRlZCByZWdleCBhcmUNCiAgICogcmV3cml0dGVuIHRvIHdvcmsgd2l0aGluIHRoZSBvdmVyYWxsIHBhdHRlcm4uDQogICAqDQogICAqIEBtZW1iZXJPZiBYUmVnRXhwDQogICAqIEBwYXJhbSB7U3RyaW5nfSBbZmxhZ3NdIEFueSBjb21iaW5hdGlvbiBvZiBYUmVnRXhwIGZsYWdzLg0KICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IEhhbmRsZXIgZm9yIHRlbXBsYXRlIGxpdGVyYWxzIHRoYXQgY29uc3RydWN0IHJlZ2V4ZXMgd2l0aCBYUmVnRXhwIHN5bnRheC4NCiAgICogQGV4YW1wbGUNCiAgICoNCiAgICogY29uc3QgaDEyID0gLzFbMC0yXXwwP1sxLTldLzsNCiAgICogY29uc3QgaDI0ID0gLzJbMC0zXXxbMDFdWzAtOV0vOw0KICAgKiBjb25zdCBob3VycyA9IFhSZWdFeHAudGFnKCd4JylgJHtoMTJ9IDogfCAke2gyNH1gOw0KICAgKiBjb25zdCBtaW51dGVzID0gL15bMC01XVswLTldJC87DQogICAqIC8vIE5vdGUgdGhhdCBleHBsaWNpdGx5IG5hbWluZyB0aGUgJ21pbnV0ZXMnIGdyb3VwIGlzIHJlcXVpcmVkIGZvciBuYW1lZCBiYWNrcmVmZXJlbmNlcw0KICAgKiBjb25zdCB0aW1lID0gWFJlZ0V4cC50YWcoJ3gnKWBeICR7aG91cnN9ICg/PG1pbnV0ZXM+JHttaW51dGVzfSkgJGA7DQogICAqIHRpbWUudGVzdCgnMTA6NTknKTsgLy8gLT4gdHJ1ZQ0KICAgKiBYUmVnRXhwLmV4ZWMoJzEwOjU5JywgdGltZSkubWludXRlczsgLy8gLT4gJzU5Jw0KICAgKi8NCg0KDQogIFhSZWdFeHAudGFnID0gZnVuY3Rpb24gKGZsYWdzKSB7DQogICAgcmV0dXJuIGZ1bmN0aW9uIChsaXRlcmFscykgew0KICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIHN1YnN0aXR1dGlvbnMgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykgew0KICAgICAgICBzdWJzdGl0dXRpb25zW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTsNCiAgICAgIH0NCg0KICAgICAgdmFyIHN1YnBhdHRlcm5zID0gc3Vic3RpdHV0aW9ucy5tYXAoaW50ZXJwb2xhdGUpLnJlZHVjZShyZWR1Y2VUb1N1YnBhdHRlcm5zT2JqZWN0LCB7fSk7DQogICAgICB2YXIgcGF0dGVybiA9IGxpdGVyYWxzLnJhdy5tYXAoZW1iZWRTdWJwYXR0ZXJuQWZ0ZXIpLmpvaW4oJycpOw0KICAgICAgcmV0dXJuIFhSZWdFeHAuYnVpbGQocGF0dGVybiwgc3VicGF0dGVybnMsIGZsYWdzKTsNCiAgICB9Ow0KICB9Ow0KICAvKioNCiAgICogQnVpbGRzIHJlZ2V4ZXMgdXNpbmcgbmFtZWQgc3VicGF0dGVybnMsIGZvciByZWFkYWJpbGl0eSBhbmQgcGF0dGVybiByZXVzZS4gQmFja3JlZmVyZW5jZXMgaW4NCiAgICogdGhlIG91dGVyIHBhdHRlcm4gYW5kIHByb3ZpZGVkIHN1YnBhdHRlcm5zIGFyZSBhdXRvbWF0aWNhbGx5IHJlbnVtYmVyZWQgdG8gd29yayBjb3JyZWN0bHkuDQogICAqIE5hdGl2ZSBmbGFncyB1c2VkIGJ5IHByb3ZpZGVkIHN1YnBhdHRlcm5zIGFyZSBpZ25vcmVkIGluIGZhdm9yIG9mIHRoZSBgZmxhZ3NgIGFyZ3VtZW50Lg0KICAgKg0KICAgKiBAbWVtYmVyT2YgWFJlZ0V4cA0KICAgKiBAcGFyYW0ge1N0cmluZ30gcGF0dGVybiBYUmVnRXhwIHBhdHRlcm4gdXNpbmcgYHt7bmFtZX19YCBmb3IgZW1iZWRkZWQgc3VicGF0dGVybnMuIEFsbG93cw0KICAgKiAgIGAoe3tuYW1lfX0pYCBhcyBzaG9ydGhhbmQgZm9yIGAoPzxuYW1lPnt7bmFtZX19KWAuIFBhdHRlcm5zIGNhbm5vdCBiZSBlbWJlZGRlZCB3aXRoaW4NCiAgICogICBjaGFyYWN0ZXIgY2xhc3Nlcy4NCiAgICogQHBhcmFtIHtPYmplY3R9IHN1YnMgTG9va3VwIG9iamVjdCBmb3IgbmFtZWQgc3VicGF0dGVybnMuIFZhbHVlcyBjYW4gYmUgc3RyaW5ncyBvciByZWdleGVzLiBBDQogICAqICAgbGVhZGluZyBgXmAgYW5kIHRyYWlsaW5nIHVuZXNjYXBlZCBgJGAgYXJlIHN0cmlwcGVkIGZyb20gc3VicGF0dGVybnMsIGlmIGJvdGggYXJlIHByZXNlbnQuDQogICAqIEBwYXJhbSB7U3RyaW5nfSBbZmxhZ3NdIEFueSBjb21iaW5hdGlvbiBvZiBYUmVnRXhwIGZsYWdzLg0KICAgKiBAcmV0dXJucyB7UmVnRXhwfSBSZWdleCB3aXRoIGludGVycG9sYXRlZCBzdWJwYXR0ZXJucy4NCiAgICogQGV4YW1wbGUNCiAgICoNCiAgICogY29uc3QgdGltZSA9IFhSZWdFeHAuYnVpbGQoJyg/eCleIHt7aG91cnN9fSAoe3ttaW51dGVzfX0pICQnLCB7DQogICAqICAgaG91cnM6IFhSZWdFeHAuYnVpbGQoJ3t7aDEyfX0gOiB8IHt7aDI0fX0nLCB7DQogICAqICAgICBoMTI6IC8xWzAtMl18MD9bMS05XS8sDQogICAqICAgICBoMjQ6IC8yWzAtM118WzAxXVswLTldLw0KICAgKiAgIH0sICd4JyksDQogICAqICAgbWludXRlczogL15bMC01XVswLTldJC8NCiAgICogfSk7DQogICAqIHRpbWUudGVzdCgnMTA6NTknKTsgLy8gLT4gdHJ1ZQ0KICAgKiBYUmVnRXhwLmV4ZWMoJzEwOjU5JywgdGltZSkubWludXRlczsgLy8gLT4gJzU5Jw0KICAgKi8NCg0KDQogIFhSZWdFeHAuYnVpbGQgPSBmdW5jdGlvbiAocGF0dGVybiwgc3VicywgZmxhZ3MpIHsNCiAgICBmbGFncyA9IGZsYWdzIHx8ICcnOyAvLyBVc2VkIHdpdGggYGFzWFJlZ0V4cGAgY2FsbHMgZm9yIGBwYXR0ZXJuYCBhbmQgc3VicGF0dGVybnMgaW4gYHN1YnNgLCB0byB3b3JrIGFyb3VuZCBob3cNCiAgICAvLyBzb21lIGJyb3dzZXJzIGNvbnZlcnQgYFJlZ0V4cCgnXG4nKWAgdG8gYSByZWdleCB0aGF0IGNvbnRhaW5zIHRoZSBsaXRlcmFsIGNoYXJhY3RlcnMgYFxgDQogICAgLy8gYW5kIGBuYC4gU2VlIG1vcmUgZGV0YWlscyBhdCA8aHR0cHM6Ly9naXRodWIuY29tL3NsZXZpdGhhbi94cmVnZXhwL3B1bGwvMTYzPi4NCg0KICAgIHZhciBhZGRGbGFnWCA9IGZsYWdzLmluZGV4T2YoJ3gnKSAhPT0gLTE7DQogICAgdmFyIGlubGluZUZsYWdzID0gL15cKFw/KFtcdyRdKylcKS8uZXhlYyhwYXR0ZXJuKTsgLy8gQWRkIGZsYWdzIHdpdGhpbiBhIGxlYWRpbmcgbW9kZSBtb2RpZmllciB0byB0aGUgb3ZlcmFsbCBwYXR0ZXJuJ3MgZmxhZ3MNCg0KICAgIGlmIChpbmxpbmVGbGFncykgew0KICAgICAgZmxhZ3MgPSBYUmVnRXhwLl9jbGlwRHVwbGljYXRlcyhmbGFncyArIGlubGluZUZsYWdzWzFdKTsNCiAgICB9DQoNCiAgICB2YXIgZGF0YSA9IHt9Ow0KDQogICAgZm9yICh2YXIgcCBpbiBzdWJzKSB7DQogICAgICBpZiAoc3Vicy5oYXNPd25Qcm9wZXJ0eShwKSkgew0KICAgICAgICAvLyBQYXNzaW5nIHRvIFhSZWdFeHAgZW5hYmxlcyBleHRlbmRlZCBzeW50YXggYW5kIGVuc3VyZXMgaW5kZXBlbmRlbnQgdmFsaWRpdHksDQogICAgICAgIC8vIGxlc3QgYW4gdW5lc2NhcGVkIGAoYCwgYClgLCBgW2AsIG9yIHRyYWlsaW5nIGBcYCBicmVha3MgdGhlIGAoPzopYCB3cmFwcGVyLiBGb3INCiAgICAgICAgLy8gc3VicGF0dGVybnMgcHJvdmlkZWQgYXMgbmF0aXZlIHJlZ2V4ZXMsIGl0IGRpZXMgb24gb2N0YWxzIGFuZCBhZGRzIHRoZSBwcm9wZXJ0eQ0KICAgICAgICAvLyB1c2VkIHRvIGhvbGQgZXh0ZW5kZWQgcmVnZXggaW5zdGFuY2UgZGF0YSwgZm9yIHNpbXBsaWNpdHkuDQogICAgICAgIHZhciBzdWIgPSBhc1hSZWdFeHAoc3Vic1twXSwgYWRkRmxhZ1gpOw0KICAgICAgICBkYXRhW3BdID0gew0KICAgICAgICAgIC8vIERlYW5jaG9yaW5nIGFsbG93cyBlbWJlZGRpbmcgaW5kZXBlbmRlbnRseSB1c2VmdWwgYW5jaG9yZWQgcmVnZXhlcy4gSWYgeW91DQogICAgICAgICAgLy8gcmVhbGx5IG5lZWQgdG8ga2VlcCB5b3VyIGFuY2hvcnMsIGRvdWJsZSB0aGVtIChpLmUuLCBgXl4uLi4kJGApLg0KICAgICAgICAgIHBhdHRlcm46IGRlYW5jaG9yKHN1Yi5zb3VyY2UpLA0KICAgICAgICAgIG5hbWVzOiBzdWJbUkVHRVhfREFUQV0uY2FwdHVyZU5hbWVzIHx8IFtdDQogICAgICAgIH07DQogICAgICB9DQogICAgfSAvLyBQYXNzaW5nIHRvIFhSZWdFeHAgZGllcyBvbiBvY3RhbHMgYW5kIGVuc3VyZXMgdGhlIG91dGVyIHBhdHRlcm4gaXMgaW5kZXBlbmRlbnRseSB2YWxpZDsNCiAgICAvLyBoZWxwcyBrZWVwIHRoaXMgc2ltcGxlLiBOYW1lZCBjYXB0dXJlcyB3aWxsIGJlIHB1dCBiYWNrLg0KDQoNCiAgICB2YXIgcGF0dGVybkFzUmVnZXggPSBhc1hSZWdFeHAocGF0dGVybiwgYWRkRmxhZ1gpOyAvLyAnQ2FwcycgaXMgc2hvcnQgZm9yICdjYXB0dXJlcycNCg0KICAgIHZhciBudW1DYXBzID0gMDsNCiAgICB2YXIgbnVtUHJpb3JDYXBzOw0KICAgIHZhciBudW1PdXRlckNhcHMgPSAwOw0KICAgIHZhciBvdXRlckNhcHNNYXAgPSBbMF07DQogICAgdmFyIG91dGVyQ2FwTmFtZXMgPSBwYXR0ZXJuQXNSZWdleFtSRUdFWF9EQVRBXS5jYXB0dXJlTmFtZXMgfHwgW107DQogICAgdmFyIG91dHB1dCA9IHBhdHRlcm5Bc1JlZ2V4LnNvdXJjZS5yZXBsYWNlKHBhcnRzLCBmdW5jdGlvbiAoJDAsICQxLCAkMiwgJDMsICQ0KSB7DQogICAgICB2YXIgc3ViTmFtZSA9ICQxIHx8ICQyOw0KICAgICAgdmFyIGNhcE5hbWU7DQogICAgICB2YXIgaW50cm87DQogICAgICB2YXIgbG9jYWxDYXBJbmRleDsgLy8gTmFtZWQgc3VicGF0dGVybg0KDQogICAgICBpZiAoc3ViTmFtZSkgew0KICAgICAgICBpZiAoIWRhdGEuaGFzT3duUHJvcGVydHkoc3ViTmFtZSkpIHsNCiAgICAgICAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoIlVuZGVmaW5lZCBwcm9wZXJ0eSAiLmNvbmNhdCgkMCkpOw0KICAgICAgICB9IC8vIE5hbWVkIHN1YnBhdHRlcm4gd2FzIHdyYXBwZWQgaW4gYSBjYXB0dXJpbmcgZ3JvdXANCg0KDQogICAgICAgIGlmICgkMSkgew0KICAgICAgICAgIGNhcE5hbWUgPSBvdXRlckNhcE5hbWVzW251bU91dGVyQ2Fwc107DQogICAgICAgICAgb3V0ZXJDYXBzTWFwWysrbnVtT3V0ZXJDYXBzXSA9ICsrbnVtQ2FwczsgLy8gSWYgaXQncyBhIG5hbWVkIGdyb3VwLCBwcmVzZXJ2ZSB0aGUgbmFtZS4gT3RoZXJ3aXNlLCB1c2UgdGhlIHN1YnBhdHRlcm4gbmFtZQ0KICAgICAgICAgIC8vIGFzIHRoZSBjYXB0dXJlIG5hbWUNCg0KICAgICAgICAgIGludHJvID0gIig/PCIuY29uY2F0KGNhcE5hbWUgfHwgc3ViTmFtZSwgIj4iKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBpbnRybyA9ICcoPzonOw0KICAgICAgICB9DQoNCiAgICAgICAgbnVtUHJpb3JDYXBzID0gbnVtQ2FwczsNCiAgICAgICAgdmFyIHJld3JpdHRlblN1YnBhdHRlcm4gPSBkYXRhW3N1Yk5hbWVdLnBhdHRlcm4ucmVwbGFjZShzdWJQYXJ0cywgZnVuY3Rpb24gKG1hdGNoLCBwYXJlbiwgYmFja3JlZikgew0KICAgICAgICAgIC8vIENhcHR1cmluZyBncm91cA0KICAgICAgICAgIGlmIChwYXJlbikgew0KICAgICAgICAgICAgY2FwTmFtZSA9IGRhdGFbc3ViTmFtZV0ubmFtZXNbbnVtQ2FwcyAtIG51bVByaW9yQ2Fwc107DQogICAgICAgICAgICArK251bUNhcHM7IC8vIElmIHRoZSBjdXJyZW50IGNhcHR1cmUgaGFzIGEgbmFtZSwgcHJlc2VydmUgdGhlIG5hbWUNCg0KICAgICAgICAgICAgaWYgKGNhcE5hbWUpIHsNCiAgICAgICAgICAgICAgcmV0dXJuICIoPzwiLmNvbmNhdChjYXBOYW1lLCAiPiIpOw0KICAgICAgICAgICAgfSAvLyBCYWNrcmVmZXJlbmNlDQoNCiAgICAgICAgICB9IGVsc2UgaWYgKGJhY2tyZWYpIHsNCiAgICAgICAgICAgIGxvY2FsQ2FwSW5kZXggPSArYmFja3JlZiAtIDE7IC8vIFJld3JpdGUgdGhlIGJhY2tyZWZlcmVuY2UNCg0KICAgICAgICAgICAgcmV0dXJuIGRhdGFbc3ViTmFtZV0ubmFtZXNbbG9jYWxDYXBJbmRleF0gPyAvLyBOZWVkIHRvIHByZXNlcnZlIHRoZSBiYWNrcmVmZXJlbmNlIG5hbWUgaW4gY2FzZSB1c2luZyBmbGFnIGBuYA0KICAgICAgICAgICAgIlxcazwiLmNvbmNhdChkYXRhW3N1Yk5hbWVdLm5hbWVzW2xvY2FsQ2FwSW5kZXhdLCAiPiIpIDogIlxcIi5jb25jYXQoK2JhY2tyZWYgKyBudW1QcmlvckNhcHMpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIHJldHVybiBtYXRjaDsNCiAgICAgICAgfSk7DQogICAgICAgIHJldHVybiAiIi5jb25jYXQoaW50cm8pLmNvbmNhdChyZXdyaXR0ZW5TdWJwYXR0ZXJuLCAiKSIpOw0KICAgICAgfSAvLyBDYXB0dXJpbmcgZ3JvdXANCg0KDQogICAgICBpZiAoJDMpIHsNCiAgICAgICAgY2FwTmFtZSA9IG91dGVyQ2FwTmFtZXNbbnVtT3V0ZXJDYXBzXTsNCiAgICAgICAgb3V0ZXJDYXBzTWFwWysrbnVtT3V0ZXJDYXBzXSA9ICsrbnVtQ2FwczsgLy8gSWYgdGhlIGN1cnJlbnQgY2FwdHVyZSBoYXMgYSBuYW1lLCBwcmVzZXJ2ZSB0aGUgbmFtZQ0KDQogICAgICAgIGlmIChjYXBOYW1lKSB7DQogICAgICAgICAgcmV0dXJuICIoPzwiLmNvbmNhdChjYXBOYW1lLCAiPiIpOw0KICAgICAgICB9IC8vIEJhY2tyZWZlcmVuY2UNCg0KICAgICAgfSBlbHNlIGlmICgkNCkgew0KICAgICAgICBsb2NhbENhcEluZGV4ID0gKyQ0IC0gMTsgLy8gUmV3cml0ZSB0aGUgYmFja3JlZmVyZW5jZQ0KDQogICAgICAgIHJldHVybiBvdXRlckNhcE5hbWVzW2xvY2FsQ2FwSW5kZXhdID8gLy8gTmVlZCB0byBwcmVzZXJ2ZSB0aGUgYmFja3JlZmVyZW5jZSBuYW1lIGluIGNhc2UgdXNpbmcgZmxhZyBgbmANCiAgICAgICAgIlxcazwiLmNvbmNhdChvdXRlckNhcE5hbWVzW2xvY2FsQ2FwSW5kZXhdLCAiPiIpIDogIlxcIi5jb25jYXQob3V0ZXJDYXBzTWFwWyskNF0pOw0KICAgICAgfQ0KDQogICAgICByZXR1cm4gJDA7DQogICAgfSk7DQogICAgcmV0dXJuIFhSZWdFeHAob3V0cHV0LCBmbGFncyk7DQogIH07DQp9Ow0KDQpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsNCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1siZGVmYXVsdCJdOw0KfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQoidXNlIHN0cmljdCI7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwOw0KDQovKiENCiAqIFhSZWdFeHAubWF0Y2hSZWN1cnNpdmUgNC4yLjANCiAqIDx4cmVnZXhwLmNvbT4NCiAqIFN0ZXZlbiBMZXZpdGhhbiAoYykgMjAwOS1wcmVzZW50IE1JVCBMaWNlbnNlDQogKi8NCnZhciBfZGVmYXVsdCA9IGZ1bmN0aW9uIF9kZWZhdWx0KFhSZWdFeHApIHsNCiAgLyoqDQogICAqIFJldHVybnMgYSBtYXRjaCBkZXRhaWwgb2JqZWN0IGNvbXBvc2VkIG9mIHRoZSBwcm92aWRlZCB2YWx1ZXMuDQogICAqDQogICAqIEBwcml2YXRlDQogICAqLw0KICBmdW5jdGlvbiByb3cobmFtZSwgdmFsdWUsIHN0YXJ0LCBlbmQpIHsNCiAgICByZXR1cm4gew0KICAgICAgbmFtZTogbmFtZSwNCiAgICAgIHZhbHVlOiB2YWx1ZSwNCiAgICAgIHN0YXJ0OiBzdGFydCwNCiAgICAgIGVuZDogZW5kDQogICAgfTsNCiAgfQ0KICAvKioNCiAgICogUmV0dXJucyBhbiBhcnJheSBvZiBtYXRjaCBzdHJpbmdzIGJldHdlZW4gb3V0ZXJtb3N0IGxlZnQgYW5kIHJpZ2h0IGRlbGltaXRlcnMsIG9yIGFuIGFycmF5IG9mDQogICAqIG9iamVjdHMgd2l0aCBkZXRhaWxlZCBtYXRjaCBwYXJ0cyBhbmQgcG9zaXRpb24gZGF0YS4gQW4gZXJyb3IgaXMgdGhyb3duIGlmIGRlbGltaXRlcnMgYXJlDQogICAqIHVuYmFsYW5jZWQgd2l0aGluIHRoZSBkYXRhLg0KICAgKg0KICAgKiBAbWVtYmVyT2YgWFJlZ0V4cA0KICAgKiBAcGFyYW0ge1N0cmluZ30gc3RyIFN0cmluZyB0byBzZWFyY2guDQogICAqIEBwYXJhbSB7U3RyaW5nfSBsZWZ0IExlZnQgZGVsaW1pdGVyIGFzIGFuIFhSZWdFeHAgcGF0dGVybi4NCiAgICogQHBhcmFtIHtTdHJpbmd9IHJpZ2h0IFJpZ2h0IGRlbGltaXRlciBhcyBhbiBYUmVnRXhwIHBhdHRlcm4uDQogICAqIEBwYXJhbSB7U3RyaW5nfSBbZmxhZ3NdIEFueSBuYXRpdmUgb3IgWFJlZ0V4cCBmbGFncywgdXNlZCBmb3IgdGhlIGxlZnQgYW5kIHJpZ2h0IGRlbGltaXRlcnMuDQogICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gTGV0cyB5b3Ugc3BlY2lmeSBgdmFsdWVOYW1lc2AgYW5kIGBlc2NhcGVDaGFyYCBvcHRpb25zLg0KICAgKiBAcmV0dXJucyB7QXJyYXl9IEFycmF5IG9mIG1hdGNoZXMsIG9yIGFuIGVtcHR5IGFycmF5Lg0KICAgKiBAZXhhbXBsZQ0KICAgKg0KICAgKiAvLyBCYXNpYyB1c2FnZQ0KICAgKiBsZXQgc3RyID0gJyh0KChlKSlzKXQoKShpbmcpJzsNCiAgICogWFJlZ0V4cC5tYXRjaFJlY3Vyc2l2ZShzdHIsICdcXCgnLCAnXFwpJywgJ2cnKTsNCiAgICogLy8gLT4gWyd0KChlKSlzJywgJycsICdpbmcnXQ0KICAgKg0KICAgKiAvLyBFeHRlbmRlZCBpbmZvcm1hdGlvbiBtb2RlIHdpdGggdmFsdWVOYW1lcw0KICAgKiBzdHIgPSAnSGVyZSBpcyA8ZGl2PiA8ZGl2PmFuPC9kaXY+PC9kaXY+IGV4YW1wbGUnOw0KICAgKiBYUmVnRXhwLm1hdGNoUmVjdXJzaXZlKHN0ciwgJzxkaXZcXHMqPicsICc8L2Rpdj4nLCAnZ2knLCB7DQogICAqICAgdmFsdWVOYW1lczogWydiZXR3ZWVuJywgJ2xlZnQnLCAnbWF0Y2gnLCAncmlnaHQnXQ0KICAgKiB9KTsNCiAgICogLy8gLT4gWw0KICAgKiAvLyB7bmFtZTogJ2JldHdlZW4nLCB2YWx1ZTogJ0hlcmUgaXMgJywgICAgICAgc3RhcnQ6IDAsICBlbmQ6IDh9LA0KICAgKiAvLyB7bmFtZTogJ2xlZnQnLCAgICB2YWx1ZTogJzxkaXY+JywgICAgICAgICAgc3RhcnQ6IDgsICBlbmQ6IDEzfSwNCiAgICogLy8ge25hbWU6ICdtYXRjaCcsICAgdmFsdWU6ICcgPGRpdj5hbjwvZGl2PicsIHN0YXJ0OiAxMywgZW5kOiAyN30sDQogICAqIC8vIHtuYW1lOiAncmlnaHQnLCAgIHZhbHVlOiAnPC9kaXY+JywgICAgICAgICBzdGFydDogMjcsIGVuZDogMzN9LA0KICAgKiAvLyB7bmFtZTogJ2JldHdlZW4nLCB2YWx1ZTogJyBleGFtcGxlJywgICAgICAgc3RhcnQ6IDMzLCBlbmQ6IDQxfQ0KICAgKiAvLyBdDQogICAqDQogICAqIC8vIE9taXR0aW5nIHVubmVlZGVkIHBhcnRzIHdpdGggbnVsbCB2YWx1ZU5hbWVzLCBhbmQgdXNpbmcgZXNjYXBlQ2hhcg0KICAgKiBzdHIgPSAnLi4uezF9Llxce3tmdW5jdGlvbih4LHkpe3JldHVybiB7eTp4fX19JzsNCiAgICogWFJlZ0V4cC5tYXRjaFJlY3Vyc2l2ZShzdHIsICd7JywgJ30nLCAnZycsIHsNCiAgICogICB2YWx1ZU5hbWVzOiBbJ2xpdGVyYWwnLCBudWxsLCAndmFsdWUnLCBudWxsXSwNCiAgICogICBlc2NhcGVDaGFyOiAnXFwnDQogICAqIH0pOw0KICAgKiAvLyAtPiBbDQogICAqIC8vIHtuYW1lOiAnbGl0ZXJhbCcsIHZhbHVlOiAnLi4uJywgIHN0YXJ0OiAwLCBlbmQ6IDN9LA0KICAgKiAvLyB7bmFtZTogJ3ZhbHVlJywgICB2YWx1ZTogJzEnLCAgICBzdGFydDogNCwgZW5kOiA1fSwNCiAgICogLy8ge25hbWU6ICdsaXRlcmFsJywgdmFsdWU6ICcuXFx7Jywgc3RhcnQ6IDYsIGVuZDogOX0sDQogICAqIC8vIHtuYW1lOiAndmFsdWUnLCAgIHZhbHVlOiAnZnVuY3Rpb24oeCx5KXtyZXR1cm4ge3k6eH19Jywgc3RhcnQ6IDEwLCBlbmQ6IDM3fQ0KICAgKiAvLyBdDQogICAqDQogICAqIC8vIFN0aWNreSBtb2RlIHZpYSBmbGFnIHkNCiAgICogc3RyID0gJzwxPjw8PDI+Pj48Mz40PDU+JzsNCiAgICogWFJlZ0V4cC5tYXRjaFJlY3Vyc2l2ZShzdHIsICc8JywgJz4nLCAnZ3knKTsNCiAgICogLy8gLT4gWycxJywgJzw8Mj4+JywgJzMnXQ0KICAgKi8NCg0KDQogIFhSZWdFeHAubWF0Y2hSZWN1cnNpdmUgPSBmdW5jdGlvbiAoc3RyLCBsZWZ0LCByaWdodCwgZmxhZ3MsIG9wdGlvbnMpIHsNCiAgICBmbGFncyA9IGZsYWdzIHx8ICcnOw0KICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9Ow0KICAgIHZhciBnbG9iYWwgPSBmbGFncy5pbmRleE9mKCdnJykgIT09IC0xOw0KICAgIHZhciBzdGlja3kgPSBmbGFncy5pbmRleE9mKCd5JykgIT09IC0xOyAvLyBGbGFnIGB5YCBpcyBjb250cm9sbGVkIGludGVybmFsbHkNCg0KICAgIHZhciBiYXNpY0ZsYWdzID0gZmxhZ3MucmVwbGFjZSgveS9nLCAnJyk7DQogICAgdmFyIF9vcHRpb25zID0gb3B0aW9ucywNCiAgICAgICAgZXNjYXBlQ2hhciA9IF9vcHRpb25zLmVzY2FwZUNoYXI7DQogICAgdmFyIHZOID0gb3B0aW9ucy52YWx1ZU5hbWVzOw0KICAgIHZhciBvdXRwdXQgPSBbXTsNCiAgICB2YXIgb3BlblRva2VucyA9IDA7DQogICAgdmFyIGRlbGltU3RhcnQgPSAwOw0KICAgIHZhciBkZWxpbUVuZCA9IDA7DQogICAgdmFyIGxhc3RPdXRlckVuZCA9IDA7DQogICAgdmFyIG91dGVyU3RhcnQ7DQogICAgdmFyIGlubmVyU3RhcnQ7DQogICAgdmFyIGxlZnRNYXRjaDsNCiAgICB2YXIgcmlnaHRNYXRjaDsNCiAgICB2YXIgZXNjOw0KICAgIGxlZnQgPSBYUmVnRXhwKGxlZnQsIGJhc2ljRmxhZ3MpOw0KICAgIHJpZ2h0ID0gWFJlZ0V4cChyaWdodCwgYmFzaWNGbGFncyk7DQoNCiAgICBpZiAoZXNjYXBlQ2hhcikgew0KICAgICAgaWYgKGVzY2FwZUNoYXIubGVuZ3RoID4gMSkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCB1c2UgbW9yZSB0aGFuIG9uZSBlc2NhcGUgY2hhcmFjdGVyJyk7DQogICAgICB9DQoNCiAgICAgIGVzY2FwZUNoYXIgPSBYUmVnRXhwLmVzY2FwZShlc2NhcGVDaGFyKTsgLy8gRXhhbXBsZSBvZiBjb25jYXRlbmF0ZWQgYGVzY2AgcmVnZXg6DQogICAgICAvLyBgZXNjYXBlQ2hhcmA6ICclJw0KICAgICAgLy8gYGxlZnRgOiAnPCcNCiAgICAgIC8vIGByaWdodGA6ICc+Jw0KICAgICAgLy8gUmVnZXggaXM6IC8oPzolW1xTXHNdfCg/Oig/ITx8PilbXiVdKSspKy8NCg0KICAgICAgZXNjID0gbmV3IFJlZ0V4cCgiKD86Ii5jb25jYXQoZXNjYXBlQ2hhciwgIltcXFNcXHNdfCg/Oig/ISIpLmNvbmNhdCggLy8gVXNpbmcgYFhSZWdFeHAudW5pb25gIHNhZmVseSByZXdyaXRlcyBiYWNrcmVmZXJlbmNlcyBpbiBgbGVmdGAgYW5kIGByaWdodGAuDQogICAgICAvLyBJbnRlbnRpb25hbGx5IG5vdCBwYXNzaW5nIGBiYXNpY0ZsYWdzYCB0byBgWFJlZ0V4cC51bmlvbmAgc2luY2UgYW55IHN5bnRheA0KICAgICAgLy8gdHJhbnNmb3JtYXRpb24gcmVzdWx0aW5nIGZyb20gdGhvc2UgZmxhZ3Mgd2FzIGFscmVhZHkgYXBwbGllZCB0byBgbGVmdGAgYW5kDQogICAgICAvLyBgcmlnaHRgIHdoZW4gdGhleSB3ZXJlIHBhc3NlZCB0aHJvdWdoIHRoZSBYUmVnRXhwIGNvbnN0cnVjdG9yIGFib3ZlLg0KICAgICAgWFJlZ0V4cC51bmlvbihbbGVmdCwgcmlnaHRdLCAnJywgew0KICAgICAgICBjb25qdW5jdGlvbjogJ29yJw0KICAgICAgfSkuc291cmNlLCAiKVteIikuY29uY2F0KGVzY2FwZUNoYXIsICJdKSspKyIpLCAvLyBGbGFncyBgZ3lgIG5vdCBuZWVkZWQgaGVyZQ0KICAgICAgZmxhZ3MucmVwbGFjZSgvW15pbXVdKy9nLCAnJykpOw0KICAgIH0NCg0KICAgIHdoaWxlICh0cnVlKSB7DQogICAgICAvLyBJZiB1c2luZyBhbiBlc2NhcGUgY2hhcmFjdGVyLCBhZHZhbmNlIHRvIHRoZSBkZWxpbWl0ZXIncyBuZXh0IHN0YXJ0aW5nIHBvc2l0aW9uLA0KICAgICAgLy8gc2tpcHBpbmcgYW55IGVzY2FwZWQgY2hhcmFjdGVycyBpbiBiZXR3ZWVuDQogICAgICBpZiAoZXNjYXBlQ2hhcikgew0KICAgICAgICBkZWxpbUVuZCArPSAoWFJlZ0V4cC5leGVjKHN0ciwgZXNjLCBkZWxpbUVuZCwgJ3N0aWNreScpIHx8IFsnJ10pWzBdLmxlbmd0aDsNCiAgICAgIH0NCg0KICAgICAgbGVmdE1hdGNoID0gWFJlZ0V4cC5leGVjKHN0ciwgbGVmdCwgZGVsaW1FbmQpOw0KICAgICAgcmlnaHRNYXRjaCA9IFhSZWdFeHAuZXhlYyhzdHIsIHJpZ2h0LCBkZWxpbUVuZCk7IC8vIEtlZXAgdGhlIGxlZnRtb3N0IG1hdGNoIG9ubHkNCg0KICAgICAgaWYgKGxlZnRNYXRjaCAmJiByaWdodE1hdGNoKSB7DQogICAgICAgIGlmIChsZWZ0TWF0Y2guaW5kZXggPD0gcmlnaHRNYXRjaC5pbmRleCkgew0KICAgICAgICAgIHJpZ2h0TWF0Y2ggPSBudWxsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIGxlZnRNYXRjaCA9IG51bGw7DQogICAgICAgIH0NCiAgICAgIH0gLy8gUGF0aHMgKExNOiBsZWZ0TWF0Y2gsIFJNOiByaWdodE1hdGNoLCBPVDogb3BlblRva2Vucyk6DQogICAgICAvLyBMTSB8IFJNIHwgT1QgfCBSZXN1bHQNCiAgICAgIC8vIDEgIHwgMCAgfCAxICB8IGxvb3ANCiAgICAgIC8vIDEgIHwgMCAgfCAwICB8IGxvb3ANCiAgICAgIC8vIDAgIHwgMSAgfCAxICB8IGxvb3ANCiAgICAgIC8vIDAgIHwgMSAgfCAwICB8IHRocm93DQogICAgICAvLyAwICB8IDAgIHwgMSAgfCB0aHJvdw0KICAgICAgLy8gMCAgfCAwICB8IDAgIHwgYnJlYWsNCiAgICAgIC8vIFRoZSBwYXRocyBhYm92ZSBkb24ndCBpbmNsdWRlIHRoZSBzdGlja3kgbW9kZSBzcGVjaWFsIGNhc2UuIFRoZSBsb29wIGVuZHMgYWZ0ZXIgdGhlDQogICAgICAvLyBmaXJzdCBjb21wbGV0ZWQgbWF0Y2ggaWYgbm90IGBnbG9iYWxgLg0KDQoNCiAgICAgIGlmIChsZWZ0TWF0Y2ggfHwgcmlnaHRNYXRjaCkgew0KICAgICAgICBkZWxpbVN0YXJ0ID0gKGxlZnRNYXRjaCB8fCByaWdodE1hdGNoKS5pbmRleDsNCiAgICAgICAgZGVsaW1FbmQgPSBkZWxpbVN0YXJ0ICsgKGxlZnRNYXRjaCB8fCByaWdodE1hdGNoKVswXS5sZW5ndGg7DQogICAgICB9IGVsc2UgaWYgKCFvcGVuVG9rZW5zKSB7DQogICAgICAgIGJyZWFrOw0KICAgICAgfQ0KDQogICAgICBpZiAoc3RpY2t5ICYmICFvcGVuVG9rZW5zICYmIGRlbGltU3RhcnQgPiBsYXN0T3V0ZXJFbmQpIHsNCiAgICAgICAgYnJlYWs7DQogICAgICB9DQoNCiAgICAgIGlmIChsZWZ0TWF0Y2gpIHsNCiAgICAgICAgaWYgKCFvcGVuVG9rZW5zKSB7DQogICAgICAgICAgb3V0ZXJTdGFydCA9IGRlbGltU3RhcnQ7DQogICAgICAgICAgaW5uZXJTdGFydCA9IGRlbGltRW5kOw0KICAgICAgICB9DQoNCiAgICAgICAgKytvcGVuVG9rZW5zOw0KICAgICAgfSBlbHNlIGlmIChyaWdodE1hdGNoICYmIG9wZW5Ub2tlbnMpIHsNCiAgICAgICAgaWYgKCEgLS1vcGVuVG9rZW5zKSB7DQogICAgICAgICAgaWYgKHZOKSB7DQogICAgICAgICAgICBpZiAodk5bMF0gJiYgb3V0ZXJTdGFydCA+IGxhc3RPdXRlckVuZCkgew0KICAgICAgICAgICAgICBvdXRwdXQucHVzaChyb3codk5bMF0sIHN0ci5zbGljZShsYXN0T3V0ZXJFbmQsIG91dGVyU3RhcnQpLCBsYXN0T3V0ZXJFbmQsIG91dGVyU3RhcnQpKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKHZOWzFdKSB7DQogICAgICAgICAgICAgIG91dHB1dC5wdXNoKHJvdyh2TlsxXSwgc3RyLnNsaWNlKG91dGVyU3RhcnQsIGlubmVyU3RhcnQpLCBvdXRlclN0YXJ0LCBpbm5lclN0YXJ0KSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICh2TlsyXSkgew0KICAgICAgICAgICAgICBvdXRwdXQucHVzaChyb3codk5bMl0sIHN0ci5zbGljZShpbm5lclN0YXJ0LCBkZWxpbVN0YXJ0KSwgaW5uZXJTdGFydCwgZGVsaW1TdGFydCkpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAodk5bM10pIHsNCiAgICAgICAgICAgICAgb3V0cHV0LnB1c2gocm93KHZOWzNdLCBzdHIuc2xpY2UoZGVsaW1TdGFydCwgZGVsaW1FbmQpLCBkZWxpbVN0YXJ0LCBkZWxpbUVuZCkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBvdXRwdXQucHVzaChzdHIuc2xpY2UoaW5uZXJTdGFydCwgZGVsaW1TdGFydCkpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGxhc3RPdXRlckVuZCA9IGRlbGltRW5kOw0KDQogICAgICAgICAgaWYgKCFnbG9iYWwpIHsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmJhbGFuY2VkIGRlbGltaXRlciBmb3VuZCBpbiBzdHJpbmcnKTsNCiAgICAgIH0gLy8gSWYgdGhlIGRlbGltaXRlciBtYXRjaGVkIGFuIGVtcHR5IHN0cmluZywgYXZvaWQgYW4gaW5maW5pdGUgbG9vcA0KDQoNCiAgICAgIGlmIChkZWxpbVN0YXJ0ID09PSBkZWxpbUVuZCkgew0KICAgICAgICArK2RlbGltRW5kOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIGlmIChnbG9iYWwgJiYgIXN0aWNreSAmJiB2TiAmJiB2TlswXSAmJiBzdHIubGVuZ3RoID4gbGFzdE91dGVyRW5kKSB7DQogICAgICBvdXRwdXQucHVzaChyb3codk5bMF0sIHN0ci5zbGljZShsYXN0T3V0ZXJFbmQpLCBsYXN0T3V0ZXJFbmQsIHN0ci5sZW5ndGgpKTsNCiAgICB9DQoNCiAgICByZXR1cm4gb3V0cHV0Ow0KICB9Ow0KfTsNCg0KZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7DQptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbImRlZmF1bHQiXTsNCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KInVzZSBzdHJpY3QiOw0KDQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7DQogIHZhbHVlOiB0cnVlDQp9KTsNCmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsNCg0KLyohDQogKiBYUmVnRXhwIFVuaWNvZGUgQmFzZSA0LjIuMA0KICogPHhyZWdleHAuY29tPg0KICogU3RldmVuIExldml0aGFuIChjKSAyMDA4LXByZXNlbnQgTUlUIExpY2Vuc2UNCiAqLw0KdmFyIF9kZWZhdWx0ID0gZnVuY3Rpb24gX2RlZmF1bHQoWFJlZ0V4cCkgew0KICAvKioNCiAgICogQWRkcyBiYXNlIHN1cHBvcnQgZm9yIFVuaWNvZGUgbWF0Y2hpbmc6DQogICAqIC0gQWRkcyBzeW50YXggYFxwey4ufWAgZm9yIG1hdGNoaW5nIFVuaWNvZGUgdG9rZW5zLiBUb2tlbnMgY2FuIGJlIGludmVydGVkIHVzaW5nIGBcUHsuLn1gIG9yDQogICAqICAgYFxwe14uLn1gLiBUb2tlbiBuYW1lcyBpZ25vcmUgY2FzZSwgc3BhY2VzLCBoeXBoZW5zLCBhbmQgdW5kZXJzY29yZXMuIFlvdSBjYW4gb21pdCB0aGUNCiAgICogICBicmFjZXMgZm9yIHRva2VuIG5hbWVzIHRoYXQgYXJlIGEgc2luZ2xlIGxldHRlciAoZS5nLiBgXHBMYCBvciBgUExgKS4NCiAgICogLSBBZGRzIGZsYWcgQSAoYXN0cmFsKSwgd2hpY2ggZW5hYmxlcyAyMS1iaXQgVW5pY29kZSBzdXBwb3J0Lg0KICAgKiAtIEFkZHMgdGhlIGBYUmVnRXhwLmFkZFVuaWNvZGVEYXRhYCBtZXRob2QgdXNlZCBieSBvdGhlciBhZGRvbnMgdG8gcHJvdmlkZSBjaGFyYWN0ZXIgZGF0YS4NCiAgICoNCiAgICogVW5pY29kZSBCYXNlIHJlbGllcyBvbiBleHRlcm5hbGx5IHByb3ZpZGVkIFVuaWNvZGUgY2hhcmFjdGVyIGRhdGEuIE9mZmljaWFsIGFkZG9ucyBhcmUNCiAgICogYXZhaWxhYmxlIHRvIHByb3ZpZGUgZGF0YSBmb3IgVW5pY29kZSBjYXRlZ29yaWVzLCBzY3JpcHRzLCBibG9ja3MsIGFuZCBwcm9wZXJ0aWVzLg0KICAgKg0KICAgKiBAcmVxdWlyZXMgWFJlZ0V4cA0KICAgKi8NCiAgLy8gPT0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLT09DQogIC8vIFByaXZhdGUgc3R1ZmYNCiAgLy8gPT0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLT09DQogIC8vIFN0b3JhZ2UgZm9yIFVuaWNvZGUgZGF0YQ0KICB2YXIgdW5pY29kZSA9IHt9OyAvLyBSZXVzZSB1dGlscw0KDQogIHZhciBkZWMgPSBYUmVnRXhwLl9kZWM7DQogIHZhciBoZXggPSBYUmVnRXhwLl9oZXg7DQogIHZhciBwYWQ0ID0gWFJlZ0V4cC5fcGFkNDsgLy8gR2VuZXJhdGVzIGEgdG9rZW4gbG9va3VwIG5hbWU6IGxvd2VyY2FzZSwgd2l0aCBoeXBoZW5zLCBzcGFjZXMsIGFuZCB1bmRlcnNjb3JlcyByZW1vdmVkDQoNCiAgZnVuY3Rpb24gbm9ybWFsaXplKG5hbWUpIHsNCiAgICByZXR1cm4gbmFtZS5yZXBsYWNlKC9bLSBfXSsvZywgJycpLnRvTG93ZXJDYXNlKCk7DQogIH0gLy8gR2V0cyB0aGUgZGVjaW1hbCBjb2RlIG9mIGEgbGl0ZXJhbCBjb2RlIHVuaXQsIFx4SEgsIFx1SEhISCwgb3IgYSBiYWNrc2xhc2gtZXNjYXBlZCBsaXRlcmFsDQoNCg0KICBmdW5jdGlvbiBjaGFyQ29kZShjaHIpIHsNCiAgICB2YXIgZXNjID0gL15cXFt4dV0oLispLy5leGVjKGNocik7DQogICAgcmV0dXJuIGVzYyA/IGRlYyhlc2NbMV0pIDogY2hyLmNoYXJDb2RlQXQoY2hyWzBdID09PSAnXFwnID8gMSA6IDApOw0KICB9IC8vIEludmVydHMgYSBsaXN0IG9mIG9yZGVyZWQgQk1QIGNoYXJhY3RlcnMgYW5kIHJhbmdlcw0KDQoNCiAgZnVuY3Rpb24gaW52ZXJ0Qm1wKHJhbmdlKSB7DQogICAgdmFyIG91dHB1dCA9ICcnOw0KICAgIHZhciBsYXN0RW5kID0gLTE7DQogICAgWFJlZ0V4cC5mb3JFYWNoKHJhbmdlLCAvKFxceC4ufFxcdS4uLi58XFw/W1xzXFNdKSg/Oi0oXFx4Li58XFx1Li4uLnxcXD9bXHNcU10pKT8vLCBmdW5jdGlvbiAobSkgew0KICAgICAgdmFyIHN0YXJ0ID0gY2hhckNvZGUobVsxXSk7DQoNCiAgICAgIGlmIChzdGFydCA+IGxhc3RFbmQgKyAxKSB7DQogICAgICAgIG91dHB1dCArPSAiXFx1Ii5jb25jYXQocGFkNChoZXgobGFzdEVuZCArIDEpKSk7DQoNCiAgICAgICAgaWYgKHN0YXJ0ID4gbGFzdEVuZCArIDIpIHsNCiAgICAgICAgICBvdXRwdXQgKz0gIi1cXHUiLmNvbmNhdChwYWQ0KGhleChzdGFydCAtIDEpKSk7DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgbGFzdEVuZCA9IGNoYXJDb2RlKG1bMl0gfHwgbVsxXSk7DQogICAgfSk7DQoNCiAgICBpZiAobGFzdEVuZCA8IDB4RkZGRikgew0KICAgICAgb3V0cHV0ICs9ICJcXHUiLmNvbmNhdChwYWQ0KGhleChsYXN0RW5kICsgMSkpKTsNCg0KICAgICAgaWYgKGxhc3RFbmQgPCAweEZGRkUpIHsNCiAgICAgICAgb3V0cHV0ICs9ICctXFx1RkZGRic7DQogICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuIG91dHB1dDsNCiAgfSAvLyBHZW5lcmF0ZXMgYW4gaW52ZXJ0ZWQgQk1QIHJhbmdlIG9uIGZpcnN0IHVzZQ0KDQoNCiAgZnVuY3Rpb24gY2FjaGVJbnZlcnRlZEJtcChzbHVnKSB7DQogICAgdmFyIHByb3AgPSAnYiEnOw0KICAgIHJldHVybiB1bmljb2RlW3NsdWddW3Byb3BdIHx8ICh1bmljb2RlW3NsdWddW3Byb3BdID0gaW52ZXJ0Qm1wKHVuaWNvZGVbc2x1Z10uYm1wKSk7DQogIH0gLy8gQ29tYmluZXMgYW5kIG9wdGlvbmFsbHkgbmVnYXRlcyBCTVAgYW5kIGFzdHJhbCBkYXRhDQoNCg0KICBmdW5jdGlvbiBidWlsZEFzdHJhbChzbHVnLCBpc05lZ2F0ZWQpIHsNCiAgICB2YXIgaXRlbSA9IHVuaWNvZGVbc2x1Z107DQogICAgdmFyIGNvbWJpbmVkID0gJyc7DQoNCiAgICBpZiAoaXRlbS5ibXAgJiYgIWl0ZW0uaXNCbXBMYXN0KSB7DQogICAgICBjb21iaW5lZCA9ICJbIi5jb25jYXQoaXRlbS5ibXAsICJdIikuY29uY2F0KGl0ZW0uYXN0cmFsID8gJ3wnIDogJycpOw0KICAgIH0NCg0KICAgIGlmIChpdGVtLmFzdHJhbCkgew0KICAgICAgY29tYmluZWQgKz0gaXRlbS5hc3RyYWw7DQogICAgfQ0KDQogICAgaWYgKGl0ZW0uaXNCbXBMYXN0ICYmIGl0ZW0uYm1wKSB7DQogICAgICBjb21iaW5lZCArPSAiIi5jb25jYXQoaXRlbS5hc3RyYWwgPyAnfCcgOiAnJywgIlsiKS5jb25jYXQoaXRlbS5ibXAsICJdIik7DQogICAgfSAvLyBBc3RyYWwgVW5pY29kZSB0b2tlbnMgYWx3YXlzIG1hdGNoIGEgY29kZSBwb2ludCwgbmV2ZXIgYSBjb2RlIHVuaXQNCg0KDQogICAgcmV0dXJuIGlzTmVnYXRlZCA/ICIoPzooPyEiLmNvbmNhdChjb21iaW5lZCwgIikoPzpbXHVEODAwLVx1REJGRl1bXHVEQzAwLVx1REZGRl18W1wwLVx1RkZGRl0pKSIpIDogIig/OiIuY29uY2F0KGNvbWJpbmVkLCAiKSIpOw0KICB9IC8vIEJ1aWxkcyBhIGNvbXBsZXRlIGFzdHJhbCBwYXR0ZXJuIG9uIGZpcnN0IHVzZQ0KDQoNCiAgZnVuY3Rpb24gY2FjaGVBc3RyYWwoc2x1ZywgaXNOZWdhdGVkKSB7DQogICAgdmFyIHByb3AgPSBpc05lZ2F0ZWQgPyAnYSEnIDogJ2E9JzsNCiAgICByZXR1cm4gdW5pY29kZVtzbHVnXVtwcm9wXSB8fCAodW5pY29kZVtzbHVnXVtwcm9wXSA9IGJ1aWxkQXN0cmFsKHNsdWcsIGlzTmVnYXRlZCkpOw0KICB9IC8vID09LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS09PQ0KICAvLyBDb3JlIGZ1bmN0aW9uYWxpdHkNCiAgLy8gPT0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLT09DQoNCiAgLyoNCiAgICogQWRkIGFzdHJhbCBtb2RlIChmbGFnIEEpIGFuZCBVbmljb2RlIHRva2VuIHN5bnRheDogYFxwey4ufWAsIGBcUHsuLn1gLCBgXHB7Xi4ufWAsIGBccENgLg0KICAgKi8NCg0KDQogIFhSZWdFeHAuYWRkVG9rZW4oIC8vIFVzZSBgKmAgaW5zdGVhZCBvZiBgK2AgdG8gYXZvaWQgY2FwdHVyaW5nIGBeYCBhcyB0aGUgdG9rZW4gbmFtZSBpbiBgXHB7Xn1gDQogIC9cXChbcFBdKSg/OnsoXF4/KShbXn1dKil9fChbQS1aYS16XSkpLywgZnVuY3Rpb24gKG1hdGNoLCBzY29wZSwgZmxhZ3MpIHsNCiAgICB2YXIgRVJSX0RPVUJMRV9ORUcgPSAnSW52YWxpZCBkb3VibGUgbmVnYXRpb24gJzsNCiAgICB2YXIgRVJSX1VOS05PV05fTkFNRSA9ICdVbmtub3duIFVuaWNvZGUgdG9rZW4gJzsNCiAgICB2YXIgRVJSX1VOS05PV05fUkVGID0gJ1VuaWNvZGUgdG9rZW4gbWlzc2luZyBkYXRhICc7DQogICAgdmFyIEVSUl9BU1RSQUxfT05MWSA9ICdBc3RyYWwgbW9kZSByZXF1aXJlZCBmb3IgVW5pY29kZSB0b2tlbiAnOw0KICAgIHZhciBFUlJfQVNUUkFMX0lOX0NMQVNTID0gJ0FzdHJhbCBtb2RlIGRvZXMgbm90IHN1cHBvcnQgVW5pY29kZSB0b2tlbnMgd2l0aGluIGNoYXJhY3RlciBjbGFzc2VzJzsgLy8gTmVnYXRlZCB2aWEgXFB7Li59IG9yIFxwe14uLn0NCg0KICAgIHZhciBpc05lZ2F0ZWQgPSBtYXRjaFsxXSA9PT0gJ1AnIHx8ICEhbWF0Y2hbMl07IC8vIFN3aXRjaCBmcm9tIEJNUCAoMC1GRkZGKSB0byBhc3RyYWwgKDAtMTBGRkZGKSBtb2RlIHZpYSBmbGFnIEENCg0KICAgIHZhciBpc0FzdHJhbE1vZGUgPSBmbGFncy5pbmRleE9mKCdBJykgIT09IC0xOyAvLyBUb2tlbiBsb29rdXAgbmFtZS4gQ2hlY2sgYFs0XWAgZmlyc3QgdG8gYXZvaWQgcGFzc2luZyBgdW5kZWZpbmVkYCB2aWEgYFxwe31gDQoNCiAgICB2YXIgc2x1ZyA9IG5vcm1hbGl6ZShtYXRjaFs0XSB8fCBtYXRjaFszXSk7IC8vIFRva2VuIGRhdGEgb2JqZWN0DQoNCiAgICB2YXIgaXRlbSA9IHVuaWNvZGVbc2x1Z107DQoNCiAgICBpZiAobWF0Y2hbMV0gPT09ICdQJyAmJiBtYXRjaFsyXSkgew0KICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKEVSUl9ET1VCTEVfTkVHICsgbWF0Y2hbMF0pOw0KICAgIH0NCg0KICAgIGlmICghdW5pY29kZS5oYXNPd25Qcm9wZXJ0eShzbHVnKSkgew0KICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKEVSUl9VTktOT1dOX05BTUUgKyBtYXRjaFswXSk7DQogICAgfSAvLyBTd2l0Y2ggdG8gdGhlIG5lZ2F0ZWQgZm9ybSBvZiB0aGUgcmVmZXJlbmNlZCBVbmljb2RlIHRva2VuDQoNCg0KICAgIGlmIChpdGVtLmludmVyc2VPZikgew0KICAgICAgc2x1ZyA9IG5vcm1hbGl6ZShpdGVtLmludmVyc2VPZik7DQoNCiAgICAgIGlmICghdW5pY29kZS5oYXNPd25Qcm9wZXJ0eShzbHVnKSkgew0KICAgICAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoIiIuY29uY2F0KEVSUl9VTktOT1dOX1JFRiArIG1hdGNoWzBdLCAiIC0+ICIpLmNvbmNhdChpdGVtLmludmVyc2VPZikpOw0KICAgICAgfQ0KDQogICAgICBpdGVtID0gdW5pY29kZVtzbHVnXTsNCiAgICAgIGlzTmVnYXRlZCA9ICFpc05lZ2F0ZWQ7DQogICAgfQ0KDQogICAgaWYgKCEoaXRlbS5ibXAgfHwgaXNBc3RyYWxNb2RlKSkgew0KICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKEVSUl9BU1RSQUxfT05MWSArIG1hdGNoWzBdKTsNCiAgICB9DQoNCiAgICBpZiAoaXNBc3RyYWxNb2RlKSB7DQogICAgICBpZiAoc2NvcGUgPT09ICdjbGFzcycpIHsNCiAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKEVSUl9BU1RSQUxfSU5fQ0xBU1MpOw0KICAgICAgfQ0KDQogICAgICByZXR1cm4gY2FjaGVBc3RyYWwoc2x1ZywgaXNOZWdhdGVkKTsNCiAgICB9DQoNCiAgICByZXR1cm4gc2NvcGUgPT09ICdjbGFzcycgPyBpc05lZ2F0ZWQgPyBjYWNoZUludmVydGVkQm1wKHNsdWcpIDogaXRlbS5ibXAgOiAiIi5jb25jYXQoKGlzTmVnYXRlZCA/ICdbXicgOiAnWycpICsgaXRlbS5ibXAsICJdIik7DQogIH0sIHsNCiAgICBzY29wZTogJ2FsbCcsDQogICAgb3B0aW9uYWxGbGFnczogJ0EnLA0KICAgIGxlYWRDaGFyOiAnXFwnDQogIH0pOw0KICAvKioNCiAgICogQWRkcyB0byB0aGUgbGlzdCBvZiBVbmljb2RlIHRva2VucyB0aGF0IFhSZWdFeHAgcmVnZXhlcyBjYW4gbWF0Y2ggdmlhIGBccGAgb3IgYFxQYC4NCiAgICoNCiAgICogQG1lbWJlck9mIFhSZWdFeHANCiAgICogQHBhcmFtIHtBcnJheX0gZGF0YSBPYmplY3RzIHdpdGggbmFtZWQgY2hhcmFjdGVyIHJhbmdlcy4gRWFjaCBvYmplY3QgbWF5IGhhdmUgcHJvcGVydGllcw0KICAgKiAgIGBuYW1lYCwgYGFsaWFzYCwgYGlzQm1wTGFzdGAsIGBpbnZlcnNlT2ZgLCBgYm1wYCwgYW5kIGBhc3RyYWxgLiBBbGwgYnV0IGBuYW1lYCBhcmUNCiAgICogICBvcHRpb25hbCwgYWx0aG91Z2ggb25lIG9mIGBibXBgIG9yIGBhc3RyYWxgIGlzIHJlcXVpcmVkICh1bmxlc3MgYGludmVyc2VPZmAgaXMgc2V0KS4gSWYNCiAgICogICBgYXN0cmFsYCBpcyBhYnNlbnQsIHRoZSBgYm1wYCBkYXRhIGlzIHVzZWQgZm9yIEJNUCBhbmQgYXN0cmFsIG1vZGVzLiBJZiBgYm1wYCBpcyBhYnNlbnQsDQogICAqICAgdGhlIG5hbWUgZXJyb3JzIGluIEJNUCBtb2RlIGJ1dCB3b3JrcyBpbiBhc3RyYWwgbW9kZS4gSWYgYm90aCBgYm1wYCBhbmQgYGFzdHJhbGAgYXJlDQogICAqICAgcHJvdmlkZWQsIHRoZSBgYm1wYCBkYXRhIG9ubHkgaXMgdXNlZCBpbiBCTVAgbW9kZSwgYW5kIHRoZSBjb21iaW5hdGlvbiBvZiBgYm1wYCBhbmQNCiAgICogICBgYXN0cmFsYCBkYXRhIGlzIHVzZWQgaW4gYXN0cmFsIG1vZGUuIGBpc0JtcExhc3RgIGlzIG5lZWRlZCB3aGVuIGEgdG9rZW4gbWF0Y2hlcyBvcnBoYW4NCiAgICogICBoaWdoIHN1cnJvZ2F0ZXMgKmFuZCogdXNlcyBzdXJyb2dhdGUgcGFpcnMgdG8gbWF0Y2ggYXN0cmFsIGNvZGUgcG9pbnRzLiBUaGUgYGJtcGAgYW5kDQogICAqICAgYGFzdHJhbGAgZGF0YSBzaG91bGQgYmUgYSBjb21iaW5hdGlvbiBvZiBsaXRlcmFsIGNoYXJhY3RlcnMgYW5kIGBceEhIYCBvciBgXHVISEhIYCBlc2NhcGUNCiAgICogICBzZXF1ZW5jZXMsIHdpdGggaHlwaGVucyB0byBjcmVhdGUgcmFuZ2VzLiBBbnkgcmVnZXggbWV0YWNoYXJhY3RlcnMgaW4gdGhlIGRhdGEgc2hvdWxkIGJlDQogICAqICAgZXNjYXBlZCwgYXBhcnQgZnJvbSByYW5nZS1jcmVhdGluZyBoeXBoZW5zLiBUaGUgYGFzdHJhbGAgZGF0YSBjYW4gYWRkaXRpb25hbGx5IHVzZQ0KICAgKiAgIGNoYXJhY3RlciBjbGFzc2VzIGFuZCBhbHRlcm5hdGlvbiwgYW5kIHNob3VsZCB1c2Ugc3Vycm9nYXRlIHBhaXJzIHRvIHJlcHJlc2VudCBhc3RyYWwgY29kZQ0KICAgKiAgIHBvaW50cy4gYGludmVyc2VPZmAgY2FuIGJlIHVzZWQgdG8gYXZvaWQgZHVwbGljYXRpbmcgY2hhcmFjdGVyIGRhdGEgaWYgYSBVbmljb2RlIHRva2VuIGlzDQogICAqICAgZGVmaW5lZCBhcyB0aGUgZXhhY3QgaW52ZXJzZSBvZiBhbm90aGVyIHRva2VuLg0KICAgKiBAZXhhbXBsZQ0KICAgKg0KICAgKiAvLyBCYXNpYyB1c2UNCiAgICogWFJlZ0V4cC5hZGRVbmljb2RlRGF0YShbew0KICAgKiAgIG5hbWU6ICdYRGlnaXQnLA0KICAgKiAgIGFsaWFzOiAnSGV4YWRlY2ltYWwnLA0KICAgKiAgIGJtcDogJzAtOUEtRmEtZicNCiAgICogfV0pOw0KICAgKiBYUmVnRXhwKCdcXHB7WERpZ2l0fTpcXHB7SGV4YWRlY2ltYWx9KycpLnRlc3QoJzA6M0QnKTsgLy8gLT4gdHJ1ZQ0KICAgKi8NCg0KICBYUmVnRXhwLmFkZFVuaWNvZGVEYXRhID0gZnVuY3Rpb24gKGRhdGEpIHsNCiAgICB2YXIgRVJSX05PX05BTUUgPSAnVW5pY29kZSB0b2tlbiByZXF1aXJlcyBuYW1lJzsNCiAgICB2YXIgRVJSX05PX0RBVEEgPSAnVW5pY29kZSB0b2tlbiBoYXMgbm8gY2hhcmFjdGVyIGRhdGEgJzsNCiAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7DQogICAgdmFyIF9kaWRJdGVyYXRvckVycm9yID0gZmFsc2U7DQogICAgdmFyIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkOw0KDQogICAgdHJ5IHsNCiAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IGRhdGFbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gKF9zdGVwID0gX2l0ZXJhdG9yLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlKSB7DQogICAgICAgIHZhciBpdGVtID0gX3N0ZXAudmFsdWU7DQoNCiAgICAgICAgaWYgKCFpdGVtLm5hbWUpIHsNCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoRVJSX05PX05BTUUpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCEoaXRlbS5pbnZlcnNlT2YgfHwgaXRlbS5ibXAgfHwgaXRlbS5hc3RyYWwpKSB7DQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKEVSUl9OT19EQVRBICsgaXRlbS5uYW1lKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHVuaWNvZGVbbm9ybWFsaXplKGl0ZW0ubmFtZSldID0gaXRlbTsNCg0KICAgICAgICBpZiAoaXRlbS5hbGlhcykgew0KICAgICAgICAgIHVuaWNvZGVbbm9ybWFsaXplKGl0ZW0uYWxpYXMpXSA9IGl0ZW07DQogICAgICAgIH0NCiAgICAgIH0gLy8gUmVzZXQgdGhlIHBhdHRlcm4gY2FjaGUgdXNlZCBieSB0aGUgYFhSZWdFeHBgIGNvbnN0cnVjdG9yLCBzaW5jZSB0aGUgc2FtZSBwYXR0ZXJuIGFuZA0KICAgICAgLy8gZmxhZ3MgbWlnaHQgbm93IHByb2R1Y2UgZGlmZmVyZW50IHJlc3VsdHMNCg0KICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlOw0KICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7DQogICAgfSBmaW5hbGx5IHsNCiAgICAgIHRyeSB7DQogICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuICE9IG51bGwpIHsNCiAgICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7DQogICAgICAgIH0NCiAgICAgIH0gZmluYWxseSB7DQogICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikgew0KICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yOw0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KDQogICAgWFJlZ0V4cC5jYWNoZS5mbHVzaCgncGF0dGVybnMnKTsNCiAgfTsNCiAgLyoqDQogICAqIEBpZ25vcmUNCiAgICoNCiAgICogUmV0dXJuIGEgcmVmZXJlbmNlIHRvIHRoZSBpbnRlcm5hbCBVbmljb2RlIGRlZmluaXRpb24gc3RydWN0dXJlIGZvciB0aGUgZ2l2ZW4gVW5pY29kZQ0KICAgKiBQcm9wZXJ0eSBpZiB0aGUgZ2l2ZW4gbmFtZSBpcyBhIGxlZ2FsIFVuaWNvZGUgUHJvcGVydHkgZm9yIHVzZSBpbiBYUmVnRXhwIGBccGAgb3IgYFxQYCByZWdleA0KICAgKiBjb25zdHJ1Y3RzLg0KICAgKg0KICAgKiBAbWVtYmVyT2YgWFJlZ0V4cA0KICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBOYW1lIGJ5IHdoaWNoIHRoZSBVbmljb2RlIFByb3BlcnR5IG1heSBiZSByZWNvZ25pemVkIChjYXNlLWluc2Vuc2l0aXZlKSwNCiAgICogICBlLmcuIGAnTidgIG9yIGAnTnVtYmVyJ2AuIFRoZSBnaXZlbiBuYW1lIGlzIG1hdGNoZWQgYWdhaW5zdCBhbGwgcmVnaXN0ZXJlZCBVbmljb2RlDQogICAqICAgUHJvcGVydGllcyBhbmQgUHJvcGVydHkgQWxpYXNlcy4NCiAgICogQHJldHVybnMge09iamVjdH0gUmVmZXJlbmNlIHRvIGRlZmluaXRpb24gc3RydWN0dXJlIHdoZW4gdGhlIG5hbWUgbWF0Y2hlcyBhIFVuaWNvZGUgUHJvcGVydHkuDQogICAqDQogICAqIEBub3RlDQogICAqIEZvciBtb3JlIGluZm8gb24gVW5pY29kZSBQcm9wZXJ0aWVzLCBzZWUgYWxzbyBodHRwOi8vdW5pY29kZS5vcmcvcmVwb3J0cy90cjE4LyNDYXRlZ29yaWVzLg0KICAgKg0KICAgKiBAbm90ZQ0KICAgKiBUaGlzIG1ldGhvZCBpcyAqbm90KiBwYXJ0IG9mIHRoZSBvZmZpY2lhbGx5IGRvY3VtZW50ZWQgQVBJIGFuZCBtYXkgY2hhbmdlIG9yIGJlIHJlbW92ZWQgaW4NCiAgICogdGhlIGZ1dHVyZS4gSXQgaXMgbWVhbnQgZm9yIHVzZXJsYW5kIGNvZGUgdGhhdCB3aXNoZXMgdG8gcmV1c2UgdGhlIChsYXJnZSkgaW50ZXJuYWwgVW5pY29kZQ0KICAgKiBzdHJ1Y3R1cmVzIHNldCB1cCBieSBYUmVnRXhwLg0KICAgKi8NCg0KDQogIFhSZWdFeHAuX2dldFVuaWNvZGVQcm9wZXJ0eSA9IGZ1bmN0aW9uIChuYW1lKSB7DQogICAgdmFyIHNsdWcgPSBub3JtYWxpemUobmFtZSk7DQogICAgcmV0dXJuIHVuaWNvZGVbc2x1Z107DQogIH07DQp9Ow0KDQpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsNCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1siZGVmYXVsdCJdOw0KfSx7fV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQoidXNlIHN0cmljdCI7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwOw0KDQp2YXIgX2Jsb2NrcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiLi4vLi4vdG9vbHMvb3V0cHV0L2Jsb2NrcyIpKTsNCg0KZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0NCg0KLyohDQogKiBYUmVnRXhwIFVuaWNvZGUgQmxvY2tzIDQuMi4wDQogKiA8eHJlZ2V4cC5jb20+DQogKiBTdGV2ZW4gTGV2aXRoYW4gKGMpIDIwMTAtcHJlc2VudCBNSVQgTGljZW5zZQ0KICogVW5pY29kZSBkYXRhIGJ5IE1hdGhpYXMgQnluZW5zIDxtYXRoaWFzYnluZW5zLmJlPg0KICovDQp2YXIgX2RlZmF1bHQgPSBmdW5jdGlvbiBfZGVmYXVsdChYUmVnRXhwKSB7DQogIC8qKg0KICAgKiBBZGRzIHN1cHBvcnQgZm9yIGFsbCBVbmljb2RlIGJsb2Nrcy4gQmxvY2sgbmFtZXMgdXNlIHRoZSBwcmVmaXggJ0luJy4gRS5nLiwNCiAgICogYFxwe0luQmFzaWNMYXRpbn1gLiBUb2tlbiBuYW1lcyBhcmUgY2FzZSBpbnNlbnNpdGl2ZSwgYW5kIGFueSBzcGFjZXMsIGh5cGhlbnMsIGFuZA0KICAgKiB1bmRlcnNjb3JlcyBhcmUgaWdub3JlZC4NCiAgICoNCiAgICogVXNlcyBVbmljb2RlIDExLjAuMC4NCiAgICoNCiAgICogQHJlcXVpcmVzIFhSZWdFeHAsIFVuaWNvZGUgQmFzZQ0KICAgKi8NCiAgaWYgKCFYUmVnRXhwLmFkZFVuaWNvZGVEYXRhKSB7DQogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCdVbmljb2RlIEJhc2UgbXVzdCBiZSBsb2FkZWQgYmVmb3JlIFVuaWNvZGUgQmxvY2tzJyk7DQogIH0NCg0KICBYUmVnRXhwLmFkZFVuaWNvZGVEYXRhKF9ibG9ja3MuZGVmYXVsdCk7DQp9Ow0KDQpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsNCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1siZGVmYXVsdCJdOw0KfSx7Ii4uLy4uL3Rvb2xzL291dHB1dC9ibG9ja3MiOjEwfV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQoidXNlIHN0cmljdCI7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwOw0KDQp2YXIgX2NhdGVnb3JpZXMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIi4uLy4uL3Rvb2xzL291dHB1dC9jYXRlZ29yaWVzIikpOw0KDQpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQ0KDQovKiENCiAqIFhSZWdFeHAgVW5pY29kZSBDYXRlZ29yaWVzIDQuMi4wDQogKiA8eHJlZ2V4cC5jb20+DQogKiBTdGV2ZW4gTGV2aXRoYW4gKGMpIDIwMTAtcHJlc2VudCBNSVQgTGljZW5zZQ0KICogVW5pY29kZSBkYXRhIGJ5IE1hdGhpYXMgQnluZW5zIDxtYXRoaWFzYnluZW5zLmJlPg0KICovDQp2YXIgX2RlZmF1bHQgPSBmdW5jdGlvbiBfZGVmYXVsdChYUmVnRXhwKSB7DQogIC8qKg0KICAgKiBBZGRzIHN1cHBvcnQgZm9yIFVuaWNvZGUncyBnZW5lcmFsIGNhdGVnb3JpZXMuIEUuZy4sIGBccHtMdX1gIG9yIGBccHtVcHBlcmNhc2UgTGV0dGVyfWAuIFNlZQ0KICAgKiBjYXRlZ29yeSBkZXNjcmlwdGlvbnMgaW4gVUFYICM0NCA8aHR0cDovL3VuaWNvZGUub3JnL3JlcG9ydHMvdHI0NC8jR0NfVmFsdWVzX1RhYmxlPi4gVG9rZW4NCiAgICogbmFtZXMgYXJlIGNhc2UgaW5zZW5zaXRpdmUsIGFuZCBhbnkgc3BhY2VzLCBoeXBoZW5zLCBhbmQgdW5kZXJzY29yZXMgYXJlIGlnbm9yZWQuDQogICAqDQogICAqIFVzZXMgVW5pY29kZSAxMS4wLjAuDQogICAqDQogICAqIEByZXF1aXJlcyBYUmVnRXhwLCBVbmljb2RlIEJhc2UNCiAgICovDQogIGlmICghWFJlZ0V4cC5hZGRVbmljb2RlRGF0YSkgew0KICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcignVW5pY29kZSBCYXNlIG11c3QgYmUgbG9hZGVkIGJlZm9yZSBVbmljb2RlIENhdGVnb3JpZXMnKTsNCiAgfQ0KDQogIFhSZWdFeHAuYWRkVW5pY29kZURhdGEoX2NhdGVnb3JpZXMuZGVmYXVsdCk7DQp9Ow0KDQpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsNCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1siZGVmYXVsdCJdOw0KfSx7Ii4uLy4uL3Rvb2xzL291dHB1dC9jYXRlZ29yaWVzIjoxMX1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KInVzZSBzdHJpY3QiOw0KDQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7DQogIHZhbHVlOiB0cnVlDQp9KTsNCmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsNCg0KdmFyIF9wcm9wZXJ0aWVzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCIuLi8uLi90b29scy9vdXRwdXQvcHJvcGVydGllcyIpKTsNCg0KZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0NCg0KLyohDQogKiBYUmVnRXhwIFVuaWNvZGUgUHJvcGVydGllcyA0LjIuMA0KICogPHhyZWdleHAuY29tPg0KICogU3RldmVuIExldml0aGFuIChjKSAyMDEyLXByZXNlbnQgTUlUIExpY2Vuc2UNCiAqIFVuaWNvZGUgZGF0YSBieSBNYXRoaWFzIEJ5bmVucyA8bWF0aGlhc2J5bmVucy5iZT4NCiAqLw0KdmFyIF9kZWZhdWx0ID0gZnVuY3Rpb24gX2RlZmF1bHQoWFJlZ0V4cCkgew0KICAvKioNCiAgICogQWRkcyBwcm9wZXJ0aWVzIHRvIG1lZXQgdGhlIFVUUyAjMTggTGV2ZWwgMSBSTDEuMiByZXF1aXJlbWVudHMgZm9yIFVuaWNvZGUgcmVnZXggc3VwcG9ydC4gU2VlDQogICAqIDxodHRwOi8vdW5pY29kZS5vcmcvcmVwb3J0cy90cjE4LyNSTDEuMj4uIEZvbGxvd2luZyBhcmUgZGVmaW5pdGlvbnMgb2YgdGhlc2UgcHJvcGVydGllcyBmcm9tDQogICAqIFVBWCAjNDQgPGh0dHA6Ly91bmljb2RlLm9yZy9yZXBvcnRzL3RyNDQvPjoNCiAgICoNCiAgICogLSBBbHBoYWJldGljDQogICAqICAgQ2hhcmFjdGVycyB3aXRoIHRoZSBBbHBoYWJldGljIHByb3BlcnR5LiBHZW5lcmF0ZWQgZnJvbTogTG93ZXJjYXNlICsgVXBwZXJjYXNlICsgTHQgKyBMbSArDQogICAqICAgTG8gKyBObCArIE90aGVyX0FscGhhYmV0aWMuDQogICAqDQogICAqIC0gRGVmYXVsdF9JZ25vcmFibGVfQ29kZV9Qb2ludA0KICAgKiAgIEZvciBwcm9ncmFtbWF0aWMgZGV0ZXJtaW5hdGlvbiBvZiBkZWZhdWx0IGlnbm9yYWJsZSBjb2RlIHBvaW50cy4gTmV3IGNoYXJhY3RlcnMgdGhhdCBzaG91bGQNCiAgICogICBiZSBpZ25vcmVkIGluIHJlbmRlcmluZyAodW5sZXNzIGV4cGxpY2l0bHkgc3VwcG9ydGVkKSB3aWxsIGJlIGFzc2lnbmVkIGluIHRoZXNlIHJhbmdlcywNCiAgICogICBwZXJtaXR0aW5nIHByb2dyYW1zIHRvIGNvcnJlY3RseSBoYW5kbGUgdGhlIGRlZmF1bHQgcmVuZGVyaW5nIG9mIHN1Y2ggY2hhcmFjdGVycyB3aGVuIG5vdA0KICAgKiAgIG90aGVyd2lzZSBzdXBwb3J0ZWQuDQogICAqDQogICAqIC0gTG93ZXJjYXNlDQogICAqICAgQ2hhcmFjdGVycyB3aXRoIHRoZSBMb3dlcmNhc2UgcHJvcGVydHkuIEdlbmVyYXRlZCBmcm9tOiBMbCArIE90aGVyX0xvd2VyY2FzZS4NCiAgICoNCiAgICogLSBOb25jaGFyYWN0ZXJfQ29kZV9Qb2ludA0KICAgKiAgIENvZGUgcG9pbnRzIHBlcm1hbmVudGx5IHJlc2VydmVkIGZvciBpbnRlcm5hbCB1c2UuDQogICAqDQogICAqIC0gVXBwZXJjYXNlDQogICAqICAgQ2hhcmFjdGVycyB3aXRoIHRoZSBVcHBlcmNhc2UgcHJvcGVydHkuIEdlbmVyYXRlZCBmcm9tOiBMdSArIE90aGVyX1VwcGVyY2FzZS4NCiAgICoNCiAgICogLSBXaGl0ZV9TcGFjZQ0KICAgKiAgIFNwYWNlcywgc2VwYXJhdG9yIGNoYXJhY3RlcnMgYW5kIG90aGVyIGNvbnRyb2wgY2hhcmFjdGVycyB3aGljaCBzaG91bGQgYmUgdHJlYXRlZCBieQ0KICAgKiAgIHByb2dyYW1taW5nIGxhbmd1YWdlcyBhcyAid2hpdGUgc3BhY2UiIGZvciB0aGUgcHVycG9zZSBvZiBwYXJzaW5nIGVsZW1lbnRzLg0KICAgKg0KICAgKiBUaGUgcHJvcGVydGllcyBBU0NJSSwgQW55LCBhbmQgQXNzaWduZWQgYXJlIGFsc28gaW5jbHVkZWQgYnV0IGFyZSBub3QgZGVmaW5lZCBpbiBVQVggIzQ0LiBVVFMNCiAgICogIzE4IFJMMS4yIGFkZGl0aW9uYWxseSByZXF1aXJlcyBzdXBwb3J0IGZvciBVbmljb2RlIHNjcmlwdHMgYW5kIGdlbmVyYWwgY2F0ZWdvcmllcy4gVGhlc2UgYXJlDQogICAqIGluY2x1ZGVkIGluIFhSZWdFeHAncyBVbmljb2RlIENhdGVnb3JpZXMgYW5kIFVuaWNvZGUgU2NyaXB0cyBhZGRvbnMuDQogICAqDQogICAqIFRva2VuIG5hbWVzIGFyZSBjYXNlIGluc2Vuc2l0aXZlLCBhbmQgYW55IHNwYWNlcywgaHlwaGVucywgYW5kIHVuZGVyc2NvcmVzIGFyZSBpZ25vcmVkLg0KICAgKg0KICAgKiBVc2VzIFVuaWNvZGUgMTEuMC4wLg0KICAgKg0KICAgKiBAcmVxdWlyZXMgWFJlZ0V4cCwgVW5pY29kZSBCYXNlDQogICAqLw0KICBpZiAoIVhSZWdFeHAuYWRkVW5pY29kZURhdGEpIHsNCiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoJ1VuaWNvZGUgQmFzZSBtdXN0IGJlIGxvYWRlZCBiZWZvcmUgVW5pY29kZSBQcm9wZXJ0aWVzJyk7DQogIH0NCg0KICB2YXIgdW5pY29kZURhdGEgPSBfcHJvcGVydGllcy5kZWZhdWx0OyAvLyBBZGQgbm9uLWdlbmVyYXRlZCBkYXRhDQoNCiAgdW5pY29kZURhdGEucHVzaCh7DQogICAgbmFtZTogJ0Fzc2lnbmVkJywNCiAgICAvLyBTaW5jZSB0aGlzIGlzIGRlZmluZWQgYXMgdGhlIGludmVyc2Ugb2YgVW5pY29kZSBjYXRlZ29yeSBDbiAoVW5hc3NpZ25lZCksIHRoZSBVbmljb2RlDQogICAgLy8gQ2F0ZWdvcmllcyBhZGRvbiBpcyByZXF1aXJlZCB0byB1c2UgdGhpcyBwcm9wZXJ0eQ0KICAgIGludmVyc2VPZjogJ0NuJw0KICB9KTsNCiAgWFJlZ0V4cC5hZGRVbmljb2RlRGF0YSh1bmljb2RlRGF0YSk7DQp9Ow0KDQpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsNCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1siZGVmYXVsdCJdOw0KfSx7Ii4uLy4uL3Rvb2xzL291dHB1dC9wcm9wZXJ0aWVzIjoxMn1dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KInVzZSBzdHJpY3QiOw0KDQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7DQogIHZhbHVlOiB0cnVlDQp9KTsNCmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsNCg0KdmFyIF9zY3JpcHRzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCIuLi8uLi90b29scy9vdXRwdXQvc2NyaXB0cyIpKTsNCg0KZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0NCg0KLyohDQogKiBYUmVnRXhwIFVuaWNvZGUgU2NyaXB0cyA0LjIuMA0KICogPHhyZWdleHAuY29tPg0KICogU3RldmVuIExldml0aGFuIChjKSAyMDEwLXByZXNlbnQgTUlUIExpY2Vuc2UNCiAqIFVuaWNvZGUgZGF0YSBieSBNYXRoaWFzIEJ5bmVucyA8bWF0aGlhc2J5bmVucy5iZT4NCiAqLw0KdmFyIF9kZWZhdWx0ID0gZnVuY3Rpb24gX2RlZmF1bHQoWFJlZ0V4cCkgew0KICAvKioNCiAgICogQWRkcyBzdXBwb3J0IGZvciBhbGwgVW5pY29kZSBzY3JpcHRzLiBFLmcuLCBgXHB7TGF0aW59YC4gVG9rZW4gbmFtZXMgYXJlIGNhc2UgaW5zZW5zaXRpdmUsDQogICAqIGFuZCBhbnkgc3BhY2VzLCBoeXBoZW5zLCBhbmQgdW5kZXJzY29yZXMgYXJlIGlnbm9yZWQuDQogICAqDQogICAqIFVzZXMgVW5pY29kZSAxMS4wLjAuDQogICAqDQogICAqIEByZXF1aXJlcyBYUmVnRXhwLCBVbmljb2RlIEJhc2UNCiAgICovDQogIGlmICghWFJlZ0V4cC5hZGRVbmljb2RlRGF0YSkgew0KICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcignVW5pY29kZSBCYXNlIG11c3QgYmUgbG9hZGVkIGJlZm9yZSBVbmljb2RlIFNjcmlwdHMnKTsNCiAgfQ0KDQogIFhSZWdFeHAuYWRkVW5pY29kZURhdGEoX3NjcmlwdHMuZGVmYXVsdCk7DQp9Ow0KDQpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsNCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1siZGVmYXVsdCJdOw0KfSx7Ii4uLy4uL3Rvb2xzL291dHB1dC9zY3JpcHRzIjoxM31dLDg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KInVzZSBzdHJpY3QiOw0KDQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7DQogIHZhbHVlOiB0cnVlDQp9KTsNCmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsNCg0KdmFyIF94cmVnZXhwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCIuL3hyZWdleHAiKSk7DQoNCnZhciBfYnVpbGQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIi4vYWRkb25zL2J1aWxkIikpOw0KDQp2YXIgX21hdGNocmVjdXJzaXZlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCIuL2FkZG9ucy9tYXRjaHJlY3Vyc2l2ZSIpKTsNCg0KdmFyIF91bmljb2RlQmFzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiLi9hZGRvbnMvdW5pY29kZS1iYXNlIikpOw0KDQp2YXIgX3VuaWNvZGVCbG9ja3MgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIi4vYWRkb25zL3VuaWNvZGUtYmxvY2tzIikpOw0KDQp2YXIgX3VuaWNvZGVDYXRlZ29yaWVzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCIuL2FkZG9ucy91bmljb2RlLWNhdGVnb3JpZXMiKSk7DQoNCnZhciBfdW5pY29kZVByb3BlcnRpZXMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIi4vYWRkb25zL3VuaWNvZGUtcHJvcGVydGllcyIpKTsNCg0KdmFyIF91bmljb2RlU2NyaXB0cyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiLi9hZGRvbnMvdW5pY29kZS1zY3JpcHRzIikpOw0KDQpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQ0KDQooMCwgX2J1aWxkLmRlZmF1bHQpKF94cmVnZXhwLmRlZmF1bHQpOw0KKDAsIF9tYXRjaHJlY3Vyc2l2ZS5kZWZhdWx0KShfeHJlZ2V4cC5kZWZhdWx0KTsNCigwLCBfdW5pY29kZUJhc2UuZGVmYXVsdCkoX3hyZWdleHAuZGVmYXVsdCk7DQooMCwgX3VuaWNvZGVCbG9ja3MuZGVmYXVsdCkoX3hyZWdleHAuZGVmYXVsdCk7DQooMCwgX3VuaWNvZGVDYXRlZ29yaWVzLmRlZmF1bHQpKF94cmVnZXhwLmRlZmF1bHQpOw0KKDAsIF91bmljb2RlUHJvcGVydGllcy5kZWZhdWx0KShfeHJlZ2V4cC5kZWZhdWx0KTsNCigwLCBfdW5pY29kZVNjcmlwdHMuZGVmYXVsdCkoX3hyZWdleHAuZGVmYXVsdCk7DQp2YXIgX2RlZmF1bHQgPSBfeHJlZ2V4cC5kZWZhdWx0Ow0KZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7DQptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbImRlZmF1bHQiXTsNCn0seyIuL2FkZG9ucy9idWlsZCI6MSwiLi9hZGRvbnMvbWF0Y2hyZWN1cnNpdmUiOjIsIi4vYWRkb25zL3VuaWNvZGUtYmFzZSI6MywiLi9hZGRvbnMvdW5pY29kZS1ibG9ja3MiOjQsIi4vYWRkb25zL3VuaWNvZGUtY2F0ZWdvcmllcyI6NSwiLi9hZGRvbnMvdW5pY29kZS1wcm9wZXJ0aWVzIjo2LCIuL2FkZG9ucy91bmljb2RlLXNjcmlwdHMiOjcsIi4veHJlZ2V4cCI6OX1dLDk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KInVzZSBzdHJpY3QiOw0KDQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7DQogIHZhbHVlOiB0cnVlDQp9KTsNCmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsNCg0KZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0NCg0KZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOyB9DQoNCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0NCg0KZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9DQoNCi8qIQ0KICogWFJlZ0V4cCA0LjIuMA0KICogPHhyZWdleHAuY29tPg0KICogU3RldmVuIExldml0aGFuIChjKSAyMDA3LXByZXNlbnQgTUlUIExpY2Vuc2UNCiAqLw0KDQovKioNCiAqIFhSZWdFeHAgcHJvdmlkZXMgYXVnbWVudGVkLCBleHRlbnNpYmxlIHJlZ3VsYXIgZXhwcmVzc2lvbnMuIFlvdSBnZXQgYWRkaXRpb25hbCByZWdleCBzeW50YXggYW5kDQogKiBmbGFncywgYmV5b25kIHdoYXQgYnJvd3NlcnMgc3VwcG9ydCBuYXRpdmVseS4gWFJlZ0V4cCBpcyBhbHNvIGEgcmVnZXggdXRpbGl0eSBiZWx0IHdpdGggdG9vbHMgdG8NCiAqIG1ha2UgeW91ciBjbGllbnQtc2lkZSBncmVwcGluZyBzaW1wbGVyIGFuZCBtb3JlIHBvd2VyZnVsLCB3aGlsZSBmcmVlaW5nIHlvdSBmcm9tIHJlbGF0ZWQNCiAqIGNyb3NzLWJyb3dzZXIgaW5jb25zaXN0ZW5jaWVzLg0KICovDQovLyA9PS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tPT0NCi8vIFByaXZhdGUgc3R1ZmYNCi8vID09LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS09PQ0KLy8gUHJvcGVydHkgbmFtZSB1c2VkIGZvciBleHRlbmRlZCByZWdleCBpbnN0YW5jZSBkYXRhDQp2YXIgUkVHRVhfREFUQSA9ICd4cmVnZXhwJzsgLy8gT3B0aW9uYWwgZmVhdHVyZXMgdGhhdCBjYW4gYmUgaW5zdGFsbGVkIGFuZCB1bmluc3RhbGxlZA0KDQp2YXIgZmVhdHVyZXMgPSB7DQogIGFzdHJhbDogZmFsc2UsDQogIG5hbWVzcGFjaW5nOiBmYWxzZQ0KfTsgLy8gTmF0aXZlIG1ldGhvZHMgdG8gdXNlIGFuZCByZXN0b3JlICgnbmF0aXZlJyBpcyBhbiBFUzMgcmVzZXJ2ZWQga2V5d29yZCkNCg0KdmFyIG5hdGl2ID0gew0KICBleGVjOiBSZWdFeHAucHJvdG90eXBlLmV4ZWMsDQogIHRlc3Q6IFJlZ0V4cC5wcm90b3R5cGUudGVzdCwNCiAgbWF0Y2g6IFN0cmluZy5wcm90b3R5cGUubWF0Y2gsDQogIHJlcGxhY2U6IFN0cmluZy5wcm90b3R5cGUucmVwbGFjZSwNCiAgc3BsaXQ6IFN0cmluZy5wcm90b3R5cGUuc3BsaXQNCn07IC8vIFN0b3JhZ2UgZm9yIGZpeGVkL2V4dGVuZGVkIG5hdGl2ZSBtZXRob2RzDQoNCnZhciBmaXhlZCA9IHt9OyAvLyBTdG9yYWdlIGZvciByZWdleGVzIGNhY2hlZCBieSBgWFJlZ0V4cC5jYWNoZWANCg0KdmFyIHJlZ2V4Q2FjaGUgPSB7fTsgLy8gU3RvcmFnZSBmb3IgcGF0dGVybiBkZXRhaWxzIGNhY2hlZCBieSB0aGUgYFhSZWdFeHBgIGNvbnN0cnVjdG9yDQoNCnZhciBwYXR0ZXJuQ2FjaGUgPSB7fTsgLy8gU3RvcmFnZSBmb3IgcmVnZXggc3ludGF4IHRva2VucyBhZGRlZCBpbnRlcm5hbGx5IG9yIGJ5IGBYUmVnRXhwLmFkZFRva2VuYA0KDQp2YXIgdG9rZW5zID0gW107IC8vIFRva2VuIHNjb3Blcw0KDQp2YXIgZGVmYXVsdFNjb3BlID0gJ2RlZmF1bHQnOw0KdmFyIGNsYXNzU2NvcGUgPSAnY2xhc3MnOyAvLyBSZWdleGVzIHRoYXQgbWF0Y2ggbmF0aXZlIHJlZ2V4IHN5bnRheCwgaW5jbHVkaW5nIG9jdGFscw0KDQp2YXIgbmF0aXZlVG9rZW5zID0gew0KICAvLyBBbnkgbmF0aXZlIG11bHRpY2hhcmFjdGVyIHRva2VuIGluIGRlZmF1bHQgc2NvcGUsIG9yIGFueSBzaW5nbGUgY2hhcmFjdGVyDQogICdkZWZhdWx0JzogL1xcKD86MCg/OlswLTNdWzAtN117MCwyfXxbNC03XVswLTddPyk/fFsxLTldXGQqfHhbXGRBLUZhLWZdezJ9fHUoPzpbXGRBLUZhLWZdezR9fHtbXGRBLUZhLWZdK30pfGNbQS1aYS16XXxbXHNcU10pfFwoXD8oPzpbOj0hXXw8Wz0hXSl8Wz8qK11cP3x7XGQrKD86LFxkKik/fVw/P3xbXHNcU10vLA0KICAvLyBBbnkgbmF0aXZlIG11bHRpY2hhcmFjdGVyIHRva2VuIGluIGNoYXJhY3RlciBjbGFzcyBzY29wZSwgb3IgYW55IHNpbmdsZSBjaGFyYWN0ZXINCiAgJ2NsYXNzJzogL1xcKD86WzAtM11bMC03XXswLDJ9fFs0LTddWzAtN10/fHhbXGRBLUZhLWZdezJ9fHUoPzpbXGRBLUZhLWZdezR9fHtbXGRBLUZhLWZdK30pfGNbQS1aYS16XXxbXHNcU10pfFtcc1xTXS8NCn07IC8vIEFueSBiYWNrcmVmZXJlbmNlIG9yIGRvbGxhci1wcmVmaXhlZCBjaGFyYWN0ZXIgaW4gcmVwbGFjZW1lbnQgc3RyaW5ncw0KDQp2YXIgcmVwbGFjZW1lbnRUb2tlbiA9IC9cJCg/OnsoW1x3JF0rKX18PChbXHckXSspPnwoXGRcZD98W1xzXFNdKSkvZzsgLy8gQ2hlY2sgZm9yIGNvcnJlY3QgYGV4ZWNgIGhhbmRsaW5nIG9mIG5vbnBhcnRpY2lwYXRpbmcgY2FwdHVyaW5nIGdyb3Vwcw0KDQp2YXIgY29ycmVjdEV4ZWNOcGNnID0gbmF0aXYuZXhlYy5jYWxsKC8oKT8/LywgJycpWzFdID09PSB1bmRlZmluZWQ7IC8vIENoZWNrIGZvciBFUzYgYGZsYWdzYCBwcm9wIHN1cHBvcnQNCg0KdmFyIGhhc0ZsYWdzUHJvcCA9IC94Ly5mbGFncyAhPT0gdW5kZWZpbmVkOyAvLyBTaG9ydGN1dCB0byBgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZ2ANCg0KdmFyIF9yZWYgPSB7fSwNCiAgICB0b1N0cmluZyA9IF9yZWYudG9TdHJpbmc7DQoNCmZ1bmN0aW9uIGhhc05hdGl2ZUZsYWcoZmxhZykgew0KICAvLyBDYW4ndCBjaGVjayBiYXNlZCBvbiB0aGUgcHJlc2VuY2Ugb2YgcHJvcGVydGllcy9nZXR0ZXJzIHNpbmNlIGJyb3dzZXJzIG1pZ2h0IHN1cHBvcnQgc3VjaA0KICAvLyBwcm9wZXJ0aWVzIGV2ZW4gd2hlbiB0aGV5IGRvbid0IHN1cHBvcnQgdGhlIGNvcnJlc3BvbmRpbmcgZmxhZyBpbiByZWdleCBjb25zdHJ1Y3Rpb24gKHRlc3RlZA0KICAvLyBpbiBDaHJvbWUgNDgsIHdoZXJlIGAndW5pY29kZScgaW4gL3gvYCBpcyB0cnVlIGJ1dCB0cnlpbmcgdG8gY29uc3RydWN0IGEgcmVnZXggd2l0aCBmbGFnIGB1YA0KICAvLyB0aHJvd3MgYW4gZXJyb3IpDQogIHZhciBpc1N1cHBvcnRlZCA9IHRydWU7DQoNCiAgdHJ5IHsNCiAgICAvLyBDYW4ndCB1c2UgcmVnZXggbGl0ZXJhbHMgZm9yIHRlc3RpbmcgZXZlbiBpbiBhIGB0cnlgIGJlY2F1c2UgcmVnZXggbGl0ZXJhbHMgd2l0aA0KICAgIC8vIHVuc3VwcG9ydGVkIGZsYWdzIGNhdXNlIGEgY29tcGlsYXRpb24gZXJyb3IgaW4gSUUNCiAgICBuZXcgUmVnRXhwKCcnLCBmbGFnKTsNCiAgfSBjYXRjaCAoZXhjZXB0aW9uKSB7DQogICAgaXNTdXBwb3J0ZWQgPSBmYWxzZTsNCiAgfQ0KDQogIHJldHVybiBpc1N1cHBvcnRlZDsNCn0gLy8gQ2hlY2sgZm9yIEVTNiBgdWAgZmxhZyBzdXBwb3J0DQoNCg0KdmFyIGhhc05hdGl2ZVUgPSBoYXNOYXRpdmVGbGFnKCd1Jyk7IC8vIENoZWNrIGZvciBFUzYgYHlgIGZsYWcgc3VwcG9ydA0KDQp2YXIgaGFzTmF0aXZlWSA9IGhhc05hdGl2ZUZsYWcoJ3knKTsgLy8gVHJhY2tlciBmb3Iga25vd24gZmxhZ3MsIGluY2x1ZGluZyBhZGRvbiBmbGFncw0KDQp2YXIgcmVnaXN0ZXJlZEZsYWdzID0gew0KICBnOiB0cnVlLA0KICBpOiB0cnVlLA0KICBtOiB0cnVlLA0KICB1OiBoYXNOYXRpdmVVLA0KICB5OiBoYXNOYXRpdmVZDQp9Ow0KLyoqDQogKiBBdHRhY2hlcyBleHRlbmRlZCBkYXRhIGFuZCBgWFJlZ0V4cC5wcm90b3R5cGVgIHByb3BlcnRpZXMgdG8gYSByZWdleCBvYmplY3QuDQogKg0KICogQHByaXZhdGUNCiAqIEBwYXJhbSB7UmVnRXhwfSByZWdleCBSZWdleCB0byBhdWdtZW50Lg0KICogQHBhcmFtIHtBcnJheX0gY2FwdHVyZU5hbWVzIEFycmF5IHdpdGggY2FwdHVyZSBuYW1lcywgb3IgYG51bGxgLg0KICogQHBhcmFtIHtTdHJpbmd9IHhTb3VyY2UgWFJlZ0V4cCBwYXR0ZXJuIHVzZWQgdG8gZ2VuZXJhdGUgYHJlZ2V4YCwgb3IgYG51bGxgIGlmIE4vQS4NCiAqIEBwYXJhbSB7U3RyaW5nfSB4RmxhZ3MgWFJlZ0V4cCBmbGFncyB1c2VkIHRvIGdlbmVyYXRlIGByZWdleGAsIG9yIGBudWxsYCBpZiBOL0EuDQogKiBAcGFyYW0ge0Jvb2xlYW59IFtpc0ludGVybmFsT25seT1mYWxzZV0gV2hldGhlciB0aGUgcmVnZXggd2lsbCBiZSB1c2VkIG9ubHkgZm9yIGludGVybmFsDQogKiAgIG9wZXJhdGlvbnMsIGFuZCBuZXZlciBleHBvc2VkIHRvIHVzZXJzLiBGb3IgaW50ZXJuYWwtb25seSByZWdleGVzLCB3ZSBjYW4gaW1wcm92ZSBwZXJmIGJ5DQogKiAgIHNraXBwaW5nIHNvbWUgb3BlcmF0aW9ucyBsaWtlIGF0dGFjaGluZyBgWFJlZ0V4cC5wcm90b3R5cGVgIHByb3BlcnRpZXMuDQogKiBAcmV0dXJucyB7UmVnRXhwfSBBdWdtZW50ZWQgcmVnZXguDQogKi8NCg0KZnVuY3Rpb24gYXVnbWVudChyZWdleCwgY2FwdHVyZU5hbWVzLCB4U291cmNlLCB4RmxhZ3MsIGlzSW50ZXJuYWxPbmx5KSB7DQogIHJlZ2V4W1JFR0VYX0RBVEFdID0gew0KICAgIGNhcHR1cmVOYW1lczogY2FwdHVyZU5hbWVzDQogIH07DQoNCiAgaWYgKGlzSW50ZXJuYWxPbmx5KSB7DQogICAgcmV0dXJuIHJlZ2V4Ow0KICB9IC8vIENhbid0IGF1dG8taW5oZXJpdCB0aGVzZSBzaW5jZSB0aGUgWFJlZ0V4cCBjb25zdHJ1Y3RvciByZXR1cm5zIGEgbm9ucHJpbWl0aXZlIHZhbHVlDQoNCg0KICBpZiAocmVnZXguX19wcm90b19fKSB7DQogICAgcmVnZXguX19wcm90b19fID0gWFJlZ0V4cC5wcm90b3R5cGU7DQogIH0gZWxzZSB7DQogICAgZm9yICh2YXIgcCBpbiBYUmVnRXhwLnByb3RvdHlwZSkgew0KICAgICAgLy8gQW4gYFhSZWdFeHAucHJvdG90eXBlLmhhc093blByb3BlcnR5KHApYCBjaGVjayB3b3VsZG4ndCBiZSB3b3J0aCBpdCBoZXJlLCBzaW5jZSB0aGlzDQogICAgICAvLyBpcyBwZXJmb3JtYW5jZSBzZW5zaXRpdmUsIGFuZCBlbnVtZXJhYmxlIGBPYmplY3QucHJvdG90eXBlYCBvciBgUmVnRXhwLnByb3RvdHlwZWANCiAgICAgIC8vIGV4dGVuc2lvbnMgZXhpc3Qgb24gYHJlZ2V4LnByb3RvdHlwZWAgYW55d2F5DQogICAgICByZWdleFtwXSA9IFhSZWdFeHAucHJvdG90eXBlW3BdOw0KICAgIH0NCiAgfQ0KDQogIHJlZ2V4W1JFR0VYX0RBVEFdLnNvdXJjZSA9IHhTb3VyY2U7IC8vIEVtdWxhdGUgdGhlIEVTNiBgZmxhZ3NgIHByb3AgYnkgZW5zdXJpbmcgZmxhZ3MgYXJlIGluIGFscGhhYmV0aWNhbCBvcmRlcg0KDQogIHJlZ2V4W1JFR0VYX0RBVEFdLmZsYWdzID0geEZsYWdzID8geEZsYWdzLnNwbGl0KCcnKS5zb3J0KCkuam9pbignJykgOiB4RmxhZ3M7DQogIHJldHVybiByZWdleDsNCn0NCi8qKg0KICogUmVtb3ZlcyBhbnkgZHVwbGljYXRlIGNoYXJhY3RlcnMgZnJvbSB0aGUgcHJvdmlkZWQgc3RyaW5nLg0KICoNCiAqIEBwcml2YXRlDQogKiBAcGFyYW0ge1N0cmluZ30gc3RyIFN0cmluZyB0byByZW1vdmUgZHVwbGljYXRlIGNoYXJhY3RlcnMgZnJvbS4NCiAqIEByZXR1cm5zIHtTdHJpbmd9IFN0cmluZyB3aXRoIGFueSBkdXBsaWNhdGUgY2hhcmFjdGVycyByZW1vdmVkLg0KICovDQoNCg0KZnVuY3Rpb24gY2xpcER1cGxpY2F0ZXMoc3RyKSB7DQogIHJldHVybiBuYXRpdi5yZXBsYWNlLmNhbGwoc3RyLCAvKFtcc1xTXSkoPz1bXHNcU10qXDEpL2csICcnKTsNCn0NCi8qKg0KICogQ29waWVzIGEgcmVnZXggb2JqZWN0IHdoaWxlIHByZXNlcnZpbmcgZXh0ZW5kZWQgZGF0YSBhbmQgYXVnbWVudGluZyB3aXRoIGBYUmVnRXhwLnByb3RvdHlwZWANCiAqIHByb3BlcnRpZXMuIFRoZSBjb3B5IGhhcyBhIGZyZXNoIGBsYXN0SW5kZXhgIHByb3BlcnR5IChzZXQgdG8gemVybykuIEFsbG93cyBhZGRpbmcgYW5kIHJlbW92aW5nDQogKiBmbGFncyBnIGFuZCB5IHdoaWxlIGNvcHlpbmcgdGhlIHJlZ2V4Lg0KICoNCiAqIEBwcml2YXRlDQogKiBAcGFyYW0ge1JlZ0V4cH0gcmVnZXggUmVnZXggdG8gY29weS4NCiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gT3B0aW9ucyBvYmplY3Qgd2l0aCBvcHRpb25hbCBwcm9wZXJ0aWVzOg0KICogICAtIGBhZGRHYCB7Qm9vbGVhbn0gQWRkIGZsYWcgZyB3aGlsZSBjb3B5aW5nIHRoZSByZWdleC4NCiAqICAgLSBgYWRkWWAge0Jvb2xlYW59IEFkZCBmbGFnIHkgd2hpbGUgY29weWluZyB0aGUgcmVnZXguDQogKiAgIC0gYHJlbW92ZUdgIHtCb29sZWFufSBSZW1vdmUgZmxhZyBnIHdoaWxlIGNvcHlpbmcgdGhlIHJlZ2V4Lg0KICogICAtIGByZW1vdmVZYCB7Qm9vbGVhbn0gUmVtb3ZlIGZsYWcgeSB3aGlsZSBjb3B5aW5nIHRoZSByZWdleC4NCiAqICAgLSBgaXNJbnRlcm5hbE9ubHlgIHtCb29sZWFufSBXaGV0aGVyIHRoZSBjb3BpZWQgcmVnZXggd2lsbCBiZSB1c2VkIG9ubHkgZm9yIGludGVybmFsDQogKiAgICAgb3BlcmF0aW9ucywgYW5kIG5ldmVyIGV4cG9zZWQgdG8gdXNlcnMuIEZvciBpbnRlcm5hbC1vbmx5IHJlZ2V4ZXMsIHdlIGNhbiBpbXByb3ZlIHBlcmYgYnkNCiAqICAgICBza2lwcGluZyBzb21lIG9wZXJhdGlvbnMgbGlrZSBhdHRhY2hpbmcgYFhSZWdFeHAucHJvdG90eXBlYCBwcm9wZXJ0aWVzLg0KICogICAtIGBzb3VyY2VgIHtTdHJpbmd9IE92ZXJyaWRlcyBgPHJlZ2V4Pi5zb3VyY2VgLCBmb3Igc3BlY2lhbCBjYXNlcy4NCiAqIEByZXR1cm5zIHtSZWdFeHB9IENvcHkgb2YgdGhlIHByb3ZpZGVkIHJlZ2V4LCBwb3NzaWJseSB3aXRoIG1vZGlmaWVkIGZsYWdzLg0KICovDQoNCg0KZnVuY3Rpb24gY29weVJlZ2V4KHJlZ2V4LCBvcHRpb25zKSB7DQogIGlmICghWFJlZ0V4cC5pc1JlZ0V4cChyZWdleCkpIHsNCiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUeXBlIFJlZ0V4cCBleHBlY3RlZCcpOw0KICB9DQoNCiAgdmFyIHhEYXRhID0gcmVnZXhbUkVHRVhfREFUQV0gfHwge307DQogIHZhciBmbGFncyA9IGdldE5hdGl2ZUZsYWdzKHJlZ2V4KTsNCiAgdmFyIGZsYWdzVG9BZGQgPSAnJzsNCiAgdmFyIGZsYWdzVG9SZW1vdmUgPSAnJzsNCiAgdmFyIHhyZWdleHBTb3VyY2UgPSBudWxsOw0KICB2YXIgeHJlZ2V4cEZsYWdzID0gbnVsbDsNCiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307DQoNCiAgaWYgKG9wdGlvbnMucmVtb3ZlRykgew0KICAgIGZsYWdzVG9SZW1vdmUgKz0gJ2cnOw0KICB9DQoNCiAgaWYgKG9wdGlvbnMucmVtb3ZlWSkgew0KICAgIGZsYWdzVG9SZW1vdmUgKz0gJ3knOw0KICB9DQoNCiAgaWYgKGZsYWdzVG9SZW1vdmUpIHsNCiAgICBmbGFncyA9IG5hdGl2LnJlcGxhY2UuY2FsbChmbGFncywgbmV3IFJlZ0V4cCgiWyIuY29uY2F0KGZsYWdzVG9SZW1vdmUsICJdKyIpLCAnZycpLCAnJyk7DQogIH0NCg0KICBpZiAob3B0aW9ucy5hZGRHKSB7DQogICAgZmxhZ3NUb0FkZCArPSAnZyc7DQogIH0NCg0KICBpZiAob3B0aW9ucy5hZGRZKSB7DQogICAgZmxhZ3NUb0FkZCArPSAneSc7DQogIH0NCg0KICBpZiAoZmxhZ3NUb0FkZCkgew0KICAgIGZsYWdzID0gY2xpcER1cGxpY2F0ZXMoZmxhZ3MgKyBmbGFnc1RvQWRkKTsNCiAgfQ0KDQogIGlmICghb3B0aW9ucy5pc0ludGVybmFsT25seSkgew0KICAgIGlmICh4RGF0YS5zb3VyY2UgIT09IHVuZGVmaW5lZCkgew0KICAgICAgeHJlZ2V4cFNvdXJjZSA9IHhEYXRhLnNvdXJjZTsNCiAgICB9IC8vIG51bGwgb3IgdW5kZWZpbmVkOyBkb24ndCB3YW50IHRvIGFkZCB0byBgZmxhZ3NgIGlmIHRoZSBwcmV2aW91cyB2YWx1ZSB3YXMgbnVsbCwgc2luY2UNCiAgICAvLyB0aGF0IGluZGljYXRlcyB3ZSdyZSBub3QgdHJhY2tpbmcgb3JpZ2luYWwgcHJlY29tcGlsYXRpb24gZmxhZ3MNCg0KDQogICAgaWYgKHhEYXRhLmZsYWdzICE9IG51bGwpIHsNCiAgICAgIC8vIEZsYWdzIGFyZSBvbmx5IGFkZGVkIGZvciBub24taW50ZXJuYWwgcmVnZXhlcyBieSBgWFJlZ0V4cC5nbG9iYWxpemVgLiBGbGFncyBhcmUgbmV2ZXINCiAgICAgIC8vIHJlbW92ZWQgZm9yIG5vbi1pbnRlcm5hbCByZWdleGVzLCBzbyBkb24ndCBuZWVkIHRvIGhhbmRsZSBpdA0KICAgICAgeHJlZ2V4cEZsYWdzID0gZmxhZ3NUb0FkZCA/IGNsaXBEdXBsaWNhdGVzKHhEYXRhLmZsYWdzICsgZmxhZ3NUb0FkZCkgOiB4RGF0YS5mbGFnczsNCiAgICB9DQogIH0gLy8gQXVnbWVudCB3aXRoIGBYUmVnRXhwLnByb3RvdHlwZWAgcHJvcGVydGllcywgYnV0IHVzZSB0aGUgbmF0aXZlIGBSZWdFeHBgIGNvbnN0cnVjdG9yIHRvIGF2b2lkDQogIC8vIHNlYXJjaGluZyBmb3Igc3BlY2lhbCB0b2tlbnMuIFRoYXQgd291bGQgYmUgd3JvbmcgZm9yIHJlZ2V4ZXMgY29uc3RydWN0ZWQgYnkgYFJlZ0V4cGAsIGFuZA0KICAvLyB1bm5lY2Vzc2FyeSBmb3IgcmVnZXhlcyBjb25zdHJ1Y3RlZCBieSBgWFJlZ0V4cGAgYmVjYXVzZSB0aGUgcmVnZXggaGFzIGFscmVhZHkgdW5kZXJnb25lIHRoZQ0KICAvLyB0cmFuc2xhdGlvbiB0byBuYXRpdmUgcmVnZXggc3ludGF4DQoNCg0KICByZWdleCA9IGF1Z21lbnQobmV3IFJlZ0V4cChvcHRpb25zLnNvdXJjZSB8fCByZWdleC5zb3VyY2UsIGZsYWdzKSwgaGFzTmFtZWRDYXB0dXJlKHJlZ2V4KSA/IHhEYXRhLmNhcHR1cmVOYW1lcy5zbGljZSgwKSA6IG51bGwsIHhyZWdleHBTb3VyY2UsIHhyZWdleHBGbGFncywgb3B0aW9ucy5pc0ludGVybmFsT25seSk7DQogIHJldHVybiByZWdleDsNCn0NCi8qKg0KICogQ29udmVydHMgaGV4YWRlY2ltYWwgdG8gZGVjaW1hbC4NCiAqDQogKiBAcHJpdmF0ZQ0KICogQHBhcmFtIHtTdHJpbmd9IGhleA0KICogQHJldHVybnMge051bWJlcn0NCiAqLw0KDQoNCmZ1bmN0aW9uIGRlYyhoZXgpIHsNCiAgcmV0dXJuIHBhcnNlSW50KGhleCwgMTYpOw0KfQ0KLyoqDQogKiBSZXR1cm5zIGEgcGF0dGVybiB0aGF0IGNhbiBiZSB1c2VkIGluIGEgbmF0aXZlIFJlZ0V4cCBpbiBwbGFjZSBvZiBhbiBpZ25vcmFibGUgdG9rZW4gc3VjaCBhcyBhbg0KICogaW5saW5lIGNvbW1lbnQgb3Igd2hpdGVzcGFjZSB3aXRoIGZsYWcgeC4gVGhpcyBpcyB1c2VkIGRpcmVjdGx5IGFzIGEgdG9rZW4gaGFuZGxlciBmdW5jdGlvbg0KICogcGFzc2VkIHRvIGBYUmVnRXhwLmFkZFRva2VuYC4NCiAqDQogKiBAcHJpdmF0ZQ0KICogQHBhcmFtIHtTdHJpbmd9IG1hdGNoIE1hdGNoIGFyZyBvZiBgWFJlZ0V4cC5hZGRUb2tlbmAgaGFuZGxlcg0KICogQHBhcmFtIHtTdHJpbmd9IHNjb3BlIFNjb3BlIGFyZyBvZiBgWFJlZ0V4cC5hZGRUb2tlbmAgaGFuZGxlcg0KICogQHBhcmFtIHtTdHJpbmd9IGZsYWdzIEZsYWdzIGFyZyBvZiBgWFJlZ0V4cC5hZGRUb2tlbmAgaGFuZGxlcg0KICogQHJldHVybnMge1N0cmluZ30gRWl0aGVyICcnIG9yICcoPzopJywgZGVwZW5kaW5nIG9uIHdoaWNoIGlzIG5lZWRlZCBpbiB0aGUgY29udGV4dCBvZiB0aGUgbWF0Y2guDQogKi8NCg0KDQpmdW5jdGlvbiBnZXRDb250ZXh0dWFsVG9rZW5TZXBhcmF0b3IobWF0Y2gsIHNjb3BlLCBmbGFncykgew0KICBpZiAoIC8vIE5vIG5lZWQgdG8gc2VwYXJhdGUgdG9rZW5zIGlmIGF0IHRoZSBiZWdpbm5pbmcgb3IgZW5kIG9mIGEgZ3JvdXANCiAgbWF0Y2guaW5wdXRbbWF0Y2guaW5kZXggLSAxXSA9PT0gJygnIHx8IG1hdGNoLmlucHV0W21hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoXSA9PT0gJyknIHx8IC8vIE5vIG5lZWQgdG8gc2VwYXJhdGUgdG9rZW5zIGlmIGJlZm9yZSBvciBhZnRlciBhIGB8YA0KICBtYXRjaC5pbnB1dFttYXRjaC5pbmRleCAtIDFdID09PSAnfCcgfHwgbWF0Y2guaW5wdXRbbWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGhdID09PSAnfCcgfHwgLy8gTm8gbmVlZCB0byBzZXBhcmF0ZSB0b2tlbnMgaWYgYXQgdGhlIGJlZ2lubmluZyBvciBlbmQgb2YgdGhlIHBhdHRlcm4NCiAgbWF0Y2guaW5kZXggPCAxIHx8IG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoID49IG1hdGNoLmlucHV0Lmxlbmd0aCB8fCAvLyBObyBuZWVkIHRvIHNlcGFyYXRlIHRva2VucyBpZiBhdCB0aGUgYmVnaW5uaW5nIG9mIGEgbm9uY2FwdHVyaW5nIGdyb3VwIG9yIGxvb2thaGVhZC4NCiAgLy8gVGhlIHdheSB0aGlzIGlzIHdyaXR0ZW4gcmVsaWVzIG9uOg0KICAvLyAtIFRoZSBzZWFyY2ggcmVnZXggbWF0Y2hpbmcgb25seSAzLWNoYXIgc3RyaW5ncy4NCiAgLy8gLSBBbHRob3VnaCBgc3Vic3RyYCBnaXZlcyBjaGFycyBmcm9tIHRoZSBlbmQgb2YgdGhlIHN0cmluZyBpZiBnaXZlbiBhIG5lZ2F0aXZlIGluZGV4LA0KICAvLyAgIHRoZSByZXN1bHRpbmcgc3Vic3RyaW5nIHdpbGwgYmUgdG9vIHNob3J0IHRvIG1hdGNoLiBFeDogYCdhYmNkJy5zdWJzdHIoLTEsIDMpID09PSAnZCdgDQogIG5hdGl2LnRlc3QuY2FsbCgvXlwoXD9bOj0hXS8sIG1hdGNoLmlucHV0LnN1YnN0cihtYXRjaC5pbmRleCAtIDMsIDMpKSB8fCAvLyBBdm9pZCBzZXBhcmF0aW5nIHRva2VucyB3aGVuIHRoZSBmb2xsb3dpbmcgdG9rZW4gaXMgYSBxdWFudGlmaWVyDQogIGlzUXVhbnRpZmllck5leHQobWF0Y2guaW5wdXQsIG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoLCBmbGFncykpIHsNCiAgICByZXR1cm4gJyc7DQogIH0gLy8gS2VlcCB0b2tlbnMgc2VwYXJhdGVkLiBUaGlzIGF2b2lkcyBlLmcuIGluYWR2ZXJ0ZWRseSBjaGFuZ2luZyBgXDEgMWAgb3IgYFwxKD8jKTFgIHRvIGBcMTFgLg0KICAvLyBUaGlzIGFsc28gZW5zdXJlcyBhbGwgdG9rZW5zIHJlbWFpbiBhcyBkaXNjcmV0ZSBhdG9tcywgZS5nLiBpdCBhdm9pZHMgY29udmVydGluZyB0aGUgc3ludGF4DQogIC8vIGVycm9yIGAoPyA6YCBpbnRvIGAoPzpgLg0KDQoNCiAgcmV0dXJuICcoPzopJzsNCn0NCi8qKg0KICogUmV0dXJucyBuYXRpdmUgYFJlZ0V4cGAgZmxhZ3MgdXNlZCBieSBhIHJlZ2V4IG9iamVjdC4NCiAqDQogKiBAcHJpdmF0ZQ0KICogQHBhcmFtIHtSZWdFeHB9IHJlZ2V4IFJlZ2V4IHRvIGNoZWNrLg0KICogQHJldHVybnMge1N0cmluZ30gTmF0aXZlIGZsYWdzIGluIHVzZS4NCiAqLw0KDQoNCmZ1bmN0aW9uIGdldE5hdGl2ZUZsYWdzKHJlZ2V4KSB7DQogIHJldHVybiBoYXNGbGFnc1Byb3AgPyByZWdleC5mbGFncyA6IC8vIEV4cGxpY2l0bHkgdXNpbmcgYFJlZ0V4cC5wcm90b3R5cGUudG9TdHJpbmdgIChyYXRoZXIgdGhhbiBlLmcuIGBTdHJpbmdgIG9yIGNvbmNhdGVuYXRpb24NCiAgLy8gd2l0aCBhbiBlbXB0eSBzdHJpbmcpIGFsbG93cyB0aGlzIHRvIGNvbnRpbnVlIHdvcmtpbmcgcHJlZGljdGFibHkgd2hlbg0KICAvLyBgWFJlZ0V4cC5wcm9wdG90eXBlLnRvU3RyaW5nYCBpcyBvdmVycmlkZGVuDQogIG5hdGl2LmV4ZWMuY2FsbCgvXC8oW2Etel0qKSQvaSwgUmVnRXhwLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHJlZ2V4KSlbMV07DQp9DQovKioNCiAqIERldGVybWluZXMgd2hldGhlciBhIHJlZ2V4IGhhcyBleHRlbmRlZCBpbnN0YW5jZSBkYXRhIHVzZWQgdG8gdHJhY2sgY2FwdHVyZSBuYW1lcy4NCiAqDQogKiBAcHJpdmF0ZQ0KICogQHBhcmFtIHtSZWdFeHB9IHJlZ2V4IFJlZ2V4IHRvIGNoZWNrLg0KICogQHJldHVybnMge0Jvb2xlYW59IFdoZXRoZXIgdGhlIHJlZ2V4IHVzZXMgbmFtZWQgY2FwdHVyZS4NCiAqLw0KDQoNCmZ1bmN0aW9uIGhhc05hbWVkQ2FwdHVyZShyZWdleCkgew0KICByZXR1cm4gISEocmVnZXhbUkVHRVhfREFUQV0gJiYgcmVnZXhbUkVHRVhfREFUQV0uY2FwdHVyZU5hbWVzKTsNCn0NCi8qKg0KICogQ29udmVydHMgZGVjaW1hbCB0byBoZXhhZGVjaW1hbC4NCiAqDQogKiBAcHJpdmF0ZQ0KICogQHBhcmFtIHtOdW1iZXJ8U3RyaW5nfSBkZWMNCiAqIEByZXR1cm5zIHtTdHJpbmd9DQogKi8NCg0KDQpmdW5jdGlvbiBoZXgoZGVjKSB7DQogIHJldHVybiBwYXJzZUludChkZWMsIDEwKS50b1N0cmluZygxNik7DQp9DQovKioNCiAqIENoZWNrcyB3aGV0aGVyIHRoZSBuZXh0IG5vbmlnbm9yYWJsZSB0b2tlbiBhZnRlciB0aGUgc3BlY2lmaWVkIHBvc2l0aW9uIGlzIGEgcXVhbnRpZmllci4NCiAqDQogKiBAcHJpdmF0ZQ0KICogQHBhcmFtIHtTdHJpbmd9IHBhdHRlcm4gUGF0dGVybiB0byBzZWFyY2ggd2l0aGluLg0KICogQHBhcmFtIHtOdW1iZXJ9IHBvcyBJbmRleCBpbiBgcGF0dGVybmAgdG8gc2VhcmNoIGF0Lg0KICogQHBhcmFtIHtTdHJpbmd9IGZsYWdzIEZsYWdzIHVzZWQgYnkgdGhlIHBhdHRlcm4uDQogKiBAcmV0dXJucyB7Qm9vbGVhbn0gV2hldGhlciB0aGUgbmV4dCBub25pZ25vcmFibGUgdG9rZW4gaXMgYSBxdWFudGlmaWVyLg0KICovDQoNCg0KZnVuY3Rpb24gaXNRdWFudGlmaWVyTmV4dChwYXR0ZXJuLCBwb3MsIGZsYWdzKSB7DQogIHZhciBpbmxpbmVDb21tZW50UGF0dGVybiA9ICdcXChcXD8jW14pXSpcXCknOw0KICB2YXIgbGluZUNvbW1lbnRQYXR0ZXJuID0gJyNbXiNcXG5dKic7DQogIHZhciBxdWFudGlmaWVyUGF0dGVybiA9ICdbPyorXXx7XFxkKyg/OixcXGQqKT99JzsNCiAgcmV0dXJuIG5hdGl2LnRlc3QuY2FsbChmbGFncy5pbmRleE9mKCd4JykgIT09IC0xID8gLy8gSWdub3JlIGFueSBsZWFkaW5nIHdoaXRlc3BhY2UsIGxpbmUgY29tbWVudHMsIGFuZCBpbmxpbmUgY29tbWVudHMNCiAgL14oPzpcc3wjW14jXG5dKnxcKFw/I1teKV0qXCkpKig/Ols/KitdfHtcZCsoPzosXGQqKT99KS8gOiAvLyBJZ25vcmUgYW55IGxlYWRpbmcgaW5saW5lIGNvbW1lbnRzDQogIC9eKD86XChcPyNbXildKlwpKSooPzpbPyorXXx7XGQrKD86LFxkKik/fSkvLCBwYXR0ZXJuLnNsaWNlKHBvcykpOw0KfQ0KLyoqDQogKiBEZXRlcm1pbmVzIHdoZXRoZXIgYSB2YWx1ZSBpcyBvZiB0aGUgc3BlY2lmaWVkIHR5cGUsIGJ5IHJlc29sdmluZyBpdHMgaW50ZXJuYWwgW1tDbGFzc11dLg0KICoNCiAqIEBwcml2YXRlDQogKiBAcGFyYW0geyp9IHZhbHVlIE9iamVjdCB0byBjaGVjay4NCiAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIFR5cGUgdG8gY2hlY2sgZm9yLCBpbiBUaXRsZUNhc2UuDQogKiBAcmV0dXJucyB7Qm9vbGVhbn0gV2hldGhlciB0aGUgb2JqZWN0IG1hdGNoZXMgdGhlIHR5cGUuDQogKi8NCg0KDQpmdW5jdGlvbiBpc1R5cGUodmFsdWUsIHR5cGUpIHsNCiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsdWUpID09PSAiW29iamVjdCAiLmNvbmNhdCh0eXBlLCAiXSIpOw0KfQ0KLyoqDQogKiBBZGRzIGxlYWRpbmcgemVyb3MgaWYgc2hvcnRlciB0aGFuIGZvdXIgY2hhcmFjdGVycy4gVXNlZCBmb3IgZml4ZWQtbGVuZ3RoIGhleGFkZWNpbWFsIHZhbHVlcy4NCiAqDQogKiBAcHJpdmF0ZQ0KICogQHBhcmFtIHtTdHJpbmd9IHN0cg0KICogQHJldHVybnMge1N0cmluZ30NCiAqLw0KDQoNCmZ1bmN0aW9uIHBhZDQoc3RyKSB7DQogIHdoaWxlIChzdHIubGVuZ3RoIDwgNCkgew0KICAgIHN0ciA9ICIwIi5jb25jYXQoc3RyKTsNCiAgfQ0KDQogIHJldHVybiBzdHI7DQp9DQovKioNCiAqIENoZWNrcyBmb3IgZmxhZy1yZWxhdGVkIGVycm9ycywgYW5kIHN0cmlwcy9hcHBsaWVzIGZsYWdzIGluIGEgbGVhZGluZyBtb2RlIG1vZGlmaWVyLiBPZmZsb2Fkcw0KICogdGhlIGZsYWcgcHJlcGFyYXRpb24gbG9naWMgZnJvbSB0aGUgYFhSZWdFeHBgIGNvbnN0cnVjdG9yLg0KICoNCiAqIEBwcml2YXRlDQogKiBAcGFyYW0ge1N0cmluZ30gcGF0dGVybiBSZWdleCBwYXR0ZXJuLCBwb3NzaWJseSB3aXRoIGEgbGVhZGluZyBtb2RlIG1vZGlmaWVyLg0KICogQHBhcmFtIHtTdHJpbmd9IGZsYWdzIEFueSBjb21iaW5hdGlvbiBvZiBmbGFncy4NCiAqIEByZXR1cm5zIHtPYmplY3R9IE9iamVjdCB3aXRoIHByb3BlcnRpZXMgYHBhdHRlcm5gIGFuZCBgZmxhZ3NgLg0KICovDQoNCg0KZnVuY3Rpb24gcHJlcGFyZUZsYWdzKHBhdHRlcm4sIGZsYWdzKSB7DQogIC8vIFJlY2VudCBicm93c2VycyB0aHJvdyBvbiBkdXBsaWNhdGUgZmxhZ3MsIHNvIGNvcHkgdGhpcyBiZWhhdmlvciBmb3Igbm9ubmF0aXZlIGZsYWdzDQogIGlmIChjbGlwRHVwbGljYXRlcyhmbGFncykgIT09IGZsYWdzKSB7DQogICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCJJbnZhbGlkIGR1cGxpY2F0ZSByZWdleCBmbGFnICIuY29uY2F0KGZsYWdzKSk7DQogIH0gLy8gU3RyaXAgYW5kIGFwcGx5IGEgbGVhZGluZyBtb2RlIG1vZGlmaWVyIHdpdGggYW55IGNvbWJpbmF0aW9uIG9mIGZsYWdzIGV4Y2VwdCBnIG9yIHkNCg0KDQogIHBhdHRlcm4gPSBuYXRpdi5yZXBsYWNlLmNhbGwocGF0dGVybiwgL15cKFw/KFtcdyRdKylcKS8sIGZ1bmN0aW9uICgkMCwgJDEpIHsNCiAgICBpZiAobmF0aXYudGVzdC5jYWxsKC9bZ3ldLywgJDEpKSB7DQogICAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoIkNhbm5vdCB1c2UgZmxhZyBnIG9yIHkgaW4gbW9kZSBtb2RpZmllciAiLmNvbmNhdCgkMCkpOw0KICAgIH0gLy8gQWxsb3cgZHVwbGljYXRlIGZsYWdzIHdpdGhpbiB0aGUgbW9kZSBtb2RpZmllcg0KDQoNCiAgICBmbGFncyA9IGNsaXBEdXBsaWNhdGVzKGZsYWdzICsgJDEpOw0KICAgIHJldHVybiAnJzsNCiAgfSk7IC8vIFRocm93IG9uIHVua25vd24gbmF0aXZlIG9yIG5vbm5hdGl2ZSBmbGFncw0KDQogIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTsNCiAgdmFyIF9kaWRJdGVyYXRvckVycm9yID0gZmFsc2U7DQogIHZhciBfaXRlcmF0b3JFcnJvciA9IHVuZGVmaW5lZDsNCg0KICB0cnkgew0KICAgIGZvciAodmFyIF9pdGVyYXRvciA9IGZsYWdzW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IChfc3RlcCA9IF9pdGVyYXRvci5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZSkgew0KICAgICAgdmFyIGZsYWcgPSBfc3RlcC52YWx1ZTsNCg0KICAgICAgaWYgKCFyZWdpc3RlcmVkRmxhZ3NbZmxhZ10pIHsNCiAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCJVbmtub3duIHJlZ2V4IGZsYWcgIi5jb25jYXQoZmxhZykpOw0KICAgICAgfQ0KICAgIH0NCiAgfSBjYXRjaCAoZXJyKSB7DQogICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlOw0KICAgIF9pdGVyYXRvckVycm9yID0gZXJyOw0KICB9IGZpbmFsbHkgew0KICAgIHRyeSB7DQogICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gJiYgX2l0ZXJhdG9yLnJldHVybiAhPSBudWxsKSB7DQogICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTsNCiAgICAgIH0NCiAgICB9IGZpbmFsbHkgew0KICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yKSB7DQogICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yOw0KICAgICAgfQ0KICAgIH0NCiAgfQ0KDQogIHJldHVybiB7DQogICAgcGF0dGVybjogcGF0dGVybiwNCiAgICBmbGFnczogZmxhZ3MNCiAgfTsNCn0NCi8qKg0KICogUHJlcGFyZXMgYW4gb3B0aW9ucyBvYmplY3QgZnJvbSB0aGUgZ2l2ZW4gdmFsdWUuDQogKg0KICogQHByaXZhdGUNCiAqIEBwYXJhbSB7U3RyaW5nfE9iamVjdH0gdmFsdWUgVmFsdWUgdG8gY29udmVydCB0byBhbiBvcHRpb25zIG9iamVjdC4NCiAqIEByZXR1cm5zIHtPYmplY3R9IE9wdGlvbnMgb2JqZWN0Lg0KICovDQoNCg0KZnVuY3Rpb24gcHJlcGFyZU9wdGlvbnModmFsdWUpIHsNCiAgdmFyIG9wdGlvbnMgPSB7fTsNCg0KICBpZiAoaXNUeXBlKHZhbHVlLCAnU3RyaW5nJykpIHsNCiAgICBYUmVnRXhwLmZvckVhY2godmFsdWUsIC9bXlxzLF0rLywgZnVuY3Rpb24gKG1hdGNoKSB7DQogICAgICBvcHRpb25zW21hdGNoXSA9IHRydWU7DQogICAgfSk7DQogICAgcmV0dXJuIG9wdGlvbnM7DQogIH0NCg0KICByZXR1cm4gdmFsdWU7DQp9DQovKioNCiAqIFJlZ2lzdGVycyBhIGZsYWcgc28gaXQgZG9lc24ndCB0aHJvdyBhbiAndW5rbm93biBmbGFnJyBlcnJvci4NCiAqDQogKiBAcHJpdmF0ZQ0KICogQHBhcmFtIHtTdHJpbmd9IGZsYWcgU2luZ2xlLWNoYXJhY3RlciBmbGFnIHRvIHJlZ2lzdGVyLg0KICovDQoNCg0KZnVuY3Rpb24gcmVnaXN0ZXJGbGFnKGZsYWcpIHsNCiAgaWYgKCEvXltcdyRdJC8udGVzdChmbGFnKSkgew0KICAgIHRocm93IG5ldyBFcnJvcignRmxhZyBtdXN0IGJlIGEgc2luZ2xlIGNoYXJhY3RlciBBLVphLXowLTlfJCcpOw0KICB9DQoNCiAgcmVnaXN0ZXJlZEZsYWdzW2ZsYWddID0gdHJ1ZTsNCn0NCi8qKg0KICogUnVucyBidWlsdC1pbiBhbmQgY3VzdG9tIHJlZ2V4IHN5bnRheCB0b2tlbnMgaW4gcmV2ZXJzZSBpbnNlcnRpb24gb3JkZXIgYXQgdGhlIHNwZWNpZmllZA0KICogcG9zaXRpb24sIHVudGlsIGEgbWF0Y2ggaXMgZm91bmQuDQogKg0KICogQHByaXZhdGUNCiAqIEBwYXJhbSB7U3RyaW5nfSBwYXR0ZXJuIE9yaWdpbmFsIHBhdHRlcm4gZnJvbSB3aGljaCBhbiBYUmVnRXhwIG9iamVjdCBpcyBiZWluZyBidWlsdC4NCiAqIEBwYXJhbSB7U3RyaW5nfSBmbGFncyBGbGFncyBiZWluZyB1c2VkIHRvIGNvbnN0cnVjdCB0aGUgcmVnZXguDQogKiBAcGFyYW0ge051bWJlcn0gcG9zIFBvc2l0aW9uIHRvIHNlYXJjaCBmb3IgdG9rZW5zIHdpdGhpbiBgcGF0dGVybmAuDQogKiBAcGFyYW0ge051bWJlcn0gc2NvcGUgUmVnZXggc2NvcGUgdG8gYXBwbHk6ICdkZWZhdWx0JyBvciAnY2xhc3MnLg0KICogQHBhcmFtIHtPYmplY3R9IGNvbnRleHQgQ29udGV4dCBvYmplY3QgdG8gdXNlIGZvciB0b2tlbiBoYW5kbGVyIGZ1bmN0aW9ucy4NCiAqIEByZXR1cm5zIHtPYmplY3R9IE9iamVjdCB3aXRoIHByb3BlcnRpZXMgYG1hdGNoTGVuZ3RoYCwgYG91dHB1dGAsIGFuZCBgcmVwYXJzZWA7IG9yIGBudWxsYC4NCiAqLw0KDQoNCmZ1bmN0aW9uIHJ1blRva2VucyhwYXR0ZXJuLCBmbGFncywgcG9zLCBzY29wZSwgY29udGV4dCkgew0KICB2YXIgaSA9IHRva2Vucy5sZW5ndGg7DQogIHZhciBsZWFkQ2hhciA9IHBhdHRlcm5bcG9zXTsNCiAgdmFyIHJlc3VsdCA9IG51bGw7DQogIHZhciBtYXRjaDsNCiAgdmFyIHQ7IC8vIFJ1biBpbiByZXZlcnNlIGluc2VydGlvbiBvcmRlcg0KDQogIHdoaWxlIChpLS0pIHsNCiAgICB0ID0gdG9rZW5zW2ldOw0KDQogICAgaWYgKHQubGVhZENoYXIgJiYgdC5sZWFkQ2hhciAhPT0gbGVhZENoYXIgfHwgdC5zY29wZSAhPT0gc2NvcGUgJiYgdC5zY29wZSAhPT0gJ2FsbCcgfHwgdC5mbGFnICYmICEoZmxhZ3MuaW5kZXhPZih0LmZsYWcpICE9PSAtMSkpIHsNCiAgICAgIGNvbnRpbnVlOw0KICAgIH0NCg0KICAgIG1hdGNoID0gWFJlZ0V4cC5leGVjKHBhdHRlcm4sIHQucmVnZXgsIHBvcywgJ3N0aWNreScpOw0KDQogICAgaWYgKG1hdGNoKSB7DQogICAgICByZXN1bHQgPSB7DQogICAgICAgIG1hdGNoTGVuZ3RoOiBtYXRjaFswXS5sZW5ndGgsDQogICAgICAgIG91dHB1dDogdC5oYW5kbGVyLmNhbGwoY29udGV4dCwgbWF0Y2gsIHNjb3BlLCBmbGFncyksDQogICAgICAgIHJlcGFyc2U6IHQucmVwYXJzZQ0KICAgICAgfTsgLy8gRmluaXNoZWQgd2l0aCB0b2tlbiB0ZXN0cw0KDQogICAgICBicmVhazsNCiAgICB9DQogIH0NCg0KICByZXR1cm4gcmVzdWx0Ow0KfQ0KLyoqDQogKiBFbmFibGVzIG9yIGRpc2FibGVzIGltcGxpY2l0IGFzdHJhbCBtb2RlIG9wdC1pbi4gV2hlbiBlbmFibGVkLCBmbGFnIEEgaXMgYXV0b21hdGljYWxseSBhZGRlZCB0bw0KICogYWxsIG5ldyByZWdleGVzIGNyZWF0ZWQgYnkgWFJlZ0V4cC4gVGhpcyBjYXVzZXMgYW4gZXJyb3IgdG8gYmUgdGhyb3duIHdoZW4gY3JlYXRpbmcgcmVnZXhlcyBpZg0KICogdGhlIFVuaWNvZGUgQmFzZSBhZGRvbiBpcyBub3QgYXZhaWxhYmxlLCBzaW5jZSBmbGFnIEEgaXMgcmVnaXN0ZXJlZCBieSB0aGF0IGFkZG9uLg0KICoNCiAqIEBwcml2YXRlDQogKiBAcGFyYW0ge0Jvb2xlYW59IG9uIGB0cnVlYCB0byBlbmFibGU7IGBmYWxzZWAgdG8gZGlzYWJsZS4NCiAqLw0KDQoNCmZ1bmN0aW9uIHNldEFzdHJhbChvbikgew0KICBmZWF0dXJlcy5hc3RyYWwgPSBvbjsNCn0NCi8qKg0KICogQWRkcyBuYW1lZCBjYXB0dXJlIGdyb3VwcyB0byB0aGUgYGdyb3Vwc2AgcHJvcGVydHkgb2YgbWF0Y2ggYXJyYXlzLiBTZWUgaGVyZSBmb3IgZGV0YWlsczoNCiAqIGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L3Byb3Bvc2FsLXJlZ2V4cC1uYW1lZC1ncm91cHMNCiAqDQogKiBAcHJpdmF0ZQ0KICogQHBhcmFtIHtCb29sZWFufSBvbiBgdHJ1ZWAgdG8gZW5hYmxlOyBgZmFsc2VgIHRvIGRpc2FibGUuDQogKi8NCg0KDQpmdW5jdGlvbiBzZXROYW1lc3BhY2luZyhvbikgew0KICBmZWF0dXJlcy5uYW1lc3BhY2luZyA9IG9uOw0KfQ0KLyoqDQogKiBSZXR1cm5zIHRoZSBvYmplY3QsIG9yIHRocm93cyBhbiBlcnJvciBpZiBpdCBpcyBgbnVsbGAgb3IgYHVuZGVmaW5lZGAuIFRoaXMgaXMgdXNlZCB0byBmb2xsb3cNCiAqIHRoZSBFUzUgYWJzdHJhY3Qgb3BlcmF0aW9uIGBUb09iamVjdGAuDQogKg0KICogQHByaXZhdGUNCiAqIEBwYXJhbSB7Kn0gdmFsdWUgT2JqZWN0IHRvIGNoZWNrIGFuZCByZXR1cm4uDQogKiBAcmV0dXJucyB7Kn0gVGhlIHByb3ZpZGVkIG9iamVjdC4NCiAqLw0KDQoNCmZ1bmN0aW9uIHRvT2JqZWN0KHZhbHVlKSB7DQogIC8vIG51bGwgb3IgdW5kZWZpbmVkDQogIGlmICh2YWx1ZSA9PSBudWxsKSB7DQogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnZlcnQgbnVsbCBvciB1bmRlZmluZWQgdG8gb2JqZWN0Jyk7DQogIH0NCg0KICByZXR1cm4gdmFsdWU7DQp9IC8vID09LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS09PQ0KLy8gQ29uc3RydWN0b3INCi8vID09LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS09PQ0KDQovKioNCiAqIENyZWF0ZXMgYW4gZXh0ZW5kZWQgcmVndWxhciBleHByZXNzaW9uIG9iamVjdCBmb3IgbWF0Y2hpbmcgdGV4dCB3aXRoIGEgcGF0dGVybi4gRGlmZmVycyBmcm9tIGENCiAqIG5hdGl2ZSByZWd1bGFyIGV4cHJlc3Npb24gaW4gdGhhdCBhZGRpdGlvbmFsIHN5bnRheCBhbmQgZmxhZ3MgYXJlIHN1cHBvcnRlZC4gVGhlIHJldHVybmVkIG9iamVjdA0KICogaXMgaW4gZmFjdCBhIG5hdGl2ZSBgUmVnRXhwYCBhbmQgd29ya3Mgd2l0aCBhbGwgbmF0aXZlIG1ldGhvZHMuDQogKg0KICogQGNsYXNzIFhSZWdFeHANCiAqIEBjb25zdHJ1Y3Rvcg0KICogQHBhcmFtIHtTdHJpbmd8UmVnRXhwfSBwYXR0ZXJuIFJlZ2V4IHBhdHRlcm4gc3RyaW5nLCBvciBhbiBleGlzdGluZyByZWdleCBvYmplY3QgdG8gY29weS4NCiAqIEBwYXJhbSB7U3RyaW5nfSBbZmxhZ3NdIEFueSBjb21iaW5hdGlvbiBvZiBmbGFncy4NCiAqICAgTmF0aXZlIGZsYWdzOg0KICogICAgIC0gYGdgIC0gZ2xvYmFsDQogKiAgICAgLSBgaWAgLSBpZ25vcmUgY2FzZQ0KICogICAgIC0gYG1gIC0gbXVsdGlsaW5lIGFuY2hvcnMNCiAqICAgICAtIGB1YCAtIHVuaWNvZGUgKEVTNikNCiAqICAgICAtIGB5YCAtIHN0aWNreSAoRmlyZWZveCAzKywgRVM2KQ0KICogICBBZGRpdGlvbmFsIFhSZWdFeHAgZmxhZ3M6DQogKiAgICAgLSBgbmAgLSBleHBsaWNpdCBjYXB0dXJlDQogKiAgICAgLSBgc2AgLSBkb3QgbWF0Y2hlcyBhbGwgKGFrYSBzaW5nbGVsaW5lKQ0KICogICAgIC0gYHhgIC0gZnJlZS1zcGFjaW5nIGFuZCBsaW5lIGNvbW1lbnRzIChha2EgZXh0ZW5kZWQpDQogKiAgICAgLSBgQWAgLSBhc3RyYWwgKHJlcXVpcmVzIHRoZSBVbmljb2RlIEJhc2UgYWRkb24pDQogKiAgIEZsYWdzIGNhbm5vdCBiZSBwcm92aWRlZCB3aGVuIGNvbnN0cnVjdGluZyBvbmUgYFJlZ0V4cGAgZnJvbSBhbm90aGVyLg0KICogQHJldHVybnMge1JlZ0V4cH0gRXh0ZW5kZWQgcmVndWxhciBleHByZXNzaW9uIG9iamVjdC4NCiAqIEBleGFtcGxlDQogKg0KICogLy8gV2l0aCBuYW1lZCBjYXB0dXJlIGFuZCBmbGFnIHgNCiAqIFhSZWdFeHAoYCg/PHllYXI+ICBbMC05XXs0fSApIC0/ICAjIHllYXINCiAqICAgICAgICAgICg/PG1vbnRoPiBbMC05XXsyfSApIC0/ICAjIG1vbnRoDQogKiAgICAgICAgICAoPzxkYXk+ICAgWzAtOV17Mn0gKSAgICAgIyBkYXlgLCAneCcpOw0KICoNCiAqIC8vIFByb3ZpZGluZyBhIHJlZ2V4IG9iamVjdCBjb3BpZXMgaXQuIE5hdGl2ZSByZWdleGVzIGFyZSByZWNvbXBpbGVkIHVzaW5nIG5hdGl2ZSAobm90IFhSZWdFeHApDQogKiAvLyBzeW50YXguIENvcGllcyBtYWludGFpbiBleHRlbmRlZCBkYXRhLCBhcmUgYXVnbWVudGVkIHdpdGggYFhSZWdFeHAucHJvdG90eXBlYCBwcm9wZXJ0aWVzLCBhbmQNCiAqIC8vIGhhdmUgZnJlc2ggYGxhc3RJbmRleGAgcHJvcGVydGllcyAoc2V0IHRvIHplcm8pLg0KICogWFJlZ0V4cCgvcmVnZXgvKTsNCiAqLw0KDQoNCmZ1bmN0aW9uIFhSZWdFeHAocGF0dGVybiwgZmxhZ3MpIHsNCiAgaWYgKFhSZWdFeHAuaXNSZWdFeHAocGF0dGVybikpIHsNCiAgICBpZiAoZmxhZ3MgIT09IHVuZGVmaW5lZCkgew0KICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IHN1cHBseSBmbGFncyB3aGVuIGNvcHlpbmcgYSBSZWdFeHAnKTsNCiAgICB9DQoNCiAgICByZXR1cm4gY29weVJlZ2V4KHBhdHRlcm4pOw0KICB9IC8vIENvcHkgdGhlIGFyZ3VtZW50IGJlaGF2aW9yIG9mIGBSZWdFeHBgDQoNCg0KICBwYXR0ZXJuID0gcGF0dGVybiA9PT0gdW5kZWZpbmVkID8gJycgOiBTdHJpbmcocGF0dGVybik7DQogIGZsYWdzID0gZmxhZ3MgPT09IHVuZGVmaW5lZCA/ICcnIDogU3RyaW5nKGZsYWdzKTsNCg0KICBpZiAoWFJlZ0V4cC5pc0luc3RhbGxlZCgnYXN0cmFsJykgJiYgIShmbGFncy5pbmRleE9mKCdBJykgIT09IC0xKSkgew0KICAgIC8vIFRoaXMgY2F1c2VzIGFuIGVycm9yIHRvIGJlIHRocm93biBpZiB0aGUgVW5pY29kZSBCYXNlIGFkZG9uIGlzIG5vdCBhdmFpbGFibGUNCiAgICBmbGFncyArPSAnQSc7DQogIH0NCg0KICBpZiAoIXBhdHRlcm5DYWNoZVtwYXR0ZXJuXSkgew0KICAgIHBhdHRlcm5DYWNoZVtwYXR0ZXJuXSA9IHt9Ow0KICB9DQoNCiAgaWYgKCFwYXR0ZXJuQ2FjaGVbcGF0dGVybl1bZmxhZ3NdKSB7DQogICAgdmFyIGNvbnRleHQgPSB7DQogICAgICBoYXNOYW1lZENhcHR1cmU6IGZhbHNlLA0KICAgICAgY2FwdHVyZU5hbWVzOiBbXQ0KICAgIH07DQogICAgdmFyIHNjb3BlID0gZGVmYXVsdFNjb3BlOw0KICAgIHZhciBvdXRwdXQgPSAnJzsNCiAgICB2YXIgcG9zID0gMDsNCiAgICB2YXIgcmVzdWx0OyAvLyBDaGVjayBmb3IgZmxhZy1yZWxhdGVkIGVycm9ycywgYW5kIHN0cmlwL2FwcGx5IGZsYWdzIGluIGEgbGVhZGluZyBtb2RlIG1vZGlmaWVyDQoNCiAgICB2YXIgYXBwbGllZCA9IHByZXBhcmVGbGFncyhwYXR0ZXJuLCBmbGFncyk7DQogICAgdmFyIGFwcGxpZWRQYXR0ZXJuID0gYXBwbGllZC5wYXR0ZXJuOw0KICAgIHZhciBhcHBsaWVkRmxhZ3MgPSBhcHBsaWVkLmZsYWdzOyAvLyBVc2UgWFJlZ0V4cCdzIHRva2VucyB0byB0cmFuc2xhdGUgdGhlIHBhdHRlcm4gdG8gYSBuYXRpdmUgcmVnZXggcGF0dGVybi4NCiAgICAvLyBgYXBwbGllZFBhdHRlcm4ubGVuZ3RoYCBtYXkgY2hhbmdlIG9uIGVhY2ggaXRlcmF0aW9uIGlmIHRva2VucyB1c2UgYHJlcGFyc2VgDQoNCiAgICB3aGlsZSAocG9zIDwgYXBwbGllZFBhdHRlcm4ubGVuZ3RoKSB7DQogICAgICBkbyB7DQogICAgICAgIC8vIENoZWNrIGZvciBjdXN0b20gdG9rZW5zIGF0IHRoZSBjdXJyZW50IHBvc2l0aW9uDQogICAgICAgIHJlc3VsdCA9IHJ1blRva2VucyhhcHBsaWVkUGF0dGVybiwgYXBwbGllZEZsYWdzLCBwb3MsIHNjb3BlLCBjb250ZXh0KTsgLy8gSWYgdGhlIG1hdGNoZWQgdG9rZW4gdXNlZCB0aGUgYHJlcGFyc2VgIG9wdGlvbiwgc3BsaWNlIGl0cyBvdXRwdXQgaW50byB0aGUNCiAgICAgICAgLy8gcGF0dGVybiBiZWZvcmUgcnVubmluZyB0b2tlbnMgYWdhaW4gYXQgdGhlIHNhbWUgcG9zaXRpb24NCg0KICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC5yZXBhcnNlKSB7DQogICAgICAgICAgYXBwbGllZFBhdHRlcm4gPSBhcHBsaWVkUGF0dGVybi5zbGljZSgwLCBwb3MpICsgcmVzdWx0Lm91dHB1dCArIGFwcGxpZWRQYXR0ZXJuLnNsaWNlKHBvcyArIHJlc3VsdC5tYXRjaExlbmd0aCk7DQogICAgICAgIH0NCiAgICAgIH0gd2hpbGUgKHJlc3VsdCAmJiByZXN1bHQucmVwYXJzZSk7DQoNCiAgICAgIGlmIChyZXN1bHQpIHsNCiAgICAgICAgb3V0cHV0ICs9IHJlc3VsdC5vdXRwdXQ7DQogICAgICAgIHBvcyArPSByZXN1bHQubWF0Y2hMZW5ndGggfHwgMTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIC8vIEdldCB0aGUgbmF0aXZlIHRva2VuIGF0IHRoZSBjdXJyZW50IHBvc2l0aW9uDQogICAgICAgIHZhciBfWFJlZ0V4cCRleGVjID0gWFJlZ0V4cC5leGVjKGFwcGxpZWRQYXR0ZXJuLCBuYXRpdmVUb2tlbnNbc2NvcGVdLCBwb3MsICdzdGlja3knKSwNCiAgICAgICAgICAgIF9YUmVnRXhwJGV4ZWMyID0gX3NsaWNlZFRvQXJyYXkoX1hSZWdFeHAkZXhlYywgMSksDQogICAgICAgICAgICB0b2tlbiA9IF9YUmVnRXhwJGV4ZWMyWzBdOw0KDQogICAgICAgIG91dHB1dCArPSB0b2tlbjsNCiAgICAgICAgcG9zICs9IHRva2VuLmxlbmd0aDsNCg0KICAgICAgICBpZiAodG9rZW4gPT09ICdbJyAmJiBzY29wZSA9PT0gZGVmYXVsdFNjb3BlKSB7DQogICAgICAgICAgc2NvcGUgPSBjbGFzc1Njb3BlOw0KICAgICAgICB9IGVsc2UgaWYgKHRva2VuID09PSAnXScgJiYgc2NvcGUgPT09IGNsYXNzU2NvcGUpIHsNCiAgICAgICAgICBzY29wZSA9IGRlZmF1bHRTY29wZTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCg0KICAgIHBhdHRlcm5DYWNoZVtwYXR0ZXJuXVtmbGFnc10gPSB7DQogICAgICAvLyBVc2UgYmFzaWMgY2xlYW51cCB0byBjb2xsYXBzZSByZXBlYXRlZCBlbXB0eSBncm91cHMgbGlrZSBgKD86KSg/OilgIHRvIGAoPzopYC4gRW1wdHkNCiAgICAgIC8vIGdyb3VwcyBhcmUgc29tZXRpbWVzIGluc2VydGVkIGR1cmluZyByZWdleCB0cmFuc3BpbGF0aW9uIGluIG9yZGVyIHRvIGtlZXAgdG9rZW5zDQogICAgICAvLyBzZXBhcmF0ZWQuIEhvd2V2ZXIsIG1vcmUgdGhhbiBvbmUgZW1wdHkgZ3JvdXAgaW4gYSByb3cgaXMgbmV2ZXIgbmVlZGVkLg0KICAgICAgcGF0dGVybjogbmF0aXYucmVwbGFjZS5jYWxsKG91dHB1dCwgLyg/OlwoXD86XCkpKy9nLCAnKD86KScpLA0KICAgICAgLy8gU3RyaXAgYWxsIGJ1dCBuYXRpdmUgZmxhZ3MNCiAgICAgIGZsYWdzOiBuYXRpdi5yZXBsYWNlLmNhbGwoYXBwbGllZEZsYWdzLCAvW15naW11eV0rL2csICcnKSwNCiAgICAgIC8vIGBjb250ZXh0LmNhcHR1cmVOYW1lc2AgaGFzIGFuIGl0ZW0gZm9yIGVhY2ggY2FwdHVyaW5nIGdyb3VwLCBldmVuIGlmIHVubmFtZWQNCiAgICAgIGNhcHR1cmVzOiBjb250ZXh0Lmhhc05hbWVkQ2FwdHVyZSA/IGNvbnRleHQuY2FwdHVyZU5hbWVzIDogbnVsbA0KICAgIH07DQogIH0NCg0KICB2YXIgZ2VuZXJhdGVkID0gcGF0dGVybkNhY2hlW3BhdHRlcm5dW2ZsYWdzXTsNCiAgcmV0dXJuIGF1Z21lbnQobmV3IFJlZ0V4cChnZW5lcmF0ZWQucGF0dGVybiwgZ2VuZXJhdGVkLmZsYWdzKSwgZ2VuZXJhdGVkLmNhcHR1cmVzLCBwYXR0ZXJuLCBmbGFncyk7DQp9IC8vIEFkZCBgUmVnRXhwLnByb3RvdHlwZWAgdG8gdGhlIHByb3RvdHlwZSBjaGFpbg0KDQoNClhSZWdFeHAucHJvdG90eXBlID0gLyg/OikvOyAvLyA9PS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tPT0NCi8vIFB1YmxpYyBwcm9wZXJ0aWVzDQovLyA9PS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tPT0NCg0KLyoqDQogKiBUaGUgWFJlZ0V4cCB2ZXJzaW9uIG51bWJlciBhcyBhIHN0cmluZyBjb250YWluaW5nIHRocmVlIGRvdC1zZXBhcmF0ZWQgcGFydHMuIEZvciBleGFtcGxlLA0KICogJzIuMC4wLWJldGEtMycuDQogKg0KICogQHN0YXRpYw0KICogQG1lbWJlck9mIFhSZWdFeHANCiAqIEB0eXBlIFN0cmluZw0KICovDQoNClhSZWdFeHAudmVyc2lvbiA9ICc0LjIuMCc7IC8vID09LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS09PQ0KLy8gUHVibGljIG1ldGhvZHMNCi8vID09LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS09PQ0KLy8gSW50ZW50aW9uYWxseSB1bmRvY3VtZW50ZWQ7IHVzZWQgaW4gdGVzdHMgYW5kIGFkZG9ucw0KDQpYUmVnRXhwLl9jbGlwRHVwbGljYXRlcyA9IGNsaXBEdXBsaWNhdGVzOw0KWFJlZ0V4cC5faGFzTmF0aXZlRmxhZyA9IGhhc05hdGl2ZUZsYWc7DQpYUmVnRXhwLl9kZWMgPSBkZWM7DQpYUmVnRXhwLl9oZXggPSBoZXg7DQpYUmVnRXhwLl9wYWQ0ID0gcGFkNDsNCi8qKg0KICogRXh0ZW5kcyBYUmVnRXhwIHN5bnRheCBhbmQgYWxsb3dzIGN1c3RvbSBmbGFncy4gVGhpcyBpcyB1c2VkIGludGVybmFsbHkgYW5kIGNhbiBiZSB1c2VkIHRvDQogKiBjcmVhdGUgWFJlZ0V4cCBhZGRvbnMuIElmIG1vcmUgdGhhbiBvbmUgdG9rZW4gY2FuIG1hdGNoIHRoZSBzYW1lIHN0cmluZywgdGhlIGxhc3QgYWRkZWQgd2lucy4NCiAqDQogKiBAbWVtYmVyT2YgWFJlZ0V4cA0KICogQHBhcmFtIHtSZWdFeHB9IHJlZ2V4IFJlZ2V4IG9iamVjdCB0aGF0IG1hdGNoZXMgdGhlIG5ldyB0b2tlbi4NCiAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIgRnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgbmV3IHBhdHRlcm4gc3RyaW5nICh1c2luZyBuYXRpdmUgcmVnZXggc3ludGF4KQ0KICogICB0byByZXBsYWNlIHRoZSBtYXRjaGVkIHRva2VuIHdpdGhpbiBhbGwgZnV0dXJlIFhSZWdFeHAgcmVnZXhlcy4gSGFzIGFjY2VzcyB0byBwZXJzaXN0ZW50DQogKiAgIHByb3BlcnRpZXMgb2YgdGhlIHJlZ2V4IGJlaW5nIGJ1aWx0LCB0aHJvdWdoIGB0aGlzYC4gSW52b2tlZCB3aXRoIHRocmVlIGFyZ3VtZW50czoNCiAqICAgLSBUaGUgbWF0Y2ggYXJyYXksIHdpdGggbmFtZWQgYmFja3JlZmVyZW5jZSBwcm9wZXJ0aWVzLg0KICogICAtIFRoZSByZWdleCBzY29wZSB3aGVyZSB0aGUgbWF0Y2ggd2FzIGZvdW5kOiAnZGVmYXVsdCcgb3IgJ2NsYXNzJy4NCiAqICAgLSBUaGUgZmxhZ3MgdXNlZCBieSB0aGUgcmVnZXgsIGluY2x1ZGluZyBhbnkgZmxhZ3MgaW4gYSBsZWFkaW5nIG1vZGUgbW9kaWZpZXIuDQogKiAgIFRoZSBoYW5kbGVyIGZ1bmN0aW9uIGJlY29tZXMgcGFydCBvZiB0aGUgWFJlZ0V4cCBjb25zdHJ1Y3Rpb24gcHJvY2Vzcywgc28gYmUgY2FyZWZ1bCBub3QgdG8NCiAqICAgY29uc3RydWN0IFhSZWdFeHBzIHdpdGhpbiB0aGUgZnVuY3Rpb24gb3IgeW91IHdpbGwgdHJpZ2dlciBpbmZpbml0ZSByZWN1cnNpb24uDQogKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIE9wdGlvbnMgb2JqZWN0IHdpdGggb3B0aW9uYWwgcHJvcGVydGllczoNCiAqICAgLSBgc2NvcGVgIHtTdHJpbmd9IFNjb3BlIHdoZXJlIHRoZSB0b2tlbiBhcHBsaWVzOiAnZGVmYXVsdCcsICdjbGFzcycsIG9yICdhbGwnLg0KICogICAtIGBmbGFnYCB7U3RyaW5nfSBTaW5nbGUtY2hhcmFjdGVyIGZsYWcgdGhhdCB0cmlnZ2VycyB0aGUgdG9rZW4uIFRoaXMgYWxzbyByZWdpc3RlcnMgdGhlDQogKiAgICAgZmxhZywgd2hpY2ggcHJldmVudHMgWFJlZ0V4cCBmcm9tIHRocm93aW5nIGFuICd1bmtub3duIGZsYWcnIGVycm9yIHdoZW4gdGhlIGZsYWcgaXMgdXNlZC4NCiAqICAgLSBgb3B0aW9uYWxGbGFnc2Age1N0cmluZ30gQW55IGN1c3RvbSBmbGFncyBjaGVja2VkIGZvciB3aXRoaW4gdGhlIHRva2VuIGBoYW5kbGVyYCB0aGF0IGFyZQ0KICogICAgIG5vdCByZXF1aXJlZCB0byB0cmlnZ2VyIHRoZSB0b2tlbi4gVGhpcyByZWdpc3RlcnMgdGhlIGZsYWdzLCB0byBwcmV2ZW50IFhSZWdFeHAgZnJvbQ0KICogICAgIHRocm93aW5nIGFuICd1bmtub3duIGZsYWcnIGVycm9yIHdoZW4gYW55IG9mIHRoZSBmbGFncyBhcmUgdXNlZC4NCiAqICAgLSBgcmVwYXJzZWAge0Jvb2xlYW59IFdoZXRoZXIgdGhlIGBoYW5kbGVyYCBmdW5jdGlvbidzIG91dHB1dCBzaG91bGQgbm90IGJlIHRyZWF0ZWQgYXMNCiAqICAgICBmaW5hbCwgYW5kIGluc3RlYWQgYmUgcmVwYXJzZWFibGUgYnkgb3RoZXIgdG9rZW5zIChpbmNsdWRpbmcgdGhlIGN1cnJlbnQgdG9rZW4pLiBBbGxvd3MNCiAqICAgICB0b2tlbiBjaGFpbmluZyBvciBkZWZlcnJpbmcuDQogKiAgIC0gYGxlYWRDaGFyYCB7U3RyaW5nfSBTaW5nbGUgY2hhcmFjdGVyIHRoYXQgb2NjdXJzIGF0IHRoZSBiZWdpbm5pbmcgb2YgYW55IHN1Y2Nlc3NmdWwgbWF0Y2gNCiAqICAgICBvZiB0aGUgdG9rZW4gKG5vdCBhbHdheXMgYXBwbGljYWJsZSkuIFRoaXMgZG9lc24ndCBjaGFuZ2UgdGhlIGJlaGF2aW9yIG9mIHRoZSB0b2tlbiB1bmxlc3MNCiAqICAgICB5b3UgcHJvdmlkZSBhbiBlcnJvbmVvdXMgdmFsdWUuIEhvd2V2ZXIsIHByb3ZpZGluZyBpdCBjYW4gaW5jcmVhc2UgdGhlIHRva2VuJ3MgcGVyZm9ybWFuY2UNCiAqICAgICBzaW5jZSB0aGUgdG9rZW4gY2FuIGJlIHNraXBwZWQgYXQgYW55IHBvc2l0aW9ucyB3aGVyZSB0aGlzIGNoYXJhY3RlciBkb2Vzbid0IGFwcGVhci4NCiAqIEBleGFtcGxlDQogKg0KICogLy8gQmFzaWMgdXNhZ2U6IEFkZCBcYSBmb3IgdGhlIEFMRVJUIGNvbnRyb2wgY29kZQ0KICogWFJlZ0V4cC5hZGRUb2tlbigNCiAqICAgL1xcYS8sDQogKiAgICgpID0+ICdcXHgwNycsDQogKiAgIHtzY29wZTogJ2FsbCd9DQogKiApOw0KICogWFJlZ0V4cCgnXFxhW1xcYS1cXG5dKycpLnRlc3QoJ1x4MDdcblx4MDcnKTsgLy8gLT4gdHJ1ZQ0KICoNCiAqIC8vIEFkZCB0aGUgVSAodW5ncmVlZHkpIGZsYWcgZnJvbSBQQ1JFIGFuZCBSRTIsIHdoaWNoIHJldmVyc2VzIGdyZWVkeSBhbmQgbGF6eSBxdWFudGlmaWVycy4NCiAqIC8vIFNpbmNlIGBzY29wZWAgaXMgbm90IHNwZWNpZmllZCwgaXQgdXNlcyAnZGVmYXVsdCcgKGkuZS4sIHRyYW5zZm9ybWF0aW9ucyBhcHBseSBvdXRzaWRlIG9mDQogKiAvLyBjaGFyYWN0ZXIgY2xhc3NlcyBvbmx5KQ0KICogWFJlZ0V4cC5hZGRUb2tlbigNCiAqICAgLyhbPyorXXx7XGQrKD86LFxkKik/fSkoXD8/KS8sDQogKiAgIChtYXRjaCkgPT4gYCR7bWF0Y2hbMV19JHttYXRjaFsyXSA/ICcnIDogJz8nfWAsDQogKiAgIHtmbGFnOiAnVSd9DQogKiApOw0KICogWFJlZ0V4cCgnYSsnLCAnVScpLmV4ZWMoJ2FhYScpWzBdOyAvLyAtPiAnYScNCiAqIFhSZWdFeHAoJ2ErPycsICdVJykuZXhlYygnYWFhJylbMF07IC8vIC0+ICdhYWEnDQogKi8NCg0KWFJlZ0V4cC5hZGRUb2tlbiA9IGZ1bmN0aW9uIChyZWdleCwgaGFuZGxlciwgb3B0aW9ucykgew0KICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsNCiAgdmFyIF9vcHRpb25zID0gb3B0aW9ucywNCiAgICAgIG9wdGlvbmFsRmxhZ3MgPSBfb3B0aW9ucy5vcHRpb25hbEZsYWdzOw0KDQogIGlmIChvcHRpb25zLmZsYWcpIHsNCiAgICByZWdpc3RlckZsYWcob3B0aW9ucy5mbGFnKTsNCiAgfQ0KDQogIGlmIChvcHRpb25hbEZsYWdzKSB7DQogICAgb3B0aW9uYWxGbGFncyA9IG5hdGl2LnNwbGl0LmNhbGwob3B0aW9uYWxGbGFncywgJycpOw0KICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWU7DQogICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMiA9IGZhbHNlOw0KICAgIHZhciBfaXRlcmF0b3JFcnJvcjIgPSB1bmRlZmluZWQ7DQoNCiAgICB0cnkgew0KICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMiA9IG9wdGlvbmFsRmxhZ3NbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDI7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSAoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWUpIHsNCiAgICAgICAgdmFyIGZsYWcgPSBfc3RlcDIudmFsdWU7DQogICAgICAgIHJlZ2lzdGVyRmxhZyhmbGFnKTsNCiAgICAgIH0NCiAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgIF9kaWRJdGVyYXRvckVycm9yMiA9IHRydWU7DQogICAgICBfaXRlcmF0b3JFcnJvcjIgPSBlcnI7DQogICAgfSBmaW5hbGx5IHsNCiAgICAgIHRyeSB7DQogICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgJiYgX2l0ZXJhdG9yMi5yZXR1cm4gIT0gbnVsbCkgew0KICAgICAgICAgIF9pdGVyYXRvcjIucmV0dXJuKCk7DQogICAgICAgIH0NCiAgICAgIH0gZmluYWxseSB7DQogICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjIpIHsNCiAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjI7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogIH0gLy8gQWRkIHRvIHRoZSBwcml2YXRlIGxpc3Qgb2Ygc3ludGF4IHRva2Vucw0KDQoNCiAgdG9rZW5zLnB1c2goew0KICAgIHJlZ2V4OiBjb3B5UmVnZXgocmVnZXgsIHsNCiAgICAgIGFkZEc6IHRydWUsDQogICAgICBhZGRZOiBoYXNOYXRpdmVZLA0KICAgICAgaXNJbnRlcm5hbE9ubHk6IHRydWUNCiAgICB9KSwNCiAgICBoYW5kbGVyOiBoYW5kbGVyLA0KICAgIHNjb3BlOiBvcHRpb25zLnNjb3BlIHx8IGRlZmF1bHRTY29wZSwNCiAgICBmbGFnOiBvcHRpb25zLmZsYWcsDQogICAgcmVwYXJzZTogb3B0aW9ucy5yZXBhcnNlLA0KICAgIGxlYWRDaGFyOiBvcHRpb25zLmxlYWRDaGFyDQogIH0pOyAvLyBSZXNldCB0aGUgcGF0dGVybiBjYWNoZSB1c2VkIGJ5IHRoZSBgWFJlZ0V4cGAgY29uc3RydWN0b3IsIHNpbmNlIHRoZSBzYW1lIHBhdHRlcm4gYW5kIGZsYWdzDQogIC8vIG1pZ2h0IG5vdyBwcm9kdWNlIGRpZmZlcmVudCByZXN1bHRzDQoNCiAgWFJlZ0V4cC5jYWNoZS5mbHVzaCgncGF0dGVybnMnKTsNCn07DQovKioNCiAqIENhY2hlcyBhbmQgcmV0dXJucyB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYFhSZWdFeHAocGF0dGVybiwgZmxhZ3MpYC4gT24gYW55IHN1YnNlcXVlbnQgY2FsbCB3aXRoDQogKiB0aGUgc2FtZSBwYXR0ZXJuIGFuZCBmbGFnIGNvbWJpbmF0aW9uLCB0aGUgY2FjaGVkIGNvcHkgb2YgdGhlIHJlZ2V4IGlzIHJldHVybmVkLg0KICoNCiAqIEBtZW1iZXJPZiBYUmVnRXhwDQogKiBAcGFyYW0ge1N0cmluZ30gcGF0dGVybiBSZWdleCBwYXR0ZXJuIHN0cmluZy4NCiAqIEBwYXJhbSB7U3RyaW5nfSBbZmxhZ3NdIEFueSBjb21iaW5hdGlvbiBvZiBYUmVnRXhwIGZsYWdzLg0KICogQHJldHVybnMge1JlZ0V4cH0gQ2FjaGVkIFhSZWdFeHAgb2JqZWN0Lg0KICogQGV4YW1wbGUNCiAqDQogKiB3aGlsZSAobWF0Y2ggPSBYUmVnRXhwLmNhY2hlKCcuJywgJ2dzJykuZXhlYyhzdHIpKSB7DQogKiAgIC8vIFRoZSByZWdleCBpcyBjb21waWxlZCBvbmNlIG9ubHkNCiAqIH0NCiAqLw0KDQoNClhSZWdFeHAuY2FjaGUgPSBmdW5jdGlvbiAocGF0dGVybiwgZmxhZ3MpIHsNCiAgaWYgKCFyZWdleENhY2hlW3BhdHRlcm5dKSB7DQogICAgcmVnZXhDYWNoZVtwYXR0ZXJuXSA9IHt9Ow0KICB9DQoNCiAgcmV0dXJuIHJlZ2V4Q2FjaGVbcGF0dGVybl1bZmxhZ3NdIHx8IChyZWdleENhY2hlW3BhdHRlcm5dW2ZsYWdzXSA9IFhSZWdFeHAocGF0dGVybiwgZmxhZ3MpKTsNCn07IC8vIEludGVudGlvbmFsbHkgdW5kb2N1bWVudGVkOyB1c2VkIGluIHRlc3RzDQoNCg0KWFJlZ0V4cC5jYWNoZS5mbHVzaCA9IGZ1bmN0aW9uIChjYWNoZU5hbWUpIHsNCiAgaWYgKGNhY2hlTmFtZSA9PT0gJ3BhdHRlcm5zJykgew0KICAgIC8vIEZsdXNoIHRoZSBwYXR0ZXJuIGNhY2hlIHVzZWQgYnkgdGhlIGBYUmVnRXhwYCBjb25zdHJ1Y3Rvcg0KICAgIHBhdHRlcm5DYWNoZSA9IHt9Ow0KICB9IGVsc2Ugew0KICAgIC8vIEZsdXNoIHRoZSByZWdleCBjYWNoZSBwb3B1bGF0ZWQgYnkgYFhSZWdFeHAuY2FjaGVgDQogICAgcmVnZXhDYWNoZSA9IHt9Ow0KICB9DQp9Ow0KLyoqDQogKiBFc2NhcGVzIGFueSByZWd1bGFyIGV4cHJlc3Npb24gbWV0YWNoYXJhY3RlcnMsIGZvciB1c2Ugd2hlbiBtYXRjaGluZyBsaXRlcmFsIHN0cmluZ3MuIFRoZSByZXN1bHQNCiAqIGNhbiBzYWZlbHkgYmUgdXNlZCBhdCBhbnkgcG9pbnQgd2l0aGluIGEgcmVnZXggdGhhdCB1c2VzIGFueSBmbGFncy4NCiAqDQogKiBAbWVtYmVyT2YgWFJlZ0V4cA0KICogQHBhcmFtIHtTdHJpbmd9IHN0ciBTdHJpbmcgdG8gZXNjYXBlLg0KICogQHJldHVybnMge1N0cmluZ30gU3RyaW5nIHdpdGggcmVnZXggbWV0YWNoYXJhY3RlcnMgZXNjYXBlZC4NCiAqIEBleGFtcGxlDQogKg0KICogWFJlZ0V4cC5lc2NhcGUoJ0VzY2FwZWQ/IDwuPicpOw0KICogLy8gLT4gJ0VzY2FwZWRcP1wgPFwuPicNCiAqLw0KDQoNClhSZWdFeHAuZXNjYXBlID0gZnVuY3Rpb24gKHN0cikgew0KICByZXR1cm4gbmF0aXYucmVwbGFjZS5jYWxsKHRvT2JqZWN0KHN0ciksIC9bLVxbXF17fSgpKis/LixcXF4kfCNcc10vZywgJ1xcJCYnKTsNCn07DQovKioNCiAqIEV4ZWN1dGVzIGEgcmVnZXggc2VhcmNoIGluIGEgc3BlY2lmaWVkIHN0cmluZy4gUmV0dXJucyBhIG1hdGNoIGFycmF5IG9yIGBudWxsYC4gSWYgdGhlIHByb3ZpZGVkDQogKiByZWdleCB1c2VzIG5hbWVkIGNhcHR1cmUsIG5hbWVkIGJhY2tyZWZlcmVuY2UgcHJvcGVydGllcyBhcmUgaW5jbHVkZWQgb24gdGhlIG1hdGNoIGFycmF5Lg0KICogT3B0aW9uYWwgYHBvc2AgYW5kIGBzdGlja3lgIGFyZ3VtZW50cyBzcGVjaWZ5IHRoZSBzZWFyY2ggc3RhcnQgcG9zaXRpb24sIGFuZCB3aGV0aGVyIHRoZSBtYXRjaA0KICogbXVzdCBzdGFydCBhdCB0aGUgc3BlY2lmaWVkIHBvc2l0aW9uIG9ubHkuIFRoZSBgbGFzdEluZGV4YCBwcm9wZXJ0eSBvZiB0aGUgcHJvdmlkZWQgcmVnZXggaXMgbm90DQogKiB1c2VkLCBidXQgaXMgdXBkYXRlZCBmb3IgY29tcGF0aWJpbGl0eS4gQWxzbyBmaXhlcyBicm93c2VyIGJ1Z3MgY29tcGFyZWQgdG8gdGhlIG5hdGl2ZQ0KICogYFJlZ0V4cC5wcm90b3R5cGUuZXhlY2AgYW5kIGNhbiBiZSB1c2VkIHJlbGlhYmx5IGNyb3NzLWJyb3dzZXIuDQogKg0KICogQG1lbWJlck9mIFhSZWdFeHANCiAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgU3RyaW5nIHRvIHNlYXJjaC4NCiAqIEBwYXJhbSB7UmVnRXhwfSByZWdleCBSZWdleCB0byBzZWFyY2ggd2l0aC4NCiAqIEBwYXJhbSB7TnVtYmVyfSBbcG9zPTBdIFplcm8tYmFzZWQgaW5kZXggYXQgd2hpY2ggdG8gc3RhcnQgdGhlIHNlYXJjaC4NCiAqIEBwYXJhbSB7Qm9vbGVhbnxTdHJpbmd9IFtzdGlja3k9ZmFsc2VdIFdoZXRoZXIgdGhlIG1hdGNoIG11c3Qgc3RhcnQgYXQgdGhlIHNwZWNpZmllZCBwb3NpdGlvbg0KICogICBvbmx5LiBUaGUgc3RyaW5nIGAnc3RpY2t5J2AgaXMgYWNjZXB0ZWQgYXMgYW4gYWx0ZXJuYXRpdmUgdG8gYHRydWVgLg0KICogQHJldHVybnMge0FycmF5fSBNYXRjaCBhcnJheSB3aXRoIG5hbWVkIGJhY2tyZWZlcmVuY2UgcHJvcGVydGllcywgb3IgYG51bGxgLg0KICogQGV4YW1wbGUNCiAqDQogKiAvLyBCYXNpYyB1c2UsIHdpdGggbmFtZWQgYmFja3JlZmVyZW5jZQ0KICogbGV0IG1hdGNoID0gWFJlZ0V4cC5leGVjKCdVKzI2MjAnLCBYUmVnRXhwKCdVXFwrKD88aGV4PlswLTlBLUZdezR9KScpKTsNCiAqIG1hdGNoLmhleDsgLy8gLT4gJzI2MjAnDQogKg0KICogLy8gV2l0aCBwb3MgYW5kIHN0aWNreSwgaW4gYSBsb29wDQogKiBsZXQgcG9zID0gMiwgcmVzdWx0ID0gW10sIG1hdGNoOw0KICogd2hpbGUgKG1hdGNoID0gWFJlZ0V4cC5leGVjKCc8MT48Mj48Mz48ND41PDY+JywgLzwoXGQpPi8sIHBvcywgJ3N0aWNreScpKSB7DQogKiAgIHJlc3VsdC5wdXNoKG1hdGNoWzFdKTsNCiAqICAgcG9zID0gbWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGg7DQogKiB9DQogKiAvLyByZXN1bHQgLT4gWycyJywgJzMnLCAnNCddDQogKi8NCg0KDQpYUmVnRXhwLmV4ZWMgPSBmdW5jdGlvbiAoc3RyLCByZWdleCwgcG9zLCBzdGlja3kpIHsNCiAgdmFyIGNhY2hlS2V5ID0gJ2cnOw0KICB2YXIgYWRkWSA9IGZhbHNlOw0KICB2YXIgZmFrZVkgPSBmYWxzZTsNCiAgdmFyIG1hdGNoOw0KICBhZGRZID0gaGFzTmF0aXZlWSAmJiAhIShzdGlja3kgfHwgcmVnZXguc3RpY2t5ICYmIHN0aWNreSAhPT0gZmFsc2UpOw0KDQogIGlmIChhZGRZKSB7DQogICAgY2FjaGVLZXkgKz0gJ3knOw0KICB9IGVsc2UgaWYgKHN0aWNreSkgew0KICAgIC8vIFNpbXVsYXRlIHN0aWNreSBtYXRjaGluZyBieSBhcHBlbmRpbmcgYW4gZW1wdHkgY2FwdHVyZSB0byB0aGUgb3JpZ2luYWwgcmVnZXguIFRoZQ0KICAgIC8vIHJlc3VsdGluZyByZWdleCB3aWxsIHN1Y2NlZWQgbm8gbWF0dGVyIHdoYXQgYXQgdGhlIGN1cnJlbnQgaW5kZXggKHNldCB3aXRoIGBsYXN0SW5kZXhgKSwNCiAgICAvLyBhbmQgd2lsbCBub3Qgc2VhcmNoIHRoZSByZXN0IG9mIHRoZSBzdWJqZWN0IHN0cmluZy4gV2UnbGwga25vdyB0aGF0IHRoZSBvcmlnaW5hbCByZWdleA0KICAgIC8vIGhhcyBmYWlsZWQgaWYgdGhhdCBsYXN0IGNhcHR1cmUgaXMgYCcnYCByYXRoZXIgdGhhbiBgdW5kZWZpbmVkYCAoaS5lLiwgaWYgdGhhdCBsYXN0DQogICAgLy8gY2FwdHVyZSBwYXJ0aWNpcGF0ZWQgaW4gdGhlIG1hdGNoKS4NCiAgICBmYWtlWSA9IHRydWU7DQogICAgY2FjaGVLZXkgKz0gJ0Zha2VZJzsNCiAgfQ0KDQogIHJlZ2V4W1JFR0VYX0RBVEFdID0gcmVnZXhbUkVHRVhfREFUQV0gfHwge307IC8vIFNoYXJlcyBjYWNoZWQgY29waWVzIHdpdGggYFhSZWdFeHAubWF0Y2hgL2ByZXBsYWNlYA0KDQogIHZhciByMiA9IHJlZ2V4W1JFR0VYX0RBVEFdW2NhY2hlS2V5XSB8fCAocmVnZXhbUkVHRVhfREFUQV1bY2FjaGVLZXldID0gY29weVJlZ2V4KHJlZ2V4LCB7DQogICAgYWRkRzogdHJ1ZSwNCiAgICBhZGRZOiBhZGRZLA0KICAgIHNvdXJjZTogZmFrZVkgPyAiIi5jb25jYXQocmVnZXguc291cmNlLCAifCgpIikgOiB1bmRlZmluZWQsDQogICAgcmVtb3ZlWTogc3RpY2t5ID09PSBmYWxzZSwNCiAgICBpc0ludGVybmFsT25seTogdHJ1ZQ0KICB9KSk7DQogIHBvcyA9IHBvcyB8fCAwOw0KICByMi5sYXN0SW5kZXggPSBwb3M7IC8vIEZpeGVkIGBleGVjYCByZXF1aXJlZCBmb3IgYGxhc3RJbmRleGAgZml4LCBuYW1lZCBiYWNrcmVmZXJlbmNlcywgZXRjLg0KDQogIG1hdGNoID0gZml4ZWQuZXhlYy5jYWxsKHIyLCBzdHIpOyAvLyBHZXQgcmlkIG9mIHRoZSBjYXB0dXJlIGFkZGVkIGJ5IHRoZSBwc2V1ZG8tc3RpY2t5IG1hdGNoZXIgaWYgbmVlZGVkLiBBbiBlbXB0eSBzdHJpbmcgbWVhbnMNCiAgLy8gdGhlIG9yaWdpbmFsIHJlZ2V4cCBmYWlsZWQgKHNlZSBhYm92ZSkuDQoNCiAgaWYgKGZha2VZICYmIG1hdGNoICYmIG1hdGNoLnBvcCgpID09PSAnJykgew0KICAgIG1hdGNoID0gbnVsbDsNCiAgfQ0KDQogIGlmIChyZWdleC5nbG9iYWwpIHsNCiAgICByZWdleC5sYXN0SW5kZXggPSBtYXRjaCA/IHIyLmxhc3RJbmRleCA6IDA7DQogIH0NCg0KICByZXR1cm4gbWF0Y2g7DQp9Ow0KLyoqDQogKiBFeGVjdXRlcyBhIHByb3ZpZGVkIGZ1bmN0aW9uIG9uY2UgcGVyIHJlZ2V4IG1hdGNoLiBTZWFyY2hlcyBhbHdheXMgc3RhcnQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUNCiAqIHN0cmluZyBhbmQgY29udGludWUgdW50aWwgdGhlIGVuZCwgcmVnYXJkbGVzcyBvZiB0aGUgc3RhdGUgb2YgdGhlIHJlZ2V4J3MgYGdsb2JhbGAgcHJvcGVydHkgYW5kDQogKiBpbml0aWFsIGBsYXN0SW5kZXhgLg0KICoNCiAqIEBtZW1iZXJPZiBYUmVnRXhwDQogKiBAcGFyYW0ge1N0cmluZ30gc3RyIFN0cmluZyB0byBzZWFyY2guDQogKiBAcGFyYW0ge1JlZ0V4cH0gcmVnZXggUmVnZXggdG8gc2VhcmNoIHdpdGguDQogKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBGdW5jdGlvbiB0byBleGVjdXRlIGZvciBlYWNoIG1hdGNoLiBJbnZva2VkIHdpdGggZm91ciBhcmd1bWVudHM6DQogKiAgIC0gVGhlIG1hdGNoIGFycmF5LCB3aXRoIG5hbWVkIGJhY2tyZWZlcmVuY2UgcHJvcGVydGllcy4NCiAqICAgLSBUaGUgemVyby1iYXNlZCBtYXRjaCBpbmRleC4NCiAqICAgLSBUaGUgc3RyaW5nIGJlaW5nIHRyYXZlcnNlZC4NCiAqICAgLSBUaGUgcmVnZXggb2JqZWN0IGJlaW5nIHVzZWQgdG8gdHJhdmVyc2UgdGhlIHN0cmluZy4NCiAqIEBleGFtcGxlDQogKg0KICogLy8gRXh0cmFjdHMgZXZlcnkgb3RoZXIgZGlnaXQgZnJvbSBhIHN0cmluZw0KICogY29uc3QgZXZlbnMgPSBbXTsNCiAqIFhSZWdFeHAuZm9yRWFjaCgnMWEyMzQ1JywgL1xkLywgKG1hdGNoLCBpKSA9PiB7DQogKiAgIGlmIChpICUgMikgZXZlbnMucHVzaCgrbWF0Y2hbMF0pOw0KICogfSk7DQogKiAvLyBldmVucyAtPiBbMiwgNF0NCiAqLw0KDQoNClhSZWdFeHAuZm9yRWFjaCA9IGZ1bmN0aW9uIChzdHIsIHJlZ2V4LCBjYWxsYmFjaykgew0KICB2YXIgcG9zID0gMDsNCiAgdmFyIGkgPSAtMTsNCiAgdmFyIG1hdGNoOw0KDQogIHdoaWxlIChtYXRjaCA9IFhSZWdFeHAuZXhlYyhzdHIsIHJlZ2V4LCBwb3MpKSB7DQogICAgLy8gQmVjYXVzZSBgcmVnZXhgIGlzIHByb3ZpZGVkIHRvIGBjYWxsYmFja2AsIHRoZSBmdW5jdGlvbiBjb3VsZCB1c2UgdGhlIGRlcHJlY2F0ZWQvDQogICAgLy8gbm9uc3RhbmRhcmQgYFJlZ0V4cC5wcm90b3R5cGUuY29tcGlsZWAgdG8gbXV0YXRlIHRoZSByZWdleC4gSG93ZXZlciwgc2luY2UgYFhSZWdFeHAuZXhlY2ANCiAgICAvLyBkb2Vzbid0IHVzZSBgbGFzdEluZGV4YCB0byBzZXQgdGhlIHNlYXJjaCBwb3NpdGlvbiwgdGhpcyBjYW4ndCBsZWFkIHRvIGFuIGluZmluaXRlIGxvb3AsDQogICAgLy8gYXQgbGVhc3QuIEFjdHVhbGx5LCBiZWNhdXNlIG9mIHRoZSB3YXkgYFhSZWdFeHAuZXhlY2AgY2FjaGVzIGdsb2JhbGl6ZWQgdmVyc2lvbnMgb2YNCiAgICAvLyByZWdleGVzLCBtdXRhdGluZyB0aGUgcmVnZXggd2lsbCBub3QgaGF2ZSBhbnkgZWZmZWN0IG9uIHRoZSBpdGVyYXRpb24gb3IgbWF0Y2hlZCBzdHJpbmdzLA0KICAgIC8vIHdoaWNoIGlzIGEgbmljZSBzaWRlIGVmZmVjdCB0aGF0IGJyaW5ncyBleHRyYSBzYWZldHkuDQogICAgY2FsbGJhY2sobWF0Y2gsICsraSwgc3RyLCByZWdleCk7DQogICAgcG9zID0gbWF0Y2guaW5kZXggKyAobWF0Y2hbMF0ubGVuZ3RoIHx8IDEpOw0KICB9DQp9Ow0KLyoqDQogKiBDb3BpZXMgYSByZWdleCBvYmplY3QgYW5kIGFkZHMgZmxhZyBgZ2AuIFRoZSBjb3B5IG1haW50YWlucyBleHRlbmRlZCBkYXRhLCBpcyBhdWdtZW50ZWQgd2l0aA0KICogYFhSZWdFeHAucHJvdG90eXBlYCBwcm9wZXJ0aWVzLCBhbmQgaGFzIGEgZnJlc2ggYGxhc3RJbmRleGAgcHJvcGVydHkgKHNldCB0byB6ZXJvKS4gTmF0aXZlDQogKiByZWdleGVzIGFyZSBub3QgcmVjb21waWxlZCB1c2luZyBYUmVnRXhwIHN5bnRheC4NCiAqDQogKiBAbWVtYmVyT2YgWFJlZ0V4cA0KICogQHBhcmFtIHtSZWdFeHB9IHJlZ2V4IFJlZ2V4IHRvIGdsb2JhbGl6ZS4NCiAqIEByZXR1cm5zIHtSZWdFeHB9IENvcHkgb2YgdGhlIHByb3ZpZGVkIHJlZ2V4IHdpdGggZmxhZyBgZ2AgYWRkZWQuDQogKiBAZXhhbXBsZQ0KICoNCiAqIGNvbnN0IGdsb2JhbENvcHkgPSBYUmVnRXhwLmdsb2JhbGl6ZSgvcmVnZXgvKTsNCiAqIGdsb2JhbENvcHkuZ2xvYmFsOyAvLyAtPiB0cnVlDQogKi8NCg0KDQpYUmVnRXhwLmdsb2JhbGl6ZSA9IGZ1bmN0aW9uIChyZWdleCkgew0KICByZXR1cm4gY29weVJlZ2V4KHJlZ2V4LCB7DQogICAgYWRkRzogdHJ1ZQ0KICB9KTsNCn07DQovKioNCiAqIEluc3RhbGxzIG9wdGlvbmFsIGZlYXR1cmVzIGFjY29yZGluZyB0byB0aGUgc3BlY2lmaWVkIG9wdGlvbnMuIENhbiBiZSB1bmRvbmUgdXNpbmcNCiAqIGBYUmVnRXhwLnVuaW5zdGFsbGAuDQogKg0KICogQG1lbWJlck9mIFhSZWdFeHANCiAqIEBwYXJhbSB7T2JqZWN0fFN0cmluZ30gb3B0aW9ucyBPcHRpb25zIG9iamVjdCBvciBzdHJpbmcuDQogKiBAZXhhbXBsZQ0KICoNCiAqIC8vIFdpdGggYW4gb3B0aW9ucyBvYmplY3QNCiAqIFhSZWdFeHAuaW5zdGFsbCh7DQogKiAgIC8vIEVuYWJsZXMgc3VwcG9ydCBmb3IgYXN0cmFsIGNvZGUgcG9pbnRzIGluIFVuaWNvZGUgYWRkb25zIChpbXBsaWNpdGx5IHNldHMgZmxhZyBBKQ0KICogICBhc3RyYWw6IHRydWUsDQogKg0KICogICAvLyBBZGRzIG5hbWVkIGNhcHR1cmUgZ3JvdXBzIHRvIHRoZSBgZ3JvdXBzYCBwcm9wZXJ0eSBvZiBtYXRjaGVzDQogKiAgIG5hbWVzcGFjaW5nOiB0cnVlDQogKiB9KTsNCiAqDQogKiAvLyBXaXRoIGFuIG9wdGlvbnMgc3RyaW5nDQogKiBYUmVnRXhwLmluc3RhbGwoJ2FzdHJhbCBuYW1lc3BhY2luZycpOw0KICovDQoNCg0KWFJlZ0V4cC5pbnN0YWxsID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsNCiAgb3B0aW9ucyA9IHByZXBhcmVPcHRpb25zKG9wdGlvbnMpOw0KDQogIGlmICghZmVhdHVyZXMuYXN0cmFsICYmIG9wdGlvbnMuYXN0cmFsKSB7DQogICAgc2V0QXN0cmFsKHRydWUpOw0KICB9DQoNCiAgaWYgKCFmZWF0dXJlcy5uYW1lc3BhY2luZyAmJiBvcHRpb25zLm5hbWVzcGFjaW5nKSB7DQogICAgc2V0TmFtZXNwYWNpbmcodHJ1ZSk7DQogIH0NCn07DQovKioNCiAqIENoZWNrcyB3aGV0aGVyIGFuIGluZGl2aWR1YWwgb3B0aW9uYWwgZmVhdHVyZSBpcyBpbnN0YWxsZWQuDQogKg0KICogQG1lbWJlck9mIFhSZWdFeHANCiAqIEBwYXJhbSB7U3RyaW5nfSBmZWF0dXJlIE5hbWUgb2YgdGhlIGZlYXR1cmUgdG8gY2hlY2suIE9uZSBvZjoNCiAqICAgLSBgYXN0cmFsYA0KICogICAtIGBuYW1lc3BhY2luZ2ANCiAqIEByZXR1cm5zIHtCb29sZWFufSBXaGV0aGVyIHRoZSBmZWF0dXJlIGlzIGluc3RhbGxlZC4NCiAqIEBleGFtcGxlDQogKg0KICogWFJlZ0V4cC5pc0luc3RhbGxlZCgnYXN0cmFsJyk7DQogKi8NCg0KDQpYUmVnRXhwLmlzSW5zdGFsbGVkID0gZnVuY3Rpb24gKGZlYXR1cmUpIHsNCiAgcmV0dXJuICEhZmVhdHVyZXNbZmVhdHVyZV07DQp9Ow0KLyoqDQogKiBSZXR1cm5zIGB0cnVlYCBpZiBhbiBvYmplY3QgaXMgYSByZWdleDsgYGZhbHNlYCBpZiBpdCBpc24ndC4gVGhpcyB3b3JrcyBjb3JyZWN0bHkgZm9yIHJlZ2V4ZXMNCiAqIGNyZWF0ZWQgaW4gYW5vdGhlciBmcmFtZSwgd2hlbiBgaW5zdGFuY2VvZmAgYW5kIGBjb25zdHJ1Y3RvcmAgY2hlY2tzIHdvdWxkIGZhaWwuDQogKg0KICogQG1lbWJlck9mIFhSZWdFeHANCiAqIEBwYXJhbSB7Kn0gdmFsdWUgT2JqZWN0IHRvIGNoZWNrLg0KICogQHJldHVybnMge0Jvb2xlYW59IFdoZXRoZXIgdGhlIG9iamVjdCBpcyBhIGBSZWdFeHBgIG9iamVjdC4NCiAqIEBleGFtcGxlDQogKg0KICogWFJlZ0V4cC5pc1JlZ0V4cCgnc3RyaW5nJyk7IC8vIC0+IGZhbHNlDQogKiBYUmVnRXhwLmlzUmVnRXhwKC9yZWdleC9pKTsgLy8gLT4gdHJ1ZQ0KICogWFJlZ0V4cC5pc1JlZ0V4cChSZWdFeHAoJ14nLCAnbScpKTsgLy8gLT4gdHJ1ZQ0KICogWFJlZ0V4cC5pc1JlZ0V4cChYUmVnRXhwKCcoP3MpLicpKTsgLy8gLT4gdHJ1ZQ0KICovDQoNCg0KWFJlZ0V4cC5pc1JlZ0V4cCA9IGZ1bmN0aW9uICh2YWx1ZSkgew0KICByZXR1cm4gdG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT09ICdbb2JqZWN0IFJlZ0V4cF0nOw0KfTsgLy8gaXNUeXBlKHZhbHVlLCAnUmVnRXhwJyk7DQoNCi8qKg0KICogUmV0dXJucyB0aGUgZmlyc3QgbWF0Y2hlZCBzdHJpbmcsIG9yIGluIGdsb2JhbCBtb2RlLCBhbiBhcnJheSBjb250YWluaW5nIGFsbCBtYXRjaGVkIHN0cmluZ3MuDQogKiBUaGlzIGlzIGVzc2VudGlhbGx5IGEgbW9yZSBjb252ZW5pZW50IHJlLWltcGxlbWVudGF0aW9uIG9mIGBTdHJpbmcucHJvdG90eXBlLm1hdGNoYCB0aGF0IGdpdmVzDQogKiB0aGUgcmVzdWx0IHR5cGVzIHlvdSBhY3R1YWxseSB3YW50IChzdHJpbmcgaW5zdGVhZCBvZiBgZXhlY2Atc3R5bGUgYXJyYXkgaW4gbWF0Y2gtZmlyc3QgbW9kZSwNCiAqIGFuZCBhbiBlbXB0eSBhcnJheSBpbnN0ZWFkIG9mIGBudWxsYCB3aGVuIG5vIG1hdGNoZXMgYXJlIGZvdW5kIGluIG1hdGNoLWFsbCBtb2RlKS4gSXQgYWxzbyBsZXRzDQogKiB5b3Ugb3ZlcnJpZGUgZmxhZyBnIGFuZCBpZ25vcmUgYGxhc3RJbmRleGAsIGFuZCBmaXhlcyBicm93c2VyIGJ1Z3MuDQogKg0KICogQG1lbWJlck9mIFhSZWdFeHANCiAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgU3RyaW5nIHRvIHNlYXJjaC4NCiAqIEBwYXJhbSB7UmVnRXhwfSByZWdleCBSZWdleCB0byBzZWFyY2ggd2l0aC4NCiAqIEBwYXJhbSB7U3RyaW5nfSBbc2NvcGU9J29uZSddIFVzZSAnb25lJyB0byByZXR1cm4gdGhlIGZpcnN0IG1hdGNoIGFzIGEgc3RyaW5nLiBVc2UgJ2FsbCcgdG8NCiAqICAgcmV0dXJuIGFuIGFycmF5IG9mIGFsbCBtYXRjaGVkIHN0cmluZ3MuIElmIG5vdCBleHBsaWNpdGx5IHNwZWNpZmllZCBhbmQgYHJlZ2V4YCB1c2VzIGZsYWcgZywNCiAqICAgYHNjb3BlYCBpcyAnYWxsJy4NCiAqIEByZXR1cm5zIHtTdHJpbmd8QXJyYXl9IEluIG1hdGNoLWZpcnN0IG1vZGU6IEZpcnN0IG1hdGNoIGFzIGEgc3RyaW5nLCBvciBgbnVsbGAuIEluIG1hdGNoLWFsbA0KICogICBtb2RlOiBBcnJheSBvZiBhbGwgbWF0Y2hlZCBzdHJpbmdzLCBvciBhbiBlbXB0eSBhcnJheS4NCiAqIEBleGFtcGxlDQogKg0KICogLy8gTWF0Y2ggZmlyc3QNCiAqIFhSZWdFeHAubWF0Y2goJ2FiYycsIC9cdy8pOyAvLyAtPiAnYScNCiAqIFhSZWdFeHAubWF0Y2goJ2FiYycsIC9cdy9nLCAnb25lJyk7IC8vIC0+ICdhJw0KICogWFJlZ0V4cC5tYXRjaCgnYWJjJywgL3gvZywgJ29uZScpOyAvLyAtPiBudWxsDQogKg0KICogLy8gTWF0Y2ggYWxsDQogKiBYUmVnRXhwLm1hdGNoKCdhYmMnLCAvXHcvZyk7IC8vIC0+IFsnYScsICdiJywgJ2MnXQ0KICogWFJlZ0V4cC5tYXRjaCgnYWJjJywgL1x3LywgJ2FsbCcpOyAvLyAtPiBbJ2EnLCAnYicsICdjJ10NCiAqIFhSZWdFeHAubWF0Y2goJ2FiYycsIC94LywgJ2FsbCcpOyAvLyAtPiBbXQ0KICovDQoNCg0KWFJlZ0V4cC5tYXRjaCA9IGZ1bmN0aW9uIChzdHIsIHJlZ2V4LCBzY29wZSkgew0KICB2YXIgZ2xvYmFsID0gcmVnZXguZ2xvYmFsICYmIHNjb3BlICE9PSAnb25lJyB8fCBzY29wZSA9PT0gJ2FsbCc7DQogIHZhciBjYWNoZUtleSA9IChnbG9iYWwgPyAnZycgOiAnJykgKyAocmVnZXguc3RpY2t5ID8gJ3knIDogJycpIHx8ICdub0dZJzsNCiAgcmVnZXhbUkVHRVhfREFUQV0gPSByZWdleFtSRUdFWF9EQVRBXSB8fCB7fTsgLy8gU2hhcmVzIGNhY2hlZCBjb3BpZXMgd2l0aCBgWFJlZ0V4cC5leGVjYC9gcmVwbGFjZWANCg0KICB2YXIgcjIgPSByZWdleFtSRUdFWF9EQVRBXVtjYWNoZUtleV0gfHwgKHJlZ2V4W1JFR0VYX0RBVEFdW2NhY2hlS2V5XSA9IGNvcHlSZWdleChyZWdleCwgew0KICAgIGFkZEc6ICEhZ2xvYmFsLA0KICAgIHJlbW92ZUc6IHNjb3BlID09PSAnb25lJywNCiAgICBpc0ludGVybmFsT25seTogdHJ1ZQ0KICB9KSk7DQogIHZhciByZXN1bHQgPSBuYXRpdi5tYXRjaC5jYWxsKHRvT2JqZWN0KHN0ciksIHIyKTsNCg0KICBpZiAocmVnZXguZ2xvYmFsKSB7DQogICAgcmVnZXgubGFzdEluZGV4ID0gc2NvcGUgPT09ICdvbmUnICYmIHJlc3VsdCA/IC8vIENhbid0IHVzZSBgcjIubGFzdEluZGV4YCBzaW5jZSBgcjJgIGlzIG5vbmdsb2JhbCBpbiB0aGlzIGNhc2UNCiAgICByZXN1bHQuaW5kZXggKyByZXN1bHRbMF0ubGVuZ3RoIDogMDsNCiAgfQ0KDQogIHJldHVybiBnbG9iYWwgPyByZXN1bHQgfHwgW10gOiByZXN1bHQgJiYgcmVzdWx0WzBdOw0KfTsNCi8qKg0KICogUmV0cmlldmVzIHRoZSBtYXRjaGVzIGZyb20gc2VhcmNoaW5nIGEgc3RyaW5nIHVzaW5nIGEgY2hhaW4gb2YgcmVnZXhlcyB0aGF0IHN1Y2Nlc3NpdmVseSBzZWFyY2gNCiAqIHdpdGhpbiBwcmV2aW91cyBtYXRjaGVzLiBUaGUgcHJvdmlkZWQgYGNoYWluYCBhcnJheSBjYW4gY29udGFpbiByZWdleGVzIGFuZCBvciBvYmplY3RzIHdpdGgNCiAqIGByZWdleGAgYW5kIGBiYWNrcmVmYCBwcm9wZXJ0aWVzLiBXaGVuIGEgYmFja3JlZmVyZW5jZSBpcyBzcGVjaWZpZWQsIHRoZSBuYW1lZCBvciBudW1iZXJlZA0KICogYmFja3JlZmVyZW5jZSBpcyBwYXNzZWQgZm9yd2FyZCB0byB0aGUgbmV4dCByZWdleCBvciByZXR1cm5lZC4NCiAqDQogKiBAbWVtYmVyT2YgWFJlZ0V4cA0KICogQHBhcmFtIHtTdHJpbmd9IHN0ciBTdHJpbmcgdG8gc2VhcmNoLg0KICogQHBhcmFtIHtBcnJheX0gY2hhaW4gUmVnZXhlcyB0aGF0IGVhY2ggc2VhcmNoIGZvciBtYXRjaGVzIHdpdGhpbiBwcmVjZWRpbmcgcmVzdWx0cy4NCiAqIEByZXR1cm5zIHtBcnJheX0gTWF0Y2hlcyBieSB0aGUgbGFzdCByZWdleCBpbiB0aGUgY2hhaW4sIG9yIGFuIGVtcHR5IGFycmF5Lg0KICogQGV4YW1wbGUNCiAqDQogKiAvLyBCYXNpYyB1c2FnZTsgbWF0Y2hlcyBudW1iZXJzIHdpdGhpbiA8Yj4gdGFncw0KICogWFJlZ0V4cC5tYXRjaENoYWluKCcxIDxiPjI8L2I+IDMgPGI+NCBhIDU2PC9iPicsIFsNCiAqICAgWFJlZ0V4cCgnKD9pcyk8Yj4uKj88L2I+JyksDQogKiAgIC9cZCsvDQogKiBdKTsNCiAqIC8vIC0+IFsnMicsICc0JywgJzU2J10NCiAqDQogKiAvLyBQYXNzaW5nIGZvcndhcmQgYW5kIHJldHVybmluZyBzcGVjaWZpYyBiYWNrcmVmZXJlbmNlcw0KICogaHRtbCA9ICc8YSBocmVmPSJodHRwOi8veHJlZ2V4cC5jb20vYXBpLyI+WFJlZ0V4cDwvYT5cDQogKiAgICAgICAgIDxhIGhyZWY9Imh0dHA6Ly93d3cuZ29vZ2xlLmNvbS8iPkdvb2dsZTwvYT4nOw0KICogWFJlZ0V4cC5tYXRjaENoYWluKGh0bWwsIFsNCiAqICAge3JlZ2V4OiAvPGEgaHJlZj0iKFteIl0rKSI+L2ksIGJhY2tyZWY6IDF9LA0KICogICB7cmVnZXg6IFhSZWdFeHAoJyg/aSleaHR0cHM/Oi8vKD88ZG9tYWluPlteLz8jXSspJyksIGJhY2tyZWY6ICdkb21haW4nfQ0KICogXSk7DQogKiAvLyAtPiBbJ3hyZWdleHAuY29tJywgJ3d3dy5nb29nbGUuY29tJ10NCiAqLw0KDQoNClhSZWdFeHAubWF0Y2hDaGFpbiA9IGZ1bmN0aW9uIChzdHIsIGNoYWluKSB7DQogIHJldHVybiBmdW5jdGlvbiByZWN1cnNlQ2hhaW4odmFsdWVzLCBsZXZlbCkgew0KICAgIHZhciBpdGVtID0gY2hhaW5bbGV2ZWxdLnJlZ2V4ID8gY2hhaW5bbGV2ZWxdIDogew0KICAgICAgcmVnZXg6IGNoYWluW2xldmVsXQ0KICAgIH07DQogICAgdmFyIG1hdGNoZXMgPSBbXTsNCg0KICAgIGZ1bmN0aW9uIGFkZE1hdGNoKG1hdGNoKSB7DQogICAgICBpZiAoaXRlbS5iYWNrcmVmKSB7DQogICAgICAgIHZhciBFUlJfVU5ERUZJTkVEX0dST1VQID0gIkJhY2tyZWZlcmVuY2UgdG8gdW5kZWZpbmVkIGdyb3VwOiAiLmNvbmNhdChpdGVtLmJhY2tyZWYpOw0KICAgICAgICB2YXIgaXNOYW1lZEJhY2tyZWYgPSBpc05hTihpdGVtLmJhY2tyZWYpOw0KDQogICAgICAgIGlmIChpc05hbWVkQmFja3JlZiAmJiBYUmVnRXhwLmlzSW5zdGFsbGVkKCduYW1lc3BhY2luZycpKSB7DQogICAgICAgICAgLy8gYGdyb3Vwc2AgaGFzIGBudWxsYCBhcyBwcm90b3R5cGUsIHNvIHVzaW5nIGBpbmAgaW5zdGVhZCBvZiBgaGFzT3duUHJvcGVydHlgDQogICAgICAgICAgaWYgKCEoaXRlbS5iYWNrcmVmIGluIG1hdGNoLmdyb3VwcykpIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihFUlJfVU5ERUZJTkVEX0dST1VQKTsNCiAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSBpZiAoIW1hdGNoLmhhc093blByb3BlcnR5KGl0ZW0uYmFja3JlZikpIHsNCiAgICAgICAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoRVJSX1VOREVGSU5FRF9HUk9VUCk7DQogICAgICAgIH0NCg0KICAgICAgICB2YXIgYmFja3JlZlZhbHVlID0gaXNOYW1lZEJhY2tyZWYgJiYgWFJlZ0V4cC5pc0luc3RhbGxlZCgnbmFtZXNwYWNpbmcnKSA/IG1hdGNoLmdyb3Vwc1tpdGVtLmJhY2tyZWZdIDogbWF0Y2hbaXRlbS5iYWNrcmVmXTsNCiAgICAgICAgbWF0Y2hlcy5wdXNoKGJhY2tyZWZWYWx1ZSB8fCAnJyk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBtYXRjaGVzLnB1c2gobWF0Y2hbMF0pOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IHRydWU7DQogICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMyA9IGZhbHNlOw0KICAgIHZhciBfaXRlcmF0b3JFcnJvcjMgPSB1bmRlZmluZWQ7DQoNCiAgICB0cnkgew0KICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMyA9IHZhbHVlc1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMzsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IChfc3RlcDMgPSBfaXRlcmF0b3IzLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zID0gdHJ1ZSkgew0KICAgICAgICB2YXIgdmFsdWUgPSBfc3RlcDMudmFsdWU7DQogICAgICAgIFhSZWdFeHAuZm9yRWFjaCh2YWx1ZSwgaXRlbS5yZWdleCwgYWRkTWF0Y2gpOw0KICAgICAgfQ0KICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IzID0gdHJ1ZTsNCiAgICAgIF9pdGVyYXRvckVycm9yMyA9IGVycjsNCiAgICB9IGZpbmFsbHkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyAmJiBfaXRlcmF0b3IzLnJldHVybiAhPSBudWxsKSB7DQogICAgICAgICAgX2l0ZXJhdG9yMy5yZXR1cm4oKTsNCiAgICAgICAgfQ0KICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yMykgew0KICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMzsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiBsZXZlbCA9PT0gY2hhaW4ubGVuZ3RoIC0gMSB8fCAhbWF0Y2hlcy5sZW5ndGggPyBtYXRjaGVzIDogcmVjdXJzZUNoYWluKG1hdGNoZXMsIGxldmVsICsgMSk7DQogIH0oW3N0cl0sIDApOw0KfTsNCi8qKg0KICogUmV0dXJucyBhIG5ldyBzdHJpbmcgd2l0aCBvbmUgb3IgYWxsIG1hdGNoZXMgb2YgYSBwYXR0ZXJuIHJlcGxhY2VkLiBUaGUgcGF0dGVybiBjYW4gYmUgYSBzdHJpbmcNCiAqIG9yIHJlZ2V4LCBhbmQgdGhlIHJlcGxhY2VtZW50IGNhbiBiZSBhIHN0cmluZyBvciBhIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBmb3IgZWFjaCBtYXRjaC4gVG8NCiAqIHBlcmZvcm0gYSBnbG9iYWwgc2VhcmNoIGFuZCByZXBsYWNlLCB1c2UgdGhlIG9wdGlvbmFsIGBzY29wZWAgYXJndW1lbnQgb3IgaW5jbHVkZSBmbGFnIGcgaWYgdXNpbmcNCiAqIGEgcmVnZXguIFJlcGxhY2VtZW50IHN0cmluZ3MgY2FuIHVzZSBgJHtufWAgb3IgYCQ8bj5gIGZvciBuYW1lZCBhbmQgbnVtYmVyZWQgYmFja3JlZmVyZW5jZXMuDQogKiBSZXBsYWNlbWVudCBmdW5jdGlvbnMgY2FuIHVzZSBuYW1lZCBiYWNrcmVmZXJlbmNlcyB2aWEgYGFyZ3VtZW50c1swXS5uYW1lYC4gQWxzbyBmaXhlcyBicm93c2VyDQogKiBidWdzIGNvbXBhcmVkIHRvIHRoZSBuYXRpdmUgYFN0cmluZy5wcm90b3R5cGUucmVwbGFjZWAgYW5kIGNhbiBiZSB1c2VkIHJlbGlhYmx5IGNyb3NzLWJyb3dzZXIuDQogKg0KICogQG1lbWJlck9mIFhSZWdFeHANCiAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgU3RyaW5nIHRvIHNlYXJjaC4NCiAqIEBwYXJhbSB7UmVnRXhwfFN0cmluZ30gc2VhcmNoIFNlYXJjaCBwYXR0ZXJuIHRvIGJlIHJlcGxhY2VkLg0KICogQHBhcmFtIHtTdHJpbmd8RnVuY3Rpb259IHJlcGxhY2VtZW50IFJlcGxhY2VtZW50IHN0cmluZyBvciBhIGZ1bmN0aW9uIGludm9rZWQgdG8gY3JlYXRlIGl0Lg0KICogICBSZXBsYWNlbWVudCBzdHJpbmdzIGNhbiBpbmNsdWRlIHNwZWNpYWwgcmVwbGFjZW1lbnQgc3ludGF4Og0KICogICAgIC0gJCQgLSBJbnNlcnRzIGEgbGl0ZXJhbCAkIGNoYXJhY3Rlci4NCiAqICAgICAtICQmLCAkMCAtIEluc2VydHMgdGhlIG1hdGNoZWQgc3Vic3RyaW5nLg0KICogICAgIC0gJGAgLSBJbnNlcnRzIHRoZSBzdHJpbmcgdGhhdCBwcmVjZWRlcyB0aGUgbWF0Y2hlZCBzdWJzdHJpbmcgKGxlZnQgY29udGV4dCkuDQogKiAgICAgLSAkJyAtIEluc2VydHMgdGhlIHN0cmluZyB0aGF0IGZvbGxvd3MgdGhlIG1hdGNoZWQgc3Vic3RyaW5nIChyaWdodCBjb250ZXh0KS4NCiAqICAgICAtICRuLCAkbm4gLSBXaGVyZSBuL25uIGFyZSBkaWdpdHMgcmVmZXJlbmNpbmcgYW4gZXhpc3RlbnQgY2FwdHVyaW5nIGdyb3VwLCBpbnNlcnRzDQogKiAgICAgICBiYWNrcmVmZXJlbmNlIG4vbm4uDQogKiAgICAgLSAke259LCAkPG4+IC0gV2hlcmUgbiBpcyBhIG5hbWUgb3IgYW55IG51bWJlciBvZiBkaWdpdHMgdGhhdCByZWZlcmVuY2UgYW4gZXhpc3RlbnQgY2FwdHVyaW5nDQogKiAgICAgICBncm91cCwgaW5zZXJ0cyBiYWNrcmVmZXJlbmNlIG4uDQogKiAgIFJlcGxhY2VtZW50IGZ1bmN0aW9ucyBhcmUgaW52b2tlZCB3aXRoIHRocmVlIG9yIG1vcmUgYXJndW1lbnRzOg0KICogICAgIC0gVGhlIG1hdGNoZWQgc3Vic3RyaW5nIChjb3JyZXNwb25kcyB0byAkJiBhYm92ZSkuIE5hbWVkIGJhY2tyZWZlcmVuY2VzIGFyZSBhY2Nlc3NpYmxlIGFzDQogKiAgICAgICBwcm9wZXJ0aWVzIG9mIHRoaXMgZmlyc3QgYXJndW1lbnQuDQogKiAgICAgLSAwLi5uIGFyZ3VtZW50cywgb25lIGZvciBlYWNoIGJhY2tyZWZlcmVuY2UgKGNvcnJlc3BvbmRpbmcgdG8gJDEsICQyLCBldGMuIGFib3ZlKS4NCiAqICAgICAtIFRoZSB6ZXJvLWJhc2VkIGluZGV4IG9mIHRoZSBtYXRjaCB3aXRoaW4gdGhlIHRvdGFsIHNlYXJjaCBzdHJpbmcuDQogKiAgICAgLSBUaGUgdG90YWwgc3RyaW5nIGJlaW5nIHNlYXJjaGVkLg0KICogQHBhcmFtIHtTdHJpbmd9IFtzY29wZT0nb25lJ10gVXNlICdvbmUnIHRvIHJlcGxhY2UgdGhlIGZpcnN0IG1hdGNoIG9ubHksIG9yICdhbGwnLiBJZiBub3QNCiAqICAgZXhwbGljaXRseSBzcGVjaWZpZWQgYW5kIHVzaW5nIGEgcmVnZXggd2l0aCBmbGFnIGcsIGBzY29wZWAgaXMgJ2FsbCcuDQogKiBAcmV0dXJucyB7U3RyaW5nfSBOZXcgc3RyaW5nIHdpdGggb25lIG9yIGFsbCBtYXRjaGVzIHJlcGxhY2VkLg0KICogQGV4YW1wbGUNCiAqDQogKiAvLyBSZWdleCBzZWFyY2gsIHVzaW5nIG5hbWVkIGJhY2tyZWZlcmVuY2VzIGluIHJlcGxhY2VtZW50IHN0cmluZw0KICogY29uc3QgbmFtZSA9IFhSZWdFeHAoJyg/PGZpcnN0PlxcdyspICg/PGxhc3Q+XFx3KyknKTsNCiAqIFhSZWdFeHAucmVwbGFjZSgnSm9obiBTbWl0aCcsIG5hbWUsICckPGxhc3Q+LCAkPGZpcnN0PicpOw0KICogLy8gLT4gJ1NtaXRoLCBKb2huJw0KICoNCiAqIC8vIFJlZ2V4IHNlYXJjaCwgdXNpbmcgbmFtZWQgYmFja3JlZmVyZW5jZXMgaW4gcmVwbGFjZW1lbnQgZnVuY3Rpb24NCiAqIFhSZWdFeHAucmVwbGFjZSgnSm9obiBTbWl0aCcsIG5hbWUsIChtYXRjaCkgPT4gYCR7bWF0Y2gubGFzdH0sICR7bWF0Y2guZmlyc3R9YCk7DQogKiAvLyAtPiAnU21pdGgsIEpvaG4nDQogKg0KICogLy8gU3RyaW5nIHNlYXJjaCwgd2l0aCByZXBsYWNlLWFsbA0KICogWFJlZ0V4cC5yZXBsYWNlKCdSZWdFeHAgYnVpbGRzIFJlZ0V4cHMnLCAnUmVnRXhwJywgJ1hSZWdFeHAnLCAnYWxsJyk7DQogKiAvLyAtPiAnWFJlZ0V4cCBidWlsZHMgWFJlZ0V4cHMnDQogKi8NCg0KDQpYUmVnRXhwLnJlcGxhY2UgPSBmdW5jdGlvbiAoc3RyLCBzZWFyY2gsIHJlcGxhY2VtZW50LCBzY29wZSkgew0KICB2YXIgaXNSZWdleCA9IFhSZWdFeHAuaXNSZWdFeHAoc2VhcmNoKTsNCiAgdmFyIGdsb2JhbCA9IHNlYXJjaC5nbG9iYWwgJiYgc2NvcGUgIT09ICdvbmUnIHx8IHNjb3BlID09PSAnYWxsJzsNCiAgdmFyIGNhY2hlS2V5ID0gKGdsb2JhbCA/ICdnJyA6ICcnKSArIChzZWFyY2guc3RpY2t5ID8gJ3knIDogJycpIHx8ICdub0dZJzsNCiAgdmFyIHMyID0gc2VhcmNoOw0KDQogIGlmIChpc1JlZ2V4KSB7DQogICAgc2VhcmNoW1JFR0VYX0RBVEFdID0gc2VhcmNoW1JFR0VYX0RBVEFdIHx8IHt9OyAvLyBTaGFyZXMgY2FjaGVkIGNvcGllcyB3aXRoIGBYUmVnRXhwLmV4ZWNgL2BtYXRjaGAuIFNpbmNlIGEgY29weSBpcyB1c2VkLCBgc2VhcmNoYCdzDQogICAgLy8gYGxhc3RJbmRleGAgaXNuJ3QgdXBkYXRlZCAqZHVyaW5nKiByZXBsYWNlbWVudCBpdGVyYXRpb25zDQoNCiAgICBzMiA9IHNlYXJjaFtSRUdFWF9EQVRBXVtjYWNoZUtleV0gfHwgKHNlYXJjaFtSRUdFWF9EQVRBXVtjYWNoZUtleV0gPSBjb3B5UmVnZXgoc2VhcmNoLCB7DQogICAgICBhZGRHOiAhIWdsb2JhbCwNCiAgICAgIHJlbW92ZUc6IHNjb3BlID09PSAnb25lJywNCiAgICAgIGlzSW50ZXJuYWxPbmx5OiB0cnVlDQogICAgfSkpOw0KICB9IGVsc2UgaWYgKGdsb2JhbCkgew0KICAgIHMyID0gbmV3IFJlZ0V4cChYUmVnRXhwLmVzY2FwZShTdHJpbmcoc2VhcmNoKSksICdnJyk7DQogIH0gLy8gRml4ZWQgYHJlcGxhY2VgIHJlcXVpcmVkIGZvciBuYW1lZCBiYWNrcmVmZXJlbmNlcywgZXRjLg0KDQoNCiAgdmFyIHJlc3VsdCA9IGZpeGVkLnJlcGxhY2UuY2FsbCh0b09iamVjdChzdHIpLCBzMiwgcmVwbGFjZW1lbnQpOw0KDQogIGlmIChpc1JlZ2V4ICYmIHNlYXJjaC5nbG9iYWwpIHsNCiAgICAvLyBGaXhlcyBJRSwgU2FmYXJpIGJ1ZyAobGFzdCB0ZXN0ZWQgSUUgOSwgU2FmYXJpIDUuMSkNCiAgICBzZWFyY2gubGFzdEluZGV4ID0gMDsNCiAgfQ0KDQogIHJldHVybiByZXN1bHQ7DQp9Ow0KLyoqDQogKiBQZXJmb3JtcyBiYXRjaCBwcm9jZXNzaW5nIG9mIHN0cmluZyByZXBsYWNlbWVudHMuIFVzZWQgbGlrZSBgWFJlZ0V4cC5yZXBsYWNlYCwgYnV0IGFjY2VwdHMgYW4NCiAqIGFycmF5IG9mIHJlcGxhY2VtZW50IGRldGFpbHMuIExhdGVyIHJlcGxhY2VtZW50cyBvcGVyYXRlIG9uIHRoZSBvdXRwdXQgb2YgZWFybGllciByZXBsYWNlbWVudHMuDQogKiBSZXBsYWNlbWVudCBkZXRhaWxzIGFyZSBhY2NlcHRlZCBhcyBhbiBhcnJheSB3aXRoIGEgcmVnZXggb3Igc3RyaW5nIHRvIHNlYXJjaCBmb3IsIHRoZQ0KICogcmVwbGFjZW1lbnQgc3RyaW5nIG9yIGZ1bmN0aW9uLCBhbmQgYW4gb3B0aW9uYWwgc2NvcGUgb2YgJ29uZScgb3IgJ2FsbCcuIFVzZXMgdGhlIFhSZWdFeHANCiAqIHJlcGxhY2VtZW50IHRleHQgc3ludGF4LCB3aGljaCBzdXBwb3J0cyBuYW1lZCBiYWNrcmVmZXJlbmNlIHByb3BlcnRpZXMgdmlhIGAke25hbWV9YCBvcg0KICogYCQ8bmFtZT5gLg0KICoNCiAqIEBtZW1iZXJPZiBYUmVnRXhwDQogKiBAcGFyYW0ge1N0cmluZ30gc3RyIFN0cmluZyB0byBzZWFyY2guDQogKiBAcGFyYW0ge0FycmF5fSByZXBsYWNlbWVudHMgQXJyYXkgb2YgcmVwbGFjZW1lbnQgZGV0YWlsIGFycmF5cy4NCiAqIEByZXR1cm5zIHtTdHJpbmd9IE5ldyBzdHJpbmcgd2l0aCBhbGwgcmVwbGFjZW1lbnRzLg0KICogQGV4YW1wbGUNCiAqDQogKiBzdHIgPSBYUmVnRXhwLnJlcGxhY2VFYWNoKHN0ciwgWw0KICogICBbWFJlZ0V4cCgnKD88bmFtZT5hKScpLCAneiR7bmFtZX0nXSwNCiAqICAgWy9iL2dpLCAneSddLA0KICogICBbL2MvZywgJ3gnLCAnb25lJ10sIC8vIHNjb3BlICdvbmUnIG92ZXJyaWRlcyAvZw0KICogICBbL2QvLCAndycsICdhbGwnXSwgIC8vIHNjb3BlICdhbGwnIG92ZXJyaWRlcyBsYWNrIG9mIC9nDQogKiAgIFsnZScsICd2JywgJ2FsbCddLCAgLy8gc2NvcGUgJ2FsbCcgYWxsb3dzIHJlcGxhY2UtYWxsIGZvciBzdHJpbmdzDQogKiAgIFsvZi9nLCAoJDApID0+ICQwLnRvVXBwZXJDYXNlKCldDQogKiBdKTsNCiAqLw0KDQoNClhSZWdFeHAucmVwbGFjZUVhY2ggPSBmdW5jdGlvbiAoc3RyLCByZXBsYWNlbWVudHMpIHsNCiAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb240ID0gdHJ1ZTsNCiAgdmFyIF9kaWRJdGVyYXRvckVycm9yNCA9IGZhbHNlOw0KICB2YXIgX2l0ZXJhdG9yRXJyb3I0ID0gdW5kZWZpbmVkOw0KDQogIHRyeSB7DQogICAgZm9yICh2YXIgX2l0ZXJhdG9yNCA9IHJlcGxhY2VtZW50c1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwNDsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCA9IChfc3RlcDQgPSBfaXRlcmF0b3I0Lm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb240ID0gdHJ1ZSkgew0KICAgICAgdmFyIHIgPSBfc3RlcDQudmFsdWU7DQogICAgICBzdHIgPSBYUmVnRXhwLnJlcGxhY2Uoc3RyLCByWzBdLCByWzFdLCByWzJdKTsNCiAgICB9DQogIH0gY2F0Y2ggKGVycikgew0KICAgIF9kaWRJdGVyYXRvckVycm9yNCA9IHRydWU7DQogICAgX2l0ZXJhdG9yRXJyb3I0ID0gZXJyOw0KICB9IGZpbmFsbHkgew0KICAgIHRyeSB7DQogICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb240ICYmIF9pdGVyYXRvcjQucmV0dXJuICE9IG51bGwpIHsNCiAgICAgICAgX2l0ZXJhdG9yNC5yZXR1cm4oKTsNCiAgICAgIH0NCiAgICB9IGZpbmFsbHkgew0KICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yNCkgew0KICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjQ7DQogICAgICB9DQogICAgfQ0KICB9DQoNCiAgcmV0dXJuIHN0cjsNCn07DQovKioNCiAqIFNwbGl0cyBhIHN0cmluZyBpbnRvIGFuIGFycmF5IG9mIHN0cmluZ3MgdXNpbmcgYSByZWdleCBvciBzdHJpbmcgc2VwYXJhdG9yLiBNYXRjaGVzIG9mIHRoZQ0KICogc2VwYXJhdG9yIGFyZSBub3QgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdCBhcnJheS4gSG93ZXZlciwgaWYgYHNlcGFyYXRvcmAgaXMgYSByZWdleCB0aGF0IGNvbnRhaW5zDQogKiBjYXB0dXJpbmcgZ3JvdXBzLCBiYWNrcmVmZXJlbmNlcyBhcmUgc3BsaWNlZCBpbnRvIHRoZSByZXN1bHQgZWFjaCB0aW1lIGBzZXBhcmF0b3JgIGlzIG1hdGNoZWQuDQogKiBGaXhlcyBicm93c2VyIGJ1Z3MgY29tcGFyZWQgdG8gdGhlIG5hdGl2ZSBgU3RyaW5nLnByb3RvdHlwZS5zcGxpdGAgYW5kIGNhbiBiZSB1c2VkIHJlbGlhYmx5DQogKiBjcm9zcy1icm93c2VyLg0KICoNCiAqIEBtZW1iZXJPZiBYUmVnRXhwDQogKiBAcGFyYW0ge1N0cmluZ30gc3RyIFN0cmluZyB0byBzcGxpdC4NCiAqIEBwYXJhbSB7UmVnRXhwfFN0cmluZ30gc2VwYXJhdG9yIFJlZ2V4IG9yIHN0cmluZyB0byB1c2UgZm9yIHNlcGFyYXRpbmcgdGhlIHN0cmluZy4NCiAqIEBwYXJhbSB7TnVtYmVyfSBbbGltaXRdIE1heGltdW0gbnVtYmVyIG9mIGl0ZW1zIHRvIGluY2x1ZGUgaW4gdGhlIHJlc3VsdCBhcnJheS4NCiAqIEByZXR1cm5zIHtBcnJheX0gQXJyYXkgb2Ygc3Vic3RyaW5ncy4NCiAqIEBleGFtcGxlDQogKg0KICogLy8gQmFzaWMgdXNlDQogKiBYUmVnRXhwLnNwbGl0KCdhIGIgYycsICcgJyk7DQogKiAvLyAtPiBbJ2EnLCAnYicsICdjJ10NCiAqDQogKiAvLyBXaXRoIGxpbWl0DQogKiBYUmVnRXhwLnNwbGl0KCdhIGIgYycsICcgJywgMik7DQogKiAvLyAtPiBbJ2EnLCAnYiddDQogKg0KICogLy8gQmFja3JlZmVyZW5jZXMgaW4gcmVzdWx0IGFycmF5DQogKiBYUmVnRXhwLnNwbGl0KCcuLndvcmQxLi4nLCAvKFthLXpdKykoXGQrKS9pKTsNCiAqIC8vIC0+IFsnLi4nLCAnd29yZCcsICcxJywgJy4uJ10NCiAqLw0KDQoNClhSZWdFeHAuc3BsaXQgPSBmdW5jdGlvbiAoc3RyLCBzZXBhcmF0b3IsIGxpbWl0KSB7DQogIHJldHVybiBmaXhlZC5zcGxpdC5jYWxsKHRvT2JqZWN0KHN0ciksIHNlcGFyYXRvciwgbGltaXQpOw0KfTsNCi8qKg0KICogRXhlY3V0ZXMgYSByZWdleCBzZWFyY2ggaW4gYSBzcGVjaWZpZWQgc3RyaW5nLiBSZXR1cm5zIGB0cnVlYCBvciBgZmFsc2VgLiBPcHRpb25hbCBgcG9zYCBhbmQNCiAqIGBzdGlja3lgIGFyZ3VtZW50cyBzcGVjaWZ5IHRoZSBzZWFyY2ggc3RhcnQgcG9zaXRpb24sIGFuZCB3aGV0aGVyIHRoZSBtYXRjaCBtdXN0IHN0YXJ0IGF0IHRoZQ0KICogc3BlY2lmaWVkIHBvc2l0aW9uIG9ubHkuIFRoZSBgbGFzdEluZGV4YCBwcm9wZXJ0eSBvZiB0aGUgcHJvdmlkZWQgcmVnZXggaXMgbm90IHVzZWQsIGJ1dCBpcw0KICogdXBkYXRlZCBmb3IgY29tcGF0aWJpbGl0eS4gQWxzbyBmaXhlcyBicm93c2VyIGJ1Z3MgY29tcGFyZWQgdG8gdGhlIG5hdGl2ZQ0KICogYFJlZ0V4cC5wcm90b3R5cGUudGVzdGAgYW5kIGNhbiBiZSB1c2VkIHJlbGlhYmx5IGNyb3NzLWJyb3dzZXIuDQogKg0KICogQG1lbWJlck9mIFhSZWdFeHANCiAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgU3RyaW5nIHRvIHNlYXJjaC4NCiAqIEBwYXJhbSB7UmVnRXhwfSByZWdleCBSZWdleCB0byBzZWFyY2ggd2l0aC4NCiAqIEBwYXJhbSB7TnVtYmVyfSBbcG9zPTBdIFplcm8tYmFzZWQgaW5kZXggYXQgd2hpY2ggdG8gc3RhcnQgdGhlIHNlYXJjaC4NCiAqIEBwYXJhbSB7Qm9vbGVhbnxTdHJpbmd9IFtzdGlja3k9ZmFsc2VdIFdoZXRoZXIgdGhlIG1hdGNoIG11c3Qgc3RhcnQgYXQgdGhlIHNwZWNpZmllZCBwb3NpdGlvbg0KICogICBvbmx5LiBUaGUgc3RyaW5nIGAnc3RpY2t5J2AgaXMgYWNjZXB0ZWQgYXMgYW4gYWx0ZXJuYXRpdmUgdG8gYHRydWVgLg0KICogQHJldHVybnMge0Jvb2xlYW59IFdoZXRoZXIgdGhlIHJlZ2V4IG1hdGNoZWQgdGhlIHByb3ZpZGVkIHZhbHVlLg0KICogQGV4YW1wbGUNCiAqDQogKiAvLyBCYXNpYyB1c2UNCiAqIFhSZWdFeHAudGVzdCgnYWJjJywgL2MvKTsgLy8gLT4gdHJ1ZQ0KICoNCiAqIC8vIFdpdGggcG9zIGFuZCBzdGlja3kNCiAqIFhSZWdFeHAudGVzdCgnYWJjJywgL2MvLCAwLCAnc3RpY2t5Jyk7IC8vIC0+IGZhbHNlDQogKiBYUmVnRXhwLnRlc3QoJ2FiYycsIC9jLywgMiwgJ3N0aWNreScpOyAvLyAtPiB0cnVlDQogKi8NCi8vIERvIHRoaXMgdGhlIGVhc3kgd2F5IDotKQ0KDQoNClhSZWdFeHAudGVzdCA9IGZ1bmN0aW9uIChzdHIsIHJlZ2V4LCBwb3MsIHN0aWNreSkgew0KICByZXR1cm4gISFYUmVnRXhwLmV4ZWMoc3RyLCByZWdleCwgcG9zLCBzdGlja3kpOw0KfTsNCi8qKg0KICogVW5pbnN0YWxscyBvcHRpb25hbCBmZWF0dXJlcyBhY2NvcmRpbmcgdG8gdGhlIHNwZWNpZmllZCBvcHRpb25zLiBBbGwgb3B0aW9uYWwgZmVhdHVyZXMgc3RhcnQgb3V0DQogKiB1bmluc3RhbGxlZCwgc28gdGhpcyBpcyB1c2VkIHRvIHVuZG8gdGhlIGFjdGlvbnMgb2YgYFhSZWdFeHAuaW5zdGFsbGAuDQogKg0KICogQG1lbWJlck9mIFhSZWdFeHANCiAqIEBwYXJhbSB7T2JqZWN0fFN0cmluZ30gb3B0aW9ucyBPcHRpb25zIG9iamVjdCBvciBzdHJpbmcuDQogKiBAZXhhbXBsZQ0KICoNCiAqIC8vIFdpdGggYW4gb3B0aW9ucyBvYmplY3QNCiAqIFhSZWdFeHAudW5pbnN0YWxsKHsNCiAqICAgLy8gRGlzYWJsZXMgc3VwcG9ydCBmb3IgYXN0cmFsIGNvZGUgcG9pbnRzIGluIFVuaWNvZGUgYWRkb25zDQogKiAgIGFzdHJhbDogdHJ1ZSwNCiAqDQogKiAgIC8vIERvbid0IGFkZCBuYW1lZCBjYXB0dXJlIGdyb3VwcyB0byB0aGUgYGdyb3Vwc2AgcHJvcGVydHkgb2YgbWF0Y2hlcw0KICogICBuYW1lc3BhY2luZzogdHJ1ZQ0KICogfSk7DQogKg0KICogLy8gV2l0aCBhbiBvcHRpb25zIHN0cmluZw0KICogWFJlZ0V4cC51bmluc3RhbGwoJ2FzdHJhbCBuYW1lc3BhY2luZycpOw0KICovDQoNCg0KWFJlZ0V4cC51bmluc3RhbGwgPSBmdW5jdGlvbiAob3B0aW9ucykgew0KICBvcHRpb25zID0gcHJlcGFyZU9wdGlvbnMob3B0aW9ucyk7DQoNCiAgaWYgKGZlYXR1cmVzLmFzdHJhbCAmJiBvcHRpb25zLmFzdHJhbCkgew0KICAgIHNldEFzdHJhbChmYWxzZSk7DQogIH0NCg0KICBpZiAoZmVhdHVyZXMubmFtZXNwYWNpbmcgJiYgb3B0aW9ucy5uYW1lc3BhY2luZykgew0KICAgIHNldE5hbWVzcGFjaW5nKGZhbHNlKTsNCiAgfQ0KfTsNCi8qKg0KICogUmV0dXJucyBhbiBYUmVnRXhwIG9iamVjdCB0aGF0IGlzIHRoZSB1bmlvbiBvZiB0aGUgZ2l2ZW4gcGF0dGVybnMuIFBhdHRlcm5zIGNhbiBiZSBwcm92aWRlZCBhcw0KICogcmVnZXggb2JqZWN0cyBvciBzdHJpbmdzLiBNZXRhY2hhcmFjdGVycyBhcmUgZXNjYXBlZCBpbiBwYXR0ZXJucyBwcm92aWRlZCBhcyBzdHJpbmdzLg0KICogQmFja3JlZmVyZW5jZXMgaW4gcHJvdmlkZWQgcmVnZXggb2JqZWN0cyBhcmUgYXV0b21hdGljYWxseSByZW51bWJlcmVkIHRvIHdvcmsgY29ycmVjdGx5IHdpdGhpbg0KICogdGhlIGxhcmdlciBjb21iaW5lZCBwYXR0ZXJuLiBOYXRpdmUgZmxhZ3MgdXNlZCBieSBwcm92aWRlZCByZWdleGVzIGFyZSBpZ25vcmVkIGluIGZhdm9yIG9mIHRoZQ0KICogYGZsYWdzYCBhcmd1bWVudC4NCiAqDQogKiBAbWVtYmVyT2YgWFJlZ0V4cA0KICogQHBhcmFtIHtBcnJheX0gcGF0dGVybnMgUmVnZXhlcyBhbmQgc3RyaW5ncyB0byBjb21iaW5lLg0KICogQHBhcmFtIHtTdHJpbmd9IFtmbGFnc10gQW55IGNvbWJpbmF0aW9uIG9mIFhSZWdFeHAgZmxhZ3MuDQogKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIE9wdGlvbnMgb2JqZWN0IHdpdGggb3B0aW9uYWwgcHJvcGVydGllczoNCiAqICAgLSBgY29uanVuY3Rpb25gIHtTdHJpbmd9IFR5cGUgb2YgY29uanVuY3Rpb24gdG8gdXNlOiAnb3InIChkZWZhdWx0KSBvciAnbm9uZScuDQogKiBAcmV0dXJucyB7UmVnRXhwfSBVbmlvbiBvZiB0aGUgcHJvdmlkZWQgcmVnZXhlcyBhbmQgc3RyaW5ncy4NCiAqIEBleGFtcGxlDQogKg0KICogWFJlZ0V4cC51bmlvbihbJ2ErYipjJywgLyhkb2dzKVwxLywgLyhjYXRzKVwxL10sICdpJyk7DQogKiAvLyAtPiAvYVwrYlwqY3woZG9ncylcMXwoY2F0cylcMi9pDQogKg0KICogWFJlZ0V4cC51bmlvbihbL21hbi8sIC9iZWFyLywgL3BpZy9dLCAnaScsIHtjb25qdW5jdGlvbjogJ25vbmUnfSk7DQogKiAvLyAtPiAvbWFuYmVhcnBpZy9pDQogKi8NCg0KDQpYUmVnRXhwLnVuaW9uID0gZnVuY3Rpb24gKHBhdHRlcm5zLCBmbGFncywgb3B0aW9ucykgew0KICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsNCiAgdmFyIGNvbmp1bmN0aW9uID0gb3B0aW9ucy5jb25qdW5jdGlvbiB8fCAnb3InOw0KICB2YXIgbnVtQ2FwdHVyZXMgPSAwOw0KICB2YXIgbnVtUHJpb3JDYXB0dXJlczsNCiAgdmFyIGNhcHR1cmVOYW1lczsNCg0KICBmdW5jdGlvbiByZXdyaXRlKG1hdGNoLCBwYXJlbiwgYmFja3JlZikgew0KICAgIHZhciBuYW1lID0gY2FwdHVyZU5hbWVzW251bUNhcHR1cmVzIC0gbnVtUHJpb3JDYXB0dXJlc107IC8vIENhcHR1cmluZyBncm91cA0KDQogICAgaWYgKHBhcmVuKSB7DQogICAgICArK251bUNhcHR1cmVzOyAvLyBJZiB0aGUgY3VycmVudCBjYXB0dXJlIGhhcyBhIG5hbWUsIHByZXNlcnZlIHRoZSBuYW1lDQoNCiAgICAgIGlmIChuYW1lKSB7DQogICAgICAgIHJldHVybiAiKD88Ii5jb25jYXQobmFtZSwgIj4iKTsNCiAgICAgIH0gLy8gQmFja3JlZmVyZW5jZQ0KDQogICAgfSBlbHNlIGlmIChiYWNrcmVmKSB7DQogICAgICAvLyBSZXdyaXRlIHRoZSBiYWNrcmVmZXJlbmNlDQogICAgICByZXR1cm4gIlxcIi5jb25jYXQoK2JhY2tyZWYgKyBudW1QcmlvckNhcHR1cmVzKTsNCiAgICB9DQoNCiAgICByZXR1cm4gbWF0Y2g7DQogIH0NCg0KICBpZiAoIShpc1R5cGUocGF0dGVybnMsICdBcnJheScpICYmIHBhdHRlcm5zLmxlbmd0aCkpIHsNCiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdNdXN0IHByb3ZpZGUgYSBub25lbXB0eSBhcnJheSBvZiBwYXR0ZXJucyB0byBtZXJnZScpOw0KICB9DQoNCiAgdmFyIHBhcnRzID0gLyhcKCkoPyFcPyl8XFwoWzEtOV1cZCopfFxcW1xzXFNdfFxbKD86W15cXFxdXXxcXFtcc1xTXSkqXF0vZzsNCiAgdmFyIG91dHB1dCA9IFtdOw0KICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjUgPSB0cnVlOw0KICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3I1ID0gZmFsc2U7DQogIHZhciBfaXRlcmF0b3JFcnJvcjUgPSB1bmRlZmluZWQ7DQoNCiAgdHJ5IHsNCiAgICBmb3IgKHZhciBfaXRlcmF0b3I1ID0gcGF0dGVybnNbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDU7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjUgPSAoX3N0ZXA1ID0gX2l0ZXJhdG9yNS5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNSA9IHRydWUpIHsNCiAgICAgIHZhciBwYXR0ZXJuID0gX3N0ZXA1LnZhbHVlOw0KDQogICAgICBpZiAoWFJlZ0V4cC5pc1JlZ0V4cChwYXR0ZXJuKSkgew0KICAgICAgICBudW1QcmlvckNhcHR1cmVzID0gbnVtQ2FwdHVyZXM7DQogICAgICAgIGNhcHR1cmVOYW1lcyA9IHBhdHRlcm5bUkVHRVhfREFUQV0gJiYgcGF0dGVybltSRUdFWF9EQVRBXS5jYXB0dXJlTmFtZXMgfHwgW107IC8vIFJld3JpdGUgYmFja3JlZmVyZW5jZXMuIFBhc3NpbmcgdG8gWFJlZ0V4cCBkaWVzIG9uIG9jdGFscyBhbmQgZW5zdXJlcyBwYXR0ZXJucyBhcmUNCiAgICAgICAgLy8gaW5kZXBlbmRlbnRseSB2YWxpZDsgaGVscHMga2VlcCB0aGlzIHNpbXBsZS4gTmFtZWQgY2FwdHVyZXMgYXJlIHB1dCBiYWNrDQoNCiAgICAgICAgb3V0cHV0LnB1c2gobmF0aXYucmVwbGFjZS5jYWxsKFhSZWdFeHAocGF0dGVybi5zb3VyY2UpLnNvdXJjZSwgcGFydHMsIHJld3JpdGUpKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIG91dHB1dC5wdXNoKFhSZWdFeHAuZXNjYXBlKHBhdHRlcm4pKTsNCiAgICAgIH0NCiAgICB9DQogIH0gY2F0Y2ggKGVycikgew0KICAgIF9kaWRJdGVyYXRvckVycm9yNSA9IHRydWU7DQogICAgX2l0ZXJhdG9yRXJyb3I1ID0gZXJyOw0KICB9IGZpbmFsbHkgew0KICAgIHRyeSB7DQogICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb241ICYmIF9pdGVyYXRvcjUucmV0dXJuICE9IG51bGwpIHsNCiAgICAgICAgX2l0ZXJhdG9yNS5yZXR1cm4oKTsNCiAgICAgIH0NCiAgICB9IGZpbmFsbHkgew0KICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yNSkgew0KICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjU7DQogICAgICB9DQogICAgfQ0KICB9DQoNCiAgdmFyIHNlcGFyYXRvciA9IGNvbmp1bmN0aW9uID09PSAnbm9uZScgPyAnJyA6ICd8JzsNCiAgcmV0dXJuIFhSZWdFeHAob3V0cHV0LmpvaW4oc2VwYXJhdG9yKSwgZmxhZ3MpOw0KfTsgLy8gPT0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLT09DQovLyBGaXhlZC9leHRlbmRlZCBuYXRpdmUgbWV0aG9kcw0KLy8gPT0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLT09DQoNCi8qKg0KICogQWRkcyBuYW1lZCBjYXB0dXJlIHN1cHBvcnQgKHdpdGggYmFja3JlZmVyZW5jZXMgcmV0dXJuZWQgYXMgYHJlc3VsdC5uYW1lYCksIGFuZCBmaXhlcyBicm93c2VyDQogKiBidWdzIGluIHRoZSBuYXRpdmUgYFJlZ0V4cC5wcm90b3R5cGUuZXhlY2AuIFVzZSB2aWEgYFhSZWdFeHAuZXhlY2AuDQogKg0KICogQG1lbWJlck9mIFJlZ0V4cA0KICogQHBhcmFtIHtTdHJpbmd9IHN0ciBTdHJpbmcgdG8gc2VhcmNoLg0KICogQHJldHVybnMge0FycmF5fSBNYXRjaCBhcnJheSB3aXRoIG5hbWVkIGJhY2tyZWZlcmVuY2UgcHJvcGVydGllcywgb3IgYG51bGxgLg0KICovDQoNCg0KZml4ZWQuZXhlYyA9IGZ1bmN0aW9uIChzdHIpIHsNCiAgdmFyIG9yaWdMYXN0SW5kZXggPSB0aGlzLmxhc3RJbmRleDsNCiAgdmFyIG1hdGNoID0gbmF0aXYuZXhlYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOw0KDQogIGlmIChtYXRjaCkgew0KICAgIC8vIEZpeCBicm93c2VycyB3aG9zZSBgZXhlY2AgbWV0aG9kcyBkb24ndCByZXR1cm4gYHVuZGVmaW5lZGAgZm9yIG5vbnBhcnRpY2lwYXRpbmcgY2FwdHVyaW5nDQogICAgLy8gZ3JvdXBzLiBUaGlzIGZpeGVzIElFIDUuNS04LCBidXQgbm90IElFIDkncyBxdWlya3MgbW9kZSBvciBlbXVsYXRpb24gb2Ygb2xkZXIgSUVzLiBJRSA5DQogICAgLy8gaW4gc3RhbmRhcmRzIG1vZGUgZm9sbG93cyB0aGUgc3BlYy4NCiAgICBpZiAoIWNvcnJlY3RFeGVjTnBjZyAmJiBtYXRjaC5sZW5ndGggPiAxICYmIG1hdGNoLmluZGV4T2YoJycpICE9PSAtMSkgew0KICAgICAgdmFyIHIyID0gY29weVJlZ2V4KHRoaXMsIHsNCiAgICAgICAgcmVtb3ZlRzogdHJ1ZSwNCiAgICAgICAgaXNJbnRlcm5hbE9ubHk6IHRydWUNCiAgICAgIH0pOyAvLyBVc2luZyBgc3RyLnNsaWNlKG1hdGNoLmluZGV4KWAgcmF0aGVyIHRoYW4gYG1hdGNoWzBdYCBpbiBjYXNlIGxvb2thaGVhZCBhbGxvd2VkDQogICAgICAvLyBtYXRjaGluZyBkdWUgdG8gY2hhcmFjdGVycyBvdXRzaWRlIHRoZSBtYXRjaA0KDQogICAgICBuYXRpdi5yZXBsYWNlLmNhbGwoU3RyaW5nKHN0cikuc2xpY2UobWF0Y2guaW5kZXgpLCByMiwgZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgLy8gU2tpcCBpbmRleCAwIGFuZCB0aGUgbGFzdCAyDQoNCiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW4gLSAyOyArK2kpIHsNCiAgICAgICAgICBpZiAoKGkgPCAwIHx8IGFyZ3VtZW50cy5sZW5ndGggPD0gaSA/IHVuZGVmaW5lZCA6IGFyZ3VtZW50c1tpXSkgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgbWF0Y2hbaV0gPSB1bmRlZmluZWQ7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9IC8vIEF0dGFjaCBuYW1lZCBjYXB0dXJlIHByb3BlcnRpZXMNCg0KDQogICAgdmFyIGdyb3Vwc09iamVjdCA9IG1hdGNoOw0KDQogICAgaWYgKFhSZWdFeHAuaXNJbnN0YWxsZWQoJ25hbWVzcGFjaW5nJykpIHsNCiAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vcHJvcG9zYWwtcmVnZXhwLW5hbWVkLWdyb3Vwcy8jc2VjLXJlZ2V4cGJ1aWx0aW5leGVjDQogICAgICBtYXRjaC5ncm91cHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOw0KICAgICAgZ3JvdXBzT2JqZWN0ID0gbWF0Y2guZ3JvdXBzOw0KICAgIH0NCg0KICAgIGlmICh0aGlzW1JFR0VYX0RBVEFdICYmIHRoaXNbUkVHRVhfREFUQV0uY2FwdHVyZU5hbWVzKSB7DQogICAgICAvLyBTa2lwIGluZGV4IDANCiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbWF0Y2gubGVuZ3RoOyArK2kpIHsNCiAgICAgICAgdmFyIG5hbWUgPSB0aGlzW1JFR0VYX0RBVEFdLmNhcHR1cmVOYW1lc1tpIC0gMV07DQoNCiAgICAgICAgaWYgKG5hbWUpIHsNCiAgICAgICAgICBncm91cHNPYmplY3RbbmFtZV0gPSBtYXRjaFtpXTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0gLy8gRml4IGJyb3dzZXJzIHRoYXQgaW5jcmVtZW50IGBsYXN0SW5kZXhgIGFmdGVyIHplcm8tbGVuZ3RoIG1hdGNoZXMNCg0KDQogICAgaWYgKHRoaXMuZ2xvYmFsICYmICFtYXRjaFswXS5sZW5ndGggJiYgdGhpcy5sYXN0SW5kZXggPiBtYXRjaC5pbmRleCkgew0KICAgICAgdGhpcy5sYXN0SW5kZXggPSBtYXRjaC5pbmRleDsNCiAgICB9DQogIH0NCg0KICBpZiAoIXRoaXMuZ2xvYmFsKSB7DQogICAgLy8gRml4ZXMgSUUsIE9wZXJhIGJ1ZyAobGFzdCB0ZXN0ZWQgSUUgOSwgT3BlcmEgMTEuNikNCiAgICB0aGlzLmxhc3RJbmRleCA9IG9yaWdMYXN0SW5kZXg7DQogIH0NCg0KICByZXR1cm4gbWF0Y2g7DQp9Ow0KLyoqDQogKiBGaXhlcyBicm93c2VyIGJ1Z3MgaW4gdGhlIG5hdGl2ZSBgUmVnRXhwLnByb3RvdHlwZS50ZXN0YC4NCiAqDQogKiBAbWVtYmVyT2YgUmVnRXhwDQogKiBAcGFyYW0ge1N0cmluZ30gc3RyIFN0cmluZyB0byBzZWFyY2guDQogKiBAcmV0dXJucyB7Qm9vbGVhbn0gV2hldGhlciB0aGUgcmVnZXggbWF0Y2hlZCB0aGUgcHJvdmlkZWQgdmFsdWUuDQogKi8NCg0KDQpmaXhlZC50ZXN0ID0gZnVuY3Rpb24gKHN0cikgew0KICAvLyBEbyB0aGlzIHRoZSBlYXN5IHdheSA6LSkNCiAgcmV0dXJuICEhZml4ZWQuZXhlYy5jYWxsKHRoaXMsIHN0cik7DQp9Ow0KLyoqDQogKiBBZGRzIG5hbWVkIGNhcHR1cmUgc3VwcG9ydCAod2l0aCBiYWNrcmVmZXJlbmNlcyByZXR1cm5lZCBhcyBgcmVzdWx0Lm5hbWVgKSwgYW5kIGZpeGVzIGJyb3dzZXINCiAqIGJ1Z3MgaW4gdGhlIG5hdGl2ZSBgU3RyaW5nLnByb3RvdHlwZS5tYXRjaGAuDQogKg0KICogQG1lbWJlck9mIFN0cmluZw0KICogQHBhcmFtIHtSZWdFeHB8Kn0gcmVnZXggUmVnZXggdG8gc2VhcmNoIHdpdGguIElmIG5vdCBhIHJlZ2V4IG9iamVjdCwgaXQgaXMgcGFzc2VkIHRvIGBSZWdFeHBgLg0KICogQHJldHVybnMge0FycmF5fSBJZiBgcmVnZXhgIHVzZXMgZmxhZyBnLCBhbiBhcnJheSBvZiBtYXRjaCBzdHJpbmdzIG9yIGBudWxsYC4gV2l0aG91dCBmbGFnIGcsDQogKiAgIHRoZSByZXN1bHQgb2YgY2FsbGluZyBgcmVnZXguZXhlYyh0aGlzKWAuDQogKi8NCg0KDQpmaXhlZC5tYXRjaCA9IGZ1bmN0aW9uIChyZWdleCkgew0KICBpZiAoIVhSZWdFeHAuaXNSZWdFeHAocmVnZXgpKSB7DQogICAgLy8gVXNlIHRoZSBuYXRpdmUgYFJlZ0V4cGAgcmF0aGVyIHRoYW4gYFhSZWdFeHBgDQogICAgcmVnZXggPSBuZXcgUmVnRXhwKHJlZ2V4KTsNCiAgfSBlbHNlIGlmIChyZWdleC5nbG9iYWwpIHsNCiAgICB2YXIgcmVzdWx0ID0gbmF0aXYubWF0Y2guYXBwbHkodGhpcywgYXJndW1lbnRzKTsgLy8gRml4ZXMgSUUgYnVnDQoNCiAgICByZWdleC5sYXN0SW5kZXggPSAwOw0KICAgIHJldHVybiByZXN1bHQ7DQogIH0NCg0KICByZXR1cm4gZml4ZWQuZXhlYy5jYWxsKHJlZ2V4LCB0b09iamVjdCh0aGlzKSk7DQp9Ow0KLyoqDQogKiBBZGRzIHN1cHBvcnQgZm9yIGAke259YCAob3IgYCQ8bj5gKSB0b2tlbnMgZm9yIG5hbWVkIGFuZCBudW1iZXJlZCBiYWNrcmVmZXJlbmNlcyBpbiByZXBsYWNlbWVudA0KICogdGV4dCwgYW5kIHByb3ZpZGVzIG5hbWVkIGJhY2tyZWZlcmVuY2VzIHRvIHJlcGxhY2VtZW50IGZ1bmN0aW9ucyBhcyBgYXJndW1lbnRzWzBdLm5hbWVgLiBBbHNvDQogKiBmaXhlcyBicm93c2VyIGJ1Z3MgaW4gcmVwbGFjZW1lbnQgdGV4dCBzeW50YXggd2hlbiBwZXJmb3JtaW5nIGEgcmVwbGFjZW1lbnQgdXNpbmcgYSBub25yZWdleA0KICogc2VhcmNoIHZhbHVlLCBhbmQgdGhlIHZhbHVlIG9mIGEgcmVwbGFjZW1lbnQgcmVnZXgncyBgbGFzdEluZGV4YCBwcm9wZXJ0eSBkdXJpbmcgcmVwbGFjZW1lbnQNCiAqIGl0ZXJhdGlvbnMgYW5kIHVwb24gY29tcGxldGlvbi4gTm90ZSB0aGF0IHRoaXMgZG9lc24ndCBzdXBwb3J0IFNwaWRlck1vbmtleSdzIHByb3ByaWV0YXJ5IHRoaXJkDQogKiAoYGZsYWdzYCkgYXJndW1lbnQuIFVzZSB2aWEgYFhSZWdFeHAucmVwbGFjZWAuDQogKg0KICogQG1lbWJlck9mIFN0cmluZw0KICogQHBhcmFtIHtSZWdFeHB8U3RyaW5nfSBzZWFyY2ggU2VhcmNoIHBhdHRlcm4gdG8gYmUgcmVwbGFjZWQuDQogKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gcmVwbGFjZW1lbnQgUmVwbGFjZW1lbnQgc3RyaW5nIG9yIGEgZnVuY3Rpb24gaW52b2tlZCB0byBjcmVhdGUgaXQuDQogKiBAcmV0dXJucyB7U3RyaW5nfSBOZXcgc3RyaW5nIHdpdGggb25lIG9yIGFsbCBtYXRjaGVzIHJlcGxhY2VkLg0KICovDQoNCg0KZml4ZWQucmVwbGFjZSA9IGZ1bmN0aW9uIChzZWFyY2gsIHJlcGxhY2VtZW50KSB7DQogIHZhciBpc1JlZ2V4ID0gWFJlZ0V4cC5pc1JlZ0V4cChzZWFyY2gpOw0KICB2YXIgb3JpZ0xhc3RJbmRleDsNCiAgdmFyIGNhcHR1cmVOYW1lczsNCiAgdmFyIHJlc3VsdDsNCg0KICBpZiAoaXNSZWdleCkgew0KICAgIGlmIChzZWFyY2hbUkVHRVhfREFUQV0pIHsNCiAgICAgIGNhcHR1cmVOYW1lcyA9IHNlYXJjaFtSRUdFWF9EQVRBXS5jYXB0dXJlTmFtZXM7DQogICAgfSAvLyBPbmx5IG5lZWRlZCBpZiBgc2VhcmNoYCBpcyBub25nbG9iYWwNCg0KDQogICAgb3JpZ0xhc3RJbmRleCA9IHNlYXJjaC5sYXN0SW5kZXg7DQogIH0gZWxzZSB7DQogICAgc2VhcmNoICs9ICcnOyAvLyBUeXBlLWNvbnZlcnQNCiAgfSAvLyBEb24ndCB1c2UgYHR5cGVvZmA7IHNvbWUgb2xkZXIgYnJvd3NlcnMgcmV0dXJuICdmdW5jdGlvbicgZm9yIHJlZ2V4IG9iamVjdHMNCg0KDQogIGlmIChpc1R5cGUocmVwbGFjZW1lbnQsICdGdW5jdGlvbicpKSB7DQogICAgLy8gU3RyaW5naWZ5aW5nIGB0aGlzYCBmaXhlcyBhIGJ1ZyBpbiBJRSA8IDkgd2hlcmUgdGhlIGxhc3QgYXJndW1lbnQgaW4gcmVwbGFjZW1lbnQNCiAgICAvLyBmdW5jdGlvbnMgaXNuJ3QgdHlwZS1jb252ZXJ0ZWQgdG8gYSBzdHJpbmcNCiAgICByZXN1bHQgPSBuYXRpdi5yZXBsYWNlLmNhbGwoU3RyaW5nKHRoaXMpLCBzZWFyY2gsIGZ1bmN0aW9uICgpIHsNCiAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgew0KICAgICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldOw0KICAgICAgfQ0KDQogICAgICBpZiAoY2FwdHVyZU5hbWVzKSB7DQogICAgICAgIHZhciBncm91cHNPYmplY3Q7DQoNCiAgICAgICAgaWYgKFhSZWdFeHAuaXNJbnN0YWxsZWQoJ25hbWVzcGFjaW5nJykpIHsNCiAgICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL3Byb3Bvc2FsLXJlZ2V4cC1uYW1lZC1ncm91cHMvI3NlYy1yZWdleHBidWlsdGluZXhlYw0KICAgICAgICAgIGdyb3Vwc09iamVjdCA9IE9iamVjdC5jcmVhdGUobnVsbCk7DQogICAgICAgICAgYXJncy5wdXNoKGdyb3Vwc09iamVjdCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgLy8gQ2hhbmdlIHRoZSBgYXJnc1swXWAgc3RyaW5nIHByaW1pdGl2ZSB0byBhIGBTdHJpbmdgIG9iamVjdCB0aGF0IGNhbiBzdG9yZQ0KICAgICAgICAgIC8vIHByb3BlcnRpZXMuIFRoaXMgcmVhbGx5IGRvZXMgbmVlZCB0byB1c2UgYFN0cmluZ2AgYXMgYSBjb25zdHJ1Y3Rvcg0KICAgICAgICAgIGFyZ3NbMF0gPSBuZXcgU3RyaW5nKGFyZ3NbMF0pOw0KICAgICAgICAgIGdyb3Vwc09iamVjdCA9IGFyZ3NbMF07DQogICAgICAgIH0gLy8gU3RvcmUgbmFtZWQgYmFja3JlZmVyZW5jZXMNCg0KDQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FwdHVyZU5hbWVzLmxlbmd0aDsgKytpKSB7DQogICAgICAgICAgaWYgKGNhcHR1cmVOYW1lc1tpXSkgew0KICAgICAgICAgICAgZ3JvdXBzT2JqZWN0W2NhcHR1cmVOYW1lc1tpXV0gPSBhcmdzW2kgKyAxXTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0gLy8gVXBkYXRlIGBsYXN0SW5kZXhgIGJlZm9yZSBjYWxsaW5nIGByZXBsYWNlbWVudGAuIEZpeGVzIElFLCBDaHJvbWUsIEZpcmVmb3gsIFNhZmFyaQ0KICAgICAgLy8gYnVnIChsYXN0IHRlc3RlZCBJRSA5LCBDaHJvbWUgMTcsIEZpcmVmb3ggMTEsIFNhZmFyaSA1LjEpDQoNCg0KICAgICAgaWYgKGlzUmVnZXggJiYgc2VhcmNoLmdsb2JhbCkgew0KICAgICAgICBzZWFyY2gubGFzdEluZGV4ID0gYXJnc1thcmdzLmxlbmd0aCAtIDJdICsgYXJnc1swXS5sZW5ndGg7DQogICAgICB9IC8vIEVTNiBzcGVjcyB0aGUgY29udGV4dCBmb3IgcmVwbGFjZW1lbnQgZnVuY3Rpb25zIGFzIGB1bmRlZmluZWRgDQoNCg0KICAgICAgcmV0dXJuIHJlcGxhY2VtZW50LmFwcGx5KHZvaWQgMCwgYXJncyk7DQogICAgfSk7DQogIH0gZWxzZSB7DQogICAgLy8gRW5zdXJlIHRoYXQgdGhlIGxhc3QgdmFsdWUgb2YgYGFyZ3NgIHdpbGwgYmUgYSBzdHJpbmcgd2hlbiBnaXZlbiBub25zdHJpbmcgYHRoaXNgLA0KICAgIC8vIHdoaWxlIHN0aWxsIHRocm93aW5nIG9uIG51bGwgb3IgdW5kZWZpbmVkIGNvbnRleHQNCiAgICByZXN1bHQgPSBuYXRpdi5yZXBsYWNlLmNhbGwodGhpcyA9PSBudWxsID8gdGhpcyA6IFN0cmluZyh0aGlzKSwgc2VhcmNoLCBmdW5jdGlvbiAoKSB7DQogICAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjIpLCBfa2V5MiA9IDA7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHsNCiAgICAgICAgYXJnc1tfa2V5Ml0gPSBhcmd1bWVudHNbX2tleTJdOw0KICAgICAgfQ0KDQogICAgICByZXR1cm4gbmF0aXYucmVwbGFjZS5jYWxsKFN0cmluZyhyZXBsYWNlbWVudCksIHJlcGxhY2VtZW50VG9rZW4sIHJlcGxhY2VyKTsNCg0KICAgICAgZnVuY3Rpb24gcmVwbGFjZXIoJDAsIGJyYWNrZXRlZCwgYW5nbGVkLCBkb2xsYXJUb2tlbikgew0KICAgICAgICBicmFja2V0ZWQgPSBicmFja2V0ZWQgfHwgYW5nbGVkOyAvLyBOYW1lZCBvciBudW1iZXJlZCBiYWNrcmVmZXJlbmNlIHdpdGggY3VybHkgb3IgYW5nbGVkIGJyYWNlcw0KDQogICAgICAgIGlmIChicmFja2V0ZWQpIHsNCiAgICAgICAgICAvLyBYUmVnRXhwIGJlaGF2aW9yIGZvciBgJHtufWAgb3IgYCQ8bj5gOg0KICAgICAgICAgIC8vIDEuIEJhY2tyZWZlcmVuY2UgdG8gbnVtYmVyZWQgY2FwdHVyZSwgaWYgYG5gIGlzIGFuIGludGVnZXIuIFVzZSBgMGAgZm9yIHRoZQ0KICAgICAgICAgIC8vICAgIGVudGlyZSBtYXRjaC4gQW55IG51bWJlciBvZiBsZWFkaW5nIHplcm9zIG1heSBiZSB1c2VkLg0KICAgICAgICAgIC8vIDIuIEJhY2tyZWZlcmVuY2UgdG8gbmFtZWQgY2FwdHVyZSBgbmAsIGlmIGl0IGV4aXN0cyBhbmQgaXMgbm90IGFuIGludGVnZXINCiAgICAgICAgICAvLyAgICBvdmVycmlkZGVuIGJ5IG51bWJlcmVkIGNhcHR1cmUuIEluIHByYWN0aWNlLCB0aGlzIGRvZXMgbm90IG92ZXJsYXAgd2l0aA0KICAgICAgICAgIC8vICAgIG51bWJlcmVkIGNhcHR1cmUgc2luY2UgWFJlZ0V4cCBkb2VzIG5vdCBhbGxvdyBuYW1lZCBjYXB0dXJlIHRvIHVzZSBhIGJhcmUNCiAgICAgICAgICAvLyAgICBpbnRlZ2VyIGFzIHRoZSBuYW1lLg0KICAgICAgICAgIC8vIDMuIElmIHRoZSBuYW1lIG9yIG51bWJlciBkb2VzIG5vdCByZWZlciB0byBhbiBleGlzdGluZyBjYXB0dXJpbmcgZ3JvdXAsIGl0J3MNCiAgICAgICAgICAvLyAgICBhbiBlcnJvci4NCiAgICAgICAgICB2YXIgbiA9ICticmFja2V0ZWQ7IC8vIFR5cGUtY29udmVydDsgZHJvcCBsZWFkaW5nIHplcm9zDQoNCiAgICAgICAgICBpZiAobiA8PSBhcmdzLmxlbmd0aCAtIDMpIHsNCiAgICAgICAgICAgIHJldHVybiBhcmdzW25dIHx8ICcnOw0KICAgICAgICAgIH0gLy8gR3JvdXBzIHdpdGggdGhlIHNhbWUgbmFtZSBpcyBhbiBlcnJvciwgZWxzZSB3b3VsZCBuZWVkIGBsYXN0SW5kZXhPZmANCg0KDQogICAgICAgICAgbiA9IGNhcHR1cmVOYW1lcyA/IGNhcHR1cmVOYW1lcy5pbmRleE9mKGJyYWNrZXRlZCkgOiAtMTsNCg0KICAgICAgICAgIGlmIChuIDwgMCkgew0KICAgICAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCJCYWNrcmVmZXJlbmNlIHRvIHVuZGVmaW5lZCBncm91cCAiLmNvbmNhdCgkMCkpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIHJldHVybiBhcmdzW24gKyAxXSB8fCAnJzsNCiAgICAgICAgfSAvLyBFbHNlLCBzcGVjaWFsIHZhcmlhYmxlIG9yIG51bWJlcmVkIGJhY2tyZWZlcmVuY2Ugd2l0aG91dCBjdXJseSBicmFjZXMNCg0KDQogICAgICAgIGlmIChkb2xsYXJUb2tlbiA9PT0gJyQnKSB7DQogICAgICAgICAgLy8gJCQNCiAgICAgICAgICByZXR1cm4gJyQnOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGRvbGxhclRva2VuID09PSAnJicgfHwgK2RvbGxhclRva2VuID09PSAwKSB7DQogICAgICAgICAgLy8gJCYsICQwIChub3QgZm9sbG93ZWQgYnkgMS05KSwgJDAwDQogICAgICAgICAgcmV0dXJuIGFyZ3NbMF07DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoZG9sbGFyVG9rZW4gPT09ICdgJykgew0KICAgICAgICAgIC8vICRgIChsZWZ0IGNvbnRleHQpDQogICAgICAgICAgcmV0dXJuIGFyZ3NbYXJncy5sZW5ndGggLSAxXS5zbGljZSgwLCBhcmdzW2FyZ3MubGVuZ3RoIC0gMl0pOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGRvbGxhclRva2VuID09PSAiJyIpIHsNCiAgICAgICAgICAvLyAkJyAocmlnaHQgY29udGV4dCkNCiAgICAgICAgICByZXR1cm4gYXJnc1thcmdzLmxlbmd0aCAtIDFdLnNsaWNlKGFyZ3NbYXJncy5sZW5ndGggLSAyXSArIGFyZ3NbMF0ubGVuZ3RoKTsNCiAgICAgICAgfSAvLyBFbHNlLCBudW1iZXJlZCBiYWNrcmVmZXJlbmNlIHdpdGhvdXQgYnJhY2VzDQoNCg0KICAgICAgICBkb2xsYXJUb2tlbiA9ICtkb2xsYXJUb2tlbjsgLy8gVHlwZS1jb252ZXJ0OyBkcm9wIGxlYWRpbmcgemVybw0KICAgICAgICAvLyBYUmVnRXhwIGJlaGF2aW9yIGZvciBgJG5gIGFuZCBgJG5uYDoNCiAgICAgICAgLy8gLSBCYWNrcmVmcyBlbmQgYWZ0ZXIgMSBvciAyIGRpZ2l0cy4gVXNlIGAkey4ufWAgb3IgYCQ8Li4+YCBmb3IgbW9yZSBkaWdpdHMuDQogICAgICAgIC8vIC0gYCQxYCBpcyBhbiBlcnJvciBpZiBubyBjYXB0dXJpbmcgZ3JvdXBzLg0KICAgICAgICAvLyAtIGAkMTBgIGlzIGFuIGVycm9yIGlmIGxlc3MgdGhhbiAxMCBjYXB0dXJpbmcgZ3JvdXBzLiBVc2UgYCR7MX0wYCBvciBgJDwxPjBgDQogICAgICAgIC8vICAgaW5zdGVhZC4NCiAgICAgICAgLy8gLSBgJDAxYCBpcyBgJDFgIGlmIGF0IGxlYXN0IG9uZSBjYXB0dXJpbmcgZ3JvdXAsIGVsc2UgaXQncyBhbiBlcnJvci4NCiAgICAgICAgLy8gLSBgJDBgIChub3QgZm9sbG93ZWQgYnkgMS05KSBhbmQgYCQwMGAgYXJlIHRoZSBlbnRpcmUgbWF0Y2guDQogICAgICAgIC8vIE5hdGl2ZSBiZWhhdmlvciwgZm9yIGNvbXBhcmlzb246DQogICAgICAgIC8vIC0gQmFja3JlZnMgZW5kIGFmdGVyIDEgb3IgMiBkaWdpdHMuIENhbm5vdCByZWZlcmVuY2UgY2FwdHVyaW5nIGdyb3VwIDEwMCsuDQogICAgICAgIC8vIC0gYCQxYCBpcyBhIGxpdGVyYWwgYCQxYCBpZiBubyBjYXB0dXJpbmcgZ3JvdXBzLg0KICAgICAgICAvLyAtIGAkMTBgIGlzIGAkMWAgZm9sbG93ZWQgYnkgYSBsaXRlcmFsIGAwYCBpZiBsZXNzIHRoYW4gMTAgY2FwdHVyaW5nIGdyb3Vwcy4NCiAgICAgICAgLy8gLSBgJDAxYCBpcyBgJDFgIGlmIGF0IGxlYXN0IG9uZSBjYXB0dXJpbmcgZ3JvdXAsIGVsc2UgaXQncyBhIGxpdGVyYWwgYCQwMWAuDQogICAgICAgIC8vIC0gYCQwYCBpcyBhIGxpdGVyYWwgYCQwYC4NCg0KICAgICAgICBpZiAoIWlzTmFOKGRvbGxhclRva2VuKSkgew0KICAgICAgICAgIGlmIChkb2xsYXJUb2tlbiA+IGFyZ3MubGVuZ3RoIC0gMykgew0KICAgICAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCJCYWNrcmVmZXJlbmNlIHRvIHVuZGVmaW5lZCBncm91cCAiLmNvbmNhdCgkMCkpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIHJldHVybiBhcmdzW2RvbGxhclRva2VuXSB8fCAnJzsNCiAgICAgICAgfSAvLyBgJGAgZm9sbG93ZWQgYnkgYW4gdW5zdXBwb3J0ZWQgY2hhciBpcyBhbiBlcnJvciwgdW5saWtlIG5hdGl2ZSBKUw0KDQoNCiAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCJJbnZhbGlkIHRva2VuICIuY29uY2F0KCQwKSk7DQogICAgICB9DQogICAgfSk7DQogIH0NCg0KICBpZiAoaXNSZWdleCkgew0KICAgIGlmIChzZWFyY2guZ2xvYmFsKSB7DQogICAgICAvLyBGaXhlcyBJRSwgU2FmYXJpIGJ1ZyAobGFzdCB0ZXN0ZWQgSUUgOSwgU2FmYXJpIDUuMSkNCiAgICAgIHNlYXJjaC5sYXN0SW5kZXggPSAwOw0KICAgIH0gZWxzZSB7DQogICAgICAvLyBGaXhlcyBJRSwgT3BlcmEgYnVnIChsYXN0IHRlc3RlZCBJRSA5LCBPcGVyYSAxMS42KQ0KICAgICAgc2VhcmNoLmxhc3RJbmRleCA9IG9yaWdMYXN0SW5kZXg7DQogICAgfQ0KICB9DQoNCiAgcmV0dXJuIHJlc3VsdDsNCn07DQovKioNCiAqIEZpeGVzIGJyb3dzZXIgYnVncyBpbiB0aGUgbmF0aXZlIGBTdHJpbmcucHJvdG90eXBlLnNwbGl0YC4gVXNlIHZpYSBgWFJlZ0V4cC5zcGxpdGAuDQogKg0KICogQG1lbWJlck9mIFN0cmluZw0KICogQHBhcmFtIHtSZWdFeHB8U3RyaW5nfSBzZXBhcmF0b3IgUmVnZXggb3Igc3RyaW5nIHRvIHVzZSBmb3Igc2VwYXJhdGluZyB0aGUgc3RyaW5nLg0KICogQHBhcmFtIHtOdW1iZXJ9IFtsaW1pdF0gTWF4aW11bSBudW1iZXIgb2YgaXRlbXMgdG8gaW5jbHVkZSBpbiB0aGUgcmVzdWx0IGFycmF5Lg0KICogQHJldHVybnMge0FycmF5fSBBcnJheSBvZiBzdWJzdHJpbmdzLg0KICovDQoNCg0KZml4ZWQuc3BsaXQgPSBmdW5jdGlvbiAoc2VwYXJhdG9yLCBsaW1pdCkgew0KICBpZiAoIVhSZWdFeHAuaXNSZWdFeHAoc2VwYXJhdG9yKSkgew0KICAgIC8vIEJyb3dzZXJzIGhhbmRsZSBub25yZWdleCBzcGxpdCBjb3JyZWN0bHksIHNvIHVzZSB0aGUgZmFzdGVyIG5hdGl2ZSBtZXRob2QNCiAgICByZXR1cm4gbmF0aXYuc3BsaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsNCiAgfQ0KDQogIHZhciBzdHIgPSBTdHJpbmcodGhpcyk7DQogIHZhciBvdXRwdXQgPSBbXTsNCiAgdmFyIG9yaWdMYXN0SW5kZXggPSBzZXBhcmF0b3IubGFzdEluZGV4Ow0KICB2YXIgbGFzdExhc3RJbmRleCA9IDA7DQogIHZhciBsYXN0TGVuZ3RoOyAvLyBWYWx1ZXMgZm9yIGBsaW1pdGAsIHBlciB0aGUgc3BlYzoNCiAgLy8gSWYgdW5kZWZpbmVkOiBwb3coMiwzMikgLSAxDQogIC8vIElmIDAsIEluZmluaXR5LCBvciBOYU46IDANCiAgLy8gSWYgcG9zaXRpdmUgbnVtYmVyOiBsaW1pdCA9IGZsb29yKGxpbWl0KTsgaWYgKGxpbWl0ID49IHBvdygyLDMyKSkgbGltaXQgLT0gcG93KDIsMzIpOw0KICAvLyBJZiBuZWdhdGl2ZSBudW1iZXI6IHBvdygyLDMyKSAtIGZsb29yKGFicyhsaW1pdCkpDQogIC8vIElmIG90aGVyOiBUeXBlLWNvbnZlcnQsIHRoZW4gdXNlIHRoZSBhYm92ZSBydWxlcw0KICAvLyBUaGlzIGxpbmUgZmFpbHMgaW4gdmVyeSBzdHJhbmdlIHdheXMgZm9yIHNvbWUgdmFsdWVzIG9mIGBsaW1pdGAgaW4gT3BlcmEgMTAuNS0xMC42MywgdW5sZXNzDQogIC8vIE9wZXJhIERyYWdvbmZseSBpcyBvcGVuIChnbyBmaWd1cmUpLiBJdCB3b3JrcyBpbiBhdCBsZWFzdCBPcGVyYSA5LjUtMTAuMSBhbmQgMTErDQoNCiAgbGltaXQgPSAobGltaXQgPT09IHVuZGVmaW5lZCA/IC0xIDogbGltaXQpID4+PiAwOw0KICBYUmVnRXhwLmZvckVhY2goc3RyLCBzZXBhcmF0b3IsIGZ1bmN0aW9uIChtYXRjaCkgew0KICAgIC8vIFRoaXMgY29uZGl0aW9uIGlzIG5vdCB0aGUgc2FtZSBhcyBgaWYgKG1hdGNoWzBdLmxlbmd0aClgDQogICAgaWYgKG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoID4gbGFzdExhc3RJbmRleCkgew0KICAgICAgb3V0cHV0LnB1c2goc3RyLnNsaWNlKGxhc3RMYXN0SW5kZXgsIG1hdGNoLmluZGV4KSk7DQoNCiAgICAgIGlmIChtYXRjaC5sZW5ndGggPiAxICYmIG1hdGNoLmluZGV4IDwgc3RyLmxlbmd0aCkgew0KICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShvdXRwdXQsIG1hdGNoLnNsaWNlKDEpKTsNCiAgICAgIH0NCg0KICAgICAgbGFzdExlbmd0aCA9IG1hdGNoWzBdLmxlbmd0aDsNCiAgICAgIGxhc3RMYXN0SW5kZXggPSBtYXRjaC5pbmRleCArIGxhc3RMZW5ndGg7DQogICAgfQ0KICB9KTsNCg0KICBpZiAobGFzdExhc3RJbmRleCA9PT0gc3RyLmxlbmd0aCkgew0KICAgIGlmICghbmF0aXYudGVzdC5jYWxsKHNlcGFyYXRvciwgJycpIHx8IGxhc3RMZW5ndGgpIHsNCiAgICAgIG91dHB1dC5wdXNoKCcnKTsNCiAgICB9DQogIH0gZWxzZSB7DQogICAgb3V0cHV0LnB1c2goc3RyLnNsaWNlKGxhc3RMYXN0SW5kZXgpKTsNCiAgfQ0KDQogIHNlcGFyYXRvci5sYXN0SW5kZXggPSBvcmlnTGFzdEluZGV4Ow0KICByZXR1cm4gb3V0cHV0Lmxlbmd0aCA+IGxpbWl0ID8gb3V0cHV0LnNsaWNlKDAsIGxpbWl0KSA6IG91dHB1dDsNCn07IC8vID09LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS09PQ0KLy8gQnVpbHQtaW4gc3ludGF4L2ZsYWcgdG9rZW5zDQovLyA9PS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tPT0NCg0KLyoNCiAqIExldHRlciBlc2NhcGVzIHRoYXQgbmF0aXZlbHkgbWF0Y2ggbGl0ZXJhbCBjaGFyYWN0ZXJzOiBgXGFgLCBgXEFgLCBldGMuIFRoZXNlIHNob3VsZCBiZQ0KICogU3ludGF4RXJyb3JzIGJ1dCBhcmUgYWxsb3dlZCBpbiB3ZWIgcmVhbGl0eS4gWFJlZ0V4cCBtYWtlcyB0aGVtIGVycm9ycyBmb3IgY3Jvc3MtYnJvd3Nlcg0KICogY29uc2lzdGVuY3kgYW5kIHRvIHJlc2VydmUgdGhlaXIgc3ludGF4LCBidXQgbGV0cyB0aGVtIGJlIHN1cGVyc2VkZWQgYnkgYWRkb25zLg0KICovDQoNCg0KWFJlZ0V4cC5hZGRUb2tlbigvXFwoW0FCQ0UtUlRVVlhZWmFlZy1tb3BxeXpdfGMoPyFbQS1aYS16XSl8dSg/IVtcZEEtRmEtZl17NH18e1tcZEEtRmEtZl0rfSl8eCg/IVtcZEEtRmEtZl17Mn0pKS8sIGZ1bmN0aW9uIChtYXRjaCwgc2NvcGUpIHsNCiAgLy8gXEIgaXMgYWxsb3dlZCBpbiBkZWZhdWx0IHNjb3BlIG9ubHkNCiAgaWYgKG1hdGNoWzFdID09PSAnQicgJiYgc2NvcGUgPT09IGRlZmF1bHRTY29wZSkgew0KICAgIHJldHVybiBtYXRjaFswXTsNCiAgfQ0KDQogIHRocm93IG5ldyBTeW50YXhFcnJvcigiSW52YWxpZCBlc2NhcGUgIi5jb25jYXQobWF0Y2hbMF0pKTsNCn0sIHsNCiAgc2NvcGU6ICdhbGwnLA0KICBsZWFkQ2hhcjogJ1xcJw0KfSk7DQovKg0KICogVW5pY29kZSBjb2RlIHBvaW50IGVzY2FwZSB3aXRoIGN1cmx5IGJyYWNlczogYFx1e04uLn1gLiBgTi4uYCBpcyBhbnkgb25lIG9yIG1vcmUgZGlnaXQNCiAqIGhleGFkZWNpbWFsIG51bWJlciBmcm9tIDAtMTBGRkZGLCBhbmQgY2FuIGluY2x1ZGUgbGVhZGluZyB6ZXJvcy4gUmVxdWlyZXMgdGhlIG5hdGl2ZSBFUzYgYHVgIGZsYWcNCiAqIHRvIHN1cHBvcnQgY29kZSBwb2ludHMgZ3JlYXRlciB0aGFuIFUrRkZGRi4gQXZvaWRzIGNvbnZlcnRpbmcgY29kZSBwb2ludHMgYWJvdmUgVStGRkZGIHRvDQogKiBzdXJyb2dhdGUgcGFpcnMgKHdoaWNoIGNvdWxkIGJlIGRvbmUgd2l0aG91dCBmbGFnIGB1YCksIHNpbmNlIHRoYXQgY291bGQgbGVhZCB0byBicm9rZW4gYmVoYXZpb3INCiAqIGlmIHlvdSBmb2xsb3cgYSBgXHV7Ti4ufWAgdG9rZW4gdGhhdCByZWZlcmVuY2VzIGEgY29kZSBwb2ludCBhYm92ZSBVK0ZGRkYgd2l0aCBhIHF1YW50aWZpZXIsIG9yDQogKiBpZiB5b3UgdXNlIHRoZSBzYW1lIGluIGEgY2hhcmFjdGVyIGNsYXNzLg0KICovDQoNClhSZWdFeHAuYWRkVG9rZW4oL1xcdXsoW1xkQS1GYS1mXSspfS8sIGZ1bmN0aW9uIChtYXRjaCwgc2NvcGUsIGZsYWdzKSB7DQogIHZhciBjb2RlID0gZGVjKG1hdGNoWzFdKTsNCg0KICBpZiAoY29kZSA+IDB4MTBGRkZGKSB7DQogICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCJJbnZhbGlkIFVuaWNvZGUgY29kZSBwb2ludCAiLmNvbmNhdChtYXRjaFswXSkpOw0KICB9DQoNCiAgaWYgKGNvZGUgPD0gMHhGRkZGKSB7DQogICAgLy8gQ29udmVydGluZyB0byBcdU5OTk4gYXZvaWRzIG5lZWRpbmcgdG8gZXNjYXBlIHRoZSBsaXRlcmFsIGNoYXJhY3RlciBhbmQga2VlcCBpdA0KICAgIC8vIHNlcGFyYXRlIGZyb20gcHJlY2VkaW5nIHRva2Vucw0KICAgIHJldHVybiAiXFx1Ii5jb25jYXQocGFkNChoZXgoY29kZSkpKTsNCiAgfSAvLyBJZiBgY29kZWAgaXMgYmV0d2VlbiAweEZGRkYgYW5kIDB4MTBGRkZGLCByZXF1aXJlIGFuZCBkZWZlciB0byBuYXRpdmUgaGFuZGxpbmcNCg0KDQogIGlmIChoYXNOYXRpdmVVICYmIGZsYWdzLmluZGV4T2YoJ3UnKSAhPT0gLTEpIHsNCiAgICByZXR1cm4gbWF0Y2hbMF07DQogIH0NCg0KICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoJ0Nhbm5vdCB1c2UgVW5pY29kZSBjb2RlIHBvaW50IGFib3ZlIFxcdXtGRkZGfSB3aXRob3V0IGZsYWcgdScpOw0KfSwgew0KICBzY29wZTogJ2FsbCcsDQogIGxlYWRDaGFyOiAnXFwnDQp9KTsNCi8qDQogKiBFbXB0eSBjaGFyYWN0ZXIgY2xhc3M6IGBbXWAgb3IgYFteXWAuIFRoaXMgZml4ZXMgYSBjcml0aWNhbCBjcm9zcy1icm93c2VyIHN5bnRheCBpbmNvbnNpc3RlbmN5Lg0KICogVW5sZXNzIHRoaXMgaXMgc3RhbmRhcmRpemVkIChwZXIgdGhlIEVTIHNwZWMpLCByZWdleCBzeW50YXggY2FuJ3QgYmUgYWNjdXJhdGVseSBwYXJzZWQgYmVjYXVzZQ0KICogY2hhcmFjdGVyIGNsYXNzIGVuZGluZ3MgY2FuJ3QgYmUgZGV0ZXJtaW5lZC4NCiAqLw0KDQpYUmVnRXhwLmFkZFRva2VuKC9cWyhcXj8pXF0vLCAvLyBGb3IgY3Jvc3MtYnJvd3NlciBjb21wYXRpYmlsaXR5IHdpdGggRVMzLCBjb252ZXJ0IFtdIHRvIFxiXEIgYW5kIFteXSB0byBbXHNcU10uDQovLyAoPyEpIHNob3VsZCB3b3JrIGxpa2UgXGJcQiwgYnV0IGlzIHVucmVsaWFibGUgaW4gc29tZSB2ZXJzaW9ucyBvZiBGaXJlZm94DQoNCi8qIGVzbGludC1kaXNhYmxlIG5vLWNvbmZ1c2luZy1hcnJvdyAqLw0KZnVuY3Rpb24gKG1hdGNoKSB7DQogIHJldHVybiBtYXRjaFsxXSA/ICdbXFxzXFxTXScgOiAnXFxiXFxCJzsNCn0sDQovKiBlc2xpbnQtZW5hYmxlIG5vLWNvbmZ1c2luZy1hcnJvdyAqLw0Kew0KICBsZWFkQ2hhcjogJ1snDQp9KTsNCi8qDQogKiBDb21tZW50IHBhdHRlcm46IGAoPyMgKWAuIElubGluZSBjb21tZW50cyBhcmUgYW4gYWx0ZXJuYXRpdmUgdG8gdGhlIGxpbmUgY29tbWVudHMgYWxsb3dlZCBpbg0KICogZnJlZS1zcGFjaW5nIG1vZGUgKGZsYWcgeCkuDQogKi8NCg0KWFJlZ0V4cC5hZGRUb2tlbigvXChcPyNbXildKlwpLywgZ2V0Q29udGV4dHVhbFRva2VuU2VwYXJhdG9yLCB7DQogIGxlYWRDaGFyOiAnKCcNCn0pOw0KLyoNCiAqIFdoaXRlc3BhY2UgYW5kIGxpbmUgY29tbWVudHMsIGluIGZyZWUtc3BhY2luZyBtb2RlIChha2EgZXh0ZW5kZWQgbW9kZSwgZmxhZyB4KSBvbmx5Lg0KICovDQoNClhSZWdFeHAuYWRkVG9rZW4oL1xzK3wjW15cbl0qXG4/LywgZ2V0Q29udGV4dHVhbFRva2VuU2VwYXJhdG9yLCB7DQogIGZsYWc6ICd4Jw0KfSk7DQovKg0KICogRG90LCBpbiBkb3RhbGwgbW9kZSAoYWthIHNpbmdsZWxpbmUgbW9kZSwgZmxhZyBzKSBvbmx5Lg0KICovDQoNClhSZWdFeHAuYWRkVG9rZW4oL1wuLywgZnVuY3Rpb24gKCkgew0KICByZXR1cm4gJ1tcXHNcXFNdJzsNCn0sIHsNCiAgZmxhZzogJ3MnLA0KICBsZWFkQ2hhcjogJy4nDQp9KTsNCi8qDQogKiBOYW1lZCBiYWNrcmVmZXJlbmNlOiBgXGs8bmFtZT5gLiBCYWNrcmVmZXJlbmNlIG5hbWVzIGNhbiB1c2UgdGhlIGNoYXJhY3RlcnMgQS1aLCBhLXosIDAtOSwgXywNCiAqIGFuZCAkIG9ubHkuIEFsc28gYWxsb3dzIG51bWJlcmVkIGJhY2tyZWZlcmVuY2VzIGFzIGBcazxuPmAuDQogKi8NCg0KWFJlZ0V4cC5hZGRUb2tlbigvXFxrPChbXHckXSspPi8sIGZ1bmN0aW9uIChtYXRjaCkgew0KICAvLyBHcm91cHMgd2l0aCB0aGUgc2FtZSBuYW1lIGlzIGFuIGVycm9yLCBlbHNlIHdvdWxkIG5lZWQgYGxhc3RJbmRleE9mYA0KICB2YXIgaW5kZXggPSBpc05hTihtYXRjaFsxXSkgPyB0aGlzLmNhcHR1cmVOYW1lcy5pbmRleE9mKG1hdGNoWzFdKSArIDEgOiArbWF0Y2hbMV07DQogIHZhciBlbmRJbmRleCA9IG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoOw0KDQogIGlmICghaW5kZXggfHwgaW5kZXggPiB0aGlzLmNhcHR1cmVOYW1lcy5sZW5ndGgpIHsNCiAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoIkJhY2tyZWZlcmVuY2UgdG8gdW5kZWZpbmVkIGdyb3VwICIuY29uY2F0KG1hdGNoWzBdKSk7DQogIH0gLy8gS2VlcCBiYWNrcmVmZXJlbmNlcyBzZXBhcmF0ZSBmcm9tIHN1YnNlcXVlbnQgbGl0ZXJhbCBudW1iZXJzLiBUaGlzIGF2b2lkcyBlLmcuDQogIC8vIGluYWR2ZXJ0ZWRseSBjaGFuZ2luZyBgKD88bj4pXGs8bj4xYCB0byBgKClcMTFgLg0KDQoNCiAgcmV0dXJuICJcXCIuY29uY2F0KGluZGV4KS5jb25jYXQoZW5kSW5kZXggPT09IG1hdGNoLmlucHV0Lmxlbmd0aCB8fCBpc05hTihtYXRjaC5pbnB1dFtlbmRJbmRleF0pID8gJycgOiAnKD86KScpOw0KfSwgew0KICBsZWFkQ2hhcjogJ1xcJw0KfSk7DQovKg0KICogTnVtYmVyZWQgYmFja3JlZmVyZW5jZSBvciBvY3RhbCwgcGx1cyBhbnkgZm9sbG93aW5nIGRpZ2l0czogYFwwYCwgYFwxMWAsIGV0Yy4gT2N0YWxzIGV4Y2VwdCBgXDBgDQogKiBub3QgZm9sbG93ZWQgYnkgMC05IGFuZCBiYWNrcmVmZXJlbmNlcyB0byB1bm9wZW5lZCBjYXB0dXJlIGdyb3VwcyB0aHJvdyBhbiBlcnJvci4gT3RoZXIgbWF0Y2hlcw0KICogYXJlIHJldHVybmVkIHVuYWx0ZXJlZC4gSUUgPCA5IGRvZXNuJ3Qgc3VwcG9ydCBiYWNrcmVmZXJlbmNlcyBhYm92ZSBgXDk5YCBpbiByZWdleCBzeW50YXguDQogKi8NCg0KWFJlZ0V4cC5hZGRUb2tlbigvXFwoXGQrKS8sIGZ1bmN0aW9uIChtYXRjaCwgc2NvcGUpIHsNCiAgaWYgKCEoc2NvcGUgPT09IGRlZmF1bHRTY29wZSAmJiAvXlsxLTldLy50ZXN0KG1hdGNoWzFdKSAmJiArbWF0Y2hbMV0gPD0gdGhpcy5jYXB0dXJlTmFtZXMubGVuZ3RoKSAmJiBtYXRjaFsxXSAhPT0gJzAnKSB7DQogICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCJDYW5ub3QgdXNlIG9jdGFsIGVzY2FwZSBvciBiYWNrcmVmZXJlbmNlIHRvIHVuZGVmaW5lZCBncm91cCAiLmNvbmNhdChtYXRjaFswXSkpOw0KICB9DQoNCiAgcmV0dXJuIG1hdGNoWzBdOw0KfSwgew0KICBzY29wZTogJ2FsbCcsDQogIGxlYWRDaGFyOiAnXFwnDQp9KTsNCi8qDQogKiBOYW1lZCBjYXB0dXJpbmcgZ3JvdXA7IG1hdGNoIHRoZSBvcGVuaW5nIGRlbGltaXRlciBvbmx5OiBgKD88bmFtZT5gLiBDYXB0dXJlIG5hbWVzIGNhbiB1c2UgdGhlDQogKiBjaGFyYWN0ZXJzIEEtWiwgYS16LCAwLTksIF8sIGFuZCAkIG9ubHkuIE5hbWVzIGNhbid0IGJlIGludGVnZXJzLiBTdXBwb3J0cyBQeXRob24tc3R5bGUNCiAqIGAoP1A8bmFtZT5gIGFzIGFuIGFsdGVybmF0ZSBzeW50YXggdG8gYXZvaWQgaXNzdWVzIGluIHNvbWUgb2xkZXIgdmVyc2lvbnMgb2YgT3BlcmEgd2hpY2ggbmF0aXZlbHkNCiAqIHN1cHBvcnRlZCB0aGUgUHl0aG9uLXN0eWxlIHN5bnRheC4gT3RoZXJ3aXNlLCBYUmVnRXhwIG1pZ2h0IHRyZWF0IG51bWJlcmVkIGJhY2tyZWZlcmVuY2VzIHRvDQogKiBQeXRob24tc3R5bGUgbmFtZWQgY2FwdHVyZSBhcyBvY3RhbHMuDQogKi8NCg0KWFJlZ0V4cC5hZGRUb2tlbigvXChcP1A/PChbXHckXSspPi8sIGZ1bmN0aW9uIChtYXRjaCkgew0KICAvLyBEaXNhbGxvdyBiYXJlIGludGVnZXJzIGFzIG5hbWVzIGJlY2F1c2UgbmFtZWQgYmFja3JlZmVyZW5jZXMgYXJlIGFkZGVkIHRvIG1hdGNoIGFycmF5cw0KICAvLyBhbmQgdGhlcmVmb3JlIG51bWVyaWMgcHJvcGVydGllcyBtYXkgbGVhZCB0byBpbmNvcnJlY3QgbG9va3Vwcw0KICBpZiAoIWlzTmFOKG1hdGNoWzFdKSkgew0KICAgIHRocm93IG5ldyBTeW50YXhFcnJvcigiQ2Fubm90IHVzZSBpbnRlZ2VyIGFzIGNhcHR1cmUgbmFtZSAiLmNvbmNhdChtYXRjaFswXSkpOw0KICB9DQoNCiAgaWYgKCFYUmVnRXhwLmlzSW5zdGFsbGVkKCduYW1lc3BhY2luZycpICYmIChtYXRjaFsxXSA9PT0gJ2xlbmd0aCcgfHwgbWF0Y2hbMV0gPT09ICdfX3Byb3RvX18nKSkgew0KICAgIHRocm93IG5ldyBTeW50YXhFcnJvcigiQ2Fubm90IHVzZSByZXNlcnZlZCB3b3JkIGFzIGNhcHR1cmUgbmFtZSAiLmNvbmNhdChtYXRjaFswXSkpOw0KICB9DQoNCiAgaWYgKHRoaXMuY2FwdHVyZU5hbWVzLmluZGV4T2YobWF0Y2hbMV0pICE9PSAtMSkgew0KICAgIHRocm93IG5ldyBTeW50YXhFcnJvcigiQ2Fubm90IHVzZSBzYW1lIG5hbWUgZm9yIG11bHRpcGxlIGdyb3VwcyAiLmNvbmNhdChtYXRjaFswXSkpOw0KICB9DQoNCiAgdGhpcy5jYXB0dXJlTmFtZXMucHVzaChtYXRjaFsxXSk7DQogIHRoaXMuaGFzTmFtZWRDYXB0dXJlID0gdHJ1ZTsNCiAgcmV0dXJuICcoJzsNCn0sIHsNCiAgbGVhZENoYXI6ICcoJw0KfSk7DQovKg0KICogQ2FwdHVyaW5nIGdyb3VwOyBtYXRjaCB0aGUgb3BlbmluZyBwYXJlbnRoZXNpcyBvbmx5LiBSZXF1aXJlZCBmb3Igc3VwcG9ydCBvZiBuYW1lZCBjYXB0dXJpbmcNCiAqIGdyb3Vwcy4gQWxzbyBhZGRzIGV4cGxpY2l0IGNhcHR1cmUgbW9kZSAoZmxhZyBuKS4NCiAqLw0KDQpYUmVnRXhwLmFkZFRva2VuKC9cKCg/IVw/KS8sIGZ1bmN0aW9uIChtYXRjaCwgc2NvcGUsIGZsYWdzKSB7DQogIGlmIChmbGFncy5pbmRleE9mKCduJykgIT09IC0xKSB7DQogICAgcmV0dXJuICcoPzonOw0KICB9DQoNCiAgdGhpcy5jYXB0dXJlTmFtZXMucHVzaChudWxsKTsNCiAgcmV0dXJuICcoJzsNCn0sIHsNCiAgb3B0aW9uYWxGbGFnczogJ24nLA0KICBsZWFkQ2hhcjogJygnDQp9KTsNCnZhciBfZGVmYXVsdCA9IFhSZWdFeHA7DQpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsNCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1siZGVmYXVsdCJdOw0KfSx7fV0sMTA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KbW9kdWxlLmV4cG9ydHMgPSBbDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkFkbGFtJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4M0FbXHVERDAwLVx1REQ1Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQWVnZWFuX051bWJlcnMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMFtcdUREMDAtXHVERDNGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5BaG9tJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDVbXHVERjAwLVx1REYzRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQWxjaGVtaWNhbF9TeW1ib2xzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4M0RbXHVERjAwLVx1REY3Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQWxwaGFiZXRpY19QcmVzZW50YXRpb25fRm9ybXMnLA0KICAgICAgICAnYm1wJzogJ1x1RkIwMC1cdUZCNEYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQW5hdG9saWFuX0hpZXJvZ2x5cGhzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MTFbXHVEQzAwLVx1REU3Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQW5jaWVudF9HcmVla19NdXNpY2FsX05vdGF0aW9uJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MzRbXHVERTAwLVx1REU0Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQW5jaWVudF9HcmVla19OdW1iZXJzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERDQwLVx1REQ4Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQW5jaWVudF9TeW1ib2xzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERDkwLVx1RERDRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQXJhYmljJywNCiAgICAgICAgJ2JtcCc6ICdcdTA2MDAtXHUwNkZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkFyYWJpY19FeHRlbmRlZF9BJywNCiAgICAgICAgJ2JtcCc6ICdcdTA4QTAtXHUwOEZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkFyYWJpY19NYXRoZW1hdGljYWxfQWxwaGFiZXRpY19TeW1ib2xzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4M0JbXHVERTAwLVx1REVGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQXJhYmljX1ByZXNlbnRhdGlvbl9Gb3Jtc19BJywNCiAgICAgICAgJ2JtcCc6ICdcdUZCNTAtXHVGREZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkFyYWJpY19QcmVzZW50YXRpb25fRm9ybXNfQicsDQogICAgICAgICdibXAnOiAnXHVGRTcwLVx1RkVGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5BcmFiaWNfU3VwcGxlbWVudCcsDQogICAgICAgICdibXAnOiAnXHUwNzUwLVx1MDc3RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5Bcm1lbmlhbicsDQogICAgICAgICdibXAnOiAnXHUwNTMwLVx1MDU4RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5BcnJvd3MnLA0KICAgICAgICAnYm1wJzogJ1x1MjE5MC1cdTIxRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQXZlc3RhbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1REYwMC1cdURGM0ZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkJhbGluZXNlJywNCiAgICAgICAgJ2JtcCc6ICdcdTFCMDAtXHUxQjdGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkJhbXVtJywNCiAgICAgICAgJ2JtcCc6ICdcdUE2QTAtXHVBNkZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkJhbXVtX1N1cHBsZW1lbnQnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgxQVtcdURDMDAtXHVERTNGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5CYXNpY19MYXRpbicsDQogICAgICAgICdibXAnOiAnXDAtXHg3RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5CYXNzYV9WYWgnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgxQVtcdURFRDAtXHVERUZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5CYXRhaycsDQogICAgICAgICdibXAnOiAnXHUxQkMwLVx1MUJGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5CZW5nYWxpJywNCiAgICAgICAgJ2JtcCc6ICdcdTA5ODAtXHUwOUZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkJoYWlrc3VraScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA3W1x1REMwMC1cdURDNkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkJsb2NrX0VsZW1lbnRzJywNCiAgICAgICAgJ2JtcCc6ICdcdTI1ODAtXHUyNTlGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkJvcG9tb2ZvJywNCiAgICAgICAgJ2JtcCc6ICdcdTMxMDAtXHUzMTJGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkJvcG9tb2ZvX0V4dGVuZGVkJywNCiAgICAgICAgJ2JtcCc6ICdcdTMxQTAtXHUzMUJGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkJveF9EcmF3aW5nJywNCiAgICAgICAgJ2JtcCc6ICdcdTI1MDAtXHUyNTdGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkJyYWhtaScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA0W1x1REMwMC1cdURDN0ZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkJyYWlsbGVfUGF0dGVybnMnLA0KICAgICAgICAnYm1wJzogJ1x1MjgwMC1cdTI4RkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQnVnaW5lc2UnLA0KICAgICAgICAnYm1wJzogJ1x1MUEwMC1cdTFBMUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQnVoaWQnLA0KICAgICAgICAnYm1wJzogJ1x1MTc0MC1cdTE3NUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQnl6YW50aW5lX011c2ljYWxfU3ltYm9scycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODM0W1x1REMwMC1cdURDRkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkNKS19Db21wYXRpYmlsaXR5JywNCiAgICAgICAgJ2JtcCc6ICdcdTMzMDAtXHUzM0ZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkNKS19Db21wYXRpYmlsaXR5X0Zvcm1zJywNCiAgICAgICAgJ2JtcCc6ICdcdUZFMzAtXHVGRTRGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkNKS19Db21wYXRpYmlsaXR5X0lkZW9ncmFwaHMnLA0KICAgICAgICAnYm1wJzogJ1x1RjkwMC1cdUZBRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ0pLX0NvbXBhdGliaWxpdHlfSWRlb2dyYXBoc19TdXBwbGVtZW50JywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4N0VbXHVEQzAwLVx1REUxRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ0pLX1JhZGljYWxzX1N1cHBsZW1lbnQnLA0KICAgICAgICAnYm1wJzogJ1x1MkU4MC1cdTJFRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ0pLX1N0cm9rZXMnLA0KICAgICAgICAnYm1wJzogJ1x1MzFDMC1cdTMxRUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ0pLX1N5bWJvbHNfQW5kX1B1bmN0dWF0aW9uJywNCiAgICAgICAgJ2JtcCc6ICdcdTMwMDAtXHUzMDNGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkNKS19VbmlmaWVkX0lkZW9ncmFwaHMnLA0KICAgICAgICAnYm1wJzogJ1x1NEUwMC1cdTlGRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ0pLX1VuaWZpZWRfSWRlb2dyYXBoc19FeHRlbnNpb25fQScsDQogICAgICAgICdibXAnOiAnXHUzNDAwLVx1NERCRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5DSktfVW5pZmllZF9JZGVvZ3JhcGhzX0V4dGVuc2lvbl9CJywNCiAgICAgICAgJ2FzdHJhbCc6ICdbXHVEODQwLVx1RDg2OF1bXHVEQzAwLVx1REZGRl18XHVEODY5W1x1REMwMC1cdURFREZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkNKS19VbmlmaWVkX0lkZW9ncmFwaHNfRXh0ZW5zaW9uX0MnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDg2OVtcdURGMDAtXHVERkZGXXxbXHVEODZBLVx1RDg2Q11bXHVEQzAwLVx1REZGRl18XHVEODZEW1x1REMwMC1cdURGM0ZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkNKS19VbmlmaWVkX0lkZW9ncmFwaHNfRXh0ZW5zaW9uX0QnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDg2RFtcdURGNDAtXHVERkZGXXxcdUQ4NkVbXHVEQzAwLVx1REMxRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ0pLX1VuaWZpZWRfSWRlb2dyYXBoc19FeHRlbnNpb25fRScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODZFW1x1REMyMC1cdURGRkZdfFtcdUQ4NkYtXHVEODcyXVtcdURDMDAtXHVERkZGXXxcdUQ4NzNbXHVEQzAwLVx1REVBRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ0pLX1VuaWZpZWRfSWRlb2dyYXBoc19FeHRlbnNpb25fRicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODczW1x1REVCMC1cdURGRkZdfFtcdUQ4NzQtXHVEODc5XVtcdURDMDAtXHVERkZGXXxcdUQ4N0FbXHVEQzAwLVx1REZFRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ2FyaWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERUEwLVx1REVERl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ2F1Y2FzaWFuX0FsYmFuaWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDFbXHVERDMwLVx1REQ2Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ2hha21hJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDRbXHVERDAwLVx1REQ0Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ2hhbScsDQogICAgICAgICdibXAnOiAnXHVBQTAwLVx1QUE1RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5DaGVyb2tlZScsDQogICAgICAgICdibXAnOiAnXHUxM0EwLVx1MTNGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5DaGVyb2tlZV9TdXBwbGVtZW50JywNCiAgICAgICAgJ2JtcCc6ICdcdUFCNzAtXHVBQkJGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkNoZXNzX1N5bWJvbHMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgzRVtcdURFMDAtXHVERTZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5Db21iaW5pbmdfRGlhY3JpdGljYWxfTWFya3MnLA0KICAgICAgICAnYm1wJzogJ1x1MDMwMC1cdTAzNkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ29tYmluaW5nX0RpYWNyaXRpY2FsX01hcmtzX0V4dGVuZGVkJywNCiAgICAgICAgJ2JtcCc6ICdcdTFBQjAtXHUxQUZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkNvbWJpbmluZ19EaWFjcml0aWNhbF9NYXJrc19Gb3JfU3ltYm9scycsDQogICAgICAgICdibXAnOiAnXHUyMEQwLVx1MjBGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5Db21iaW5pbmdfRGlhY3JpdGljYWxfTWFya3NfU3VwcGxlbWVudCcsDQogICAgICAgICdibXAnOiAnXHUxREMwLVx1MURGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5Db21iaW5pbmdfSGFsZl9NYXJrcycsDQogICAgICAgICdibXAnOiAnXHVGRTIwLVx1RkUyRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5Db21tb25fSW5kaWNfTnVtYmVyX0Zvcm1zJywNCiAgICAgICAgJ2JtcCc6ICdcdUE4MzAtXHVBODNGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkNvbnRyb2xfUGljdHVyZXMnLA0KICAgICAgICAnYm1wJzogJ1x1MjQwMC1cdTI0M0YnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ29wdGljJywNCiAgICAgICAgJ2JtcCc6ICdcdTJDODAtXHUyQ0ZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkNvcHRpY19FcGFjdF9OdW1iZXJzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERUUwLVx1REVGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ291bnRpbmdfUm9kX051bWVyYWxzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MzRbXHVERjYwLVx1REY3Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ3VuZWlmb3JtJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDhbXHVEQzAwLVx1REZGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ3VuZWlmb3JtX051bWJlcnNfQW5kX1B1bmN0dWF0aW9uJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDlbXHVEQzAwLVx1REM3Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ3VycmVuY3lfU3ltYm9scycsDQogICAgICAgICdibXAnOiAnXHUyMEEwLVx1MjBDRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5DeXByaW90X1N5bGxhYmFyeScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1REMwMC1cdURDM0ZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkN5cmlsbGljJywNCiAgICAgICAgJ2JtcCc6ICdcdTA0MDAtXHUwNEZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkN5cmlsbGljX0V4dGVuZGVkX0EnLA0KICAgICAgICAnYm1wJzogJ1x1MkRFMC1cdTJERkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luQ3lyaWxsaWNfRXh0ZW5kZWRfQicsDQogICAgICAgICdibXAnOiAnXHVBNjQwLVx1QTY5RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5DeXJpbGxpY19FeHRlbmRlZF9DJywNCiAgICAgICAgJ2JtcCc6ICdcdTFDODAtXHUxQzhGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkN5cmlsbGljX1N1cHBsZW1lbnQnLA0KICAgICAgICAnYm1wJzogJ1x1MDUwMC1cdTA1MkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luRGVzZXJldCcsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAxW1x1REMwMC1cdURDNEZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkRldmFuYWdhcmknLA0KICAgICAgICAnYm1wJzogJ1x1MDkwMC1cdTA5N0YnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luRGV2YW5hZ2FyaV9FeHRlbmRlZCcsDQogICAgICAgICdibXAnOiAnXHVBOEUwLVx1QThGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5EaW5nYmF0cycsDQogICAgICAgICdibXAnOiAnXHUyNzAwLVx1MjdCRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5Eb2dyYScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA2W1x1REMwMC1cdURDNEZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkRvbWlub19UaWxlcycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODNDW1x1REMzMC1cdURDOUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkR1cGxveWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MkZbXHVEQzAwLVx1REM5Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luRWFybHlfRHluYXN0aWNfQ3VuZWlmb3JtJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDlbXHVEQzgwLVx1REQ0Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luRWd5cHRpYW5fSGllcm9nbHlwaHMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwQ1tcdURDMDAtXHVERkZGXXxcdUQ4MERbXHVEQzAwLVx1REMyRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luRWxiYXNhbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAxW1x1REQwMC1cdUREMkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkVtb3RpY29ucycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODNEW1x1REUwMC1cdURFNEZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkVuY2xvc2VkX0FscGhhbnVtZXJpY19TdXBwbGVtZW50JywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4M0NbXHVERDAwLVx1RERGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luRW5jbG9zZWRfQWxwaGFudW1lcmljcycsDQogICAgICAgICdibXAnOiAnXHUyNDYwLVx1MjRGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5FbmNsb3NlZF9DSktfTGV0dGVyc19BbmRfTW9udGhzJywNCiAgICAgICAgJ2JtcCc6ICdcdTMyMDAtXHUzMkZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkVuY2xvc2VkX0lkZW9ncmFwaGljX1N1cHBsZW1lbnQnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgzQ1tcdURFMDAtXHVERUZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5FdGhpb3BpYycsDQogICAgICAgICdibXAnOiAnXHUxMjAwLVx1MTM3RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5FdGhpb3BpY19FeHRlbmRlZCcsDQogICAgICAgICdibXAnOiAnXHUyRDgwLVx1MkRERicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5FdGhpb3BpY19FeHRlbmRlZF9BJywNCiAgICAgICAgJ2JtcCc6ICdcdUFCMDAtXHVBQjJGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkV0aGlvcGljX1N1cHBsZW1lbnQnLA0KICAgICAgICAnYm1wJzogJ1x1MTM4MC1cdTEzOUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luR2VuZXJhbF9QdW5jdHVhdGlvbicsDQogICAgICAgICdibXAnOiAnXHUyMDAwLVx1MjA2RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5HZW9tZXRyaWNfU2hhcGVzJywNCiAgICAgICAgJ2JtcCc6ICdcdTI1QTAtXHUyNUZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkdlb21ldHJpY19TaGFwZXNfRXh0ZW5kZWQnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgzRFtcdURGODAtXHVERkZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5HZW9yZ2lhbicsDQogICAgICAgICdibXAnOiAnXHUxMEEwLVx1MTBGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5HZW9yZ2lhbl9FeHRlbmRlZCcsDQogICAgICAgICdibXAnOiAnXHUxQzkwLVx1MUNCRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5HZW9yZ2lhbl9TdXBwbGVtZW50JywNCiAgICAgICAgJ2JtcCc6ICdcdTJEMDAtXHUyRDJGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkdsYWdvbGl0aWMnLA0KICAgICAgICAnYm1wJzogJ1x1MkMwMC1cdTJDNUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luR2xhZ29saXRpY19TdXBwbGVtZW50JywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MzhbXHVEQzAwLVx1REMyRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luR290aGljJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERjMwLVx1REY0Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luR3JhbnRoYScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA0W1x1REYwMC1cdURGN0ZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkdyZWVrX0FuZF9Db3B0aWMnLA0KICAgICAgICAnYm1wJzogJ1x1MDM3MC1cdTAzRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luR3JlZWtfRXh0ZW5kZWQnLA0KICAgICAgICAnYm1wJzogJ1x1MUYwMC1cdTFGRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luR3VqYXJhdGknLA0KICAgICAgICAnYm1wJzogJ1x1MEE4MC1cdTBBRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luR3VuamFsYV9Hb25kaScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA3W1x1REQ2MC1cdUREQUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkd1cm11a2hpJywNCiAgICAgICAgJ2JtcCc6ICdcdTBBMDAtXHUwQTdGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkhhbGZ3aWR0aF9BbmRfRnVsbHdpZHRoX0Zvcm1zJywNCiAgICAgICAgJ2JtcCc6ICdcdUZGMDAtXHVGRkVGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkhhbmd1bF9Db21wYXRpYmlsaXR5X0phbW8nLA0KICAgICAgICAnYm1wJzogJ1x1MzEzMC1cdTMxOEYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luSGFuZ3VsX0phbW8nLA0KICAgICAgICAnYm1wJzogJ1x1MTEwMC1cdTExRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luSGFuZ3VsX0phbW9fRXh0ZW5kZWRfQScsDQogICAgICAgICdibXAnOiAnXHVBOTYwLVx1QTk3RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5IYW5ndWxfSmFtb19FeHRlbmRlZF9CJywNCiAgICAgICAgJ2JtcCc6ICdcdUQ3QjAtXHVEN0ZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkhhbmd1bF9TeWxsYWJsZXMnLA0KICAgICAgICAnYm1wJzogJ1x1QUMwMC1cdUQ3QUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luSGFuaWZpX1JvaGluZ3lhJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDNbXHVERDAwLVx1REQzRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luSGFudW5vbycsDQogICAgICAgICdibXAnOiAnXHUxNzIwLVx1MTczRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5IYXRyYW4nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMltcdURDRTAtXHVEQ0ZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5IZWJyZXcnLA0KICAgICAgICAnYm1wJzogJ1x1MDU5MC1cdTA1RkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luSGlnaF9Qcml2YXRlX1VzZV9TdXJyb2dhdGVzJywNCiAgICAgICAgJ2JtcCc6ICdcdURCODAtXHVEQkZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkhpZ2hfU3Vycm9nYXRlcycsDQogICAgICAgICdibXAnOiAnXHVEODAwLVx1REI3RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5IaXJhZ2FuYScsDQogICAgICAgICdibXAnOiAnXHUzMDQwLVx1MzA5RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5JUEFfRXh0ZW5zaW9ucycsDQogICAgICAgICdibXAnOiAnXHUwMjUwLVx1MDJBRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5JZGVvZ3JhcGhpY19EZXNjcmlwdGlvbl9DaGFyYWN0ZXJzJywNCiAgICAgICAgJ2JtcCc6ICdcdTJGRjAtXHUyRkZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbklkZW9ncmFwaGljX1N5bWJvbHNfQW5kX1B1bmN0dWF0aW9uJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MUJbXHVERkUwLVx1REZGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luSW1wZXJpYWxfQXJhbWFpYycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1REM0MC1cdURDNUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkluZGljX1NpeWFxX051bWJlcnMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgzQltcdURDNzAtXHVEQ0JGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5JbnNjcmlwdGlvbmFsX1BhaGxhdmknLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMltcdURGNjAtXHVERjdGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5JbnNjcmlwdGlvbmFsX1BhcnRoaWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVERjQwLVx1REY1Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luSmF2YW5lc2UnLA0KICAgICAgICAnYm1wJzogJ1x1QTk4MC1cdUE5REYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luS2FpdGhpJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDRbXHVEQzgwLVx1RENDRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luS2FuYV9FeHRlbmRlZF9BJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MkNbXHVERDAwLVx1REQyRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luS2FuYV9TdXBwbGVtZW50JywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MkNbXHVEQzAwLVx1RENGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luS2FuYnVuJywNCiAgICAgICAgJ2JtcCc6ICdcdTMxOTAtXHUzMTlGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkthbmd4aV9SYWRpY2FscycsDQogICAgICAgICdibXAnOiAnXHUyRjAwLVx1MkZERicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5LYW5uYWRhJywNCiAgICAgICAgJ2JtcCc6ICdcdTBDODAtXHUwQ0ZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkthdGFrYW5hJywNCiAgICAgICAgJ2JtcCc6ICdcdTMwQTAtXHUzMEZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkthdGFrYW5hX1Bob25ldGljX0V4dGVuc2lvbnMnLA0KICAgICAgICAnYm1wJzogJ1x1MzFGMC1cdTMxRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luS2F5YWhfTGknLA0KICAgICAgICAnYm1wJzogJ1x1QTkwMC1cdUE5MkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luS2hhcm9zaHRoaScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1REUwMC1cdURFNUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbktobWVyJywNCiAgICAgICAgJ2JtcCc6ICdcdTE3ODAtXHUxN0ZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbktobWVyX1N5bWJvbHMnLA0KICAgICAgICAnYm1wJzogJ1x1MTlFMC1cdTE5RkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luS2hvamtpJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDRbXHVERTAwLVx1REU0Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luS2h1ZGF3YWRpJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDRbXHVERUIwLVx1REVGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTGFvJywNCiAgICAgICAgJ2JtcCc6ICdcdTBFODAtXHUwRUZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkxhdGluXzFfU3VwcGxlbWVudCcsDQogICAgICAgICdibXAnOiAnXHg4MC1ceEZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkxhdGluX0V4dGVuZGVkX0EnLA0KICAgICAgICAnYm1wJzogJ1x1MDEwMC1cdTAxN0YnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTGF0aW5fRXh0ZW5kZWRfQWRkaXRpb25hbCcsDQogICAgICAgICdibXAnOiAnXHUxRTAwLVx1MUVGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5MYXRpbl9FeHRlbmRlZF9CJywNCiAgICAgICAgJ2JtcCc6ICdcdTAxODAtXHUwMjRGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkxhdGluX0V4dGVuZGVkX0MnLA0KICAgICAgICAnYm1wJzogJ1x1MkM2MC1cdTJDN0YnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTGF0aW5fRXh0ZW5kZWRfRCcsDQogICAgICAgICdibXAnOiAnXHVBNzIwLVx1QTdGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5MYXRpbl9FeHRlbmRlZF9FJywNCiAgICAgICAgJ2JtcCc6ICdcdUFCMzAtXHVBQjZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkxlcGNoYScsDQogICAgICAgICdibXAnOiAnXHUxQzAwLVx1MUM0RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5MZXR0ZXJsaWtlX1N5bWJvbHMnLA0KICAgICAgICAnYm1wJzogJ1x1MjEwMC1cdTIxNEYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTGltYnUnLA0KICAgICAgICAnYm1wJzogJ1x1MTkwMC1cdTE5NEYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTGluZWFyX0EnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMVtcdURFMDAtXHVERjdGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5MaW5lYXJfQl9JZGVvZ3JhbXMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMFtcdURDODAtXHVEQ0ZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5MaW5lYXJfQl9TeWxsYWJhcnknLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMFtcdURDMDAtXHVEQzdGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5MaXN1JywNCiAgICAgICAgJ2JtcCc6ICdcdUE0RDAtXHVBNEZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkxvd19TdXJyb2dhdGVzJywNCiAgICAgICAgJ2JtcCc6ICdcdURDMDAtXHVERkZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkx5Y2lhbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAwW1x1REU4MC1cdURFOUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbkx5ZGlhbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1REQyMC1cdUREM0ZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk1haGFqYW5pJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDRbXHVERDUwLVx1REQ3Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTWFoam9uZ19UaWxlcycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODNDW1x1REMwMC1cdURDMkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk1ha2FzYXInLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwN1tcdURFRTAtXHVERUZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5NYWxheWFsYW0nLA0KICAgICAgICAnYm1wJzogJ1x1MEQwMC1cdTBEN0YnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTWFuZGFpYycsDQogICAgICAgICdibXAnOiAnXHUwODQwLVx1MDg1RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5NYW5pY2hhZWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVERUMwLVx1REVGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTWFyY2hlbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA3W1x1REM3MC1cdURDQkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk1hc2FyYW1fR29uZGknLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwN1tcdUREMDAtXHVERDVGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5NYXRoZW1hdGljYWxfQWxwaGFudW1lcmljX1N5bWJvbHMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgzNVtcdURDMDAtXHVERkZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5NYXRoZW1hdGljYWxfT3BlcmF0b3JzJywNCiAgICAgICAgJ2JtcCc6ICdcdTIyMDAtXHUyMkZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk1heWFuX051bWVyYWxzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MzRbXHVERUUwLVx1REVGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTWVkZWZhaWRyaW4nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgxQltcdURFNDAtXHVERTlGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5NZWV0ZWlfTWF5ZWsnLA0KICAgICAgICAnYm1wJzogJ1x1QUJDMC1cdUFCRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTWVldGVpX01heWVrX0V4dGVuc2lvbnMnLA0KICAgICAgICAnYm1wJzogJ1x1QUFFMC1cdUFBRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTWVuZGVfS2lrYWt1aScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODNBW1x1REMwMC1cdURDREZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk1lcm9pdGljX0N1cnNpdmUnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMltcdUREQTAtXHVEREZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5NZXJvaXRpY19IaWVyb2dseXBocycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1REQ4MC1cdUREOUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk1pYW8nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgxQltcdURGMDAtXHVERjlGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5NaXNjZWxsYW5lb3VzX01hdGhlbWF0aWNhbF9TeW1ib2xzX0EnLA0KICAgICAgICAnYm1wJzogJ1x1MjdDMC1cdTI3RUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTWlzY2VsbGFuZW91c19NYXRoZW1hdGljYWxfU3ltYm9sc19CJywNCiAgICAgICAgJ2JtcCc6ICdcdTI5ODAtXHUyOUZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk1pc2NlbGxhbmVvdXNfU3ltYm9scycsDQogICAgICAgICdibXAnOiAnXHUyNjAwLVx1MjZGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5NaXNjZWxsYW5lb3VzX1N5bWJvbHNfQW5kX0Fycm93cycsDQogICAgICAgICdibXAnOiAnXHUyQjAwLVx1MkJGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5NaXNjZWxsYW5lb3VzX1N5bWJvbHNfQW5kX1BpY3RvZ3JhcGhzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4M0NbXHVERjAwLVx1REZGRl18XHVEODNEW1x1REMwMC1cdURERkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk1pc2NlbGxhbmVvdXNfVGVjaG5pY2FsJywNCiAgICAgICAgJ2JtcCc6ICdcdTIzMDAtXHUyM0ZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk1vZGknLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNVtcdURFMDAtXHVERTVGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5Nb2RpZmllcl9Ub25lX0xldHRlcnMnLA0KICAgICAgICAnYm1wJzogJ1x1QTcwMC1cdUE3MUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTW9uZ29saWFuJywNCiAgICAgICAgJ2JtcCc6ICdcdTE4MDAtXHUxOEFGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk1vbmdvbGlhbl9TdXBwbGVtZW50JywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDVbXHVERTYwLVx1REU3Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTXJvJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MUFbXHVERTQwLVx1REU2Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTXVsdGFuaScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA0W1x1REU4MC1cdURFQUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk11c2ljYWxfU3ltYm9scycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODM0W1x1REQwMC1cdURERkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk15YW5tYXInLA0KICAgICAgICAnYm1wJzogJ1x1MTAwMC1cdTEwOUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTXlhbm1hcl9FeHRlbmRlZF9BJywNCiAgICAgICAgJ2JtcCc6ICdcdUFBNjAtXHVBQTdGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk15YW5tYXJfRXh0ZW5kZWRfQicsDQogICAgICAgICdibXAnOiAnXHVBOUUwLVx1QTlGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5OS28nLA0KICAgICAgICAnYm1wJzogJ1x1MDdDMC1cdTA3RkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTmFiYXRhZWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVEQzgwLVx1RENBRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTmV3X1RhaV9MdWUnLA0KICAgICAgICAnYm1wJzogJ1x1MTk4MC1cdTE5REYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luTmV3YScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA1W1x1REMwMC1cdURDN0ZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk51bWJlcl9Gb3JtcycsDQogICAgICAgICdibXAnOiAnXHUyMTUwLVx1MjE4RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5OdXNodScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODJDW1x1REQ3MC1cdURFRkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk9naGFtJywNCiAgICAgICAgJ2JtcCc6ICdcdTE2ODAtXHUxNjlGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk9sX0NoaWtpJywNCiAgICAgICAgJ2JtcCc6ICdcdTFDNTAtXHUxQzdGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk9sZF9IdW5nYXJpYW4nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwM1tcdURDODAtXHVEQ0ZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5PbGRfSXRhbGljJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERjAwLVx1REYyRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luT2xkX05vcnRoX0FyYWJpYW4nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMltcdURFODAtXHVERTlGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5PbGRfUGVybWljJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERjUwLVx1REY3Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luT2xkX1BlcnNpYW4nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMFtcdURGQTAtXHVERkRGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5PbGRfU29nZGlhbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAzW1x1REYwMC1cdURGMkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk9sZF9Tb3V0aF9BcmFiaWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVERTYwLVx1REU3Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luT2xkX1R1cmtpYycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAzW1x1REMwMC1cdURDNEZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk9wdGljYWxfQ2hhcmFjdGVyX1JlY29nbml0aW9uJywNCiAgICAgICAgJ2JtcCc6ICdcdTI0NDAtXHUyNDVGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk9yaXlhJywNCiAgICAgICAgJ2JtcCc6ICdcdTBCMDAtXHUwQjdGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk9ybmFtZW50YWxfRGluZ2JhdHMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgzRFtcdURFNTAtXHVERTdGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5Pc2FnZScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAxW1x1RENCMC1cdURDRkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbk9zbWFueWEnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMVtcdURDODAtXHVEQ0FGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5QYWhhd2hfSG1vbmcnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgxQVtcdURGMDAtXHVERjhGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5QYWxteXJlbmUnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMltcdURDNjAtXHVEQzdGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5QYXVfQ2luX0hhdScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA2W1x1REVDMC1cdURFRkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblBoYWdzX1BhJywNCiAgICAgICAgJ2JtcCc6ICdcdUE4NDAtXHVBODdGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblBoYWlzdG9zX0Rpc2MnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMFtcdURERDAtXHVEREZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5QaG9lbmljaWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVERDAwLVx1REQxRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luUGhvbmV0aWNfRXh0ZW5zaW9ucycsDQogICAgICAgICdibXAnOiAnXHUxRDAwLVx1MUQ3RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5QaG9uZXRpY19FeHRlbnNpb25zX1N1cHBsZW1lbnQnLA0KICAgICAgICAnYm1wJzogJ1x1MUQ4MC1cdTFEQkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luUGxheWluZ19DYXJkcycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODNDW1x1RENBMC1cdURDRkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblByaXZhdGVfVXNlX0FyZWEnLA0KICAgICAgICAnYm1wJzogJ1x1RTAwMC1cdUY4RkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luUHNhbHRlcl9QYWhsYXZpJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVERjgwLVx1REZBRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luUmVqYW5nJywNCiAgICAgICAgJ2JtcCc6ICdcdUE5MzAtXHVBOTVGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblJ1bWlfTnVtZXJhbF9TeW1ib2xzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDNbXHVERTYwLVx1REU3Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luUnVuaWMnLA0KICAgICAgICAnYm1wJzogJ1x1MTZBMC1cdTE2RkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luU2FtYXJpdGFuJywNCiAgICAgICAgJ2JtcCc6ICdcdTA4MDAtXHUwODNGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblNhdXJhc2h0cmEnLA0KICAgICAgICAnYm1wJzogJ1x1QTg4MC1cdUE4REYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luU2hhcmFkYScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA0W1x1REQ4MC1cdUREREZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblNoYXZpYW4nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMVtcdURDNTAtXHVEQzdGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5TaG9ydGhhbmRfRm9ybWF0X0NvbnRyb2xzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MkZbXHVEQ0EwLVx1RENBRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luU2lkZGhhbScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA1W1x1REQ4MC1cdURERkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblNpbmhhbGEnLA0KICAgICAgICAnYm1wJzogJ1x1MEQ4MC1cdTBERkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luU2luaGFsYV9BcmNoYWljX051bWJlcnMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNFtcdURERTAtXHVEREZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5TbWFsbF9Gb3JtX1ZhcmlhbnRzJywNCiAgICAgICAgJ2JtcCc6ICdcdUZFNTAtXHVGRTZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblNvZ2RpYW4nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwM1tcdURGMzAtXHVERjZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5Tb3JhX1NvbXBlbmcnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNFtcdURDRDAtXHVEQ0ZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5Tb3lvbWJvJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDZbXHVERTUwLVx1REVBRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luU3BhY2luZ19Nb2RpZmllcl9MZXR0ZXJzJywNCiAgICAgICAgJ2JtcCc6ICdcdTAyQjAtXHUwMkZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblNwZWNpYWxzJywNCiAgICAgICAgJ2JtcCc6ICdcdUZGRjAtXHVGRkZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblN1bmRhbmVzZScsDQogICAgICAgICdibXAnOiAnXHUxQjgwLVx1MUJCRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5TdW5kYW5lc2VfU3VwcGxlbWVudCcsDQogICAgICAgICdibXAnOiAnXHUxQ0MwLVx1MUNDRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5TdXBlcnNjcmlwdHNfQW5kX1N1YnNjcmlwdHMnLA0KICAgICAgICAnYm1wJzogJ1x1MjA3MC1cdTIwOUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luU3VwcGxlbWVudGFsX0Fycm93c19BJywNCiAgICAgICAgJ2JtcCc6ICdcdTI3RjAtXHUyN0ZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblN1cHBsZW1lbnRhbF9BcnJvd3NfQicsDQogICAgICAgICdibXAnOiAnXHUyOTAwLVx1Mjk3RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5TdXBwbGVtZW50YWxfQXJyb3dzX0MnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgzRVtcdURDMDAtXHVEQ0ZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5TdXBwbGVtZW50YWxfTWF0aGVtYXRpY2FsX09wZXJhdG9ycycsDQogICAgICAgICdibXAnOiAnXHUyQTAwLVx1MkFGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5TdXBwbGVtZW50YWxfUHVuY3R1YXRpb24nLA0KICAgICAgICAnYm1wJzogJ1x1MkUwMC1cdTJFN0YnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luU3VwcGxlbWVudGFsX1N5bWJvbHNfQW5kX1BpY3RvZ3JhcGhzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4M0VbXHVERDAwLVx1RERGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luU3VwcGxlbWVudGFyeV9Qcml2YXRlX1VzZV9BcmVhX0EnLA0KICAgICAgICAnYXN0cmFsJzogJ1tcdURCODAtXHVEQkJGXVtcdURDMDAtXHVERkZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5TdXBwbGVtZW50YXJ5X1ByaXZhdGVfVXNlX0FyZWFfQicsDQogICAgICAgICdhc3RyYWwnOiAnW1x1REJDMC1cdURCRkZdW1x1REMwMC1cdURGRkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblN1dHRvbl9TaWduV3JpdGluZycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODM2W1x1REMwMC1cdURFQUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblN5bG90aV9OYWdyaScsDQogICAgICAgICdibXAnOiAnXHVBODAwLVx1QTgyRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5TeXJpYWMnLA0KICAgICAgICAnYm1wJzogJ1x1MDcwMC1cdTA3NEYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luU3lyaWFjX1N1cHBsZW1lbnQnLA0KICAgICAgICAnYm1wJzogJ1x1MDg2MC1cdTA4NkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luVGFnYWxvZycsDQogICAgICAgICdibXAnOiAnXHUxNzAwLVx1MTcxRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5UYWdiYW53YScsDQogICAgICAgICdibXAnOiAnXHUxNzYwLVx1MTc3RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5UYWdzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdURCNDBbXHVEQzAwLVx1REM3Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luVGFpX0xlJywNCiAgICAgICAgJ2JtcCc6ICdcdTE5NTAtXHUxOTdGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblRhaV9UaGFtJywNCiAgICAgICAgJ2JtcCc6ICdcdTFBMjAtXHUxQUFGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblRhaV9WaWV0JywNCiAgICAgICAgJ2JtcCc6ICdcdUFBODAtXHVBQURGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblRhaV9YdWFuX0ppbmdfU3ltYm9scycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODM0W1x1REYwMC1cdURGNUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblRha3JpJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDVbXHVERTgwLVx1REVDRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luVGFtaWwnLA0KICAgICAgICAnYm1wJzogJ1x1MEI4MC1cdTBCRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luVGFuZ3V0JywNCiAgICAgICAgJ2FzdHJhbCc6ICdbXHVEODFDLVx1RDgyMV1bXHVEQzAwLVx1REZGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luVGFuZ3V0X0NvbXBvbmVudHMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgyMltcdURDMDAtXHVERUZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5UZWx1Z3UnLA0KICAgICAgICAnYm1wJzogJ1x1MEMwMC1cdTBDN0YnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luVGhhYW5hJywNCiAgICAgICAgJ2JtcCc6ICdcdTA3ODAtXHUwN0JGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblRoYWknLA0KICAgICAgICAnYm1wJzogJ1x1MEUwMC1cdTBFN0YnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luVGliZXRhbicsDQogICAgICAgICdibXAnOiAnXHUwRjAwLVx1MEZGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5UaWZpbmFnaCcsDQogICAgICAgICdibXAnOiAnXHUyRDMwLVx1MkQ3RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5UaXJodXRhJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDVbXHVEQzgwLVx1RENERl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luVHJhbnNwb3J0X0FuZF9NYXBfU3ltYm9scycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODNEW1x1REU4MC1cdURFRkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblVnYXJpdGljJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERjgwLVx1REY5Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luVW5pZmllZF9DYW5hZGlhbl9BYm9yaWdpbmFsX1N5bGxhYmljcycsDQogICAgICAgICdibXAnOiAnXHUxNDAwLVx1MTY3RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5VbmlmaWVkX0NhbmFkaWFuX0Fib3JpZ2luYWxfU3lsbGFiaWNzX0V4dGVuZGVkJywNCiAgICAgICAgJ2JtcCc6ICdcdTE4QjAtXHUxOEZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblZhaScsDQogICAgICAgICdibXAnOiAnXHVBNTAwLVx1QTYzRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5WYXJpYXRpb25fU2VsZWN0b3JzJywNCiAgICAgICAgJ2JtcCc6ICdcdUZFMDAtXHVGRTBGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblZhcmlhdGlvbl9TZWxlY3RvcnNfU3VwcGxlbWVudCcsDQogICAgICAgICdhc3RyYWwnOiAnXHVEQjQwW1x1REQwMC1cdURERUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJblZlZGljX0V4dGVuc2lvbnMnLA0KICAgICAgICAnYm1wJzogJ1x1MUNEMC1cdTFDRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luVmVydGljYWxfRm9ybXMnLA0KICAgICAgICAnYm1wJzogJ1x1RkUxMC1cdUZFMUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luV2FyYW5nX0NpdGknLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNltcdURDQTAtXHVEQ0ZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5ZaV9SYWRpY2FscycsDQogICAgICAgICdibXAnOiAnXHVBNDkwLVx1QTRDRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5ZaV9TeWxsYWJsZXMnLA0KICAgICAgICAnYm1wJzogJ1x1QTAwMC1cdUE0OEYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luWWlqaW5nX0hleGFncmFtX1N5bWJvbHMnLA0KICAgICAgICAnYm1wJzogJ1x1NERDMC1cdTRERkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luWmFuYWJhemFyX1NxdWFyZScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA2W1x1REUwMC1cdURFNEZdJw0KICAgIH0NCl07DQoNCn0se31dLDExOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCm1vZHVsZS5leHBvcnRzID0gWw0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnQycsDQogICAgICAgICdhbGlhcyc6ICdPdGhlcicsDQogICAgICAgICdpc0JtcExhc3QnOiB0cnVlLA0KICAgICAgICAnYm1wJzogJ1wwLVx4MUZceDdGLVx4OUZceEFEXHUwMzc4XHUwMzc5XHUwMzgwLVx1MDM4M1x1MDM4Qlx1MDM4RFx1MDNBMlx1MDUzMFx1MDU1N1x1MDU1OFx1MDU4Qlx1MDU4Q1x1MDU5MFx1MDVDOC1cdTA1Q0ZcdTA1RUItXHUwNUVFXHUwNUY1LVx1MDYwNVx1MDYxQ1x1MDYxRFx1MDZERFx1MDcwRVx1MDcwRlx1MDc0Qlx1MDc0Q1x1MDdCMi1cdTA3QkZcdTA3RkJcdTA3RkNcdTA4MkVcdTA4MkZcdTA4M0ZcdTA4NUNcdTA4NURcdTA4NUZcdTA4NkItXHUwODlGXHUwOEI1XHUwOEJFLVx1MDhEMlx1MDhFMlx1MDk4NFx1MDk4RFx1MDk4RVx1MDk5MVx1MDk5Mlx1MDlBOVx1MDlCMVx1MDlCMy1cdTA5QjVcdTA5QkFcdTA5QkJcdTA5QzVcdTA5QzZcdTA5QzlcdTA5Q0FcdTA5Q0YtXHUwOUQ2XHUwOUQ4LVx1MDlEQlx1MDlERVx1MDlFNFx1MDlFNVx1MDlGRlx1MEEwMFx1MEEwNFx1MEEwQi1cdTBBMEVcdTBBMTFcdTBBMTJcdTBBMjlcdTBBMzFcdTBBMzRcdTBBMzdcdTBBM0FcdTBBM0JcdTBBM0RcdTBBNDMtXHUwQTQ2XHUwQTQ5XHUwQTRBXHUwQTRFLVx1MEE1MFx1MEE1Mi1cdTBBNThcdTBBNURcdTBBNUYtXHUwQTY1XHUwQTc3LVx1MEE4MFx1MEE4NFx1MEE4RVx1MEE5Mlx1MEFBOVx1MEFCMVx1MEFCNFx1MEFCQVx1MEFCQlx1MEFDNlx1MEFDQVx1MEFDRVx1MEFDRlx1MEFEMS1cdTBBREZcdTBBRTRcdTBBRTVcdTBBRjItXHUwQUY4XHUwQjAwXHUwQjA0XHUwQjBEXHUwQjBFXHUwQjExXHUwQjEyXHUwQjI5XHUwQjMxXHUwQjM0XHUwQjNBXHUwQjNCXHUwQjQ1XHUwQjQ2XHUwQjQ5XHUwQjRBXHUwQjRFLVx1MEI1NVx1MEI1OC1cdTBCNUJcdTBCNUVcdTBCNjRcdTBCNjVcdTBCNzgtXHUwQjgxXHUwQjg0XHUwQjhCLVx1MEI4RFx1MEI5MVx1MEI5Ni1cdTBCOThcdTBCOUJcdTBCOURcdTBCQTAtXHUwQkEyXHUwQkE1LVx1MEJBN1x1MEJBQi1cdTBCQURcdTBCQkEtXHUwQkJEXHUwQkMzLVx1MEJDNVx1MEJDOVx1MEJDRVx1MEJDRlx1MEJEMS1cdTBCRDZcdTBCRDgtXHUwQkU1XHUwQkZCLVx1MEJGRlx1MEMwRFx1MEMxMVx1MEMyOVx1MEMzQS1cdTBDM0NcdTBDNDVcdTBDNDlcdTBDNEUtXHUwQzU0XHUwQzU3XHUwQzVCLVx1MEM1Rlx1MEM2NFx1MEM2NVx1MEM3MC1cdTBDNzdcdTBDOERcdTBDOTFcdTBDQTlcdTBDQjRcdTBDQkFcdTBDQkJcdTBDQzVcdTBDQzlcdTBDQ0UtXHUwQ0Q0XHUwQ0Q3LVx1MENERFx1MENERlx1MENFNFx1MENFNVx1MENGMFx1MENGMy1cdTBDRkZcdTBEMDRcdTBEMERcdTBEMTFcdTBENDVcdTBENDlcdTBENTAtXHUwRDUzXHUwRDY0XHUwRDY1XHUwRDgwXHUwRDgxXHUwRDg0XHUwRDk3LVx1MEQ5OVx1MERCMlx1MERCQ1x1MERCRVx1MERCRlx1MERDNy1cdTBEQzlcdTBEQ0ItXHUwRENFXHUwREQ1XHUwREQ3XHUwREUwLVx1MERFNVx1MERGMFx1MERGMVx1MERGNS1cdTBFMDBcdTBFM0ItXHUwRTNFXHUwRTVDLVx1MEU4MFx1MEU4M1x1MEU4NVx1MEU4Nlx1MEU4OVx1MEU4Qlx1MEU4Q1x1MEU4RS1cdTBFOTNcdTBFOThcdTBFQTBcdTBFQTRcdTBFQTZcdTBFQThcdTBFQTlcdTBFQUNcdTBFQkFcdTBFQkVcdTBFQkZcdTBFQzVcdTBFQzdcdTBFQ0VcdTBFQ0ZcdTBFREFcdTBFREJcdTBFRTAtXHUwRUZGXHUwRjQ4XHUwRjZELVx1MEY3MFx1MEY5OFx1MEZCRFx1MEZDRFx1MEZEQi1cdTBGRkZcdTEwQzZcdTEwQzgtXHUxMENDXHUxMENFXHUxMENGXHUxMjQ5XHUxMjRFXHUxMjRGXHUxMjU3XHUxMjU5XHUxMjVFXHUxMjVGXHUxMjg5XHUxMjhFXHUxMjhGXHUxMkIxXHUxMkI2XHUxMkI3XHUxMkJGXHUxMkMxXHUxMkM2XHUxMkM3XHUxMkQ3XHUxMzExXHUxMzE2XHUxMzE3XHUxMzVCXHUxMzVDXHUxMzdELVx1MTM3Rlx1MTM5QS1cdTEzOUZcdTEzRjZcdTEzRjdcdTEzRkVcdTEzRkZcdTE2OUQtXHUxNjlGXHUxNkY5LVx1MTZGRlx1MTcwRFx1MTcxNS1cdTE3MUZcdTE3MzctXHUxNzNGXHUxNzU0LVx1MTc1Rlx1MTc2RFx1MTc3MVx1MTc3NC1cdTE3N0ZcdTE3REVcdTE3REZcdTE3RUEtXHUxN0VGXHUxN0ZBLVx1MTdGRlx1MTgwRVx1MTgwRlx1MTgxQS1cdTE4MUZcdTE4NzktXHUxODdGXHUxOEFCLVx1MThBRlx1MThGNi1cdTE4RkZcdTE5MUZcdTE5MkMtXHUxOTJGXHUxOTNDLVx1MTkzRlx1MTk0MS1cdTE5NDNcdTE5NkVcdTE5NkZcdTE5NzUtXHUxOTdGXHUxOUFDLVx1MTlBRlx1MTlDQS1cdTE5Q0ZcdTE5REItXHUxOUREXHUxQTFDXHUxQTFEXHUxQTVGXHUxQTdEXHUxQTdFXHUxQThBLVx1MUE4Rlx1MUE5QS1cdTFBOUZcdTFBQUVcdTFBQUZcdTFBQkYtXHUxQUZGXHUxQjRDLVx1MUI0Rlx1MUI3RC1cdTFCN0ZcdTFCRjQtXHUxQkZCXHUxQzM4LVx1MUMzQVx1MUM0QS1cdTFDNENcdTFDODktXHUxQzhGXHUxQ0JCXHUxQ0JDXHUxQ0M4LVx1MUNDRlx1MUNGQS1cdTFDRkZcdTFERkFcdTFGMTZcdTFGMTdcdTFGMUVcdTFGMUZcdTFGNDZcdTFGNDdcdTFGNEVcdTFGNEZcdTFGNThcdTFGNUFcdTFGNUNcdTFGNUVcdTFGN0VcdTFGN0ZcdTFGQjVcdTFGQzVcdTFGRDRcdTFGRDVcdTFGRENcdTFGRjBcdTFGRjFcdTFGRjVcdTFGRkZcdTIwMEItXHUyMDBGXHUyMDJBLVx1MjAyRVx1MjA2MC1cdTIwNkZcdTIwNzJcdTIwNzNcdTIwOEZcdTIwOUQtXHUyMDlGXHUyMEMwLVx1MjBDRlx1MjBGMS1cdTIwRkZcdTIxOEMtXHUyMThGXHUyNDI3LVx1MjQzRlx1MjQ0Qi1cdTI0NUZcdTJCNzRcdTJCNzVcdTJCOTZcdTJCOTdcdTJCQzlcdTJCRkZcdTJDMkZcdTJDNUZcdTJDRjQtXHUyQ0Y4XHUyRDI2XHUyRDI4LVx1MkQyQ1x1MkQyRVx1MkQyRlx1MkQ2OC1cdTJENkVcdTJENzEtXHUyRDdFXHUyRDk3LVx1MkQ5Rlx1MkRBN1x1MkRBRlx1MkRCN1x1MkRCRlx1MkRDN1x1MkRDRlx1MkREN1x1MkRERlx1MkU0Ri1cdTJFN0ZcdTJFOUFcdTJFRjQtXHUyRUZGXHUyRkQ2LVx1MkZFRlx1MkZGQy1cdTJGRkZcdTMwNDBcdTMwOTdcdTMwOThcdTMxMDAtXHUzMTA0XHUzMTMwXHUzMThGXHUzMUJCLVx1MzFCRlx1MzFFNC1cdTMxRUZcdTMyMUZcdTMyRkZcdTREQjYtXHU0REJGXHU5RkYwLVx1OUZGRlx1QTQ4RC1cdUE0OEZcdUE0QzctXHVBNENGXHVBNjJDLVx1QTYzRlx1QTZGOC1cdUE2RkZcdUE3QkEtXHVBN0Y2XHVBODJDLVx1QTgyRlx1QTgzQS1cdUE4M0ZcdUE4NzgtXHVBODdGXHVBOEM2LVx1QThDRFx1QThEQS1cdUE4REZcdUE5NTQtXHVBOTVFXHVBOTdELVx1QTk3Rlx1QTlDRVx1QTlEQS1cdUE5RERcdUE5RkZcdUFBMzctXHVBQTNGXHVBQTRFXHVBQTRGXHVBQTVBXHVBQTVCXHVBQUMzLVx1QUFEQVx1QUFGNy1cdUFCMDBcdUFCMDdcdUFCMDhcdUFCMEZcdUFCMTBcdUFCMTctXHVBQjFGXHVBQjI3XHVBQjJGXHVBQjY2LVx1QUI2Rlx1QUJFRVx1QUJFRlx1QUJGQS1cdUFCRkZcdUQ3QTQtXHVEN0FGXHVEN0M3LVx1RDdDQVx1RDdGQy1cdUY4RkZcdUZBNkVcdUZBNkZcdUZBREEtXHVGQUZGXHVGQjA3LVx1RkIxMlx1RkIxOC1cdUZCMUNcdUZCMzdcdUZCM0RcdUZCM0ZcdUZCNDJcdUZCNDVcdUZCQzItXHVGQkQyXHVGRDQwLVx1RkQ0Rlx1RkQ5MFx1RkQ5MVx1RkRDOC1cdUZERUZcdUZERkVcdUZERkZcdUZFMUEtXHVGRTFGXHVGRTUzXHVGRTY3XHVGRTZDLVx1RkU2Rlx1RkU3NVx1RkVGRC1cdUZGMDBcdUZGQkYtXHVGRkMxXHVGRkM4XHVGRkM5XHVGRkQwXHVGRkQxXHVGRkQ4XHVGRkQ5XHVGRkRELVx1RkZERlx1RkZFN1x1RkZFRi1cdUZGRkJcdUZGRkVcdUZGRkYnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMFtcdURDMENcdURDMjdcdURDM0JcdURDM0VcdURDNEVcdURDNEZcdURDNUUtXHVEQzdGXHVEQ0ZCLVx1RENGRlx1REQwMy1cdUREMDZcdUREMzQtXHVERDM2XHVERDhGXHVERDlDLVx1REQ5Rlx1RERBMS1cdUREQ0ZcdURERkUtXHVERTdGXHVERTlELVx1REU5Rlx1REVEMS1cdURFREZcdURFRkMtXHVERUZGXHVERjI0LVx1REYyQ1x1REY0Qi1cdURGNEZcdURGN0ItXHVERjdGXHVERjlFXHVERkM0LVx1REZDN1x1REZENi1cdURGRkZdfFx1RDgwMVtcdURDOUVcdURDOUZcdURDQUEtXHVEQ0FGXHVEQ0Q0LVx1RENEN1x1RENGQy1cdURDRkZcdUREMjgtXHVERDJGXHVERDY0LVx1REQ2RVx1REQ3MC1cdURERkZcdURGMzctXHVERjNGXHVERjU2LVx1REY1Rlx1REY2OC1cdURGRkZdfFx1RDgwMltcdURDMDZcdURDMDdcdURDMDlcdURDMzZcdURDMzktXHVEQzNCXHVEQzNEXHVEQzNFXHVEQzU2XHVEQzlGLVx1RENBNlx1RENCMC1cdURDREZcdURDRjNcdURDRjYtXHVEQ0ZBXHVERDFDLVx1REQxRVx1REQzQS1cdUREM0VcdURENDAtXHVERDdGXHVEREI4LVx1RERCQlx1REREMFx1REREMVx1REUwNFx1REUwNy1cdURFMEJcdURFMTRcdURFMThcdURFMzZcdURFMzdcdURFM0ItXHVERTNFXHVERTQ5LVx1REU0Rlx1REU1OS1cdURFNUZcdURFQTAtXHVERUJGXHVERUU3LVx1REVFQVx1REVGNy1cdURFRkZcdURGMzYtXHVERjM4XHVERjU2XHVERjU3XHVERjczLVx1REY3N1x1REY5Mi1cdURGOThcdURGOUQtXHVERkE4XHVERkIwLVx1REZGRl18XHVEODAzW1x1REM0OS1cdURDN0ZcdURDQjMtXHVEQ0JGXHVEQ0YzLVx1RENGOVx1REQyOC1cdUREMkZcdUREM0EtXHVERTVGXHVERTdGLVx1REVGRlx1REYyOC1cdURGMkZcdURGNUEtXHVERkZGXXxcdUQ4MDRbXHVEQzRFLVx1REM1MVx1REM3MC1cdURDN0VcdURDQkRcdURDQzItXHVEQ0NGXHVEQ0U5LVx1RENFRlx1RENGQS1cdURDRkZcdUREMzVcdURENDctXHVERDRGXHVERDc3LVx1REQ3Rlx1RERDRVx1RERDRlx1RERFMFx1RERGNS1cdURERkZcdURFMTJcdURFM0YtXHVERTdGXHVERTg3XHVERTg5XHVERThFXHVERTlFXHVERUFBLVx1REVBRlx1REVFQi1cdURFRUZcdURFRkEtXHVERUZGXHVERjA0XHVERjBEXHVERjBFXHVERjExXHVERjEyXHVERjI5XHVERjMxXHVERjM0XHVERjNBXHVERjQ1XHVERjQ2XHVERjQ5XHVERjRBXHVERjRFXHVERjRGXHVERjUxLVx1REY1Nlx1REY1OC1cdURGNUNcdURGNjRcdURGNjVcdURGNkQtXHVERjZGXHVERjc1LVx1REZGRl18XHVEODA1W1x1REM1QVx1REM1Q1x1REM1Ri1cdURDN0ZcdURDQzgtXHVEQ0NGXHVEQ0RBLVx1REQ3Rlx1RERCNlx1RERCN1x1RERERS1cdURERkZcdURFNDUtXHVERTRGXHVERTVBLVx1REU1Rlx1REU2RC1cdURFN0ZcdURFQjgtXHVERUJGXHVERUNBLVx1REVGRlx1REYxQlx1REYxQ1x1REYyQy1cdURGMkZcdURGNDAtXHVERkZGXXxcdUQ4MDZbXHVEQzNDLVx1REM5Rlx1RENGMy1cdURDRkVcdUREMDAtXHVEREZGXHVERTQ4LVx1REU0Rlx1REU4NFx1REU4NVx1REVBMy1cdURFQkZcdURFRjktXHVERkZGXXxcdUQ4MDdbXHVEQzA5XHVEQzM3XHVEQzQ2LVx1REM0Rlx1REM2RC1cdURDNkZcdURDOTBcdURDOTFcdURDQThcdURDQjctXHVEQ0ZGXHVERDA3XHVERDBBXHVERDM3LVx1REQzOVx1REQzQlx1REQzRVx1REQ0OC1cdURENEZcdURENUEtXHVERDVGXHVERDY2XHVERDY5XHVERDhGXHVERDkyXHVERDk5LVx1REQ5Rlx1RERBQS1cdURFREZcdURFRjktXHVERkZGXXxcdUQ4MDhbXHVERjlBLVx1REZGRl18XHVEODA5W1x1REM2Rlx1REM3NS1cdURDN0ZcdURENDQtXHVERkZGXXxbXHVEODBBXHVEODBCXHVEODBFLVx1RDgxMFx1RDgxMi1cdUQ4MTlcdUQ4MjMtXHVEODJCXHVEODJEXHVEODJFXHVEODMwLVx1RDgzM1x1RDgzN1x1RDgzOVx1RDgzRlx1RDg3Qi1cdUQ4N0RcdUQ4N0YtXHVEQjNGXHVEQjQxLVx1REJGRl1bXHVEQzAwLVx1REZGRl18XHVEODBEW1x1REMyRi1cdURGRkZdfFx1RDgxMVtcdURFNDctXHVERkZGXXxcdUQ4MUFbXHVERTM5LVx1REUzRlx1REU1Rlx1REU2QS1cdURFNkRcdURFNzAtXHVERUNGXHVERUVFXHVERUVGXHVERUY2LVx1REVGRlx1REY0Ni1cdURGNEZcdURGNUFcdURGNjJcdURGNzgtXHVERjdDXHVERjkwLVx1REZGRl18XHVEODFCW1x1REMwMC1cdURFM0ZcdURFOUItXHVERUZGXHVERjQ1LVx1REY0Rlx1REY3Ri1cdURGOEVcdURGQTAtXHVERkRGXHVERkUyLVx1REZGRl18XHVEODIxW1x1REZGMi1cdURGRkZdfFx1RDgyMltcdURFRjMtXHVERkZGXXxcdUQ4MkNbXHVERDFGLVx1REQ2Rlx1REVGQy1cdURGRkZdfFx1RDgyRltcdURDNkItXHVEQzZGXHVEQzdELVx1REM3Rlx1REM4OS1cdURDOEZcdURDOUFcdURDOUJcdURDQTAtXHVERkZGXXxcdUQ4MzRbXHVEQ0Y2LVx1RENGRlx1REQyN1x1REQyOFx1REQ3My1cdUREN0FcdURERTktXHVEREZGXHVERTQ2LVx1REVERlx1REVGNC1cdURFRkZcdURGNTctXHVERjVGXHVERjc5LVx1REZGRl18XHVEODM1W1x1REM1NVx1REM5RFx1RENBMFx1RENBMVx1RENBM1x1RENBNFx1RENBN1x1RENBOFx1RENBRFx1RENCQVx1RENCQ1x1RENDNFx1REQwNlx1REQwQlx1REQwQ1x1REQxNVx1REQxRFx1REQzQVx1REQzRlx1REQ0NVx1REQ0Ny1cdURENDlcdURENTFcdURFQTZcdURFQTdcdURGQ0NcdURGQ0RdfFx1RDgzNltcdURFOEMtXHVERTlBXHVERUEwXHVERUIwLVx1REZGRl18XHVEODM4W1x1REMwN1x1REMxOVx1REMxQVx1REMyMlx1REMyNVx1REMyQi1cdURGRkZdfFx1RDgzQVtcdURDQzVcdURDQzZcdURDRDctXHVEQ0ZGXHVERDRCLVx1REQ0Rlx1REQ1QS1cdURENURcdURENjAtXHVERkZGXXxcdUQ4M0JbXHVEQzAwLVx1REM3MFx1RENCNS1cdURERkZcdURFMDRcdURFMjBcdURFMjNcdURFMjVcdURFMjZcdURFMjhcdURFMzNcdURFMzhcdURFM0FcdURFM0MtXHVERTQxXHVERTQzLVx1REU0Nlx1REU0OFx1REU0QVx1REU0Q1x1REU1MFx1REU1M1x1REU1NVx1REU1Nlx1REU1OFx1REU1QVx1REU1Q1x1REU1RVx1REU2MFx1REU2M1x1REU2NVx1REU2Nlx1REU2Qlx1REU3M1x1REU3OFx1REU3RFx1REU3Rlx1REU4QVx1REU5Qy1cdURFQTBcdURFQTRcdURFQUFcdURFQkMtXHVERUVGXHVERUYyLVx1REZGRl18XHVEODNDW1x1REMyQy1cdURDMkZcdURDOTQtXHVEQzlGXHVEQ0FGXHVEQ0IwXHVEQ0MwXHVEQ0QwXHVEQ0Y2LVx1RENGRlx1REQwRC1cdUREMEZcdURENkMtXHVERDZGXHVEREFELVx1RERFNVx1REUwMy1cdURFMEZcdURFM0MtXHVERTNGXHVERTQ5LVx1REU0Rlx1REU1Mi1cdURFNUZcdURFNjYtXHVERUZGXXxcdUQ4M0RbXHVERUQ1LVx1REVERlx1REVFRC1cdURFRUZcdURFRkEtXHVERUZGXHVERjc0LVx1REY3Rlx1REZEOS1cdURGRkZdfFx1RDgzRVtcdURDMEMtXHVEQzBGXHVEQzQ4LVx1REM0Rlx1REM1QS1cdURDNUZcdURDODgtXHVEQzhGXHVEQ0FFLVx1RENGRlx1REQwQy1cdUREMEZcdUREM0ZcdURENzFcdURENzJcdURENzctXHVERDc5XHVERDdCXHVEREEzLVx1RERBRlx1RERCQS1cdUREQkZcdUREQzMtXHVERENGXHVERTAwLVx1REU1Rlx1REU2RS1cdURGRkZdfFx1RDg2OVtcdURFRDctXHVERUZGXXxcdUQ4NkRbXHVERjM1LVx1REYzRl18XHVEODZFW1x1REMxRVx1REMxRl18XHVEODczW1x1REVBMi1cdURFQUZdfFx1RDg3QVtcdURGRTEtXHVERkZGXXxcdUQ4N0VbXHVERTFFLVx1REZGRl18XHVEQjQwW1x1REMwMC1cdURDRkZcdURERjAtXHVERkZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnQ2MnLA0KICAgICAgICAnYWxpYXMnOiAnQ29udHJvbCcsDQogICAgICAgICdibXAnOiAnXDAtXHgxRlx4N0YtXHg5RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnQ2YnLA0KICAgICAgICAnYWxpYXMnOiAnRm9ybWF0JywNCiAgICAgICAgJ2JtcCc6ICdceEFEXHUwNjAwLVx1MDYwNVx1MDYxQ1x1MDZERFx1MDcwRlx1MDhFMlx1MTgwRVx1MjAwQi1cdTIwMEZcdTIwMkEtXHUyMDJFXHUyMDYwLVx1MjA2NFx1MjA2Ni1cdTIwNkZcdUZFRkZcdUZGRjktXHVGRkZCJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDRbXHVEQ0JEXHVEQ0NEXXxcdUQ4MkZbXHVEQ0EwLVx1RENBM118XHVEODM0W1x1REQ3My1cdUREN0FdfFx1REI0MFtcdURDMDFcdURDMjAtXHVEQzdGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnQ24nLA0KICAgICAgICAnYWxpYXMnOiAnVW5hc3NpZ25lZCcsDQogICAgICAgICdibXAnOiAnXHUwMzc4XHUwMzc5XHUwMzgwLVx1MDM4M1x1MDM4Qlx1MDM4RFx1MDNBMlx1MDUzMFx1MDU1N1x1MDU1OFx1MDU4Qlx1MDU4Q1x1MDU5MFx1MDVDOC1cdTA1Q0ZcdTA1RUItXHUwNUVFXHUwNUY1LVx1MDVGRlx1MDYxRFx1MDcwRVx1MDc0Qlx1MDc0Q1x1MDdCMi1cdTA3QkZcdTA3RkJcdTA3RkNcdTA4MkVcdTA4MkZcdTA4M0ZcdTA4NUNcdTA4NURcdTA4NUZcdTA4NkItXHUwODlGXHUwOEI1XHUwOEJFLVx1MDhEMlx1MDk4NFx1MDk4RFx1MDk4RVx1MDk5MVx1MDk5Mlx1MDlBOVx1MDlCMVx1MDlCMy1cdTA5QjVcdTA5QkFcdTA5QkJcdTA5QzVcdTA5QzZcdTA5QzlcdTA5Q0FcdTA5Q0YtXHUwOUQ2XHUwOUQ4LVx1MDlEQlx1MDlERVx1MDlFNFx1MDlFNVx1MDlGRlx1MEEwMFx1MEEwNFx1MEEwQi1cdTBBMEVcdTBBMTFcdTBBMTJcdTBBMjlcdTBBMzFcdTBBMzRcdTBBMzdcdTBBM0FcdTBBM0JcdTBBM0RcdTBBNDMtXHUwQTQ2XHUwQTQ5XHUwQTRBXHUwQTRFLVx1MEE1MFx1MEE1Mi1cdTBBNThcdTBBNURcdTBBNUYtXHUwQTY1XHUwQTc3LVx1MEE4MFx1MEE4NFx1MEE4RVx1MEE5Mlx1MEFBOVx1MEFCMVx1MEFCNFx1MEFCQVx1MEFCQlx1MEFDNlx1MEFDQVx1MEFDRVx1MEFDRlx1MEFEMS1cdTBBREZcdTBBRTRcdTBBRTVcdTBBRjItXHUwQUY4XHUwQjAwXHUwQjA0XHUwQjBEXHUwQjBFXHUwQjExXHUwQjEyXHUwQjI5XHUwQjMxXHUwQjM0XHUwQjNBXHUwQjNCXHUwQjQ1XHUwQjQ2XHUwQjQ5XHUwQjRBXHUwQjRFLVx1MEI1NVx1MEI1OC1cdTBCNUJcdTBCNUVcdTBCNjRcdTBCNjVcdTBCNzgtXHUwQjgxXHUwQjg0XHUwQjhCLVx1MEI4RFx1MEI5MVx1MEI5Ni1cdTBCOThcdTBCOUJcdTBCOURcdTBCQTAtXHUwQkEyXHUwQkE1LVx1MEJBN1x1MEJBQi1cdTBCQURcdTBCQkEtXHUwQkJEXHUwQkMzLVx1MEJDNVx1MEJDOVx1MEJDRVx1MEJDRlx1MEJEMS1cdTBCRDZcdTBCRDgtXHUwQkU1XHUwQkZCLVx1MEJGRlx1MEMwRFx1MEMxMVx1MEMyOVx1MEMzQS1cdTBDM0NcdTBDNDVcdTBDNDlcdTBDNEUtXHUwQzU0XHUwQzU3XHUwQzVCLVx1MEM1Rlx1MEM2NFx1MEM2NVx1MEM3MC1cdTBDNzdcdTBDOERcdTBDOTFcdTBDQTlcdTBDQjRcdTBDQkFcdTBDQkJcdTBDQzVcdTBDQzlcdTBDQ0UtXHUwQ0Q0XHUwQ0Q3LVx1MENERFx1MENERlx1MENFNFx1MENFNVx1MENGMFx1MENGMy1cdTBDRkZcdTBEMDRcdTBEMERcdTBEMTFcdTBENDVcdTBENDlcdTBENTAtXHUwRDUzXHUwRDY0XHUwRDY1XHUwRDgwXHUwRDgxXHUwRDg0XHUwRDk3LVx1MEQ5OVx1MERCMlx1MERCQ1x1MERCRVx1MERCRlx1MERDNy1cdTBEQzlcdTBEQ0ItXHUwRENFXHUwREQ1XHUwREQ3XHUwREUwLVx1MERFNVx1MERGMFx1MERGMVx1MERGNS1cdTBFMDBcdTBFM0ItXHUwRTNFXHUwRTVDLVx1MEU4MFx1MEU4M1x1MEU4NVx1MEU4Nlx1MEU4OVx1MEU4Qlx1MEU4Q1x1MEU4RS1cdTBFOTNcdTBFOThcdTBFQTBcdTBFQTRcdTBFQTZcdTBFQThcdTBFQTlcdTBFQUNcdTBFQkFcdTBFQkVcdTBFQkZcdTBFQzVcdTBFQzdcdTBFQ0VcdTBFQ0ZcdTBFREFcdTBFREJcdTBFRTAtXHUwRUZGXHUwRjQ4XHUwRjZELVx1MEY3MFx1MEY5OFx1MEZCRFx1MEZDRFx1MEZEQi1cdTBGRkZcdTEwQzZcdTEwQzgtXHUxMENDXHUxMENFXHUxMENGXHUxMjQ5XHUxMjRFXHUxMjRGXHUxMjU3XHUxMjU5XHUxMjVFXHUxMjVGXHUxMjg5XHUxMjhFXHUxMjhGXHUxMkIxXHUxMkI2XHUxMkI3XHUxMkJGXHUxMkMxXHUxMkM2XHUxMkM3XHUxMkQ3XHUxMzExXHUxMzE2XHUxMzE3XHUxMzVCXHUxMzVDXHUxMzdELVx1MTM3Rlx1MTM5QS1cdTEzOUZcdTEzRjZcdTEzRjdcdTEzRkVcdTEzRkZcdTE2OUQtXHUxNjlGXHUxNkY5LVx1MTZGRlx1MTcwRFx1MTcxNS1cdTE3MUZcdTE3MzctXHUxNzNGXHUxNzU0LVx1MTc1Rlx1MTc2RFx1MTc3MVx1MTc3NC1cdTE3N0ZcdTE3REVcdTE3REZcdTE3RUEtXHUxN0VGXHUxN0ZBLVx1MTdGRlx1MTgwRlx1MTgxQS1cdTE4MUZcdTE4NzktXHUxODdGXHUxOEFCLVx1MThBRlx1MThGNi1cdTE4RkZcdTE5MUZcdTE5MkMtXHUxOTJGXHUxOTNDLVx1MTkzRlx1MTk0MS1cdTE5NDNcdTE5NkVcdTE5NkZcdTE5NzUtXHUxOTdGXHUxOUFDLVx1MTlBRlx1MTlDQS1cdTE5Q0ZcdTE5REItXHUxOUREXHUxQTFDXHUxQTFEXHUxQTVGXHUxQTdEXHUxQTdFXHUxQThBLVx1MUE4Rlx1MUE5QS1cdTFBOUZcdTFBQUVcdTFBQUZcdTFBQkYtXHUxQUZGXHUxQjRDLVx1MUI0Rlx1MUI3RC1cdTFCN0ZcdTFCRjQtXHUxQkZCXHUxQzM4LVx1MUMzQVx1MUM0QS1cdTFDNENcdTFDODktXHUxQzhGXHUxQ0JCXHUxQ0JDXHUxQ0M4LVx1MUNDRlx1MUNGQS1cdTFDRkZcdTFERkFcdTFGMTZcdTFGMTdcdTFGMUVcdTFGMUZcdTFGNDZcdTFGNDdcdTFGNEVcdTFGNEZcdTFGNThcdTFGNUFcdTFGNUNcdTFGNUVcdTFGN0VcdTFGN0ZcdTFGQjVcdTFGQzVcdTFGRDRcdTFGRDVcdTFGRENcdTFGRjBcdTFGRjFcdTFGRjVcdTFGRkZcdTIwNjVcdTIwNzJcdTIwNzNcdTIwOEZcdTIwOUQtXHUyMDlGXHUyMEMwLVx1MjBDRlx1MjBGMS1cdTIwRkZcdTIxOEMtXHUyMThGXHUyNDI3LVx1MjQzRlx1MjQ0Qi1cdTI0NUZcdTJCNzRcdTJCNzVcdTJCOTZcdTJCOTdcdTJCQzlcdTJCRkZcdTJDMkZcdTJDNUZcdTJDRjQtXHUyQ0Y4XHUyRDI2XHUyRDI4LVx1MkQyQ1x1MkQyRVx1MkQyRlx1MkQ2OC1cdTJENkVcdTJENzEtXHUyRDdFXHUyRDk3LVx1MkQ5Rlx1MkRBN1x1MkRBRlx1MkRCN1x1MkRCRlx1MkRDN1x1MkRDRlx1MkREN1x1MkRERlx1MkU0Ri1cdTJFN0ZcdTJFOUFcdTJFRjQtXHUyRUZGXHUyRkQ2LVx1MkZFRlx1MkZGQy1cdTJGRkZcdTMwNDBcdTMwOTdcdTMwOThcdTMxMDAtXHUzMTA0XHUzMTMwXHUzMThGXHUzMUJCLVx1MzFCRlx1MzFFNC1cdTMxRUZcdTMyMUZcdTMyRkZcdTREQjYtXHU0REJGXHU5RkYwLVx1OUZGRlx1QTQ4RC1cdUE0OEZcdUE0QzctXHVBNENGXHVBNjJDLVx1QTYzRlx1QTZGOC1cdUE2RkZcdUE3QkEtXHVBN0Y2XHVBODJDLVx1QTgyRlx1QTgzQS1cdUE4M0ZcdUE4NzgtXHVBODdGXHVBOEM2LVx1QThDRFx1QThEQS1cdUE4REZcdUE5NTQtXHVBOTVFXHVBOTdELVx1QTk3Rlx1QTlDRVx1QTlEQS1cdUE5RERcdUE5RkZcdUFBMzctXHVBQTNGXHVBQTRFXHVBQTRGXHVBQTVBXHVBQTVCXHVBQUMzLVx1QUFEQVx1QUFGNy1cdUFCMDBcdUFCMDdcdUFCMDhcdUFCMEZcdUFCMTBcdUFCMTctXHVBQjFGXHVBQjI3XHVBQjJGXHVBQjY2LVx1QUI2Rlx1QUJFRVx1QUJFRlx1QUJGQS1cdUFCRkZcdUQ3QTQtXHVEN0FGXHVEN0M3LVx1RDdDQVx1RDdGQy1cdUQ3RkZcdUZBNkVcdUZBNkZcdUZBREEtXHVGQUZGXHVGQjA3LVx1RkIxMlx1RkIxOC1cdUZCMUNcdUZCMzdcdUZCM0RcdUZCM0ZcdUZCNDJcdUZCNDVcdUZCQzItXHVGQkQyXHVGRDQwLVx1RkQ0Rlx1RkQ5MFx1RkQ5MVx1RkRDOC1cdUZERUZcdUZERkVcdUZERkZcdUZFMUEtXHVGRTFGXHVGRTUzXHVGRTY3XHVGRTZDLVx1RkU2Rlx1RkU3NVx1RkVGRFx1RkVGRVx1RkYwMFx1RkZCRi1cdUZGQzFcdUZGQzhcdUZGQzlcdUZGRDBcdUZGRDFcdUZGRDhcdUZGRDlcdUZGREQtXHVGRkRGXHVGRkU3XHVGRkVGLVx1RkZGOFx1RkZGRVx1RkZGRicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAwW1x1REMwQ1x1REMyN1x1REMzQlx1REMzRVx1REM0RVx1REM0Rlx1REM1RS1cdURDN0ZcdURDRkItXHVEQ0ZGXHVERDAzLVx1REQwNlx1REQzNC1cdUREMzZcdUREOEZcdUREOUMtXHVERDlGXHVEREExLVx1RERDRlx1RERGRS1cdURFN0ZcdURFOUQtXHVERTlGXHVERUQxLVx1REVERlx1REVGQy1cdURFRkZcdURGMjQtXHVERjJDXHVERjRCLVx1REY0Rlx1REY3Qi1cdURGN0ZcdURGOUVcdURGQzQtXHVERkM3XHVERkQ2LVx1REZGRl18XHVEODAxW1x1REM5RVx1REM5Rlx1RENBQS1cdURDQUZcdURDRDQtXHVEQ0Q3XHVEQ0ZDLVx1RENGRlx1REQyOC1cdUREMkZcdURENjQtXHVERDZFXHVERDcwLVx1RERGRlx1REYzNy1cdURGM0ZcdURGNTYtXHVERjVGXHVERjY4LVx1REZGRl18XHVEODAyW1x1REMwNlx1REMwN1x1REMwOVx1REMzNlx1REMzOS1cdURDM0JcdURDM0RcdURDM0VcdURDNTZcdURDOUYtXHVEQ0E2XHVEQ0IwLVx1RENERlx1RENGM1x1RENGNi1cdURDRkFcdUREMUMtXHVERDFFXHVERDNBLVx1REQzRVx1REQ0MC1cdUREN0ZcdUREQjgtXHVEREJCXHVEREQwXHVEREQxXHVERTA0XHVERTA3LVx1REUwQlx1REUxNFx1REUxOFx1REUzNlx1REUzN1x1REUzQi1cdURFM0VcdURFNDktXHVERTRGXHVERTU5LVx1REU1Rlx1REVBMC1cdURFQkZcdURFRTctXHVERUVBXHVERUY3LVx1REVGRlx1REYzNi1cdURGMzhcdURGNTZcdURGNTdcdURGNzMtXHVERjc3XHVERjkyLVx1REY5OFx1REY5RC1cdURGQThcdURGQjAtXHVERkZGXXxcdUQ4MDNbXHVEQzQ5LVx1REM3Rlx1RENCMy1cdURDQkZcdURDRjMtXHVEQ0Y5XHVERDI4LVx1REQyRlx1REQzQS1cdURFNUZcdURFN0YtXHVERUZGXHVERjI4LVx1REYyRlx1REY1QS1cdURGRkZdfFx1RDgwNFtcdURDNEUtXHVEQzUxXHVEQzcwLVx1REM3RVx1RENDMi1cdURDQ0NcdURDQ0VcdURDQ0ZcdURDRTktXHVEQ0VGXHVEQ0ZBLVx1RENGRlx1REQzNVx1REQ0Ny1cdURENEZcdURENzctXHVERDdGXHVERENFXHVERENGXHVEREUwXHVEREY1LVx1RERGRlx1REUxMlx1REUzRi1cdURFN0ZcdURFODdcdURFODlcdURFOEVcdURFOUVcdURFQUEtXHVERUFGXHVERUVCLVx1REVFRlx1REVGQS1cdURFRkZcdURGMDRcdURGMERcdURGMEVcdURGMTFcdURGMTJcdURGMjlcdURGMzFcdURGMzRcdURGM0FcdURGNDVcdURGNDZcdURGNDlcdURGNEFcdURGNEVcdURGNEZcdURGNTEtXHVERjU2XHVERjU4LVx1REY1Q1x1REY2NFx1REY2NVx1REY2RC1cdURGNkZcdURGNzUtXHVERkZGXXxcdUQ4MDVbXHVEQzVBXHVEQzVDXHVEQzVGLVx1REM3Rlx1RENDOC1cdURDQ0ZcdURDREEtXHVERDdGXHVEREI2XHVEREI3XHVERERFLVx1RERGRlx1REU0NS1cdURFNEZcdURFNUEtXHVERTVGXHVERTZELVx1REU3Rlx1REVCOC1cdURFQkZcdURFQ0EtXHVERUZGXHVERjFCXHVERjFDXHVERjJDLVx1REYyRlx1REY0MC1cdURGRkZdfFx1RDgwNltcdURDM0MtXHVEQzlGXHVEQ0YzLVx1RENGRVx1REQwMC1cdURERkZcdURFNDgtXHVERTRGXHVERTg0XHVERTg1XHVERUEzLVx1REVCRlx1REVGOS1cdURGRkZdfFx1RDgwN1tcdURDMDlcdURDMzdcdURDNDYtXHVEQzRGXHVEQzZELVx1REM2Rlx1REM5MFx1REM5MVx1RENBOFx1RENCNy1cdURDRkZcdUREMDdcdUREMEFcdUREMzctXHVERDM5XHVERDNCXHVERDNFXHVERDQ4LVx1REQ0Rlx1REQ1QS1cdURENUZcdURENjZcdURENjlcdUREOEZcdUREOTJcdUREOTktXHVERDlGXHVEREFBLVx1REVERlx1REVGOS1cdURGRkZdfFx1RDgwOFtcdURGOUEtXHVERkZGXXxcdUQ4MDlbXHVEQzZGXHVEQzc1LVx1REM3Rlx1REQ0NC1cdURGRkZdfFtcdUQ4MEFcdUQ4MEJcdUQ4MEUtXHVEODEwXHVEODEyLVx1RDgxOVx1RDgyMy1cdUQ4MkJcdUQ4MkRcdUQ4MkVcdUQ4MzAtXHVEODMzXHVEODM3XHVEODM5XHVEODNGXHVEODdCLVx1RDg3RFx1RDg3Ri1cdURCM0ZcdURCNDEtXHVEQjdGXVtcdURDMDAtXHVERkZGXXxcdUQ4MERbXHVEQzJGLVx1REZGRl18XHVEODExW1x1REU0Ny1cdURGRkZdfFx1RDgxQVtcdURFMzktXHVERTNGXHVERTVGXHVERTZBLVx1REU2RFx1REU3MC1cdURFQ0ZcdURFRUVcdURFRUZcdURFRjYtXHVERUZGXHVERjQ2LVx1REY0Rlx1REY1QVx1REY2Mlx1REY3OC1cdURGN0NcdURGOTAtXHVERkZGXXxcdUQ4MUJbXHVEQzAwLVx1REUzRlx1REU5Qi1cdURFRkZcdURGNDUtXHVERjRGXHVERjdGLVx1REY4RVx1REZBMC1cdURGREZcdURGRTItXHVERkZGXXxcdUQ4MjFbXHVERkYyLVx1REZGRl18XHVEODIyW1x1REVGMy1cdURGRkZdfFx1RDgyQ1tcdUREMUYtXHVERDZGXHVERUZDLVx1REZGRl18XHVEODJGW1x1REM2Qi1cdURDNkZcdURDN0QtXHVEQzdGXHVEQzg5LVx1REM4Rlx1REM5QVx1REM5Qlx1RENBNC1cdURGRkZdfFx1RDgzNFtcdURDRjYtXHVEQ0ZGXHVERDI3XHVERDI4XHVEREU5LVx1RERGRlx1REU0Ni1cdURFREZcdURFRjQtXHVERUZGXHVERjU3LVx1REY1Rlx1REY3OS1cdURGRkZdfFx1RDgzNVtcdURDNTVcdURDOURcdURDQTBcdURDQTFcdURDQTNcdURDQTRcdURDQTdcdURDQThcdURDQURcdURDQkFcdURDQkNcdURDQzRcdUREMDZcdUREMEJcdUREMENcdUREMTVcdUREMURcdUREM0FcdUREM0ZcdURENDVcdURENDctXHVERDQ5XHVERDUxXHVERUE2XHVERUE3XHVERkNDXHVERkNEXXxcdUQ4MzZbXHVERThDLVx1REU5QVx1REVBMFx1REVCMC1cdURGRkZdfFx1RDgzOFtcdURDMDdcdURDMTlcdURDMUFcdURDMjJcdURDMjVcdURDMkItXHVERkZGXXxcdUQ4M0FbXHVEQ0M1XHVEQ0M2XHVEQ0Q3LVx1RENGRlx1REQ0Qi1cdURENEZcdURENUEtXHVERDVEXHVERDYwLVx1REZGRl18XHVEODNCW1x1REMwMC1cdURDNzBcdURDQjUtXHVEREZGXHVERTA0XHVERTIwXHVERTIzXHVERTI1XHVERTI2XHVERTI4XHVERTMzXHVERTM4XHVERTNBXHVERTNDLVx1REU0MVx1REU0My1cdURFNDZcdURFNDhcdURFNEFcdURFNENcdURFNTBcdURFNTNcdURFNTVcdURFNTZcdURFNThcdURFNUFcdURFNUNcdURFNUVcdURFNjBcdURFNjNcdURFNjVcdURFNjZcdURFNkJcdURFNzNcdURFNzhcdURFN0RcdURFN0ZcdURFOEFcdURFOUMtXHVERUEwXHVERUE0XHVERUFBXHVERUJDLVx1REVFRlx1REVGMi1cdURGRkZdfFx1RDgzQ1tcdURDMkMtXHVEQzJGXHVEQzk0LVx1REM5Rlx1RENBRlx1RENCMFx1RENDMFx1RENEMFx1RENGNi1cdURDRkZcdUREMEQtXHVERDBGXHVERDZDLVx1REQ2Rlx1RERBRC1cdURERTVcdURFMDMtXHVERTBGXHVERTNDLVx1REUzRlx1REU0OS1cdURFNEZcdURFNTItXHVERTVGXHVERTY2LVx1REVGRl18XHVEODNEW1x1REVENS1cdURFREZcdURFRUQtXHVERUVGXHVERUZBLVx1REVGRlx1REY3NC1cdURGN0ZcdURGRDktXHVERkZGXXxcdUQ4M0VbXHVEQzBDLVx1REMwRlx1REM0OC1cdURDNEZcdURDNUEtXHVEQzVGXHVEQzg4LVx1REM4Rlx1RENBRS1cdURDRkZcdUREMEMtXHVERDBGXHVERDNGXHVERDcxXHVERDcyXHVERDc3LVx1REQ3OVx1REQ3Qlx1RERBMy1cdUREQUZcdUREQkEtXHVEREJGXHVEREMzLVx1RERDRlx1REUwMC1cdURFNUZcdURFNkUtXHVERkZGXXxcdUQ4NjlbXHVERUQ3LVx1REVGRl18XHVEODZEW1x1REYzNS1cdURGM0ZdfFx1RDg2RVtcdURDMUVcdURDMUZdfFx1RDg3M1tcdURFQTItXHVERUFGXXxcdUQ4N0FbXHVERkUxLVx1REZGRl18XHVEODdFW1x1REUxRS1cdURGRkZdfFx1REI0MFtcdURDMDBcdURDMDItXHVEQzFGXHVEQzgwLVx1RENGRlx1RERGMC1cdURGRkZdfFtcdURCQkZcdURCRkZdW1x1REZGRVx1REZGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0NvJywNCiAgICAgICAgJ2FsaWFzJzogJ1ByaXZhdGVfVXNlJywNCiAgICAgICAgJ2JtcCc6ICdcdUUwMDAtXHVGOEZGJywNCiAgICAgICAgJ2FzdHJhbCc6ICdbXHVEQjgwLVx1REJCRVx1REJDMC1cdURCRkVdW1x1REMwMC1cdURGRkZdfFtcdURCQkZcdURCRkZdW1x1REMwMC1cdURGRkRdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdDcycsDQogICAgICAgICdhbGlhcyc6ICdTdXJyb2dhdGUnLA0KICAgICAgICAnYm1wJzogJ1x1RDgwMC1cdURGRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0wnLA0KICAgICAgICAnYWxpYXMnOiAnTGV0dGVyJywNCiAgICAgICAgJ2JtcCc6ICdBLVphLXpceEFBXHhCNVx4QkFceEMwLVx4RDZceEQ4LVx4RjZceEY4LVx1MDJDMVx1MDJDNi1cdTAyRDFcdTAyRTAtXHUwMkU0XHUwMkVDXHUwMkVFXHUwMzcwLVx1MDM3NFx1MDM3Nlx1MDM3N1x1MDM3QS1cdTAzN0RcdTAzN0ZcdTAzODZcdTAzODgtXHUwMzhBXHUwMzhDXHUwMzhFLVx1MDNBMVx1MDNBMy1cdTAzRjVcdTAzRjctXHUwNDgxXHUwNDhBLVx1MDUyRlx1MDUzMS1cdTA1NTZcdTA1NTlcdTA1NjAtXHUwNTg4XHUwNUQwLVx1MDVFQVx1MDVFRi1cdTA1RjJcdTA2MjAtXHUwNjRBXHUwNjZFXHUwNjZGXHUwNjcxLVx1MDZEM1x1MDZENVx1MDZFNVx1MDZFNlx1MDZFRVx1MDZFRlx1MDZGQS1cdTA2RkNcdTA2RkZcdTA3MTBcdTA3MTItXHUwNzJGXHUwNzRELVx1MDdBNVx1MDdCMVx1MDdDQS1cdTA3RUFcdTA3RjRcdTA3RjVcdTA3RkFcdTA4MDAtXHUwODE1XHUwODFBXHUwODI0XHUwODI4XHUwODQwLVx1MDg1OFx1MDg2MC1cdTA4NkFcdTA4QTAtXHUwOEI0XHUwOEI2LVx1MDhCRFx1MDkwNC1cdTA5MzlcdTA5M0RcdTA5NTBcdTA5NTgtXHUwOTYxXHUwOTcxLVx1MDk4MFx1MDk4NS1cdTA5OENcdTA5OEZcdTA5OTBcdTA5OTMtXHUwOUE4XHUwOUFBLVx1MDlCMFx1MDlCMlx1MDlCNi1cdTA5QjlcdTA5QkRcdTA5Q0VcdTA5RENcdTA5RERcdTA5REYtXHUwOUUxXHUwOUYwXHUwOUYxXHUwOUZDXHUwQTA1LVx1MEEwQVx1MEEwRlx1MEExMFx1MEExMy1cdTBBMjhcdTBBMkEtXHUwQTMwXHUwQTMyXHUwQTMzXHUwQTM1XHUwQTM2XHUwQTM4XHUwQTM5XHUwQTU5LVx1MEE1Q1x1MEE1RVx1MEE3Mi1cdTBBNzRcdTBBODUtXHUwQThEXHUwQThGLVx1MEE5MVx1MEE5My1cdTBBQThcdTBBQUEtXHUwQUIwXHUwQUIyXHUwQUIzXHUwQUI1LVx1MEFCOVx1MEFCRFx1MEFEMFx1MEFFMFx1MEFFMVx1MEFGOVx1MEIwNS1cdTBCMENcdTBCMEZcdTBCMTBcdTBCMTMtXHUwQjI4XHUwQjJBLVx1MEIzMFx1MEIzMlx1MEIzM1x1MEIzNS1cdTBCMzlcdTBCM0RcdTBCNUNcdTBCNURcdTBCNUYtXHUwQjYxXHUwQjcxXHUwQjgzXHUwQjg1LVx1MEI4QVx1MEI4RS1cdTBCOTBcdTBCOTItXHUwQjk1XHUwQjk5XHUwQjlBXHUwQjlDXHUwQjlFXHUwQjlGXHUwQkEzXHUwQkE0XHUwQkE4LVx1MEJBQVx1MEJBRS1cdTBCQjlcdTBCRDBcdTBDMDUtXHUwQzBDXHUwQzBFLVx1MEMxMFx1MEMxMi1cdTBDMjhcdTBDMkEtXHUwQzM5XHUwQzNEXHUwQzU4LVx1MEM1QVx1MEM2MFx1MEM2MVx1MEM4MFx1MEM4NS1cdTBDOENcdTBDOEUtXHUwQzkwXHUwQzkyLVx1MENBOFx1MENBQS1cdTBDQjNcdTBDQjUtXHUwQ0I5XHUwQ0JEXHUwQ0RFXHUwQ0UwXHUwQ0UxXHUwQ0YxXHUwQ0YyXHUwRDA1LVx1MEQwQ1x1MEQwRS1cdTBEMTBcdTBEMTItXHUwRDNBXHUwRDNEXHUwRDRFXHUwRDU0LVx1MEQ1Nlx1MEQ1Ri1cdTBENjFcdTBEN0EtXHUwRDdGXHUwRDg1LVx1MEQ5Nlx1MEQ5QS1cdTBEQjFcdTBEQjMtXHUwREJCXHUwREJEXHUwREMwLVx1MERDNlx1MEUwMS1cdTBFMzBcdTBFMzJcdTBFMzNcdTBFNDAtXHUwRTQ2XHUwRTgxXHUwRTgyXHUwRTg0XHUwRTg3XHUwRTg4XHUwRThBXHUwRThEXHUwRTk0LVx1MEU5N1x1MEU5OS1cdTBFOUZcdTBFQTEtXHUwRUEzXHUwRUE1XHUwRUE3XHUwRUFBXHUwRUFCXHUwRUFELVx1MEVCMFx1MEVCMlx1MEVCM1x1MEVCRFx1MEVDMC1cdTBFQzRcdTBFQzZcdTBFREMtXHUwRURGXHUwRjAwXHUwRjQwLVx1MEY0N1x1MEY0OS1cdTBGNkNcdTBGODgtXHUwRjhDXHUxMDAwLVx1MTAyQVx1MTAzRlx1MTA1MC1cdTEwNTVcdTEwNUEtXHUxMDVEXHUxMDYxXHUxMDY1XHUxMDY2XHUxMDZFLVx1MTA3MFx1MTA3NS1cdTEwODFcdTEwOEVcdTEwQTAtXHUxMEM1XHUxMEM3XHUxMENEXHUxMEQwLVx1MTBGQVx1MTBGQy1cdTEyNDhcdTEyNEEtXHUxMjREXHUxMjUwLVx1MTI1Nlx1MTI1OFx1MTI1QS1cdTEyNURcdTEyNjAtXHUxMjg4XHUxMjhBLVx1MTI4RFx1MTI5MC1cdTEyQjBcdTEyQjItXHUxMkI1XHUxMkI4LVx1MTJCRVx1MTJDMFx1MTJDMi1cdTEyQzVcdTEyQzgtXHUxMkQ2XHUxMkQ4LVx1MTMxMFx1MTMxMi1cdTEzMTVcdTEzMTgtXHUxMzVBXHUxMzgwLVx1MTM4Rlx1MTNBMC1cdTEzRjVcdTEzRjgtXHUxM0ZEXHUxNDAxLVx1MTY2Q1x1MTY2Ri1cdTE2N0ZcdTE2ODEtXHUxNjlBXHUxNkEwLVx1MTZFQVx1MTZGMS1cdTE2RjhcdTE3MDAtXHUxNzBDXHUxNzBFLVx1MTcxMVx1MTcyMC1cdTE3MzFcdTE3NDAtXHUxNzUxXHUxNzYwLVx1MTc2Q1x1MTc2RS1cdTE3NzBcdTE3ODAtXHUxN0IzXHUxN0Q3XHUxN0RDXHUxODIwLVx1MTg3OFx1MTg4MC1cdTE4ODRcdTE4ODctXHUxOEE4XHUxOEFBXHUxOEIwLVx1MThGNVx1MTkwMC1cdTE5MUVcdTE5NTAtXHUxOTZEXHUxOTcwLVx1MTk3NFx1MTk4MC1cdTE5QUJcdTE5QjAtXHUxOUM5XHUxQTAwLVx1MUExNlx1MUEyMC1cdTFBNTRcdTFBQTdcdTFCMDUtXHUxQjMzXHUxQjQ1LVx1MUI0Qlx1MUI4My1cdTFCQTBcdTFCQUVcdTFCQUZcdTFCQkEtXHUxQkU1XHUxQzAwLVx1MUMyM1x1MUM0RC1cdTFDNEZcdTFDNUEtXHUxQzdEXHUxQzgwLVx1MUM4OFx1MUM5MC1cdTFDQkFcdTFDQkQtXHUxQ0JGXHUxQ0U5LVx1MUNFQ1x1MUNFRS1cdTFDRjFcdTFDRjVcdTFDRjZcdTFEMDAtXHUxREJGXHUxRTAwLVx1MUYxNVx1MUYxOC1cdTFGMURcdTFGMjAtXHUxRjQ1XHUxRjQ4LVx1MUY0RFx1MUY1MC1cdTFGNTdcdTFGNTlcdTFGNUJcdTFGNURcdTFGNUYtXHUxRjdEXHUxRjgwLVx1MUZCNFx1MUZCNi1cdTFGQkNcdTFGQkVcdTFGQzItXHUxRkM0XHUxRkM2LVx1MUZDQ1x1MUZEMC1cdTFGRDNcdTFGRDYtXHUxRkRCXHUxRkUwLVx1MUZFQ1x1MUZGMi1cdTFGRjRcdTFGRjYtXHUxRkZDXHUyMDcxXHUyMDdGXHUyMDkwLVx1MjA5Q1x1MjEwMlx1MjEwN1x1MjEwQS1cdTIxMTNcdTIxMTVcdTIxMTktXHUyMTFEXHUyMTI0XHUyMTI2XHUyMTI4XHUyMTJBLVx1MjEyRFx1MjEyRi1cdTIxMzlcdTIxM0MtXHUyMTNGXHUyMTQ1LVx1MjE0OVx1MjE0RVx1MjE4M1x1MjE4NFx1MkMwMC1cdTJDMkVcdTJDMzAtXHUyQzVFXHUyQzYwLVx1MkNFNFx1MkNFQi1cdTJDRUVcdTJDRjJcdTJDRjNcdTJEMDAtXHUyRDI1XHUyRDI3XHUyRDJEXHUyRDMwLVx1MkQ2N1x1MkQ2Rlx1MkQ4MC1cdTJEOTZcdTJEQTAtXHUyREE2XHUyREE4LVx1MkRBRVx1MkRCMC1cdTJEQjZcdTJEQjgtXHUyREJFXHUyREMwLVx1MkRDNlx1MkRDOC1cdTJEQ0VcdTJERDAtXHUyREQ2XHUyREQ4LVx1MkRERVx1MkUyRlx1MzAwNVx1MzAwNlx1MzAzMS1cdTMwMzVcdTMwM0JcdTMwM0NcdTMwNDEtXHUzMDk2XHUzMDlELVx1MzA5Rlx1MzBBMS1cdTMwRkFcdTMwRkMtXHUzMEZGXHUzMTA1LVx1MzEyRlx1MzEzMS1cdTMxOEVcdTMxQTAtXHUzMUJBXHUzMUYwLVx1MzFGRlx1MzQwMC1cdTREQjVcdTRFMDAtXHU5RkVGXHVBMDAwLVx1QTQ4Q1x1QTREMC1cdUE0RkRcdUE1MDAtXHVBNjBDXHVBNjEwLVx1QTYxRlx1QTYyQVx1QTYyQlx1QTY0MC1cdUE2NkVcdUE2N0YtXHVBNjlEXHVBNkEwLVx1QTZFNVx1QTcxNy1cdUE3MUZcdUE3MjItXHVBNzg4XHVBNzhCLVx1QTdCOVx1QTdGNy1cdUE4MDFcdUE4MDMtXHVBODA1XHVBODA3LVx1QTgwQVx1QTgwQy1cdUE4MjJcdUE4NDAtXHVBODczXHVBODgyLVx1QThCM1x1QThGMi1cdUE4RjdcdUE4RkJcdUE4RkRcdUE4RkVcdUE5MEEtXHVBOTI1XHVBOTMwLVx1QTk0Nlx1QTk2MC1cdUE5N0NcdUE5ODQtXHVBOUIyXHVBOUNGXHVBOUUwLVx1QTlFNFx1QTlFNi1cdUE5RUZcdUE5RkEtXHVBOUZFXHVBQTAwLVx1QUEyOFx1QUE0MC1cdUFBNDJcdUFBNDQtXHVBQTRCXHVBQTYwLVx1QUE3Nlx1QUE3QVx1QUE3RS1cdUFBQUZcdUFBQjFcdUFBQjVcdUFBQjZcdUFBQjktXHVBQUJEXHVBQUMwXHVBQUMyXHVBQURCLVx1QUFERFx1QUFFMC1cdUFBRUFcdUFBRjItXHVBQUY0XHVBQjAxLVx1QUIwNlx1QUIwOS1cdUFCMEVcdUFCMTEtXHVBQjE2XHVBQjIwLVx1QUIyNlx1QUIyOC1cdUFCMkVcdUFCMzAtXHVBQjVBXHVBQjVDLVx1QUI2NVx1QUI3MC1cdUFCRTJcdUFDMDAtXHVEN0EzXHVEN0IwLVx1RDdDNlx1RDdDQi1cdUQ3RkJcdUY5MDAtXHVGQTZEXHVGQTcwLVx1RkFEOVx1RkIwMC1cdUZCMDZcdUZCMTMtXHVGQjE3XHVGQjFEXHVGQjFGLVx1RkIyOFx1RkIyQS1cdUZCMzZcdUZCMzgtXHVGQjNDXHVGQjNFXHVGQjQwXHVGQjQxXHVGQjQzXHVGQjQ0XHVGQjQ2LVx1RkJCMVx1RkJEMy1cdUZEM0RcdUZENTAtXHVGRDhGXHVGRDkyLVx1RkRDN1x1RkRGMC1cdUZERkJcdUZFNzAtXHVGRTc0XHVGRTc2LVx1RkVGQ1x1RkYyMS1cdUZGM0FcdUZGNDEtXHVGRjVBXHVGRjY2LVx1RkZCRVx1RkZDMi1cdUZGQzdcdUZGQ0EtXHVGRkNGXHVGRkQyLVx1RkZEN1x1RkZEQS1cdUZGREMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMFtcdURDMDAtXHVEQzBCXHVEQzBELVx1REMyNlx1REMyOC1cdURDM0FcdURDM0NcdURDM0RcdURDM0YtXHVEQzREXHVEQzUwLVx1REM1RFx1REM4MC1cdURDRkFcdURFODAtXHVERTlDXHVERUEwLVx1REVEMFx1REYwMC1cdURGMUZcdURGMkQtXHVERjQwXHVERjQyLVx1REY0OVx1REY1MC1cdURGNzVcdURGODAtXHVERjlEXHVERkEwLVx1REZDM1x1REZDOC1cdURGQ0ZdfFx1RDgwMVtcdURDMDAtXHVEQzlEXHVEQ0IwLVx1RENEM1x1RENEOC1cdURDRkJcdUREMDAtXHVERDI3XHVERDMwLVx1REQ2M1x1REUwMC1cdURGMzZcdURGNDAtXHVERjU1XHVERjYwLVx1REY2N118XHVEODAyW1x1REMwMC1cdURDMDVcdURDMDhcdURDMEEtXHVEQzM1XHVEQzM3XHVEQzM4XHVEQzNDXHVEQzNGLVx1REM1NVx1REM2MC1cdURDNzZcdURDODAtXHVEQzlFXHVEQ0UwLVx1RENGMlx1RENGNFx1RENGNVx1REQwMC1cdUREMTVcdUREMjAtXHVERDM5XHVERDgwLVx1RERCN1x1RERCRVx1RERCRlx1REUwMFx1REUxMC1cdURFMTNcdURFMTUtXHVERTE3XHVERTE5LVx1REUzNVx1REU2MC1cdURFN0NcdURFODAtXHVERTlDXHVERUMwLVx1REVDN1x1REVDOS1cdURFRTRcdURGMDAtXHVERjM1XHVERjQwLVx1REY1NVx1REY2MC1cdURGNzJcdURGODAtXHVERjkxXXxcdUQ4MDNbXHVEQzAwLVx1REM0OFx1REM4MC1cdURDQjJcdURDQzAtXHVEQ0YyXHVERDAwLVx1REQyM1x1REYwMC1cdURGMUNcdURGMjdcdURGMzAtXHVERjQ1XXxcdUQ4MDRbXHVEQzAzLVx1REMzN1x1REM4My1cdURDQUZcdURDRDAtXHVEQ0U4XHVERDAzLVx1REQyNlx1REQ0NFx1REQ1MC1cdURENzJcdURENzZcdUREODMtXHVEREIyXHVEREMxLVx1RERDNFx1REREQVx1REREQ1x1REUwMC1cdURFMTFcdURFMTMtXHVERTJCXHVERTgwLVx1REU4Nlx1REU4OFx1REU4QS1cdURFOERcdURFOEYtXHVERTlEXHVERTlGLVx1REVBOFx1REVCMC1cdURFREVcdURGMDUtXHVERjBDXHVERjBGXHVERjEwXHVERjEzLVx1REYyOFx1REYyQS1cdURGMzBcdURGMzJcdURGMzNcdURGMzUtXHVERjM5XHVERjNEXHVERjUwXHVERjVELVx1REY2MV18XHVEODA1W1x1REMwMC1cdURDMzRcdURDNDctXHVEQzRBXHVEQzgwLVx1RENBRlx1RENDNFx1RENDNVx1RENDN1x1REQ4MC1cdUREQUVcdURERDgtXHVERERCXHVERTAwLVx1REUyRlx1REU0NFx1REU4MC1cdURFQUFcdURGMDAtXHVERjFBXXxcdUQ4MDZbXHVEQzAwLVx1REMyQlx1RENBMC1cdURDREZcdURDRkZcdURFMDBcdURFMEItXHVERTMyXHVERTNBXHVERTUwXHVERTVDLVx1REU4M1x1REU4Ni1cdURFODlcdURFOURcdURFQzAtXHVERUY4XXxcdUQ4MDdbXHVEQzAwLVx1REMwOFx1REMwQS1cdURDMkVcdURDNDBcdURDNzItXHVEQzhGXHVERDAwLVx1REQwNlx1REQwOFx1REQwOVx1REQwQi1cdUREMzBcdURENDZcdURENjAtXHVERDY1XHVERDY3XHVERDY4XHVERDZBLVx1REQ4OVx1REQ5OFx1REVFMC1cdURFRjJdfFx1RDgwOFtcdURDMDAtXHVERjk5XXxcdUQ4MDlbXHVEQzgwLVx1REQ0M118W1x1RDgwQ1x1RDgxQy1cdUQ4MjBcdUQ4NDAtXHVEODY4XHVEODZBLVx1RDg2Q1x1RDg2Ri1cdUQ4NzJcdUQ4NzQtXHVEODc5XVtcdURDMDAtXHVERkZGXXxcdUQ4MERbXHVEQzAwLVx1REMyRV18XHVEODExW1x1REMwMC1cdURFNDZdfFx1RDgxQVtcdURDMDAtXHVERTM4XHVERTQwLVx1REU1RVx1REVEMC1cdURFRURcdURGMDAtXHVERjJGXHVERjQwLVx1REY0M1x1REY2My1cdURGNzdcdURGN0QtXHVERjhGXXxcdUQ4MUJbXHVERTQwLVx1REU3Rlx1REYwMC1cdURGNDRcdURGNTBcdURGOTMtXHVERjlGXHVERkUwXHVERkUxXXxcdUQ4MjFbXHVEQzAwLVx1REZGMV18XHVEODIyW1x1REMwMC1cdURFRjJdfFx1RDgyQ1tcdURDMDAtXHVERDFFXHVERDcwLVx1REVGQl18XHVEODJGW1x1REMwMC1cdURDNkFcdURDNzAtXHVEQzdDXHVEQzgwLVx1REM4OFx1REM5MC1cdURDOTldfFx1RDgzNVtcdURDMDAtXHVEQzU0XHVEQzU2LVx1REM5Q1x1REM5RVx1REM5Rlx1RENBMlx1RENBNVx1RENBNlx1RENBOS1cdURDQUNcdURDQUUtXHVEQ0I5XHVEQ0JCXHVEQ0JELVx1RENDM1x1RENDNS1cdUREMDVcdUREMDctXHVERDBBXHVERDBELVx1REQxNFx1REQxNi1cdUREMUNcdUREMUUtXHVERDM5XHVERDNCLVx1REQzRVx1REQ0MC1cdURENDRcdURENDZcdURENEEtXHVERDUwXHVERDUyLVx1REVBNVx1REVBOC1cdURFQzBcdURFQzItXHVERURBXHVERURDLVx1REVGQVx1REVGQy1cdURGMTRcdURGMTYtXHVERjM0XHVERjM2LVx1REY0RVx1REY1MC1cdURGNkVcdURGNzAtXHVERjg4XHVERjhBLVx1REZBOFx1REZBQS1cdURGQzJcdURGQzQtXHVERkNCXXxcdUQ4M0FbXHVEQzAwLVx1RENDNFx1REQwMC1cdURENDNdfFx1RDgzQltcdURFMDAtXHVERTAzXHVERTA1LVx1REUxRlx1REUyMVx1REUyMlx1REUyNFx1REUyN1x1REUyOS1cdURFMzJcdURFMzQtXHVERTM3XHVERTM5XHVERTNCXHVERTQyXHVERTQ3XHVERTQ5XHVERTRCXHVERTRELVx1REU0Rlx1REU1MVx1REU1Mlx1REU1NFx1REU1N1x1REU1OVx1REU1Qlx1REU1RFx1REU1Rlx1REU2MVx1REU2Mlx1REU2NFx1REU2Ny1cdURFNkFcdURFNkMtXHVERTcyXHVERTc0LVx1REU3N1x1REU3OS1cdURFN0NcdURFN0VcdURFODAtXHVERTg5XHVERThCLVx1REU5Qlx1REVBMS1cdURFQTNcdURFQTUtXHVERUE5XHVERUFCLVx1REVCQl18XHVEODY5W1x1REMwMC1cdURFRDZcdURGMDAtXHVERkZGXXxcdUQ4NkRbXHVEQzAwLVx1REYzNFx1REY0MC1cdURGRkZdfFx1RDg2RVtcdURDMDAtXHVEQzFEXHVEQzIwLVx1REZGRl18XHVEODczW1x1REMwMC1cdURFQTFcdURFQjAtXHVERkZGXXxcdUQ4N0FbXHVEQzAwLVx1REZFMF18XHVEODdFW1x1REMwMC1cdURFMURdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdMQycsDQogICAgICAgICdhbGlhcyc6ICdDYXNlZF9MZXR0ZXInLA0KICAgICAgICAnYm1wJzogJ0EtWmEtelx4QjVceEMwLVx4RDZceEQ4LVx4RjZceEY4LVx1MDFCQVx1MDFCQy1cdTAxQkZcdTAxQzQtXHUwMjkzXHUwMjk1LVx1MDJBRlx1MDM3MC1cdTAzNzNcdTAzNzZcdTAzNzdcdTAzN0ItXHUwMzdEXHUwMzdGXHUwMzg2XHUwMzg4LVx1MDM4QVx1MDM4Q1x1MDM4RS1cdTAzQTFcdTAzQTMtXHUwM0Y1XHUwM0Y3LVx1MDQ4MVx1MDQ4QS1cdTA1MkZcdTA1MzEtXHUwNTU2XHUwNTYwLVx1MDU4OFx1MTBBMC1cdTEwQzVcdTEwQzdcdTEwQ0RcdTEwRDAtXHUxMEZBXHUxMEZELVx1MTBGRlx1MTNBMC1cdTEzRjVcdTEzRjgtXHUxM0ZEXHUxQzgwLVx1MUM4OFx1MUM5MC1cdTFDQkFcdTFDQkQtXHUxQ0JGXHUxRDAwLVx1MUQyQlx1MUQ2Qi1cdTFENzdcdTFENzktXHUxRDlBXHUxRTAwLVx1MUYxNVx1MUYxOC1cdTFGMURcdTFGMjAtXHUxRjQ1XHUxRjQ4LVx1MUY0RFx1MUY1MC1cdTFGNTdcdTFGNTlcdTFGNUJcdTFGNURcdTFGNUYtXHUxRjdEXHUxRjgwLVx1MUZCNFx1MUZCNi1cdTFGQkNcdTFGQkVcdTFGQzItXHUxRkM0XHUxRkM2LVx1MUZDQ1x1MUZEMC1cdTFGRDNcdTFGRDYtXHUxRkRCXHUxRkUwLVx1MUZFQ1x1MUZGMi1cdTFGRjRcdTFGRjYtXHUxRkZDXHUyMTAyXHUyMTA3XHUyMTBBLVx1MjExM1x1MjExNVx1MjExOS1cdTIxMURcdTIxMjRcdTIxMjZcdTIxMjhcdTIxMkEtXHUyMTJEXHUyMTJGLVx1MjEzNFx1MjEzOVx1MjEzQy1cdTIxM0ZcdTIxNDUtXHUyMTQ5XHUyMTRFXHUyMTgzXHUyMTg0XHUyQzAwLVx1MkMyRVx1MkMzMC1cdTJDNUVcdTJDNjAtXHUyQzdCXHUyQzdFLVx1MkNFNFx1MkNFQi1cdTJDRUVcdTJDRjJcdTJDRjNcdTJEMDAtXHUyRDI1XHUyRDI3XHUyRDJEXHVBNjQwLVx1QTY2RFx1QTY4MC1cdUE2OUJcdUE3MjItXHVBNzZGXHVBNzcxLVx1QTc4N1x1QTc4Qi1cdUE3OEVcdUE3OTAtXHVBN0I5XHVBN0ZBXHVBQjMwLVx1QUI1QVx1QUI2MC1cdUFCNjVcdUFCNzAtXHVBQkJGXHVGQjAwLVx1RkIwNlx1RkIxMy1cdUZCMTdcdUZGMjEtXHVGRjNBXHVGRjQxLVx1RkY1QScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAxW1x1REMwMC1cdURDNEZcdURDQjAtXHVEQ0QzXHVEQ0Q4LVx1RENGQl18XHVEODAzW1x1REM4MC1cdURDQjJcdURDQzAtXHVEQ0YyXXxcdUQ4MDZbXHVEQ0EwLVx1RENERl18XHVEODFCW1x1REU0MC1cdURFN0ZdfFx1RDgzNVtcdURDMDAtXHVEQzU0XHVEQzU2LVx1REM5Q1x1REM5RVx1REM5Rlx1RENBMlx1RENBNVx1RENBNlx1RENBOS1cdURDQUNcdURDQUUtXHVEQ0I5XHVEQ0JCXHVEQ0JELVx1RENDM1x1RENDNS1cdUREMDVcdUREMDctXHVERDBBXHVERDBELVx1REQxNFx1REQxNi1cdUREMUNcdUREMUUtXHVERDM5XHVERDNCLVx1REQzRVx1REQ0MC1cdURENDRcdURENDZcdURENEEtXHVERDUwXHVERDUyLVx1REVBNVx1REVBOC1cdURFQzBcdURFQzItXHVERURBXHVERURDLVx1REVGQVx1REVGQy1cdURGMTRcdURGMTYtXHVERjM0XHVERjM2LVx1REY0RVx1REY1MC1cdURGNkVcdURGNzAtXHVERjg4XHVERjhBLVx1REZBOFx1REZBQS1cdURGQzJcdURGQzQtXHVERkNCXXxcdUQ4M0FbXHVERDAwLVx1REQ0M10nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0xsJywNCiAgICAgICAgJ2FsaWFzJzogJ0xvd2VyY2FzZV9MZXR0ZXInLA0KICAgICAgICAnYm1wJzogJ2Etelx4QjVceERGLVx4RjZceEY4LVx4RkZcdTAxMDFcdTAxMDNcdTAxMDVcdTAxMDdcdTAxMDlcdTAxMEJcdTAxMERcdTAxMEZcdTAxMTFcdTAxMTNcdTAxMTVcdTAxMTdcdTAxMTlcdTAxMUJcdTAxMURcdTAxMUZcdTAxMjFcdTAxMjNcdTAxMjVcdTAxMjdcdTAxMjlcdTAxMkJcdTAxMkRcdTAxMkZcdTAxMzFcdTAxMzNcdTAxMzVcdTAxMzdcdTAxMzhcdTAxM0FcdTAxM0NcdTAxM0VcdTAxNDBcdTAxNDJcdTAxNDRcdTAxNDZcdTAxNDhcdTAxNDlcdTAxNEJcdTAxNERcdTAxNEZcdTAxNTFcdTAxNTNcdTAxNTVcdTAxNTdcdTAxNTlcdTAxNUJcdTAxNURcdTAxNUZcdTAxNjFcdTAxNjNcdTAxNjVcdTAxNjdcdTAxNjlcdTAxNkJcdTAxNkRcdTAxNkZcdTAxNzFcdTAxNzNcdTAxNzVcdTAxNzdcdTAxN0FcdTAxN0NcdTAxN0UtXHUwMTgwXHUwMTgzXHUwMTg1XHUwMTg4XHUwMThDXHUwMThEXHUwMTkyXHUwMTk1XHUwMTk5LVx1MDE5Qlx1MDE5RVx1MDFBMVx1MDFBM1x1MDFBNVx1MDFBOFx1MDFBQVx1MDFBQlx1MDFBRFx1MDFCMFx1MDFCNFx1MDFCNlx1MDFCOVx1MDFCQVx1MDFCRC1cdTAxQkZcdTAxQzZcdTAxQzlcdTAxQ0NcdTAxQ0VcdTAxRDBcdTAxRDJcdTAxRDRcdTAxRDZcdTAxRDhcdTAxREFcdTAxRENcdTAxRERcdTAxREZcdTAxRTFcdTAxRTNcdTAxRTVcdTAxRTdcdTAxRTlcdTAxRUJcdTAxRURcdTAxRUZcdTAxRjBcdTAxRjNcdTAxRjVcdTAxRjlcdTAxRkJcdTAxRkRcdTAxRkZcdTAyMDFcdTAyMDNcdTAyMDVcdTAyMDdcdTAyMDlcdTAyMEJcdTAyMERcdTAyMEZcdTAyMTFcdTAyMTNcdTAyMTVcdTAyMTdcdTAyMTlcdTAyMUJcdTAyMURcdTAyMUZcdTAyMjFcdTAyMjNcdTAyMjVcdTAyMjdcdTAyMjlcdTAyMkJcdTAyMkRcdTAyMkZcdTAyMzFcdTAyMzMtXHUwMjM5XHUwMjNDXHUwMjNGXHUwMjQwXHUwMjQyXHUwMjQ3XHUwMjQ5XHUwMjRCXHUwMjREXHUwMjRGLVx1MDI5M1x1MDI5NS1cdTAyQUZcdTAzNzFcdTAzNzNcdTAzNzdcdTAzN0ItXHUwMzdEXHUwMzkwXHUwM0FDLVx1MDNDRVx1MDNEMFx1MDNEMVx1MDNENS1cdTAzRDdcdTAzRDlcdTAzREJcdTAzRERcdTAzREZcdTAzRTFcdTAzRTNcdTAzRTVcdTAzRTdcdTAzRTlcdTAzRUJcdTAzRURcdTAzRUYtXHUwM0YzXHUwM0Y1XHUwM0Y4XHUwM0ZCXHUwM0ZDXHUwNDMwLVx1MDQ1Rlx1MDQ2MVx1MDQ2M1x1MDQ2NVx1MDQ2N1x1MDQ2OVx1MDQ2Qlx1MDQ2RFx1MDQ2Rlx1MDQ3MVx1MDQ3M1x1MDQ3NVx1MDQ3N1x1MDQ3OVx1MDQ3Qlx1MDQ3RFx1MDQ3Rlx1MDQ4MVx1MDQ4Qlx1MDQ4RFx1MDQ4Rlx1MDQ5MVx1MDQ5M1x1MDQ5NVx1MDQ5N1x1MDQ5OVx1MDQ5Qlx1MDQ5RFx1MDQ5Rlx1MDRBMVx1MDRBM1x1MDRBNVx1MDRBN1x1MDRBOVx1MDRBQlx1MDRBRFx1MDRBRlx1MDRCMVx1MDRCM1x1MDRCNVx1MDRCN1x1MDRCOVx1MDRCQlx1MDRCRFx1MDRCRlx1MDRDMlx1MDRDNFx1MDRDNlx1MDRDOFx1MDRDQVx1MDRDQ1x1MDRDRVx1MDRDRlx1MDREMVx1MDREM1x1MDRENVx1MDREN1x1MDREOVx1MDREQlx1MDRERFx1MDRERlx1MDRFMVx1MDRFM1x1MDRFNVx1MDRFN1x1MDRFOVx1MDRFQlx1MDRFRFx1MDRFRlx1MDRGMVx1MDRGM1x1MDRGNVx1MDRGN1x1MDRGOVx1MDRGQlx1MDRGRFx1MDRGRlx1MDUwMVx1MDUwM1x1MDUwNVx1MDUwN1x1MDUwOVx1MDUwQlx1MDUwRFx1MDUwRlx1MDUxMVx1MDUxM1x1MDUxNVx1MDUxN1x1MDUxOVx1MDUxQlx1MDUxRFx1MDUxRlx1MDUyMVx1MDUyM1x1MDUyNVx1MDUyN1x1MDUyOVx1MDUyQlx1MDUyRFx1MDUyRlx1MDU2MC1cdTA1ODhcdTEwRDAtXHUxMEZBXHUxMEZELVx1MTBGRlx1MTNGOC1cdTEzRkRcdTFDODAtXHUxQzg4XHUxRDAwLVx1MUQyQlx1MUQ2Qi1cdTFENzdcdTFENzktXHUxRDlBXHUxRTAxXHUxRTAzXHUxRTA1XHUxRTA3XHUxRTA5XHUxRTBCXHUxRTBEXHUxRTBGXHUxRTExXHUxRTEzXHUxRTE1XHUxRTE3XHUxRTE5XHUxRTFCXHUxRTFEXHUxRTFGXHUxRTIxXHUxRTIzXHUxRTI1XHUxRTI3XHUxRTI5XHUxRTJCXHUxRTJEXHUxRTJGXHUxRTMxXHUxRTMzXHUxRTM1XHUxRTM3XHUxRTM5XHUxRTNCXHUxRTNEXHUxRTNGXHUxRTQxXHUxRTQzXHUxRTQ1XHUxRTQ3XHUxRTQ5XHUxRTRCXHUxRTREXHUxRTRGXHUxRTUxXHUxRTUzXHUxRTU1XHUxRTU3XHUxRTU5XHUxRTVCXHUxRTVEXHUxRTVGXHUxRTYxXHUxRTYzXHUxRTY1XHUxRTY3XHUxRTY5XHUxRTZCXHUxRTZEXHUxRTZGXHUxRTcxXHUxRTczXHUxRTc1XHUxRTc3XHUxRTc5XHUxRTdCXHUxRTdEXHUxRTdGXHUxRTgxXHUxRTgzXHUxRTg1XHUxRTg3XHUxRTg5XHUxRThCXHUxRThEXHUxRThGXHUxRTkxXHUxRTkzXHUxRTk1LVx1MUU5RFx1MUU5Rlx1MUVBMVx1MUVBM1x1MUVBNVx1MUVBN1x1MUVBOVx1MUVBQlx1MUVBRFx1MUVBRlx1MUVCMVx1MUVCM1x1MUVCNVx1MUVCN1x1MUVCOVx1MUVCQlx1MUVCRFx1MUVCRlx1MUVDMVx1MUVDM1x1MUVDNVx1MUVDN1x1MUVDOVx1MUVDQlx1MUVDRFx1MUVDRlx1MUVEMVx1MUVEM1x1MUVENVx1MUVEN1x1MUVEOVx1MUVEQlx1MUVERFx1MUVERlx1MUVFMVx1MUVFM1x1MUVFNVx1MUVFN1x1MUVFOVx1MUVFQlx1MUVFRFx1MUVFRlx1MUVGMVx1MUVGM1x1MUVGNVx1MUVGN1x1MUVGOVx1MUVGQlx1MUVGRFx1MUVGRi1cdTFGMDdcdTFGMTAtXHUxRjE1XHUxRjIwLVx1MUYyN1x1MUYzMC1cdTFGMzdcdTFGNDAtXHUxRjQ1XHUxRjUwLVx1MUY1N1x1MUY2MC1cdTFGNjdcdTFGNzAtXHUxRjdEXHUxRjgwLVx1MUY4N1x1MUY5MC1cdTFGOTdcdTFGQTAtXHUxRkE3XHUxRkIwLVx1MUZCNFx1MUZCNlx1MUZCN1x1MUZCRVx1MUZDMi1cdTFGQzRcdTFGQzZcdTFGQzdcdTFGRDAtXHUxRkQzXHUxRkQ2XHUxRkQ3XHUxRkUwLVx1MUZFN1x1MUZGMi1cdTFGRjRcdTFGRjZcdTFGRjdcdTIxMEFcdTIxMEVcdTIxMEZcdTIxMTNcdTIxMkZcdTIxMzRcdTIxMzlcdTIxM0NcdTIxM0RcdTIxNDYtXHUyMTQ5XHUyMTRFXHUyMTg0XHUyQzMwLVx1MkM1RVx1MkM2MVx1MkM2NVx1MkM2Nlx1MkM2OFx1MkM2QVx1MkM2Q1x1MkM3MVx1MkM3M1x1MkM3NFx1MkM3Ni1cdTJDN0JcdTJDODFcdTJDODNcdTJDODVcdTJDODdcdTJDODlcdTJDOEJcdTJDOERcdTJDOEZcdTJDOTFcdTJDOTNcdTJDOTVcdTJDOTdcdTJDOTlcdTJDOUJcdTJDOURcdTJDOUZcdTJDQTFcdTJDQTNcdTJDQTVcdTJDQTdcdTJDQTlcdTJDQUJcdTJDQURcdTJDQUZcdTJDQjFcdTJDQjNcdTJDQjVcdTJDQjdcdTJDQjlcdTJDQkJcdTJDQkRcdTJDQkZcdTJDQzFcdTJDQzNcdTJDQzVcdTJDQzdcdTJDQzlcdTJDQ0JcdTJDQ0RcdTJDQ0ZcdTJDRDFcdTJDRDNcdTJDRDVcdTJDRDdcdTJDRDlcdTJDREJcdTJDRERcdTJDREZcdTJDRTFcdTJDRTNcdTJDRTRcdTJDRUNcdTJDRUVcdTJDRjNcdTJEMDAtXHUyRDI1XHUyRDI3XHUyRDJEXHVBNjQxXHVBNjQzXHVBNjQ1XHVBNjQ3XHVBNjQ5XHVBNjRCXHVBNjREXHVBNjRGXHVBNjUxXHVBNjUzXHVBNjU1XHVBNjU3XHVBNjU5XHVBNjVCXHVBNjVEXHVBNjVGXHVBNjYxXHVBNjYzXHVBNjY1XHVBNjY3XHVBNjY5XHVBNjZCXHVBNjZEXHVBNjgxXHVBNjgzXHVBNjg1XHVBNjg3XHVBNjg5XHVBNjhCXHVBNjhEXHVBNjhGXHVBNjkxXHVBNjkzXHVBNjk1XHVBNjk3XHVBNjk5XHVBNjlCXHVBNzIzXHVBNzI1XHVBNzI3XHVBNzI5XHVBNzJCXHVBNzJEXHVBNzJGLVx1QTczMVx1QTczM1x1QTczNVx1QTczN1x1QTczOVx1QTczQlx1QTczRFx1QTczRlx1QTc0MVx1QTc0M1x1QTc0NVx1QTc0N1x1QTc0OVx1QTc0Qlx1QTc0RFx1QTc0Rlx1QTc1MVx1QTc1M1x1QTc1NVx1QTc1N1x1QTc1OVx1QTc1Qlx1QTc1RFx1QTc1Rlx1QTc2MVx1QTc2M1x1QTc2NVx1QTc2N1x1QTc2OVx1QTc2Qlx1QTc2RFx1QTc2Rlx1QTc3MS1cdUE3NzhcdUE3N0FcdUE3N0NcdUE3N0ZcdUE3ODFcdUE3ODNcdUE3ODVcdUE3ODdcdUE3OENcdUE3OEVcdUE3OTFcdUE3OTMtXHVBNzk1XHVBNzk3XHVBNzk5XHVBNzlCXHVBNzlEXHVBNzlGXHVBN0ExXHVBN0EzXHVBN0E1XHVBN0E3XHVBN0E5XHVBN0FGXHVBN0I1XHVBN0I3XHVBN0I5XHVBN0ZBXHVBQjMwLVx1QUI1QVx1QUI2MC1cdUFCNjVcdUFCNzAtXHVBQkJGXHVGQjAwLVx1RkIwNlx1RkIxMy1cdUZCMTdcdUZGNDEtXHVGRjVBJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDFbXHVEQzI4LVx1REM0Rlx1RENEOC1cdURDRkJdfFx1RDgwM1tcdURDQzAtXHVEQ0YyXXxcdUQ4MDZbXHVEQ0MwLVx1RENERl18XHVEODFCW1x1REU2MC1cdURFN0ZdfFx1RDgzNVtcdURDMUEtXHVEQzMzXHVEQzRFLVx1REM1NFx1REM1Ni1cdURDNjdcdURDODItXHVEQzlCXHVEQ0I2LVx1RENCOVx1RENCQlx1RENCRC1cdURDQzNcdURDQzUtXHVEQ0NGXHVEQ0VBLVx1REQwM1x1REQxRS1cdUREMzdcdURENTItXHVERDZCXHVERDg2LVx1REQ5Rlx1RERCQS1cdURERDNcdURERUUtXHVERTA3XHVERTIyLVx1REUzQlx1REU1Ni1cdURFNkZcdURFOEEtXHVERUE1XHVERUMyLVx1REVEQVx1REVEQy1cdURFRTFcdURFRkMtXHVERjE0XHVERjE2LVx1REYxQlx1REYzNi1cdURGNEVcdURGNTAtXHVERjU1XHVERjcwLVx1REY4OFx1REY4QS1cdURGOEZcdURGQUEtXHVERkMyXHVERkM0LVx1REZDOVx1REZDQl18XHVEODNBW1x1REQyMi1cdURENDNdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdMbScsDQogICAgICAgICdhbGlhcyc6ICdNb2RpZmllcl9MZXR0ZXInLA0KICAgICAgICAnYm1wJzogJ1x1MDJCMC1cdTAyQzFcdTAyQzYtXHUwMkQxXHUwMkUwLVx1MDJFNFx1MDJFQ1x1MDJFRVx1MDM3NFx1MDM3QVx1MDU1OVx1MDY0MFx1MDZFNVx1MDZFNlx1MDdGNFx1MDdGNVx1MDdGQVx1MDgxQVx1MDgyNFx1MDgyOFx1MDk3MVx1MEU0Nlx1MEVDNlx1MTBGQ1x1MTdEN1x1MTg0M1x1MUFBN1x1MUM3OC1cdTFDN0RcdTFEMkMtXHUxRDZBXHUxRDc4XHUxRDlCLVx1MURCRlx1MjA3MVx1MjA3Rlx1MjA5MC1cdTIwOUNcdTJDN0NcdTJDN0RcdTJENkZcdTJFMkZcdTMwMDVcdTMwMzEtXHUzMDM1XHUzMDNCXHUzMDlEXHUzMDlFXHUzMEZDLVx1MzBGRVx1QTAxNVx1QTRGOC1cdUE0RkRcdUE2MENcdUE2N0ZcdUE2OUNcdUE2OURcdUE3MTctXHVBNzFGXHVBNzcwXHVBNzg4XHVBN0Y4XHVBN0Y5XHVBOUNGXHVBOUU2XHVBQTcwXHVBQUREXHVBQUYzXHVBQUY0XHVBQjVDLVx1QUI1Rlx1RkY3MFx1RkY5RVx1RkY5RicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODFBW1x1REY0MC1cdURGNDNdfFx1RDgxQltcdURGOTMtXHVERjlGXHVERkUwXHVERkUxXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTG8nLA0KICAgICAgICAnYWxpYXMnOiAnT3RoZXJfTGV0dGVyJywNCiAgICAgICAgJ2JtcCc6ICdceEFBXHhCQVx1MDFCQlx1MDFDMC1cdTAxQzNcdTAyOTRcdTA1RDAtXHUwNUVBXHUwNUVGLVx1MDVGMlx1MDYyMC1cdTA2M0ZcdTA2NDEtXHUwNjRBXHUwNjZFXHUwNjZGXHUwNjcxLVx1MDZEM1x1MDZENVx1MDZFRVx1MDZFRlx1MDZGQS1cdTA2RkNcdTA2RkZcdTA3MTBcdTA3MTItXHUwNzJGXHUwNzRELVx1MDdBNVx1MDdCMVx1MDdDQS1cdTA3RUFcdTA4MDAtXHUwODE1XHUwODQwLVx1MDg1OFx1MDg2MC1cdTA4NkFcdTA4QTAtXHUwOEI0XHUwOEI2LVx1MDhCRFx1MDkwNC1cdTA5MzlcdTA5M0RcdTA5NTBcdTA5NTgtXHUwOTYxXHUwOTcyLVx1MDk4MFx1MDk4NS1cdTA5OENcdTA5OEZcdTA5OTBcdTA5OTMtXHUwOUE4XHUwOUFBLVx1MDlCMFx1MDlCMlx1MDlCNi1cdTA5QjlcdTA5QkRcdTA5Q0VcdTA5RENcdTA5RERcdTA5REYtXHUwOUUxXHUwOUYwXHUwOUYxXHUwOUZDXHUwQTA1LVx1MEEwQVx1MEEwRlx1MEExMFx1MEExMy1cdTBBMjhcdTBBMkEtXHUwQTMwXHUwQTMyXHUwQTMzXHUwQTM1XHUwQTM2XHUwQTM4XHUwQTM5XHUwQTU5LVx1MEE1Q1x1MEE1RVx1MEE3Mi1cdTBBNzRcdTBBODUtXHUwQThEXHUwQThGLVx1MEE5MVx1MEE5My1cdTBBQThcdTBBQUEtXHUwQUIwXHUwQUIyXHUwQUIzXHUwQUI1LVx1MEFCOVx1MEFCRFx1MEFEMFx1MEFFMFx1MEFFMVx1MEFGOVx1MEIwNS1cdTBCMENcdTBCMEZcdTBCMTBcdTBCMTMtXHUwQjI4XHUwQjJBLVx1MEIzMFx1MEIzMlx1MEIzM1x1MEIzNS1cdTBCMzlcdTBCM0RcdTBCNUNcdTBCNURcdTBCNUYtXHUwQjYxXHUwQjcxXHUwQjgzXHUwQjg1LVx1MEI4QVx1MEI4RS1cdTBCOTBcdTBCOTItXHUwQjk1XHUwQjk5XHUwQjlBXHUwQjlDXHUwQjlFXHUwQjlGXHUwQkEzXHUwQkE0XHUwQkE4LVx1MEJBQVx1MEJBRS1cdTBCQjlcdTBCRDBcdTBDMDUtXHUwQzBDXHUwQzBFLVx1MEMxMFx1MEMxMi1cdTBDMjhcdTBDMkEtXHUwQzM5XHUwQzNEXHUwQzU4LVx1MEM1QVx1MEM2MFx1MEM2MVx1MEM4MFx1MEM4NS1cdTBDOENcdTBDOEUtXHUwQzkwXHUwQzkyLVx1MENBOFx1MENBQS1cdTBDQjNcdTBDQjUtXHUwQ0I5XHUwQ0JEXHUwQ0RFXHUwQ0UwXHUwQ0UxXHUwQ0YxXHUwQ0YyXHUwRDA1LVx1MEQwQ1x1MEQwRS1cdTBEMTBcdTBEMTItXHUwRDNBXHUwRDNEXHUwRDRFXHUwRDU0LVx1MEQ1Nlx1MEQ1Ri1cdTBENjFcdTBEN0EtXHUwRDdGXHUwRDg1LVx1MEQ5Nlx1MEQ5QS1cdTBEQjFcdTBEQjMtXHUwREJCXHUwREJEXHUwREMwLVx1MERDNlx1MEUwMS1cdTBFMzBcdTBFMzJcdTBFMzNcdTBFNDAtXHUwRTQ1XHUwRTgxXHUwRTgyXHUwRTg0XHUwRTg3XHUwRTg4XHUwRThBXHUwRThEXHUwRTk0LVx1MEU5N1x1MEU5OS1cdTBFOUZcdTBFQTEtXHUwRUEzXHUwRUE1XHUwRUE3XHUwRUFBXHUwRUFCXHUwRUFELVx1MEVCMFx1MEVCMlx1MEVCM1x1MEVCRFx1MEVDMC1cdTBFQzRcdTBFREMtXHUwRURGXHUwRjAwXHUwRjQwLVx1MEY0N1x1MEY0OS1cdTBGNkNcdTBGODgtXHUwRjhDXHUxMDAwLVx1MTAyQVx1MTAzRlx1MTA1MC1cdTEwNTVcdTEwNUEtXHUxMDVEXHUxMDYxXHUxMDY1XHUxMDY2XHUxMDZFLVx1MTA3MFx1MTA3NS1cdTEwODFcdTEwOEVcdTExMDAtXHUxMjQ4XHUxMjRBLVx1MTI0RFx1MTI1MC1cdTEyNTZcdTEyNThcdTEyNUEtXHUxMjVEXHUxMjYwLVx1MTI4OFx1MTI4QS1cdTEyOERcdTEyOTAtXHUxMkIwXHUxMkIyLVx1MTJCNVx1MTJCOC1cdTEyQkVcdTEyQzBcdTEyQzItXHUxMkM1XHUxMkM4LVx1MTJENlx1MTJEOC1cdTEzMTBcdTEzMTItXHUxMzE1XHUxMzE4LVx1MTM1QVx1MTM4MC1cdTEzOEZcdTE0MDEtXHUxNjZDXHUxNjZGLVx1MTY3Rlx1MTY4MS1cdTE2OUFcdTE2QTAtXHUxNkVBXHUxNkYxLVx1MTZGOFx1MTcwMC1cdTE3MENcdTE3MEUtXHUxNzExXHUxNzIwLVx1MTczMVx1MTc0MC1cdTE3NTFcdTE3NjAtXHUxNzZDXHUxNzZFLVx1MTc3MFx1MTc4MC1cdTE3QjNcdTE3RENcdTE4MjAtXHUxODQyXHUxODQ0LVx1MTg3OFx1MTg4MC1cdTE4ODRcdTE4ODctXHUxOEE4XHUxOEFBXHUxOEIwLVx1MThGNVx1MTkwMC1cdTE5MUVcdTE5NTAtXHUxOTZEXHUxOTcwLVx1MTk3NFx1MTk4MC1cdTE5QUJcdTE5QjAtXHUxOUM5XHUxQTAwLVx1MUExNlx1MUEyMC1cdTFBNTRcdTFCMDUtXHUxQjMzXHUxQjQ1LVx1MUI0Qlx1MUI4My1cdTFCQTBcdTFCQUVcdTFCQUZcdTFCQkEtXHUxQkU1XHUxQzAwLVx1MUMyM1x1MUM0RC1cdTFDNEZcdTFDNUEtXHUxQzc3XHUxQ0U5LVx1MUNFQ1x1MUNFRS1cdTFDRjFcdTFDRjVcdTFDRjZcdTIxMzUtXHUyMTM4XHUyRDMwLVx1MkQ2N1x1MkQ4MC1cdTJEOTZcdTJEQTAtXHUyREE2XHUyREE4LVx1MkRBRVx1MkRCMC1cdTJEQjZcdTJEQjgtXHUyREJFXHUyREMwLVx1MkRDNlx1MkRDOC1cdTJEQ0VcdTJERDAtXHUyREQ2XHUyREQ4LVx1MkRERVx1MzAwNlx1MzAzQ1x1MzA0MS1cdTMwOTZcdTMwOUZcdTMwQTEtXHUzMEZBXHUzMEZGXHUzMTA1LVx1MzEyRlx1MzEzMS1cdTMxOEVcdTMxQTAtXHUzMUJBXHUzMUYwLVx1MzFGRlx1MzQwMC1cdTREQjVcdTRFMDAtXHU5RkVGXHVBMDAwLVx1QTAxNFx1QTAxNi1cdUE0OENcdUE0RDAtXHVBNEY3XHVBNTAwLVx1QTYwQlx1QTYxMC1cdUE2MUZcdUE2MkFcdUE2MkJcdUE2NkVcdUE2QTAtXHVBNkU1XHVBNzhGXHVBN0Y3XHVBN0ZCLVx1QTgwMVx1QTgwMy1cdUE4MDVcdUE4MDctXHVBODBBXHVBODBDLVx1QTgyMlx1QTg0MC1cdUE4NzNcdUE4ODItXHVBOEIzXHVBOEYyLVx1QThGN1x1QThGQlx1QThGRFx1QThGRVx1QTkwQS1cdUE5MjVcdUE5MzAtXHVBOTQ2XHVBOTYwLVx1QTk3Q1x1QTk4NC1cdUE5QjJcdUE5RTAtXHVBOUU0XHVBOUU3LVx1QTlFRlx1QTlGQS1cdUE5RkVcdUFBMDAtXHVBQTI4XHVBQTQwLVx1QUE0Mlx1QUE0NC1cdUFBNEJcdUFBNjAtXHVBQTZGXHVBQTcxLVx1QUE3Nlx1QUE3QVx1QUE3RS1cdUFBQUZcdUFBQjFcdUFBQjVcdUFBQjZcdUFBQjktXHVBQUJEXHVBQUMwXHVBQUMyXHVBQURCXHVBQURDXHVBQUUwLVx1QUFFQVx1QUFGMlx1QUIwMS1cdUFCMDZcdUFCMDktXHVBQjBFXHVBQjExLVx1QUIxNlx1QUIyMC1cdUFCMjZcdUFCMjgtXHVBQjJFXHVBQkMwLVx1QUJFMlx1QUMwMC1cdUQ3QTNcdUQ3QjAtXHVEN0M2XHVEN0NCLVx1RDdGQlx1RjkwMC1cdUZBNkRcdUZBNzAtXHVGQUQ5XHVGQjFEXHVGQjFGLVx1RkIyOFx1RkIyQS1cdUZCMzZcdUZCMzgtXHVGQjNDXHVGQjNFXHVGQjQwXHVGQjQxXHVGQjQzXHVGQjQ0XHVGQjQ2LVx1RkJCMVx1RkJEMy1cdUZEM0RcdUZENTAtXHVGRDhGXHVGRDkyLVx1RkRDN1x1RkRGMC1cdUZERkJcdUZFNzAtXHVGRTc0XHVGRTc2LVx1RkVGQ1x1RkY2Ni1cdUZGNkZcdUZGNzEtXHVGRjlEXHVGRkEwLVx1RkZCRVx1RkZDMi1cdUZGQzdcdUZGQ0EtXHVGRkNGXHVGRkQyLVx1RkZEN1x1RkZEQS1cdUZGREMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMFtcdURDMDAtXHVEQzBCXHVEQzBELVx1REMyNlx1REMyOC1cdURDM0FcdURDM0NcdURDM0RcdURDM0YtXHVEQzREXHVEQzUwLVx1REM1RFx1REM4MC1cdURDRkFcdURFODAtXHVERTlDXHVERUEwLVx1REVEMFx1REYwMC1cdURGMUZcdURGMkQtXHVERjQwXHVERjQyLVx1REY0OVx1REY1MC1cdURGNzVcdURGODAtXHVERjlEXHVERkEwLVx1REZDM1x1REZDOC1cdURGQ0ZdfFx1RDgwMVtcdURDNTAtXHVEQzlEXHVERDAwLVx1REQyN1x1REQzMC1cdURENjNcdURFMDAtXHVERjM2XHVERjQwLVx1REY1NVx1REY2MC1cdURGNjddfFx1RDgwMltcdURDMDAtXHVEQzA1XHVEQzA4XHVEQzBBLVx1REMzNVx1REMzN1x1REMzOFx1REMzQ1x1REMzRi1cdURDNTVcdURDNjAtXHVEQzc2XHVEQzgwLVx1REM5RVx1RENFMC1cdURDRjJcdURDRjRcdURDRjVcdUREMDAtXHVERDE1XHVERDIwLVx1REQzOVx1REQ4MC1cdUREQjdcdUREQkVcdUREQkZcdURFMDBcdURFMTAtXHVERTEzXHVERTE1LVx1REUxN1x1REUxOS1cdURFMzVcdURFNjAtXHVERTdDXHVERTgwLVx1REU5Q1x1REVDMC1cdURFQzdcdURFQzktXHVERUU0XHVERjAwLVx1REYzNVx1REY0MC1cdURGNTVcdURGNjAtXHVERjcyXHVERjgwLVx1REY5MV18XHVEODAzW1x1REMwMC1cdURDNDhcdUREMDAtXHVERDIzXHVERjAwLVx1REYxQ1x1REYyN1x1REYzMC1cdURGNDVdfFx1RDgwNFtcdURDMDMtXHVEQzM3XHVEQzgzLVx1RENBRlx1RENEMC1cdURDRThcdUREMDMtXHVERDI2XHVERDQ0XHVERDUwLVx1REQ3Mlx1REQ3Nlx1REQ4My1cdUREQjJcdUREQzEtXHVEREM0XHVERERBXHVERERDXHVERTAwLVx1REUxMVx1REUxMy1cdURFMkJcdURFODAtXHVERTg2XHVERTg4XHVERThBLVx1REU4RFx1REU4Ri1cdURFOURcdURFOUYtXHVERUE4XHVERUIwLVx1REVERVx1REYwNS1cdURGMENcdURGMEZcdURGMTBcdURGMTMtXHVERjI4XHVERjJBLVx1REYzMFx1REYzMlx1REYzM1x1REYzNS1cdURGMzlcdURGM0RcdURGNTBcdURGNUQtXHVERjYxXXxcdUQ4MDVbXHVEQzAwLVx1REMzNFx1REM0Ny1cdURDNEFcdURDODAtXHVEQ0FGXHVEQ0M0XHVEQ0M1XHVEQ0M3XHVERDgwLVx1RERBRVx1REREOC1cdUREREJcdURFMDAtXHVERTJGXHVERTQ0XHVERTgwLVx1REVBQVx1REYwMC1cdURGMUFdfFx1RDgwNltcdURDMDAtXHVEQzJCXHVEQ0ZGXHVERTAwXHVERTBCLVx1REUzMlx1REUzQVx1REU1MFx1REU1Qy1cdURFODNcdURFODYtXHVERTg5XHVERTlEXHVERUMwLVx1REVGOF18XHVEODA3W1x1REMwMC1cdURDMDhcdURDMEEtXHVEQzJFXHVEQzQwXHVEQzcyLVx1REM4Rlx1REQwMC1cdUREMDZcdUREMDhcdUREMDlcdUREMEItXHVERDMwXHVERDQ2XHVERDYwLVx1REQ2NVx1REQ2N1x1REQ2OFx1REQ2QS1cdUREODlcdUREOThcdURFRTAtXHVERUYyXXxcdUQ4MDhbXHVEQzAwLVx1REY5OV18XHVEODA5W1x1REM4MC1cdURENDNdfFtcdUQ4MENcdUQ4MUMtXHVEODIwXHVEODQwLVx1RDg2OFx1RDg2QS1cdUQ4NkNcdUQ4NkYtXHVEODcyXHVEODc0LVx1RDg3OV1bXHVEQzAwLVx1REZGRl18XHVEODBEW1x1REMwMC1cdURDMkVdfFx1RDgxMVtcdURDMDAtXHVERTQ2XXxcdUQ4MUFbXHVEQzAwLVx1REUzOFx1REU0MC1cdURFNUVcdURFRDAtXHVERUVEXHVERjAwLVx1REYyRlx1REY2My1cdURGNzdcdURGN0QtXHVERjhGXXxcdUQ4MUJbXHVERjAwLVx1REY0NFx1REY1MF18XHVEODIxW1x1REMwMC1cdURGRjFdfFx1RDgyMltcdURDMDAtXHVERUYyXXxcdUQ4MkNbXHVEQzAwLVx1REQxRVx1REQ3MC1cdURFRkJdfFx1RDgyRltcdURDMDAtXHVEQzZBXHVEQzcwLVx1REM3Q1x1REM4MC1cdURDODhcdURDOTAtXHVEQzk5XXxcdUQ4M0FbXHVEQzAwLVx1RENDNF18XHVEODNCW1x1REUwMC1cdURFMDNcdURFMDUtXHVERTFGXHVERTIxXHVERTIyXHVERTI0XHVERTI3XHVERTI5LVx1REUzMlx1REUzNC1cdURFMzdcdURFMzlcdURFM0JcdURFNDJcdURFNDdcdURFNDlcdURFNEJcdURFNEQtXHVERTRGXHVERTUxXHVERTUyXHVERTU0XHVERTU3XHVERTU5XHVERTVCXHVERTVEXHVERTVGXHVERTYxXHVERTYyXHVERTY0XHVERTY3LVx1REU2QVx1REU2Qy1cdURFNzJcdURFNzQtXHVERTc3XHVERTc5LVx1REU3Q1x1REU3RVx1REU4MC1cdURFODlcdURFOEItXHVERTlCXHVERUExLVx1REVBM1x1REVBNS1cdURFQTlcdURFQUItXHVERUJCXXxcdUQ4NjlbXHVEQzAwLVx1REVENlx1REYwMC1cdURGRkZdfFx1RDg2RFtcdURDMDAtXHVERjM0XHVERjQwLVx1REZGRl18XHVEODZFW1x1REMwMC1cdURDMURcdURDMjAtXHVERkZGXXxcdUQ4NzNbXHVEQzAwLVx1REVBMVx1REVCMC1cdURGRkZdfFx1RDg3QVtcdURDMDAtXHVERkUwXXxcdUQ4N0VbXHVEQzAwLVx1REUxRF0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0x0JywNCiAgICAgICAgJ2FsaWFzJzogJ1RpdGxlY2FzZV9MZXR0ZXInLA0KICAgICAgICAnYm1wJzogJ1x1MDFDNVx1MDFDOFx1MDFDQlx1MDFGMlx1MUY4OC1cdTFGOEZcdTFGOTgtXHUxRjlGXHUxRkE4LVx1MUZBRlx1MUZCQ1x1MUZDQ1x1MUZGQycNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTHUnLA0KICAgICAgICAnYWxpYXMnOiAnVXBwZXJjYXNlX0xldHRlcicsDQogICAgICAgICdibXAnOiAnQS1aXHhDMC1ceEQ2XHhEOC1ceERFXHUwMTAwXHUwMTAyXHUwMTA0XHUwMTA2XHUwMTA4XHUwMTBBXHUwMTBDXHUwMTBFXHUwMTEwXHUwMTEyXHUwMTE0XHUwMTE2XHUwMTE4XHUwMTFBXHUwMTFDXHUwMTFFXHUwMTIwXHUwMTIyXHUwMTI0XHUwMTI2XHUwMTI4XHUwMTJBXHUwMTJDXHUwMTJFXHUwMTMwXHUwMTMyXHUwMTM0XHUwMTM2XHUwMTM5XHUwMTNCXHUwMTNEXHUwMTNGXHUwMTQxXHUwMTQzXHUwMTQ1XHUwMTQ3XHUwMTRBXHUwMTRDXHUwMTRFXHUwMTUwXHUwMTUyXHUwMTU0XHUwMTU2XHUwMTU4XHUwMTVBXHUwMTVDXHUwMTVFXHUwMTYwXHUwMTYyXHUwMTY0XHUwMTY2XHUwMTY4XHUwMTZBXHUwMTZDXHUwMTZFXHUwMTcwXHUwMTcyXHUwMTc0XHUwMTc2XHUwMTc4XHUwMTc5XHUwMTdCXHUwMTdEXHUwMTgxXHUwMTgyXHUwMTg0XHUwMTg2XHUwMTg3XHUwMTg5LVx1MDE4Qlx1MDE4RS1cdTAxOTFcdTAxOTNcdTAxOTRcdTAxOTYtXHUwMTk4XHUwMTlDXHUwMTlEXHUwMTlGXHUwMUEwXHUwMUEyXHUwMUE0XHUwMUE2XHUwMUE3XHUwMUE5XHUwMUFDXHUwMUFFXHUwMUFGXHUwMUIxLVx1MDFCM1x1MDFCNVx1MDFCN1x1MDFCOFx1MDFCQ1x1MDFDNFx1MDFDN1x1MDFDQVx1MDFDRFx1MDFDRlx1MDFEMVx1MDFEM1x1MDFENVx1MDFEN1x1MDFEOVx1MDFEQlx1MDFERVx1MDFFMFx1MDFFMlx1MDFFNFx1MDFFNlx1MDFFOFx1MDFFQVx1MDFFQ1x1MDFFRVx1MDFGMVx1MDFGNFx1MDFGNi1cdTAxRjhcdTAxRkFcdTAxRkNcdTAxRkVcdTAyMDBcdTAyMDJcdTAyMDRcdTAyMDZcdTAyMDhcdTAyMEFcdTAyMENcdTAyMEVcdTAyMTBcdTAyMTJcdTAyMTRcdTAyMTZcdTAyMThcdTAyMUFcdTAyMUNcdTAyMUVcdTAyMjBcdTAyMjJcdTAyMjRcdTAyMjZcdTAyMjhcdTAyMkFcdTAyMkNcdTAyMkVcdTAyMzBcdTAyMzJcdTAyM0FcdTAyM0JcdTAyM0RcdTAyM0VcdTAyNDFcdTAyNDMtXHUwMjQ2XHUwMjQ4XHUwMjRBXHUwMjRDXHUwMjRFXHUwMzcwXHUwMzcyXHUwMzc2XHUwMzdGXHUwMzg2XHUwMzg4LVx1MDM4QVx1MDM4Q1x1MDM4RVx1MDM4Rlx1MDM5MS1cdTAzQTFcdTAzQTMtXHUwM0FCXHUwM0NGXHUwM0QyLVx1MDNENFx1MDNEOFx1MDNEQVx1MDNEQ1x1MDNERVx1MDNFMFx1MDNFMlx1MDNFNFx1MDNFNlx1MDNFOFx1MDNFQVx1MDNFQ1x1MDNFRVx1MDNGNFx1MDNGN1x1MDNGOVx1MDNGQVx1MDNGRC1cdTA0MkZcdTA0NjBcdTA0NjJcdTA0NjRcdTA0NjZcdTA0NjhcdTA0NkFcdTA0NkNcdTA0NkVcdTA0NzBcdTA0NzJcdTA0NzRcdTA0NzZcdTA0NzhcdTA0N0FcdTA0N0NcdTA0N0VcdTA0ODBcdTA0OEFcdTA0OENcdTA0OEVcdTA0OTBcdTA0OTJcdTA0OTRcdTA0OTZcdTA0OThcdTA0OUFcdTA0OUNcdTA0OUVcdTA0QTBcdTA0QTJcdTA0QTRcdTA0QTZcdTA0QThcdTA0QUFcdTA0QUNcdTA0QUVcdTA0QjBcdTA0QjJcdTA0QjRcdTA0QjZcdTA0QjhcdTA0QkFcdTA0QkNcdTA0QkVcdTA0QzBcdTA0QzFcdTA0QzNcdTA0QzVcdTA0QzdcdTA0QzlcdTA0Q0JcdTA0Q0RcdTA0RDBcdTA0RDJcdTA0RDRcdTA0RDZcdTA0RDhcdTA0REFcdTA0RENcdTA0REVcdTA0RTBcdTA0RTJcdTA0RTRcdTA0RTZcdTA0RThcdTA0RUFcdTA0RUNcdTA0RUVcdTA0RjBcdTA0RjJcdTA0RjRcdTA0RjZcdTA0RjhcdTA0RkFcdTA0RkNcdTA0RkVcdTA1MDBcdTA1MDJcdTA1MDRcdTA1MDZcdTA1MDhcdTA1MEFcdTA1MENcdTA1MEVcdTA1MTBcdTA1MTJcdTA1MTRcdTA1MTZcdTA1MThcdTA1MUFcdTA1MUNcdTA1MUVcdTA1MjBcdTA1MjJcdTA1MjRcdTA1MjZcdTA1MjhcdTA1MkFcdTA1MkNcdTA1MkVcdTA1MzEtXHUwNTU2XHUxMEEwLVx1MTBDNVx1MTBDN1x1MTBDRFx1MTNBMC1cdTEzRjVcdTFDOTAtXHUxQ0JBXHUxQ0JELVx1MUNCRlx1MUUwMFx1MUUwMlx1MUUwNFx1MUUwNlx1MUUwOFx1MUUwQVx1MUUwQ1x1MUUwRVx1MUUxMFx1MUUxMlx1MUUxNFx1MUUxNlx1MUUxOFx1MUUxQVx1MUUxQ1x1MUUxRVx1MUUyMFx1MUUyMlx1MUUyNFx1MUUyNlx1MUUyOFx1MUUyQVx1MUUyQ1x1MUUyRVx1MUUzMFx1MUUzMlx1MUUzNFx1MUUzNlx1MUUzOFx1MUUzQVx1MUUzQ1x1MUUzRVx1MUU0MFx1MUU0Mlx1MUU0NFx1MUU0Nlx1MUU0OFx1MUU0QVx1MUU0Q1x1MUU0RVx1MUU1MFx1MUU1Mlx1MUU1NFx1MUU1Nlx1MUU1OFx1MUU1QVx1MUU1Q1x1MUU1RVx1MUU2MFx1MUU2Mlx1MUU2NFx1MUU2Nlx1MUU2OFx1MUU2QVx1MUU2Q1x1MUU2RVx1MUU3MFx1MUU3Mlx1MUU3NFx1MUU3Nlx1MUU3OFx1MUU3QVx1MUU3Q1x1MUU3RVx1MUU4MFx1MUU4Mlx1MUU4NFx1MUU4Nlx1MUU4OFx1MUU4QVx1MUU4Q1x1MUU4RVx1MUU5MFx1MUU5Mlx1MUU5NFx1MUU5RVx1MUVBMFx1MUVBMlx1MUVBNFx1MUVBNlx1MUVBOFx1MUVBQVx1MUVBQ1x1MUVBRVx1MUVCMFx1MUVCMlx1MUVCNFx1MUVCNlx1MUVCOFx1MUVCQVx1MUVCQ1x1MUVCRVx1MUVDMFx1MUVDMlx1MUVDNFx1MUVDNlx1MUVDOFx1MUVDQVx1MUVDQ1x1MUVDRVx1MUVEMFx1MUVEMlx1MUVENFx1MUVENlx1MUVEOFx1MUVEQVx1MUVEQ1x1MUVERVx1MUVFMFx1MUVFMlx1MUVFNFx1MUVFNlx1MUVFOFx1MUVFQVx1MUVFQ1x1MUVFRVx1MUVGMFx1MUVGMlx1MUVGNFx1MUVGNlx1MUVGOFx1MUVGQVx1MUVGQ1x1MUVGRVx1MUYwOC1cdTFGMEZcdTFGMTgtXHUxRjFEXHUxRjI4LVx1MUYyRlx1MUYzOC1cdTFGM0ZcdTFGNDgtXHUxRjREXHUxRjU5XHUxRjVCXHUxRjVEXHUxRjVGXHUxRjY4LVx1MUY2Rlx1MUZCOC1cdTFGQkJcdTFGQzgtXHUxRkNCXHUxRkQ4LVx1MUZEQlx1MUZFOC1cdTFGRUNcdTFGRjgtXHUxRkZCXHUyMTAyXHUyMTA3XHUyMTBCLVx1MjEwRFx1MjExMC1cdTIxMTJcdTIxMTVcdTIxMTktXHUyMTFEXHUyMTI0XHUyMTI2XHUyMTI4XHUyMTJBLVx1MjEyRFx1MjEzMC1cdTIxMzNcdTIxM0VcdTIxM0ZcdTIxNDVcdTIxODNcdTJDMDAtXHUyQzJFXHUyQzYwXHUyQzYyLVx1MkM2NFx1MkM2N1x1MkM2OVx1MkM2Qlx1MkM2RC1cdTJDNzBcdTJDNzJcdTJDNzVcdTJDN0UtXHUyQzgwXHUyQzgyXHUyQzg0XHUyQzg2XHUyQzg4XHUyQzhBXHUyQzhDXHUyQzhFXHUyQzkwXHUyQzkyXHUyQzk0XHUyQzk2XHUyQzk4XHUyQzlBXHUyQzlDXHUyQzlFXHUyQ0EwXHUyQ0EyXHUyQ0E0XHUyQ0E2XHUyQ0E4XHUyQ0FBXHUyQ0FDXHUyQ0FFXHUyQ0IwXHUyQ0IyXHUyQ0I0XHUyQ0I2XHUyQ0I4XHUyQ0JBXHUyQ0JDXHUyQ0JFXHUyQ0MwXHUyQ0MyXHUyQ0M0XHUyQ0M2XHUyQ0M4XHUyQ0NBXHUyQ0NDXHUyQ0NFXHUyQ0QwXHUyQ0QyXHUyQ0Q0XHUyQ0Q2XHUyQ0Q4XHUyQ0RBXHUyQ0RDXHUyQ0RFXHUyQ0UwXHUyQ0UyXHUyQ0VCXHUyQ0VEXHUyQ0YyXHVBNjQwXHVBNjQyXHVBNjQ0XHVBNjQ2XHVBNjQ4XHVBNjRBXHVBNjRDXHVBNjRFXHVBNjUwXHVBNjUyXHVBNjU0XHVBNjU2XHVBNjU4XHVBNjVBXHVBNjVDXHVBNjVFXHVBNjYwXHVBNjYyXHVBNjY0XHVBNjY2XHVBNjY4XHVBNjZBXHVBNjZDXHVBNjgwXHVBNjgyXHVBNjg0XHVBNjg2XHVBNjg4XHVBNjhBXHVBNjhDXHVBNjhFXHVBNjkwXHVBNjkyXHVBNjk0XHVBNjk2XHVBNjk4XHVBNjlBXHVBNzIyXHVBNzI0XHVBNzI2XHVBNzI4XHVBNzJBXHVBNzJDXHVBNzJFXHVBNzMyXHVBNzM0XHVBNzM2XHVBNzM4XHVBNzNBXHVBNzNDXHVBNzNFXHVBNzQwXHVBNzQyXHVBNzQ0XHVBNzQ2XHVBNzQ4XHVBNzRBXHVBNzRDXHVBNzRFXHVBNzUwXHVBNzUyXHVBNzU0XHVBNzU2XHVBNzU4XHVBNzVBXHVBNzVDXHVBNzVFXHVBNzYwXHVBNzYyXHVBNzY0XHVBNzY2XHVBNzY4XHVBNzZBXHVBNzZDXHVBNzZFXHVBNzc5XHVBNzdCXHVBNzdEXHVBNzdFXHVBNzgwXHVBNzgyXHVBNzg0XHVBNzg2XHVBNzhCXHVBNzhEXHVBNzkwXHVBNzkyXHVBNzk2XHVBNzk4XHVBNzlBXHVBNzlDXHVBNzlFXHVBN0EwXHVBN0EyXHVBN0E0XHVBN0E2XHVBN0E4XHVBN0FBLVx1QTdBRVx1QTdCMC1cdUE3QjRcdUE3QjZcdUE3QjhcdUZGMjEtXHVGRjNBJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDFbXHVEQzAwLVx1REMyN1x1RENCMC1cdURDRDNdfFx1RDgwM1tcdURDODAtXHVEQ0IyXXxcdUQ4MDZbXHVEQ0EwLVx1RENCRl18XHVEODFCW1x1REU0MC1cdURFNUZdfFx1RDgzNVtcdURDMDAtXHVEQzE5XHVEQzM0LVx1REM0RFx1REM2OC1cdURDODFcdURDOUNcdURDOUVcdURDOUZcdURDQTJcdURDQTVcdURDQTZcdURDQTktXHVEQ0FDXHVEQ0FFLVx1RENCNVx1RENEMC1cdURDRTlcdUREMDRcdUREMDVcdUREMDctXHVERDBBXHVERDBELVx1REQxNFx1REQxNi1cdUREMUNcdUREMzhcdUREMzlcdUREM0ItXHVERDNFXHVERDQwLVx1REQ0NFx1REQ0Nlx1REQ0QS1cdURENTBcdURENkMtXHVERDg1XHVEREEwLVx1RERCOVx1RERENC1cdURERURcdURFMDgtXHVERTIxXHVERTNDLVx1REU1NVx1REU3MC1cdURFODlcdURFQTgtXHVERUMwXHVERUUyLVx1REVGQVx1REYxQy1cdURGMzRcdURGNTYtXHVERjZFXHVERjkwLVx1REZBOFx1REZDQV18XHVEODNBW1x1REQwMC1cdUREMjFdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdNJywNCiAgICAgICAgJ2FsaWFzJzogJ01hcmsnLA0KICAgICAgICAnYm1wJzogJ1x1MDMwMC1cdTAzNkZcdTA0ODMtXHUwNDg5XHUwNTkxLVx1MDVCRFx1MDVCRlx1MDVDMVx1MDVDMlx1MDVDNFx1MDVDNVx1MDVDN1x1MDYxMC1cdTA2MUFcdTA2NEItXHUwNjVGXHUwNjcwXHUwNkQ2LVx1MDZEQ1x1MDZERi1cdTA2RTRcdTA2RTdcdTA2RThcdTA2RUEtXHUwNkVEXHUwNzExXHUwNzMwLVx1MDc0QVx1MDdBNi1cdTA3QjBcdTA3RUItXHUwN0YzXHUwN0ZEXHUwODE2LVx1MDgxOVx1MDgxQi1cdTA4MjNcdTA4MjUtXHUwODI3XHUwODI5LVx1MDgyRFx1MDg1OS1cdTA4NUJcdTA4RDMtXHUwOEUxXHUwOEUzLVx1MDkwM1x1MDkzQS1cdTA5M0NcdTA5M0UtXHUwOTRGXHUwOTUxLVx1MDk1N1x1MDk2Mlx1MDk2M1x1MDk4MS1cdTA5ODNcdTA5QkNcdTA5QkUtXHUwOUM0XHUwOUM3XHUwOUM4XHUwOUNCLVx1MDlDRFx1MDlEN1x1MDlFMlx1MDlFM1x1MDlGRVx1MEEwMS1cdTBBMDNcdTBBM0NcdTBBM0UtXHUwQTQyXHUwQTQ3XHUwQTQ4XHUwQTRCLVx1MEE0RFx1MEE1MVx1MEE3MFx1MEE3MVx1MEE3NVx1MEE4MS1cdTBBODNcdTBBQkNcdTBBQkUtXHUwQUM1XHUwQUM3LVx1MEFDOVx1MEFDQi1cdTBBQ0RcdTBBRTJcdTBBRTNcdTBBRkEtXHUwQUZGXHUwQjAxLVx1MEIwM1x1MEIzQ1x1MEIzRS1cdTBCNDRcdTBCNDdcdTBCNDhcdTBCNEItXHUwQjREXHUwQjU2XHUwQjU3XHUwQjYyXHUwQjYzXHUwQjgyXHUwQkJFLVx1MEJDMlx1MEJDNi1cdTBCQzhcdTBCQ0EtXHUwQkNEXHUwQkQ3XHUwQzAwLVx1MEMwNFx1MEMzRS1cdTBDNDRcdTBDNDYtXHUwQzQ4XHUwQzRBLVx1MEM0RFx1MEM1NVx1MEM1Nlx1MEM2Mlx1MEM2M1x1MEM4MS1cdTBDODNcdTBDQkNcdTBDQkUtXHUwQ0M0XHUwQ0M2LVx1MENDOFx1MENDQS1cdTBDQ0RcdTBDRDVcdTBDRDZcdTBDRTJcdTBDRTNcdTBEMDAtXHUwRDAzXHUwRDNCXHUwRDNDXHUwRDNFLVx1MEQ0NFx1MEQ0Ni1cdTBENDhcdTBENEEtXHUwRDREXHUwRDU3XHUwRDYyXHUwRDYzXHUwRDgyXHUwRDgzXHUwRENBXHUwRENGLVx1MERENFx1MERENlx1MEREOC1cdTBEREZcdTBERjJcdTBERjNcdTBFMzFcdTBFMzQtXHUwRTNBXHUwRTQ3LVx1MEU0RVx1MEVCMVx1MEVCNC1cdTBFQjlcdTBFQkJcdTBFQkNcdTBFQzgtXHUwRUNEXHUwRjE4XHUwRjE5XHUwRjM1XHUwRjM3XHUwRjM5XHUwRjNFXHUwRjNGXHUwRjcxLVx1MEY4NFx1MEY4Nlx1MEY4N1x1MEY4RC1cdTBGOTdcdTBGOTktXHUwRkJDXHUwRkM2XHUxMDJCLVx1MTAzRVx1MTA1Ni1cdTEwNTlcdTEwNUUtXHUxMDYwXHUxMDYyLVx1MTA2NFx1MTA2Ny1cdTEwNkRcdTEwNzEtXHUxMDc0XHUxMDgyLVx1MTA4RFx1MTA4Rlx1MTA5QS1cdTEwOURcdTEzNUQtXHUxMzVGXHUxNzEyLVx1MTcxNFx1MTczMi1cdTE3MzRcdTE3NTJcdTE3NTNcdTE3NzJcdTE3NzNcdTE3QjQtXHUxN0QzXHUxN0REXHUxODBCLVx1MTgwRFx1MTg4NVx1MTg4Nlx1MThBOVx1MTkyMC1cdTE5MkJcdTE5MzAtXHUxOTNCXHUxQTE3LVx1MUExQlx1MUE1NS1cdTFBNUVcdTFBNjAtXHUxQTdDXHUxQTdGXHUxQUIwLVx1MUFCRVx1MUIwMC1cdTFCMDRcdTFCMzQtXHUxQjQ0XHUxQjZCLVx1MUI3M1x1MUI4MC1cdTFCODJcdTFCQTEtXHUxQkFEXHUxQkU2LVx1MUJGM1x1MUMyNC1cdTFDMzdcdTFDRDAtXHUxQ0QyXHUxQ0Q0LVx1MUNFOFx1MUNFRFx1MUNGMi1cdTFDRjRcdTFDRjctXHUxQ0Y5XHUxREMwLVx1MURGOVx1MURGQi1cdTFERkZcdTIwRDAtXHUyMEYwXHUyQ0VGLVx1MkNGMVx1MkQ3Rlx1MkRFMC1cdTJERkZcdTMwMkEtXHUzMDJGXHUzMDk5XHUzMDlBXHVBNjZGLVx1QTY3Mlx1QTY3NC1cdUE2N0RcdUE2OUVcdUE2OUZcdUE2RjBcdUE2RjFcdUE4MDJcdUE4MDZcdUE4MEJcdUE4MjMtXHVBODI3XHVBODgwXHVBODgxXHVBOEI0LVx1QThDNVx1QThFMC1cdUE4RjFcdUE4RkZcdUE5MjYtXHVBOTJEXHVBOTQ3LVx1QTk1M1x1QTk4MC1cdUE5ODNcdUE5QjMtXHVBOUMwXHVBOUU1XHVBQTI5LVx1QUEzNlx1QUE0M1x1QUE0Q1x1QUE0RFx1QUE3Qi1cdUFBN0RcdUFBQjBcdUFBQjItXHVBQUI0XHVBQUI3XHVBQUI4XHVBQUJFXHVBQUJGXHVBQUMxXHVBQUVCLVx1QUFFRlx1QUFGNVx1QUFGNlx1QUJFMy1cdUFCRUFcdUFCRUNcdUFCRURcdUZCMUVcdUZFMDAtXHVGRTBGXHVGRTIwLVx1RkUyRicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAwW1x1RERGRFx1REVFMFx1REY3Ni1cdURGN0FdfFx1RDgwMltcdURFMDEtXHVERTAzXHVERTA1XHVERTA2XHVERTBDLVx1REUwRlx1REUzOC1cdURFM0FcdURFM0ZcdURFRTVcdURFRTZdfFx1RDgwM1tcdUREMjQtXHVERDI3XHVERjQ2LVx1REY1MF18XHVEODA0W1x1REMwMC1cdURDMDJcdURDMzgtXHVEQzQ2XHVEQzdGLVx1REM4Mlx1RENCMC1cdURDQkFcdUREMDAtXHVERDAyXHVERDI3LVx1REQzNFx1REQ0NVx1REQ0Nlx1REQ3M1x1REQ4MC1cdUREODJcdUREQjMtXHVEREMwXHVEREM5LVx1RERDQ1x1REUyQy1cdURFMzdcdURFM0VcdURFREYtXHVERUVBXHVERjAwLVx1REYwM1x1REYzQlx1REYzQ1x1REYzRS1cdURGNDRcdURGNDdcdURGNDhcdURGNEItXHVERjREXHVERjU3XHVERjYyXHVERjYzXHVERjY2LVx1REY2Q1x1REY3MC1cdURGNzRdfFx1RDgwNVtcdURDMzUtXHVEQzQ2XHVEQzVFXHVEQ0IwLVx1RENDM1x1RERBRi1cdUREQjVcdUREQjgtXHVEREMwXHVERERDXHVEREREXHVERTMwLVx1REU0MFx1REVBQi1cdURFQjdcdURGMUQtXHVERjJCXXxcdUQ4MDZbXHVEQzJDLVx1REMzQVx1REUwMS1cdURFMEFcdURFMzMtXHVERTM5XHVERTNCLVx1REUzRVx1REU0N1x1REU1MS1cdURFNUJcdURFOEEtXHVERTk5XXxcdUQ4MDdbXHVEQzJGLVx1REMzNlx1REMzOC1cdURDM0ZcdURDOTItXHVEQ0E3XHVEQ0E5LVx1RENCNlx1REQzMS1cdUREMzZcdUREM0FcdUREM0NcdUREM0RcdUREM0YtXHVERDQ1XHVERDQ3XHVERDhBLVx1REQ4RVx1REQ5MFx1REQ5MVx1REQ5My1cdUREOTdcdURFRjMtXHVERUY2XXxcdUQ4MUFbXHVERUYwLVx1REVGNFx1REYzMC1cdURGMzZdfFx1RDgxQltcdURGNTEtXHVERjdFXHVERjhGLVx1REY5Ml18XHVEODJGW1x1REM5RFx1REM5RV18XHVEODM0W1x1REQ2NS1cdURENjlcdURENkQtXHVERDcyXHVERDdCLVx1REQ4Mlx1REQ4NS1cdUREOEJcdUREQUEtXHVEREFEXHVERTQyLVx1REU0NF18XHVEODM2W1x1REUwMC1cdURFMzZcdURFM0ItXHVERTZDXHVERTc1XHVERTg0XHVERTlCLVx1REU5Rlx1REVBMS1cdURFQUZdfFx1RDgzOFtcdURDMDAtXHVEQzA2XHVEQzA4LVx1REMxOFx1REMxQi1cdURDMjFcdURDMjNcdURDMjRcdURDMjYtXHVEQzJBXXxcdUQ4M0FbXHVEQ0QwLVx1RENENlx1REQ0NC1cdURENEFdfFx1REI0MFtcdUREMDAtXHVEREVGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTWMnLA0KICAgICAgICAnYWxpYXMnOiAnU3BhY2luZ19NYXJrJywNCiAgICAgICAgJ2JtcCc6ICdcdTA5MDNcdTA5M0JcdTA5M0UtXHUwOTQwXHUwOTQ5LVx1MDk0Q1x1MDk0RVx1MDk0Rlx1MDk4Mlx1MDk4M1x1MDlCRS1cdTA5QzBcdTA5QzdcdTA5QzhcdTA5Q0JcdTA5Q0NcdTA5RDdcdTBBMDNcdTBBM0UtXHUwQTQwXHUwQTgzXHUwQUJFLVx1MEFDMFx1MEFDOVx1MEFDQlx1MEFDQ1x1MEIwMlx1MEIwM1x1MEIzRVx1MEI0MFx1MEI0N1x1MEI0OFx1MEI0Qlx1MEI0Q1x1MEI1N1x1MEJCRVx1MEJCRlx1MEJDMVx1MEJDMlx1MEJDNi1cdTBCQzhcdTBCQ0EtXHUwQkNDXHUwQkQ3XHUwQzAxLVx1MEMwM1x1MEM0MS1cdTBDNDRcdTBDODJcdTBDODNcdTBDQkVcdTBDQzAtXHUwQ0M0XHUwQ0M3XHUwQ0M4XHUwQ0NBXHUwQ0NCXHUwQ0Q1XHUwQ0Q2XHUwRDAyXHUwRDAzXHUwRDNFLVx1MEQ0MFx1MEQ0Ni1cdTBENDhcdTBENEEtXHUwRDRDXHUwRDU3XHUwRDgyXHUwRDgzXHUwRENGLVx1MEREMVx1MEREOC1cdTBEREZcdTBERjJcdTBERjNcdTBGM0VcdTBGM0ZcdTBGN0ZcdTEwMkJcdTEwMkNcdTEwMzFcdTEwMzhcdTEwM0JcdTEwM0NcdTEwNTZcdTEwNTdcdTEwNjItXHUxMDY0XHUxMDY3LVx1MTA2RFx1MTA4M1x1MTA4NFx1MTA4Ny1cdTEwOENcdTEwOEZcdTEwOUEtXHUxMDlDXHUxN0I2XHUxN0JFLVx1MTdDNVx1MTdDN1x1MTdDOFx1MTkyMy1cdTE5MjZcdTE5MjktXHUxOTJCXHUxOTMwXHUxOTMxXHUxOTMzLVx1MTkzOFx1MUExOVx1MUExQVx1MUE1NVx1MUE1N1x1MUE2MVx1MUE2M1x1MUE2NFx1MUE2RC1cdTFBNzJcdTFCMDRcdTFCMzVcdTFCM0JcdTFCM0QtXHUxQjQxXHUxQjQzXHUxQjQ0XHUxQjgyXHUxQkExXHUxQkE2XHUxQkE3XHUxQkFBXHUxQkU3XHUxQkVBLVx1MUJFQ1x1MUJFRVx1MUJGMlx1MUJGM1x1MUMyNC1cdTFDMkJcdTFDMzRcdTFDMzVcdTFDRTFcdTFDRjJcdTFDRjNcdTFDRjdcdTMwMkVcdTMwMkZcdUE4MjNcdUE4MjRcdUE4MjdcdUE4ODBcdUE4ODFcdUE4QjQtXHVBOEMzXHVBOTUyXHVBOTUzXHVBOTgzXHVBOUI0XHVBOUI1XHVBOUJBXHVBOUJCXHVBOUJELVx1QTlDMFx1QUEyRlx1QUEzMFx1QUEzM1x1QUEzNFx1QUE0RFx1QUE3Qlx1QUE3RFx1QUFFQlx1QUFFRVx1QUFFRlx1QUFGNVx1QUJFM1x1QUJFNFx1QUJFNlx1QUJFN1x1QUJFOVx1QUJFQVx1QUJFQycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA0W1x1REMwMFx1REMwMlx1REM4Mlx1RENCMC1cdURDQjJcdURDQjdcdURDQjhcdUREMkNcdURENDVcdURENDZcdUREODJcdUREQjMtXHVEREI1XHVEREJGXHVEREMwXHVERTJDLVx1REUyRVx1REUzMlx1REUzM1x1REUzNVx1REVFMC1cdURFRTJcdURGMDJcdURGMDNcdURGM0VcdURGM0ZcdURGNDEtXHVERjQ0XHVERjQ3XHVERjQ4XHVERjRCLVx1REY0RFx1REY1N1x1REY2Mlx1REY2M118XHVEODA1W1x1REMzNS1cdURDMzdcdURDNDBcdURDNDFcdURDNDVcdURDQjAtXHVEQ0IyXHVEQ0I5XHVEQ0JCLVx1RENCRVx1RENDMVx1RERBRi1cdUREQjFcdUREQjgtXHVEREJCXHVEREJFXHVERTMwLVx1REUzMlx1REUzQlx1REUzQ1x1REUzRVx1REVBQ1x1REVBRVx1REVBRlx1REVCNlx1REYyMFx1REYyMVx1REYyNl18XHVEODA2W1x1REMyQy1cdURDMkVcdURDMzhcdURFMzlcdURFNTdcdURFNThcdURFOTddfFx1RDgwN1tcdURDMkZcdURDM0VcdURDQTlcdURDQjFcdURDQjRcdUREOEEtXHVERDhFXHVERDkzXHVERDk0XHVERDk2XHVERUY1XHVERUY2XXxcdUQ4MUJbXHVERjUxLVx1REY3RV18XHVEODM0W1x1REQ2NVx1REQ2Nlx1REQ2RC1cdURENzJdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdNZScsDQogICAgICAgICdhbGlhcyc6ICdFbmNsb3NpbmdfTWFyaycsDQogICAgICAgICdibXAnOiAnXHUwNDg4XHUwNDg5XHUxQUJFXHUyMERELVx1MjBFMFx1MjBFMi1cdTIwRTRcdUE2NzAtXHVBNjcyJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdNbicsDQogICAgICAgICdhbGlhcyc6ICdOb25zcGFjaW5nX01hcmsnLA0KICAgICAgICAnYm1wJzogJ1x1MDMwMC1cdTAzNkZcdTA0ODMtXHUwNDg3XHUwNTkxLVx1MDVCRFx1MDVCRlx1MDVDMVx1MDVDMlx1MDVDNFx1MDVDNVx1MDVDN1x1MDYxMC1cdTA2MUFcdTA2NEItXHUwNjVGXHUwNjcwXHUwNkQ2LVx1MDZEQ1x1MDZERi1cdTA2RTRcdTA2RTdcdTA2RThcdTA2RUEtXHUwNkVEXHUwNzExXHUwNzMwLVx1MDc0QVx1MDdBNi1cdTA3QjBcdTA3RUItXHUwN0YzXHUwN0ZEXHUwODE2LVx1MDgxOVx1MDgxQi1cdTA4MjNcdTA4MjUtXHUwODI3XHUwODI5LVx1MDgyRFx1MDg1OS1cdTA4NUJcdTA4RDMtXHUwOEUxXHUwOEUzLVx1MDkwMlx1MDkzQVx1MDkzQ1x1MDk0MS1cdTA5NDhcdTA5NERcdTA5NTEtXHUwOTU3XHUwOTYyXHUwOTYzXHUwOTgxXHUwOUJDXHUwOUMxLVx1MDlDNFx1MDlDRFx1MDlFMlx1MDlFM1x1MDlGRVx1MEEwMVx1MEEwMlx1MEEzQ1x1MEE0MVx1MEE0Mlx1MEE0N1x1MEE0OFx1MEE0Qi1cdTBBNERcdTBBNTFcdTBBNzBcdTBBNzFcdTBBNzVcdTBBODFcdTBBODJcdTBBQkNcdTBBQzEtXHUwQUM1XHUwQUM3XHUwQUM4XHUwQUNEXHUwQUUyXHUwQUUzXHUwQUZBLVx1MEFGRlx1MEIwMVx1MEIzQ1x1MEIzRlx1MEI0MS1cdTBCNDRcdTBCNERcdTBCNTZcdTBCNjJcdTBCNjNcdTBCODJcdTBCQzBcdTBCQ0RcdTBDMDBcdTBDMDRcdTBDM0UtXHUwQzQwXHUwQzQ2LVx1MEM0OFx1MEM0QS1cdTBDNERcdTBDNTVcdTBDNTZcdTBDNjJcdTBDNjNcdTBDODFcdTBDQkNcdTBDQkZcdTBDQzZcdTBDQ0NcdTBDQ0RcdTBDRTJcdTBDRTNcdTBEMDBcdTBEMDFcdTBEM0JcdTBEM0NcdTBENDEtXHUwRDQ0XHUwRDREXHUwRDYyXHUwRDYzXHUwRENBXHUwREQyLVx1MERENFx1MERENlx1MEUzMVx1MEUzNC1cdTBFM0FcdTBFNDctXHUwRTRFXHUwRUIxXHUwRUI0LVx1MEVCOVx1MEVCQlx1MEVCQ1x1MEVDOC1cdTBFQ0RcdTBGMThcdTBGMTlcdTBGMzVcdTBGMzdcdTBGMzlcdTBGNzEtXHUwRjdFXHUwRjgwLVx1MEY4NFx1MEY4Nlx1MEY4N1x1MEY4RC1cdTBGOTdcdTBGOTktXHUwRkJDXHUwRkM2XHUxMDJELVx1MTAzMFx1MTAzMi1cdTEwMzdcdTEwMzlcdTEwM0FcdTEwM0RcdTEwM0VcdTEwNThcdTEwNTlcdTEwNUUtXHUxMDYwXHUxMDcxLVx1MTA3NFx1MTA4Mlx1MTA4NVx1MTA4Nlx1MTA4RFx1MTA5RFx1MTM1RC1cdTEzNUZcdTE3MTItXHUxNzE0XHUxNzMyLVx1MTczNFx1MTc1Mlx1MTc1M1x1MTc3Mlx1MTc3M1x1MTdCNFx1MTdCNVx1MTdCNy1cdTE3QkRcdTE3QzZcdTE3QzktXHUxN0QzXHUxN0REXHUxODBCLVx1MTgwRFx1MTg4NVx1MTg4Nlx1MThBOVx1MTkyMC1cdTE5MjJcdTE5MjdcdTE5MjhcdTE5MzJcdTE5MzktXHUxOTNCXHUxQTE3XHUxQTE4XHUxQTFCXHUxQTU2XHUxQTU4LVx1MUE1RVx1MUE2MFx1MUE2Mlx1MUE2NS1cdTFBNkNcdTFBNzMtXHUxQTdDXHUxQTdGXHUxQUIwLVx1MUFCRFx1MUIwMC1cdTFCMDNcdTFCMzRcdTFCMzYtXHUxQjNBXHUxQjNDXHUxQjQyXHUxQjZCLVx1MUI3M1x1MUI4MFx1MUI4MVx1MUJBMi1cdTFCQTVcdTFCQThcdTFCQTlcdTFCQUItXHUxQkFEXHUxQkU2XHUxQkU4XHUxQkU5XHUxQkVEXHUxQkVGLVx1MUJGMVx1MUMyQy1cdTFDMzNcdTFDMzZcdTFDMzdcdTFDRDAtXHUxQ0QyXHUxQ0Q0LVx1MUNFMFx1MUNFMi1cdTFDRThcdTFDRURcdTFDRjRcdTFDRjhcdTFDRjlcdTFEQzAtXHUxREY5XHUxREZCLVx1MURGRlx1MjBEMC1cdTIwRENcdTIwRTFcdTIwRTUtXHUyMEYwXHUyQ0VGLVx1MkNGMVx1MkQ3Rlx1MkRFMC1cdTJERkZcdTMwMkEtXHUzMDJEXHUzMDk5XHUzMDlBXHVBNjZGXHVBNjc0LVx1QTY3RFx1QTY5RVx1QTY5Rlx1QTZGMFx1QTZGMVx1QTgwMlx1QTgwNlx1QTgwQlx1QTgyNVx1QTgyNlx1QThDNFx1QThDNVx1QThFMC1cdUE4RjFcdUE4RkZcdUE5MjYtXHVBOTJEXHVBOTQ3LVx1QTk1MVx1QTk4MC1cdUE5ODJcdUE5QjNcdUE5QjYtXHVBOUI5XHVBOUJDXHVBOUU1XHVBQTI5LVx1QUEyRVx1QUEzMVx1QUEzMlx1QUEzNVx1QUEzNlx1QUE0M1x1QUE0Q1x1QUE3Q1x1QUFCMFx1QUFCMi1cdUFBQjRcdUFBQjdcdUFBQjhcdUFBQkVcdUFBQkZcdUFBQzFcdUFBRUNcdUFBRURcdUFBRjZcdUFCRTVcdUFCRThcdUFCRURcdUZCMUVcdUZFMDAtXHVGRTBGXHVGRTIwLVx1RkUyRicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAwW1x1RERGRFx1REVFMFx1REY3Ni1cdURGN0FdfFx1RDgwMltcdURFMDEtXHVERTAzXHVERTA1XHVERTA2XHVERTBDLVx1REUwRlx1REUzOC1cdURFM0FcdURFM0ZcdURFRTVcdURFRTZdfFx1RDgwM1tcdUREMjQtXHVERDI3XHVERjQ2LVx1REY1MF18XHVEODA0W1x1REMwMVx1REMzOC1cdURDNDZcdURDN0YtXHVEQzgxXHVEQ0IzLVx1RENCNlx1RENCOVx1RENCQVx1REQwMC1cdUREMDJcdUREMjctXHVERDJCXHVERDJELVx1REQzNFx1REQ3M1x1REQ4MFx1REQ4MVx1RERCNi1cdUREQkVcdUREQzktXHVERENDXHVERTJGLVx1REUzMVx1REUzNFx1REUzNlx1REUzN1x1REUzRVx1REVERlx1REVFMy1cdURFRUFcdURGMDBcdURGMDFcdURGM0JcdURGM0NcdURGNDBcdURGNjYtXHVERjZDXHVERjcwLVx1REY3NF18XHVEODA1W1x1REMzOC1cdURDM0ZcdURDNDItXHVEQzQ0XHVEQzQ2XHVEQzVFXHVEQ0IzLVx1RENCOFx1RENCQVx1RENCRlx1RENDMFx1RENDMlx1RENDM1x1RERCMi1cdUREQjVcdUREQkNcdUREQkRcdUREQkZcdUREQzBcdURERENcdURERERcdURFMzMtXHVERTNBXHVERTNEXHVERTNGXHVERTQwXHVERUFCXHVERUFEXHVERUIwLVx1REVCNVx1REVCN1x1REYxRC1cdURGMUZcdURGMjItXHVERjI1XHVERjI3LVx1REYyQl18XHVEODA2W1x1REMyRi1cdURDMzdcdURDMzlcdURDM0FcdURFMDEtXHVERTBBXHVERTMzLVx1REUzOFx1REUzQi1cdURFM0VcdURFNDdcdURFNTEtXHVERTU2XHVERTU5LVx1REU1Qlx1REU4QS1cdURFOTZcdURFOThcdURFOTldfFx1RDgwN1tcdURDMzAtXHVEQzM2XHVEQzM4LVx1REMzRFx1REMzRlx1REM5Mi1cdURDQTdcdURDQUEtXHVEQ0IwXHVEQ0IyXHVEQ0IzXHVEQ0I1XHVEQ0I2XHVERDMxLVx1REQzNlx1REQzQVx1REQzQ1x1REQzRFx1REQzRi1cdURENDVcdURENDdcdUREOTBcdUREOTFcdUREOTVcdUREOTdcdURFRjNcdURFRjRdfFx1RDgxQVtcdURFRjAtXHVERUY0XHVERjMwLVx1REYzNl18XHVEODFCW1x1REY4Ri1cdURGOTJdfFx1RDgyRltcdURDOURcdURDOUVdfFx1RDgzNFtcdURENjctXHVERDY5XHVERDdCLVx1REQ4Mlx1REQ4NS1cdUREOEJcdUREQUEtXHVEREFEXHVERTQyLVx1REU0NF18XHVEODM2W1x1REUwMC1cdURFMzZcdURFM0ItXHVERTZDXHVERTc1XHVERTg0XHVERTlCLVx1REU5Rlx1REVBMS1cdURFQUZdfFx1RDgzOFtcdURDMDAtXHVEQzA2XHVEQzA4LVx1REMxOFx1REMxQi1cdURDMjFcdURDMjNcdURDMjRcdURDMjYtXHVEQzJBXXxcdUQ4M0FbXHVEQ0QwLVx1RENENlx1REQ0NC1cdURENEFdfFx1REI0MFtcdUREMDAtXHVEREVGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTicsDQogICAgICAgICdhbGlhcyc6ICdOdW1iZXInLA0KICAgICAgICAnYm1wJzogJzAtOVx4QjJceEIzXHhCOVx4QkMtXHhCRVx1MDY2MC1cdTA2NjlcdTA2RjAtXHUwNkY5XHUwN0MwLVx1MDdDOVx1MDk2Ni1cdTA5NkZcdTA5RTYtXHUwOUVGXHUwOUY0LVx1MDlGOVx1MEE2Ni1cdTBBNkZcdTBBRTYtXHUwQUVGXHUwQjY2LVx1MEI2Rlx1MEI3Mi1cdTBCNzdcdTBCRTYtXHUwQkYyXHUwQzY2LVx1MEM2Rlx1MEM3OC1cdTBDN0VcdTBDRTYtXHUwQ0VGXHUwRDU4LVx1MEQ1RVx1MEQ2Ni1cdTBENzhcdTBERTYtXHUwREVGXHUwRTUwLVx1MEU1OVx1MEVEMC1cdTBFRDlcdTBGMjAtXHUwRjMzXHUxMDQwLVx1MTA0OVx1MTA5MC1cdTEwOTlcdTEzNjktXHUxMzdDXHUxNkVFLVx1MTZGMFx1MTdFMC1cdTE3RTlcdTE3RjAtXHUxN0Y5XHUxODEwLVx1MTgxOVx1MTk0Ni1cdTE5NEZcdTE5RDAtXHUxOURBXHUxQTgwLVx1MUE4OVx1MUE5MC1cdTFBOTlcdTFCNTAtXHUxQjU5XHUxQkIwLVx1MUJCOVx1MUM0MC1cdTFDNDlcdTFDNTAtXHUxQzU5XHUyMDcwXHUyMDc0LVx1MjA3OVx1MjA4MC1cdTIwODlcdTIxNTAtXHUyMTgyXHUyMTg1LVx1MjE4OVx1MjQ2MC1cdTI0OUJcdTI0RUEtXHUyNEZGXHUyNzc2LVx1Mjc5M1x1MkNGRFx1MzAwN1x1MzAyMS1cdTMwMjlcdTMwMzgtXHUzMDNBXHUzMTkyLVx1MzE5NVx1MzIyMC1cdTMyMjlcdTMyNDgtXHUzMjRGXHUzMjUxLVx1MzI1Rlx1MzI4MC1cdTMyODlcdTMyQjEtXHUzMkJGXHVBNjIwLVx1QTYyOVx1QTZFNi1cdUE2RUZcdUE4MzAtXHVBODM1XHVBOEQwLVx1QThEOVx1QTkwMC1cdUE5MDlcdUE5RDAtXHVBOUQ5XHVBOUYwLVx1QTlGOVx1QUE1MC1cdUFBNTlcdUFCRjAtXHVBQkY5XHVGRjEwLVx1RkYxOScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAwW1x1REQwNy1cdUREMzNcdURENDAtXHVERDc4XHVERDhBXHVERDhCXHVERUUxLVx1REVGQlx1REYyMC1cdURGMjNcdURGNDFcdURGNEFcdURGRDEtXHVERkQ1XXxcdUQ4MDFbXHVEQ0EwLVx1RENBOV18XHVEODAyW1x1REM1OC1cdURDNUZcdURDNzktXHVEQzdGXHVEQ0E3LVx1RENBRlx1RENGQi1cdURDRkZcdUREMTYtXHVERDFCXHVEREJDXHVEREJEXHVEREMwLVx1RERDRlx1REREMi1cdURERkZcdURFNDAtXHVERTQ4XHVERTdEXHVERTdFXHVERTlELVx1REU5Rlx1REVFQi1cdURFRUZcdURGNTgtXHVERjVGXHVERjc4LVx1REY3Rlx1REZBOS1cdURGQUZdfFx1RDgwM1tcdURDRkEtXHVEQ0ZGXHVERDMwLVx1REQzOVx1REU2MC1cdURFN0VcdURGMUQtXHVERjI2XHVERjUxLVx1REY1NF18XHVEODA0W1x1REM1Mi1cdURDNkZcdURDRjAtXHVEQ0Y5XHVERDM2LVx1REQzRlx1REREMC1cdURERDlcdURERTEtXHVEREY0XHVERUYwLVx1REVGOV18XHVEODA1W1x1REM1MC1cdURDNTlcdURDRDAtXHVEQ0Q5XHVERTUwLVx1REU1OVx1REVDMC1cdURFQzlcdURGMzAtXHVERjNCXXxcdUQ4MDZbXHVEQ0UwLVx1RENGMl18XHVEODA3W1x1REM1MC1cdURDNkNcdURENTAtXHVERDU5XHVEREEwLVx1RERBOV18XHVEODA5W1x1REMwMC1cdURDNkVdfFx1RDgxQVtcdURFNjAtXHVERTY5XHVERjUwLVx1REY1OVx1REY1Qi1cdURGNjFdfFx1RDgxQltcdURFODAtXHVERTk2XXxcdUQ4MzRbXHVERUUwLVx1REVGM1x1REY2MC1cdURGNzhdfFx1RDgzNVtcdURGQ0UtXHVERkZGXXxcdUQ4M0FbXHVEQ0M3LVx1RENDRlx1REQ1MC1cdURENTldfFx1RDgzQltcdURDNzEtXHVEQ0FCXHVEQ0FELVx1RENBRlx1RENCMS1cdURDQjRdfFx1RDgzQ1tcdUREMDAtXHVERDBDXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTmQnLA0KICAgICAgICAnYWxpYXMnOiAnRGVjaW1hbF9OdW1iZXInLA0KICAgICAgICAnYm1wJzogJzAtOVx1MDY2MC1cdTA2NjlcdTA2RjAtXHUwNkY5XHUwN0MwLVx1MDdDOVx1MDk2Ni1cdTA5NkZcdTA5RTYtXHUwOUVGXHUwQTY2LVx1MEE2Rlx1MEFFNi1cdTBBRUZcdTBCNjYtXHUwQjZGXHUwQkU2LVx1MEJFRlx1MEM2Ni1cdTBDNkZcdTBDRTYtXHUwQ0VGXHUwRDY2LVx1MEQ2Rlx1MERFNi1cdTBERUZcdTBFNTAtXHUwRTU5XHUwRUQwLVx1MEVEOVx1MEYyMC1cdTBGMjlcdTEwNDAtXHUxMDQ5XHUxMDkwLVx1MTA5OVx1MTdFMC1cdTE3RTlcdTE4MTAtXHUxODE5XHUxOTQ2LVx1MTk0Rlx1MTlEMC1cdTE5RDlcdTFBODAtXHUxQTg5XHUxQTkwLVx1MUE5OVx1MUI1MC1cdTFCNTlcdTFCQjAtXHUxQkI5XHUxQzQwLVx1MUM0OVx1MUM1MC1cdTFDNTlcdUE2MjAtXHVBNjI5XHVBOEQwLVx1QThEOVx1QTkwMC1cdUE5MDlcdUE5RDAtXHVBOUQ5XHVBOUYwLVx1QTlGOVx1QUE1MC1cdUFBNTlcdUFCRjAtXHVBQkY5XHVGRjEwLVx1RkYxOScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAxW1x1RENBMC1cdURDQTldfFx1RDgwM1tcdUREMzAtXHVERDM5XXxcdUQ4MDRbXHVEQzY2LVx1REM2Rlx1RENGMC1cdURDRjlcdUREMzYtXHVERDNGXHVEREQwLVx1REREOVx1REVGMC1cdURFRjldfFx1RDgwNVtcdURDNTAtXHVEQzU5XHVEQ0QwLVx1RENEOVx1REU1MC1cdURFNTlcdURFQzAtXHVERUM5XHVERjMwLVx1REYzOV18XHVEODA2W1x1RENFMC1cdURDRTldfFx1RDgwN1tcdURDNTAtXHVEQzU5XHVERDUwLVx1REQ1OVx1RERBMC1cdUREQTldfFx1RDgxQVtcdURFNjAtXHVERTY5XHVERjUwLVx1REY1OV18XHVEODM1W1x1REZDRS1cdURGRkZdfFx1RDgzQVtcdURENTAtXHVERDU5XScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTmwnLA0KICAgICAgICAnYWxpYXMnOiAnTGV0dGVyX051bWJlcicsDQogICAgICAgICdibXAnOiAnXHUxNkVFLVx1MTZGMFx1MjE2MC1cdTIxODJcdTIxODUtXHUyMTg4XHUzMDA3XHUzMDIxLVx1MzAyOVx1MzAzOC1cdTMwM0FcdUE2RTYtXHVBNkVGJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERDQwLVx1REQ3NFx1REY0MVx1REY0QVx1REZEMS1cdURGRDVdfFx1RDgwOVtcdURDMDAtXHVEQzZFXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTm8nLA0KICAgICAgICAnYWxpYXMnOiAnT3RoZXJfTnVtYmVyJywNCiAgICAgICAgJ2JtcCc6ICdceEIyXHhCM1x4QjlceEJDLVx4QkVcdTA5RjQtXHUwOUY5XHUwQjcyLVx1MEI3N1x1MEJGMC1cdTBCRjJcdTBDNzgtXHUwQzdFXHUwRDU4LVx1MEQ1RVx1MEQ3MC1cdTBENzhcdTBGMkEtXHUwRjMzXHUxMzY5LVx1MTM3Q1x1MTdGMC1cdTE3RjlcdTE5REFcdTIwNzBcdTIwNzQtXHUyMDc5XHUyMDgwLVx1MjA4OVx1MjE1MC1cdTIxNUZcdTIxODlcdTI0NjAtXHUyNDlCXHUyNEVBLVx1MjRGRlx1Mjc3Ni1cdTI3OTNcdTJDRkRcdTMxOTItXHUzMTk1XHUzMjIwLVx1MzIyOVx1MzI0OC1cdTMyNEZcdTMyNTEtXHUzMjVGXHUzMjgwLVx1MzI4OVx1MzJCMS1cdTMyQkZcdUE4MzAtXHVBODM1JywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERDA3LVx1REQzM1x1REQ3NS1cdURENzhcdUREOEFcdUREOEJcdURFRTEtXHVERUZCXHVERjIwLVx1REYyM118XHVEODAyW1x1REM1OC1cdURDNUZcdURDNzktXHVEQzdGXHVEQ0E3LVx1RENBRlx1RENGQi1cdURDRkZcdUREMTYtXHVERDFCXHVEREJDXHVEREJEXHVEREMwLVx1RERDRlx1REREMi1cdURERkZcdURFNDAtXHVERTQ4XHVERTdEXHVERTdFXHVERTlELVx1REU5Rlx1REVFQi1cdURFRUZcdURGNTgtXHVERjVGXHVERjc4LVx1REY3Rlx1REZBOS1cdURGQUZdfFx1RDgwM1tcdURDRkEtXHVEQ0ZGXHVERTYwLVx1REU3RVx1REYxRC1cdURGMjZcdURGNTEtXHVERjU0XXxcdUQ4MDRbXHVEQzUyLVx1REM2NVx1RERFMS1cdURERjRdfFx1RDgwNVtcdURGM0FcdURGM0JdfFx1RDgwNltcdURDRUEtXHVEQ0YyXXxcdUQ4MDdbXHVEQzVBLVx1REM2Q118XHVEODFBW1x1REY1Qi1cdURGNjFdfFx1RDgxQltcdURFODAtXHVERTk2XXxcdUQ4MzRbXHVERUUwLVx1REVGM1x1REY2MC1cdURGNzhdfFx1RDgzQVtcdURDQzctXHVEQ0NGXXxcdUQ4M0JbXHVEQzcxLVx1RENBQlx1RENBRC1cdURDQUZcdURDQjEtXHVEQ0I0XXxcdUQ4M0NbXHVERDAwLVx1REQwQ10nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1AnLA0KICAgICAgICAnYWxpYXMnOiAnUHVuY3R1YXRpb24nLA0KICAgICAgICAnYm1wJzogJyEtIyUtXFwqLC1cXC86O1xcP0BcXFstXFxdX1xce1xcfVx4QTFceEE3XHhBQlx4QjZceEI3XHhCQlx4QkZcdTAzN0VcdTAzODdcdTA1NUEtXHUwNTVGXHUwNTg5XHUwNThBXHUwNUJFXHUwNUMwXHUwNUMzXHUwNUM2XHUwNUYzXHUwNUY0XHUwNjA5XHUwNjBBXHUwNjBDXHUwNjBEXHUwNjFCXHUwNjFFXHUwNjFGXHUwNjZBLVx1MDY2RFx1MDZENFx1MDcwMC1cdTA3MERcdTA3RjctXHUwN0Y5XHUwODMwLVx1MDgzRVx1MDg1RVx1MDk2NFx1MDk2NVx1MDk3MFx1MDlGRFx1MEE3Nlx1MEFGMFx1MEM4NFx1MERGNFx1MEU0Rlx1MEU1QVx1MEU1Qlx1MEYwNC1cdTBGMTJcdTBGMTRcdTBGM0EtXHUwRjNEXHUwRjg1XHUwRkQwLVx1MEZENFx1MEZEOVx1MEZEQVx1MTA0QS1cdTEwNEZcdTEwRkJcdTEzNjAtXHUxMzY4XHUxNDAwXHUxNjZEXHUxNjZFXHUxNjlCXHUxNjlDXHUxNkVCLVx1MTZFRFx1MTczNVx1MTczNlx1MTdENC1cdTE3RDZcdTE3RDgtXHUxN0RBXHUxODAwLVx1MTgwQVx1MTk0NFx1MTk0NVx1MUExRVx1MUExRlx1MUFBMC1cdTFBQTZcdTFBQTgtXHUxQUFEXHUxQjVBLVx1MUI2MFx1MUJGQy1cdTFCRkZcdTFDM0ItXHUxQzNGXHUxQzdFXHUxQzdGXHUxQ0MwLVx1MUNDN1x1MUNEM1x1MjAxMC1cdTIwMjdcdTIwMzAtXHUyMDQzXHUyMDQ1LVx1MjA1MVx1MjA1My1cdTIwNUVcdTIwN0RcdTIwN0VcdTIwOERcdTIwOEVcdTIzMDgtXHUyMzBCXHUyMzI5XHUyMzJBXHUyNzY4LVx1Mjc3NVx1MjdDNVx1MjdDNlx1MjdFNi1cdTI3RUZcdTI5ODMtXHUyOTk4XHUyOUQ4LVx1MjlEQlx1MjlGQ1x1MjlGRFx1MkNGOS1cdTJDRkNcdTJDRkVcdTJDRkZcdTJENzBcdTJFMDAtXHUyRTJFXHUyRTMwLVx1MkU0RVx1MzAwMS1cdTMwMDNcdTMwMDgtXHUzMDExXHUzMDE0LVx1MzAxRlx1MzAzMFx1MzAzRFx1MzBBMFx1MzBGQlx1QTRGRVx1QTRGRlx1QTYwRC1cdUE2MEZcdUE2NzNcdUE2N0VcdUE2RjItXHVBNkY3XHVBODc0LVx1QTg3N1x1QThDRVx1QThDRlx1QThGOC1cdUE4RkFcdUE4RkNcdUE5MkVcdUE5MkZcdUE5NUZcdUE5QzEtXHVBOUNEXHVBOURFXHVBOURGXHVBQTVDLVx1QUE1Rlx1QUFERVx1QUFERlx1QUFGMFx1QUFGMVx1QUJFQlx1RkQzRVx1RkQzRlx1RkUxMC1cdUZFMTlcdUZFMzAtXHVGRTUyXHVGRTU0LVx1RkU2MVx1RkU2M1x1RkU2OFx1RkU2QVx1RkU2Qlx1RkYwMS1cdUZGMDNcdUZGMDUtXHVGRjBBXHVGRjBDLVx1RkYwRlx1RkYxQVx1RkYxQlx1RkYxRlx1RkYyMFx1RkYzQi1cdUZGM0RcdUZGM0ZcdUZGNUJcdUZGNURcdUZGNUYtXHVGRjY1JywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERDAwLVx1REQwMlx1REY5Rlx1REZEMF18XHVEODAxXHVERDZGfFx1RDgwMltcdURDNTdcdUREMUZcdUREM0ZcdURFNTAtXHVERTU4XHVERTdGXHVERUYwLVx1REVGNlx1REYzOS1cdURGM0ZcdURGOTktXHVERjlDXXxcdUQ4MDNbXHVERjU1LVx1REY1OV18XHVEODA0W1x1REM0Ny1cdURDNERcdURDQkJcdURDQkNcdURDQkUtXHVEQ0MxXHVERDQwLVx1REQ0M1x1REQ3NFx1REQ3NVx1RERDNS1cdUREQzhcdUREQ0RcdUREREJcdUREREQtXHVERERGXHVERTM4LVx1REUzRFx1REVBOV18XHVEODA1W1x1REM0Qi1cdURDNEZcdURDNUJcdURDNURcdURDQzZcdUREQzEtXHVEREQ3XHVERTQxLVx1REU0M1x1REU2MC1cdURFNkNcdURGM0MtXHVERjNFXXxcdUQ4MDZbXHVEQzNCXHVERTNGLVx1REU0Nlx1REU5QS1cdURFOUNcdURFOUUtXHVERUEyXXxcdUQ4MDdbXHVEQzQxLVx1REM0NVx1REM3MFx1REM3MVx1REVGN1x1REVGOF18XHVEODA5W1x1REM3MC1cdURDNzRdfFx1RDgxQVtcdURFNkVcdURFNkZcdURFRjVcdURGMzctXHVERjNCXHVERjQ0XXxcdUQ4MUJbXHVERTk3LVx1REU5QV18XHVEODJGXHVEQzlGfFx1RDgzNltcdURFODctXHVERThCXXxcdUQ4M0FbXHVERDVFXHVERDVGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnUGMnLA0KICAgICAgICAnYWxpYXMnOiAnQ29ubmVjdG9yX1B1bmN0dWF0aW9uJywNCiAgICAgICAgJ2JtcCc6ICdfXHUyMDNGXHUyMDQwXHUyMDU0XHVGRTMzXHVGRTM0XHVGRTRELVx1RkU0Rlx1RkYzRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnUGQnLA0KICAgICAgICAnYWxpYXMnOiAnRGFzaF9QdW5jdHVhdGlvbicsDQogICAgICAgICdibXAnOiAnXFwtXHUwNThBXHUwNUJFXHUxNDAwXHUxODA2XHUyMDEwLVx1MjAxNVx1MkUxN1x1MkUxQVx1MkUzQVx1MkUzQlx1MkU0MFx1MzAxQ1x1MzAzMFx1MzBBMFx1RkUzMVx1RkUzMlx1RkU1OFx1RkU2M1x1RkYwRCcNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnUGUnLA0KICAgICAgICAnYWxpYXMnOiAnQ2xvc2VfUHVuY3R1YXRpb24nLA0KICAgICAgICAnYm1wJzogJ1xcKVxcXVxcfVx1MEYzQlx1MEYzRFx1MTY5Q1x1MjA0Nlx1MjA3RVx1MjA4RVx1MjMwOVx1MjMwQlx1MjMyQVx1Mjc2OVx1Mjc2Qlx1Mjc2RFx1Mjc2Rlx1Mjc3MVx1Mjc3M1x1Mjc3NVx1MjdDNlx1MjdFN1x1MjdFOVx1MjdFQlx1MjdFRFx1MjdFRlx1Mjk4NFx1Mjk4Nlx1Mjk4OFx1Mjk4QVx1Mjk4Q1x1Mjk4RVx1Mjk5MFx1Mjk5Mlx1Mjk5NFx1Mjk5Nlx1Mjk5OFx1MjlEOVx1MjlEQlx1MjlGRFx1MkUyM1x1MkUyNVx1MkUyN1x1MkUyOVx1MzAwOVx1MzAwQlx1MzAwRFx1MzAwRlx1MzAxMVx1MzAxNVx1MzAxN1x1MzAxOVx1MzAxQlx1MzAxRVx1MzAxRlx1RkQzRVx1RkUxOFx1RkUzNlx1RkUzOFx1RkUzQVx1RkUzQ1x1RkUzRVx1RkU0MFx1RkU0Mlx1RkU0NFx1RkU0OFx1RkU1QVx1RkU1Q1x1RkU1RVx1RkYwOVx1RkYzRFx1RkY1RFx1RkY2MFx1RkY2MycNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnUGYnLA0KICAgICAgICAnYWxpYXMnOiAnRmluYWxfUHVuY3R1YXRpb24nLA0KICAgICAgICAnYm1wJzogJ1x4QkJcdTIwMTlcdTIwMURcdTIwM0FcdTJFMDNcdTJFMDVcdTJFMEFcdTJFMERcdTJFMURcdTJFMjEnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1BpJywNCiAgICAgICAgJ2FsaWFzJzogJ0luaXRpYWxfUHVuY3R1YXRpb24nLA0KICAgICAgICAnYm1wJzogJ1x4QUJcdTIwMThcdTIwMUJcdTIwMUNcdTIwMUZcdTIwMzlcdTJFMDJcdTJFMDRcdTJFMDlcdTJFMENcdTJFMUNcdTJFMjAnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1BvJywNCiAgICAgICAgJ2FsaWFzJzogJ090aGVyX1B1bmN0dWF0aW9uJywNCiAgICAgICAgJ2JtcCc6ICchLSMlLVwnXFwqLFxcLlxcLzo7XFw/QFxcXHhBMVx4QTdceEI2XHhCN1x4QkZcdTAzN0VcdTAzODdcdTA1NUEtXHUwNTVGXHUwNTg5XHUwNUMwXHUwNUMzXHUwNUM2XHUwNUYzXHUwNUY0XHUwNjA5XHUwNjBBXHUwNjBDXHUwNjBEXHUwNjFCXHUwNjFFXHUwNjFGXHUwNjZBLVx1MDY2RFx1MDZENFx1MDcwMC1cdTA3MERcdTA3RjctXHUwN0Y5XHUwODMwLVx1MDgzRVx1MDg1RVx1MDk2NFx1MDk2NVx1MDk3MFx1MDlGRFx1MEE3Nlx1MEFGMFx1MEM4NFx1MERGNFx1MEU0Rlx1MEU1QVx1MEU1Qlx1MEYwNC1cdTBGMTJcdTBGMTRcdTBGODVcdTBGRDAtXHUwRkQ0XHUwRkQ5XHUwRkRBXHUxMDRBLVx1MTA0Rlx1MTBGQlx1MTM2MC1cdTEzNjhcdTE2NkRcdTE2NkVcdTE2RUItXHUxNkVEXHUxNzM1XHUxNzM2XHUxN0Q0LVx1MTdENlx1MTdEOC1cdTE3REFcdTE4MDAtXHUxODA1XHUxODA3LVx1MTgwQVx1MTk0NFx1MTk0NVx1MUExRVx1MUExRlx1MUFBMC1cdTFBQTZcdTFBQTgtXHUxQUFEXHUxQjVBLVx1MUI2MFx1MUJGQy1cdTFCRkZcdTFDM0ItXHUxQzNGXHUxQzdFXHUxQzdGXHUxQ0MwLVx1MUNDN1x1MUNEM1x1MjAxNlx1MjAxN1x1MjAyMC1cdTIwMjdcdTIwMzAtXHUyMDM4XHUyMDNCLVx1MjAzRVx1MjA0MS1cdTIwNDNcdTIwNDctXHUyMDUxXHUyMDUzXHUyMDU1LVx1MjA1RVx1MkNGOS1cdTJDRkNcdTJDRkVcdTJDRkZcdTJENzBcdTJFMDBcdTJFMDFcdTJFMDYtXHUyRTA4XHUyRTBCXHUyRTBFLVx1MkUxNlx1MkUxOFx1MkUxOVx1MkUxQlx1MkUxRVx1MkUxRlx1MkUyQS1cdTJFMkVcdTJFMzAtXHUyRTM5XHUyRTNDLVx1MkUzRlx1MkU0MVx1MkU0My1cdTJFNEVcdTMwMDEtXHUzMDAzXHUzMDNEXHUzMEZCXHVBNEZFXHVBNEZGXHVBNjBELVx1QTYwRlx1QTY3M1x1QTY3RVx1QTZGMi1cdUE2RjdcdUE4NzQtXHVBODc3XHVBOENFXHVBOENGXHVBOEY4LVx1QThGQVx1QThGQ1x1QTkyRVx1QTkyRlx1QTk1Rlx1QTlDMS1cdUE5Q0RcdUE5REVcdUE5REZcdUFBNUMtXHVBQTVGXHVBQURFXHVBQURGXHVBQUYwXHVBQUYxXHVBQkVCXHVGRTEwLVx1RkUxNlx1RkUxOVx1RkUzMFx1RkU0NVx1RkU0Nlx1RkU0OS1cdUZFNENcdUZFNTAtXHVGRTUyXHVGRTU0LVx1RkU1N1x1RkU1Ri1cdUZFNjFcdUZFNjhcdUZFNkFcdUZFNkJcdUZGMDEtXHVGRjAzXHVGRjA1LVx1RkYwN1x1RkYwQVx1RkYwQ1x1RkYwRVx1RkYwRlx1RkYxQVx1RkYxQlx1RkYxRlx1RkYyMFx1RkYzQ1x1RkY2MVx1RkY2NFx1RkY2NScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAwW1x1REQwMC1cdUREMDJcdURGOUZcdURGRDBdfFx1RDgwMVx1REQ2RnxcdUQ4MDJbXHVEQzU3XHVERDFGXHVERDNGXHVERTUwLVx1REU1OFx1REU3Rlx1REVGMC1cdURFRjZcdURGMzktXHVERjNGXHVERjk5LVx1REY5Q118XHVEODAzW1x1REY1NS1cdURGNTldfFx1RDgwNFtcdURDNDctXHVEQzREXHVEQ0JCXHVEQ0JDXHVEQ0JFLVx1RENDMVx1REQ0MC1cdURENDNcdURENzRcdURENzVcdUREQzUtXHVEREM4XHVERENEXHVERERCXHVERERELVx1RERERlx1REUzOC1cdURFM0RcdURFQTldfFx1RDgwNVtcdURDNEItXHVEQzRGXHVEQzVCXHVEQzVEXHVEQ0M2XHVEREMxLVx1REREN1x1REU0MS1cdURFNDNcdURFNjAtXHVERTZDXHVERjNDLVx1REYzRV18XHVEODA2W1x1REMzQlx1REUzRi1cdURFNDZcdURFOUEtXHVERTlDXHVERTlFLVx1REVBMl18XHVEODA3W1x1REM0MS1cdURDNDVcdURDNzBcdURDNzFcdURFRjdcdURFRjhdfFx1RDgwOVtcdURDNzAtXHVEQzc0XXxcdUQ4MUFbXHVERTZFXHVERTZGXHVERUY1XHVERjM3LVx1REYzQlx1REY0NF18XHVEODFCW1x1REU5Ny1cdURFOUFdfFx1RDgyRlx1REM5RnxcdUQ4MzZbXHVERTg3LVx1REU4Ql18XHVEODNBW1x1REQ1RVx1REQ1Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1BzJywNCiAgICAgICAgJ2FsaWFzJzogJ09wZW5fUHVuY3R1YXRpb24nLA0KICAgICAgICAnYm1wJzogJ1xcKFxcW1xce1x1MEYzQVx1MEYzQ1x1MTY5Qlx1MjAxQVx1MjAxRVx1MjA0NVx1MjA3RFx1MjA4RFx1MjMwOFx1MjMwQVx1MjMyOVx1Mjc2OFx1Mjc2QVx1Mjc2Q1x1Mjc2RVx1Mjc3MFx1Mjc3Mlx1Mjc3NFx1MjdDNVx1MjdFNlx1MjdFOFx1MjdFQVx1MjdFQ1x1MjdFRVx1Mjk4M1x1Mjk4NVx1Mjk4N1x1Mjk4OVx1Mjk4Qlx1Mjk4RFx1Mjk4Rlx1Mjk5MVx1Mjk5M1x1Mjk5NVx1Mjk5N1x1MjlEOFx1MjlEQVx1MjlGQ1x1MkUyMlx1MkUyNFx1MkUyNlx1MkUyOFx1MkU0Mlx1MzAwOFx1MzAwQVx1MzAwQ1x1MzAwRVx1MzAxMFx1MzAxNFx1MzAxNlx1MzAxOFx1MzAxQVx1MzAxRFx1RkQzRlx1RkUxN1x1RkUzNVx1RkUzN1x1RkUzOVx1RkUzQlx1RkUzRFx1RkUzRlx1RkU0MVx1RkU0M1x1RkU0N1x1RkU1OVx1RkU1Qlx1RkU1RFx1RkYwOFx1RkYzQlx1RkY1Qlx1RkY1Rlx1RkY2MicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnUycsDQogICAgICAgICdhbGlhcyc6ICdTeW1ib2wnLA0KICAgICAgICAnYm1wJzogJ1xcJFxcKzwtPlxcXmBcXHx+XHhBMi1ceEE2XHhBOFx4QTlceEFDXHhBRS1ceEIxXHhCNFx4QjhceEQ3XHhGN1x1MDJDMi1cdTAyQzVcdTAyRDItXHUwMkRGXHUwMkU1LVx1MDJFQlx1MDJFRFx1MDJFRi1cdTAyRkZcdTAzNzVcdTAzODRcdTAzODVcdTAzRjZcdTA0ODJcdTA1OEQtXHUwNThGXHUwNjA2LVx1MDYwOFx1MDYwQlx1MDYwRVx1MDYwRlx1MDZERVx1MDZFOVx1MDZGRFx1MDZGRVx1MDdGNlx1MDdGRVx1MDdGRlx1MDlGMlx1MDlGM1x1MDlGQVx1MDlGQlx1MEFGMVx1MEI3MFx1MEJGMy1cdTBCRkFcdTBDN0ZcdTBENEZcdTBENzlcdTBFM0ZcdTBGMDEtXHUwRjAzXHUwRjEzXHUwRjE1LVx1MEYxN1x1MEYxQS1cdTBGMUZcdTBGMzRcdTBGMzZcdTBGMzhcdTBGQkUtXHUwRkM1XHUwRkM3LVx1MEZDQ1x1MEZDRVx1MEZDRlx1MEZENS1cdTBGRDhcdTEwOUVcdTEwOUZcdTEzOTAtXHUxMzk5XHUxN0RCXHUxOTQwXHUxOURFLVx1MTlGRlx1MUI2MS1cdTFCNkFcdTFCNzQtXHUxQjdDXHUxRkJEXHUxRkJGLVx1MUZDMVx1MUZDRC1cdTFGQ0ZcdTFGREQtXHUxRkRGXHUxRkVELVx1MUZFRlx1MUZGRFx1MUZGRVx1MjA0NFx1MjA1Mlx1MjA3QS1cdTIwN0NcdTIwOEEtXHUyMDhDXHUyMEEwLVx1MjBCRlx1MjEwMFx1MjEwMVx1MjEwMy1cdTIxMDZcdTIxMDhcdTIxMDlcdTIxMTRcdTIxMTYtXHUyMTE4XHUyMTFFLVx1MjEyM1x1MjEyNVx1MjEyN1x1MjEyOVx1MjEyRVx1MjEzQVx1MjEzQlx1MjE0MC1cdTIxNDRcdTIxNEEtXHUyMTREXHUyMTRGXHUyMThBXHUyMThCXHUyMTkwLVx1MjMwN1x1MjMwQy1cdTIzMjhcdTIzMkItXHUyNDI2XHUyNDQwLVx1MjQ0QVx1MjQ5Qy1cdTI0RTlcdTI1MDAtXHUyNzY3XHUyNzk0LVx1MjdDNFx1MjdDNy1cdTI3RTVcdTI3RjAtXHUyOTgyXHUyOTk5LVx1MjlEN1x1MjlEQy1cdTI5RkJcdTI5RkUtXHUyQjczXHUyQjc2LVx1MkI5NVx1MkI5OC1cdTJCQzhcdTJCQ0EtXHUyQkZFXHUyQ0U1LVx1MkNFQVx1MkU4MC1cdTJFOTlcdTJFOUItXHUyRUYzXHUyRjAwLVx1MkZENVx1MkZGMC1cdTJGRkJcdTMwMDRcdTMwMTJcdTMwMTNcdTMwMjBcdTMwMzZcdTMwMzdcdTMwM0VcdTMwM0ZcdTMwOUJcdTMwOUNcdTMxOTBcdTMxOTFcdTMxOTYtXHUzMTlGXHUzMUMwLVx1MzFFM1x1MzIwMC1cdTMyMUVcdTMyMkEtXHUzMjQ3XHUzMjUwXHUzMjYwLVx1MzI3Rlx1MzI4QS1cdTMyQjBcdTMyQzAtXHUzMkZFXHUzMzAwLVx1MzNGRlx1NERDMC1cdTRERkZcdUE0OTAtXHVBNEM2XHVBNzAwLVx1QTcxNlx1QTcyMFx1QTcyMVx1QTc4OVx1QTc4QVx1QTgyOC1cdUE4MkJcdUE4MzYtXHVBODM5XHVBQTc3LVx1QUE3OVx1QUI1Qlx1RkIyOVx1RkJCMi1cdUZCQzFcdUZERkNcdUZERkRcdUZFNjJcdUZFNjQtXHVGRTY2XHVGRTY5XHVGRjA0XHVGRjBCXHVGRjFDLVx1RkYxRVx1RkYzRVx1RkY0MFx1RkY1Q1x1RkY1RVx1RkZFMC1cdUZGRTZcdUZGRTgtXHVGRkVFXHVGRkZDXHVGRkZEJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERDM3LVx1REQzRlx1REQ3OS1cdUREODlcdUREOEMtXHVERDhFXHVERDkwLVx1REQ5Qlx1RERBMFx1REREMC1cdURERkNdfFx1RDgwMltcdURDNzdcdURDNzhcdURFQzhdfFx1RDgwNVx1REYzRnxcdUQ4MUFbXHVERjNDLVx1REYzRlx1REY0NV18XHVEODJGXHVEQzlDfFx1RDgzNFtcdURDMDAtXHVEQ0Y1XHVERDAwLVx1REQyNlx1REQyOS1cdURENjRcdURENkEtXHVERDZDXHVERDgzXHVERDg0XHVERDhDLVx1RERBOVx1RERBRS1cdURERThcdURFMDAtXHVERTQxXHVERTQ1XHVERjAwLVx1REY1Nl18XHVEODM1W1x1REVDMVx1REVEQlx1REVGQlx1REYxNVx1REYzNVx1REY0Rlx1REY2Rlx1REY4OVx1REZBOVx1REZDM118XHVEODM2W1x1REMwMC1cdURERkZcdURFMzctXHVERTNBXHVERTZELVx1REU3NFx1REU3Ni1cdURFODNcdURFODVcdURFODZdfFx1RDgzQltcdURDQUNcdURDQjBcdURFRjBcdURFRjFdfFx1RDgzQ1tcdURDMDAtXHVEQzJCXHVEQzMwLVx1REM5M1x1RENBMC1cdURDQUVcdURDQjEtXHVEQ0JGXHVEQ0MxLVx1RENDRlx1RENEMS1cdURDRjVcdUREMTAtXHVERDZCXHVERDcwLVx1RERBQ1x1RERFNi1cdURFMDJcdURFMTAtXHVERTNCXHVERTQwLVx1REU0OFx1REU1MFx1REU1MVx1REU2MC1cdURFNjVcdURGMDAtXHVERkZGXXxcdUQ4M0RbXHVEQzAwLVx1REVENFx1REVFMC1cdURFRUNcdURFRjAtXHVERUY5XHVERjAwLVx1REY3M1x1REY4MC1cdURGRDhdfFx1RDgzRVtcdURDMDAtXHVEQzBCXHVEQzEwLVx1REM0N1x1REM1MC1cdURDNTlcdURDNjAtXHVEQzg3XHVEQzkwLVx1RENBRFx1REQwMC1cdUREMEJcdUREMTAtXHVERDNFXHVERDQwLVx1REQ3MFx1REQ3My1cdURENzZcdUREN0FcdUREN0MtXHVEREEyXHVEREIwLVx1RERCOVx1RERDMC1cdUREQzJcdURERDAtXHVEREZGXHVERTYwLVx1REU2RF0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1NjJywNCiAgICAgICAgJ2FsaWFzJzogJ0N1cnJlbmN5X1N5bWJvbCcsDQogICAgICAgICdibXAnOiAnXFwkXHhBMi1ceEE1XHUwNThGXHUwNjBCXHUwN0ZFXHUwN0ZGXHUwOUYyXHUwOUYzXHUwOUZCXHUwQUYxXHUwQkY5XHUwRTNGXHUxN0RCXHUyMEEwLVx1MjBCRlx1QTgzOFx1RkRGQ1x1RkU2OVx1RkYwNFx1RkZFMFx1RkZFMVx1RkZFNVx1RkZFNicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODNCXHVEQ0IwJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdTaycsDQogICAgICAgICdhbGlhcyc6ICdNb2RpZmllcl9TeW1ib2wnLA0KICAgICAgICAnYm1wJzogJ1xcXmBceEE4XHhBRlx4QjRceEI4XHUwMkMyLVx1MDJDNVx1MDJEMi1cdTAyREZcdTAyRTUtXHUwMkVCXHUwMkVEXHUwMkVGLVx1MDJGRlx1MDM3NVx1MDM4NFx1MDM4NVx1MUZCRFx1MUZCRi1cdTFGQzFcdTFGQ0QtXHUxRkNGXHUxRkRELVx1MUZERlx1MUZFRC1cdTFGRUZcdTFGRkRcdTFGRkVcdTMwOUJcdTMwOUNcdUE3MDAtXHVBNzE2XHVBNzIwXHVBNzIxXHVBNzg5XHVBNzhBXHVBQjVCXHVGQkIyLVx1RkJDMVx1RkYzRVx1RkY0MFx1RkZFMycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODNDW1x1REZGQi1cdURGRkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdTbScsDQogICAgICAgICdhbGlhcyc6ICdNYXRoX1N5bWJvbCcsDQogICAgICAgICdibXAnOiAnXFwrPC0+XFx8flx4QUNceEIxXHhEN1x4RjdcdTAzRjZcdTA2MDYtXHUwNjA4XHUyMDQ0XHUyMDUyXHUyMDdBLVx1MjA3Q1x1MjA4QS1cdTIwOENcdTIxMThcdTIxNDAtXHUyMTQ0XHUyMTRCXHUyMTkwLVx1MjE5NFx1MjE5QVx1MjE5Qlx1MjFBMFx1MjFBM1x1MjFBNlx1MjFBRVx1MjFDRVx1MjFDRlx1MjFEMlx1MjFENFx1MjFGNC1cdTIyRkZcdTIzMjBcdTIzMjFcdTIzN0NcdTIzOUItXHUyM0IzXHUyM0RDLVx1MjNFMVx1MjVCN1x1MjVDMVx1MjVGOC1cdTI1RkZcdTI2NkZcdTI3QzAtXHUyN0M0XHUyN0M3LVx1MjdFNVx1MjdGMC1cdTI3RkZcdTI5MDAtXHUyOTgyXHUyOTk5LVx1MjlEN1x1MjlEQy1cdTI5RkJcdTI5RkUtXHUyQUZGXHUyQjMwLVx1MkI0NFx1MkI0Ny1cdTJCNENcdUZCMjlcdUZFNjJcdUZFNjQtXHVGRTY2XHVGRjBCXHVGRjFDLVx1RkYxRVx1RkY1Q1x1RkY1RVx1RkZFMlx1RkZFOS1cdUZGRUMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgzNVtcdURFQzFcdURFREJcdURFRkJcdURGMTVcdURGMzVcdURGNEZcdURGNkZcdURGODlcdURGQTlcdURGQzNdfFx1RDgzQltcdURFRjBcdURFRjFdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdTbycsDQogICAgICAgICdhbGlhcyc6ICdPdGhlcl9TeW1ib2wnLA0KICAgICAgICAnYm1wJzogJ1x4QTZceEE5XHhBRVx4QjBcdTA0ODJcdTA1OERcdTA1OEVcdTA2MEVcdTA2MEZcdTA2REVcdTA2RTlcdTA2RkRcdTA2RkVcdTA3RjZcdTA5RkFcdTBCNzBcdTBCRjMtXHUwQkY4XHUwQkZBXHUwQzdGXHUwRDRGXHUwRDc5XHUwRjAxLVx1MEYwM1x1MEYxM1x1MEYxNS1cdTBGMTdcdTBGMUEtXHUwRjFGXHUwRjM0XHUwRjM2XHUwRjM4XHUwRkJFLVx1MEZDNVx1MEZDNy1cdTBGQ0NcdTBGQ0VcdTBGQ0ZcdTBGRDUtXHUwRkQ4XHUxMDlFXHUxMDlGXHUxMzkwLVx1MTM5OVx1MTk0MFx1MTlERS1cdTE5RkZcdTFCNjEtXHUxQjZBXHUxQjc0LVx1MUI3Q1x1MjEwMFx1MjEwMVx1MjEwMy1cdTIxMDZcdTIxMDhcdTIxMDlcdTIxMTRcdTIxMTZcdTIxMTdcdTIxMUUtXHUyMTIzXHUyMTI1XHUyMTI3XHUyMTI5XHUyMTJFXHUyMTNBXHUyMTNCXHUyMTRBXHUyMTRDXHUyMTREXHUyMTRGXHUyMThBXHUyMThCXHUyMTk1LVx1MjE5OVx1MjE5Qy1cdTIxOUZcdTIxQTFcdTIxQTJcdTIxQTRcdTIxQTVcdTIxQTctXHUyMUFEXHUyMUFGLVx1MjFDRFx1MjFEMFx1MjFEMVx1MjFEM1x1MjFENS1cdTIxRjNcdTIzMDAtXHUyMzA3XHUyMzBDLVx1MjMxRlx1MjMyMi1cdTIzMjhcdTIzMkItXHUyMzdCXHUyMzdELVx1MjM5QVx1MjNCNC1cdTIzREJcdTIzRTItXHUyNDI2XHUyNDQwLVx1MjQ0QVx1MjQ5Qy1cdTI0RTlcdTI1MDAtXHUyNUI2XHUyNUI4LVx1MjVDMFx1MjVDMi1cdTI1RjdcdTI2MDAtXHUyNjZFXHUyNjcwLVx1Mjc2N1x1Mjc5NC1cdTI3QkZcdTI4MDAtXHUyOEZGXHUyQjAwLVx1MkIyRlx1MkI0NVx1MkI0Nlx1MkI0RC1cdTJCNzNcdTJCNzYtXHUyQjk1XHUyQjk4LVx1MkJDOFx1MkJDQS1cdTJCRkVcdTJDRTUtXHUyQ0VBXHUyRTgwLVx1MkU5OVx1MkU5Qi1cdTJFRjNcdTJGMDAtXHUyRkQ1XHUyRkYwLVx1MkZGQlx1MzAwNFx1MzAxMlx1MzAxM1x1MzAyMFx1MzAzNlx1MzAzN1x1MzAzRVx1MzAzRlx1MzE5MFx1MzE5MVx1MzE5Ni1cdTMxOUZcdTMxQzAtXHUzMUUzXHUzMjAwLVx1MzIxRVx1MzIyQS1cdTMyNDdcdTMyNTBcdTMyNjAtXHUzMjdGXHUzMjhBLVx1MzJCMFx1MzJDMC1cdTMyRkVcdTMzMDAtXHUzM0ZGXHU0REMwLVx1NERGRlx1QTQ5MC1cdUE0QzZcdUE4MjgtXHVBODJCXHVBODM2XHVBODM3XHVBODM5XHVBQTc3LVx1QUE3OVx1RkRGRFx1RkZFNFx1RkZFOFx1RkZFRFx1RkZFRVx1RkZGQ1x1RkZGRCcsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAwW1x1REQzNy1cdUREM0ZcdURENzktXHVERDg5XHVERDhDLVx1REQ4RVx1REQ5MC1cdUREOUJcdUREQTBcdURERDAtXHVEREZDXXxcdUQ4MDJbXHVEQzc3XHVEQzc4XHVERUM4XXxcdUQ4MDVcdURGM0Z8XHVEODFBW1x1REYzQy1cdURGM0ZcdURGNDVdfFx1RDgyRlx1REM5Q3xcdUQ4MzRbXHVEQzAwLVx1RENGNVx1REQwMC1cdUREMjZcdUREMjktXHVERDY0XHVERDZBLVx1REQ2Q1x1REQ4M1x1REQ4NFx1REQ4Qy1cdUREQTlcdUREQUUtXHVEREU4XHVERTAwLVx1REU0MVx1REU0NVx1REYwMC1cdURGNTZdfFx1RDgzNltcdURDMDAtXHVEREZGXHVERTM3LVx1REUzQVx1REU2RC1cdURFNzRcdURFNzYtXHVERTgzXHVERTg1XHVERTg2XXxcdUQ4M0JcdURDQUN8XHVEODNDW1x1REMwMC1cdURDMkJcdURDMzAtXHVEQzkzXHVEQ0EwLVx1RENBRVx1RENCMS1cdURDQkZcdURDQzEtXHVEQ0NGXHVEQ0QxLVx1RENGNVx1REQxMC1cdURENkJcdURENzAtXHVEREFDXHVEREU2LVx1REUwMlx1REUxMC1cdURFM0JcdURFNDAtXHVERTQ4XHVERTUwXHVERTUxXHVERTYwLVx1REU2NVx1REYwMC1cdURGRkFdfFx1RDgzRFtcdURDMDAtXHVERUQ0XHVERUUwLVx1REVFQ1x1REVGMC1cdURFRjlcdURGMDAtXHVERjczXHVERjgwLVx1REZEOF18XHVEODNFW1x1REMwMC1cdURDMEJcdURDMTAtXHVEQzQ3XHVEQzUwLVx1REM1OVx1REM2MC1cdURDODdcdURDOTAtXHVEQ0FEXHVERDAwLVx1REQwQlx1REQxMC1cdUREM0VcdURENDAtXHVERDcwXHVERDczLVx1REQ3Nlx1REQ3QVx1REQ3Qy1cdUREQTJcdUREQjAtXHVEREI5XHVEREMwLVx1RERDMlx1REREMC1cdURERkZcdURFNjAtXHVERTZEXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnWicsDQogICAgICAgICdhbGlhcyc6ICdTZXBhcmF0b3InLA0KICAgICAgICAnYm1wJzogJyBceEEwXHUxNjgwXHUyMDAwLVx1MjAwQVx1MjAyOFx1MjAyOVx1MjAyRlx1MjA1Rlx1MzAwMCcNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnWmwnLA0KICAgICAgICAnYWxpYXMnOiAnTGluZV9TZXBhcmF0b3InLA0KICAgICAgICAnYm1wJzogJ1x1MjAyOCcNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnWnAnLA0KICAgICAgICAnYWxpYXMnOiAnUGFyYWdyYXBoX1NlcGFyYXRvcicsDQogICAgICAgICdibXAnOiAnXHUyMDI5Jw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdacycsDQogICAgICAgICdhbGlhcyc6ICdTcGFjZV9TZXBhcmF0b3InLA0KICAgICAgICAnYm1wJzogJyBceEEwXHUxNjgwXHUyMDAwLVx1MjAwQVx1MjAyRlx1MjA1Rlx1MzAwMCcNCiAgICB9DQpdOw0KDQp9LHt9XSwxMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQptb2R1bGUuZXhwb3J0cyA9IFsNCiAgICB7DQogICAgICAgICduYW1lJzogJ0FTQ0lJJywNCiAgICAgICAgJ2JtcCc6ICdcMC1ceDdGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdBbHBoYWJldGljJywNCiAgICAgICAgJ2JtcCc6ICdBLVphLXpceEFBXHhCNVx4QkFceEMwLVx4RDZceEQ4LVx4RjZceEY4LVx1MDJDMVx1MDJDNi1cdTAyRDFcdTAyRTAtXHUwMkU0XHUwMkVDXHUwMkVFXHUwMzQ1XHUwMzcwLVx1MDM3NFx1MDM3Nlx1MDM3N1x1MDM3QS1cdTAzN0RcdTAzN0ZcdTAzODZcdTAzODgtXHUwMzhBXHUwMzhDXHUwMzhFLVx1MDNBMVx1MDNBMy1cdTAzRjVcdTAzRjctXHUwNDgxXHUwNDhBLVx1MDUyRlx1MDUzMS1cdTA1NTZcdTA1NTlcdTA1NjAtXHUwNTg4XHUwNUIwLVx1MDVCRFx1MDVCRlx1MDVDMVx1MDVDMlx1MDVDNFx1MDVDNVx1MDVDN1x1MDVEMC1cdTA1RUFcdTA1RUYtXHUwNUYyXHUwNjEwLVx1MDYxQVx1MDYyMC1cdTA2NTdcdTA2NTktXHUwNjVGXHUwNjZFLVx1MDZEM1x1MDZENS1cdTA2RENcdTA2RTEtXHUwNkU4XHUwNkVELVx1MDZFRlx1MDZGQS1cdTA2RkNcdTA2RkZcdTA3MTAtXHUwNzNGXHUwNzRELVx1MDdCMVx1MDdDQS1cdTA3RUFcdTA3RjRcdTA3RjVcdTA3RkFcdTA4MDAtXHUwODE3XHUwODFBLVx1MDgyQ1x1MDg0MC1cdTA4NThcdTA4NjAtXHUwODZBXHUwOEEwLVx1MDhCNFx1MDhCNi1cdTA4QkRcdTA4RDQtXHUwOERGXHUwOEUzLVx1MDhFOVx1MDhGMC1cdTA5M0JcdTA5M0QtXHUwOTRDXHUwOTRFLVx1MDk1MFx1MDk1NS1cdTA5NjNcdTA5NzEtXHUwOTgzXHUwOTg1LVx1MDk4Q1x1MDk4Rlx1MDk5MFx1MDk5My1cdTA5QThcdTA5QUEtXHUwOUIwXHUwOUIyXHUwOUI2LVx1MDlCOVx1MDlCRC1cdTA5QzRcdTA5QzdcdTA5QzhcdTA5Q0JcdTA5Q0NcdTA5Q0VcdTA5RDdcdTA5RENcdTA5RERcdTA5REYtXHUwOUUzXHUwOUYwXHUwOUYxXHUwOUZDXHUwQTAxLVx1MEEwM1x1MEEwNS1cdTBBMEFcdTBBMEZcdTBBMTBcdTBBMTMtXHUwQTI4XHUwQTJBLVx1MEEzMFx1MEEzMlx1MEEzM1x1MEEzNVx1MEEzNlx1MEEzOFx1MEEzOVx1MEEzRS1cdTBBNDJcdTBBNDdcdTBBNDhcdTBBNEJcdTBBNENcdTBBNTFcdTBBNTktXHUwQTVDXHUwQTVFXHUwQTcwLVx1MEE3NVx1MEE4MS1cdTBBODNcdTBBODUtXHUwQThEXHUwQThGLVx1MEE5MVx1MEE5My1cdTBBQThcdTBBQUEtXHUwQUIwXHUwQUIyXHUwQUIzXHUwQUI1LVx1MEFCOVx1MEFCRC1cdTBBQzVcdTBBQzctXHUwQUM5XHUwQUNCXHUwQUNDXHUwQUQwXHUwQUUwLVx1MEFFM1x1MEFGOS1cdTBBRkNcdTBCMDEtXHUwQjAzXHUwQjA1LVx1MEIwQ1x1MEIwRlx1MEIxMFx1MEIxMy1cdTBCMjhcdTBCMkEtXHUwQjMwXHUwQjMyXHUwQjMzXHUwQjM1LVx1MEIzOVx1MEIzRC1cdTBCNDRcdTBCNDdcdTBCNDhcdTBCNEJcdTBCNENcdTBCNTZcdTBCNTdcdTBCNUNcdTBCNURcdTBCNUYtXHUwQjYzXHUwQjcxXHUwQjgyXHUwQjgzXHUwQjg1LVx1MEI4QVx1MEI4RS1cdTBCOTBcdTBCOTItXHUwQjk1XHUwQjk5XHUwQjlBXHUwQjlDXHUwQjlFXHUwQjlGXHUwQkEzXHUwQkE0XHUwQkE4LVx1MEJBQVx1MEJBRS1cdTBCQjlcdTBCQkUtXHUwQkMyXHUwQkM2LVx1MEJDOFx1MEJDQS1cdTBCQ0NcdTBCRDBcdTBCRDdcdTBDMDAtXHUwQzAzXHUwQzA1LVx1MEMwQ1x1MEMwRS1cdTBDMTBcdTBDMTItXHUwQzI4XHUwQzJBLVx1MEMzOVx1MEMzRC1cdTBDNDRcdTBDNDYtXHUwQzQ4XHUwQzRBLVx1MEM0Q1x1MEM1NVx1MEM1Nlx1MEM1OC1cdTBDNUFcdTBDNjAtXHUwQzYzXHUwQzgwLVx1MEM4M1x1MEM4NS1cdTBDOENcdTBDOEUtXHUwQzkwXHUwQzkyLVx1MENBOFx1MENBQS1cdTBDQjNcdTBDQjUtXHUwQ0I5XHUwQ0JELVx1MENDNFx1MENDNi1cdTBDQzhcdTBDQ0EtXHUwQ0NDXHUwQ0Q1XHUwQ0Q2XHUwQ0RFXHUwQ0UwLVx1MENFM1x1MENGMVx1MENGMlx1MEQwMC1cdTBEMDNcdTBEMDUtXHUwRDBDXHUwRDBFLVx1MEQxMFx1MEQxMi1cdTBEM0FcdTBEM0QtXHUwRDQ0XHUwRDQ2LVx1MEQ0OFx1MEQ0QS1cdTBENENcdTBENEVcdTBENTQtXHUwRDU3XHUwRDVGLVx1MEQ2M1x1MEQ3QS1cdTBEN0ZcdTBEODJcdTBEODNcdTBEODUtXHUwRDk2XHUwRDlBLVx1MERCMVx1MERCMy1cdTBEQkJcdTBEQkRcdTBEQzAtXHUwREM2XHUwRENGLVx1MERENFx1MERENlx1MEREOC1cdTBEREZcdTBERjJcdTBERjNcdTBFMDEtXHUwRTNBXHUwRTQwLVx1MEU0Nlx1MEU0RFx1MEU4MVx1MEU4Mlx1MEU4NFx1MEU4N1x1MEU4OFx1MEU4QVx1MEU4RFx1MEU5NC1cdTBFOTdcdTBFOTktXHUwRTlGXHUwRUExLVx1MEVBM1x1MEVBNVx1MEVBN1x1MEVBQVx1MEVBQlx1MEVBRC1cdTBFQjlcdTBFQkItXHUwRUJEXHUwRUMwLVx1MEVDNFx1MEVDNlx1MEVDRFx1MEVEQy1cdTBFREZcdTBGMDBcdTBGNDAtXHUwRjQ3XHUwRjQ5LVx1MEY2Q1x1MEY3MS1cdTBGODFcdTBGODgtXHUwRjk3XHUwRjk5LVx1MEZCQ1x1MTAwMC1cdTEwMzZcdTEwMzhcdTEwM0ItXHUxMDNGXHUxMDUwLVx1MTA2Mlx1MTA2NS1cdTEwNjhcdTEwNkUtXHUxMDg2XHUxMDhFXHUxMDlDXHUxMDlEXHUxMEEwLVx1MTBDNVx1MTBDN1x1MTBDRFx1MTBEMC1cdTEwRkFcdTEwRkMtXHUxMjQ4XHUxMjRBLVx1MTI0RFx1MTI1MC1cdTEyNTZcdTEyNThcdTEyNUEtXHUxMjVEXHUxMjYwLVx1MTI4OFx1MTI4QS1cdTEyOERcdTEyOTAtXHUxMkIwXHUxMkIyLVx1MTJCNVx1MTJCOC1cdTEyQkVcdTEyQzBcdTEyQzItXHUxMkM1XHUxMkM4LVx1MTJENlx1MTJEOC1cdTEzMTBcdTEzMTItXHUxMzE1XHUxMzE4LVx1MTM1QVx1MTM1Rlx1MTM4MC1cdTEzOEZcdTEzQTAtXHUxM0Y1XHUxM0Y4LVx1MTNGRFx1MTQwMS1cdTE2NkNcdTE2NkYtXHUxNjdGXHUxNjgxLVx1MTY5QVx1MTZBMC1cdTE2RUFcdTE2RUUtXHUxNkY4XHUxNzAwLVx1MTcwQ1x1MTcwRS1cdTE3MTNcdTE3MjAtXHUxNzMzXHUxNzQwLVx1MTc1M1x1MTc2MC1cdTE3NkNcdTE3NkUtXHUxNzcwXHUxNzcyXHUxNzczXHUxNzgwLVx1MTdCM1x1MTdCNi1cdTE3QzhcdTE3RDdcdTE3RENcdTE4MjAtXHUxODc4XHUxODgwLVx1MThBQVx1MThCMC1cdTE4RjVcdTE5MDAtXHUxOTFFXHUxOTIwLVx1MTkyQlx1MTkzMC1cdTE5MzhcdTE5NTAtXHUxOTZEXHUxOTcwLVx1MTk3NFx1MTk4MC1cdTE5QUJcdTE5QjAtXHUxOUM5XHUxQTAwLVx1MUExQlx1MUEyMC1cdTFBNUVcdTFBNjEtXHUxQTc0XHUxQUE3XHUxQjAwLVx1MUIzM1x1MUIzNS1cdTFCNDNcdTFCNDUtXHUxQjRCXHUxQjgwLVx1MUJBOVx1MUJBQy1cdTFCQUZcdTFCQkEtXHUxQkU1XHUxQkU3LVx1MUJGMVx1MUMwMC1cdTFDMzVcdTFDNEQtXHUxQzRGXHUxQzVBLVx1MUM3RFx1MUM4MC1cdTFDODhcdTFDOTAtXHUxQ0JBXHUxQ0JELVx1MUNCRlx1MUNFOS1cdTFDRUNcdTFDRUUtXHUxQ0YzXHUxQ0Y1XHUxQ0Y2XHUxRDAwLVx1MURCRlx1MURFNy1cdTFERjRcdTFFMDAtXHUxRjE1XHUxRjE4LVx1MUYxRFx1MUYyMC1cdTFGNDVcdTFGNDgtXHUxRjREXHUxRjUwLVx1MUY1N1x1MUY1OVx1MUY1Qlx1MUY1RFx1MUY1Ri1cdTFGN0RcdTFGODAtXHUxRkI0XHUxRkI2LVx1MUZCQ1x1MUZCRVx1MUZDMi1cdTFGQzRcdTFGQzYtXHUxRkNDXHUxRkQwLVx1MUZEM1x1MUZENi1cdTFGREJcdTFGRTAtXHUxRkVDXHUxRkYyLVx1MUZGNFx1MUZGNi1cdTFGRkNcdTIwNzFcdTIwN0ZcdTIwOTAtXHUyMDlDXHUyMTAyXHUyMTA3XHUyMTBBLVx1MjExM1x1MjExNVx1MjExOS1cdTIxMURcdTIxMjRcdTIxMjZcdTIxMjhcdTIxMkEtXHUyMTJEXHUyMTJGLVx1MjEzOVx1MjEzQy1cdTIxM0ZcdTIxNDUtXHUyMTQ5XHUyMTRFXHUyMTYwLVx1MjE4OFx1MjRCNi1cdTI0RTlcdTJDMDAtXHUyQzJFXHUyQzMwLVx1MkM1RVx1MkM2MC1cdTJDRTRcdTJDRUItXHUyQ0VFXHUyQ0YyXHUyQ0YzXHUyRDAwLVx1MkQyNVx1MkQyN1x1MkQyRFx1MkQzMC1cdTJENjdcdTJENkZcdTJEODAtXHUyRDk2XHUyREEwLVx1MkRBNlx1MkRBOC1cdTJEQUVcdTJEQjAtXHUyREI2XHUyREI4LVx1MkRCRVx1MkRDMC1cdTJEQzZcdTJEQzgtXHUyRENFXHUyREQwLVx1MkRENlx1MkREOC1cdTJEREVcdTJERTAtXHUyREZGXHUyRTJGXHUzMDA1LVx1MzAwN1x1MzAyMS1cdTMwMjlcdTMwMzEtXHUzMDM1XHUzMDM4LVx1MzAzQ1x1MzA0MS1cdTMwOTZcdTMwOUQtXHUzMDlGXHUzMEExLVx1MzBGQVx1MzBGQy1cdTMwRkZcdTMxMDUtXHUzMTJGXHUzMTMxLVx1MzE4RVx1MzFBMC1cdTMxQkFcdTMxRjAtXHUzMUZGXHUzNDAwLVx1NERCNVx1NEUwMC1cdTlGRUZcdUEwMDAtXHVBNDhDXHVBNEQwLVx1QTRGRFx1QTUwMC1cdUE2MENcdUE2MTAtXHVBNjFGXHVBNjJBXHVBNjJCXHVBNjQwLVx1QTY2RVx1QTY3NC1cdUE2N0JcdUE2N0YtXHVBNkVGXHVBNzE3LVx1QTcxRlx1QTcyMi1cdUE3ODhcdUE3OEItXHVBN0I5XHVBN0Y3LVx1QTgwMVx1QTgwMy1cdUE4MDVcdUE4MDctXHVBODBBXHVBODBDLVx1QTgyN1x1QTg0MC1cdUE4NzNcdUE4ODAtXHVBOEMzXHVBOEM1XHVBOEYyLVx1QThGN1x1QThGQlx1QThGRFx1QThGRVx1QTkwQS1cdUE5MkFcdUE5MzAtXHVBOTUyXHVBOTYwLVx1QTk3Q1x1QTk4MC1cdUE5QjJcdUE5QjQtXHVBOUJGXHVBOUNGXHVBOUUwLVx1QTlFNFx1QTlFNi1cdUE5RUZcdUE5RkEtXHVBOUZFXHVBQTAwLVx1QUEzNlx1QUE0MC1cdUFBNERcdUFBNjAtXHVBQTc2XHVBQTdBXHVBQTdFLVx1QUFCRVx1QUFDMFx1QUFDMlx1QUFEQi1cdUFBRERcdUFBRTAtXHVBQUVGXHVBQUYyLVx1QUFGNVx1QUIwMS1cdUFCMDZcdUFCMDktXHVBQjBFXHVBQjExLVx1QUIxNlx1QUIyMC1cdUFCMjZcdUFCMjgtXHVBQjJFXHVBQjMwLVx1QUI1QVx1QUI1Qy1cdUFCNjVcdUFCNzAtXHVBQkVBXHVBQzAwLVx1RDdBM1x1RDdCMC1cdUQ3QzZcdUQ3Q0ItXHVEN0ZCXHVGOTAwLVx1RkE2RFx1RkE3MC1cdUZBRDlcdUZCMDAtXHVGQjA2XHVGQjEzLVx1RkIxN1x1RkIxRC1cdUZCMjhcdUZCMkEtXHVGQjM2XHVGQjM4LVx1RkIzQ1x1RkIzRVx1RkI0MFx1RkI0MVx1RkI0M1x1RkI0NFx1RkI0Ni1cdUZCQjFcdUZCRDMtXHVGRDNEXHVGRDUwLVx1RkQ4Rlx1RkQ5Mi1cdUZEQzdcdUZERjAtXHVGREZCXHVGRTcwLVx1RkU3NFx1RkU3Ni1cdUZFRkNcdUZGMjEtXHVGRjNBXHVGRjQxLVx1RkY1QVx1RkY2Ni1cdUZGQkVcdUZGQzItXHVGRkM3XHVGRkNBLVx1RkZDRlx1RkZEMi1cdUZGRDdcdUZGREEtXHVGRkRDJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVEQzAwLVx1REMwQlx1REMwRC1cdURDMjZcdURDMjgtXHVEQzNBXHVEQzNDXHVEQzNEXHVEQzNGLVx1REM0RFx1REM1MC1cdURDNURcdURDODAtXHVEQ0ZBXHVERDQwLVx1REQ3NFx1REU4MC1cdURFOUNcdURFQTAtXHVERUQwXHVERjAwLVx1REYxRlx1REYyRC1cdURGNEFcdURGNTAtXHVERjdBXHVERjgwLVx1REY5RFx1REZBMC1cdURGQzNcdURGQzgtXHVERkNGXHVERkQxLVx1REZENV18XHVEODAxW1x1REMwMC1cdURDOURcdURDQjAtXHVEQ0QzXHVEQ0Q4LVx1RENGQlx1REQwMC1cdUREMjdcdUREMzAtXHVERDYzXHVERTAwLVx1REYzNlx1REY0MC1cdURGNTVcdURGNjAtXHVERjY3XXxcdUQ4MDJbXHVEQzAwLVx1REMwNVx1REMwOFx1REMwQS1cdURDMzVcdURDMzdcdURDMzhcdURDM0NcdURDM0YtXHVEQzU1XHVEQzYwLVx1REM3Nlx1REM4MC1cdURDOUVcdURDRTAtXHVEQ0YyXHVEQ0Y0XHVEQ0Y1XHVERDAwLVx1REQxNVx1REQyMC1cdUREMzlcdUREODAtXHVEREI3XHVEREJFXHVEREJGXHVERTAwLVx1REUwM1x1REUwNVx1REUwNlx1REUwQy1cdURFMTNcdURFMTUtXHVERTE3XHVERTE5LVx1REUzNVx1REU2MC1cdURFN0NcdURFODAtXHVERTlDXHVERUMwLVx1REVDN1x1REVDOS1cdURFRTRcdURGMDAtXHVERjM1XHVERjQwLVx1REY1NVx1REY2MC1cdURGNzJcdURGODAtXHVERjkxXXxcdUQ4MDNbXHVEQzAwLVx1REM0OFx1REM4MC1cdURDQjJcdURDQzAtXHVEQ0YyXHVERDAwLVx1REQyN1x1REYwMC1cdURGMUNcdURGMjdcdURGMzAtXHVERjQ1XXxcdUQ4MDRbXHVEQzAwLVx1REM0NVx1REM4Mi1cdURDQjhcdURDRDAtXHVEQ0U4XHVERDAwLVx1REQzMlx1REQ0NC1cdURENDZcdURENTAtXHVERDcyXHVERDc2XHVERDgwLVx1RERCRlx1RERDMS1cdUREQzRcdUREREFcdURERENcdURFMDAtXHVERTExXHVERTEzLVx1REUzNFx1REUzN1x1REUzRVx1REU4MC1cdURFODZcdURFODhcdURFOEEtXHVERThEXHVERThGLVx1REU5RFx1REU5Ri1cdURFQThcdURFQjAtXHVERUU4XHVERjAwLVx1REYwM1x1REYwNS1cdURGMENcdURGMEZcdURGMTBcdURGMTMtXHVERjI4XHVERjJBLVx1REYzMFx1REYzMlx1REYzM1x1REYzNS1cdURGMzlcdURGM0QtXHVERjQ0XHVERjQ3XHVERjQ4XHVERjRCXHVERjRDXHVERjUwXHVERjU3XHVERjVELVx1REY2M118XHVEODA1W1x1REMwMC1cdURDNDFcdURDNDMtXHVEQzQ1XHVEQzQ3LVx1REM0QVx1REM4MC1cdURDQzFcdURDQzRcdURDQzVcdURDQzdcdUREODAtXHVEREI1XHVEREI4LVx1RERCRVx1REREOC1cdURERERcdURFMDAtXHVERTNFXHVERTQwXHVERTQ0XHVERTgwLVx1REVCNVx1REYwMC1cdURGMUFcdURGMUQtXHVERjJBXXxcdUQ4MDZbXHVEQzAwLVx1REMzOFx1RENBMC1cdURDREZcdURDRkZcdURFMDAtXHVERTMyXHVERTM1LVx1REUzRVx1REU1MC1cdURFODNcdURFODYtXHVERTk3XHVERTlEXHVERUMwLVx1REVGOF18XHVEODA3W1x1REMwMC1cdURDMDhcdURDMEEtXHVEQzM2XHVEQzM4LVx1REMzRVx1REM0MFx1REM3Mi1cdURDOEZcdURDOTItXHVEQ0E3XHVEQ0E5LVx1RENCNlx1REQwMC1cdUREMDZcdUREMDhcdUREMDlcdUREMEItXHVERDM2XHVERDNBXHVERDNDXHVERDNEXHVERDNGLVx1REQ0MVx1REQ0M1x1REQ0Nlx1REQ0N1x1REQ2MC1cdURENjVcdURENjdcdURENjhcdURENkEtXHVERDhFXHVERDkwXHVERDkxXHVERDkzLVx1REQ5Nlx1REQ5OFx1REVFMC1cdURFRjZdfFx1RDgwOFtcdURDMDAtXHVERjk5XXxcdUQ4MDlbXHVEQzAwLVx1REM2RVx1REM4MC1cdURENDNdfFtcdUQ4MENcdUQ4MUMtXHVEODIwXHVEODQwLVx1RDg2OFx1RDg2QS1cdUQ4NkNcdUQ4NkYtXHVEODcyXHVEODc0LVx1RDg3OV1bXHVEQzAwLVx1REZGRl18XHVEODBEW1x1REMwMC1cdURDMkVdfFx1RDgxMVtcdURDMDAtXHVERTQ2XXxcdUQ4MUFbXHVEQzAwLVx1REUzOFx1REU0MC1cdURFNUVcdURFRDAtXHVERUVEXHVERjAwLVx1REYzNlx1REY0MC1cdURGNDNcdURGNjMtXHVERjc3XHVERjdELVx1REY4Rl18XHVEODFCW1x1REU0MC1cdURFN0ZcdURGMDAtXHVERjQ0XHVERjUwLVx1REY3RVx1REY5My1cdURGOUZcdURGRTBcdURGRTFdfFx1RDgyMVtcdURDMDAtXHVERkYxXXxcdUQ4MjJbXHVEQzAwLVx1REVGMl18XHVEODJDW1x1REMwMC1cdUREMUVcdURENzAtXHVERUZCXXxcdUQ4MkZbXHVEQzAwLVx1REM2QVx1REM3MC1cdURDN0NcdURDODAtXHVEQzg4XHVEQzkwLVx1REM5OVx1REM5RV18XHVEODM1W1x1REMwMC1cdURDNTRcdURDNTYtXHVEQzlDXHVEQzlFXHVEQzlGXHVEQ0EyXHVEQ0E1XHVEQ0E2XHVEQ0E5LVx1RENBQ1x1RENBRS1cdURDQjlcdURDQkJcdURDQkQtXHVEQ0MzXHVEQ0M1LVx1REQwNVx1REQwNy1cdUREMEFcdUREMEQtXHVERDE0XHVERDE2LVx1REQxQ1x1REQxRS1cdUREMzlcdUREM0ItXHVERDNFXHVERDQwLVx1REQ0NFx1REQ0Nlx1REQ0QS1cdURENTBcdURENTItXHVERUE1XHVERUE4LVx1REVDMFx1REVDMi1cdURFREFcdURFREMtXHVERUZBXHVERUZDLVx1REYxNFx1REYxNi1cdURGMzRcdURGMzYtXHVERjRFXHVERjUwLVx1REY2RVx1REY3MC1cdURGODhcdURGOEEtXHVERkE4XHVERkFBLVx1REZDMlx1REZDNC1cdURGQ0JdfFx1RDgzOFtcdURDMDAtXHVEQzA2XHVEQzA4LVx1REMxOFx1REMxQi1cdURDMjFcdURDMjNcdURDMjRcdURDMjYtXHVEQzJBXXxcdUQ4M0FbXHVEQzAwLVx1RENDNFx1REQwMC1cdURENDNcdURENDddfFx1RDgzQltcdURFMDAtXHVERTAzXHVERTA1LVx1REUxRlx1REUyMVx1REUyMlx1REUyNFx1REUyN1x1REUyOS1cdURFMzJcdURFMzQtXHVERTM3XHVERTM5XHVERTNCXHVERTQyXHVERTQ3XHVERTQ5XHVERTRCXHVERTRELVx1REU0Rlx1REU1MVx1REU1Mlx1REU1NFx1REU1N1x1REU1OVx1REU1Qlx1REU1RFx1REU1Rlx1REU2MVx1REU2Mlx1REU2NFx1REU2Ny1cdURFNkFcdURFNkMtXHVERTcyXHVERTc0LVx1REU3N1x1REU3OS1cdURFN0NcdURFN0VcdURFODAtXHVERTg5XHVERThCLVx1REU5Qlx1REVBMS1cdURFQTNcdURFQTUtXHVERUE5XHVERUFCLVx1REVCQl18XHVEODNDW1x1REQzMC1cdURENDlcdURENTAtXHVERDY5XHVERDcwLVx1REQ4OV18XHVEODY5W1x1REMwMC1cdURFRDZcdURGMDAtXHVERkZGXXxcdUQ4NkRbXHVEQzAwLVx1REYzNFx1REY0MC1cdURGRkZdfFx1RDg2RVtcdURDMDAtXHVEQzFEXHVEQzIwLVx1REZGRl18XHVEODczW1x1REMwMC1cdURFQTFcdURFQjAtXHVERkZGXXxcdUQ4N0FbXHVEQzAwLVx1REZFMF18XHVEODdFW1x1REMwMC1cdURFMURdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdBbnknLA0KICAgICAgICAnaXNCbXBMYXN0JzogdHJ1ZSwNCiAgICAgICAgJ2JtcCc6ICdcMC1cdUZGRkYnLA0KICAgICAgICAnYXN0cmFsJzogJ1tcdUQ4MDAtXHVEQkZGXVtcdURDMDAtXHVERkZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnRGVmYXVsdF9JZ25vcmFibGVfQ29kZV9Qb2ludCcsDQogICAgICAgICdibXAnOiAnXHhBRFx1MDM0Rlx1MDYxQ1x1MTE1Rlx1MTE2MFx1MTdCNFx1MTdCNVx1MTgwQi1cdTE4MEVcdTIwMEItXHUyMDBGXHUyMDJBLVx1MjAyRVx1MjA2MC1cdTIwNkZcdTMxNjRcdUZFMDAtXHVGRTBGXHVGRUZGXHVGRkEwXHVGRkYwLVx1RkZGOCcsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODJGW1x1RENBMC1cdURDQTNdfFx1RDgzNFtcdURENzMtXHVERDdBXXxbXHVEQjQwLVx1REI0M11bXHVEQzAwLVx1REZGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0xvd2VyY2FzZScsDQogICAgICAgICdibXAnOiAnYS16XHhBQVx4QjVceEJBXHhERi1ceEY2XHhGOC1ceEZGXHUwMTAxXHUwMTAzXHUwMTA1XHUwMTA3XHUwMTA5XHUwMTBCXHUwMTBEXHUwMTBGXHUwMTExXHUwMTEzXHUwMTE1XHUwMTE3XHUwMTE5XHUwMTFCXHUwMTFEXHUwMTFGXHUwMTIxXHUwMTIzXHUwMTI1XHUwMTI3XHUwMTI5XHUwMTJCXHUwMTJEXHUwMTJGXHUwMTMxXHUwMTMzXHUwMTM1XHUwMTM3XHUwMTM4XHUwMTNBXHUwMTNDXHUwMTNFXHUwMTQwXHUwMTQyXHUwMTQ0XHUwMTQ2XHUwMTQ4XHUwMTQ5XHUwMTRCXHUwMTREXHUwMTRGXHUwMTUxXHUwMTUzXHUwMTU1XHUwMTU3XHUwMTU5XHUwMTVCXHUwMTVEXHUwMTVGXHUwMTYxXHUwMTYzXHUwMTY1XHUwMTY3XHUwMTY5XHUwMTZCXHUwMTZEXHUwMTZGXHUwMTcxXHUwMTczXHUwMTc1XHUwMTc3XHUwMTdBXHUwMTdDXHUwMTdFLVx1MDE4MFx1MDE4M1x1MDE4NVx1MDE4OFx1MDE4Q1x1MDE4RFx1MDE5Mlx1MDE5NVx1MDE5OS1cdTAxOUJcdTAxOUVcdTAxQTFcdTAxQTNcdTAxQTVcdTAxQThcdTAxQUFcdTAxQUJcdTAxQURcdTAxQjBcdTAxQjRcdTAxQjZcdTAxQjlcdTAxQkFcdTAxQkQtXHUwMUJGXHUwMUM2XHUwMUM5XHUwMUNDXHUwMUNFXHUwMUQwXHUwMUQyXHUwMUQ0XHUwMUQ2XHUwMUQ4XHUwMURBXHUwMURDXHUwMUREXHUwMURGXHUwMUUxXHUwMUUzXHUwMUU1XHUwMUU3XHUwMUU5XHUwMUVCXHUwMUVEXHUwMUVGXHUwMUYwXHUwMUYzXHUwMUY1XHUwMUY5XHUwMUZCXHUwMUZEXHUwMUZGXHUwMjAxXHUwMjAzXHUwMjA1XHUwMjA3XHUwMjA5XHUwMjBCXHUwMjBEXHUwMjBGXHUwMjExXHUwMjEzXHUwMjE1XHUwMjE3XHUwMjE5XHUwMjFCXHUwMjFEXHUwMjFGXHUwMjIxXHUwMjIzXHUwMjI1XHUwMjI3XHUwMjI5XHUwMjJCXHUwMjJEXHUwMjJGXHUwMjMxXHUwMjMzLVx1MDIzOVx1MDIzQ1x1MDIzRlx1MDI0MFx1MDI0Mlx1MDI0N1x1MDI0OVx1MDI0Qlx1MDI0RFx1MDI0Ri1cdTAyOTNcdTAyOTUtXHUwMkI4XHUwMkMwXHUwMkMxXHUwMkUwLVx1MDJFNFx1MDM0NVx1MDM3MVx1MDM3M1x1MDM3N1x1MDM3QS1cdTAzN0RcdTAzOTBcdTAzQUMtXHUwM0NFXHUwM0QwXHUwM0QxXHUwM0Q1LVx1MDNEN1x1MDNEOVx1MDNEQlx1MDNERFx1MDNERlx1MDNFMVx1MDNFM1x1MDNFNVx1MDNFN1x1MDNFOVx1MDNFQlx1MDNFRFx1MDNFRi1cdTAzRjNcdTAzRjVcdTAzRjhcdTAzRkJcdTAzRkNcdTA0MzAtXHUwNDVGXHUwNDYxXHUwNDYzXHUwNDY1XHUwNDY3XHUwNDY5XHUwNDZCXHUwNDZEXHUwNDZGXHUwNDcxXHUwNDczXHUwNDc1XHUwNDc3XHUwNDc5XHUwNDdCXHUwNDdEXHUwNDdGXHUwNDgxXHUwNDhCXHUwNDhEXHUwNDhGXHUwNDkxXHUwNDkzXHUwNDk1XHUwNDk3XHUwNDk5XHUwNDlCXHUwNDlEXHUwNDlGXHUwNEExXHUwNEEzXHUwNEE1XHUwNEE3XHUwNEE5XHUwNEFCXHUwNEFEXHUwNEFGXHUwNEIxXHUwNEIzXHUwNEI1XHUwNEI3XHUwNEI5XHUwNEJCXHUwNEJEXHUwNEJGXHUwNEMyXHUwNEM0XHUwNEM2XHUwNEM4XHUwNENBXHUwNENDXHUwNENFXHUwNENGXHUwNEQxXHUwNEQzXHUwNEQ1XHUwNEQ3XHUwNEQ5XHUwNERCXHUwNEREXHUwNERGXHUwNEUxXHUwNEUzXHUwNEU1XHUwNEU3XHUwNEU5XHUwNEVCXHUwNEVEXHUwNEVGXHUwNEYxXHUwNEYzXHUwNEY1XHUwNEY3XHUwNEY5XHUwNEZCXHUwNEZEXHUwNEZGXHUwNTAxXHUwNTAzXHUwNTA1XHUwNTA3XHUwNTA5XHUwNTBCXHUwNTBEXHUwNTBGXHUwNTExXHUwNTEzXHUwNTE1XHUwNTE3XHUwNTE5XHUwNTFCXHUwNTFEXHUwNTFGXHUwNTIxXHUwNTIzXHUwNTI1XHUwNTI3XHUwNTI5XHUwNTJCXHUwNTJEXHUwNTJGXHUwNTYwLVx1MDU4OFx1MTBEMC1cdTEwRkFcdTEwRkQtXHUxMEZGXHUxM0Y4LVx1MTNGRFx1MUM4MC1cdTFDODhcdTFEMDAtXHUxREJGXHUxRTAxXHUxRTAzXHUxRTA1XHUxRTA3XHUxRTA5XHUxRTBCXHUxRTBEXHUxRTBGXHUxRTExXHUxRTEzXHUxRTE1XHUxRTE3XHUxRTE5XHUxRTFCXHUxRTFEXHUxRTFGXHUxRTIxXHUxRTIzXHUxRTI1XHUxRTI3XHUxRTI5XHUxRTJCXHUxRTJEXHUxRTJGXHUxRTMxXHUxRTMzXHUxRTM1XHUxRTM3XHUxRTM5XHUxRTNCXHUxRTNEXHUxRTNGXHUxRTQxXHUxRTQzXHUxRTQ1XHUxRTQ3XHUxRTQ5XHUxRTRCXHUxRTREXHUxRTRGXHUxRTUxXHUxRTUzXHUxRTU1XHUxRTU3XHUxRTU5XHUxRTVCXHUxRTVEXHUxRTVGXHUxRTYxXHUxRTYzXHUxRTY1XHUxRTY3XHUxRTY5XHUxRTZCXHUxRTZEXHUxRTZGXHUxRTcxXHUxRTczXHUxRTc1XHUxRTc3XHUxRTc5XHUxRTdCXHUxRTdEXHUxRTdGXHUxRTgxXHUxRTgzXHUxRTg1XHUxRTg3XHUxRTg5XHUxRThCXHUxRThEXHUxRThGXHUxRTkxXHUxRTkzXHUxRTk1LVx1MUU5RFx1MUU5Rlx1MUVBMVx1MUVBM1x1MUVBNVx1MUVBN1x1MUVBOVx1MUVBQlx1MUVBRFx1MUVBRlx1MUVCMVx1MUVCM1x1MUVCNVx1MUVCN1x1MUVCOVx1MUVCQlx1MUVCRFx1MUVCRlx1MUVDMVx1MUVDM1x1MUVDNVx1MUVDN1x1MUVDOVx1MUVDQlx1MUVDRFx1MUVDRlx1MUVEMVx1MUVEM1x1MUVENVx1MUVEN1x1MUVEOVx1MUVEQlx1MUVERFx1MUVERlx1MUVFMVx1MUVFM1x1MUVFNVx1MUVFN1x1MUVFOVx1MUVFQlx1MUVFRFx1MUVFRlx1MUVGMVx1MUVGM1x1MUVGNVx1MUVGN1x1MUVGOVx1MUVGQlx1MUVGRFx1MUVGRi1cdTFGMDdcdTFGMTAtXHUxRjE1XHUxRjIwLVx1MUYyN1x1MUYzMC1cdTFGMzdcdTFGNDAtXHUxRjQ1XHUxRjUwLVx1MUY1N1x1MUY2MC1cdTFGNjdcdTFGNzAtXHUxRjdEXHUxRjgwLVx1MUY4N1x1MUY5MC1cdTFGOTdcdTFGQTAtXHUxRkE3XHUxRkIwLVx1MUZCNFx1MUZCNlx1MUZCN1x1MUZCRVx1MUZDMi1cdTFGQzRcdTFGQzZcdTFGQzdcdTFGRDAtXHUxRkQzXHUxRkQ2XHUxRkQ3XHUxRkUwLVx1MUZFN1x1MUZGMi1cdTFGRjRcdTFGRjZcdTFGRjdcdTIwNzFcdTIwN0ZcdTIwOTAtXHUyMDlDXHUyMTBBXHUyMTBFXHUyMTBGXHUyMTEzXHUyMTJGXHUyMTM0XHUyMTM5XHUyMTNDXHUyMTNEXHUyMTQ2LVx1MjE0OVx1MjE0RVx1MjE3MC1cdTIxN0ZcdTIxODRcdTI0RDAtXHUyNEU5XHUyQzMwLVx1MkM1RVx1MkM2MVx1MkM2NVx1MkM2Nlx1MkM2OFx1MkM2QVx1MkM2Q1x1MkM3MVx1MkM3M1x1MkM3NFx1MkM3Ni1cdTJDN0RcdTJDODFcdTJDODNcdTJDODVcdTJDODdcdTJDODlcdTJDOEJcdTJDOERcdTJDOEZcdTJDOTFcdTJDOTNcdTJDOTVcdTJDOTdcdTJDOTlcdTJDOUJcdTJDOURcdTJDOUZcdTJDQTFcdTJDQTNcdTJDQTVcdTJDQTdcdTJDQTlcdTJDQUJcdTJDQURcdTJDQUZcdTJDQjFcdTJDQjNcdTJDQjVcdTJDQjdcdTJDQjlcdTJDQkJcdTJDQkRcdTJDQkZcdTJDQzFcdTJDQzNcdTJDQzVcdTJDQzdcdTJDQzlcdTJDQ0JcdTJDQ0RcdTJDQ0ZcdTJDRDFcdTJDRDNcdTJDRDVcdTJDRDdcdTJDRDlcdTJDREJcdTJDRERcdTJDREZcdTJDRTFcdTJDRTNcdTJDRTRcdTJDRUNcdTJDRUVcdTJDRjNcdTJEMDAtXHUyRDI1XHUyRDI3XHUyRDJEXHVBNjQxXHVBNjQzXHVBNjQ1XHVBNjQ3XHVBNjQ5XHVBNjRCXHVBNjREXHVBNjRGXHVBNjUxXHVBNjUzXHVBNjU1XHVBNjU3XHVBNjU5XHVBNjVCXHVBNjVEXHVBNjVGXHVBNjYxXHVBNjYzXHVBNjY1XHVBNjY3XHVBNjY5XHVBNjZCXHVBNjZEXHVBNjgxXHVBNjgzXHVBNjg1XHVBNjg3XHVBNjg5XHVBNjhCXHVBNjhEXHVBNjhGXHVBNjkxXHVBNjkzXHVBNjk1XHVBNjk3XHVBNjk5XHVBNjlCLVx1QTY5RFx1QTcyM1x1QTcyNVx1QTcyN1x1QTcyOVx1QTcyQlx1QTcyRFx1QTcyRi1cdUE3MzFcdUE3MzNcdUE3MzVcdUE3MzdcdUE3MzlcdUE3M0JcdUE3M0RcdUE3M0ZcdUE3NDFcdUE3NDNcdUE3NDVcdUE3NDdcdUE3NDlcdUE3NEJcdUE3NERcdUE3NEZcdUE3NTFcdUE3NTNcdUE3NTVcdUE3NTdcdUE3NTlcdUE3NUJcdUE3NURcdUE3NUZcdUE3NjFcdUE3NjNcdUE3NjVcdUE3NjdcdUE3NjlcdUE3NkJcdUE3NkRcdUE3NkYtXHVBNzc4XHVBNzdBXHVBNzdDXHVBNzdGXHVBNzgxXHVBNzgzXHVBNzg1XHVBNzg3XHVBNzhDXHVBNzhFXHVBNzkxXHVBNzkzLVx1QTc5NVx1QTc5N1x1QTc5OVx1QTc5Qlx1QTc5RFx1QTc5Rlx1QTdBMVx1QTdBM1x1QTdBNVx1QTdBN1x1QTdBOVx1QTdBRlx1QTdCNVx1QTdCN1x1QTdCOVx1QTdGOC1cdUE3RkFcdUFCMzAtXHVBQjVBXHVBQjVDLVx1QUI2NVx1QUI3MC1cdUFCQkZcdUZCMDAtXHVGQjA2XHVGQjEzLVx1RkIxN1x1RkY0MS1cdUZGNUEnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMVtcdURDMjgtXHVEQzRGXHVEQ0Q4LVx1RENGQl18XHVEODAzW1x1RENDMC1cdURDRjJdfFx1RDgwNltcdURDQzAtXHVEQ0RGXXxcdUQ4MUJbXHVERTYwLVx1REU3Rl18XHVEODM1W1x1REMxQS1cdURDMzNcdURDNEUtXHVEQzU0XHVEQzU2LVx1REM2N1x1REM4Mi1cdURDOUJcdURDQjYtXHVEQ0I5XHVEQ0JCXHVEQ0JELVx1RENDM1x1RENDNS1cdURDQ0ZcdURDRUEtXHVERDAzXHVERDFFLVx1REQzN1x1REQ1Mi1cdURENkJcdUREODYtXHVERDlGXHVEREJBLVx1REREM1x1RERFRS1cdURFMDdcdURFMjItXHVERTNCXHVERTU2LVx1REU2Rlx1REU4QS1cdURFQTVcdURFQzItXHVERURBXHVERURDLVx1REVFMVx1REVGQy1cdURGMTRcdURGMTYtXHVERjFCXHVERjM2LVx1REY0RVx1REY1MC1cdURGNTVcdURGNzAtXHVERjg4XHVERjhBLVx1REY4Rlx1REZBQS1cdURGQzJcdURGQzQtXHVERkM5XHVERkNCXXxcdUQ4M0FbXHVERDIyLVx1REQ0M10nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ05vbmNoYXJhY3Rlcl9Db2RlX1BvaW50JywNCiAgICAgICAgJ2JtcCc6ICdcdUZERDAtXHVGREVGXHVGRkZFXHVGRkZGJywNCiAgICAgICAgJ2FzdHJhbCc6ICdbXHVEODNGXHVEODdGXHVEOEJGXHVEOEZGXHVEOTNGXHVEOTdGXHVEOUJGXHVEOUZGXHVEQTNGXHVEQTdGXHVEQUJGXHVEQUZGXHVEQjNGXHVEQjdGXHVEQkJGXHVEQkZGXVtcdURGRkVcdURGRkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdVcHBlcmNhc2UnLA0KICAgICAgICAnYm1wJzogJ0EtWlx4QzAtXHhENlx4RDgtXHhERVx1MDEwMFx1MDEwMlx1MDEwNFx1MDEwNlx1MDEwOFx1MDEwQVx1MDEwQ1x1MDEwRVx1MDExMFx1MDExMlx1MDExNFx1MDExNlx1MDExOFx1MDExQVx1MDExQ1x1MDExRVx1MDEyMFx1MDEyMlx1MDEyNFx1MDEyNlx1MDEyOFx1MDEyQVx1MDEyQ1x1MDEyRVx1MDEzMFx1MDEzMlx1MDEzNFx1MDEzNlx1MDEzOVx1MDEzQlx1MDEzRFx1MDEzRlx1MDE0MVx1MDE0M1x1MDE0NVx1MDE0N1x1MDE0QVx1MDE0Q1x1MDE0RVx1MDE1MFx1MDE1Mlx1MDE1NFx1MDE1Nlx1MDE1OFx1MDE1QVx1MDE1Q1x1MDE1RVx1MDE2MFx1MDE2Mlx1MDE2NFx1MDE2Nlx1MDE2OFx1MDE2QVx1MDE2Q1x1MDE2RVx1MDE3MFx1MDE3Mlx1MDE3NFx1MDE3Nlx1MDE3OFx1MDE3OVx1MDE3Qlx1MDE3RFx1MDE4MVx1MDE4Mlx1MDE4NFx1MDE4Nlx1MDE4N1x1MDE4OS1cdTAxOEJcdTAxOEUtXHUwMTkxXHUwMTkzXHUwMTk0XHUwMTk2LVx1MDE5OFx1MDE5Q1x1MDE5RFx1MDE5Rlx1MDFBMFx1MDFBMlx1MDFBNFx1MDFBNlx1MDFBN1x1MDFBOVx1MDFBQ1x1MDFBRVx1MDFBRlx1MDFCMS1cdTAxQjNcdTAxQjVcdTAxQjdcdTAxQjhcdTAxQkNcdTAxQzRcdTAxQzdcdTAxQ0FcdTAxQ0RcdTAxQ0ZcdTAxRDFcdTAxRDNcdTAxRDVcdTAxRDdcdTAxRDlcdTAxREJcdTAxREVcdTAxRTBcdTAxRTJcdTAxRTRcdTAxRTZcdTAxRThcdTAxRUFcdTAxRUNcdTAxRUVcdTAxRjFcdTAxRjRcdTAxRjYtXHUwMUY4XHUwMUZBXHUwMUZDXHUwMUZFXHUwMjAwXHUwMjAyXHUwMjA0XHUwMjA2XHUwMjA4XHUwMjBBXHUwMjBDXHUwMjBFXHUwMjEwXHUwMjEyXHUwMjE0XHUwMjE2XHUwMjE4XHUwMjFBXHUwMjFDXHUwMjFFXHUwMjIwXHUwMjIyXHUwMjI0XHUwMjI2XHUwMjI4XHUwMjJBXHUwMjJDXHUwMjJFXHUwMjMwXHUwMjMyXHUwMjNBXHUwMjNCXHUwMjNEXHUwMjNFXHUwMjQxXHUwMjQzLVx1MDI0Nlx1MDI0OFx1MDI0QVx1MDI0Q1x1MDI0RVx1MDM3MFx1MDM3Mlx1MDM3Nlx1MDM3Rlx1MDM4Nlx1MDM4OC1cdTAzOEFcdTAzOENcdTAzOEVcdTAzOEZcdTAzOTEtXHUwM0ExXHUwM0EzLVx1MDNBQlx1MDNDRlx1MDNEMi1cdTAzRDRcdTAzRDhcdTAzREFcdTAzRENcdTAzREVcdTAzRTBcdTAzRTJcdTAzRTRcdTAzRTZcdTAzRThcdTAzRUFcdTAzRUNcdTAzRUVcdTAzRjRcdTAzRjdcdTAzRjlcdTAzRkFcdTAzRkQtXHUwNDJGXHUwNDYwXHUwNDYyXHUwNDY0XHUwNDY2XHUwNDY4XHUwNDZBXHUwNDZDXHUwNDZFXHUwNDcwXHUwNDcyXHUwNDc0XHUwNDc2XHUwNDc4XHUwNDdBXHUwNDdDXHUwNDdFXHUwNDgwXHUwNDhBXHUwNDhDXHUwNDhFXHUwNDkwXHUwNDkyXHUwNDk0XHUwNDk2XHUwNDk4XHUwNDlBXHUwNDlDXHUwNDlFXHUwNEEwXHUwNEEyXHUwNEE0XHUwNEE2XHUwNEE4XHUwNEFBXHUwNEFDXHUwNEFFXHUwNEIwXHUwNEIyXHUwNEI0XHUwNEI2XHUwNEI4XHUwNEJBXHUwNEJDXHUwNEJFXHUwNEMwXHUwNEMxXHUwNEMzXHUwNEM1XHUwNEM3XHUwNEM5XHUwNENCXHUwNENEXHUwNEQwXHUwNEQyXHUwNEQ0XHUwNEQ2XHUwNEQ4XHUwNERBXHUwNERDXHUwNERFXHUwNEUwXHUwNEUyXHUwNEU0XHUwNEU2XHUwNEU4XHUwNEVBXHUwNEVDXHUwNEVFXHUwNEYwXHUwNEYyXHUwNEY0XHUwNEY2XHUwNEY4XHUwNEZBXHUwNEZDXHUwNEZFXHUwNTAwXHUwNTAyXHUwNTA0XHUwNTA2XHUwNTA4XHUwNTBBXHUwNTBDXHUwNTBFXHUwNTEwXHUwNTEyXHUwNTE0XHUwNTE2XHUwNTE4XHUwNTFBXHUwNTFDXHUwNTFFXHUwNTIwXHUwNTIyXHUwNTI0XHUwNTI2XHUwNTI4XHUwNTJBXHUwNTJDXHUwNTJFXHUwNTMxLVx1MDU1Nlx1MTBBMC1cdTEwQzVcdTEwQzdcdTEwQ0RcdTEzQTAtXHUxM0Y1XHUxQzkwLVx1MUNCQVx1MUNCRC1cdTFDQkZcdTFFMDBcdTFFMDJcdTFFMDRcdTFFMDZcdTFFMDhcdTFFMEFcdTFFMENcdTFFMEVcdTFFMTBcdTFFMTJcdTFFMTRcdTFFMTZcdTFFMThcdTFFMUFcdTFFMUNcdTFFMUVcdTFFMjBcdTFFMjJcdTFFMjRcdTFFMjZcdTFFMjhcdTFFMkFcdTFFMkNcdTFFMkVcdTFFMzBcdTFFMzJcdTFFMzRcdTFFMzZcdTFFMzhcdTFFM0FcdTFFM0NcdTFFM0VcdTFFNDBcdTFFNDJcdTFFNDRcdTFFNDZcdTFFNDhcdTFFNEFcdTFFNENcdTFFNEVcdTFFNTBcdTFFNTJcdTFFNTRcdTFFNTZcdTFFNThcdTFFNUFcdTFFNUNcdTFFNUVcdTFFNjBcdTFFNjJcdTFFNjRcdTFFNjZcdTFFNjhcdTFFNkFcdTFFNkNcdTFFNkVcdTFFNzBcdTFFNzJcdTFFNzRcdTFFNzZcdTFFNzhcdTFFN0FcdTFFN0NcdTFFN0VcdTFFODBcdTFFODJcdTFFODRcdTFFODZcdTFFODhcdTFFOEFcdTFFOENcdTFFOEVcdTFFOTBcdTFFOTJcdTFFOTRcdTFFOUVcdTFFQTBcdTFFQTJcdTFFQTRcdTFFQTZcdTFFQThcdTFFQUFcdTFFQUNcdTFFQUVcdTFFQjBcdTFFQjJcdTFFQjRcdTFFQjZcdTFFQjhcdTFFQkFcdTFFQkNcdTFFQkVcdTFFQzBcdTFFQzJcdTFFQzRcdTFFQzZcdTFFQzhcdTFFQ0FcdTFFQ0NcdTFFQ0VcdTFFRDBcdTFFRDJcdTFFRDRcdTFFRDZcdTFFRDhcdTFFREFcdTFFRENcdTFFREVcdTFFRTBcdTFFRTJcdTFFRTRcdTFFRTZcdTFFRThcdTFFRUFcdTFFRUNcdTFFRUVcdTFFRjBcdTFFRjJcdTFFRjRcdTFFRjZcdTFFRjhcdTFFRkFcdTFFRkNcdTFFRkVcdTFGMDgtXHUxRjBGXHUxRjE4LVx1MUYxRFx1MUYyOC1cdTFGMkZcdTFGMzgtXHUxRjNGXHUxRjQ4LVx1MUY0RFx1MUY1OVx1MUY1Qlx1MUY1RFx1MUY1Rlx1MUY2OC1cdTFGNkZcdTFGQjgtXHUxRkJCXHUxRkM4LVx1MUZDQlx1MUZEOC1cdTFGREJcdTFGRTgtXHUxRkVDXHUxRkY4LVx1MUZGQlx1MjEwMlx1MjEwN1x1MjEwQi1cdTIxMERcdTIxMTAtXHUyMTEyXHUyMTE1XHUyMTE5LVx1MjExRFx1MjEyNFx1MjEyNlx1MjEyOFx1MjEyQS1cdTIxMkRcdTIxMzAtXHUyMTMzXHUyMTNFXHUyMTNGXHUyMTQ1XHUyMTYwLVx1MjE2Rlx1MjE4M1x1MjRCNi1cdTI0Q0ZcdTJDMDAtXHUyQzJFXHUyQzYwXHUyQzYyLVx1MkM2NFx1MkM2N1x1MkM2OVx1MkM2Qlx1MkM2RC1cdTJDNzBcdTJDNzJcdTJDNzVcdTJDN0UtXHUyQzgwXHUyQzgyXHUyQzg0XHUyQzg2XHUyQzg4XHUyQzhBXHUyQzhDXHUyQzhFXHUyQzkwXHUyQzkyXHUyQzk0XHUyQzk2XHUyQzk4XHUyQzlBXHUyQzlDXHUyQzlFXHUyQ0EwXHUyQ0EyXHUyQ0E0XHUyQ0E2XHUyQ0E4XHUyQ0FBXHUyQ0FDXHUyQ0FFXHUyQ0IwXHUyQ0IyXHUyQ0I0XHUyQ0I2XHUyQ0I4XHUyQ0JBXHUyQ0JDXHUyQ0JFXHUyQ0MwXHUyQ0MyXHUyQ0M0XHUyQ0M2XHUyQ0M4XHUyQ0NBXHUyQ0NDXHUyQ0NFXHUyQ0QwXHUyQ0QyXHUyQ0Q0XHUyQ0Q2XHUyQ0Q4XHUyQ0RBXHUyQ0RDXHUyQ0RFXHUyQ0UwXHUyQ0UyXHUyQ0VCXHUyQ0VEXHUyQ0YyXHVBNjQwXHVBNjQyXHVBNjQ0XHVBNjQ2XHVBNjQ4XHVBNjRBXHVBNjRDXHVBNjRFXHVBNjUwXHVBNjUyXHVBNjU0XHVBNjU2XHVBNjU4XHVBNjVBXHVBNjVDXHVBNjVFXHVBNjYwXHVBNjYyXHVBNjY0XHVBNjY2XHVBNjY4XHVBNjZBXHVBNjZDXHVBNjgwXHVBNjgyXHVBNjg0XHVBNjg2XHVBNjg4XHVBNjhBXHVBNjhDXHVBNjhFXHVBNjkwXHVBNjkyXHVBNjk0XHVBNjk2XHVBNjk4XHVBNjlBXHVBNzIyXHVBNzI0XHVBNzI2XHVBNzI4XHVBNzJBXHVBNzJDXHVBNzJFXHVBNzMyXHVBNzM0XHVBNzM2XHVBNzM4XHVBNzNBXHVBNzNDXHVBNzNFXHVBNzQwXHVBNzQyXHVBNzQ0XHVBNzQ2XHVBNzQ4XHVBNzRBXHVBNzRDXHVBNzRFXHVBNzUwXHVBNzUyXHVBNzU0XHVBNzU2XHVBNzU4XHVBNzVBXHVBNzVDXHVBNzVFXHVBNzYwXHVBNzYyXHVBNzY0XHVBNzY2XHVBNzY4XHVBNzZBXHVBNzZDXHVBNzZFXHVBNzc5XHVBNzdCXHVBNzdEXHVBNzdFXHVBNzgwXHVBNzgyXHVBNzg0XHVBNzg2XHVBNzhCXHVBNzhEXHVBNzkwXHVBNzkyXHVBNzk2XHVBNzk4XHVBNzlBXHVBNzlDXHVBNzlFXHVBN0EwXHVBN0EyXHVBN0E0XHVBN0E2XHVBN0E4XHVBN0FBLVx1QTdBRVx1QTdCMC1cdUE3QjRcdUE3QjZcdUE3QjhcdUZGMjEtXHVGRjNBJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDFbXHVEQzAwLVx1REMyN1x1RENCMC1cdURDRDNdfFx1RDgwM1tcdURDODAtXHVEQ0IyXXxcdUQ4MDZbXHVEQ0EwLVx1RENCRl18XHVEODFCW1x1REU0MC1cdURFNUZdfFx1RDgzNVtcdURDMDAtXHVEQzE5XHVEQzM0LVx1REM0RFx1REM2OC1cdURDODFcdURDOUNcdURDOUVcdURDOUZcdURDQTJcdURDQTVcdURDQTZcdURDQTktXHVEQ0FDXHVEQ0FFLVx1RENCNVx1RENEMC1cdURDRTlcdUREMDRcdUREMDVcdUREMDctXHVERDBBXHVERDBELVx1REQxNFx1REQxNi1cdUREMUNcdUREMzhcdUREMzlcdUREM0ItXHVERDNFXHVERDQwLVx1REQ0NFx1REQ0Nlx1REQ0QS1cdURENTBcdURENkMtXHVERDg1XHVEREEwLVx1RERCOVx1RERENC1cdURERURcdURFMDgtXHVERTIxXHVERTNDLVx1REU1NVx1REU3MC1cdURFODlcdURFQTgtXHVERUMwXHVERUUyLVx1REVGQVx1REYxQy1cdURGMzRcdURGNTYtXHVERjZFXHVERjkwLVx1REZBOFx1REZDQV18XHVEODNBW1x1REQwMC1cdUREMjFdfFx1RDgzQ1tcdUREMzAtXHVERDQ5XHVERDUwLVx1REQ2OVx1REQ3MC1cdUREODldJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdXaGl0ZV9TcGFjZScsDQogICAgICAgICdibXAnOiAnXHQtXHIgXHg4NVx4QTBcdTE2ODBcdTIwMDAtXHUyMDBBXHUyMDI4XHUyMDI5XHUyMDJGXHUyMDVGXHUzMDAwJw0KICAgIH0NCl07DQoNCn0se31dLDEzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCm1vZHVsZS5leHBvcnRzID0gWw0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnQWRsYW0nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgzQVtcdUREMDAtXHVERDRBXHVERDUwLVx1REQ1OVx1REQ1RVx1REQ1Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0Fob20nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNVtcdURGMDAtXHVERjFBXHVERjFELVx1REYyQlx1REYzMC1cdURGM0ZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdBbmF0b2xpYW5fSGllcm9nbHlwaHMnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgxMVtcdURDMDAtXHVERTQ2XScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnQXJhYmljJywNCiAgICAgICAgJ2JtcCc6ICdcdTA2MDAtXHUwNjA0XHUwNjA2LVx1MDYwQlx1MDYwRC1cdTA2MUFcdTA2MUNcdTA2MUVcdTA2MjAtXHUwNjNGXHUwNjQxLVx1MDY0QVx1MDY1Ni1cdTA2NkZcdTA2NzEtXHUwNkRDXHUwNkRFLVx1MDZGRlx1MDc1MC1cdTA3N0ZcdTA4QTAtXHUwOEI0XHUwOEI2LVx1MDhCRFx1MDhEMy1cdTA4RTFcdTA4RTMtXHUwOEZGXHVGQjUwLVx1RkJDMVx1RkJEMy1cdUZEM0RcdUZENTAtXHVGRDhGXHVGRDkyLVx1RkRDN1x1RkRGMC1cdUZERkRcdUZFNzAtXHVGRTc0XHVGRTc2LVx1RkVGQycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAzW1x1REU2MC1cdURFN0VdfFx1RDgzQltcdURFMDAtXHVERTAzXHVERTA1LVx1REUxRlx1REUyMVx1REUyMlx1REUyNFx1REUyN1x1REUyOS1cdURFMzJcdURFMzQtXHVERTM3XHVERTM5XHVERTNCXHVERTQyXHVERTQ3XHVERTQ5XHVERTRCXHVERTRELVx1REU0Rlx1REU1MVx1REU1Mlx1REU1NFx1REU1N1x1REU1OVx1REU1Qlx1REU1RFx1REU1Rlx1REU2MVx1REU2Mlx1REU2NFx1REU2Ny1cdURFNkFcdURFNkMtXHVERTcyXHVERTc0LVx1REU3N1x1REU3OS1cdURFN0NcdURFN0VcdURFODAtXHVERTg5XHVERThCLVx1REU5Qlx1REVBMS1cdURFQTNcdURFQTUtXHVERUE5XHVERUFCLVx1REVCQlx1REVGMFx1REVGMV0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0FybWVuaWFuJywNCiAgICAgICAgJ2JtcCc6ICdcdTA1MzEtXHUwNTU2XHUwNTU5LVx1MDU4OFx1MDU4QVx1MDU4RC1cdTA1OEZcdUZCMTMtXHVGQjE3Jw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdBdmVzdGFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVERjAwLVx1REYzNVx1REYzOS1cdURGM0ZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdCYWxpbmVzZScsDQogICAgICAgICdibXAnOiAnXHUxQjAwLVx1MUI0Qlx1MUI1MC1cdTFCN0MnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0JhbXVtJywNCiAgICAgICAgJ2JtcCc6ICdcdUE2QTAtXHVBNkY3JywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MUFbXHVEQzAwLVx1REUzOF0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0Jhc3NhX1ZhaCcsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODFBW1x1REVEMC1cdURFRURcdURFRjAtXHVERUY1XScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnQmF0YWsnLA0KICAgICAgICAnYm1wJzogJ1x1MUJDMC1cdTFCRjNcdTFCRkMtXHUxQkZGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdCZW5nYWxpJywNCiAgICAgICAgJ2JtcCc6ICdcdTA5ODAtXHUwOTgzXHUwOTg1LVx1MDk4Q1x1MDk4Rlx1MDk5MFx1MDk5My1cdTA5QThcdTA5QUEtXHUwOUIwXHUwOUIyXHUwOUI2LVx1MDlCOVx1MDlCQy1cdTA5QzRcdTA5QzdcdTA5QzhcdTA5Q0ItXHUwOUNFXHUwOUQ3XHUwOURDXHUwOUREXHUwOURGLVx1MDlFM1x1MDlFNi1cdTA5RkUnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0JoYWlrc3VraScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA3W1x1REMwMC1cdURDMDhcdURDMEEtXHVEQzM2XHVEQzM4LVx1REM0NVx1REM1MC1cdURDNkNdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdCb3BvbW9mbycsDQogICAgICAgICdibXAnOiAnXHUwMkVBXHUwMkVCXHUzMTA1LVx1MzEyRlx1MzFBMC1cdTMxQkEnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0JyYWhtaScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA0W1x1REMwMC1cdURDNERcdURDNTItXHVEQzZGXHVEQzdGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnQnJhaWxsZScsDQogICAgICAgICdibXAnOiAnXHUyODAwLVx1MjhGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnQnVnaW5lc2UnLA0KICAgICAgICAnYm1wJzogJ1x1MUEwMC1cdTFBMUJcdTFBMUVcdTFBMUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0J1aGlkJywNCiAgICAgICAgJ2JtcCc6ICdcdTE3NDAtXHUxNzUzJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdDYW5hZGlhbl9BYm9yaWdpbmFsJywNCiAgICAgICAgJ2JtcCc6ICdcdTE0MDAtXHUxNjdGXHUxOEIwLVx1MThGNScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnQ2FyaWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERUEwLVx1REVEMF0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0NhdWNhc2lhbl9BbGJhbmlhbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAxW1x1REQzMC1cdURENjNcdURENkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdDaGFrbWEnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNFtcdUREMDAtXHVERDM0XHVERDM2LVx1REQ0Nl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0NoYW0nLA0KICAgICAgICAnYm1wJzogJ1x1QUEwMC1cdUFBMzZcdUFBNDAtXHVBQTREXHVBQTUwLVx1QUE1OVx1QUE1Qy1cdUFBNUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0NoZXJva2VlJywNCiAgICAgICAgJ2JtcCc6ICdcdTEzQTAtXHUxM0Y1XHUxM0Y4LVx1MTNGRFx1QUI3MC1cdUFCQkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0NvbW1vbicsDQogICAgICAgICdibXAnOiAnXDAtQFxcWy1gXFx7LVx4QTlceEFCLVx4QjlceEJCLVx4QkZceEQ3XHhGN1x1MDJCOS1cdTAyREZcdTAyRTUtXHUwMkU5XHUwMkVDLVx1MDJGRlx1MDM3NFx1MDM3RVx1MDM4NVx1MDM4N1x1MDU4OVx1MDYwNVx1MDYwQ1x1MDYxQlx1MDYxRlx1MDY0MFx1MDZERFx1MDhFMlx1MDk2NFx1MDk2NVx1MEUzRlx1MEZENS1cdTBGRDhcdTEwRkJcdTE2RUItXHUxNkVEXHUxNzM1XHUxNzM2XHUxODAyXHUxODAzXHUxODA1XHUxQ0QzXHUxQ0UxXHUxQ0U5LVx1MUNFQ1x1MUNFRS1cdTFDRjNcdTFDRjUtXHUxQ0Y3XHUyMDAwLVx1MjAwQlx1MjAwRS1cdTIwNjRcdTIwNjYtXHUyMDcwXHUyMDc0LVx1MjA3RVx1MjA4MC1cdTIwOEVcdTIwQTAtXHUyMEJGXHUyMTAwLVx1MjEyNVx1MjEyNy1cdTIxMjlcdTIxMkMtXHUyMTMxXHUyMTMzLVx1MjE0RFx1MjE0Ri1cdTIxNUZcdTIxODktXHUyMThCXHUyMTkwLVx1MjQyNlx1MjQ0MC1cdTI0NEFcdTI0NjAtXHUyN0ZGXHUyOTAwLVx1MkI3M1x1MkI3Ni1cdTJCOTVcdTJCOTgtXHUyQkM4XHUyQkNBLVx1MkJGRVx1MkUwMC1cdTJFNEVcdTJGRjAtXHUyRkZCXHUzMDAwLVx1MzAwNFx1MzAwNlx1MzAwOC1cdTMwMjBcdTMwMzAtXHUzMDM3XHUzMDNDLVx1MzAzRlx1MzA5Qlx1MzA5Q1x1MzBBMFx1MzBGQlx1MzBGQ1x1MzE5MC1cdTMxOUZcdTMxQzAtXHUzMUUzXHUzMjIwLVx1MzI1Rlx1MzI3Ri1cdTMyQ0ZcdTMzNTgtXHUzM0ZGXHU0REMwLVx1NERGRlx1QTcwMC1cdUE3MjFcdUE3ODgtXHVBNzhBXHVBODMwLVx1QTgzOVx1QTkyRVx1QTlDRlx1QUI1Qlx1RkQzRVx1RkQzRlx1RkUxMC1cdUZFMTlcdUZFMzAtXHVGRTUyXHVGRTU0LVx1RkU2Nlx1RkU2OC1cdUZFNkJcdUZFRkZcdUZGMDEtXHVGRjIwXHVGRjNCLVx1RkY0MFx1RkY1Qi1cdUZGNjVcdUZGNzBcdUZGOUVcdUZGOUZcdUZGRTAtXHVGRkU2XHVGRkU4LVx1RkZFRVx1RkZGOS1cdUZGRkQnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMFtcdUREMDAtXHVERDAyXHVERDA3LVx1REQzM1x1REQzNy1cdUREM0ZcdUREOTAtXHVERDlCXHVEREQwLVx1RERGQ1x1REVFMS1cdURFRkJdfFx1RDgyRltcdURDQTAtXHVEQ0EzXXxcdUQ4MzRbXHVEQzAwLVx1RENGNVx1REQwMC1cdUREMjZcdUREMjktXHVERDY2XHVERDZBLVx1REQ3QVx1REQ4M1x1REQ4NFx1REQ4Qy1cdUREQTlcdUREQUUtXHVEREU4XHVERUUwLVx1REVGM1x1REYwMC1cdURGNTZcdURGNjAtXHVERjc4XXxcdUQ4MzVbXHVEQzAwLVx1REM1NFx1REM1Ni1cdURDOUNcdURDOUVcdURDOUZcdURDQTJcdURDQTVcdURDQTZcdURDQTktXHVEQ0FDXHVEQ0FFLVx1RENCOVx1RENCQlx1RENCRC1cdURDQzNcdURDQzUtXHVERDA1XHVERDA3LVx1REQwQVx1REQwRC1cdUREMTRcdUREMTYtXHVERDFDXHVERDFFLVx1REQzOVx1REQzQi1cdUREM0VcdURENDAtXHVERDQ0XHVERDQ2XHVERDRBLVx1REQ1MFx1REQ1Mi1cdURFQTVcdURFQTgtXHVERkNCXHVERkNFLVx1REZGRl18XHVEODNCW1x1REM3MS1cdURDQjRdfFx1RDgzQ1tcdURDMDAtXHVEQzJCXHVEQzMwLVx1REM5M1x1RENBMC1cdURDQUVcdURDQjEtXHVEQ0JGXHVEQ0MxLVx1RENDRlx1RENEMS1cdURDRjVcdUREMDAtXHVERDBDXHVERDEwLVx1REQ2Qlx1REQ3MC1cdUREQUNcdURERTYtXHVEREZGXHVERTAxXHVERTAyXHVERTEwLVx1REUzQlx1REU0MC1cdURFNDhcdURFNTBcdURFNTFcdURFNjAtXHVERTY1XHVERjAwLVx1REZGRl18XHVEODNEW1x1REMwMC1cdURFRDRcdURFRTAtXHVERUVDXHVERUYwLVx1REVGOVx1REYwMC1cdURGNzNcdURGODAtXHVERkQ4XXxcdUQ4M0VbXHVEQzAwLVx1REMwQlx1REMxMC1cdURDNDdcdURDNTAtXHVEQzU5XHVEQzYwLVx1REM4N1x1REM5MC1cdURDQURcdUREMDAtXHVERDBCXHVERDEwLVx1REQzRVx1REQ0MC1cdURENzBcdURENzMtXHVERDc2XHVERDdBXHVERDdDLVx1RERBMlx1RERCMC1cdUREQjlcdUREQzAtXHVEREMyXHVEREQwLVx1RERGRlx1REU2MC1cdURFNkRdfFx1REI0MFtcdURDMDFcdURDMjAtXHVEQzdGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnQ29wdGljJywNCiAgICAgICAgJ2JtcCc6ICdcdTAzRTItXHUwM0VGXHUyQzgwLVx1MkNGM1x1MkNGOS1cdTJDRkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0N1bmVpZm9ybScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA4W1x1REMwMC1cdURGOTldfFx1RDgwOVtcdURDMDAtXHVEQzZFXHVEQzcwLVx1REM3NFx1REM4MC1cdURENDNdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdDeXByaW90JywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVEQzAwLVx1REMwNVx1REMwOFx1REMwQS1cdURDMzVcdURDMzdcdURDMzhcdURDM0NcdURDM0ZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdDeXJpbGxpYycsDQogICAgICAgICdibXAnOiAnXHUwNDAwLVx1MDQ4NFx1MDQ4Ny1cdTA1MkZcdTFDODAtXHUxQzg4XHUxRDJCXHUxRDc4XHUyREUwLVx1MkRGRlx1QTY0MC1cdUE2OUZcdUZFMkVcdUZFMkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0Rlc2VyZXQnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMVtcdURDMDAtXHVEQzRGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnRGV2YW5hZ2FyaScsDQogICAgICAgICdibXAnOiAnXHUwOTAwLVx1MDk1MFx1MDk1My1cdTA5NjNcdTA5NjYtXHUwOTdGXHVBOEUwLVx1QThGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnRG9ncmEnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNltcdURDMDAtXHVEQzNCXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnRHVwbG95YW4nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgyRltcdURDMDAtXHVEQzZBXHVEQzcwLVx1REM3Q1x1REM4MC1cdURDODhcdURDOTAtXHVEQzk5XHVEQzlDLVx1REM5Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0VneXB0aWFuX0hpZXJvZ2x5cGhzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MENbXHVEQzAwLVx1REZGRl18XHVEODBEW1x1REMwMC1cdURDMkVdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdFbGJhc2FuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDFbXHVERDAwLVx1REQyN10nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0V0aGlvcGljJywNCiAgICAgICAgJ2JtcCc6ICdcdTEyMDAtXHUxMjQ4XHUxMjRBLVx1MTI0RFx1MTI1MC1cdTEyNTZcdTEyNThcdTEyNUEtXHUxMjVEXHUxMjYwLVx1MTI4OFx1MTI4QS1cdTEyOERcdTEyOTAtXHUxMkIwXHUxMkIyLVx1MTJCNVx1MTJCOC1cdTEyQkVcdTEyQzBcdTEyQzItXHUxMkM1XHUxMkM4LVx1MTJENlx1MTJEOC1cdTEzMTBcdTEzMTItXHUxMzE1XHUxMzE4LVx1MTM1QVx1MTM1RC1cdTEzN0NcdTEzODAtXHUxMzk5XHUyRDgwLVx1MkQ5Nlx1MkRBMC1cdTJEQTZcdTJEQTgtXHUyREFFXHUyREIwLVx1MkRCNlx1MkRCOC1cdTJEQkVcdTJEQzAtXHUyREM2XHUyREM4LVx1MkRDRVx1MkREMC1cdTJERDZcdTJERDgtXHUyRERFXHVBQjAxLVx1QUIwNlx1QUIwOS1cdUFCMEVcdUFCMTEtXHVBQjE2XHVBQjIwLVx1QUIyNlx1QUIyOC1cdUFCMkUnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0dlb3JnaWFuJywNCiAgICAgICAgJ2JtcCc6ICdcdTEwQTAtXHUxMEM1XHUxMEM3XHUxMENEXHUxMEQwLVx1MTBGQVx1MTBGQy1cdTEwRkZcdTFDOTAtXHUxQ0JBXHUxQ0JELVx1MUNCRlx1MkQwMC1cdTJEMjVcdTJEMjdcdTJEMkQnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0dsYWdvbGl0aWMnLA0KICAgICAgICAnYm1wJzogJ1x1MkMwMC1cdTJDMkVcdTJDMzAtXHUyQzVFJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MzhbXHVEQzAwLVx1REMwNlx1REMwOC1cdURDMThcdURDMUItXHVEQzIxXHVEQzIzXHVEQzI0XHVEQzI2LVx1REMyQV0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0dvdGhpYycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAwW1x1REYzMC1cdURGNEFdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdHcmFudGhhJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDRbXHVERjAwLVx1REYwM1x1REYwNS1cdURGMENcdURGMEZcdURGMTBcdURGMTMtXHVERjI4XHVERjJBLVx1REYzMFx1REYzMlx1REYzM1x1REYzNS1cdURGMzlcdURGM0MtXHVERjQ0XHVERjQ3XHVERjQ4XHVERjRCLVx1REY0RFx1REY1MFx1REY1N1x1REY1RC1cdURGNjNcdURGNjYtXHVERjZDXHVERjcwLVx1REY3NF0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0dyZWVrJywNCiAgICAgICAgJ2JtcCc6ICdcdTAzNzAtXHUwMzczXHUwMzc1LVx1MDM3N1x1MDM3QS1cdTAzN0RcdTAzN0ZcdTAzODRcdTAzODZcdTAzODgtXHUwMzhBXHUwMzhDXHUwMzhFLVx1MDNBMVx1MDNBMy1cdTAzRTFcdTAzRjAtXHUwM0ZGXHUxRDI2LVx1MUQyQVx1MUQ1RC1cdTFENjFcdTFENjYtXHUxRDZBXHUxREJGXHUxRjAwLVx1MUYxNVx1MUYxOC1cdTFGMURcdTFGMjAtXHUxRjQ1XHUxRjQ4LVx1MUY0RFx1MUY1MC1cdTFGNTdcdTFGNTlcdTFGNUJcdTFGNURcdTFGNUYtXHUxRjdEXHUxRjgwLVx1MUZCNFx1MUZCNi1cdTFGQzRcdTFGQzYtXHUxRkQzXHUxRkQ2LVx1MUZEQlx1MUZERC1cdTFGRUZcdTFGRjItXHUxRkY0XHUxRkY2LVx1MUZGRVx1MjEyNlx1QUI2NScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAwW1x1REQ0MC1cdUREOEVcdUREQTBdfFx1RDgzNFtcdURFMDAtXHVERTQ1XScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnR3VqYXJhdGknLA0KICAgICAgICAnYm1wJzogJ1x1MEE4MS1cdTBBODNcdTBBODUtXHUwQThEXHUwQThGLVx1MEE5MVx1MEE5My1cdTBBQThcdTBBQUEtXHUwQUIwXHUwQUIyXHUwQUIzXHUwQUI1LVx1MEFCOVx1MEFCQy1cdTBBQzVcdTBBQzctXHUwQUM5XHUwQUNCLVx1MEFDRFx1MEFEMFx1MEFFMC1cdTBBRTNcdTBBRTYtXHUwQUYxXHUwQUY5LVx1MEFGRicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnR3VuamFsYV9Hb25kaScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA3W1x1REQ2MC1cdURENjVcdURENjdcdURENjhcdURENkEtXHVERDhFXHVERDkwXHVERDkxXHVERDkzLVx1REQ5OFx1RERBMC1cdUREQTldJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdHdXJtdWtoaScsDQogICAgICAgICdibXAnOiAnXHUwQTAxLVx1MEEwM1x1MEEwNS1cdTBBMEFcdTBBMEZcdTBBMTBcdTBBMTMtXHUwQTI4XHUwQTJBLVx1MEEzMFx1MEEzMlx1MEEzM1x1MEEzNVx1MEEzNlx1MEEzOFx1MEEzOVx1MEEzQ1x1MEEzRS1cdTBBNDJcdTBBNDdcdTBBNDhcdTBBNEItXHUwQTREXHUwQTUxXHUwQTU5LVx1MEE1Q1x1MEE1RVx1MEE2Ni1cdTBBNzYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0hhbicsDQogICAgICAgICdibXAnOiAnXHUyRTgwLVx1MkU5OVx1MkU5Qi1cdTJFRjNcdTJGMDAtXHUyRkQ1XHUzMDA1XHUzMDA3XHUzMDIxLVx1MzAyOVx1MzAzOC1cdTMwM0JcdTM0MDAtXHU0REI1XHU0RTAwLVx1OUZFRlx1RjkwMC1cdUZBNkRcdUZBNzAtXHVGQUQ5JywNCiAgICAgICAgJ2FzdHJhbCc6ICdbXHVEODQwLVx1RDg2OFx1RDg2QS1cdUQ4NkNcdUQ4NkYtXHVEODcyXHVEODc0LVx1RDg3OV1bXHVEQzAwLVx1REZGRl18XHVEODY5W1x1REMwMC1cdURFRDZcdURGMDAtXHVERkZGXXxcdUQ4NkRbXHVEQzAwLVx1REYzNFx1REY0MC1cdURGRkZdfFx1RDg2RVtcdURDMDAtXHVEQzFEXHVEQzIwLVx1REZGRl18XHVEODczW1x1REMwMC1cdURFQTFcdURFQjAtXHVERkZGXXxcdUQ4N0FbXHVEQzAwLVx1REZFMF18XHVEODdFW1x1REMwMC1cdURFMURdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdIYW5ndWwnLA0KICAgICAgICAnYm1wJzogJ1x1MTEwMC1cdTExRkZcdTMwMkVcdTMwMkZcdTMxMzEtXHUzMThFXHUzMjAwLVx1MzIxRVx1MzI2MC1cdTMyN0VcdUE5NjAtXHVBOTdDXHVBQzAwLVx1RDdBM1x1RDdCMC1cdUQ3QzZcdUQ3Q0ItXHVEN0ZCXHVGRkEwLVx1RkZCRVx1RkZDMi1cdUZGQzdcdUZGQ0EtXHVGRkNGXHVGRkQyLVx1RkZEN1x1RkZEQS1cdUZGREMnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0hhbmlmaV9Sb2hpbmd5YScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAzW1x1REQwMC1cdUREMjdcdUREMzAtXHVERDM5XScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSGFudW5vbycsDQogICAgICAgICdibXAnOiAnXHUxNzIwLVx1MTczNCcNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSGF0cmFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVEQ0UwLVx1RENGMlx1RENGNFx1RENGNVx1RENGQi1cdURDRkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdIZWJyZXcnLA0KICAgICAgICAnYm1wJzogJ1x1MDU5MS1cdTA1QzdcdTA1RDAtXHUwNUVBXHUwNUVGLVx1MDVGNFx1RkIxRC1cdUZCMzZcdUZCMzgtXHVGQjNDXHVGQjNFXHVGQjQwXHVGQjQxXHVGQjQzXHVGQjQ0XHVGQjQ2LVx1RkI0RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSGlyYWdhbmEnLA0KICAgICAgICAnYm1wJzogJ1x1MzA0MS1cdTMwOTZcdTMwOUQtXHUzMDlGJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MkNbXHVEQzAxLVx1REQxRV18XHVEODNDXHVERTAwJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbXBlcmlhbF9BcmFtYWljJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVEQzQwLVx1REM1NVx1REM1Ny1cdURDNUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdJbmhlcml0ZWQnLA0KICAgICAgICAnYm1wJzogJ1x1MDMwMC1cdTAzNkZcdTA0ODVcdTA0ODZcdTA2NEItXHUwNjU1XHUwNjcwXHUwOTUxXHUwOTUyXHUxQUIwLVx1MUFCRVx1MUNEMC1cdTFDRDJcdTFDRDQtXHUxQ0UwXHUxQ0UyLVx1MUNFOFx1MUNFRFx1MUNGNFx1MUNGOFx1MUNGOVx1MURDMC1cdTFERjlcdTFERkItXHUxREZGXHUyMDBDXHUyMDBEXHUyMEQwLVx1MjBGMFx1MzAyQS1cdTMwMkRcdTMwOTlcdTMwOUFcdUZFMDAtXHVGRTBGXHVGRTIwLVx1RkUyRCcsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAwW1x1RERGRFx1REVFMF18XHVEODA0XHVERjNCfFx1RDgzNFtcdURENjctXHVERDY5XHVERDdCLVx1REQ4Mlx1REQ4NS1cdUREOEJcdUREQUEtXHVEREFEXXxcdURCNDBbXHVERDAwLVx1RERFRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0luc2NyaXB0aW9uYWxfUGFobGF2aScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1REY2MC1cdURGNzJcdURGNzgtXHVERjdGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSW5zY3JpcHRpb25hbF9QYXJ0aGlhbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1REY0MC1cdURGNTVcdURGNTgtXHVERjVGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnSmF2YW5lc2UnLA0KICAgICAgICAnYm1wJzogJ1x1QTk4MC1cdUE5Q0RcdUE5RDAtXHVBOUQ5XHVBOURFXHVBOURGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdLYWl0aGknLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNFtcdURDODAtXHVEQ0MxXHVEQ0NEXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnS2FubmFkYScsDQogICAgICAgICdibXAnOiAnXHUwQzgwLVx1MEM4Q1x1MEM4RS1cdTBDOTBcdTBDOTItXHUwQ0E4XHUwQ0FBLVx1MENCM1x1MENCNS1cdTBDQjlcdTBDQkMtXHUwQ0M0XHUwQ0M2LVx1MENDOFx1MENDQS1cdTBDQ0RcdTBDRDVcdTBDRDZcdTBDREVcdTBDRTAtXHUwQ0UzXHUwQ0U2LVx1MENFRlx1MENGMVx1MENGMicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnS2F0YWthbmEnLA0KICAgICAgICAnYm1wJzogJ1x1MzBBMS1cdTMwRkFcdTMwRkQtXHUzMEZGXHUzMUYwLVx1MzFGRlx1MzJEMC1cdTMyRkVcdTMzMDAtXHUzMzU3XHVGRjY2LVx1RkY2Rlx1RkY3MS1cdUZGOUQnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgyQ1x1REMwMCcNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnS2F5YWhfTGknLA0KICAgICAgICAnYm1wJzogJ1x1QTkwMC1cdUE5MkRcdUE5MkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0toYXJvc2h0aGknLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMltcdURFMDAtXHVERTAzXHVERTA1XHVERTA2XHVERTBDLVx1REUxM1x1REUxNS1cdURFMTdcdURFMTktXHVERTM1XHVERTM4LVx1REUzQVx1REUzRi1cdURFNDhcdURFNTAtXHVERTU4XScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnS2htZXInLA0KICAgICAgICAnYm1wJzogJ1x1MTc4MC1cdTE3RERcdTE3RTAtXHUxN0U5XHUxN0YwLVx1MTdGOVx1MTlFMC1cdTE5RkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0tob2praScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA0W1x1REUwMC1cdURFMTFcdURFMTMtXHVERTNFXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnS2h1ZGF3YWRpJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDRbXHVERUIwLVx1REVFQVx1REVGMC1cdURFRjldJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdMYW8nLA0KICAgICAgICAnYm1wJzogJ1x1MEU4MVx1MEU4Mlx1MEU4NFx1MEU4N1x1MEU4OFx1MEU4QVx1MEU4RFx1MEU5NC1cdTBFOTdcdTBFOTktXHUwRTlGXHUwRUExLVx1MEVBM1x1MEVBNVx1MEVBN1x1MEVBQVx1MEVBQlx1MEVBRC1cdTBFQjlcdTBFQkItXHUwRUJEXHUwRUMwLVx1MEVDNFx1MEVDNlx1MEVDOC1cdTBFQ0RcdTBFRDAtXHUwRUQ5XHUwRURDLVx1MEVERicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTGF0aW4nLA0KICAgICAgICAnYm1wJzogJ0EtWmEtelx4QUFceEJBXHhDMC1ceEQ2XHhEOC1ceEY2XHhGOC1cdTAyQjhcdTAyRTAtXHUwMkU0XHUxRDAwLVx1MUQyNVx1MUQyQy1cdTFENUNcdTFENjItXHUxRDY1XHUxRDZCLVx1MUQ3N1x1MUQ3OS1cdTFEQkVcdTFFMDAtXHUxRUZGXHUyMDcxXHUyMDdGXHUyMDkwLVx1MjA5Q1x1MjEyQVx1MjEyQlx1MjEzMlx1MjE0RVx1MjE2MC1cdTIxODhcdTJDNjAtXHUyQzdGXHVBNzIyLVx1QTc4N1x1QTc4Qi1cdUE3QjlcdUE3RjctXHVBN0ZGXHVBQjMwLVx1QUI1QVx1QUI1Qy1cdUFCNjRcdUZCMDAtXHVGQjA2XHVGRjIxLVx1RkYzQVx1RkY0MS1cdUZGNUEnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0xlcGNoYScsDQogICAgICAgICdibXAnOiAnXHUxQzAwLVx1MUMzN1x1MUMzQi1cdTFDNDlcdTFDNEQtXHUxQzRGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdMaW1idScsDQogICAgICAgICdibXAnOiAnXHUxOTAwLVx1MTkxRVx1MTkyMC1cdTE5MkJcdTE5MzAtXHUxOTNCXHUxOTQwXHUxOTQ0LVx1MTk0RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTGluZWFyX0EnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMVtcdURFMDAtXHVERjM2XHVERjQwLVx1REY1NVx1REY2MC1cdURGNjddJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdMaW5lYXJfQicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAwW1x1REMwMC1cdURDMEJcdURDMEQtXHVEQzI2XHVEQzI4LVx1REMzQVx1REMzQ1x1REMzRFx1REMzRi1cdURDNERcdURDNTAtXHVEQzVEXHVEQzgwLVx1RENGQV0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0xpc3UnLA0KICAgICAgICAnYm1wJzogJ1x1QTREMC1cdUE0RkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ0x5Y2lhbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAwW1x1REU4MC1cdURFOUNdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdMeWRpYW4nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMltcdUREMjAtXHVERDM5XHVERDNGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTWFoYWphbmknLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNFtcdURENTAtXHVERDc2XScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTWFrYXNhcicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA3W1x1REVFMC1cdURFRjhdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdNYWxheWFsYW0nLA0KICAgICAgICAnYm1wJzogJ1x1MEQwMC1cdTBEMDNcdTBEMDUtXHUwRDBDXHUwRDBFLVx1MEQxMFx1MEQxMi1cdTBENDRcdTBENDYtXHUwRDQ4XHUwRDRBLVx1MEQ0Rlx1MEQ1NC1cdTBENjNcdTBENjYtXHUwRDdGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdNYW5kYWljJywNCiAgICAgICAgJ2JtcCc6ICdcdTA4NDAtXHUwODVCXHUwODVFJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdNYW5pY2hhZWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVERUMwLVx1REVFNlx1REVFQi1cdURFRjZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdNYXJjaGVuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDdbXHVEQzcwLVx1REM4Rlx1REM5Mi1cdURDQTdcdURDQTktXHVEQ0I2XScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTWFzYXJhbV9Hb25kaScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA3W1x1REQwMC1cdUREMDZcdUREMDhcdUREMDlcdUREMEItXHVERDM2XHVERDNBXHVERDNDXHVERDNEXHVERDNGLVx1REQ0N1x1REQ1MC1cdURENTldJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdNZWRlZmFpZHJpbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODFCW1x1REU0MC1cdURFOUFdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdNZWV0ZWlfTWF5ZWsnLA0KICAgICAgICAnYm1wJzogJ1x1QUFFMC1cdUFBRjZcdUFCQzAtXHVBQkVEXHVBQkYwLVx1QUJGOScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTWVuZGVfS2lrYWt1aScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODNBW1x1REMwMC1cdURDQzRcdURDQzctXHVEQ0Q2XScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTWVyb2l0aWNfQ3Vyc2l2ZScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1RERBMC1cdUREQjdcdUREQkMtXHVERENGXHVEREQyLVx1RERGRl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ01lcm9pdGljX0hpZXJvZ2x5cGhzJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVERDgwLVx1REQ5Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ01pYW8nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgxQltcdURGMDAtXHVERjQ0XHVERjUwLVx1REY3RVx1REY4Ri1cdURGOUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdNb2RpJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDVbXHVERTAwLVx1REU0NFx1REU1MC1cdURFNTldJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdNb25nb2xpYW4nLA0KICAgICAgICAnYm1wJzogJ1x1MTgwMFx1MTgwMVx1MTgwNFx1MTgwNi1cdTE4MEVcdTE4MTAtXHUxODE5XHUxODIwLVx1MTg3OFx1MTg4MC1cdTE4QUEnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNVtcdURFNjAtXHVERTZDXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTXJvJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MUFbXHVERTQwLVx1REU1RVx1REU2MC1cdURFNjlcdURFNkVcdURFNkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdNdWx0YW5pJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDRbXHVERTgwLVx1REU4Nlx1REU4OFx1REU4QS1cdURFOERcdURFOEYtXHVERTlEXHVERTlGLVx1REVBOV0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ015YW5tYXInLA0KICAgICAgICAnYm1wJzogJ1x1MTAwMC1cdTEwOUZcdUE5RTAtXHVBOUZFXHVBQTYwLVx1QUE3RicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnTmFiYXRhZWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDJbXHVEQzgwLVx1REM5RVx1RENBNy1cdURDQUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdOZXdfVGFpX0x1ZScsDQogICAgICAgICdibXAnOiAnXHUxOTgwLVx1MTlBQlx1MTlCMC1cdTE5QzlcdTE5RDAtXHUxOURBXHUxOURFXHUxOURGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdOZXdhJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDVbXHVEQzAwLVx1REM1OVx1REM1Qlx1REM1RFx1REM1RV0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ05rbycsDQogICAgICAgICdibXAnOiAnXHUwN0MwLVx1MDdGQVx1MDdGRC1cdTA3RkYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ051c2h1JywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MUJcdURGRTF8XHVEODJDW1x1REQ3MC1cdURFRkJdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdPZ2hhbScsDQogICAgICAgICdibXAnOiAnXHUxNjgwLVx1MTY5QycNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnT2xfQ2hpa2knLA0KICAgICAgICAnYm1wJzogJ1x1MUM1MC1cdTFDN0YnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ09sZF9IdW5nYXJpYW4nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwM1tcdURDODAtXHVEQ0IyXHVEQ0MwLVx1RENGMlx1RENGQS1cdURDRkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdPbGRfSXRhbGljJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERjAwLVx1REYyM1x1REYyRC1cdURGMkZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdPbGRfTm9ydGhfQXJhYmlhbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1REU4MC1cdURFOUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdPbGRfUGVybWljJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERjUwLVx1REY3QV0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ09sZF9QZXJzaWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERkEwLVx1REZDM1x1REZDOC1cdURGRDVdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdPbGRfU29nZGlhbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAzW1x1REYwMC1cdURGMjddJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdPbGRfU291dGhfQXJhYmlhbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1REU2MC1cdURFN0ZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdPbGRfVHVya2ljJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDNbXHVEQzAwLVx1REM0OF0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ09yaXlhJywNCiAgICAgICAgJ2JtcCc6ICdcdTBCMDEtXHUwQjAzXHUwQjA1LVx1MEIwQ1x1MEIwRlx1MEIxMFx1MEIxMy1cdTBCMjhcdTBCMkEtXHUwQjMwXHUwQjMyXHUwQjMzXHUwQjM1LVx1MEIzOVx1MEIzQy1cdTBCNDRcdTBCNDdcdTBCNDhcdTBCNEItXHUwQjREXHUwQjU2XHUwQjU3XHUwQjVDXHUwQjVEXHUwQjVGLVx1MEI2M1x1MEI2Ni1cdTBCNzcnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ09zYWdlJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDFbXHVEQ0IwLVx1RENEM1x1RENEOC1cdURDRkJdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdPc21hbnlhJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDFbXHVEQzgwLVx1REM5RFx1RENBMC1cdURDQTldJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdQYWhhd2hfSG1vbmcnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgxQVtcdURGMDAtXHVERjQ1XHVERjUwLVx1REY1OVx1REY1Qi1cdURGNjFcdURGNjMtXHVERjc3XHVERjdELVx1REY4Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1BhbG15cmVuZScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1REM2MC1cdURDN0ZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdQYXVfQ2luX0hhdScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA2W1x1REVDMC1cdURFRjhdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdQaGFnc19QYScsDQogICAgICAgICdibXAnOiAnXHVBODQwLVx1QTg3NycNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnUGhvZW5pY2lhbicsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODAyW1x1REQwMC1cdUREMUJcdUREMUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdQc2FsdGVyX1BhaGxhdmknLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMltcdURGODAtXHVERjkxXHVERjk5LVx1REY5Q1x1REZBOS1cdURGQUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdSZWphbmcnLA0KICAgICAgICAnYm1wJzogJ1x1QTkzMC1cdUE5NTNcdUE5NUYnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1J1bmljJywNCiAgICAgICAgJ2JtcCc6ICdcdTE2QTAtXHUxNkVBXHUxNkVFLVx1MTZGOCcNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnU2FtYXJpdGFuJywNCiAgICAgICAgJ2JtcCc6ICdcdTA4MDAtXHUwODJEXHUwODMwLVx1MDgzRScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnU2F1cmFzaHRyYScsDQogICAgICAgICdibXAnOiAnXHVBODgwLVx1QThDNVx1QThDRS1cdUE4RDknDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1NoYXJhZGEnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNFtcdUREODAtXHVERENEXHVEREQwLVx1RERERl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1NoYXZpYW4nLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwMVtcdURDNTAtXHVEQzdGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnU2lkZGhhbScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA1W1x1REQ4MC1cdUREQjVcdUREQjgtXHVEREREXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnU2lnbldyaXRpbmcnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgzNltcdURDMDAtXHVERThCXHVERTlCLVx1REU5Rlx1REVBMS1cdURFQUZdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdTaW5oYWxhJywNCiAgICAgICAgJ2JtcCc6ICdcdTBEODJcdTBEODNcdTBEODUtXHUwRDk2XHUwRDlBLVx1MERCMVx1MERCMy1cdTBEQkJcdTBEQkRcdTBEQzAtXHUwREM2XHUwRENBXHUwRENGLVx1MERENFx1MERENlx1MEREOC1cdTBEREZcdTBERTYtXHUwREVGXHUwREYyLVx1MERGNCcsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA0W1x1RERFMS1cdURERjRdJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdTb2dkaWFuJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDNbXHVERjMwLVx1REY1OV0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1NvcmFfU29tcGVuZycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA0W1x1RENEMC1cdURDRThcdURDRjAtXHVEQ0Y5XScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnU295b21ibycsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA2W1x1REU1MC1cdURFODNcdURFODYtXHVERUEyXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnU3VuZGFuZXNlJywNCiAgICAgICAgJ2JtcCc6ICdcdTFCODAtXHUxQkJGXHUxQ0MwLVx1MUNDNycNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnU3lsb3RpX05hZ3JpJywNCiAgICAgICAgJ2JtcCc6ICdcdUE4MDAtXHVBODJCJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdTeXJpYWMnLA0KICAgICAgICAnYm1wJzogJ1x1MDcwMC1cdTA3MERcdTA3MEYtXHUwNzRBXHUwNzRELVx1MDc0Rlx1MDg2MC1cdTA4NkEnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1RhZ2Fsb2cnLA0KICAgICAgICAnYm1wJzogJ1x1MTcwMC1cdTE3MENcdTE3MEUtXHUxNzE0Jw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdUYWdiYW53YScsDQogICAgICAgICdibXAnOiAnXHUxNzYwLVx1MTc2Q1x1MTc2RS1cdTE3NzBcdTE3NzJcdTE3NzMnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1RhaV9MZScsDQogICAgICAgICdibXAnOiAnXHUxOTUwLVx1MTk2RFx1MTk3MC1cdTE5NzQnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1RhaV9UaGFtJywNCiAgICAgICAgJ2JtcCc6ICdcdTFBMjAtXHUxQTVFXHUxQTYwLVx1MUE3Q1x1MUE3Ri1cdTFBODlcdTFBOTAtXHUxQTk5XHUxQUEwLVx1MUFBRCcNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnVGFpX1ZpZXQnLA0KICAgICAgICAnYm1wJzogJ1x1QUE4MC1cdUFBQzJcdUFBREItXHVBQURGJw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdUYWtyaScsDQogICAgICAgICdhc3RyYWwnOiAnXHVEODA1W1x1REU4MC1cdURFQjdcdURFQzAtXHVERUM5XScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnVGFtaWwnLA0KICAgICAgICAnYm1wJzogJ1x1MEI4Mlx1MEI4M1x1MEI4NS1cdTBCOEFcdTBCOEUtXHUwQjkwXHUwQjkyLVx1MEI5NVx1MEI5OVx1MEI5QVx1MEI5Q1x1MEI5RVx1MEI5Rlx1MEJBM1x1MEJBNFx1MEJBOC1cdTBCQUFcdTBCQUUtXHUwQkI5XHUwQkJFLVx1MEJDMlx1MEJDNi1cdTBCQzhcdTBCQ0EtXHUwQkNEXHUwQkQwXHUwQkQ3XHUwQkU2LVx1MEJGQScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnVGFuZ3V0JywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MUJcdURGRTB8W1x1RDgxQy1cdUQ4MjBdW1x1REMwMC1cdURGRkZdfFx1RDgyMVtcdURDMDAtXHVERkYxXXxcdUQ4MjJbXHVEQzAwLVx1REVGMl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1RlbHVndScsDQogICAgICAgICdibXAnOiAnXHUwQzAwLVx1MEMwQ1x1MEMwRS1cdTBDMTBcdTBDMTItXHUwQzI4XHUwQzJBLVx1MEMzOVx1MEMzRC1cdTBDNDRcdTBDNDYtXHUwQzQ4XHUwQzRBLVx1MEM0RFx1MEM1NVx1MEM1Nlx1MEM1OC1cdTBDNUFcdTBDNjAtXHUwQzYzXHUwQzY2LVx1MEM2Rlx1MEM3OC1cdTBDN0YnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1RoYWFuYScsDQogICAgICAgICdibXAnOiAnXHUwNzgwLVx1MDdCMScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnVGhhaScsDQogICAgICAgICdibXAnOiAnXHUwRTAxLVx1MEUzQVx1MEU0MC1cdTBFNUInDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1RpYmV0YW4nLA0KICAgICAgICAnYm1wJzogJ1x1MEYwMC1cdTBGNDdcdTBGNDktXHUwRjZDXHUwRjcxLVx1MEY5N1x1MEY5OS1cdTBGQkNcdTBGQkUtXHUwRkNDXHUwRkNFLVx1MEZENFx1MEZEOVx1MEZEQScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnVGlmaW5hZ2gnLA0KICAgICAgICAnYm1wJzogJ1x1MkQzMC1cdTJENjdcdTJENkZcdTJENzBcdTJEN0YnDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1Rpcmh1dGEnLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNVtcdURDODAtXHVEQ0M3XHVEQ0QwLVx1RENEOV0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1VnYXJpdGljJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDBbXHVERjgwLVx1REY5RFx1REY5Rl0nDQogICAgfSwNCiAgICB7DQogICAgICAgICduYW1lJzogJ1ZhaScsDQogICAgICAgICdibXAnOiAnXHVBNTAwLVx1QTYyQicNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnV2FyYW5nX0NpdGknLA0KICAgICAgICAnYXN0cmFsJzogJ1x1RDgwNltcdURDQTAtXHVEQ0YyXHVEQ0ZGXScNCiAgICB9LA0KICAgIHsNCiAgICAgICAgJ25hbWUnOiAnWWknLA0KICAgICAgICAnYm1wJzogJ1x1QTAwMC1cdUE0OENcdUE0OTAtXHVBNEM2Jw0KICAgIH0sDQogICAgew0KICAgICAgICAnbmFtZSc6ICdaYW5hYmF6YXJfU3F1YXJlJywNCiAgICAgICAgJ2FzdHJhbCc6ICdcdUQ4MDZbXHVERTAwLVx1REU0N10nDQogICAgfQ0KXTsNCg0KfSx7fV19LHt9LFs4XSkoOCkNCn0pOw0K",
        "IWZ1bmN0aW9uKGUsdCl7Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzJiYidW5kZWZpbmVkIiE9dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz10KCk6ImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUodCk6KGU9ZXx8c2VsZikuTWljcm9Nb2RhbD10KCl9KHRoaXMsZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7cmV0dXJuKCgpPT57Y29uc3QgZT1bImFbaHJlZl0iLCJhcmVhW2hyZWZdIiwnaW5wdXQ6bm90KFtkaXNhYmxlZF0pOm5vdChbdHlwZT0iaGlkZGVuIl0pOm5vdChbYXJpYS1oaWRkZW5dKScsInNlbGVjdDpub3QoW2Rpc2FibGVkXSk6bm90KFthcmlhLWhpZGRlbl0pIiwidGV4dGFyZWE6bm90KFtkaXNhYmxlZF0pOm5vdChbYXJpYS1oaWRkZW5dKSIsImJ1dHRvbjpub3QoW2Rpc2FibGVkXSk6bm90KFthcmlhLWhpZGRlbl0pIiwiaWZyYW1lIiwib2JqZWN0IiwiZW1iZWQiLCJbY29udGVudGVkaXRhYmxlXSIsJ1t0YWJpbmRleF06bm90KFt0YWJpbmRleF49Ii0iXSknXTtjbGFzcyB0e2NvbnN0cnVjdG9yKHt0YXJnZXRNb2RhbDplLHRyaWdnZXJzOnQ9W10sb25TaG93Om89KCgpPT57fSksb25DbG9zZTppPSgoKT0+e30pLG9wZW5UcmlnZ2VyOm49ImRhdGEtbWljcm9tb2RhbC10cmlnZ2VyIixjbG9zZVRyaWdnZXI6cz0iZGF0YS1taWNyb21vZGFsLWNsb3NlIixkaXNhYmxlU2Nyb2xsOmE9ITEsZGlzYWJsZUZvY3VzOmw9ITEsYXdhaXRDbG9zZUFuaW1hdGlvbjpkPSExLGF3YWl0T3BlbkFuaW1hdGlvbjpyPSExLGRlYnVnTW9kZTpjPSExfSl7dGhpcy5tb2RhbD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChlKSx0aGlzLmNvbmZpZz17ZGVidWdNb2RlOmMsZGlzYWJsZVNjcm9sbDphLG9wZW5UcmlnZ2VyOm4sY2xvc2VUcmlnZ2VyOnMsb25TaG93Om8sb25DbG9zZTppLGF3YWl0Q2xvc2VBbmltYXRpb246ZCxhd2FpdE9wZW5BbmltYXRpb246cixkaXNhYmxlRm9jdXM6bH0sdC5sZW5ndGg+MCYmdGhpcy5yZWdpc3RlclRyaWdnZXJzKC4uLnQpLHRoaXMub25DbGljaz10aGlzLm9uQ2xpY2suYmluZCh0aGlzKSx0aGlzLm9uS2V5ZG93bj10aGlzLm9uS2V5ZG93bi5iaW5kKHRoaXMpfXJlZ2lzdGVyVHJpZ2dlcnMoLi4uZSl7ZS5maWx0ZXIoQm9vbGVhbikuZm9yRWFjaChlPT57ZS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsZT0+dGhpcy5zaG93TW9kYWwoZSkpfSl9c2hvd01vZGFsKCl7aWYodGhpcy5hY3RpdmVFbGVtZW50PWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQsdGhpcy5tb2RhbC5zZXRBdHRyaWJ1dGUoImFyaWEtaGlkZGVuIiwiZmFsc2UiKSx0aGlzLm1vZGFsLmNsYXNzTGlzdC5hZGQoImlzLW9wZW4iKSx0aGlzLnNjcm9sbEJlaGF2aW91cigiZGlzYWJsZSIpLHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnMoKSx0aGlzLmNvbmZpZy5hd2FpdE9wZW5BbmltYXRpb24pe2NvbnN0IGU9KCk9Pnt0aGlzLm1vZGFsLnJlbW92ZUV2ZW50TGlzdGVuZXIoImFuaW1hdGlvbmVuZCIsZSwhMSksdGhpcy5zZXRGb2N1c1RvRmlyc3ROb2RlKCl9O3RoaXMubW9kYWwuYWRkRXZlbnRMaXN0ZW5lcigiYW5pbWF0aW9uZW5kIixlLCExKX1lbHNlIHRoaXMuc2V0Rm9jdXNUb0ZpcnN0Tm9kZSgpO3RoaXMuY29uZmlnLm9uU2hvdyh0aGlzLm1vZGFsLHRoaXMuYWN0aXZlRWxlbWVudCl9Y2xvc2VNb2RhbCgpe2NvbnN0IGU9dGhpcy5tb2RhbDt0aGlzLm1vZGFsLnNldEF0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iLCJ0cnVlIiksdGhpcy5yZW1vdmVFdmVudExpc3RlbmVycygpLHRoaXMuc2Nyb2xsQmVoYXZpb3VyKCJlbmFibGUiKSx0aGlzLmFjdGl2ZUVsZW1lbnQmJnRoaXMuYWN0aXZlRWxlbWVudC5mb2N1cygpLHRoaXMuY29uZmlnLm9uQ2xvc2UodGhpcy5tb2RhbCksdGhpcy5jb25maWcuYXdhaXRDbG9zZUFuaW1hdGlvbj90aGlzLm1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoImFuaW1hdGlvbmVuZCIsZnVuY3Rpb24gdCgpe2UuY2xhc3NMaXN0LnJlbW92ZSgiaXMtb3BlbiIpLGUucmVtb3ZlRXZlbnRMaXN0ZW5lcigiYW5pbWF0aW9uZW5kIix0LCExKX0sITEpOmUuY2xhc3NMaXN0LnJlbW92ZSgiaXMtb3BlbiIpfWNsb3NlTW9kYWxCeUlkKGUpe3RoaXMubW9kYWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSksdGhpcy5tb2RhbCYmdGhpcy5jbG9zZU1vZGFsKCl9c2Nyb2xsQmVoYXZpb3VyKGUpe2lmKCF0aGlzLmNvbmZpZy5kaXNhYmxlU2Nyb2xsKXJldHVybjtjb25zdCB0PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImJvZHkiKTtzd2l0Y2goZSl7Y2FzZSJlbmFibGUiOk9iamVjdC5hc3NpZ24odC5zdHlsZSx7b3ZlcmZsb3c6IiIsaGVpZ2h0OiIifSk7YnJlYWs7Y2FzZSJkaXNhYmxlIjpPYmplY3QuYXNzaWduKHQuc3R5bGUse292ZXJmbG93OiJoaWRkZW4iLGhlaWdodDoiMTAwdmgifSl9fWFkZEV2ZW50TGlzdGVuZXJzKCl7dGhpcy5tb2RhbC5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaHN0YXJ0Iix0aGlzLm9uQ2xpY2spLHRoaXMubW9kYWwuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLHRoaXMub25DbGljayksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsdGhpcy5vbktleWRvd24pfXJlbW92ZUV2ZW50TGlzdGVuZXJzKCl7dGhpcy5tb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKCJ0b3VjaHN0YXJ0Iix0aGlzLm9uQ2xpY2spLHRoaXMubW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xpY2siLHRoaXMub25DbGljayksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsdGhpcy5vbktleWRvd24pfW9uQ2xpY2soZSl7ZS50YXJnZXQuaGFzQXR0cmlidXRlKHRoaXMuY29uZmlnLmNsb3NlVHJpZ2dlcikmJih0aGlzLmNsb3NlTW9kYWwoKSxlLnByZXZlbnREZWZhdWx0KCkpfW9uS2V5ZG93bihlKXsyNz09PWUua2V5Q29kZSYmdGhpcy5jbG9zZU1vZGFsKGUpLDk9PT1lLmtleUNvZGUmJnRoaXMubWFpbnRhaW5Gb2N1cyhlKX1nZXRGb2N1c2FibGVOb2Rlcygpe2NvbnN0IHQ9dGhpcy5tb2RhbC5xdWVyeVNlbGVjdG9yQWxsKGUpO3JldHVybiBBcnJheSguLi50KX1zZXRGb2N1c1RvRmlyc3ROb2RlKCl7aWYodGhpcy5jb25maWcuZGlzYWJsZUZvY3VzKXJldHVybjtjb25zdCBlPXRoaXMuZ2V0Rm9jdXNhYmxlTm9kZXMoKTtlLmxlbmd0aCYmZVswXS5mb2N1cygpfW1haW50YWluRm9jdXMoZSl7Y29uc3QgdD10aGlzLmdldEZvY3VzYWJsZU5vZGVzKCk7aWYodGhpcy5tb2RhbC5jb250YWlucyhkb2N1bWVudC5hY3RpdmVFbGVtZW50KSl7Y29uc3Qgbz10LmluZGV4T2YoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCk7ZS5zaGlmdEtleSYmMD09PW8mJih0W3QubGVuZ3RoLTFdLmZvY3VzKCksZS5wcmV2ZW50RGVmYXVsdCgpKSxlLnNoaWZ0S2V5fHxvIT09dC5sZW5ndGgtMXx8KHRbMF0uZm9jdXMoKSxlLnByZXZlbnREZWZhdWx0KCkpfWVsc2UgdFswXS5mb2N1cygpfX1sZXQgbz1udWxsO2NvbnN0IGk9ZT0+e2lmKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlKSlyZXR1cm4gY29uc29sZS53YXJuKGBNaWNyb01vZGFsOiDinZdTZWVtcyBsaWtlIHlvdSBoYXZlIG1pc3NlZCAlYycke2V9J2AsImJhY2tncm91bmQtY29sb3I6ICNmOGY5ZmE7Y29sb3I6ICM1MDU5NmM7Zm9udC13ZWlnaHQ6IGJvbGQ7IiwiSUQgc29tZXdoZXJlIGluIHlvdXIgY29kZS4gUmVmZXIgZXhhbXBsZSBiZWxvdyB0byByZXNvbHZlIGl0LiIpLGNvbnNvbGUud2FybigiJWNFeGFtcGxlOiIsImJhY2tncm91bmQtY29sb3I6ICNmOGY5ZmE7Y29sb3I6ICM1MDU5NmM7Zm9udC13ZWlnaHQ6IGJvbGQ7IixgPGRpdiBjbGFzcz0ibW9kYWwiIGlkPSIke2V9Ij48L2Rpdj5gKSwhMX0sbj0oZSx0KT0+e2lmKChlPT57aWYoZS5sZW5ndGg8PTApY29uc29sZS53YXJuKCJNaWNyb01vZGFsOiDinZdQbGVhc2Ugc3BlY2lmeSBhdCBsZWFzdCBvbmUgJWMnbWljcm9tb2RhbC10cmlnZ2VyJyIsImJhY2tncm91bmQtY29sb3I6ICNmOGY5ZmE7Y29sb3I6ICM1MDU5NmM7Zm9udC13ZWlnaHQ6IGJvbGQ7IiwiZGF0YSBhdHRyaWJ1dGUuIiksY29uc29sZS53YXJuKCIlY0V4YW1wbGU6IiwiYmFja2dyb3VuZC1jb2xvcjogI2Y4ZjlmYTtjb2xvcjogIzUwNTk2Yztmb250LXdlaWdodDogYm9sZDsiLCc8YSBocmVmPSIjIiBkYXRhLW1pY3JvbW9kYWwtdHJpZ2dlcj0ibXktbW9kYWwiPjwvYT4nKX0pKGUpLCF0KXJldHVybiEwO2Zvcih2YXIgbyBpbiB0KWkobyk7cmV0dXJuITB9O3JldHVybntpbml0OmU9Pntjb25zdCBpPU9iamVjdC5hc3NpZ24oe30se29wZW5UcmlnZ2VyOiJkYXRhLW1pY3JvbW9kYWwtdHJpZ2dlciJ9LGUpLHM9Wy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYFske2kub3BlblRyaWdnZXJ9XWApXSxhPSgoZSx0KT0+e2NvbnN0IG89W107cmV0dXJuIGUuZm9yRWFjaChlPT57Y29uc3QgaT1lLmF0dHJpYnV0ZXNbdF0udmFsdWU7dm9pZCAwPT09b1tpXSYmKG9baV09W10pLG9baV0ucHVzaChlKX0pLG99KShzLGkub3BlblRyaWdnZXIpO2lmKCEwIT09aS5kZWJ1Z01vZGV8fCExIT09bihzLGEpKWZvcih2YXIgbCBpbiBhKXtsZXQgZT1hW2xdO2kudGFyZ2V0TW9kYWw9bCxpLnRyaWdnZXJzPVsuLi5lXSxvPW5ldyB0KGkpfX0sc2hvdzooZSxuKT0+e2NvbnN0IHM9bnx8e307cy50YXJnZXRNb2RhbD1lLCEwPT09cy5kZWJ1Z01vZGUmJiExPT09aShlKXx8KG89bmV3IHQocykpLnNob3dNb2RhbCgpfSxjbG9zZTplPT57ZT9vLmNsb3NlTW9kYWxCeUlkKGUpOm8uY2xvc2VNb2RhbCgpfX19KSgpfSk7DQo=",
        "LyohCiogc3dlZXRhbGVydDIgdjguMTQuMAoqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4KKi8KKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHsKCXR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpIDoKCXR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6CgkoZ2xvYmFsLlN3ZWV0YWxlcnQyID0gZmFjdG9yeSgpKTsKfSh0aGlzLCAoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogIGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gKG9iaikgewogICAgICByZXR1cm4gdHlwZW9mIG9iajsKICAgIH07CiAgfSBlbHNlIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiAob2JqKSB7CiAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7CiAgICB9OwogIH0KCiAgcmV0dXJuIF90eXBlb2Yob2JqKTsKfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICB9Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwogICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwogICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CiAgfQp9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CiAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogIHJldHVybiBDb25zdHJ1Y3RvcjsKfQoKZnVuY3Rpb24gX2V4dGVuZHMoKSB7CiAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsKICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07CgogICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsKICAgICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRhcmdldDsKICB9OwoKICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7CiAgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7CiAgfQoKICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsKICAgIGNvbnN0cnVjdG9yOiB7CiAgICAgIHZhbHVlOiBzdWJDbGFzcywKICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgfQogIH0pOwogIGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOwp9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOwogIH07CiAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsKfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICAgIG8uX19wcm90b19fID0gcDsKICAgIHJldHVybiBvOwogIH07CgogIHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7Cn0KCmZ1bmN0aW9uIGlzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsKICBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOwogIGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7CiAgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7CgogIHRyeSB7CiAgICBEYXRlLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKFJlZmxlY3QuY29uc3RydWN0KERhdGUsIFtdLCBmdW5jdGlvbiAoKSB7fSkpOwogICAgcmV0dXJuIHRydWU7CiAgfSBjYXRjaCAoZSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gX2NvbnN0cnVjdChQYXJlbnQsIGFyZ3MsIENsYXNzKSB7CiAgaWYgKGlzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpKSB7CiAgICBfY29uc3RydWN0ID0gUmVmbGVjdC5jb25zdHJ1Y3Q7CiAgfSBlbHNlIHsKICAgIF9jb25zdHJ1Y3QgPSBmdW5jdGlvbiBfY29uc3RydWN0KFBhcmVudCwgYXJncywgQ2xhc3MpIHsKICAgICAgdmFyIGEgPSBbbnVsbF07CiAgICAgIGEucHVzaC5hcHBseShhLCBhcmdzKTsKICAgICAgdmFyIENvbnN0cnVjdG9yID0gRnVuY3Rpb24uYmluZC5hcHBseShQYXJlbnQsIGEpOwogICAgICB2YXIgaW5zdGFuY2UgPSBuZXcgQ29uc3RydWN0b3IoKTsKICAgICAgaWYgKENsYXNzKSBfc2V0UHJvdG90eXBlT2YoaW5zdGFuY2UsIENsYXNzLnByb3RvdHlwZSk7CiAgICAgIHJldHVybiBpbnN0YW5jZTsKICAgIH07CiAgfQoKICByZXR1cm4gX2NvbnN0cnVjdC5hcHBseShudWxsLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsKICBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIHNlbGY7Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgewogICAgcmV0dXJuIGNhbGw7CiAgfQoKICByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsKfQoKZnVuY3Rpb24gX3N1cGVyUHJvcEJhc2Uob2JqZWN0LCBwcm9wZXJ0eSkgewogIHdoaWxlICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpKSB7CiAgICBvYmplY3QgPSBfZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsKICAgIGlmIChvYmplY3QgPT09IG51bGwpIGJyZWFrOwogIH0KCiAgcmV0dXJuIG9iamVjdDsKfQoKZnVuY3Rpb24gX2dldCh0YXJnZXQsIHByb3BlcnR5LCByZWNlaXZlcikgewogIGlmICh0eXBlb2YgUmVmbGVjdCAhPT0gInVuZGVmaW5lZCIgJiYgUmVmbGVjdC5nZXQpIHsKICAgIF9nZXQgPSBSZWZsZWN0LmdldDsKICB9IGVsc2UgewogICAgX2dldCA9IGZ1bmN0aW9uIF9nZXQodGFyZ2V0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsKICAgICAgdmFyIGJhc2UgPSBfc3VwZXJQcm9wQmFzZSh0YXJnZXQsIHByb3BlcnR5KTsKCiAgICAgIGlmICghYmFzZSkgcmV0dXJuOwogICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYmFzZSwgcHJvcGVydHkpOwoKICAgICAgaWYgKGRlc2MuZ2V0KSB7CiAgICAgICAgcmV0dXJuIGRlc2MuZ2V0LmNhbGwocmVjZWl2ZXIpOwogICAgICB9CgogICAgICByZXR1cm4gZGVzYy52YWx1ZTsKICAgIH07CiAgfQoKICByZXR1cm4gX2dldCh0YXJnZXQsIHByb3BlcnR5LCByZWNlaXZlciB8fCB0YXJnZXQpOwp9Cgp2YXIgY29uc29sZVByZWZpeCA9ICdTd2VldEFsZXJ0MjonOwovKioKICogRmlsdGVyIHRoZSB1bmlxdWUgdmFsdWVzIGludG8gYSBuZXcgYXJyYXkKICogQHBhcmFtIGFycgogKi8KCnZhciB1bmlxdWVBcnJheSA9IGZ1bmN0aW9uIHVuaXF1ZUFycmF5KGFycikgewogIHZhciByZXN1bHQgPSBbXTsKCiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgIGlmIChyZXN1bHQuaW5kZXhPZihhcnJbaV0pID09PSAtMSkgewogICAgICByZXN1bHQucHVzaChhcnJbaV0pOwogICAgfQogIH0KCiAgcmV0dXJuIHJlc3VsdDsKfTsKLyoqCiAqIFJldHVybnMgdGhlIGFycmF5IG9iIG9iamVjdCB2YWx1ZXMgKE9iamVjdC52YWx1ZXMgaXNuJ3Qgc3VwcG9ydGVkIGluIElFMTEpCiAqIEBwYXJhbSBvYmoKICovCgp2YXIgb2JqZWN0VmFsdWVzID0gZnVuY3Rpb24gb2JqZWN0VmFsdWVzKG9iaikgewogIHJldHVybiBPYmplY3Qua2V5cyhvYmopLm1hcChmdW5jdGlvbiAoa2V5KSB7CiAgICByZXR1cm4gb2JqW2tleV07CiAgfSk7Cn07Ci8qKgogKiBDb252ZXJ0IE5vZGVMaXN0IHRvIEFycmF5CiAqIEBwYXJhbSBub2RlTGlzdAogKi8KCnZhciB0b0FycmF5ID0gZnVuY3Rpb24gdG9BcnJheShub2RlTGlzdCkgewogIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChub2RlTGlzdCk7Cn07Ci8qKgogKiBTdGFuZGFyZGlzZSBjb25zb2xlIHdhcm5pbmdzCiAqIEBwYXJhbSBtZXNzYWdlCiAqLwoKdmFyIHdhcm4gPSBmdW5jdGlvbiB3YXJuKG1lc3NhZ2UpIHsKICBjb25zb2xlLndhcm4oIiIuY29uY2F0KGNvbnNvbGVQcmVmaXgsICIgIikuY29uY2F0KG1lc3NhZ2UpKTsKfTsKLyoqCiAqIFN0YW5kYXJkaXNlIGNvbnNvbGUgZXJyb3JzCiAqIEBwYXJhbSBtZXNzYWdlCiAqLwoKdmFyIGVycm9yID0gZnVuY3Rpb24gZXJyb3IobWVzc2FnZSkgewogIGNvbnNvbGUuZXJyb3IoIiIuY29uY2F0KGNvbnNvbGVQcmVmaXgsICIgIikuY29uY2F0KG1lc3NhZ2UpKTsKfTsKLyoqCiAqIFByaXZhdGUgZ2xvYmFsIHN0YXRlIGZvciBgd2Fybk9uY2VgCiAqIEB0eXBlIHtBcnJheX0KICogQHByaXZhdGUKICovCgp2YXIgcHJldmlvdXNXYXJuT25jZU1lc3NhZ2VzID0gW107Ci8qKgogKiBTaG93IGEgY29uc29sZSB3YXJuaW5nLCBidXQgb25seSBpZiBpdCBoYXNuJ3QgYWxyZWFkeSBiZWVuIHNob3duCiAqIEBwYXJhbSBtZXNzYWdlCiAqLwoKdmFyIHdhcm5PbmNlID0gZnVuY3Rpb24gd2Fybk9uY2UobWVzc2FnZSkgewogIGlmICghKHByZXZpb3VzV2Fybk9uY2VNZXNzYWdlcy5pbmRleE9mKG1lc3NhZ2UpICE9PSAtMSkpIHsKICAgIHByZXZpb3VzV2Fybk9uY2VNZXNzYWdlcy5wdXNoKG1lc3NhZ2UpOwogICAgd2FybihtZXNzYWdlKTsKICB9Cn07Ci8qKgogKiBTaG93IGEgb25lLXRpbWUgY29uc29sZSB3YXJuaW5nIGFib3V0IGRlcHJlY2F0ZWQgcGFyYW1zL21ldGhvZHMKICovCgp2YXIgd2FybkFib3V0RGVwcmVhdGlvbiA9IGZ1bmN0aW9uIHdhcm5BYm91dERlcHJlYXRpb24oZGVwcmVjYXRlZFBhcmFtLCB1c2VJbnN0ZWFkKSB7CiAgd2Fybk9uY2UoIlwiIi5jb25jYXQoZGVwcmVjYXRlZFBhcmFtLCAiXCIgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UuIFBsZWFzZSB1c2UgXCIiKS5jb25jYXQodXNlSW5zdGVhZCwgIlwiIGluc3RlYWQuIikpOwp9OwovKioKICogSWYgYGFyZ2AgaXMgYSBmdW5jdGlvbiwgY2FsbCBpdCAod2l0aCBubyBhcmd1bWVudHMgb3IgY29udGV4dCkgYW5kIHJldHVybiB0aGUgcmVzdWx0LgogKiBPdGhlcndpc2UsIGp1c3QgcGFzcyB0aGUgdmFsdWUgdGhyb3VnaAogKiBAcGFyYW0gYXJnCiAqLwoKdmFyIGNhbGxJZkZ1bmN0aW9uID0gZnVuY3Rpb24gY2FsbElmRnVuY3Rpb24oYXJnKSB7CiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdmdW5jdGlvbicgPyBhcmcoKSA6IGFyZzsKfTsKdmFyIGlzUHJvbWlzZSA9IGZ1bmN0aW9uIGlzUHJvbWlzZShhcmcpIHsKICByZXR1cm4gYXJnICYmIFByb21pc2UucmVzb2x2ZShhcmcpID09PSBhcmc7Cn07Cgp2YXIgRGlzbWlzc1JlYXNvbiA9IE9iamVjdC5mcmVlemUoewogIGNhbmNlbDogJ2NhbmNlbCcsCiAgYmFja2Ryb3A6ICdiYWNrZHJvcCcsCiAgY2xvc2U6ICdjbG9zZScsCiAgZXNjOiAnZXNjJywKICB0aW1lcjogJ3RpbWVyJwp9KTsKCnZhciBhcmdzVG9QYXJhbXMgPSBmdW5jdGlvbiBhcmdzVG9QYXJhbXMoYXJncykgewogIHZhciBwYXJhbXMgPSB7fTsKCiAgc3dpdGNoIChfdHlwZW9mKGFyZ3NbMF0pKSB7CiAgICBjYXNlICdvYmplY3QnOgogICAgICBfZXh0ZW5kcyhwYXJhbXMsIGFyZ3NbMF0pOwoKICAgICAgYnJlYWs7CgogICAgZGVmYXVsdDoKICAgICAgWyd0aXRsZScsICdodG1sJywgJ3R5cGUnXS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lLCBpbmRleCkgewogICAgICAgIHN3aXRjaCAoX3R5cGVvZihhcmdzW2luZGV4XSkpIHsKICAgICAgICAgIGNhc2UgJ3N0cmluZyc6CiAgICAgICAgICAgIHBhcmFtc1tuYW1lXSA9IGFyZ3NbaW5kZXhdOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICd1bmRlZmluZWQnOgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBlcnJvcigiVW5leHBlY3RlZCB0eXBlIG9mICIuY29uY2F0KG5hbWUsICIhIEV4cGVjdGVkIFwic3RyaW5nXCIsIGdvdCAiKS5jb25jYXQoX3R5cGVvZihhcmdzW2luZGV4XSkpKTsKICAgICAgICB9CiAgICAgIH0pOwogIH0KCiAgcmV0dXJuIHBhcmFtczsKfTsKCnZhciBzd2FsUHJlZml4ID0gJ3N3YWwyLSc7CnZhciBwcmVmaXggPSBmdW5jdGlvbiBwcmVmaXgoaXRlbXMpIHsKICB2YXIgcmVzdWx0ID0ge307CgogIGZvciAodmFyIGkgaW4gaXRlbXMpIHsKICAgIHJlc3VsdFtpdGVtc1tpXV0gPSBzd2FsUHJlZml4ICsgaXRlbXNbaV07CiAgfQoKICByZXR1cm4gcmVzdWx0Owp9Owp2YXIgc3dhbENsYXNzZXMgPSBwcmVmaXgoWydjb250YWluZXInLCAnc2hvd24nLCAnaGVpZ2h0LWF1dG8nLCAnaW9zZml4JywgJ3BvcHVwJywgJ21vZGFsJywgJ25vLWJhY2tkcm9wJywgJ3RvYXN0JywgJ3RvYXN0LXNob3duJywgJ3RvYXN0LWNvbHVtbicsICdmYWRlJywgJ3Nob3cnLCAnaGlkZScsICdub2FuaW1hdGlvbicsICdjbG9zZScsICd0aXRsZScsICdoZWFkZXInLCAnY29udGVudCcsICdhY3Rpb25zJywgJ2NvbmZpcm0nLCAnY2FuY2VsJywgJ2Zvb3RlcicsICdpY29uJywgJ2ltYWdlJywgJ2lucHV0JywgJ2ZpbGUnLCAncmFuZ2UnLCAnc2VsZWN0JywgJ3JhZGlvJywgJ2NoZWNrYm94JywgJ2xhYmVsJywgJ3RleHRhcmVhJywgJ2lucHV0ZXJyb3InLCAndmFsaWRhdGlvbi1tZXNzYWdlJywgJ3Byb2dyZXNzLXN0ZXBzJywgJ2FjdGl2ZS1wcm9ncmVzcy1zdGVwJywgJ3Byb2dyZXNzLXN0ZXAnLCAncHJvZ3Jlc3Mtc3RlcC1saW5lJywgJ2xvYWRpbmcnLCAnc3R5bGVkJywgJ3RvcCcsICd0b3Atc3RhcnQnLCAndG9wLWVuZCcsICd0b3AtbGVmdCcsICd0b3AtcmlnaHQnLCAnY2VudGVyJywgJ2NlbnRlci1zdGFydCcsICdjZW50ZXItZW5kJywgJ2NlbnRlci1sZWZ0JywgJ2NlbnRlci1yaWdodCcsICdib3R0b20nLCAnYm90dG9tLXN0YXJ0JywgJ2JvdHRvbS1lbmQnLCAnYm90dG9tLWxlZnQnLCAnYm90dG9tLXJpZ2h0JywgJ2dyb3ctcm93JywgJ2dyb3ctY29sdW1uJywgJ2dyb3ctZnVsbHNjcmVlbicsICdydGwnXSk7CnZhciBpY29uVHlwZXMgPSBwcmVmaXgoWydzdWNjZXNzJywgJ3dhcm5pbmcnLCAnaW5mbycsICdxdWVzdGlvbicsICdlcnJvciddKTsKCnZhciBzdGF0ZXMgPSB7CiAgcHJldmlvdXNCb2R5UGFkZGluZzogbnVsbAp9Owp2YXIgaGFzQ2xhc3MgPSBmdW5jdGlvbiBoYXNDbGFzcyhlbGVtLCBjbGFzc05hbWUpIHsKICByZXR1cm4gZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lKTsKfTsKdmFyIGFwcGx5Q3VzdG9tQ2xhc3MgPSBmdW5jdGlvbiBhcHBseUN1c3RvbUNsYXNzKGVsZW0sIGN1c3RvbUNsYXNzLCBjbGFzc05hbWUpIHsKICAvLyBDbGVhbiB1cCBwcmV2aW91cyBjdXN0b20gY2xhc3NlcwogIHRvQXJyYXkoZWxlbS5jbGFzc0xpc3QpLmZvckVhY2goZnVuY3Rpb24gKGNsYXNzTmFtZSkgewogICAgaWYgKCEob2JqZWN0VmFsdWVzKHN3YWxDbGFzc2VzKS5pbmRleE9mKGNsYXNzTmFtZSkgIT09IC0xKSAmJiAhKG9iamVjdFZhbHVlcyhpY29uVHlwZXMpLmluZGV4T2YoY2xhc3NOYW1lKSAhPT0gLTEpKSB7CiAgICAgIGVsZW0uY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpOwogICAgfQogIH0pOwoKICBpZiAoY3VzdG9tQ2xhc3MgJiYgY3VzdG9tQ2xhc3NbY2xhc3NOYW1lXSkgewogICAgYWRkQ2xhc3MoZWxlbSwgY3VzdG9tQ2xhc3NbY2xhc3NOYW1lXSk7CiAgfQp9OwpmdW5jdGlvbiBnZXRJbnB1dChjb250ZW50LCBpbnB1dFR5cGUpIHsKICBpZiAoIWlucHV0VHlwZSkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICBzd2l0Y2ggKGlucHV0VHlwZSkgewogICAgY2FzZSAnc2VsZWN0JzoKICAgIGNhc2UgJ3RleHRhcmVhJzoKICAgIGNhc2UgJ2ZpbGUnOgogICAgICByZXR1cm4gZ2V0Q2hpbGRCeUNsYXNzKGNvbnRlbnQsIHN3YWxDbGFzc2VzW2lucHV0VHlwZV0pOwoKICAgIGNhc2UgJ2NoZWNrYm94JzoKICAgICAgcmV0dXJuIGNvbnRlbnQucXVlcnlTZWxlY3RvcigiLiIuY29uY2F0KHN3YWxDbGFzc2VzLmNoZWNrYm94LCAiIGlucHV0IikpOwoKICAgIGNhc2UgJ3JhZGlvJzoKICAgICAgcmV0dXJuIGNvbnRlbnQucXVlcnlTZWxlY3RvcigiLiIuY29uY2F0KHN3YWxDbGFzc2VzLnJhZGlvLCAiIGlucHV0OmNoZWNrZWQiKSkgfHwgY29udGVudC5xdWVyeVNlbGVjdG9yKCIuIi5jb25jYXQoc3dhbENsYXNzZXMucmFkaW8sICIgaW5wdXQ6Zmlyc3QtY2hpbGQiKSk7CgogICAgY2FzZSAncmFuZ2UnOgogICAgICByZXR1cm4gY29udGVudC5xdWVyeVNlbGVjdG9yKCIuIi5jb25jYXQoc3dhbENsYXNzZXMucmFuZ2UsICIgaW5wdXQiKSk7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIGdldENoaWxkQnlDbGFzcyhjb250ZW50LCBzd2FsQ2xhc3Nlcy5pbnB1dCk7CiAgfQp9CnZhciBmb2N1c0lucHV0ID0gZnVuY3Rpb24gZm9jdXNJbnB1dChpbnB1dCkgewogIGlucHV0LmZvY3VzKCk7IC8vIHBsYWNlIGN1cnNvciBhdCBlbmQgb2YgdGV4dCBpbiB0ZXh0IGlucHV0CgogIGlmIChpbnB1dC50eXBlICE9PSAnZmlsZScpIHsKICAgIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIzNDU5MTUKICAgIHZhciB2YWwgPSBpbnB1dC52YWx1ZTsKICAgIGlucHV0LnZhbHVlID0gJyc7CiAgICBpbnB1dC52YWx1ZSA9IHZhbDsKICB9Cn07CnZhciB0b2dnbGVDbGFzcyA9IGZ1bmN0aW9uIHRvZ2dsZUNsYXNzKHRhcmdldCwgY2xhc3NMaXN0LCBjb25kaXRpb24pIHsKICBpZiAoIXRhcmdldCB8fCAhY2xhc3NMaXN0KSB7CiAgICByZXR1cm47CiAgfQoKICBpZiAodHlwZW9mIGNsYXNzTGlzdCA9PT0gJ3N0cmluZycpIHsKICAgIGNsYXNzTGlzdCA9IGNsYXNzTGlzdC5zcGxpdCgvXHMrLykuZmlsdGVyKEJvb2xlYW4pOwogIH0KCiAgY2xhc3NMaXN0LmZvckVhY2goZnVuY3Rpb24gKGNsYXNzTmFtZSkgewogICAgaWYgKHRhcmdldC5mb3JFYWNoKSB7CiAgICAgIHRhcmdldC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgY29uZGl0aW9uID8gZWxlbS5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSkgOiBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBjb25kaXRpb24gPyB0YXJnZXQuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpIDogdGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTsKICAgIH0KICB9KTsKfTsKdmFyIGFkZENsYXNzID0gZnVuY3Rpb24gYWRkQ2xhc3ModGFyZ2V0LCBjbGFzc0xpc3QpIHsKICB0b2dnbGVDbGFzcyh0YXJnZXQsIGNsYXNzTGlzdCwgdHJ1ZSk7Cn07CnZhciByZW1vdmVDbGFzcyA9IGZ1bmN0aW9uIHJlbW92ZUNsYXNzKHRhcmdldCwgY2xhc3NMaXN0KSB7CiAgdG9nZ2xlQ2xhc3ModGFyZ2V0LCBjbGFzc0xpc3QsIGZhbHNlKTsKfTsKdmFyIGdldENoaWxkQnlDbGFzcyA9IGZ1bmN0aW9uIGdldENoaWxkQnlDbGFzcyhlbGVtLCBjbGFzc05hbWUpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW0uY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykgewogICAgaWYgKGhhc0NsYXNzKGVsZW0uY2hpbGROb2Rlc1tpXSwgY2xhc3NOYW1lKSkgewogICAgICByZXR1cm4gZWxlbS5jaGlsZE5vZGVzW2ldOwogICAgfQogIH0KfTsKdmFyIGFwcGx5TnVtZXJpY2FsU3R5bGUgPSBmdW5jdGlvbiBhcHBseU51bWVyaWNhbFN0eWxlKGVsZW0sIHByb3BlcnR5LCB2YWx1ZSkgewogIGlmICh2YWx1ZSB8fCBwYXJzZUludCh2YWx1ZSkgPT09IDApIHsKICAgIGVsZW0uc3R5bGVbcHJvcGVydHldID0gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyA/IHZhbHVlICsgJ3B4JyA6IHZhbHVlOwogIH0gZWxzZSB7CiAgICBlbGVtLnN0eWxlLnJlbW92ZVByb3BlcnR5KHByb3BlcnR5KTsKICB9Cn07CnZhciBzaG93ID0gZnVuY3Rpb24gc2hvdyhlbGVtKSB7CiAgdmFyIGRpc3BsYXkgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6ICdmbGV4JzsKICBlbGVtLnN0eWxlLm9wYWNpdHkgPSAnJzsKICBlbGVtLnN0eWxlLmRpc3BsYXkgPSBkaXNwbGF5Owp9Owp2YXIgaGlkZSA9IGZ1bmN0aW9uIGhpZGUoZWxlbSkgewogIGVsZW0uc3R5bGUub3BhY2l0eSA9ICcnOwogIGVsZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKfTsKdmFyIHRvZ2dsZSA9IGZ1bmN0aW9uIHRvZ2dsZShlbGVtLCBjb25kaXRpb24sIGRpc3BsYXkpIHsKICBjb25kaXRpb24gPyBzaG93KGVsZW0sIGRpc3BsYXkpIDogaGlkZShlbGVtKTsKfTsgLy8gYm9ycm93ZWQgZnJvbSBqcXVlcnkgJChlbGVtKS5pcygnOnZpc2libGUnKSBpbXBsZW1lbnRhdGlvbgoKdmFyIGlzVmlzaWJsZSA9IGZ1bmN0aW9uIGlzVmlzaWJsZShlbGVtKSB7CiAgcmV0dXJuICEhKGVsZW0gJiYgKGVsZW0ub2Zmc2V0V2lkdGggfHwgZWxlbS5vZmZzZXRIZWlnaHQgfHwgZWxlbS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCkpOwp9Owp2YXIgaXNTY3JvbGxhYmxlID0gZnVuY3Rpb24gaXNTY3JvbGxhYmxlKGVsZW0pIHsKICByZXR1cm4gISEoZWxlbS5zY3JvbGxIZWlnaHQgPiBlbGVtLmNsaWVudEhlaWdodCk7Cn07IC8vIGJvcnJvd2VkIGZyb20gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzQ2MzUyMTE5Cgp2YXIgaGFzQ3NzQW5pbWF0aW9uID0gZnVuY3Rpb24gaGFzQ3NzQW5pbWF0aW9uKGVsZW0pIHsKICB2YXIgc3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtKTsKICB2YXIgYW5pbUR1cmF0aW9uID0gcGFyc2VGbG9hdChzdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdhbmltYXRpb24tZHVyYXRpb24nKSB8fCAnMCcpOwogIHZhciB0cmFuc0R1cmF0aW9uID0gcGFyc2VGbG9hdChzdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCd0cmFuc2l0aW9uLWR1cmF0aW9uJykgfHwgJzAnKTsKICByZXR1cm4gYW5pbUR1cmF0aW9uID4gMCB8fCB0cmFuc0R1cmF0aW9uID4gMDsKfTsKdmFyIGNvbnRhaW5zID0gZnVuY3Rpb24gY29udGFpbnMoaGF5c3RhY2ssIG5lZWRsZSkgewogIGlmICh0eXBlb2YgaGF5c3RhY2suY29udGFpbnMgPT09ICdmdW5jdGlvbicpIHsKICAgIHJldHVybiBoYXlzdGFjay5jb250YWlucyhuZWVkbGUpOwogIH0KfTsKCnZhciBnZXRDb250YWluZXIgPSBmdW5jdGlvbiBnZXRDb250YWluZXIoKSB7CiAgcmV0dXJuIGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcignLicgKyBzd2FsQ2xhc3Nlcy5jb250YWluZXIpOwp9Owp2YXIgZWxlbWVudEJ5U2VsZWN0b3IgPSBmdW5jdGlvbiBlbGVtZW50QnlTZWxlY3RvcihzZWxlY3RvclN0cmluZykgewogIHZhciBjb250YWluZXIgPSBnZXRDb250YWluZXIoKTsKICByZXR1cm4gY29udGFpbmVyID8gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JTdHJpbmcpIDogbnVsbDsKfTsKCnZhciBlbGVtZW50QnlDbGFzcyA9IGZ1bmN0aW9uIGVsZW1lbnRCeUNsYXNzKGNsYXNzTmFtZSkgewogIHJldHVybiBlbGVtZW50QnlTZWxlY3RvcignLicgKyBjbGFzc05hbWUpOwp9OwoKdmFyIGdldFBvcHVwID0gZnVuY3Rpb24gZ2V0UG9wdXAoKSB7CiAgcmV0dXJuIGVsZW1lbnRCeUNsYXNzKHN3YWxDbGFzc2VzLnBvcHVwKTsKfTsKdmFyIGdldEljb25zID0gZnVuY3Rpb24gZ2V0SWNvbnMoKSB7CiAgdmFyIHBvcHVwID0gZ2V0UG9wdXAoKTsKICByZXR1cm4gdG9BcnJheShwb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIHN3YWxDbGFzc2VzLmljb24pKTsKfTsKdmFyIGdldEljb24gPSBmdW5jdGlvbiBnZXRJY29uKCkgewogIHZhciB2aXNpYmxlSWNvbiA9IGdldEljb25zKCkuZmlsdGVyKGZ1bmN0aW9uIChpY29uKSB7CiAgICByZXR1cm4gaXNWaXNpYmxlKGljb24pOwogIH0pOwogIHJldHVybiB2aXNpYmxlSWNvbi5sZW5ndGggPyB2aXNpYmxlSWNvblswXSA6IG51bGw7Cn07CnZhciBnZXRUaXRsZSA9IGZ1bmN0aW9uIGdldFRpdGxlKCkgewogIHJldHVybiBlbGVtZW50QnlDbGFzcyhzd2FsQ2xhc3Nlcy50aXRsZSk7Cn07CnZhciBnZXRDb250ZW50ID0gZnVuY3Rpb24gZ2V0Q29udGVudCgpIHsKICByZXR1cm4gZWxlbWVudEJ5Q2xhc3Moc3dhbENsYXNzZXMuY29udGVudCk7Cn07CnZhciBnZXRJbWFnZSA9IGZ1bmN0aW9uIGdldEltYWdlKCkgewogIHJldHVybiBlbGVtZW50QnlDbGFzcyhzd2FsQ2xhc3Nlcy5pbWFnZSk7Cn07CnZhciBnZXRQcm9ncmVzc1N0ZXBzID0gZnVuY3Rpb24gZ2V0UHJvZ3Jlc3NTdGVwcygpIHsKICByZXR1cm4gZWxlbWVudEJ5Q2xhc3Moc3dhbENsYXNzZXNbJ3Byb2dyZXNzLXN0ZXBzJ10pOwp9Owp2YXIgZ2V0VmFsaWRhdGlvbk1lc3NhZ2UgPSBmdW5jdGlvbiBnZXRWYWxpZGF0aW9uTWVzc2FnZSgpIHsKICByZXR1cm4gZWxlbWVudEJ5Q2xhc3Moc3dhbENsYXNzZXNbJ3ZhbGlkYXRpb24tbWVzc2FnZSddKTsKfTsKdmFyIGdldENvbmZpcm1CdXR0b24gPSBmdW5jdGlvbiBnZXRDb25maXJtQnV0dG9uKCkgewogIHJldHVybiBlbGVtZW50QnlTZWxlY3RvcignLicgKyBzd2FsQ2xhc3Nlcy5hY3Rpb25zICsgJyAuJyArIHN3YWxDbGFzc2VzLmNvbmZpcm0pOwp9Owp2YXIgZ2V0Q2FuY2VsQnV0dG9uID0gZnVuY3Rpb24gZ2V0Q2FuY2VsQnV0dG9uKCkgewogIHJldHVybiBlbGVtZW50QnlTZWxlY3RvcignLicgKyBzd2FsQ2xhc3Nlcy5hY3Rpb25zICsgJyAuJyArIHN3YWxDbGFzc2VzLmNhbmNlbCk7Cn07CnZhciBnZXRBY3Rpb25zID0gZnVuY3Rpb24gZ2V0QWN0aW9ucygpIHsKICByZXR1cm4gZWxlbWVudEJ5Q2xhc3Moc3dhbENsYXNzZXMuYWN0aW9ucyk7Cn07CnZhciBnZXRIZWFkZXIgPSBmdW5jdGlvbiBnZXRIZWFkZXIoKSB7CiAgcmV0dXJuIGVsZW1lbnRCeUNsYXNzKHN3YWxDbGFzc2VzLmhlYWRlcik7Cn07CnZhciBnZXRGb290ZXIgPSBmdW5jdGlvbiBnZXRGb290ZXIoKSB7CiAgcmV0dXJuIGVsZW1lbnRCeUNsYXNzKHN3YWxDbGFzc2VzLmZvb3Rlcik7Cn07CnZhciBnZXRDbG9zZUJ1dHRvbiA9IGZ1bmN0aW9uIGdldENsb3NlQnV0dG9uKCkgewogIHJldHVybiBlbGVtZW50QnlDbGFzcyhzd2FsQ2xhc3Nlcy5jbG9zZSk7Cn07CnZhciBnZXRGb2N1c2FibGVFbGVtZW50cyA9IGZ1bmN0aW9uIGdldEZvY3VzYWJsZUVsZW1lbnRzKCkgewogIHZhciBmb2N1c2FibGVFbGVtZW50c1dpdGhUYWJpbmRleCA9IHRvQXJyYXkoZ2V0UG9wdXAoKS5xdWVyeVNlbGVjdG9yQWxsKCdbdGFiaW5kZXhdOm5vdChbdGFiaW5kZXg9Ii0xIl0pOm5vdChbdGFiaW5kZXg9IjAiXSknKSkgLy8gc29ydCBhY2NvcmRpbmcgdG8gdGFiaW5kZXgKICAuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgYSA9IHBhcnNlSW50KGEuZ2V0QXR0cmlidXRlKCd0YWJpbmRleCcpKTsKICAgIGIgPSBwYXJzZUludChiLmdldEF0dHJpYnV0ZSgndGFiaW5kZXgnKSk7CgogICAgaWYgKGEgPiBiKSB7CiAgICAgIHJldHVybiAxOwogICAgfSBlbHNlIGlmIChhIDwgYikgewogICAgICByZXR1cm4gLTE7CiAgICB9CgogICAgcmV0dXJuIDA7CiAgfSk7IC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9qa3VwL2ZvY3VzYWJsZS9ibG9iL21hc3Rlci9pbmRleC5qcwoKICB2YXIgb3RoZXJGb2N1c2FibGVFbGVtZW50cyA9IHRvQXJyYXkoZ2V0UG9wdXAoKS5xdWVyeVNlbGVjdG9yQWxsKCdhW2hyZWZdLCBhcmVhW2hyZWZdLCBpbnB1dDpub3QoW2Rpc2FibGVkXSksIHNlbGVjdDpub3QoW2Rpc2FibGVkXSksIHRleHRhcmVhOm5vdChbZGlzYWJsZWRdKSwgYnV0dG9uOm5vdChbZGlzYWJsZWRdKSwgaWZyYW1lLCBvYmplY3QsIGVtYmVkLCBbdGFiaW5kZXg9IjAiXSwgW2NvbnRlbnRlZGl0YWJsZV0sIGF1ZGlvW2NvbnRyb2xzXSwgdmlkZW9bY29udHJvbHNdJykpLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgIHJldHVybiBlbC5nZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JykgIT09ICctMSc7CiAgfSk7CiAgcmV0dXJuIHVuaXF1ZUFycmF5KGZvY3VzYWJsZUVsZW1lbnRzV2l0aFRhYmluZGV4LmNvbmNhdChvdGhlckZvY3VzYWJsZUVsZW1lbnRzKSkuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgcmV0dXJuIGlzVmlzaWJsZShlbCk7CiAgfSk7Cn07CnZhciBpc01vZGFsID0gZnVuY3Rpb24gaXNNb2RhbCgpIHsKICByZXR1cm4gIWlzVG9hc3QoKSAmJiAhZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuY29udGFpbnMoc3dhbENsYXNzZXNbJ25vLWJhY2tkcm9wJ10pOwp9Owp2YXIgaXNUb2FzdCA9IGZ1bmN0aW9uIGlzVG9hc3QoKSB7CiAgcmV0dXJuIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKHN3YWxDbGFzc2VzWyd0b2FzdC1zaG93biddKTsKfTsKdmFyIGlzTG9hZGluZyA9IGZ1bmN0aW9uIGlzTG9hZGluZygpIHsKICByZXR1cm4gZ2V0UG9wdXAoKS5oYXNBdHRyaWJ1dGUoJ2RhdGEtbG9hZGluZycpOwp9OwoKLy8gRGV0ZWN0IE5vZGUgZW52CnZhciBpc05vZGVFbnYgPSBmdW5jdGlvbiBpc05vZGVFbnYoKSB7CiAgcmV0dXJuIHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiBkb2N1bWVudCA9PT0gJ3VuZGVmaW5lZCc7Cn07Cgp2YXIgc3dlZXRIVE1MID0gIlxuIDxkaXYgYXJpYS1sYWJlbGxlZGJ5PVwiIi5jb25jYXQoc3dhbENsYXNzZXMudGl0bGUsICJcIiBhcmlhLWRlc2NyaWJlZGJ5PVwiIikuY29uY2F0KHN3YWxDbGFzc2VzLmNvbnRlbnQsICJcIiBjbGFzcz1cIiIpLmNvbmNhdChzd2FsQ2xhc3Nlcy5wb3B1cCwgIlwiIHRhYmluZGV4PVwiLTFcIj5cbiAgIDxkaXYgY2xhc3M9XCIiKS5jb25jYXQoc3dhbENsYXNzZXMuaGVhZGVyLCAiXCI+XG4gICAgIDx1bCBjbGFzcz1cIiIpLmNvbmNhdChzd2FsQ2xhc3Nlc1sncHJvZ3Jlc3Mtc3RlcHMnXSwgIlwiPjwvdWw+XG4gICAgIDxkaXYgY2xhc3M9XCIiKS5jb25jYXQoc3dhbENsYXNzZXMuaWNvbiwgIiAiKS5jb25jYXQoaWNvblR5cGVzLmVycm9yLCAiXCI+XG4gICAgICAgPHNwYW4gY2xhc3M9XCJzd2FsMi14LW1hcmtcIj48c3BhbiBjbGFzcz1cInN3YWwyLXgtbWFyay1saW5lLWxlZnRcIj48L3NwYW4+PHNwYW4gY2xhc3M9XCJzd2FsMi14LW1hcmstbGluZS1yaWdodFwiPjwvc3Bhbj48L3NwYW4+XG4gICAgIDwvZGl2PlxuICAgICA8ZGl2IGNsYXNzPVwiIikuY29uY2F0KHN3YWxDbGFzc2VzLmljb24sICIgIikuY29uY2F0KGljb25UeXBlcy5xdWVzdGlvbiwgIlwiPjwvZGl2PlxuICAgICA8ZGl2IGNsYXNzPVwiIikuY29uY2F0KHN3YWxDbGFzc2VzLmljb24sICIgIikuY29uY2F0KGljb25UeXBlcy53YXJuaW5nLCAiXCI+PC9kaXY+XG4gICAgIDxkaXYgY2xhc3M9XCIiKS5jb25jYXQoc3dhbENsYXNzZXMuaWNvbiwgIiAiKS5jb25jYXQoaWNvblR5cGVzLmluZm8sICJcIj48L2Rpdj5cbiAgICAgPGRpdiBjbGFzcz1cIiIpLmNvbmNhdChzd2FsQ2xhc3Nlcy5pY29uLCAiICIpLmNvbmNhdChpY29uVHlwZXMuc3VjY2VzcywgIlwiPlxuICAgICAgIDxkaXYgY2xhc3M9XCJzd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmUtbGVmdFwiPjwvZGl2PlxuICAgICAgIDxzcGFuIGNsYXNzPVwic3dhbDItc3VjY2Vzcy1saW5lLXRpcFwiPjwvc3Bhbj4gPHNwYW4gY2xhc3M9XCJzd2FsMi1zdWNjZXNzLWxpbmUtbG9uZ1wiPjwvc3Bhbj5cbiAgICAgICA8ZGl2IGNsYXNzPVwic3dhbDItc3VjY2Vzcy1yaW5nXCI+PC9kaXY+IDxkaXYgY2xhc3M9XCJzd2FsMi1zdWNjZXNzLWZpeFwiPjwvZGl2PlxuICAgICAgIDxkaXYgY2xhc3M9XCJzd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmUtcmlnaHRcIj48L2Rpdj5cbiAgICAgPC9kaXY+XG4gICAgIDxpbWcgY2xhc3M9XCIiKS5jb25jYXQoc3dhbENsYXNzZXMuaW1hZ2UsICJcIiAvPlxuICAgICA8aDIgY2xhc3M9XCIiKS5jb25jYXQoc3dhbENsYXNzZXMudGl0bGUsICJcIiBpZD1cIiIpLmNvbmNhdChzd2FsQ2xhc3Nlcy50aXRsZSwgIlwiPjwvaDI+XG4gICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiIikuY29uY2F0KHN3YWxDbGFzc2VzLmNsb3NlLCAiXCI+PC9idXR0b24+XG4gICA8L2Rpdj5cbiAgIDxkaXYgY2xhc3M9XCIiKS5jb25jYXQoc3dhbENsYXNzZXMuY29udGVudCwgIlwiPlxuICAgICA8ZGl2IGlkPVwiIikuY29uY2F0KHN3YWxDbGFzc2VzLmNvbnRlbnQsICJcIj48L2Rpdj5cbiAgICAgPGlucHV0IGNsYXNzPVwiIikuY29uY2F0KHN3YWxDbGFzc2VzLmlucHV0LCAiXCIgLz5cbiAgICAgPGlucHV0IHR5cGU9XCJmaWxlXCIgY2xhc3M9XCIiKS5jb25jYXQoc3dhbENsYXNzZXMuZmlsZSwgIlwiIC8+XG4gICAgIDxkaXYgY2xhc3M9XCIiKS5jb25jYXQoc3dhbENsYXNzZXMucmFuZ2UsICJcIj5cbiAgICAgICA8aW5wdXQgdHlwZT1cInJhbmdlXCIgLz5cbiAgICAgICA8b3V0cHV0Pjwvb3V0cHV0PlxuICAgICA8L2Rpdj5cbiAgICAgPHNlbGVjdCBjbGFzcz1cIiIpLmNvbmNhdChzd2FsQ2xhc3Nlcy5zZWxlY3QsICJcIj48L3NlbGVjdD5cbiAgICAgPGRpdiBjbGFzcz1cIiIpLmNvbmNhdChzd2FsQ2xhc3Nlcy5yYWRpbywgIlwiPjwvZGl2PlxuICAgICA8bGFiZWwgZm9yPVwiIikuY29uY2F0KHN3YWxDbGFzc2VzLmNoZWNrYm94LCAiXCIgY2xhc3M9XCIiKS5jb25jYXQoc3dhbENsYXNzZXMuY2hlY2tib3gsICJcIj5cbiAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgLz5cbiAgICAgICA8c3BhbiBjbGFzcz1cIiIpLmNvbmNhdChzd2FsQ2xhc3Nlcy5sYWJlbCwgIlwiPjwvc3Bhbj5cbiAgICAgPC9sYWJlbD5cbiAgICAgPHRleHRhcmVhIGNsYXNzPVwiIikuY29uY2F0KHN3YWxDbGFzc2VzLnRleHRhcmVhLCAiXCI+PC90ZXh0YXJlYT5cbiAgICAgPGRpdiBjbGFzcz1cIiIpLmNvbmNhdChzd2FsQ2xhc3Nlc1sndmFsaWRhdGlvbi1tZXNzYWdlJ10sICJcIiBpZD1cIiIpLmNvbmNhdChzd2FsQ2xhc3Nlc1sndmFsaWRhdGlvbi1tZXNzYWdlJ10sICJcIj48L2Rpdj5cbiAgIDwvZGl2PlxuICAgPGRpdiBjbGFzcz1cIiIpLmNvbmNhdChzd2FsQ2xhc3Nlcy5hY3Rpb25zLCAiXCI+XG4gICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiIikuY29uY2F0KHN3YWxDbGFzc2VzLmNvbmZpcm0sICJcIj5PSzwvYnV0dG9uPlxuICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cIiIpLmNvbmNhdChzd2FsQ2xhc3Nlcy5jYW5jZWwsICJcIj5DYW5jZWw8L2J1dHRvbj5cbiAgIDwvZGl2PlxuICAgPGRpdiBjbGFzcz1cIiIpLmNvbmNhdChzd2FsQ2xhc3Nlcy5mb290ZXIsICJcIj5cbiAgIDwvZGl2PlxuIDwvZGl2PlxuIikucmVwbGFjZSgvKF58XG4pXHMqL2csICcnKTsKCnZhciByZXNldE9sZENvbnRhaW5lciA9IGZ1bmN0aW9uIHJlc2V0T2xkQ29udGFpbmVyKCkgewogIHZhciBvbGRDb250YWluZXIgPSBnZXRDb250YWluZXIoKTsKCiAgaWYgKCFvbGRDb250YWluZXIpIHsKICAgIHJldHVybjsKICB9CgogIG9sZENvbnRhaW5lci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG9sZENvbnRhaW5lcik7CiAgcmVtb3ZlQ2xhc3MoW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgZG9jdW1lbnQuYm9keV0sIFtzd2FsQ2xhc3Nlc1snbm8tYmFja2Ryb3AnXSwgc3dhbENsYXNzZXNbJ3RvYXN0LXNob3duJ10sIHN3YWxDbGFzc2VzWydoYXMtY29sdW1uJ11dKTsKfTsKCnZhciBvbGRJbnB1dFZhbDsgLy8gSUUxMSB3b3JrYXJvdW5kLCBzZWUgIzExMDkgZm9yIGRldGFpbHMKCnZhciByZXNldFZhbGlkYXRpb25NZXNzYWdlID0gZnVuY3Rpb24gcmVzZXRWYWxpZGF0aW9uTWVzc2FnZShlKSB7CiAgaWYgKFN3YWwuaXNWaXNpYmxlKCkgJiYgb2xkSW5wdXRWYWwgIT09IGUudGFyZ2V0LnZhbHVlKSB7CiAgICBTd2FsLnJlc2V0VmFsaWRhdGlvbk1lc3NhZ2UoKTsKICB9CgogIG9sZElucHV0VmFsID0gZS50YXJnZXQudmFsdWU7Cn07Cgp2YXIgYWRkSW5wdXRDaGFuZ2VMaXN0ZW5lcnMgPSBmdW5jdGlvbiBhZGRJbnB1dENoYW5nZUxpc3RlbmVycygpIHsKICB2YXIgY29udGVudCA9IGdldENvbnRlbnQoKTsKICB2YXIgaW5wdXQgPSBnZXRDaGlsZEJ5Q2xhc3MoY29udGVudCwgc3dhbENsYXNzZXMuaW5wdXQpOwogIHZhciBmaWxlID0gZ2V0Q2hpbGRCeUNsYXNzKGNvbnRlbnQsIHN3YWxDbGFzc2VzLmZpbGUpOwogIHZhciByYW5nZSA9IGNvbnRlbnQucXVlcnlTZWxlY3RvcigiLiIuY29uY2F0KHN3YWxDbGFzc2VzLnJhbmdlLCAiIGlucHV0IikpOwogIHZhciByYW5nZU91dHB1dCA9IGNvbnRlbnQucXVlcnlTZWxlY3RvcigiLiIuY29uY2F0KHN3YWxDbGFzc2VzLnJhbmdlLCAiIG91dHB1dCIpKTsKICB2YXIgc2VsZWN0ID0gZ2V0Q2hpbGRCeUNsYXNzKGNvbnRlbnQsIHN3YWxDbGFzc2VzLnNlbGVjdCk7CiAgdmFyIGNoZWNrYm94ID0gY29udGVudC5xdWVyeVNlbGVjdG9yKCIuIi5jb25jYXQoc3dhbENsYXNzZXMuY2hlY2tib3gsICIgaW5wdXQiKSk7CiAgdmFyIHRleHRhcmVhID0gZ2V0Q2hpbGRCeUNsYXNzKGNvbnRlbnQsIHN3YWxDbGFzc2VzLnRleHRhcmVhKTsKICBpbnB1dC5vbmlucHV0ID0gcmVzZXRWYWxpZGF0aW9uTWVzc2FnZTsKICBmaWxlLm9uY2hhbmdlID0gcmVzZXRWYWxpZGF0aW9uTWVzc2FnZTsKICBzZWxlY3Qub25jaGFuZ2UgPSByZXNldFZhbGlkYXRpb25NZXNzYWdlOwogIGNoZWNrYm94Lm9uY2hhbmdlID0gcmVzZXRWYWxpZGF0aW9uTWVzc2FnZTsKICB0ZXh0YXJlYS5vbmlucHV0ID0gcmVzZXRWYWxpZGF0aW9uTWVzc2FnZTsKCiAgcmFuZ2Uub25pbnB1dCA9IGZ1bmN0aW9uIChlKSB7CiAgICByZXNldFZhbGlkYXRpb25NZXNzYWdlKGUpOwogICAgcmFuZ2VPdXRwdXQudmFsdWUgPSByYW5nZS52YWx1ZTsKICB9OwoKICByYW5nZS5vbmNoYW5nZSA9IGZ1bmN0aW9uIChlKSB7CiAgICByZXNldFZhbGlkYXRpb25NZXNzYWdlKGUpOwogICAgcmFuZ2UubmV4dFNpYmxpbmcudmFsdWUgPSByYW5nZS52YWx1ZTsKICB9Owp9OwoKdmFyIGdldFRhcmdldCA9IGZ1bmN0aW9uIGdldFRhcmdldCh0YXJnZXQpIHsKICByZXR1cm4gdHlwZW9mIHRhcmdldCA9PT0gJ3N0cmluZycgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldCkgOiB0YXJnZXQ7Cn07Cgp2YXIgc2V0dXBBY2Nlc3NpYmlsaXR5ID0gZnVuY3Rpb24gc2V0dXBBY2Nlc3NpYmlsaXR5KHBhcmFtcykgewogIHZhciBwb3B1cCA9IGdldFBvcHVwKCk7CiAgcG9wdXAuc2V0QXR0cmlidXRlKCdyb2xlJywgcGFyYW1zLnRvYXN0ID8gJ2FsZXJ0JyA6ICdkaWFsb2cnKTsKICBwb3B1cC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGl2ZScsIHBhcmFtcy50b2FzdCA/ICdwb2xpdGUnIDogJ2Fzc2VydGl2ZScpOwoKICBpZiAoIXBhcmFtcy50b2FzdCkgewogICAgcG9wdXAuc2V0QXR0cmlidXRlKCdhcmlhLW1vZGFsJywgJ3RydWUnKTsKICB9Cn07Cgp2YXIgc2V0dXBSVEwgPSBmdW5jdGlvbiBzZXR1cFJUTCh0YXJnZXRFbGVtZW50KSB7CiAgaWYgKHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRhcmdldEVsZW1lbnQpLmRpcmVjdGlvbiA9PT0gJ3J0bCcpIHsKICAgIGFkZENsYXNzKGdldENvbnRhaW5lcigpLCBzd2FsQ2xhc3Nlcy5ydGwpOwogIH0KfTsKLyoKICogQWRkIG1vZGFsICsgYmFja2Ryb3AgdG8gRE9NCiAqLwoKCnZhciBpbml0ID0gZnVuY3Rpb24gaW5pdChwYXJhbXMpIHsKICAvLyBDbGVhbiB1cCB0aGUgb2xkIHBvcHVwIGNvbnRhaW5lciBpZiBpdCBleGlzdHMKICByZXNldE9sZENvbnRhaW5lcigpOwogIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwoKICBpZiAoaXNOb2RlRW52KCkpIHsKICAgIGVycm9yKCdTd2VldEFsZXJ0MiByZXF1aXJlcyBkb2N1bWVudCB0byBpbml0aWFsaXplJyk7CiAgICByZXR1cm47CiAgfQoKICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgY29udGFpbmVyLmNsYXNzTmFtZSA9IHN3YWxDbGFzc2VzLmNvbnRhaW5lcjsKICBjb250YWluZXIuaW5uZXJIVE1MID0gc3dlZXRIVE1MOwogIHZhciB0YXJnZXRFbGVtZW50ID0gZ2V0VGFyZ2V0KHBhcmFtcy50YXJnZXQpOwogIHRhcmdldEVsZW1lbnQuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTsKICBzZXR1cEFjY2Vzc2liaWxpdHkocGFyYW1zKTsKICBzZXR1cFJUTCh0YXJnZXRFbGVtZW50KTsKICBhZGRJbnB1dENoYW5nZUxpc3RlbmVycygpOwp9OwoKdmFyIHBhcnNlSHRtbFRvQ29udGFpbmVyID0gZnVuY3Rpb24gcGFyc2VIdG1sVG9Db250YWluZXIocGFyYW0sIHRhcmdldCkgewogIC8vIERPTSBlbGVtZW50CiAgaWYgKHBhcmFtIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHsKICAgIHRhcmdldC5hcHBlbmRDaGlsZChwYXJhbSk7IC8vIEpRdWVyeSBlbGVtZW50KHMpCiAgfSBlbHNlIGlmIChfdHlwZW9mKHBhcmFtKSA9PT0gJ29iamVjdCcpIHsKICAgIGhhbmRsZUpxdWVyeUVsZW0odGFyZ2V0LCBwYXJhbSk7IC8vIFBsYWluIHN0cmluZwogIH0gZWxzZSBpZiAocGFyYW0pIHsKICAgIHRhcmdldC5pbm5lckhUTUwgPSBwYXJhbTsKICB9Cn07Cgp2YXIgaGFuZGxlSnF1ZXJ5RWxlbSA9IGZ1bmN0aW9uIGhhbmRsZUpxdWVyeUVsZW0odGFyZ2V0LCBlbGVtKSB7CiAgdGFyZ2V0LmlubmVySFRNTCA9ICcnOwoKICBpZiAoMCBpbiBlbGVtKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSBpbiBlbGVtOyBpKyspIHsKICAgICAgdGFyZ2V0LmFwcGVuZENoaWxkKGVsZW1baV0uY2xvbmVOb2RlKHRydWUpKTsKICAgIH0KICB9IGVsc2UgewogICAgdGFyZ2V0LmFwcGVuZENoaWxkKGVsZW0uY2xvbmVOb2RlKHRydWUpKTsKICB9Cn07Cgp2YXIgYW5pbWF0aW9uRW5kRXZlbnQgPSBmdW5jdGlvbiAoKSB7CiAgLy8gUHJldmVudCBydW4gaW4gTm9kZSBlbnYKCiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKGlzTm9kZUVudigpKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICB2YXIgdGVzdEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgdmFyIHRyYW5zRW5kRXZlbnROYW1lcyA9IHsKICAgIFdlYmtpdEFuaW1hdGlvbjogJ3dlYmtpdEFuaW1hdGlvbkVuZCcsCiAgICBPQW5pbWF0aW9uOiAnb0FuaW1hdGlvbkVuZCBvYW5pbWF0aW9uZW5kJywKICAgIGFuaW1hdGlvbjogJ2FuaW1hdGlvbmVuZCcKICB9OwoKICBmb3IgKHZhciBpIGluIHRyYW5zRW5kRXZlbnROYW1lcykgewogICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0cmFuc0VuZEV2ZW50TmFtZXMsIGkpICYmIHR5cGVvZiB0ZXN0RWwuc3R5bGVbaV0gIT09ICd1bmRlZmluZWQnKSB7CiAgICAgIHJldHVybiB0cmFuc0VuZEV2ZW50TmFtZXNbaV07CiAgICB9CiAgfQoKICByZXR1cm4gZmFsc2U7Cn0oKTsKCi8vIE1lYXN1cmUgd2lkdGggb2Ygc2Nyb2xsYmFyCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9qcy9tb2RhbC5qcyNMMjc5LUwyODYKdmFyIG1lYXN1cmVTY3JvbGxiYXIgPSBmdW5jdGlvbiBtZWFzdXJlU2Nyb2xsYmFyKCkgewogIHZhciBzdXBwb3J0c1RvdWNoID0gJ29udG91Y2hzdGFydCcgaW4gd2luZG93IHx8IG5hdmlnYXRvci5tc01heFRvdWNoUG9pbnRzOwoKICBpZiAoc3VwcG9ydHNUb3VjaCkgewogICAgcmV0dXJuIDA7CiAgfQoKICB2YXIgc2Nyb2xsRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgc2Nyb2xsRGl2LnN0eWxlLndpZHRoID0gJzUwcHgnOwogIHNjcm9sbERpdi5zdHlsZS5oZWlnaHQgPSAnNTBweCc7CiAgc2Nyb2xsRGl2LnN0eWxlLm92ZXJmbG93ID0gJ3Njcm9sbCc7CiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JvbGxEaXYpOwogIHZhciBzY3JvbGxiYXJXaWR0aCA9IHNjcm9sbERpdi5vZmZzZXRXaWR0aCAtIHNjcm9sbERpdi5jbGllbnRXaWR0aDsKICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHNjcm9sbERpdik7CiAgcmV0dXJuIHNjcm9sbGJhcldpZHRoOwp9OwoKZnVuY3Rpb24gaGFuZGxlQnV0dG9uc1N0eWxpbmcoY29uZmlybUJ1dHRvbiwgY2FuY2VsQnV0dG9uLCBwYXJhbXMpIHsKICBhZGRDbGFzcyhbY29uZmlybUJ1dHRvbiwgY2FuY2VsQnV0dG9uXSwgc3dhbENsYXNzZXMuc3R5bGVkKTsgLy8gQnV0dG9ucyBiYWNrZ3JvdW5kIGNvbG9ycwoKICBpZiAocGFyYW1zLmNvbmZpcm1CdXR0b25Db2xvcikgewogICAgY29uZmlybUJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBwYXJhbXMuY29uZmlybUJ1dHRvbkNvbG9yOwogIH0KCiAgaWYgKHBhcmFtcy5jYW5jZWxCdXR0b25Db2xvcikgewogICAgY2FuY2VsQnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHBhcmFtcy5jYW5jZWxCdXR0b25Db2xvcjsKICB9IC8vIExvYWRpbmcgc3RhdGUKCgogIHZhciBjb25maXJtQnV0dG9uQmFja2dyb3VuZENvbG9yID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoY29uZmlybUJ1dHRvbikuZ2V0UHJvcGVydHlWYWx1ZSgnYmFja2dyb3VuZC1jb2xvcicpOwogIGNvbmZpcm1CdXR0b24uc3R5bGUuYm9yZGVyTGVmdENvbG9yID0gY29uZmlybUJ1dHRvbkJhY2tncm91bmRDb2xvcjsKICBjb25maXJtQnV0dG9uLnN0eWxlLmJvcmRlclJpZ2h0Q29sb3IgPSBjb25maXJtQnV0dG9uQmFja2dyb3VuZENvbG9yOwp9CgpmdW5jdGlvbiByZW5kZXJCdXR0b24oYnV0dG9uLCBidXR0b25UeXBlLCBwYXJhbXMpIHsKICB0b2dnbGUoYnV0dG9uLCBwYXJhbXNbJ3Nob3dDJyArIGJ1dHRvblR5cGUuc3Vic3RyaW5nKDEpICsgJ0J1dHRvbiddLCAnaW5saW5lLWJsb2NrJyk7CiAgYnV0dG9uLmlubmVySFRNTCA9IHBhcmFtc1tidXR0b25UeXBlICsgJ0J1dHRvblRleHQnXTsgLy8gU2V0IGNhcHRpb24gdGV4dAoKICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgcGFyYW1zW2J1dHRvblR5cGUgKyAnQnV0dG9uQXJpYUxhYmVsJ10pOyAvLyBBUklBIGxhYmVsCiAgLy8gQWRkIGJ1dHRvbnMgY3VzdG9tIGNsYXNzZXMKCiAgYnV0dG9uLmNsYXNzTmFtZSA9IHN3YWxDbGFzc2VzW2J1dHRvblR5cGVdOwogIGFwcGx5Q3VzdG9tQ2xhc3MoYnV0dG9uLCBwYXJhbXMuY3VzdG9tQ2xhc3MsIGJ1dHRvblR5cGUgKyAnQnV0dG9uJyk7CiAgYWRkQ2xhc3MoYnV0dG9uLCBwYXJhbXNbYnV0dG9uVHlwZSArICdCdXR0b25DbGFzcyddKTsKfQoKdmFyIHJlbmRlckFjdGlvbnMgPSBmdW5jdGlvbiByZW5kZXJBY3Rpb25zKGluc3RhbmNlLCBwYXJhbXMpIHsKICB2YXIgYWN0aW9ucyA9IGdldEFjdGlvbnMoKTsKICB2YXIgY29uZmlybUJ1dHRvbiA9IGdldENvbmZpcm1CdXR0b24oKTsKICB2YXIgY2FuY2VsQnV0dG9uID0gZ2V0Q2FuY2VsQnV0dG9uKCk7IC8vIEFjdGlvbnMgKGJ1dHRvbnMpIHdyYXBwZXIKCiAgaWYgKCFwYXJhbXMuc2hvd0NvbmZpcm1CdXR0b24gJiYgIXBhcmFtcy5zaG93Q2FuY2VsQnV0dG9uKSB7CiAgICBoaWRlKGFjdGlvbnMpOwogIH0gZWxzZSB7CiAgICBzaG93KGFjdGlvbnMpOwogIH0gLy8gQ3VzdG9tIGNsYXNzCgoKICBhcHBseUN1c3RvbUNsYXNzKGFjdGlvbnMsIHBhcmFtcy5jdXN0b21DbGFzcywgJ2FjdGlvbnMnKTsgLy8gUmVuZGVyIGNvbmZpcm0gYnV0dG9uCgogIHJlbmRlckJ1dHRvbihjb25maXJtQnV0dG9uLCAnY29uZmlybScsIHBhcmFtcyk7IC8vIHJlbmRlciBDYW5jZWwgQnV0dG9uCgogIHJlbmRlckJ1dHRvbihjYW5jZWxCdXR0b24sICdjYW5jZWwnLCBwYXJhbXMpOwoKICBpZiAocGFyYW1zLmJ1dHRvbnNTdHlsaW5nKSB7CiAgICBoYW5kbGVCdXR0b25zU3R5bGluZyhjb25maXJtQnV0dG9uLCBjYW5jZWxCdXR0b24sIHBhcmFtcyk7CiAgfSBlbHNlIHsKICAgIHJlbW92ZUNsYXNzKFtjb25maXJtQnV0dG9uLCBjYW5jZWxCdXR0b25dLCBzd2FsQ2xhc3Nlcy5zdHlsZWQpOwogICAgY29uZmlybUJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb25maXJtQnV0dG9uLnN0eWxlLmJvcmRlckxlZnRDb2xvciA9IGNvbmZpcm1CdXR0b24uc3R5bGUuYm9yZGVyUmlnaHRDb2xvciA9ICcnOwogICAgY2FuY2VsQnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNhbmNlbEJ1dHRvbi5zdHlsZS5ib3JkZXJMZWZ0Q29sb3IgPSBjYW5jZWxCdXR0b24uc3R5bGUuYm9yZGVyUmlnaHRDb2xvciA9ICcnOwogIH0KfTsKCmZ1bmN0aW9uIGhhbmRsZUJhY2tkcm9wUGFyYW0oY29udGFpbmVyLCBiYWNrZHJvcCkgewogIGlmICh0eXBlb2YgYmFja2Ryb3AgPT09ICdzdHJpbmcnKSB7CiAgICBjb250YWluZXIuc3R5bGUuYmFja2dyb3VuZCA9IGJhY2tkcm9wOwogIH0gZWxzZSBpZiAoIWJhY2tkcm9wKSB7CiAgICBhZGRDbGFzcyhbZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBkb2N1bWVudC5ib2R5XSwgc3dhbENsYXNzZXNbJ25vLWJhY2tkcm9wJ10pOwogIH0KfQoKZnVuY3Rpb24gaGFuZGxlUG9zaXRpb25QYXJhbShjb250YWluZXIsIHBvc2l0aW9uKSB7CiAgaWYgKHBvc2l0aW9uIGluIHN3YWxDbGFzc2VzKSB7CiAgICBhZGRDbGFzcyhjb250YWluZXIsIHN3YWxDbGFzc2VzW3Bvc2l0aW9uXSk7CiAgfSBlbHNlIHsKICAgIHdhcm4oJ1RoZSAicG9zaXRpb24iIHBhcmFtZXRlciBpcyBub3QgdmFsaWQsIGRlZmF1bHRpbmcgdG8gImNlbnRlciInKTsKICAgIGFkZENsYXNzKGNvbnRhaW5lciwgc3dhbENsYXNzZXMuY2VudGVyKTsKICB9Cn0KCmZ1bmN0aW9uIGhhbmRsZUdyb3dQYXJhbShjb250YWluZXIsIGdyb3cpIHsKICBpZiAoZ3JvdyAmJiB0eXBlb2YgZ3JvdyA9PT0gJ3N0cmluZycpIHsKICAgIHZhciBncm93Q2xhc3MgPSAnZ3Jvdy0nICsgZ3JvdzsKCiAgICBpZiAoZ3Jvd0NsYXNzIGluIHN3YWxDbGFzc2VzKSB7CiAgICAgIGFkZENsYXNzKGNvbnRhaW5lciwgc3dhbENsYXNzZXNbZ3Jvd0NsYXNzXSk7CiAgICB9CiAgfQp9Cgp2YXIgcmVuZGVyQ29udGFpbmVyID0gZnVuY3Rpb24gcmVuZGVyQ29udGFpbmVyKGluc3RhbmNlLCBwYXJhbXMpIHsKICB2YXIgY29udGFpbmVyID0gZ2V0Q29udGFpbmVyKCk7CgogIGlmICghY29udGFpbmVyKSB7CiAgICByZXR1cm47CiAgfQoKICBoYW5kbGVCYWNrZHJvcFBhcmFtKGNvbnRhaW5lciwgcGFyYW1zLmJhY2tkcm9wKTsKCiAgaWYgKCFwYXJhbXMuYmFja2Ryb3AgJiYgcGFyYW1zLmFsbG93T3V0c2lkZUNsaWNrKSB7CiAgICB3YXJuKCciYWxsb3dPdXRzaWRlQ2xpY2siIHBhcmFtZXRlciByZXF1aXJlcyBgYmFja2Ryb3BgIHBhcmFtZXRlciB0byBiZSBzZXQgdG8gYHRydWVgJyk7CiAgfQoKICBoYW5kbGVQb3NpdGlvblBhcmFtKGNvbnRhaW5lciwgcGFyYW1zLnBvc2l0aW9uKTsKICBoYW5kbGVHcm93UGFyYW0oY29udGFpbmVyLCBwYXJhbXMuZ3Jvdyk7IC8vIEN1c3RvbSBjbGFzcwoKICBhcHBseUN1c3RvbUNsYXNzKGNvbnRhaW5lciwgcGFyYW1zLmN1c3RvbUNsYXNzLCAnY29udGFpbmVyJyk7CgogIGlmIChwYXJhbXMuY3VzdG9tQ29udGFpbmVyQ2xhc3MpIHsKICAgIC8vIEBkZXByZWNhdGVkCiAgICBhZGRDbGFzcyhjb250YWluZXIsIHBhcmFtcy5jdXN0b21Db250YWluZXJDbGFzcyk7CiAgfQp9OwoKLyoqCiAqIFRoaXMgbW9kdWxlIGNvbnRhaW50cyBgV2Vha01hcGBzIGZvciBlYWNoIGVmZmVjdGl2ZWx5LSJwcml2YXRlICBwcm9wZXJ0eSIgdGhhdCBhIGBTd2FsYCBoYXMuCiAqIEZvciBleGFtcGxlLCB0byBzZXQgdGhlIHByaXZhdGUgcHJvcGVydHkgImZvbyIgb2YgYHRoaXNgIHRvICJiYXIiLCB5b3UgY2FuIGBwcml2YXRlUHJvcHMuZm9vLnNldCh0aGlzLCAnYmFyJylgCiAqIFRoaXMgaXMgdGhlIGFwcHJvYWNoIHRoYXQgQmFiZWwgd2lsbCBwcm9iYWJseSB0YWtlIHRvIGltcGxlbWVudCBwcml2YXRlIG1ldGhvZHMvZmllbGRzCiAqICAgaHR0cHM6Ly9naXRodWIuY29tL3RjMzkvcHJvcG9zYWwtcHJpdmF0ZS1tZXRob2RzCiAqICAgaHR0cHM6Ly9naXRodWIuY29tL2JhYmVsL2JhYmVsL3B1bGwvNzU1NQogKiBPbmNlIHdlIGhhdmUgdGhlIGNoYW5nZXMgZnJvbSB0aGF0IFBSIGluIEJhYmVsLCBhbmQgb3VyIGNvcmUgY2xhc3MgZml0cyByZWFzb25hYmxlIGluICpvbmUgbW9kdWxlKgogKiAgIHRoZW4gd2UgY2FuIHVzZSB0aGF0IGxhbmd1YWdlIGZlYXR1cmUuCiAqLwp2YXIgcHJpdmF0ZVByb3BzID0gewogIHByb21pc2U6IG5ldyBXZWFrTWFwKCksCiAgaW5uZXJQYXJhbXM6IG5ldyBXZWFrTWFwKCksCiAgZG9tQ2FjaGU6IG5ldyBXZWFrTWFwKCkKfTsKCnZhciBpbnB1dFR5cGVzID0gWydpbnB1dCcsICdmaWxlJywgJ3JhbmdlJywgJ3NlbGVjdCcsICdyYWRpbycsICdjaGVja2JveCcsICd0ZXh0YXJlYSddOwp2YXIgcmVuZGVySW5wdXQgPSBmdW5jdGlvbiByZW5kZXJJbnB1dChpbnN0YW5jZSwgcGFyYW1zKSB7CiAgdmFyIGNvbnRlbnQgPSBnZXRDb250ZW50KCk7CiAgdmFyIGlubmVyUGFyYW1zID0gcHJpdmF0ZVByb3BzLmlubmVyUGFyYW1zLmdldChpbnN0YW5jZSk7CiAgdmFyIHJlcmVuZGVyID0gIWlubmVyUGFyYW1zIHx8IHBhcmFtcy5pbnB1dCAhPT0gaW5uZXJQYXJhbXMuaW5wdXQ7CiAgaW5wdXRUeXBlcy5mb3JFYWNoKGZ1bmN0aW9uIChpbnB1dFR5cGUpIHsKICAgIHZhciBpbnB1dENsYXNzID0gc3dhbENsYXNzZXNbaW5wdXRUeXBlXTsKICAgIHZhciBpbnB1dENvbnRhaW5lciA9IGdldENoaWxkQnlDbGFzcyhjb250ZW50LCBpbnB1dENsYXNzKTsgLy8gc2V0IGF0dHJpYnV0ZXMKCiAgICBzZXRBdHRyaWJ1dGVzKGlucHV0VHlwZSwgcGFyYW1zLmlucHV0QXR0cmlidXRlcyk7IC8vIHNldCBjbGFzcwoKICAgIHNldENsYXNzKGlucHV0Q29udGFpbmVyLCBpbnB1dENsYXNzLCBwYXJhbXMpOwoKICAgIGlmIChyZXJlbmRlcikgewogICAgICBoaWRlKGlucHV0Q29udGFpbmVyKTsKICAgIH0KICB9KTsKCiAgaWYgKHBhcmFtcy5pbnB1dCAmJiByZXJlbmRlcikgewogICAgc2hvd0lucHV0KHBhcmFtcyk7CiAgfQp9OwoKdmFyIHNob3dJbnB1dCA9IGZ1bmN0aW9uIHNob3dJbnB1dChwYXJhbXMpIHsKICBpZiAoIXJlbmRlcklucHV0VHlwZVtwYXJhbXMuaW5wdXRdKSB7CiAgICByZXR1cm4gZXJyb3IoIlVuZXhwZWN0ZWQgdHlwZSBvZiBpbnB1dCEgRXhwZWN0ZWQgXCJ0ZXh0XCIsIFwiZW1haWxcIiwgXCJwYXNzd29yZFwiLCBcIm51bWJlclwiLCBcInRlbFwiLCBcInNlbGVjdFwiLCBcInJhZGlvXCIsIFwiY2hlY2tib3hcIiwgXCJ0ZXh0YXJlYVwiLCBcImZpbGVcIiBvciBcInVybFwiLCBnb3QgXCIiLmNvbmNhdChwYXJhbXMuaW5wdXQsICJcIiIpKTsKICB9CgogIHZhciBpbnB1dCA9IHJlbmRlcklucHV0VHlwZVtwYXJhbXMuaW5wdXRdKHBhcmFtcyk7CiAgc2hvdyhpbnB1dCk7Cn07Cgp2YXIgcmVtb3ZlQXR0cmlidXRlcyA9IGZ1bmN0aW9uIHJlbW92ZUF0dHJpYnV0ZXMoaW5wdXQpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IGlucHV0LmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBhdHRyTmFtZSA9IGlucHV0LmF0dHJpYnV0ZXNbaV0ubmFtZTsKCiAgICBpZiAoIShbJ3R5cGUnLCAndmFsdWUnLCAnc3R5bGUnXS5pbmRleE9mKGF0dHJOYW1lKSAhPT0gLTEpKSB7CiAgICAgIGlucHV0LnJlbW92ZUF0dHJpYnV0ZShhdHRyTmFtZSk7CiAgICB9CiAgfQp9OwoKdmFyIHNldEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiBzZXRBdHRyaWJ1dGVzKGlucHV0VHlwZSwgaW5wdXRBdHRyaWJ1dGVzKSB7CiAgdmFyIGlucHV0ID0gZ2V0SW5wdXQoZ2V0Q29udGVudCgpLCBpbnB1dFR5cGUpOwoKICBpZiAoIWlucHV0KSB7CiAgICByZXR1cm47CiAgfQoKICByZW1vdmVBdHRyaWJ1dGVzKGlucHV0KTsKCiAgZm9yICh2YXIgYXR0ciBpbiBpbnB1dEF0dHJpYnV0ZXMpIHsKICAgIC8vIERvIG5vdCBzZXQgYSBwbGFjZWhvbGRlciBmb3IgPGlucHV0IHR5cGU9InJhbmdlIj4KICAgIC8vIGl0J2xsIGNyYXNoIEVkZ2UsICMxMjk4CiAgICBpZiAoaW5wdXRUeXBlID09PSAncmFuZ2UnICYmIGF0dHIgPT09ICdwbGFjZWhvbGRlcicpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgaW5wdXQuc2V0QXR0cmlidXRlKGF0dHIsIGlucHV0QXR0cmlidXRlc1thdHRyXSk7CiAgfQp9OwoKdmFyIHNldENsYXNzID0gZnVuY3Rpb24gc2V0Q2xhc3MoaW5wdXRDb250YWluZXIsIGlucHV0Q2xhc3MsIHBhcmFtcykgewogIGlucHV0Q29udGFpbmVyLmNsYXNzTmFtZSA9IGlucHV0Q2xhc3M7CgogIGlmIChwYXJhbXMuaW5wdXRDbGFzcykgewogICAgYWRkQ2xhc3MoaW5wdXRDb250YWluZXIsIHBhcmFtcy5pbnB1dENsYXNzKTsKICB9CgogIGlmIChwYXJhbXMuY3VzdG9tQ2xhc3MpIHsKICAgIGFkZENsYXNzKGlucHV0Q29udGFpbmVyLCBwYXJhbXMuY3VzdG9tQ2xhc3MuaW5wdXQpOwogIH0KfTsKCnZhciBzZXRJbnB1dFBsYWNlaG9sZGVyID0gZnVuY3Rpb24gc2V0SW5wdXRQbGFjZWhvbGRlcihpbnB1dCwgcGFyYW1zKSB7CiAgaWYgKCFpbnB1dC5wbGFjZWhvbGRlciB8fCBwYXJhbXMuaW5wdXRQbGFjZWhvbGRlcikgewogICAgaW5wdXQucGxhY2Vob2xkZXIgPSBwYXJhbXMuaW5wdXRQbGFjZWhvbGRlcjsKICB9Cn07Cgp2YXIgcmVuZGVySW5wdXRUeXBlID0ge307CgpyZW5kZXJJbnB1dFR5cGUudGV4dCA9IHJlbmRlcklucHV0VHlwZS5lbWFpbCA9IHJlbmRlcklucHV0VHlwZS5wYXNzd29yZCA9IHJlbmRlcklucHV0VHlwZS5udW1iZXIgPSByZW5kZXJJbnB1dFR5cGUudGVsID0gcmVuZGVySW5wdXRUeXBlLnVybCA9IGZ1bmN0aW9uIChwYXJhbXMpIHsKICB2YXIgaW5wdXQgPSBnZXRDaGlsZEJ5Q2xhc3MoZ2V0Q29udGVudCgpLCBzd2FsQ2xhc3Nlcy5pbnB1dCk7CgogIGlmICh0eXBlb2YgcGFyYW1zLmlucHV0VmFsdWUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBwYXJhbXMuaW5wdXRWYWx1ZSA9PT0gJ251bWJlcicpIHsKICAgIGlucHV0LnZhbHVlID0gcGFyYW1zLmlucHV0VmFsdWU7CiAgfSBlbHNlIGlmICghaXNQcm9taXNlKHBhcmFtcy5pbnB1dFZhbHVlKSkgewogICAgd2FybigiVW5leHBlY3RlZCB0eXBlIG9mIGlucHV0VmFsdWUhIEV4cGVjdGVkIFwic3RyaW5nXCIsIFwibnVtYmVyXCIgb3IgXCJQcm9taXNlXCIsIGdvdCBcIiIuY29uY2F0KF90eXBlb2YocGFyYW1zLmlucHV0VmFsdWUpLCAiXCIiKSk7CiAgfQoKICBzZXRJbnB1dFBsYWNlaG9sZGVyKGlucHV0LCBwYXJhbXMpOwogIGlucHV0LnR5cGUgPSBwYXJhbXMuaW5wdXQ7CiAgcmV0dXJuIGlucHV0Owp9OwoKcmVuZGVySW5wdXRUeXBlLmZpbGUgPSBmdW5jdGlvbiAocGFyYW1zKSB7CiAgdmFyIGlucHV0ID0gZ2V0Q2hpbGRCeUNsYXNzKGdldENvbnRlbnQoKSwgc3dhbENsYXNzZXMuZmlsZSk7CiAgc2V0SW5wdXRQbGFjZWhvbGRlcihpbnB1dCwgcGFyYW1zKTsKICBpbnB1dC50eXBlID0gcGFyYW1zLmlucHV0OwogIHJldHVybiBpbnB1dDsKfTsKCnJlbmRlcklucHV0VHlwZS5yYW5nZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHsKICB2YXIgcmFuZ2UgPSBnZXRDaGlsZEJ5Q2xhc3MoZ2V0Q29udGVudCgpLCBzd2FsQ2xhc3Nlcy5yYW5nZSk7CiAgdmFyIHJhbmdlSW5wdXQgPSByYW5nZS5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpOwogIHZhciByYW5nZU91dHB1dCA9IHJhbmdlLnF1ZXJ5U2VsZWN0b3IoJ291dHB1dCcpOwogIHJhbmdlSW5wdXQudmFsdWUgPSBwYXJhbXMuaW5wdXRWYWx1ZTsKICByYW5nZUlucHV0LnR5cGUgPSBwYXJhbXMuaW5wdXQ7CiAgcmFuZ2VPdXRwdXQudmFsdWUgPSBwYXJhbXMuaW5wdXRWYWx1ZTsKICByZXR1cm4gcmFuZ2U7Cn07CgpyZW5kZXJJbnB1dFR5cGUuc2VsZWN0ID0gZnVuY3Rpb24gKHBhcmFtcykgewogIHZhciBzZWxlY3QgPSBnZXRDaGlsZEJ5Q2xhc3MoZ2V0Q29udGVudCgpLCBzd2FsQ2xhc3Nlcy5zZWxlY3QpOwogIHNlbGVjdC5pbm5lckhUTUwgPSAnJzsKCiAgaWYgKHBhcmFtcy5pbnB1dFBsYWNlaG9sZGVyKSB7CiAgICB2YXIgcGxhY2Vob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsKICAgIHBsYWNlaG9sZGVyLmlubmVySFRNTCA9IHBhcmFtcy5pbnB1dFBsYWNlaG9sZGVyOwogICAgcGxhY2Vob2xkZXIudmFsdWUgPSAnJzsKICAgIHBsYWNlaG9sZGVyLmRpc2FibGVkID0gdHJ1ZTsKICAgIHBsYWNlaG9sZGVyLnNlbGVjdGVkID0gdHJ1ZTsKICAgIHNlbGVjdC5hcHBlbmRDaGlsZChwbGFjZWhvbGRlcik7CiAgfQoKICByZXR1cm4gc2VsZWN0Owp9OwoKcmVuZGVySW5wdXRUeXBlLnJhZGlvID0gZnVuY3Rpb24gKCkgewogIHZhciByYWRpbyA9IGdldENoaWxkQnlDbGFzcyhnZXRDb250ZW50KCksIHN3YWxDbGFzc2VzLnJhZGlvKTsKICByYWRpby5pbm5lckhUTUwgPSAnJzsKICByZXR1cm4gcmFkaW87Cn07CgpyZW5kZXJJbnB1dFR5cGUuY2hlY2tib3ggPSBmdW5jdGlvbiAocGFyYW1zKSB7CiAgdmFyIGNoZWNrYm94ID0gZ2V0Q2hpbGRCeUNsYXNzKGdldENvbnRlbnQoKSwgc3dhbENsYXNzZXMuY2hlY2tib3gpOwogIHZhciBjaGVja2JveElucHV0ID0gZ2V0SW5wdXQoZ2V0Q29udGVudCgpLCAnY2hlY2tib3gnKTsKICBjaGVja2JveElucHV0LnR5cGUgPSAnY2hlY2tib3gnOwogIGNoZWNrYm94SW5wdXQudmFsdWUgPSAxOwogIGNoZWNrYm94SW5wdXQuaWQgPSBzd2FsQ2xhc3Nlcy5jaGVja2JveDsKICBjaGVja2JveElucHV0LmNoZWNrZWQgPSBCb29sZWFuKHBhcmFtcy5pbnB1dFZhbHVlKTsKICB2YXIgbGFiZWwgPSBjaGVja2JveC5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7CiAgbGFiZWwuaW5uZXJIVE1MID0gcGFyYW1zLmlucHV0UGxhY2Vob2xkZXI7CiAgcmV0dXJuIGNoZWNrYm94Owp9OwoKcmVuZGVySW5wdXRUeXBlLnRleHRhcmVhID0gZnVuY3Rpb24gKHBhcmFtcykgewogIHZhciB0ZXh0YXJlYSA9IGdldENoaWxkQnlDbGFzcyhnZXRDb250ZW50KCksIHN3YWxDbGFzc2VzLnRleHRhcmVhKTsKICB0ZXh0YXJlYS52YWx1ZSA9IHBhcmFtcy5pbnB1dFZhbHVlOwogIHNldElucHV0UGxhY2Vob2xkZXIodGV4dGFyZWEsIHBhcmFtcyk7CiAgcmV0dXJuIHRleHRhcmVhOwp9OwoKdmFyIHJlbmRlckNvbnRlbnQgPSBmdW5jdGlvbiByZW5kZXJDb250ZW50KGluc3RhbmNlLCBwYXJhbXMpIHsKICB2YXIgY29udGVudCA9IGdldENvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcjJyArIHN3YWxDbGFzc2VzLmNvbnRlbnQpOyAvLyBDb250ZW50IGFzIEhUTUwKCiAgaWYgKHBhcmFtcy5odG1sKSB7CiAgICBwYXJzZUh0bWxUb0NvbnRhaW5lcihwYXJhbXMuaHRtbCwgY29udGVudCk7CiAgICBzaG93KGNvbnRlbnQsICdibG9jaycpOyAvLyBDb250ZW50IGFzIHBsYWluIHRleHQKICB9IGVsc2UgaWYgKHBhcmFtcy50ZXh0KSB7CiAgICBjb250ZW50LnRleHRDb250ZW50ID0gcGFyYW1zLnRleHQ7CiAgICBzaG93KGNvbnRlbnQsICdibG9jaycpOyAvLyBObyBjb250ZW50CiAgfSBlbHNlIHsKICAgIGhpZGUoY29udGVudCk7CiAgfQoKICByZW5kZXJJbnB1dChpbnN0YW5jZSwgcGFyYW1zKTsgLy8gQ3VzdG9tIGNsYXNzCgogIGFwcGx5Q3VzdG9tQ2xhc3MoZ2V0Q29udGVudCgpLCBwYXJhbXMuY3VzdG9tQ2xhc3MsICdjb250ZW50Jyk7Cn07Cgp2YXIgcmVuZGVyRm9vdGVyID0gZnVuY3Rpb24gcmVuZGVyRm9vdGVyKGluc3RhbmNlLCBwYXJhbXMpIHsKICB2YXIgZm9vdGVyID0gZ2V0Rm9vdGVyKCk7CiAgdG9nZ2xlKGZvb3RlciwgcGFyYW1zLmZvb3Rlcik7CgogIGlmIChwYXJhbXMuZm9vdGVyKSB7CiAgICBwYXJzZUh0bWxUb0NvbnRhaW5lcihwYXJhbXMuZm9vdGVyLCBmb290ZXIpOwogIH0gLy8gQ3VzdG9tIGNsYXNzCgoKICBhcHBseUN1c3RvbUNsYXNzKGZvb3RlciwgcGFyYW1zLmN1c3RvbUNsYXNzLCAnZm9vdGVyJyk7Cn07Cgp2YXIgcmVuZGVyQ2xvc2VCdXR0b24gPSBmdW5jdGlvbiByZW5kZXJDbG9zZUJ1dHRvbihpbnN0YW5jZSwgcGFyYW1zKSB7CiAgdmFyIGNsb3NlQnV0dG9uID0gZ2V0Q2xvc2VCdXR0b24oKTsKICBjbG9zZUJ1dHRvbi5pbm5lckhUTUwgPSBwYXJhbXMuY2xvc2VCdXR0b25IdG1sOyAvLyBDdXN0b20gY2xhc3MKCiAgYXBwbHlDdXN0b21DbGFzcyhjbG9zZUJ1dHRvbiwgcGFyYW1zLmN1c3RvbUNsYXNzLCAnY2xvc2VCdXR0b24nKTsKICB0b2dnbGUoY2xvc2VCdXR0b24sIHBhcmFtcy5zaG93Q2xvc2VCdXR0b24pOwogIGNsb3NlQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIHBhcmFtcy5jbG9zZUJ1dHRvbkFyaWFMYWJlbCk7Cn07Cgp2YXIgcmVuZGVySWNvbiA9IGZ1bmN0aW9uIHJlbmRlckljb24oaW5zdGFuY2UsIHBhcmFtcykgewogIHZhciBpbm5lclBhcmFtcyA9IHByaXZhdGVQcm9wcy5pbm5lclBhcmFtcy5nZXQoaW5zdGFuY2UpOyAvLyBpZiB0aGUgaWNvbiB3aXRoIHRoZSBnaXZlbiB0eXBlIGFscmVhZHkgcmVuZGVyZWQsCiAgLy8gYXBwbHkgdGhlIGN1c3RvbSBjbGFzcyB3aXRob3V0IHJlLXJlbmRlcmluZyB0aGUgaWNvbgoKICBpZiAoaW5uZXJQYXJhbXMgJiYgcGFyYW1zLnR5cGUgPT09IGlubmVyUGFyYW1zLnR5cGUgJiYgZ2V0SWNvbigpKSB7CiAgICBhcHBseUN1c3RvbUNsYXNzKGdldEljb24oKSwgcGFyYW1zLmN1c3RvbUNsYXNzLCAnaWNvbicpOwogICAgcmV0dXJuOwogIH0KCiAgaGlkZUFsbEljb25zKCk7CgogIGlmICghcGFyYW1zLnR5cGUpIHsKICAgIHJldHVybjsKICB9CgogIGFkanVzdFN1Y2Nlc3NJY29uQmFja2dvdW5kQ29sb3IoKTsKCiAgaWYgKE9iamVjdC5rZXlzKGljb25UeXBlcykuaW5kZXhPZihwYXJhbXMudHlwZSkgIT09IC0xKSB7CiAgICB2YXIgaWNvbiA9IGVsZW1lbnRCeVNlbGVjdG9yKCIuIi5jb25jYXQoc3dhbENsYXNzZXMuaWNvbiwgIi4iKS5jb25jYXQoaWNvblR5cGVzW3BhcmFtcy50eXBlXSkpOwogICAgc2hvdyhpY29uKTsgLy8gQ3VzdG9tIGNsYXNzCgogICAgYXBwbHlDdXN0b21DbGFzcyhpY29uLCBwYXJhbXMuY3VzdG9tQ2xhc3MsICdpY29uJyk7IC8vIEFuaW1hdGUgaWNvbgoKICAgIHRvZ2dsZUNsYXNzKGljb24sICJzd2FsMi1hbmltYXRlLSIuY29uY2F0KHBhcmFtcy50eXBlLCAiLWljb24iKSwgcGFyYW1zLmFuaW1hdGlvbik7CiAgfSBlbHNlIHsKICAgIGVycm9yKCJVbmtub3duIHR5cGUhIEV4cGVjdGVkIFwic3VjY2Vzc1wiLCBcImVycm9yXCIsIFwid2FybmluZ1wiLCBcImluZm9cIiBvciBcInF1ZXN0aW9uXCIsIGdvdCBcIiIuY29uY2F0KHBhcmFtcy50eXBlLCAiXCIiKSk7CiAgfQp9OwoKdmFyIGhpZGVBbGxJY29ucyA9IGZ1bmN0aW9uIGhpZGVBbGxJY29ucygpIHsKICB2YXIgaWNvbnMgPSBnZXRJY29ucygpOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IGljb25zLmxlbmd0aDsgaSsrKSB7CiAgICBoaWRlKGljb25zW2ldKTsKICB9Cn07IC8vIEFkanVzdCBzdWNjZXNzIGljb24gYmFja2dyb3VuZCBjb2xvciB0byBtYXRjaCB0aGUgcG9wdXAgYmFja2dyb3VuZCBjb2xvcgoKCnZhciBhZGp1c3RTdWNjZXNzSWNvbkJhY2tnb3VuZENvbG9yID0gZnVuY3Rpb24gYWRqdXN0U3VjY2Vzc0ljb25CYWNrZ291bmRDb2xvcigpIHsKICB2YXIgcG9wdXAgPSBnZXRQb3B1cCgpOwogIHZhciBwb3B1cEJhY2tncm91bmRDb2xvciA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHBvcHVwKS5nZXRQcm9wZXJ0eVZhbHVlKCdiYWNrZ3JvdW5kLWNvbG9yJyk7CiAgdmFyIHN1Y2Nlc3NJY29uUGFydHMgPSBwb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCdbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtY2lyY3VsYXItbGluZV0sIC5zd2FsMi1zdWNjZXNzLWZpeCcpOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IHN1Y2Nlc3NJY29uUGFydHMubGVuZ3RoOyBpKyspIHsKICAgIHN1Y2Nlc3NJY29uUGFydHNbaV0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gcG9wdXBCYWNrZ3JvdW5kQ29sb3I7CiAgfQp9OwoKdmFyIHJlbmRlckltYWdlID0gZnVuY3Rpb24gcmVuZGVySW1hZ2UoaW5zdGFuY2UsIHBhcmFtcykgewogIHZhciBpbWFnZSA9IGdldEltYWdlKCk7CgogIGlmICghcGFyYW1zLmltYWdlVXJsKSB7CiAgICByZXR1cm4gaGlkZShpbWFnZSk7CiAgfQoKICBzaG93KGltYWdlKTsgLy8gU3JjLCBhbHQKCiAgaW1hZ2Uuc2V0QXR0cmlidXRlKCdzcmMnLCBwYXJhbXMuaW1hZ2VVcmwpOwogIGltYWdlLnNldEF0dHJpYnV0ZSgnYWx0JywgcGFyYW1zLmltYWdlQWx0KTsgLy8gV2lkdGgsIGhlaWdodAoKICBhcHBseU51bWVyaWNhbFN0eWxlKGltYWdlLCAnd2lkdGgnLCBwYXJhbXMuaW1hZ2VXaWR0aCk7CiAgYXBwbHlOdW1lcmljYWxTdHlsZShpbWFnZSwgJ2hlaWdodCcsIHBhcmFtcy5pbWFnZUhlaWdodCk7IC8vIENsYXNzCgogIGltYWdlLmNsYXNzTmFtZSA9IHN3YWxDbGFzc2VzLmltYWdlOwogIGFwcGx5Q3VzdG9tQ2xhc3MoaW1hZ2UsIHBhcmFtcy5jdXN0b21DbGFzcywgJ2ltYWdlJyk7CgogIGlmIChwYXJhbXMuaW1hZ2VDbGFzcykgewogICAgYWRkQ2xhc3MoaW1hZ2UsIHBhcmFtcy5pbWFnZUNsYXNzKTsKICB9Cn07Cgp2YXIgY3JlYXRlU3RlcEVsZW1lbnQgPSBmdW5jdGlvbiBjcmVhdGVTdGVwRWxlbWVudChzdGVwKSB7CiAgdmFyIHN0ZXBFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7CiAgYWRkQ2xhc3Moc3RlcEVsLCBzd2FsQ2xhc3Nlc1sncHJvZ3Jlc3Mtc3RlcCddKTsKICBzdGVwRWwuaW5uZXJIVE1MID0gc3RlcDsKICByZXR1cm4gc3RlcEVsOwp9OwoKdmFyIGNyZWF0ZUxpbmVFbGVtZW50ID0gZnVuY3Rpb24gY3JlYXRlTGluZUVsZW1lbnQocGFyYW1zKSB7CiAgdmFyIGxpbmVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7CiAgYWRkQ2xhc3MobGluZUVsLCBzd2FsQ2xhc3Nlc1sncHJvZ3Jlc3Mtc3RlcC1saW5lJ10pOwoKICBpZiAocGFyYW1zLnByb2dyZXNzU3RlcHNEaXN0YW5jZSkgewogICAgbGluZUVsLnN0eWxlLndpZHRoID0gcGFyYW1zLnByb2dyZXNzU3RlcHNEaXN0YW5jZTsKICB9CgogIHJldHVybiBsaW5lRWw7Cn07Cgp2YXIgcmVuZGVyUHJvZ3Jlc3NTdGVwcyA9IGZ1bmN0aW9uIHJlbmRlclByb2dyZXNzU3RlcHMoaW5zdGFuY2UsIHBhcmFtcykgewogIHZhciBwcm9ncmVzc1N0ZXBzQ29udGFpbmVyID0gZ2V0UHJvZ3Jlc3NTdGVwcygpOwoKICBpZiAoIXBhcmFtcy5wcm9ncmVzc1N0ZXBzIHx8IHBhcmFtcy5wcm9ncmVzc1N0ZXBzLmxlbmd0aCA9PT0gMCkgewogICAgcmV0dXJuIGhpZGUocHJvZ3Jlc3NTdGVwc0NvbnRhaW5lcik7CiAgfQoKICBzaG93KHByb2dyZXNzU3RlcHNDb250YWluZXIpOwogIHByb2dyZXNzU3RlcHNDb250YWluZXIuaW5uZXJIVE1MID0gJyc7CiAgdmFyIGN1cnJlbnRQcm9ncmVzc1N0ZXAgPSBwYXJzZUludChwYXJhbXMuY3VycmVudFByb2dyZXNzU3RlcCA9PT0gbnVsbCA/IFN3YWwuZ2V0UXVldWVTdGVwKCkgOiBwYXJhbXMuY3VycmVudFByb2dyZXNzU3RlcCk7CgogIGlmIChjdXJyZW50UHJvZ3Jlc3NTdGVwID49IHBhcmFtcy5wcm9ncmVzc1N0ZXBzLmxlbmd0aCkgewogICAgd2FybignSW52YWxpZCBjdXJyZW50UHJvZ3Jlc3NTdGVwIHBhcmFtZXRlciwgaXQgc2hvdWxkIGJlIGxlc3MgdGhhbiBwcm9ncmVzc1N0ZXBzLmxlbmd0aCAnICsgJyhjdXJyZW50UHJvZ3Jlc3NTdGVwIGxpa2UgSlMgYXJyYXlzIHN0YXJ0cyBmcm9tIDApJyk7CiAgfQoKICBwYXJhbXMucHJvZ3Jlc3NTdGVwcy5mb3JFYWNoKGZ1bmN0aW9uIChzdGVwLCBpbmRleCkgewogICAgdmFyIHN0ZXBFbCA9IGNyZWF0ZVN0ZXBFbGVtZW50KHN0ZXApOwogICAgcHJvZ3Jlc3NTdGVwc0NvbnRhaW5lci5hcHBlbmRDaGlsZChzdGVwRWwpOwoKICAgIGlmIChpbmRleCA9PT0gY3VycmVudFByb2dyZXNzU3RlcCkgewogICAgICBhZGRDbGFzcyhzdGVwRWwsIHN3YWxDbGFzc2VzWydhY3RpdmUtcHJvZ3Jlc3Mtc3RlcCddKTsKICAgIH0KCiAgICBpZiAoaW5kZXggIT09IHBhcmFtcy5wcm9ncmVzc1N0ZXBzLmxlbmd0aCAtIDEpIHsKICAgICAgdmFyIGxpbmVFbCA9IGNyZWF0ZUxpbmVFbGVtZW50KHN0ZXApOwogICAgICBwcm9ncmVzc1N0ZXBzQ29udGFpbmVyLmFwcGVuZENoaWxkKGxpbmVFbCk7CiAgICB9CiAgfSk7Cn07Cgp2YXIgcmVuZGVyVGl0bGUgPSBmdW5jdGlvbiByZW5kZXJUaXRsZShpbnN0YW5jZSwgcGFyYW1zKSB7CiAgdmFyIHRpdGxlID0gZ2V0VGl0bGUoKTsKICB0b2dnbGUodGl0bGUsIHBhcmFtcy50aXRsZSB8fCBwYXJhbXMudGl0bGVUZXh0KTsKCiAgaWYgKHBhcmFtcy50aXRsZSkgewogICAgcGFyc2VIdG1sVG9Db250YWluZXIocGFyYW1zLnRpdGxlLCB0aXRsZSk7CiAgfQoKICBpZiAocGFyYW1zLnRpdGxlVGV4dCkgewogICAgdGl0bGUuaW5uZXJUZXh0ID0gcGFyYW1zLnRpdGxlVGV4dDsKICB9IC8vIEN1c3RvbSBjbGFzcwoKCiAgYXBwbHlDdXN0b21DbGFzcyh0aXRsZSwgcGFyYW1zLmN1c3RvbUNsYXNzLCAndGl0bGUnKTsKfTsKCnZhciByZW5kZXJIZWFkZXIgPSBmdW5jdGlvbiByZW5kZXJIZWFkZXIoaW5zdGFuY2UsIHBhcmFtcykgewogIHZhciBoZWFkZXIgPSBnZXRIZWFkZXIoKTsgLy8gQ3VzdG9tIGNsYXNzCgogIGFwcGx5Q3VzdG9tQ2xhc3MoaGVhZGVyLCBwYXJhbXMuY3VzdG9tQ2xhc3MsICdoZWFkZXInKTsgLy8gUHJvZ3Jlc3Mgc3RlcHMKCiAgcmVuZGVyUHJvZ3Jlc3NTdGVwcyhpbnN0YW5jZSwgcGFyYW1zKTsgLy8gSWNvbgoKICByZW5kZXJJY29uKGluc3RhbmNlLCBwYXJhbXMpOyAvLyBJbWFnZQoKICByZW5kZXJJbWFnZShpbnN0YW5jZSwgcGFyYW1zKTsgLy8gVGl0bGUKCiAgcmVuZGVyVGl0bGUoaW5zdGFuY2UsIHBhcmFtcyk7IC8vIENsb3NlIGJ1dHRvbgoKICByZW5kZXJDbG9zZUJ1dHRvbihpbnN0YW5jZSwgcGFyYW1zKTsKfTsKCnZhciByZW5kZXJQb3B1cCA9IGZ1bmN0aW9uIHJlbmRlclBvcHVwKGluc3RhbmNlLCBwYXJhbXMpIHsKICB2YXIgcG9wdXAgPSBnZXRQb3B1cCgpOyAvLyBXaWR0aAoKICBhcHBseU51bWVyaWNhbFN0eWxlKHBvcHVwLCAnd2lkdGgnLCBwYXJhbXMud2lkdGgpOyAvLyBQYWRkaW5nCgogIGFwcGx5TnVtZXJpY2FsU3R5bGUocG9wdXAsICdwYWRkaW5nJywgcGFyYW1zLnBhZGRpbmcpOyAvLyBCYWNrZ3JvdW5kCgogIGlmIChwYXJhbXMuYmFja2dyb3VuZCkgewogICAgcG9wdXAuc3R5bGUuYmFja2dyb3VuZCA9IHBhcmFtcy5iYWNrZ3JvdW5kOwogIH0gLy8gRGVmYXVsdCBDbGFzcwoKCiAgcG9wdXAuY2xhc3NOYW1lID0gc3dhbENsYXNzZXMucG9wdXA7CgogIGlmIChwYXJhbXMudG9hc3QpIHsKICAgIGFkZENsYXNzKFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIGRvY3VtZW50LmJvZHldLCBzd2FsQ2xhc3Nlc1sndG9hc3Qtc2hvd24nXSk7CiAgICBhZGRDbGFzcyhwb3B1cCwgc3dhbENsYXNzZXMudG9hc3QpOwogIH0gZWxzZSB7CiAgICBhZGRDbGFzcyhwb3B1cCwgc3dhbENsYXNzZXMubW9kYWwpOwogIH0gLy8gQ3VzdG9tIGNsYXNzCgoKICBhcHBseUN1c3RvbUNsYXNzKHBvcHVwLCBwYXJhbXMuY3VzdG9tQ2xhc3MsICdwb3B1cCcpOwoKICBpZiAodHlwZW9mIHBhcmFtcy5jdXN0b21DbGFzcyA9PT0gJ3N0cmluZycpIHsKICAgIGFkZENsYXNzKHBvcHVwLCBwYXJhbXMuY3VzdG9tQ2xhc3MpOwogIH0gLy8gQ1NTIGFuaW1hdGlvbgoKCiAgdG9nZ2xlQ2xhc3MocG9wdXAsIHN3YWxDbGFzc2VzLm5vYW5pbWF0aW9uLCAhcGFyYW1zLmFuaW1hdGlvbik7Cn07Cgp2YXIgcmVuZGVyID0gZnVuY3Rpb24gcmVuZGVyKGluc3RhbmNlLCBwYXJhbXMpIHsKICByZW5kZXJQb3B1cChpbnN0YW5jZSwgcGFyYW1zKTsKICByZW5kZXJDb250YWluZXIoaW5zdGFuY2UsIHBhcmFtcyk7CiAgcmVuZGVySGVhZGVyKGluc3RhbmNlLCBwYXJhbXMpOwogIHJlbmRlckNvbnRlbnQoaW5zdGFuY2UsIHBhcmFtcyk7CiAgcmVuZGVyQWN0aW9ucyhpbnN0YW5jZSwgcGFyYW1zKTsKICByZW5kZXJGb290ZXIoaW5zdGFuY2UsIHBhcmFtcyk7Cn07CgovKgogKiBHbG9iYWwgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIGlmIFN3ZWV0QWxlcnQyIHBvcHVwIGlzIHNob3duCiAqLwoKdmFyIGlzVmlzaWJsZSQxID0gZnVuY3Rpb24gaXNWaXNpYmxlJCQxKCkgewogIHJldHVybiBpc1Zpc2libGUoZ2V0UG9wdXAoKSk7Cn07Ci8qCiAqIEdsb2JhbCBmdW5jdGlvbiB0byBjbGljayAnQ29uZmlybScgYnV0dG9uCiAqLwoKdmFyIGNsaWNrQ29uZmlybSA9IGZ1bmN0aW9uIGNsaWNrQ29uZmlybSgpIHsKICByZXR1cm4gZ2V0Q29uZmlybUJ1dHRvbigpICYmIGdldENvbmZpcm1CdXR0b24oKS5jbGljaygpOwp9OwovKgogKiBHbG9iYWwgZnVuY3Rpb24gdG8gY2xpY2sgJ0NhbmNlbCcgYnV0dG9uCiAqLwoKdmFyIGNsaWNrQ2FuY2VsID0gZnVuY3Rpb24gY2xpY2tDYW5jZWwoKSB7CiAgcmV0dXJuIGdldENhbmNlbEJ1dHRvbigpICYmIGdldENhbmNlbEJ1dHRvbigpLmNsaWNrKCk7Cn07CgpmdW5jdGlvbiBmaXJlKCkgewogIHZhciBTd2FsID0gdGhpczsKCiAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogIH0KCiAgcmV0dXJuIF9jb25zdHJ1Y3QoU3dhbCwgYXJncyk7Cn0KCi8qKgogKiBSZXR1cm5zIGFuIGV4dGVuZGVkIHZlcnNpb24gb2YgYFN3YWxgIGNvbnRhaW5pbmcgYHBhcmFtc2AgYXMgZGVmYXVsdHMuCiAqIFVzZWZ1bCBmb3IgcmV1c2luZyBTd2FsIGNvbmZpZ3VyYXRpb24uCiAqCiAqIEZvciBleGFtcGxlOgogKgogKiBCZWZvcmU6CiAqIGNvbnN0IHRleHRQcm9tcHRPcHRpb25zID0geyBpbnB1dDogJ3RleHQnLCBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlIH0KICogY29uc3Qge3ZhbHVlOiBmaXJzdE5hbWV9ID0gYXdhaXQgU3dhbC5maXJlKHsgLi4udGV4dFByb21wdE9wdGlvbnMsIHRpdGxlOiAnV2hhdCBpcyB5b3VyIGZpcnN0IG5hbWU/JyB9KQogKiBjb25zdCB7dmFsdWU6IGxhc3ROYW1lfSA9IGF3YWl0IFN3YWwuZmlyZSh7IC4uLnRleHRQcm9tcHRPcHRpb25zLCB0aXRsZTogJ1doYXQgaXMgeW91ciBsYXN0IG5hbWU/JyB9KQogKgogKiBBZnRlcjoKICogY29uc3QgVGV4dFByb21wdCA9IFN3YWwubWl4aW4oeyBpbnB1dDogJ3RleHQnLCBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlIH0pCiAqIGNvbnN0IHt2YWx1ZTogZmlyc3ROYW1lfSA9IGF3YWl0IFRleHRQcm9tcHQoJ1doYXQgaXMgeW91ciBmaXJzdCBuYW1lPycpCiAqIGNvbnN0IHt2YWx1ZTogbGFzdE5hbWV9ID0gYXdhaXQgVGV4dFByb21wdCgnV2hhdCBpcyB5b3VyIGxhc3QgbmFtZT8nKQogKgogKiBAcGFyYW0gbWl4aW5QYXJhbXMKICovCmZ1bmN0aW9uIG1peGluKG1peGluUGFyYW1zKSB7CiAgdmFyIE1peGluU3dhbCA9CiAgLyojX19QVVJFX18qLwogIGZ1bmN0aW9uIChfdGhpcykgewogICAgX2luaGVyaXRzKE1peGluU3dhbCwgX3RoaXMpOwoKICAgIGZ1bmN0aW9uIE1peGluU3dhbCgpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1peGluU3dhbCk7CgogICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKE1peGluU3dhbCkuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7CiAgICB9CgogICAgX2NyZWF0ZUNsYXNzKE1peGluU3dhbCwgW3sKICAgICAga2V5OiAiX21haW4iLAogICAgICB2YWx1ZTogZnVuY3Rpb24gX21haW4ocGFyYW1zKSB7CiAgICAgICAgcmV0dXJuIF9nZXQoX2dldFByb3RvdHlwZU9mKE1peGluU3dhbC5wcm90b3R5cGUpLCAiX21haW4iLCB0aGlzKS5jYWxsKHRoaXMsIF9leHRlbmRzKHt9LCBtaXhpblBhcmFtcywgcGFyYW1zKSk7CiAgICAgIH0KICAgIH1dKTsKCiAgICByZXR1cm4gTWl4aW5Td2FsOwogIH0odGhpcyk7CgogIHJldHVybiBNaXhpblN3YWw7Cn0KCi8vIHByaXZhdGUgZ2xvYmFsIHN0YXRlIGZvciB0aGUgcXVldWUgZmVhdHVyZQp2YXIgY3VycmVudFN0ZXBzID0gW107Ci8qCiAqIEdsb2JhbCBmdW5jdGlvbiBmb3IgY2hhaW5pbmcgc3dlZXRBbGVydCBwb3B1cHMKICovCgp2YXIgcXVldWUgPSBmdW5jdGlvbiBxdWV1ZShzdGVwcykgewogIHZhciBTd2FsID0gdGhpczsKICBjdXJyZW50U3RlcHMgPSBzdGVwczsKCiAgdmFyIHJlc2V0QW5kUmVzb2x2ZSA9IGZ1bmN0aW9uIHJlc2V0QW5kUmVzb2x2ZShyZXNvbHZlLCB2YWx1ZSkgewogICAgY3VycmVudFN0ZXBzID0gW107CiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1zd2FsMi1xdWV1ZS1zdGVwJyk7CiAgICByZXNvbHZlKHZhbHVlKTsKICB9OwoKICB2YXIgcXVldWVSZXN1bHQgPSBbXTsKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgIChmdW5jdGlvbiBzdGVwKGksIGNhbGxiYWNrKSB7CiAgICAgIGlmIChpIDwgY3VycmVudFN0ZXBzLmxlbmd0aCkgewogICAgICAgIGRvY3VtZW50LmJvZHkuc2V0QXR0cmlidXRlKCdkYXRhLXN3YWwyLXF1ZXVlLXN0ZXAnLCBpKTsKICAgICAgICBTd2FsLmZpcmUoY3VycmVudFN0ZXBzW2ldKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgIGlmICh0eXBlb2YgcmVzdWx0LnZhbHVlICE9PSAndW5kZWZpbmVkJykgewogICAgICAgICAgICBxdWV1ZVJlc3VsdC5wdXNoKHJlc3VsdC52YWx1ZSk7CiAgICAgICAgICAgIHN0ZXAoaSArIDEsIGNhbGxiYWNrKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlc2V0QW5kUmVzb2x2ZShyZXNvbHZlLCB7CiAgICAgICAgICAgICAgZGlzbWlzczogcmVzdWx0LmRpc21pc3MKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzZXRBbmRSZXNvbHZlKHJlc29sdmUsIHsKICAgICAgICAgIHZhbHVlOiBxdWV1ZVJlc3VsdAogICAgICAgIH0pOwogICAgICB9CiAgICB9KSgwKTsKICB9KTsKfTsKLyoKICogR2xvYmFsIGZ1bmN0aW9uIGZvciBnZXR0aW5nIHRoZSBpbmRleCBvZiBjdXJyZW50IHBvcHVwIGluIHF1ZXVlCiAqLwoKdmFyIGdldFF1ZXVlU3RlcCA9IGZ1bmN0aW9uIGdldFF1ZXVlU3RlcCgpIHsKICByZXR1cm4gZG9jdW1lbnQuYm9keS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc3dhbDItcXVldWUtc3RlcCcpOwp9OwovKgogKiBHbG9iYWwgZnVuY3Rpb24gZm9yIGluc2VydGluZyBhIHBvcHVwIHRvIHRoZSBxdWV1ZQogKi8KCnZhciBpbnNlcnRRdWV1ZVN0ZXAgPSBmdW5jdGlvbiBpbnNlcnRRdWV1ZVN0ZXAoc3RlcCwgaW5kZXgpIHsKICBpZiAoaW5kZXggJiYgaW5kZXggPCBjdXJyZW50U3RlcHMubGVuZ3RoKSB7CiAgICByZXR1cm4gY3VycmVudFN0ZXBzLnNwbGljZShpbmRleCwgMCwgc3RlcCk7CiAgfQoKICByZXR1cm4gY3VycmVudFN0ZXBzLnB1c2goc3RlcCk7Cn07Ci8qCiAqIEdsb2JhbCBmdW5jdGlvbiBmb3IgZGVsZXRpbmcgYSBwb3B1cCBmcm9tIHRoZSBxdWV1ZQogKi8KCnZhciBkZWxldGVRdWV1ZVN0ZXAgPSBmdW5jdGlvbiBkZWxldGVRdWV1ZVN0ZXAoaW5kZXgpIHsKICBpZiAodHlwZW9mIGN1cnJlbnRTdGVwc1tpbmRleF0gIT09ICd1bmRlZmluZWQnKSB7CiAgICBjdXJyZW50U3RlcHMuc3BsaWNlKGluZGV4LCAxKTsKICB9Cn07CgovKioKICogU2hvdyBzcGlubmVyIGluc3RlYWQgb2YgQ29uZmlybSBidXR0b24gYW5kIGRpc2FibGUgQ2FuY2VsIGJ1dHRvbgogKi8KCnZhciBzaG93TG9hZGluZyA9IGZ1bmN0aW9uIHNob3dMb2FkaW5nKCkgewogIHZhciBwb3B1cCA9IGdldFBvcHVwKCk7CgogIGlmICghcG9wdXApIHsKICAgIFN3YWwuZmlyZSgnJyk7CiAgfQoKICBwb3B1cCA9IGdldFBvcHVwKCk7CiAgdmFyIGFjdGlvbnMgPSBnZXRBY3Rpb25zKCk7CiAgdmFyIGNvbmZpcm1CdXR0b24gPSBnZXRDb25maXJtQnV0dG9uKCk7CiAgdmFyIGNhbmNlbEJ1dHRvbiA9IGdldENhbmNlbEJ1dHRvbigpOwogIHNob3coYWN0aW9ucyk7CiAgc2hvdyhjb25maXJtQnV0dG9uKTsKICBhZGRDbGFzcyhbcG9wdXAsIGFjdGlvbnNdLCBzd2FsQ2xhc3Nlcy5sb2FkaW5nKTsKICBjb25maXJtQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTsKICBjYW5jZWxCdXR0b24uZGlzYWJsZWQgPSB0cnVlOwogIHBvcHVwLnNldEF0dHJpYnV0ZSgnZGF0YS1sb2FkaW5nJywgdHJ1ZSk7CiAgcG9wdXAuc2V0QXR0cmlidXRlKCdhcmlhLWJ1c3knLCB0cnVlKTsKICBwb3B1cC5mb2N1cygpOwp9OwoKdmFyIFJFU1RPUkVfRk9DVVNfVElNRU9VVCA9IDEwMDsKCnZhciBnbG9iYWxTdGF0ZSA9IHt9Owp2YXIgZm9jdXNQcmV2aW91c0FjdGl2ZUVsZW1lbnQgPSBmdW5jdGlvbiBmb2N1c1ByZXZpb3VzQWN0aXZlRWxlbWVudCgpIHsKICBpZiAoZ2xvYmFsU3RhdGUucHJldmlvdXNBY3RpdmVFbGVtZW50ICYmIGdsb2JhbFN0YXRlLnByZXZpb3VzQWN0aXZlRWxlbWVudC5mb2N1cykgewogICAgZ2xvYmFsU3RhdGUucHJldmlvdXNBY3RpdmVFbGVtZW50LmZvY3VzKCk7CiAgICBnbG9iYWxTdGF0ZS5wcmV2aW91c0FjdGl2ZUVsZW1lbnQgPSBudWxsOwogIH0gZWxzZSBpZiAoZG9jdW1lbnQuYm9keSkgewogICAgZG9jdW1lbnQuYm9keS5mb2N1cygpOwogIH0KfTsgLy8gUmVzdG9yZSBwcmV2aW91cyBhY3RpdmUgKGZvY3VzZWQpIGVsZW1lbnQKCgp2YXIgcmVzdG9yZUFjdGl2ZUVsZW1lbnQgPSBmdW5jdGlvbiByZXN0b3JlQWN0aXZlRWxlbWVudCgpIHsKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgIHZhciB4ID0gd2luZG93LnNjcm9sbFg7CiAgICB2YXIgeSA9IHdpbmRvdy5zY3JvbGxZOwogICAgZ2xvYmFsU3RhdGUucmVzdG9yZUZvY3VzVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICBmb2N1c1ByZXZpb3VzQWN0aXZlRWxlbWVudCgpOwogICAgICByZXNvbHZlKCk7CiAgICB9LCBSRVNUT1JFX0ZPQ1VTX1RJTUVPVVQpOyAvLyBpc3N1ZXMvOTAwCgogICAgaWYgKHR5cGVvZiB4ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgeSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgLy8gSUUgZG9lc24ndCBoYXZlIHNjcm9sbFgvc2Nyb2xsWSBzdXBwb3J0CiAgICAgIHdpbmRvdy5zY3JvbGxUbyh4LCB5KTsKICAgIH0KICB9KTsKfTsKCi8qKgogKiBJZiBgdGltZXJgIHBhcmFtZXRlciBpcyBzZXQsIHJldHVybnMgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBvZiB0aW1lciByZW1haW5lZC4KICogT3RoZXJ3aXNlLCByZXR1cm5zIHVuZGVmaW5lZC4KICovCgp2YXIgZ2V0VGltZXJMZWZ0ID0gZnVuY3Rpb24gZ2V0VGltZXJMZWZ0KCkgewogIHJldHVybiBnbG9iYWxTdGF0ZS50aW1lb3V0ICYmIGdsb2JhbFN0YXRlLnRpbWVvdXQuZ2V0VGltZXJMZWZ0KCk7Cn07Ci8qKgogKiBTdG9wIHRpbWVyLiBSZXR1cm5zIG51bWJlciBvZiBtaWxsaXNlY29uZHMgb2YgdGltZXIgcmVtYWluZWQuCiAqIElmIGB0aW1lcmAgcGFyYW1ldGVyIGlzbid0IHNldCwgcmV0dXJucyB1bmRlZmluZWQuCiAqLwoKdmFyIHN0b3BUaW1lciA9IGZ1bmN0aW9uIHN0b3BUaW1lcigpIHsKICByZXR1cm4gZ2xvYmFsU3RhdGUudGltZW91dCAmJiBnbG9iYWxTdGF0ZS50aW1lb3V0LnN0b3AoKTsKfTsKLyoqCiAqIFJlc3VtZSB0aW1lci4gUmV0dXJucyBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIG9mIHRpbWVyIHJlbWFpbmVkLgogKiBJZiBgdGltZXJgIHBhcmFtZXRlciBpc24ndCBzZXQsIHJldHVybnMgdW5kZWZpbmVkLgogKi8KCnZhciByZXN1bWVUaW1lciA9IGZ1bmN0aW9uIHJlc3VtZVRpbWVyKCkgewogIHJldHVybiBnbG9iYWxTdGF0ZS50aW1lb3V0ICYmIGdsb2JhbFN0YXRlLnRpbWVvdXQuc3RhcnQoKTsKfTsKLyoqCiAqIFJlc3VtZSB0aW1lci4gUmV0dXJucyBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIG9mIHRpbWVyIHJlbWFpbmVkLgogKiBJZiBgdGltZXJgIHBhcmFtZXRlciBpc24ndCBzZXQsIHJldHVybnMgdW5kZWZpbmVkLgogKi8KCnZhciB0b2dnbGVUaW1lciA9IGZ1bmN0aW9uIHRvZ2dsZVRpbWVyKCkgewogIHZhciB0aW1lciA9IGdsb2JhbFN0YXRlLnRpbWVvdXQ7CiAgcmV0dXJuIHRpbWVyICYmICh0aW1lci5ydW5uaW5nID8gdGltZXIuc3RvcCgpIDogdGltZXIuc3RhcnQoKSk7Cn07Ci8qKgogKiBJbmNyZWFzZSB0aW1lci4gUmV0dXJucyBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIG9mIGFuIHVwZGF0ZWQgdGltZXIuCiAqIElmIGB0aW1lcmAgcGFyYW1ldGVyIGlzbid0IHNldCwgcmV0dXJucyB1bmRlZmluZWQuCiAqLwoKdmFyIGluY3JlYXNlVGltZXIgPSBmdW5jdGlvbiBpbmNyZWFzZVRpbWVyKG4pIHsKICByZXR1cm4gZ2xvYmFsU3RhdGUudGltZW91dCAmJiBnbG9iYWxTdGF0ZS50aW1lb3V0LmluY3JlYXNlKG4pOwp9OwovKioKICogQ2hlY2sgaWYgdGltZXIgaXMgcnVubmluZy4gUmV0dXJucyB0cnVlIGlmIHRpbWVyIGlzIHJ1bm5pbmcKICogb3IgZmFsc2UgaWYgdGltZXIgaXMgcGF1c2VkIG9yIHN0b3BwZWQuCiAqIElmIGB0aW1lcmAgcGFyYW1ldGVyIGlzbid0IHNldCwgcmV0dXJucyB1bmRlZmluZWQKICovCgp2YXIgaXNUaW1lclJ1bm5pbmcgPSBmdW5jdGlvbiBpc1RpbWVyUnVubmluZygpIHsKICByZXR1cm4gZ2xvYmFsU3RhdGUudGltZW91dCAmJiBnbG9iYWxTdGF0ZS50aW1lb3V0LmlzUnVubmluZygpOwp9OwoKdmFyIGRlZmF1bHRQYXJhbXMgPSB7CiAgdGl0bGU6ICcnLAogIHRpdGxlVGV4dDogJycsCiAgdGV4dDogJycsCiAgaHRtbDogJycsCiAgZm9vdGVyOiAnJywKICB0eXBlOiBudWxsLAogIHRvYXN0OiBmYWxzZSwKICBjdXN0b21DbGFzczogJycsCiAgY3VzdG9tQ29udGFpbmVyQ2xhc3M6ICcnLAogIHRhcmdldDogJ2JvZHknLAogIGJhY2tkcm9wOiB0cnVlLAogIGFuaW1hdGlvbjogdHJ1ZSwKICBoZWlnaHRBdXRvOiB0cnVlLAogIGFsbG93T3V0c2lkZUNsaWNrOiB0cnVlLAogIGFsbG93RXNjYXBlS2V5OiB0cnVlLAogIGFsbG93RW50ZXJLZXk6IHRydWUsCiAgc3RvcEtleWRvd25Qcm9wYWdhdGlvbjogdHJ1ZSwKICBrZXlkb3duTGlzdGVuZXJDYXB0dXJlOiBmYWxzZSwKICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSwKICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICBwcmVDb25maXJtOiBudWxsLAogIGNvbmZpcm1CdXR0b25UZXh0OiAnT0snLAogIGNvbmZpcm1CdXR0b25BcmlhTGFiZWw6ICcnLAogIGNvbmZpcm1CdXR0b25Db2xvcjogbnVsbCwKICBjb25maXJtQnV0dG9uQ2xhc3M6ICcnLAogIGNhbmNlbEJ1dHRvblRleHQ6ICdDYW5jZWwnLAogIGNhbmNlbEJ1dHRvbkFyaWFMYWJlbDogJycsCiAgY2FuY2VsQnV0dG9uQ29sb3I6IG51bGwsCiAgY2FuY2VsQnV0dG9uQ2xhc3M6ICcnLAogIGJ1dHRvbnNTdHlsaW5nOiB0cnVlLAogIHJldmVyc2VCdXR0b25zOiBmYWxzZSwKICBmb2N1c0NvbmZpcm06IHRydWUsCiAgZm9jdXNDYW5jZWw6IGZhbHNlLAogIHNob3dDbG9zZUJ1dHRvbjogZmFsc2UsCiAgY2xvc2VCdXR0b25IdG1sOiAnJnRpbWVzOycsCiAgY2xvc2VCdXR0b25BcmlhTGFiZWw6ICdDbG9zZSB0aGlzIGRpYWxvZycsCiAgc2hvd0xvYWRlck9uQ29uZmlybTogZmFsc2UsCiAgaW1hZ2VVcmw6IG51bGwsCiAgaW1hZ2VXaWR0aDogbnVsbCwKICBpbWFnZUhlaWdodDogbnVsbCwKICBpbWFnZUFsdDogJycsCiAgaW1hZ2VDbGFzczogJycsCiAgdGltZXI6IG51bGwsCiAgd2lkdGg6IG51bGwsCiAgcGFkZGluZzogbnVsbCwKICBiYWNrZ3JvdW5kOiBudWxsLAogIGlucHV0OiBudWxsLAogIGlucHV0UGxhY2Vob2xkZXI6ICcnLAogIGlucHV0VmFsdWU6ICcnLAogIGlucHV0T3B0aW9uczoge30sCiAgaW5wdXRBdXRvVHJpbTogdHJ1ZSwKICBpbnB1dENsYXNzOiAnJywKICBpbnB1dEF0dHJpYnV0ZXM6IHt9LAogIGlucHV0VmFsaWRhdG9yOiBudWxsLAogIHZhbGlkYXRpb25NZXNzYWdlOiBudWxsLAogIGdyb3c6IGZhbHNlLAogIHBvc2l0aW9uOiAnY2VudGVyJywKICBwcm9ncmVzc1N0ZXBzOiBbXSwKICBjdXJyZW50UHJvZ3Jlc3NTdGVwOiBudWxsLAogIHByb2dyZXNzU3RlcHNEaXN0YW5jZTogbnVsbCwKICBvbkJlZm9yZU9wZW46IG51bGwsCiAgb25BZnRlckNsb3NlOiBudWxsLAogIG9uT3BlbjogbnVsbCwKICBvbkNsb3NlOiBudWxsLAogIHNjcm9sbGJhclBhZGRpbmc6IHRydWUKfTsKdmFyIHVwZGF0YWJsZVBhcmFtcyA9IFsndGl0bGUnLCAndGl0bGVUZXh0JywgJ3RleHQnLCAnaHRtbCcsICd0eXBlJywgJ2N1c3RvbUNsYXNzJywgJ3Nob3dDb25maXJtQnV0dG9uJywgJ3Nob3dDYW5jZWxCdXR0b24nLCAnY29uZmlybUJ1dHRvblRleHQnLCAnY29uZmlybUJ1dHRvbkFyaWFMYWJlbCcsICdjb25maXJtQnV0dG9uQ29sb3InLCAnY29uZmlybUJ1dHRvbkNsYXNzJywgJ2NhbmNlbEJ1dHRvblRleHQnLCAnY2FuY2VsQnV0dG9uQXJpYUxhYmVsJywgJ2NhbmNlbEJ1dHRvbkNvbG9yJywgJ2NhbmNlbEJ1dHRvbkNsYXNzJywgJ2J1dHRvbnNTdHlsaW5nJywgJ3JldmVyc2VCdXR0b25zJywgJ2ltYWdlVXJsJywgJ2ltYWdlV2lkdGgnLCAnaW1hZ2VIZWlndGgnLCAnaW1hZ2VBbHQnLCAnaW1hZ2VDbGFzcycsICdwcm9ncmVzc1N0ZXBzJywgJ2N1cnJlbnRQcm9ncmVzc1N0ZXAnXTsKdmFyIGRlcHJlY2F0ZWRQYXJhbXMgPSB7CiAgY3VzdG9tQ29udGFpbmVyQ2xhc3M6ICdjdXN0b21DbGFzcycsCiAgY29uZmlybUJ1dHRvbkNsYXNzOiAnY3VzdG9tQ2xhc3MnLAogIGNhbmNlbEJ1dHRvbkNsYXNzOiAnY3VzdG9tQ2xhc3MnLAogIGltYWdlQ2xhc3M6ICdjdXN0b21DbGFzcycsCiAgaW5wdXRDbGFzczogJ2N1c3RvbUNsYXNzJwp9Owp2YXIgdG9hc3RJbmNvbXBhdGlibGVQYXJhbXMgPSBbJ2FsbG93T3V0c2lkZUNsaWNrJywgJ2FsbG93RW50ZXJLZXknLCAnYmFja2Ryb3AnLCAnZm9jdXNDb25maXJtJywgJ2ZvY3VzQ2FuY2VsJywgJ2hlaWdodEF1dG8nLCAna2V5ZG93bkxpc3RlbmVyQ2FwdHVyZSddOwovKioKICogSXMgdmFsaWQgcGFyYW1ldGVyCiAqIEBwYXJhbSB7U3RyaW5nfSBwYXJhbU5hbWUKICovCgp2YXIgaXNWYWxpZFBhcmFtZXRlciA9IGZ1bmN0aW9uIGlzVmFsaWRQYXJhbWV0ZXIocGFyYW1OYW1lKSB7CiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkZWZhdWx0UGFyYW1zLCBwYXJhbU5hbWUpOwp9OwovKioKICogSXMgdmFsaWQgcGFyYW1ldGVyIGZvciBTd2FsLnVwZGF0ZSgpIG1ldGhvZAogKiBAcGFyYW0ge1N0cmluZ30gcGFyYW1OYW1lCiAqLwoKdmFyIGlzVXBkYXRhYmxlUGFyYW1ldGVyID0gZnVuY3Rpb24gaXNVcGRhdGFibGVQYXJhbWV0ZXIocGFyYW1OYW1lKSB7CiAgcmV0dXJuIHVwZGF0YWJsZVBhcmFtcy5pbmRleE9mKHBhcmFtTmFtZSkgIT09IC0xOwp9OwovKioKICogSXMgZGVwcmVjYXRlZCBwYXJhbWV0ZXIKICogQHBhcmFtIHtTdHJpbmd9IHBhcmFtTmFtZQogKi8KCnZhciBpc0RlcHJlY2F0ZWRQYXJhbWV0ZXIgPSBmdW5jdGlvbiBpc0RlcHJlY2F0ZWRQYXJhbWV0ZXIocGFyYW1OYW1lKSB7CiAgcmV0dXJuIGRlcHJlY2F0ZWRQYXJhbXNbcGFyYW1OYW1lXTsKfTsKCnZhciBjaGVja0lmUGFyYW1Jc1ZhbGlkID0gZnVuY3Rpb24gY2hlY2tJZlBhcmFtSXNWYWxpZChwYXJhbSkgewogIGlmICghaXNWYWxpZFBhcmFtZXRlcihwYXJhbSkpIHsKICAgIHdhcm4oIlVua25vd24gcGFyYW1ldGVyIFwiIi5jb25jYXQocGFyYW0sICJcIiIpKTsKICB9Cn07Cgp2YXIgY2hlY2tJZlRvYXN0UGFyYW1Jc1ZhbGlkID0gZnVuY3Rpb24gY2hlY2tJZlRvYXN0UGFyYW1Jc1ZhbGlkKHBhcmFtKSB7CiAgaWYgKHRvYXN0SW5jb21wYXRpYmxlUGFyYW1zLmluZGV4T2YocGFyYW0pICE9PSAtMSkgewogICAgd2FybigiVGhlIHBhcmFtZXRlciBcIiIuY29uY2F0KHBhcmFtLCAiXCIgaXMgaW5jb21wYXRpYmxlIHdpdGggdG9hc3RzIikpOwogIH0KfTsKCnZhciBjaGVja0lmUGFyYW1Jc0RlcHJlY2F0ZWQgPSBmdW5jdGlvbiBjaGVja0lmUGFyYW1Jc0RlcHJlY2F0ZWQocGFyYW0pIHsKICBpZiAoaXNEZXByZWNhdGVkUGFyYW1ldGVyKHBhcmFtKSkgewogICAgd2FybkFib3V0RGVwcmVhdGlvbihwYXJhbSwgaXNEZXByZWNhdGVkUGFyYW1ldGVyKHBhcmFtKSk7CiAgfQp9OwovKioKICogU2hvdyByZWxldmFudCB3YXJuaW5ncyBmb3IgZ2l2ZW4gcGFyYW1zCiAqCiAqIEBwYXJhbSBwYXJhbXMKICovCgoKdmFyIHNob3dXYXJuaW5nc0ZvclBhcmFtcyA9IGZ1bmN0aW9uIHNob3dXYXJuaW5nc0ZvclBhcmFtcyhwYXJhbXMpIHsKICBmb3IgKHZhciBwYXJhbSBpbiBwYXJhbXMpIHsKICAgIGNoZWNrSWZQYXJhbUlzVmFsaWQocGFyYW0pOwoKICAgIGlmIChwYXJhbXMudG9hc3QpIHsKICAgICAgY2hlY2tJZlRvYXN0UGFyYW1Jc1ZhbGlkKHBhcmFtKTsKICAgIH0KCiAgICBjaGVja0lmUGFyYW1Jc0RlcHJlY2F0ZWQoKTsKICB9Cn07CgoKCnZhciBzdGF0aWNNZXRob2RzID0gT2JqZWN0LmZyZWV6ZSh7Cglpc1ZhbGlkUGFyYW1ldGVyOiBpc1ZhbGlkUGFyYW1ldGVyLAoJaXNVcGRhdGFibGVQYXJhbWV0ZXI6IGlzVXBkYXRhYmxlUGFyYW1ldGVyLAoJaXNEZXByZWNhdGVkUGFyYW1ldGVyOiBpc0RlcHJlY2F0ZWRQYXJhbWV0ZXIsCglhcmdzVG9QYXJhbXM6IGFyZ3NUb1BhcmFtcywKCWlzVmlzaWJsZTogaXNWaXNpYmxlJDEsCgljbGlja0NvbmZpcm06IGNsaWNrQ29uZmlybSwKCWNsaWNrQ2FuY2VsOiBjbGlja0NhbmNlbCwKCWdldENvbnRhaW5lcjogZ2V0Q29udGFpbmVyLAoJZ2V0UG9wdXA6IGdldFBvcHVwLAoJZ2V0VGl0bGU6IGdldFRpdGxlLAoJZ2V0Q29udGVudDogZ2V0Q29udGVudCwKCWdldEltYWdlOiBnZXRJbWFnZSwKCWdldEljb246IGdldEljb24sCglnZXRJY29uczogZ2V0SWNvbnMsCglnZXRDbG9zZUJ1dHRvbjogZ2V0Q2xvc2VCdXR0b24sCglnZXRBY3Rpb25zOiBnZXRBY3Rpb25zLAoJZ2V0Q29uZmlybUJ1dHRvbjogZ2V0Q29uZmlybUJ1dHRvbiwKCWdldENhbmNlbEJ1dHRvbjogZ2V0Q2FuY2VsQnV0dG9uLAoJZ2V0SGVhZGVyOiBnZXRIZWFkZXIsCglnZXRGb290ZXI6IGdldEZvb3RlciwKCWdldEZvY3VzYWJsZUVsZW1lbnRzOiBnZXRGb2N1c2FibGVFbGVtZW50cywKCWdldFZhbGlkYXRpb25NZXNzYWdlOiBnZXRWYWxpZGF0aW9uTWVzc2FnZSwKCWlzTG9hZGluZzogaXNMb2FkaW5nLAoJZmlyZTogZmlyZSwKCW1peGluOiBtaXhpbiwKCXF1ZXVlOiBxdWV1ZSwKCWdldFF1ZXVlU3RlcDogZ2V0UXVldWVTdGVwLAoJaW5zZXJ0UXVldWVTdGVwOiBpbnNlcnRRdWV1ZVN0ZXAsCglkZWxldGVRdWV1ZVN0ZXA6IGRlbGV0ZVF1ZXVlU3RlcCwKCXNob3dMb2FkaW5nOiBzaG93TG9hZGluZywKCWVuYWJsZUxvYWRpbmc6IHNob3dMb2FkaW5nLAoJZ2V0VGltZXJMZWZ0OiBnZXRUaW1lckxlZnQsCglzdG9wVGltZXI6IHN0b3BUaW1lciwKCXJlc3VtZVRpbWVyOiByZXN1bWVUaW1lciwKCXRvZ2dsZVRpbWVyOiB0b2dnbGVUaW1lciwKCWluY3JlYXNlVGltZXI6IGluY3JlYXNlVGltZXIsCglpc1RpbWVyUnVubmluZzogaXNUaW1lclJ1bm5pbmcKfSk7CgovKioKICogRW5hYmxlcyBidXR0b25zIGFuZCBoaWRlIGxvYWRlci4KICovCgpmdW5jdGlvbiBoaWRlTG9hZGluZygpIHsKICB2YXIgaW5uZXJQYXJhbXMgPSBwcml2YXRlUHJvcHMuaW5uZXJQYXJhbXMuZ2V0KHRoaXMpOwogIHZhciBkb21DYWNoZSA9IHByaXZhdGVQcm9wcy5kb21DYWNoZS5nZXQodGhpcyk7CgogIGlmICghaW5uZXJQYXJhbXMuc2hvd0NvbmZpcm1CdXR0b24pIHsKICAgIGhpZGUoZG9tQ2FjaGUuY29uZmlybUJ1dHRvbik7CgogICAgaWYgKCFpbm5lclBhcmFtcy5zaG93Q2FuY2VsQnV0dG9uKSB7CiAgICAgIGhpZGUoZG9tQ2FjaGUuYWN0aW9ucyk7CiAgICB9CiAgfQoKICByZW1vdmVDbGFzcyhbZG9tQ2FjaGUucG9wdXAsIGRvbUNhY2hlLmFjdGlvbnNdLCBzd2FsQ2xhc3Nlcy5sb2FkaW5nKTsKICBkb21DYWNoZS5wb3B1cC5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtYnVzeScpOwogIGRvbUNhY2hlLnBvcHVwLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1sb2FkaW5nJyk7CiAgZG9tQ2FjaGUuY29uZmlybUJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlOwogIGRvbUNhY2hlLmNhbmNlbEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlOwp9CgpmdW5jdGlvbiBnZXRJbnB1dCQxKGluc3RhbmNlKSB7CiAgdmFyIGlubmVyUGFyYW1zID0gcHJpdmF0ZVByb3BzLmlubmVyUGFyYW1zLmdldChpbnN0YW5jZSB8fCB0aGlzKTsKICB2YXIgZG9tQ2FjaGUgPSBwcml2YXRlUHJvcHMuZG9tQ2FjaGUuZ2V0KGluc3RhbmNlIHx8IHRoaXMpOwoKICBpZiAoIWRvbUNhY2hlKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIHJldHVybiBnZXRJbnB1dChkb21DYWNoZS5jb250ZW50LCBpbm5lclBhcmFtcy5pbnB1dCk7Cn0KCnZhciBmaXhTY3JvbGxiYXIgPSBmdW5jdGlvbiBmaXhTY3JvbGxiYXIoKSB7CiAgLy8gZm9yIHF1ZXVlcywgZG8gbm90IGRvIHRoaXMgbW9yZSB0aGFuIG9uY2UKICBpZiAoc3RhdGVzLnByZXZpb3VzQm9keVBhZGRpbmcgIT09IG51bGwpIHsKICAgIHJldHVybjsKICB9IC8vIGlmIHRoZSBib2R5IGhhcyBvdmVyZmxvdwoKCiAgaWYgKGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0ID4gd2luZG93LmlubmVySGVpZ2h0KSB7CiAgICAvLyBhZGQgcGFkZGluZyBzbyB0aGUgY29udGVudCBkb2Vzbid0IHNoaWZ0IGFmdGVyIHJlbW92YWwgb2Ygc2Nyb2xsYmFyCiAgICBzdGF0ZXMucHJldmlvdXNCb2R5UGFkZGluZyA9IHBhcnNlSW50KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctcmlnaHQnKSk7CiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnBhZGRpbmdSaWdodCA9IHN0YXRlcy5wcmV2aW91c0JvZHlQYWRkaW5nICsgbWVhc3VyZVNjcm9sbGJhcigpICsgJ3B4JzsKICB9Cn07CnZhciB1bmRvU2Nyb2xsYmFyID0gZnVuY3Rpb24gdW5kb1Njcm9sbGJhcigpIHsKICBpZiAoc3RhdGVzLnByZXZpb3VzQm9keVBhZGRpbmcgIT09IG51bGwpIHsKICAgIGRvY3VtZW50LmJvZHkuc3R5bGUucGFkZGluZ1JpZ2h0ID0gc3RhdGVzLnByZXZpb3VzQm9keVBhZGRpbmcgKyAncHgnOwogICAgc3RhdGVzLnByZXZpb3VzQm9keVBhZGRpbmcgPSBudWxsOwogIH0KfTsKCi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCgp2YXIgaU9TZml4ID0gZnVuY3Rpb24gaU9TZml4KCkgewogIHZhciBpT1MgPSAvaVBhZHxpUGhvbmV8aVBvZC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSAmJiAhd2luZG93Lk1TU3RyZWFtOwoKICBpZiAoaU9TICYmICFoYXNDbGFzcyhkb2N1bWVudC5ib2R5LCBzd2FsQ2xhc3Nlcy5pb3NmaXgpKSB7CiAgICB2YXIgb2Zmc2V0ID0gZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7CiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnRvcCA9IG9mZnNldCAqIC0xICsgJ3B4JzsKICAgIGFkZENsYXNzKGRvY3VtZW50LmJvZHksIHN3YWxDbGFzc2VzLmlvc2ZpeCk7CiAgICBsb2NrQm9keVNjcm9sbCgpOwogIH0KfTsKCnZhciBsb2NrQm9keVNjcm9sbCA9IGZ1bmN0aW9uIGxvY2tCb2R5U2Nyb2xsKCkgewogIC8vICMxMjQ2CiAgdmFyIGNvbnRhaW5lciA9IGdldENvbnRhaW5lcigpOwogIHZhciBwcmV2ZW50VG91Y2hNb3ZlOwoKICBjb250YWluZXIub250b3VjaHN0YXJ0ID0gZnVuY3Rpb24gKGUpIHsKICAgIHByZXZlbnRUb3VjaE1vdmUgPSBlLnRhcmdldCA9PT0gY29udGFpbmVyIHx8ICFpc1Njcm9sbGFibGUoY29udGFpbmVyKSAmJiBlLnRhcmdldC50YWdOYW1lICE9PSAnSU5QVVQnIC8vICMxNjAzCiAgICA7CiAgfTsKCiAgY29udGFpbmVyLm9udG91Y2htb3ZlID0gZnVuY3Rpb24gKGUpIHsKICAgIGlmIChwcmV2ZW50VG91Y2hNb3ZlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgIH0KICB9Owp9OwovKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoKCnZhciB1bmRvSU9TZml4ID0gZnVuY3Rpb24gdW5kb0lPU2ZpeCgpIHsKICBpZiAoaGFzQ2xhc3MoZG9jdW1lbnQuYm9keSwgc3dhbENsYXNzZXMuaW9zZml4KSkgewogICAgdmFyIG9mZnNldCA9IHBhcnNlSW50KGRvY3VtZW50LmJvZHkuc3R5bGUudG9wLCAxMCk7CiAgICByZW1vdmVDbGFzcyhkb2N1bWVudC5ib2R5LCBzd2FsQ2xhc3Nlcy5pb3NmaXgpOwogICAgZG9jdW1lbnQuYm9keS5zdHlsZS50b3AgPSAnJzsKICAgIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gb2Zmc2V0ICogLTE7CiAgfQp9OwoKdmFyIGlzSUUxMSA9IGZ1bmN0aW9uIGlzSUUxMSgpIHsKICByZXR1cm4gISF3aW5kb3cuTVNJbnB1dE1ldGhvZENvbnRleHQgJiYgISFkb2N1bWVudC5kb2N1bWVudE1vZGU7Cn07IC8vIEZpeCBJRTExIGNlbnRlcmluZyBzd2VldGFsZXJ0Mi9pc3N1ZXMvOTMzCgovKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoKCnZhciBmaXhWZXJ0aWNhbFBvc2l0aW9uSUUgPSBmdW5jdGlvbiBmaXhWZXJ0aWNhbFBvc2l0aW9uSUUoKSB7CiAgdmFyIGNvbnRhaW5lciA9IGdldENvbnRhaW5lcigpOwogIHZhciBwb3B1cCA9IGdldFBvcHVwKCk7CiAgY29udGFpbmVyLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdhbGlnbi1pdGVtcycpOwoKICBpZiAocG9wdXAub2Zmc2V0VG9wIDwgMCkgewogICAgY29udGFpbmVyLnN0eWxlLmFsaWduSXRlbXMgPSAnZmxleC1zdGFydCc7CiAgfQp9OwovKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoKCnZhciBJRWZpeCA9IGZ1bmN0aW9uIElFZml4KCkgewogIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiBpc0lFMTEoKSkgewogICAgZml4VmVydGljYWxQb3NpdGlvbklFKCk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZml4VmVydGljYWxQb3NpdGlvbklFKTsKICB9Cn07Ci8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCgp2YXIgdW5kb0lFZml4ID0gZnVuY3Rpb24gdW5kb0lFZml4KCkgewogIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiBpc0lFMTEoKSkgewogICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZpeFZlcnRpY2FsUG9zaXRpb25JRSk7CiAgfQp9OwoKLy8gQWRkaW5nIGFyaWEtaGlkZGVuPSJ0cnVlIiB0byBlbGVtZW50cyBvdXRzaWRlIG9mIHRoZSBhY3RpdmUgbW9kYWwgZGlhbG9nIGVuc3VyZXMgdGhhdAovLyBlbGVtZW50cyBub3Qgd2l0aGluIHRoZSBhY3RpdmUgbW9kYWwgZGlhbG9nIHdpbGwgbm90IGJlIHN1cmZhY2VkIGlmIGEgdXNlciBvcGVucyBhIHNjcmVlbgovLyByZWFkZXLigJlzIGxpc3Qgb2YgZWxlbWVudHMgKGhlYWRpbmdzLCBmb3JtIGNvbnRyb2xzLCBsYW5kbWFya3MsIGV0Yy4pIGluIHRoZSBkb2N1bWVudC4KCnZhciBzZXRBcmlhSGlkZGVuID0gZnVuY3Rpb24gc2V0QXJpYUhpZGRlbigpIHsKICB2YXIgYm9keUNoaWxkcmVuID0gdG9BcnJheShkb2N1bWVudC5ib2R5LmNoaWxkcmVuKTsKICBib2R5Q2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoZWwpIHsKICAgIGlmIChlbCA9PT0gZ2V0Q29udGFpbmVyKCkgfHwgY29udGFpbnMoZWwsIGdldENvbnRhaW5lcigpKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGVsLmhhc0F0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nKSkgewogICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcHJldmlvdXMtYXJpYS1oaWRkZW4nLCBlbC5nZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJykpOwogICAgfQoKICAgIGVsLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpOwogIH0pOwp9Owp2YXIgdW5zZXRBcmlhSGlkZGVuID0gZnVuY3Rpb24gdW5zZXRBcmlhSGlkZGVuKCkgewogIHZhciBib2R5Q2hpbGRyZW4gPSB0b0FycmF5KGRvY3VtZW50LmJvZHkuY2hpbGRyZW4pOwogIGJvZHlDaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChlbCkgewogICAgaWYgKGVsLmhhc0F0dHJpYnV0ZSgnZGF0YS1wcmV2aW91cy1hcmlhLWhpZGRlbicpKSB7CiAgICAgIGVsLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCBlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcHJldmlvdXMtYXJpYS1oaWRkZW4nKSk7CiAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1wcmV2aW91cy1hcmlhLWhpZGRlbicpOwogICAgfSBlbHNlIHsKICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWhpZGRlbicpOwogICAgfQogIH0pOwp9OwoKLyoqCiAqIFRoaXMgbW9kdWxlIGNvbnRhaW50cyBgV2Vha01hcGBzIGZvciBlYWNoIGVmZmVjdGl2ZWx5LSJwcml2YXRlICBwcm9wZXJ0eSIgdGhhdCBhIGBTd2FsYCBoYXMuCiAqIEZvciBleGFtcGxlLCB0byBzZXQgdGhlIHByaXZhdGUgcHJvcGVydHkgImZvbyIgb2YgYHRoaXNgIHRvICJiYXIiLCB5b3UgY2FuIGBwcml2YXRlUHJvcHMuZm9vLnNldCh0aGlzLCAnYmFyJylgCiAqIFRoaXMgaXMgdGhlIGFwcHJvYWNoIHRoYXQgQmFiZWwgd2lsbCBwcm9iYWJseSB0YWtlIHRvIGltcGxlbWVudCBwcml2YXRlIG1ldGhvZHMvZmllbGRzCiAqICAgaHR0cHM6Ly9naXRodWIuY29tL3RjMzkvcHJvcG9zYWwtcHJpdmF0ZS1tZXRob2RzCiAqICAgaHR0cHM6Ly9naXRodWIuY29tL2JhYmVsL2JhYmVsL3B1bGwvNzU1NQogKiBPbmNlIHdlIGhhdmUgdGhlIGNoYW5nZXMgZnJvbSB0aGF0IFBSIGluIEJhYmVsLCBhbmQgb3VyIGNvcmUgY2xhc3MgZml0cyByZWFzb25hYmxlIGluICpvbmUgbW9kdWxlKgogKiAgIHRoZW4gd2UgY2FuIHVzZSB0aGF0IGxhbmd1YWdlIGZlYXR1cmUuCiAqLwp2YXIgcHJpdmF0ZU1ldGhvZHMgPSB7CiAgc3dhbFByb21pc2VSZXNvbHZlOiBuZXcgV2Vha01hcCgpCn07CgovKgogKiBJbnN0YW5jZSBtZXRob2QgdG8gY2xvc2Ugc3dlZXRBbGVydAogKi8KCmZ1bmN0aW9uIHJlbW92ZVBvcHVwQW5kUmVzZXRTdGF0ZShpbnN0YW5jZSwgY29udGFpbmVyLCBpc1RvYXN0LCBvbkFmdGVyQ2xvc2UpIHsKICBpZiAoaXNUb2FzdCkgewogICAgdHJpZ2dlck9uQWZ0ZXJDbG9zZUFuZERpc3Bvc2UoaW5zdGFuY2UsIG9uQWZ0ZXJDbG9zZSk7CiAgfSBlbHNlIHsKICAgIHJlc3RvcmVBY3RpdmVFbGVtZW50KCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0cmlnZ2VyT25BZnRlckNsb3NlQW5kRGlzcG9zZShpbnN0YW5jZSwgb25BZnRlckNsb3NlKTsKICAgIH0pOwogICAgZ2xvYmFsU3RhdGUua2V5ZG93blRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZ2xvYmFsU3RhdGUua2V5ZG93bkhhbmRsZXIsIHsKICAgICAgY2FwdHVyZTogZ2xvYmFsU3RhdGUua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZQogICAgfSk7CiAgICBnbG9iYWxTdGF0ZS5rZXlkb3duSGFuZGxlckFkZGVkID0gZmFsc2U7CiAgfQoKICBpZiAoY29udGFpbmVyLnBhcmVudE5vZGUpIHsKICAgIGNvbnRhaW5lci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNvbnRhaW5lcik7CiAgfQoKICBpZiAoaXNNb2RhbCgpKSB7CiAgICB1bmRvU2Nyb2xsYmFyKCk7CiAgICB1bmRvSU9TZml4KCk7CiAgICB1bmRvSUVmaXgoKTsKICAgIHVuc2V0QXJpYUhpZGRlbigpOwogIH0KCiAgcmVtb3ZlQm9keUNsYXNzZXMoKTsKfQoKZnVuY3Rpb24gcmVtb3ZlQm9keUNsYXNzZXMoKSB7CiAgcmVtb3ZlQ2xhc3MoW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgZG9jdW1lbnQuYm9keV0sIFtzd2FsQ2xhc3Nlcy5zaG93biwgc3dhbENsYXNzZXNbJ2hlaWdodC1hdXRvJ10sIHN3YWxDbGFzc2VzWyduby1iYWNrZHJvcCddLCBzd2FsQ2xhc3Nlc1sndG9hc3Qtc2hvd24nXSwgc3dhbENsYXNzZXNbJ3RvYXN0LWNvbHVtbiddXSk7Cn0KCmZ1bmN0aW9uIGRpc3Bvc2VTd2FsKGluc3RhbmNlKSB7CiAgLy8gVW5zZXQgdGhpcy5wYXJhbXMgc28gR0Mgd2lsbCBkaXNwb3NlIGl0ICgjMTU2OSkKICBkZWxldGUgaW5zdGFuY2UucGFyYW1zOyAvLyBVbnNldCBnbG9iYWxTdGF0ZSBwcm9wcyBzbyBHQyB3aWxsIGRpc3Bvc2UgZ2xvYmFsU3RhdGUgKCMxNTY5KQoKICBkZWxldGUgZ2xvYmFsU3RhdGUua2V5ZG93bkhhbmRsZXI7CiAgZGVsZXRlIGdsb2JhbFN0YXRlLmtleWRvd25UYXJnZXQ7IC8vIFVuc2V0IFdlYWtNYXBzIHNvIEdDIHdpbGwgYmUgYWJsZSB0byBkaXNwb3NlIHRoZW0gKCMxNTY5KQoKICB1bnNldFdlYWtNYXBzKHByaXZhdGVQcm9wcyk7CiAgdW5zZXRXZWFrTWFwcyhwcml2YXRlTWV0aG9kcyk7Cn0KCmZ1bmN0aW9uIGNsb3NlKHJlc29sdmVWYWx1ZSkgewogIHZhciBwb3B1cCA9IGdldFBvcHVwKCk7CgogIGlmICghcG9wdXAgfHwgaGFzQ2xhc3MocG9wdXAsIHN3YWxDbGFzc2VzLmhpZGUpKSB7CiAgICByZXR1cm47CiAgfQoKICB2YXIgaW5uZXJQYXJhbXMgPSBwcml2YXRlUHJvcHMuaW5uZXJQYXJhbXMuZ2V0KHRoaXMpOwoKICBpZiAoIWlubmVyUGFyYW1zKSB7CiAgICByZXR1cm47CiAgfQoKICB2YXIgc3dhbFByb21pc2VSZXNvbHZlID0gcHJpdmF0ZU1ldGhvZHMuc3dhbFByb21pc2VSZXNvbHZlLmdldCh0aGlzKTsKICByZW1vdmVDbGFzcyhwb3B1cCwgc3dhbENsYXNzZXMuc2hvdyk7CiAgYWRkQ2xhc3MocG9wdXAsIHN3YWxDbGFzc2VzLmhpZGUpOwogIGhhbmRsZVBvcHVwQW5pbWF0aW9uKHRoaXMsIHBvcHVwLCBpbm5lclBhcmFtcyk7IC8vIFJlc29sdmUgU3dhbCBwcm9taXNlCgogIHN3YWxQcm9taXNlUmVzb2x2ZShyZXNvbHZlVmFsdWUgfHwge30pOwp9Cgp2YXIgaGFuZGxlUG9wdXBBbmltYXRpb24gPSBmdW5jdGlvbiBoYW5kbGVQb3B1cEFuaW1hdGlvbihpbnN0YW5jZSwgcG9wdXAsIGlubmVyUGFyYW1zKSB7CiAgdmFyIGNvbnRhaW5lciA9IGdldENvbnRhaW5lcigpOyAvLyBJZiBhbmltYXRpb24gaXMgc3VwcG9ydGVkLCBhbmltYXRlCgogIHZhciBhbmltYXRpb25Jc1N1cHBvcnRlZCA9IGFuaW1hdGlvbkVuZEV2ZW50ICYmIGhhc0Nzc0FuaW1hdGlvbihwb3B1cCk7CiAgdmFyIG9uQ2xvc2UgPSBpbm5lclBhcmFtcy5vbkNsb3NlLAogICAgICBvbkFmdGVyQ2xvc2UgPSBpbm5lclBhcmFtcy5vbkFmdGVyQ2xvc2U7CgogIGlmIChvbkNsb3NlICE9PSBudWxsICYmIHR5cGVvZiBvbkNsb3NlID09PSAnZnVuY3Rpb24nKSB7CiAgICBvbkNsb3NlKHBvcHVwKTsKICB9CgogIGlmIChhbmltYXRpb25Jc1N1cHBvcnRlZCkgewogICAgYW5pbWF0ZVBvcHVwKGluc3RhbmNlLCBwb3B1cCwgY29udGFpbmVyLCBvbkFmdGVyQ2xvc2UpOwogIH0gZWxzZSB7CiAgICAvLyBPdGhlcndpc2UsIHJlbW92ZSBpbW1lZGlhdGVseQogICAgcmVtb3ZlUG9wdXBBbmRSZXNldFN0YXRlKGluc3RhbmNlLCBjb250YWluZXIsIGlzVG9hc3QoKSwgb25BZnRlckNsb3NlKTsKICB9Cn07Cgp2YXIgYW5pbWF0ZVBvcHVwID0gZnVuY3Rpb24gYW5pbWF0ZVBvcHVwKGluc3RhbmNlLCBwb3B1cCwgY29udGFpbmVyLCBvbkFmdGVyQ2xvc2UpIHsKICBnbG9iYWxTdGF0ZS5zd2FsQ2xvc2VFdmVudEZpbmlzaGVkQ2FsbGJhY2sgPSByZW1vdmVQb3B1cEFuZFJlc2V0U3RhdGUuYmluZChudWxsLCBpbnN0YW5jZSwgY29udGFpbmVyLCBpc1RvYXN0KCksIG9uQWZ0ZXJDbG9zZSk7CiAgcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihhbmltYXRpb25FbmRFdmVudCwgZnVuY3Rpb24gKGUpIHsKICAgIGlmIChlLnRhcmdldCA9PT0gcG9wdXApIHsKICAgICAgZ2xvYmFsU3RhdGUuc3dhbENsb3NlRXZlbnRGaW5pc2hlZENhbGxiYWNrKCk7CiAgICAgIGRlbGV0ZSBnbG9iYWxTdGF0ZS5zd2FsQ2xvc2VFdmVudEZpbmlzaGVkQ2FsbGJhY2s7CiAgICB9CiAgfSk7Cn07Cgp2YXIgdW5zZXRXZWFrTWFwcyA9IGZ1bmN0aW9uIHVuc2V0V2Vha01hcHMob2JqKSB7CiAgZm9yICh2YXIgaSBpbiBvYmopIHsKICAgIG9ialtpXSA9IG5ldyBXZWFrTWFwKCk7CiAgfQp9OwoKdmFyIHRyaWdnZXJPbkFmdGVyQ2xvc2VBbmREaXNwb3NlID0gZnVuY3Rpb24gdHJpZ2dlck9uQWZ0ZXJDbG9zZUFuZERpc3Bvc2UoaW5zdGFuY2UsIG9uQWZ0ZXJDbG9zZSkgewogIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgaWYgKG9uQWZ0ZXJDbG9zZSAhPT0gbnVsbCAmJiB0eXBlb2Ygb25BZnRlckNsb3NlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIG9uQWZ0ZXJDbG9zZSgpOwogICAgfQoKICAgIGlmICghZ2V0UG9wdXAoKSkgewogICAgICBkaXNwb3NlU3dhbChpbnN0YW5jZSk7CiAgICB9CiAgfSk7Cn07CgpmdW5jdGlvbiBzZXRCdXR0b25zRGlzYWJsZWQoaW5zdGFuY2UsIGJ1dHRvbnMsIGRpc2FibGVkKSB7CiAgdmFyIGRvbUNhY2hlID0gcHJpdmF0ZVByb3BzLmRvbUNhY2hlLmdldChpbnN0YW5jZSk7CiAgYnV0dG9ucy5mb3JFYWNoKGZ1bmN0aW9uIChidXR0b24pIHsKICAgIGRvbUNhY2hlW2J1dHRvbl0uZGlzYWJsZWQgPSBkaXNhYmxlZDsKICB9KTsKfQoKZnVuY3Rpb24gc2V0SW5wdXREaXNhYmxlZChpbnB1dCwgZGlzYWJsZWQpIHsKICBpZiAoIWlucHV0KSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBpZiAoaW5wdXQudHlwZSA9PT0gJ3JhZGlvJykgewogICAgdmFyIHJhZGlvc0NvbnRhaW5lciA9IGlucHV0LnBhcmVudE5vZGUucGFyZW50Tm9kZTsKICAgIHZhciByYWRpb3MgPSByYWRpb3NDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhZGlvcy5sZW5ndGg7IGkrKykgewogICAgICByYWRpb3NbaV0uZGlzYWJsZWQgPSBkaXNhYmxlZDsKICAgIH0KICB9IGVsc2UgewogICAgaW5wdXQuZGlzYWJsZWQgPSBkaXNhYmxlZDsKICB9Cn0KCmZ1bmN0aW9uIGVuYWJsZUJ1dHRvbnMoKSB7CiAgc2V0QnV0dG9uc0Rpc2FibGVkKHRoaXMsIFsnY29uZmlybUJ1dHRvbicsICdjYW5jZWxCdXR0b24nXSwgZmFsc2UpOwp9CmZ1bmN0aW9uIGRpc2FibGVCdXR0b25zKCkgewogIHNldEJ1dHRvbnNEaXNhYmxlZCh0aGlzLCBbJ2NvbmZpcm1CdXR0b24nLCAnY2FuY2VsQnV0dG9uJ10sIHRydWUpOwp9IC8vIEBkZXByZWNhdGVkCgpmdW5jdGlvbiBlbmFibGVDb25maXJtQnV0dG9uKCkgewogIHdhcm5BYm91dERlcHJlYXRpb24oJ1N3YWwuZGlzYWJsZUNvbmZpcm1CdXR0b24oKScsICJTd2FsLmdldENvbmZpcm1CdXR0b24oKS5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJykiKTsKICBzZXRCdXR0b25zRGlzYWJsZWQodGhpcywgWydjb25maXJtQnV0dG9uJ10sIGZhbHNlKTsKfSAvLyBAZGVwcmVjYXRlZAoKZnVuY3Rpb24gZGlzYWJsZUNvbmZpcm1CdXR0b24oKSB7CiAgd2FybkFib3V0RGVwcmVhdGlvbignU3dhbC5lbmFibGVDb25maXJtQnV0dG9uKCknLCAiU3dhbC5nZXRDb25maXJtQnV0dG9uKCkuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKSIpOwogIHNldEJ1dHRvbnNEaXNhYmxlZCh0aGlzLCBbJ2NvbmZpcm1CdXR0b24nXSwgdHJ1ZSk7Cn0KZnVuY3Rpb24gZW5hYmxlSW5wdXQoKSB7CiAgcmV0dXJuIHNldElucHV0RGlzYWJsZWQodGhpcy5nZXRJbnB1dCgpLCBmYWxzZSk7Cn0KZnVuY3Rpb24gZGlzYWJsZUlucHV0KCkgewogIHJldHVybiBzZXRJbnB1dERpc2FibGVkKHRoaXMuZ2V0SW5wdXQoKSwgdHJ1ZSk7Cn0KCmZ1bmN0aW9uIHNob3dWYWxpZGF0aW9uTWVzc2FnZShlcnJvcikgewogIHZhciBkb21DYWNoZSA9IHByaXZhdGVQcm9wcy5kb21DYWNoZS5nZXQodGhpcyk7CiAgZG9tQ2FjaGUudmFsaWRhdGlvbk1lc3NhZ2UuaW5uZXJIVE1MID0gZXJyb3I7CiAgdmFyIHBvcHVwQ29tcHV0ZWRTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRvbUNhY2hlLnBvcHVwKTsKICBkb21DYWNoZS52YWxpZGF0aW9uTWVzc2FnZS5zdHlsZS5tYXJnaW5MZWZ0ID0gIi0iLmNvbmNhdChwb3B1cENvbXB1dGVkU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1sZWZ0JykpOwogIGRvbUNhY2hlLnZhbGlkYXRpb25NZXNzYWdlLnN0eWxlLm1hcmdpblJpZ2h0ID0gIi0iLmNvbmNhdChwb3B1cENvbXB1dGVkU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1yaWdodCcpKTsKICBzaG93KGRvbUNhY2hlLnZhbGlkYXRpb25NZXNzYWdlKTsKICB2YXIgaW5wdXQgPSB0aGlzLmdldElucHV0KCk7CgogIGlmIChpbnB1dCkgewogICAgaW5wdXQuc2V0QXR0cmlidXRlKCdhcmlhLWludmFsaWQnLCB0cnVlKTsKICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1kZXNjcmliZWRCeScsIHN3YWxDbGFzc2VzWyd2YWxpZGF0aW9uLW1lc3NhZ2UnXSk7CiAgICBmb2N1c0lucHV0KGlucHV0KTsKICAgIGFkZENsYXNzKGlucHV0LCBzd2FsQ2xhc3Nlcy5pbnB1dGVycm9yKTsKICB9Cn0gLy8gSGlkZSBibG9jayB3aXRoIHZhbGlkYXRpb24gbWVzc2FnZQoKZnVuY3Rpb24gcmVzZXRWYWxpZGF0aW9uTWVzc2FnZSQxKCkgewogIHZhciBkb21DYWNoZSA9IHByaXZhdGVQcm9wcy5kb21DYWNoZS5nZXQodGhpcyk7CgogIGlmIChkb21DYWNoZS52YWxpZGF0aW9uTWVzc2FnZSkgewogICAgaGlkZShkb21DYWNoZS52YWxpZGF0aW9uTWVzc2FnZSk7CiAgfQoKICB2YXIgaW5wdXQgPSB0aGlzLmdldElucHV0KCk7CgogIGlmIChpbnB1dCkgewogICAgaW5wdXQucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWludmFsaWQnKTsKICAgIGlucHV0LnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1kZXNjcmliZWRCeScpOwogICAgcmVtb3ZlQ2xhc3MoaW5wdXQsIHN3YWxDbGFzc2VzLmlucHV0ZXJyb3IpOwogIH0KfQoKZnVuY3Rpb24gZ2V0UHJvZ3Jlc3NTdGVwcyQxKCkgewogIHdhcm5BYm91dERlcHJlYXRpb24oJ1N3YWwuZ2V0UHJvZ3Jlc3NTdGVwcygpJywgImNvbnN0IHN3YWxJbnN0YW5jZSA9IFN3YWwuZmlyZSh7cHJvZ3Jlc3NTdGVwczogWycxJywgJzInLCAnMyddfSk7IGNvbnN0IHByb2dyZXNzU3RlcHMgPSBzd2FsSW5zdGFuY2UucGFyYW1zLnByb2dyZXNzU3RlcHMiKTsKICB2YXIgaW5uZXJQYXJhbXMgPSBwcml2YXRlUHJvcHMuaW5uZXJQYXJhbXMuZ2V0KHRoaXMpOwogIHJldHVybiBpbm5lclBhcmFtcy5wcm9ncmVzc1N0ZXBzOwp9CmZ1bmN0aW9uIHNldFByb2dyZXNzU3RlcHMocHJvZ3Jlc3NTdGVwcykgewogIHdhcm5BYm91dERlcHJlYXRpb24oJ1N3YWwuc2V0UHJvZ3Jlc3NTdGVwcygpJywgJ1N3YWwudXBkYXRlKCknKTsKICB2YXIgaW5uZXJQYXJhbXMgPSBwcml2YXRlUHJvcHMuaW5uZXJQYXJhbXMuZ2V0KHRoaXMpOwoKICB2YXIgdXBkYXRlZFBhcmFtcyA9IF9leHRlbmRzKHt9LCBpbm5lclBhcmFtcywgewogICAgcHJvZ3Jlc3NTdGVwczogcHJvZ3Jlc3NTdGVwcwogIH0pOwoKICByZW5kZXJQcm9ncmVzc1N0ZXBzKHRoaXMsIHVwZGF0ZWRQYXJhbXMpOwogIHByaXZhdGVQcm9wcy5pbm5lclBhcmFtcy5zZXQodGhpcywgdXBkYXRlZFBhcmFtcyk7Cn0KZnVuY3Rpb24gc2hvd1Byb2dyZXNzU3RlcHMoKSB7CiAgdmFyIGRvbUNhY2hlID0gcHJpdmF0ZVByb3BzLmRvbUNhY2hlLmdldCh0aGlzKTsKICBzaG93KGRvbUNhY2hlLnByb2dyZXNzU3RlcHMpOwp9CmZ1bmN0aW9uIGhpZGVQcm9ncmVzc1N0ZXBzKCkgewogIHZhciBkb21DYWNoZSA9IHByaXZhdGVQcm9wcy5kb21DYWNoZS5nZXQodGhpcyk7CiAgaGlkZShkb21DYWNoZS5wcm9ncmVzc1N0ZXBzKTsKfQoKdmFyIFRpbWVyID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gVGltZXIoY2FsbGJhY2ssIGRlbGF5KSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGltZXIpOwoKICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjazsKICAgIHRoaXMucmVtYWluaW5nID0gZGVsYXk7CiAgICB0aGlzLnJ1bm5pbmcgPSBmYWxzZTsKICAgIHRoaXMuc3RhcnQoKTsKICB9CgogIF9jcmVhdGVDbGFzcyhUaW1lciwgW3sKICAgIGtleTogInN0YXJ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydCgpIHsKICAgICAgaWYgKCF0aGlzLnJ1bm5pbmcpIHsKICAgICAgICB0aGlzLnJ1bm5pbmcgPSB0cnVlOwogICAgICAgIHRoaXMuc3RhcnRlZCA9IG5ldyBEYXRlKCk7CiAgICAgICAgdGhpcy5pZCA9IHNldFRpbWVvdXQodGhpcy5jYWxsYmFjaywgdGhpcy5yZW1haW5pbmcpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5yZW1haW5pbmc7CiAgICB9CiAgfSwgewogICAga2V5OiAic3RvcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcCgpIHsKICAgICAgaWYgKHRoaXMucnVubmluZykgewogICAgICAgIHRoaXMucnVubmluZyA9IGZhbHNlOwogICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmlkKTsKICAgICAgICB0aGlzLnJlbWFpbmluZyAtPSBuZXcgRGF0ZSgpIC0gdGhpcy5zdGFydGVkOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5yZW1haW5pbmc7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW5jcmVhc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluY3JlYXNlKG4pIHsKICAgICAgdmFyIHJ1bm5pbmcgPSB0aGlzLnJ1bm5pbmc7CgogICAgICBpZiAocnVubmluZykgewogICAgICAgIHRoaXMuc3RvcCgpOwogICAgICB9CgogICAgICB0aGlzLnJlbWFpbmluZyArPSBuOwoKICAgICAgaWYgKHJ1bm5pbmcpIHsKICAgICAgICB0aGlzLnN0YXJ0KCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLnJlbWFpbmluZzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRUaW1lckxlZnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFRpbWVyTGVmdCgpIHsKICAgICAgaWYgKHRoaXMucnVubmluZykgewogICAgICAgIHRoaXMuc3RvcCgpOwogICAgICAgIHRoaXMuc3RhcnQoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMucmVtYWluaW5nOwogICAgfQogIH0sIHsKICAgIGtleTogImlzUnVubmluZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNSdW5uaW5nKCkgewogICAgICByZXR1cm4gdGhpcy5ydW5uaW5nOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFRpbWVyOwp9KCk7Cgp2YXIgZGVmYXVsdElucHV0VmFsaWRhdG9ycyA9IHsKICBlbWFpbDogZnVuY3Rpb24gZW1haWwoc3RyaW5nLCB2YWxpZGF0aW9uTWVzc2FnZSkgewogICAgcmV0dXJuIC9eW2EtekEtWjAtOS4rXy1dK0BbYS16QS1aMC05Li1dK1wuW2EtekEtWjAtOS1dezIsMjR9JC8udGVzdChzdHJpbmcpID8gUHJvbWlzZS5yZXNvbHZlKCkgOiBQcm9taXNlLnJlc29sdmUodmFsaWRhdGlvbk1lc3NhZ2UgfHwgJ0ludmFsaWQgZW1haWwgYWRkcmVzcycpOwogIH0sCiAgdXJsOiBmdW5jdGlvbiB1cmwoc3RyaW5nLCB2YWxpZGF0aW9uTWVzc2FnZSkgewogICAgLy8gdGFrZW4gZnJvbSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMzgwOTQzNSB3aXRoIGEgc21hbGwgY2hhbmdlIGZyb20gIzEzMDYKICAgIHJldHVybiAvXmh0dHBzPzpcL1wvKHd3d1wuKT9bLWEtekEtWjAtOUA6JS5fK34jPV17MiwyNTZ9XC5bYS16XXsyLDYzfVxiKFstYS16QS1aMC05QDolXysufiM/Ji89XSopJC8udGVzdChzdHJpbmcpID8gUHJvbWlzZS5yZXNvbHZlKCkgOiBQcm9taXNlLnJlc29sdmUodmFsaWRhdGlvbk1lc3NhZ2UgfHwgJ0ludmFsaWQgVVJMJyk7CiAgfQp9OwoKZnVuY3Rpb24gc2V0RGVmYXVsdElucHV0VmFsaWRhdG9ycyhwYXJhbXMpIHsKICAvLyBVc2UgZGVmYXVsdCBgaW5wdXRWYWxpZGF0b3JgIGZvciBzdXBwb3J0ZWQgaW5wdXQgdHlwZXMgaWYgbm90IHByb3ZpZGVkCiAgaWYgKCFwYXJhbXMuaW5wdXRWYWxpZGF0b3IpIHsKICAgIE9iamVjdC5rZXlzKGRlZmF1bHRJbnB1dFZhbGlkYXRvcnMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICBpZiAocGFyYW1zLmlucHV0ID09PSBrZXkpIHsKICAgICAgICBwYXJhbXMuaW5wdXRWYWxpZGF0b3IgPSBkZWZhdWx0SW5wdXRWYWxpZGF0b3JzW2tleV07CiAgICAgIH0KICAgIH0pOwogIH0KfQoKZnVuY3Rpb24gdmFsaWRhdGVDdXN0b21UYXJnZXRFbGVtZW50KHBhcmFtcykgewogIC8vIERldGVybWluZSBpZiB0aGUgY3VzdG9tIHRhcmdldCBlbGVtZW50IGlzIHZhbGlkCiAgaWYgKCFwYXJhbXMudGFyZ2V0IHx8IHR5cGVvZiBwYXJhbXMudGFyZ2V0ID09PSAnc3RyaW5nJyAmJiAhZG9jdW1lbnQucXVlcnlTZWxlY3RvcihwYXJhbXMudGFyZ2V0KSB8fCB0eXBlb2YgcGFyYW1zLnRhcmdldCAhPT0gJ3N0cmluZycgJiYgIXBhcmFtcy50YXJnZXQuYXBwZW5kQ2hpbGQpIHsKICAgIHdhcm4oJ1RhcmdldCBwYXJhbWV0ZXIgaXMgbm90IHZhbGlkLCBkZWZhdWx0aW5nIHRvICJib2R5IicpOwogICAgcGFyYW1zLnRhcmdldCA9ICdib2R5JzsKICB9Cn0KLyoqCiAqIFNldCB0eXBlLCB0ZXh0IGFuZCBhY3Rpb25zIG9uIHBvcHVwCiAqCiAqIEBwYXJhbSBwYXJhbXMKICogQHJldHVybnMge2Jvb2xlYW59CiAqLwoKCmZ1bmN0aW9uIHNldFBhcmFtZXRlcnMocGFyYW1zKSB7CiAgc2V0RGVmYXVsdElucHV0VmFsaWRhdG9ycyhwYXJhbXMpOyAvLyBzaG93TG9hZGVyT25Db25maXJtICYmIHByZUNvbmZpcm0KCiAgaWYgKHBhcmFtcy5zaG93TG9hZGVyT25Db25maXJtICYmICFwYXJhbXMucHJlQ29uZmlybSkgewogICAgd2Fybignc2hvd0xvYWRlck9uQ29uZmlybSBpcyBzZXQgdG8gdHJ1ZSwgYnV0IHByZUNvbmZpcm0gaXMgbm90IGRlZmluZWQuXG4nICsgJ3Nob3dMb2FkZXJPbkNvbmZpcm0gc2hvdWxkIGJlIHVzZWQgdG9nZXRoZXIgd2l0aCBwcmVDb25maXJtLCBzZWUgdXNhZ2UgZXhhbXBsZTpcbicgKyAnaHR0cHM6Ly9zd2VldGFsZXJ0Mi5naXRodWIuaW8vI2FqYXgtcmVxdWVzdCcpOwogIH0gLy8gcGFyYW1zLmFuaW1hdGlvbiB3aWxsIGJlIGFjdHVhbGx5IHVzZWQgaW4gcmVuZGVyUG9wdXAuanMKICAvLyBidXQgaW4gY2FzZSB3aGVuIHBhcmFtcy5hbmltYXRpb24gaXMgYSBmdW5jdGlvbiwgd2UgbmVlZCB0byBjYWxsIHRoYXQgZnVuY3Rpb24KICAvLyBiZWZvcmUgcG9wdXAgKHJlKWluaXRpYWxpemF0aW9uLCBzbyBpdCdsbCBiZSBwb3NzaWJsZSB0byBjaGVjayBTd2FsLmlzVmlzaWJsZSgpCiAgLy8gaW5zaWRlIHRoZSBwYXJhbXMuYW5pbWF0aW9uIGZ1bmN0aW9uCgoKICBwYXJhbXMuYW5pbWF0aW9uID0gY2FsbElmRnVuY3Rpb24ocGFyYW1zLmFuaW1hdGlvbik7CiAgdmFsaWRhdGVDdXN0b21UYXJnZXRFbGVtZW50KHBhcmFtcyk7IC8vIFJlcGxhY2UgbmV3bGluZXMgd2l0aCA8YnI+IGluIHRpdGxlCgogIGlmICh0eXBlb2YgcGFyYW1zLnRpdGxlID09PSAnc3RyaW5nJykgewogICAgcGFyYW1zLnRpdGxlID0gcGFyYW1zLnRpdGxlLnNwbGl0KCdcbicpLmpvaW4oJzxiciAvPicpOwogIH0KCiAgaW5pdChwYXJhbXMpOwp9CgpmdW5jdGlvbiBzd2FsT3BlbkFuaW1hdGlvbkZpbmlzaGVkKHBvcHVwLCBjb250YWluZXIpIHsKICBwb3B1cC5yZW1vdmVFdmVudExpc3RlbmVyKGFuaW1hdGlvbkVuZEV2ZW50LCBzd2FsT3BlbkFuaW1hdGlvbkZpbmlzaGVkKTsKICBjb250YWluZXIuc3R5bGUub3ZlcmZsb3dZID0gJ2F1dG8nOwp9Ci8qKgogKiBPcGVuIHBvcHVwLCBhZGQgbmVjZXNzYXJ5IGNsYXNzZXMgYW5kIHN0eWxlcywgZml4IHNjcm9sbGJhcgogKgogKiBAcGFyYW0ge0FycmF5fSBwYXJhbXMKICovCgoKdmFyIG9wZW5Qb3B1cCA9IGZ1bmN0aW9uIG9wZW5Qb3B1cChwYXJhbXMpIHsKICB2YXIgY29udGFpbmVyID0gZ2V0Q29udGFpbmVyKCk7CiAgdmFyIHBvcHVwID0gZ2V0UG9wdXAoKTsKCiAgaWYgKHR5cGVvZiBwYXJhbXMub25CZWZvcmVPcGVuID09PSAnZnVuY3Rpb24nKSB7CiAgICBwYXJhbXMub25CZWZvcmVPcGVuKHBvcHVwKTsKICB9CgogIGFkZENsYXNzZXMoY29udGFpbmVyLCBwb3B1cCwgcGFyYW1zKTsgLy8gc2Nyb2xsaW5nIGlzICdoaWRkZW4nIHVudGlsIGFuaW1hdGlvbiBpcyBkb25lLCBhZnRlciB0aGF0ICdhdXRvJwoKICBzZXRTY3JvbGxpbmdWaXNpYmlsaXR5KGNvbnRhaW5lciwgcG9wdXApOwoKICBpZiAoaXNNb2RhbCgpKSB7CiAgICBmaXhTY3JvbGxDb250YWluZXIoY29udGFpbmVyLCBwYXJhbXMuc2Nyb2xsYmFyUGFkZGluZyk7CiAgfQoKICBpZiAoIWlzVG9hc3QoKSAmJiAhZ2xvYmFsU3RhdGUucHJldmlvdXNBY3RpdmVFbGVtZW50KSB7CiAgICBnbG9iYWxTdGF0ZS5wcmV2aW91c0FjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50OwogIH0KCiAgaWYgKHR5cGVvZiBwYXJhbXMub25PcGVuID09PSAnZnVuY3Rpb24nKSB7CiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHBhcmFtcy5vbk9wZW4ocG9wdXApOwogICAgfSk7CiAgfQp9OwoKdmFyIHNldFNjcm9sbGluZ1Zpc2liaWxpdHkgPSBmdW5jdGlvbiBzZXRTY3JvbGxpbmdWaXNpYmlsaXR5KGNvbnRhaW5lciwgcG9wdXApIHsKICBpZiAoYW5pbWF0aW9uRW5kRXZlbnQgJiYgaGFzQ3NzQW5pbWF0aW9uKHBvcHVwKSkgewogICAgY29udGFpbmVyLnN0eWxlLm92ZXJmbG93WSA9ICdoaWRkZW4nOwogICAgcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihhbmltYXRpb25FbmRFdmVudCwgc3dhbE9wZW5BbmltYXRpb25GaW5pc2hlZC5iaW5kKG51bGwsIHBvcHVwLCBjb250YWluZXIpKTsKICB9IGVsc2UgewogICAgY29udGFpbmVyLnN0eWxlLm92ZXJmbG93WSA9ICdhdXRvJzsKICB9Cn07Cgp2YXIgZml4U2Nyb2xsQ29udGFpbmVyID0gZnVuY3Rpb24gZml4U2Nyb2xsQ29udGFpbmVyKGNvbnRhaW5lciwgc2Nyb2xsYmFyUGFkZGluZykgewogIGlPU2ZpeCgpOwogIElFZml4KCk7CiAgc2V0QXJpYUhpZGRlbigpOwoKICBpZiAoc2Nyb2xsYmFyUGFkZGluZykgewogICAgZml4U2Nyb2xsYmFyKCk7CiAgfSAvLyBzd2VldGFsZXJ0Mi9pc3N1ZXMvMTI0NwoKCiAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICBjb250YWluZXIuc2Nyb2xsVG9wID0gMDsKICB9KTsKfTsKCnZhciBhZGRDbGFzc2VzID0gZnVuY3Rpb24gYWRkQ2xhc3Nlcyhjb250YWluZXIsIHBvcHVwLCBwYXJhbXMpIHsKICBpZiAocGFyYW1zLmFuaW1hdGlvbikgewogICAgYWRkQ2xhc3MocG9wdXAsIHN3YWxDbGFzc2VzLnNob3cpOwogICAgYWRkQ2xhc3MoY29udGFpbmVyLCBzd2FsQ2xhc3Nlcy5mYWRlKTsKICB9CgogIHNob3cocG9wdXApOwogIGFkZENsYXNzKFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIGRvY3VtZW50LmJvZHksIGNvbnRhaW5lcl0sIHN3YWxDbGFzc2VzLnNob3duKTsKCiAgaWYgKHBhcmFtcy5oZWlnaHRBdXRvICYmIHBhcmFtcy5iYWNrZHJvcCAmJiAhcGFyYW1zLnRvYXN0KSB7CiAgICBhZGRDbGFzcyhbZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBkb2N1bWVudC5ib2R5XSwgc3dhbENsYXNzZXNbJ2hlaWdodC1hdXRvJ10pOwogIH0KfTsKCnZhciBoYW5kbGVJbnB1dE9wdGlvbnMgPSBmdW5jdGlvbiBoYW5kbGVJbnB1dE9wdGlvbnMoaW5zdGFuY2UsIHBhcmFtcykgewogIHZhciBjb250ZW50ID0gZ2V0Q29udGVudCgpOwoKICB2YXIgcHJvY2Vzc0lucHV0T3B0aW9ucyA9IGZ1bmN0aW9uIHByb2Nlc3NJbnB1dE9wdGlvbnMoaW5wdXRPcHRpb25zKSB7CiAgICByZXR1cm4gcG9wdWxhdGVJbnB1dE9wdGlvbnNbcGFyYW1zLmlucHV0XShjb250ZW50LCBmb3JtYXRJbnB1dE9wdGlvbnMoaW5wdXRPcHRpb25zKSwgcGFyYW1zKTsKICB9OwoKICBpZiAoaXNQcm9taXNlKHBhcmFtcy5pbnB1dE9wdGlvbnMpKSB7CiAgICBzaG93TG9hZGluZygpOwogICAgcGFyYW1zLmlucHV0T3B0aW9ucy50aGVuKGZ1bmN0aW9uIChpbnB1dE9wdGlvbnMpIHsKICAgICAgaW5zdGFuY2UuaGlkZUxvYWRpbmcoKTsKICAgICAgcHJvY2Vzc0lucHV0T3B0aW9ucyhpbnB1dE9wdGlvbnMpOwogICAgfSk7CiAgfSBlbHNlIGlmIChfdHlwZW9mKHBhcmFtcy5pbnB1dE9wdGlvbnMpID09PSAnb2JqZWN0JykgewogICAgcHJvY2Vzc0lucHV0T3B0aW9ucyhwYXJhbXMuaW5wdXRPcHRpb25zKTsKICB9IGVsc2UgewogICAgZXJyb3IoIlVuZXhwZWN0ZWQgdHlwZSBvZiBpbnB1dE9wdGlvbnMhIEV4cGVjdGVkIG9iamVjdCwgTWFwIG9yIFByb21pc2UsIGdvdCAiLmNvbmNhdChfdHlwZW9mKHBhcmFtcy5pbnB1dE9wdGlvbnMpKSk7CiAgfQp9Owp2YXIgaGFuZGxlSW5wdXRWYWx1ZSA9IGZ1bmN0aW9uIGhhbmRsZUlucHV0VmFsdWUoaW5zdGFuY2UsIHBhcmFtcykgewogIHZhciBpbnB1dCA9IGluc3RhbmNlLmdldElucHV0KCk7CiAgaGlkZShpbnB1dCk7CiAgcGFyYW1zLmlucHV0VmFsdWUudGhlbihmdW5jdGlvbiAoaW5wdXRWYWx1ZSkgewogICAgaW5wdXQudmFsdWUgPSBwYXJhbXMuaW5wdXQgPT09ICdudW1iZXInID8gcGFyc2VGbG9hdChpbnB1dFZhbHVlKSB8fCAwIDogaW5wdXRWYWx1ZSArICcnOwogICAgc2hvdyhpbnB1dCk7CiAgICBpbnB1dC5mb2N1cygpOwogICAgaW5zdGFuY2UuaGlkZUxvYWRpbmcoKTsKICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyKSB7CiAgICBlcnJvcignRXJyb3IgaW4gaW5wdXRWYWx1ZSBwcm9taXNlOiAnICsgZXJyKTsKICAgIGlucHV0LnZhbHVlID0gJyc7CiAgICBzaG93KGlucHV0KTsKICAgIGlucHV0LmZvY3VzKCk7CiAgICBpbnN0YW5jZS5oaWRlTG9hZGluZygpOwogIH0pOwp9Owp2YXIgcG9wdWxhdGVJbnB1dE9wdGlvbnMgPSB7CiAgc2VsZWN0OiBmdW5jdGlvbiBzZWxlY3QoY29udGVudCwgaW5wdXRPcHRpb25zLCBwYXJhbXMpIHsKICAgIHZhciBzZWxlY3QgPSBnZXRDaGlsZEJ5Q2xhc3MoY29udGVudCwgc3dhbENsYXNzZXMuc2VsZWN0KTsKICAgIGlucHV0T3B0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChpbnB1dE9wdGlvbikgewogICAgICB2YXIgb3B0aW9uVmFsdWUgPSBpbnB1dE9wdGlvblswXTsKICAgICAgdmFyIG9wdGlvbkxhYmVsID0gaW5wdXRPcHRpb25bMV07CiAgICAgIHZhciBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsKICAgICAgb3B0aW9uLnZhbHVlID0gb3B0aW9uVmFsdWU7CiAgICAgIG9wdGlvbi5pbm5lckhUTUwgPSBvcHRpb25MYWJlbDsKCiAgICAgIGlmIChwYXJhbXMuaW5wdXRWYWx1ZS50b1N0cmluZygpID09PSBvcHRpb25WYWx1ZS50b1N0cmluZygpKSB7CiAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgfQoKICAgICAgc2VsZWN0LmFwcGVuZENoaWxkKG9wdGlvbik7CiAgICB9KTsKICAgIHNlbGVjdC5mb2N1cygpOwogIH0sCiAgcmFkaW86IGZ1bmN0aW9uIHJhZGlvKGNvbnRlbnQsIGlucHV0T3B0aW9ucywgcGFyYW1zKSB7CiAgICB2YXIgcmFkaW8gPSBnZXRDaGlsZEJ5Q2xhc3MoY29udGVudCwgc3dhbENsYXNzZXMucmFkaW8pOwogICAgaW5wdXRPcHRpb25zLmZvckVhY2goZnVuY3Rpb24gKGlucHV0T3B0aW9uKSB7CiAgICAgIHZhciByYWRpb1ZhbHVlID0gaW5wdXRPcHRpb25bMF07CiAgICAgIHZhciByYWRpb0xhYmVsID0gaW5wdXRPcHRpb25bMV07CiAgICAgIHZhciByYWRpb0lucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgdmFyIHJhZGlvTGFiZWxFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTsKICAgICAgcmFkaW9JbnB1dC50eXBlID0gJ3JhZGlvJzsKICAgICAgcmFkaW9JbnB1dC5uYW1lID0gc3dhbENsYXNzZXMucmFkaW87CiAgICAgIHJhZGlvSW5wdXQudmFsdWUgPSByYWRpb1ZhbHVlOwoKICAgICAgaWYgKHBhcmFtcy5pbnB1dFZhbHVlLnRvU3RyaW5nKCkgPT09IHJhZGlvVmFsdWUudG9TdHJpbmcoKSkgewogICAgICAgIHJhZGlvSW5wdXQuY2hlY2tlZCA9IHRydWU7CiAgICAgIH0KCiAgICAgIHZhciBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgbGFiZWwuaW5uZXJIVE1MID0gcmFkaW9MYWJlbDsKICAgICAgbGFiZWwuY2xhc3NOYW1lID0gc3dhbENsYXNzZXMubGFiZWw7CiAgICAgIHJhZGlvTGFiZWxFbGVtZW50LmFwcGVuZENoaWxkKHJhZGlvSW5wdXQpOwogICAgICByYWRpb0xhYmVsRWxlbWVudC5hcHBlbmRDaGlsZChsYWJlbCk7CiAgICAgIHJhZGlvLmFwcGVuZENoaWxkKHJhZGlvTGFiZWxFbGVtZW50KTsKICAgIH0pOwogICAgdmFyIHJhZGlvcyA9IHJhZGlvLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0Jyk7CgogICAgaWYgKHJhZGlvcy5sZW5ndGgpIHsKICAgICAgcmFkaW9zWzBdLmZvY3VzKCk7CiAgICB9CiAgfQogIC8qKgogICAqIENvbnZlcnRzIGBpbnB1dE9wdGlvbnNgIGludG8gYW4gYXJyYXkgb2YgYFt2YWx1ZSwgbGFiZWxdYHMKICAgKiBAcGFyYW0gaW5wdXRPcHRpb25zCiAgICovCgp9OwoKdmFyIGZvcm1hdElucHV0T3B0aW9ucyA9IGZ1bmN0aW9uIGZvcm1hdElucHV0T3B0aW9ucyhpbnB1dE9wdGlvbnMpIHsKICB2YXIgcmVzdWx0ID0gW107CgogIGlmICh0eXBlb2YgTWFwICE9PSAndW5kZWZpbmVkJyAmJiBpbnB1dE9wdGlvbnMgaW5zdGFuY2VvZiBNYXApIHsKICAgIGlucHV0T3B0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7CiAgICAgIHJlc3VsdC5wdXNoKFtrZXksIHZhbHVlXSk7CiAgICB9KTsKICB9IGVsc2UgewogICAgT2JqZWN0LmtleXMoaW5wdXRPcHRpb25zKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgcmVzdWx0LnB1c2goW2tleSwgaW5wdXRPcHRpb25zW2tleV1dKTsKICAgIH0pOwogIH0KCiAgcmV0dXJuIHJlc3VsdDsKfTsKCmZ1bmN0aW9uIF9tYWluKHVzZXJQYXJhbXMpIHsKICB2YXIgX3RoaXMgPSB0aGlzOwoKICBzaG93V2FybmluZ3NGb3JQYXJhbXModXNlclBhcmFtcyk7IC8vIENoZWNrIGlmIHRoZXJlIGlzIGFub3RoZXIgU3dhbCBjbG9zaW5nCgogIGlmIChnZXRQb3B1cCgpICYmIGdsb2JhbFN0YXRlLnN3YWxDbG9zZUV2ZW50RmluaXNoZWRDYWxsYmFjaykgewogICAgZ2xvYmFsU3RhdGUuc3dhbENsb3NlRXZlbnRGaW5pc2hlZENhbGxiYWNrKCk7CiAgICBkZWxldGUgZ2xvYmFsU3RhdGUuc3dhbENsb3NlRXZlbnRGaW5pc2hlZENhbGxiYWNrOwogIH0gLy8gQ2hlY2sgaWYgdGhlcmUgaXMgYSBzd2FsIGRpc3Bvc2FsIGRlZmVyIHRpbWVyCgoKICBpZiAoZ2xvYmFsU3RhdGUuZGVmZXJEaXNwb3NhbFRpbWVyKSB7CiAgICBjbGVhclRpbWVvdXQoZ2xvYmFsU3RhdGUuZGVmZXJEaXNwb3NhbFRpbWVyKTsKICAgIGRlbGV0ZSBnbG9iYWxTdGF0ZS5kZWZlckRpc3Bvc2FsVGltZXI7CiAgfQoKICB2YXIgaW5uZXJQYXJhbXMgPSBfZXh0ZW5kcyh7fSwgZGVmYXVsdFBhcmFtcywgdXNlclBhcmFtcyk7CgogIHNldFBhcmFtZXRlcnMoaW5uZXJQYXJhbXMpOwogIE9iamVjdC5mcmVlemUoaW5uZXJQYXJhbXMpOyAvLyBjbGVhciB0aGUgcHJldmlvdXMgdGltZXIKCiAgaWYgKGdsb2JhbFN0YXRlLnRpbWVvdXQpIHsKICAgIGdsb2JhbFN0YXRlLnRpbWVvdXQuc3RvcCgpOwogICAgZGVsZXRlIGdsb2JhbFN0YXRlLnRpbWVvdXQ7CiAgfSAvLyBjbGVhciB0aGUgcmVzdG9yZSBmb2N1cyB0aW1lb3V0CgoKICBjbGVhclRpbWVvdXQoZ2xvYmFsU3RhdGUucmVzdG9yZUZvY3VzVGltZW91dCk7CiAgdmFyIGRvbUNhY2hlID0gewogICAgcG9wdXA6IGdldFBvcHVwKCksCiAgICBjb250YWluZXI6IGdldENvbnRhaW5lcigpLAogICAgY29udGVudDogZ2V0Q29udGVudCgpLAogICAgYWN0aW9uczogZ2V0QWN0aW9ucygpLAogICAgY29uZmlybUJ1dHRvbjogZ2V0Q29uZmlybUJ1dHRvbigpLAogICAgY2FuY2VsQnV0dG9uOiBnZXRDYW5jZWxCdXR0b24oKSwKICAgIGNsb3NlQnV0dG9uOiBnZXRDbG9zZUJ1dHRvbigpLAogICAgdmFsaWRhdGlvbk1lc3NhZ2U6IGdldFZhbGlkYXRpb25NZXNzYWdlKCksCiAgICBwcm9ncmVzc1N0ZXBzOiBnZXRQcm9ncmVzc1N0ZXBzKCkKICB9OwogIHByaXZhdGVQcm9wcy5kb21DYWNoZS5zZXQodGhpcywgZG9tQ2FjaGUpOwogIHJlbmRlcih0aGlzLCBpbm5lclBhcmFtcyk7CiAgcHJpdmF0ZVByb3BzLmlubmVyUGFyYW1zLnNldCh0aGlzLCBpbm5lclBhcmFtcyk7CiAgdmFyIGNvbnN0cnVjdG9yID0gdGhpcy5jb25zdHJ1Y3RvcjsKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgIC8vIGZ1bmN0aW9ucyB0byBoYW5kbGUgYWxsIGNsb3NpbmdzL2Rpc21pc3NhbHMKICAgIHZhciBzdWNjZWVkV2l0aCA9IGZ1bmN0aW9uIHN1Y2NlZWRXaXRoKHZhbHVlKSB7CiAgICAgIF90aGlzLmNsb3NlUG9wdXAoewogICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICB9KTsKICAgIH07CgogICAgdmFyIGRpc21pc3NXaXRoID0gZnVuY3Rpb24gZGlzbWlzc1dpdGgoZGlzbWlzcykgewogICAgICBfdGhpcy5jbG9zZVBvcHVwKHsKICAgICAgICBkaXNtaXNzOiBkaXNtaXNzCiAgICAgIH0pOwogICAgfTsKCiAgICBwcml2YXRlTWV0aG9kcy5zd2FsUHJvbWlzZVJlc29sdmUuc2V0KF90aGlzLCByZXNvbHZlKTsgLy8gQ2xvc2Ugb24gdGltZXIKCiAgICBpZiAoaW5uZXJQYXJhbXMudGltZXIpIHsKICAgICAgZ2xvYmFsU3RhdGUudGltZW91dCA9IG5ldyBUaW1lcihmdW5jdGlvbiAoKSB7CiAgICAgICAgZGlzbWlzc1dpdGgoJ3RpbWVyJyk7CiAgICAgICAgZGVsZXRlIGdsb2JhbFN0YXRlLnRpbWVvdXQ7CiAgICAgIH0sIGlubmVyUGFyYW1zLnRpbWVyKTsKICAgIH0gLy8gR2V0IHRoZSB2YWx1ZSBvZiB0aGUgcG9wdXAgaW5wdXQKCgogICAgdmFyIGdldElucHV0VmFsdWUgPSBmdW5jdGlvbiBnZXRJbnB1dFZhbHVlKCkgewogICAgICB2YXIgaW5wdXQgPSBfdGhpcy5nZXRJbnB1dCgpOwoKICAgICAgaWYgKCFpbnB1dCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBzd2l0Y2ggKGlubmVyUGFyYW1zLmlucHV0KSB7CiAgICAgICAgY2FzZSAnY2hlY2tib3gnOgogICAgICAgICAgcmV0dXJuIGlucHV0LmNoZWNrZWQgPyAxIDogMDsKCiAgICAgICAgY2FzZSAncmFkaW8nOgogICAgICAgICAgcmV0dXJuIGlucHV0LmNoZWNrZWQgPyBpbnB1dC52YWx1ZSA6IG51bGw7CgogICAgICAgIGNhc2UgJ2ZpbGUnOgogICAgICAgICAgcmV0dXJuIGlucHV0LmZpbGVzLmxlbmd0aCA/IGlucHV0LmZpbGVzWzBdIDogbnVsbDsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybiBpbm5lclBhcmFtcy5pbnB1dEF1dG9UcmltID8gaW5wdXQudmFsdWUudHJpbSgpIDogaW5wdXQudmFsdWU7CiAgICAgIH0KICAgIH07IC8vIGlucHV0IGF1dG9mb2N1cwoKCiAgICBpZiAoaW5uZXJQYXJhbXMuaW5wdXQpIHsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGlucHV0ID0gX3RoaXMuZ2V0SW5wdXQoKTsKCiAgICAgICAgaWYgKGlucHV0KSB7CiAgICAgICAgICBmb2N1c0lucHV0KGlucHV0KTsKICAgICAgICB9CiAgICAgIH0sIDApOwogICAgfQoKICAgIHZhciBjb25maXJtID0gZnVuY3Rpb24gY29uZmlybSh2YWx1ZSkgewogICAgICBpZiAoaW5uZXJQYXJhbXMuc2hvd0xvYWRlck9uQ29uZmlybSkgewogICAgICAgIGNvbnN0cnVjdG9yLnNob3dMb2FkaW5nKCk7IC8vIFRPRE86IG1ha2Ugc2hvd0xvYWRpbmcgYW4gKmluc3RhbmNlKiBtZXRob2QKICAgICAgfQoKICAgICAgaWYgKGlubmVyUGFyYW1zLnByZUNvbmZpcm0pIHsKICAgICAgICBfdGhpcy5yZXNldFZhbGlkYXRpb25NZXNzYWdlKCk7CgogICAgICAgIHZhciBwcmVDb25maXJtUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIGlubmVyUGFyYW1zLnByZUNvbmZpcm0odmFsdWUsIGlubmVyUGFyYW1zLnZhbGlkYXRpb25NZXNzYWdlKTsKICAgICAgICB9KTsKICAgICAgICBwcmVDb25maXJtUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChwcmVDb25maXJtVmFsdWUpIHsKICAgICAgICAgIGlmIChpc1Zpc2libGUoZG9tQ2FjaGUudmFsaWRhdGlvbk1lc3NhZ2UpIHx8IHByZUNvbmZpcm1WYWx1ZSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgX3RoaXMuaGlkZUxvYWRpbmcoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN1Y2NlZWRXaXRoKHR5cGVvZiBwcmVDb25maXJtVmFsdWUgPT09ICd1bmRlZmluZWQnID8gdmFsdWUgOiBwcmVDb25maXJtVmFsdWUpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHN1Y2NlZWRXaXRoKHZhbHVlKTsKICAgICAgfQogICAgfTsgLy8gTW91c2UgaW50ZXJhY3Rpb25zCgoKICAgIHZhciBvbkJ1dHRvbkV2ZW50ID0gZnVuY3Rpb24gb25CdXR0b25FdmVudChlKSB7CiAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDsKICAgICAgdmFyIGNvbmZpcm1CdXR0b24gPSBkb21DYWNoZS5jb25maXJtQnV0dG9uLAogICAgICAgICAgY2FuY2VsQnV0dG9uID0gZG9tQ2FjaGUuY2FuY2VsQnV0dG9uOwogICAgICB2YXIgdGFyZ2V0ZWRDb25maXJtID0gY29uZmlybUJ1dHRvbiAmJiAoY29uZmlybUJ1dHRvbiA9PT0gdGFyZ2V0IHx8IGNvbmZpcm1CdXR0b24uY29udGFpbnModGFyZ2V0KSk7CiAgICAgIHZhciB0YXJnZXRlZENhbmNlbCA9IGNhbmNlbEJ1dHRvbiAmJiAoY2FuY2VsQnV0dG9uID09PSB0YXJnZXQgfHwgY2FuY2VsQnV0dG9uLmNvbnRhaW5zKHRhcmdldCkpOwoKICAgICAgc3dpdGNoIChlLnR5cGUpIHsKICAgICAgICBjYXNlICdjbGljayc6CiAgICAgICAgICAvLyBDbGlja2VkICdjb25maXJtJwogICAgICAgICAgaWYgKHRhcmdldGVkQ29uZmlybSkgewogICAgICAgICAgICBfdGhpcy5kaXNhYmxlQnV0dG9ucygpOwoKICAgICAgICAgICAgaWYgKGlubmVyUGFyYW1zLmlucHV0KSB7CiAgICAgICAgICAgICAgdmFyIGlucHV0VmFsdWUgPSBnZXRJbnB1dFZhbHVlKCk7CgogICAgICAgICAgICAgIGlmIChpbm5lclBhcmFtcy5pbnB1dFZhbGlkYXRvcikgewogICAgICAgICAgICAgICAgX3RoaXMuZGlzYWJsZUlucHV0KCk7CgogICAgICAgICAgICAgICAgdmFyIHZhbGlkYXRpb25Qcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBpbm5lclBhcmFtcy5pbnB1dFZhbGlkYXRvcihpbnB1dFZhbHVlLCBpbm5lclBhcmFtcy52YWxpZGF0aW9uTWVzc2FnZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHZhbGlkYXRpb25Qcm9taXNlLnRoZW4oZnVuY3Rpb24gKHZhbGlkYXRpb25NZXNzYWdlKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLmVuYWJsZUJ1dHRvbnMoKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzLmVuYWJsZUlucHV0KCk7CgogICAgICAgICAgICAgICAgICBpZiAodmFsaWRhdGlvbk1lc3NhZ2UpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpcy5zaG93VmFsaWRhdGlvbk1lc3NhZ2UodmFsaWRhdGlvbk1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGNvbmZpcm0oaW5wdXRWYWx1ZSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoIV90aGlzLmdldElucHV0KCkuY2hlY2tWYWxpZGl0eSgpKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5lbmFibGVCdXR0b25zKCk7CgogICAgICAgICAgICAgICAgX3RoaXMuc2hvd1ZhbGlkYXRpb25NZXNzYWdlKGlubmVyUGFyYW1zLnZhbGlkYXRpb25NZXNzYWdlKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uZmlybShpbnB1dFZhbHVlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29uZmlybSh0cnVlKTsKICAgICAgICAgICAgfSAvLyBDbGlja2VkICdjYW5jZWwnCgogICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXRlZENhbmNlbCkgewogICAgICAgICAgICBfdGhpcy5kaXNhYmxlQnV0dG9ucygpOwoKICAgICAgICAgICAgZGlzbWlzc1dpdGgoY29uc3RydWN0b3IuRGlzbWlzc1JlYXNvbi5jYW5jZWwpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICB9CiAgICB9OwoKICAgIHZhciBidXR0b25zID0gZG9tQ2FjaGUucG9wdXAucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uJyk7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidXR0b25zLmxlbmd0aDsgaSsrKSB7CiAgICAgIGJ1dHRvbnNbaV0ub25jbGljayA9IG9uQnV0dG9uRXZlbnQ7CiAgICAgIGJ1dHRvbnNbaV0ub25tb3VzZW92ZXIgPSBvbkJ1dHRvbkV2ZW50OwogICAgICBidXR0b25zW2ldLm9ubW91c2VvdXQgPSBvbkJ1dHRvbkV2ZW50OwogICAgICBidXR0b25zW2ldLm9ubW91c2Vkb3duID0gb25CdXR0b25FdmVudDsKICAgIH0gLy8gQ2xvc2luZyBwb3B1cCBieSBjbG9zZSBidXR0b24KCgogICAgZG9tQ2FjaGUuY2xvc2VCdXR0b24ub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgZGlzbWlzc1dpdGgoY29uc3RydWN0b3IuRGlzbWlzc1JlYXNvbi5jbG9zZSk7CiAgICB9OwoKICAgIGlmIChpbm5lclBhcmFtcy50b2FzdCkgewogICAgICAvLyBDbG9zaW5nIHBvcHVwIGJ5IGludGVybmFsIGNsaWNrCiAgICAgIGRvbUNhY2hlLnBvcHVwLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKGlubmVyUGFyYW1zLnNob3dDb25maXJtQnV0dG9uIHx8IGlubmVyUGFyYW1zLnNob3dDYW5jZWxCdXR0b24gfHwgaW5uZXJQYXJhbXMuc2hvd0Nsb3NlQnV0dG9uIHx8IGlubmVyUGFyYW1zLmlucHV0KSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBkaXNtaXNzV2l0aChjb25zdHJ1Y3Rvci5EaXNtaXNzUmVhc29uLmNsb3NlKTsKICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIHZhciBpZ25vcmVPdXRzaWRlQ2xpY2sgPSBmYWxzZTsgLy8gSWdub3JlIGNsaWNrIGV2ZW50cyB0aGF0IGhhZCBtb3VzZWRvd24gb24gdGhlIHBvcHVwIGJ1dCBtb3VzZXVwIG9uIHRoZSBjb250YWluZXIKICAgICAgLy8gVGhpcyBjYW4gaGFwcGVuIHdoZW4gdGhlIHVzZXIgZHJhZ3MgYSBzbGlkZXIKCiAgICAgIGRvbUNhY2hlLnBvcHVwLm9ubW91c2Vkb3duID0gZnVuY3Rpb24gKCkgewogICAgICAgIGRvbUNhY2hlLmNvbnRhaW5lci5vbm1vdXNldXAgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgZG9tQ2FjaGUuY29udGFpbmVyLm9ubW91c2V1cCA9IHVuZGVmaW5lZDsgLy8gV2Ugb25seSBjaGVjayBpZiB0aGUgbW91c2V1cCB0YXJnZXQgaXMgdGhlIGNvbnRhaW5lciBiZWNhdXNlIHVzdWFsbHkgaXQgZG9lc24ndAogICAgICAgICAgLy8gaGF2ZSBhbnkgb3RoZXIgZGlyZWN0IGNoaWxkcmVuIGFzaWRlIG9mIHRoZSBwb3B1cAoKICAgICAgICAgIGlmIChlLnRhcmdldCA9PT0gZG9tQ2FjaGUuY29udGFpbmVyKSB7CiAgICAgICAgICAgIGlnbm9yZU91dHNpZGVDbGljayA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfTsgLy8gSWdub3JlIGNsaWNrIGV2ZW50cyB0aGF0IGhhZCBtb3VzZWRvd24gb24gdGhlIGNvbnRhaW5lciBidXQgbW91c2V1cCBvbiB0aGUgcG9wdXAKCgogICAgICBkb21DYWNoZS5jb250YWluZXIub25tb3VzZWRvd24gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZG9tQ2FjaGUucG9wdXAub25tb3VzZXVwID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGRvbUNhY2hlLnBvcHVwLm9ubW91c2V1cCA9IHVuZGVmaW5lZDsgLy8gV2UgYWxzbyBuZWVkIHRvIGNoZWNrIGlmIHRoZSBtb3VzZXVwIHRhcmdldCBpcyBhIGNoaWxkIG9mIHRoZSBwb3B1cAoKICAgICAgICAgIGlmIChlLnRhcmdldCA9PT0gZG9tQ2FjaGUucG9wdXAgfHwgZG9tQ2FjaGUucG9wdXAuY29udGFpbnMoZS50YXJnZXQpKSB7CiAgICAgICAgICAgIGlnbm9yZU91dHNpZGVDbGljayA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfTsKCiAgICAgIGRvbUNhY2hlLmNvbnRhaW5lci5vbmNsaWNrID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBpZiAoaWdub3JlT3V0c2lkZUNsaWNrKSB7CiAgICAgICAgICBpZ25vcmVPdXRzaWRlQ2xpY2sgPSBmYWxzZTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChlLnRhcmdldCAhPT0gZG9tQ2FjaGUuY29udGFpbmVyKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoY2FsbElmRnVuY3Rpb24oaW5uZXJQYXJhbXMuYWxsb3dPdXRzaWRlQ2xpY2spKSB7CiAgICAgICAgICBkaXNtaXNzV2l0aChjb25zdHJ1Y3Rvci5EaXNtaXNzUmVhc29uLmJhY2tkcm9wKTsKICAgICAgICB9CiAgICAgIH07CiAgICB9IC8vIFJldmVyc2UgYnV0dG9ucyAoQ29uZmlybSBvbiB0aGUgcmlnaHQgc2lkZSkKCgogICAgaWYgKGlubmVyUGFyYW1zLnJldmVyc2VCdXR0b25zKSB7CiAgICAgIGRvbUNhY2hlLmNvbmZpcm1CdXR0b24ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZG9tQ2FjaGUuY2FuY2VsQnV0dG9uLCBkb21DYWNoZS5jb25maXJtQnV0dG9uKTsKICAgIH0gZWxzZSB7CiAgICAgIGRvbUNhY2hlLmNvbmZpcm1CdXR0b24ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZG9tQ2FjaGUuY29uZmlybUJ1dHRvbiwgZG9tQ2FjaGUuY2FuY2VsQnV0dG9uKTsKICAgIH0gLy8gRm9jdXMgaGFuZGxpbmcKCgogICAgdmFyIHNldEZvY3VzID0gZnVuY3Rpb24gc2V0Rm9jdXMoaW5kZXgsIGluY3JlbWVudCkgewogICAgICB2YXIgZm9jdXNhYmxlRWxlbWVudHMgPSBnZXRGb2N1c2FibGVFbGVtZW50cyhpbm5lclBhcmFtcy5mb2N1c0NhbmNlbCk7IC8vIHNlYXJjaCBmb3IgdmlzaWJsZSBlbGVtZW50cyBhbmQgc2VsZWN0IHRoZSBuZXh0IHBvc3NpYmxlIG1hdGNoCgogICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgZm9jdXNhYmxlRWxlbWVudHMubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgaW5kZXggPSBpbmRleCArIGluY3JlbWVudDsgLy8gcm9sbG92ZXIgdG8gZmlyc3QgaXRlbQoKICAgICAgICBpZiAoaW5kZXggPT09IGZvY3VzYWJsZUVsZW1lbnRzLmxlbmd0aCkgewogICAgICAgICAgaW5kZXggPSAwOyAvLyBnbyB0byBsYXN0IGl0ZW0KICAgICAgICB9IGVsc2UgaWYgKGluZGV4ID09PSAtMSkgewogICAgICAgICAgaW5kZXggPSBmb2N1c2FibGVFbGVtZW50cy5sZW5ndGggLSAxOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZvY3VzYWJsZUVsZW1lbnRzW2luZGV4XS5mb2N1cygpOwogICAgICB9IC8vIG5vIHZpc2libGUgZm9jdXNhYmxlIGVsZW1lbnRzLCBmb2N1cyB0aGUgcG9wdXAKCgogICAgICBkb21DYWNoZS5wb3B1cC5mb2N1cygpOwogICAgfTsKCiAgICB2YXIga2V5ZG93bkhhbmRsZXIgPSBmdW5jdGlvbiBrZXlkb3duSGFuZGxlcihlLCBpbm5lclBhcmFtcykgewogICAgICBpZiAoaW5uZXJQYXJhbXMuc3RvcEtleWRvd25Qcm9wYWdhdGlvbikgewogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIH0KCiAgICAgIHZhciBhcnJvd0tleXMgPSBbJ0Fycm93TGVmdCcsICdBcnJvd1JpZ2h0JywgJ0Fycm93VXAnLCAnQXJyb3dEb3duJywgJ0xlZnQnLCAnUmlnaHQnLCAnVXAnLCAnRG93bicgLy8gSUUxMQogICAgICBdOwoKICAgICAgaWYgKGUua2V5ID09PSAnRW50ZXInICYmICFlLmlzQ29tcG9zaW5nKSB7CiAgICAgICAgaWYgKGUudGFyZ2V0ICYmIF90aGlzLmdldElucHV0KCkgJiYgZS50YXJnZXQub3V0ZXJIVE1MID09PSBfdGhpcy5nZXRJbnB1dCgpLm91dGVySFRNTCkgewogICAgICAgICAgaWYgKFsndGV4dGFyZWEnLCAnZmlsZSddLmluZGV4T2YoaW5uZXJQYXJhbXMuaW5wdXQpICE9PSAtMSkgewogICAgICAgICAgICByZXR1cm47IC8vIGRvIG5vdCBzdWJtaXQKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdHJ1Y3Rvci5jbGlja0NvbmZpcm0oKTsKICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICB9IC8vIFRBQgoKICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ1RhYicpIHsKICAgICAgICB2YXIgdGFyZ2V0RWxlbWVudCA9IGUudGFyZ2V0OwogICAgICAgIHZhciBmb2N1c2FibGVFbGVtZW50cyA9IGdldEZvY3VzYWJsZUVsZW1lbnRzKGlubmVyUGFyYW1zLmZvY3VzQ2FuY2VsKTsKICAgICAgICB2YXIgYnRuSW5kZXggPSAtMTsKCiAgICAgICAgZm9yICh2YXIgX2kyID0gMDsgX2kyIDwgZm9jdXNhYmxlRWxlbWVudHMubGVuZ3RoOyBfaTIrKykgewogICAgICAgICAgaWYgKHRhcmdldEVsZW1lbnQgPT09IGZvY3VzYWJsZUVsZW1lbnRzW19pMl0pIHsKICAgICAgICAgICAgYnRuSW5kZXggPSBfaTI7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCFlLnNoaWZ0S2V5KSB7CiAgICAgICAgICAvLyBDeWNsZSB0byB0aGUgbmV4dCBidXR0b24KICAgICAgICAgIHNldEZvY3VzKGJ0bkluZGV4LCAxKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gQ3ljbGUgdG8gdGhlIHByZXYgYnV0dG9uCiAgICAgICAgICBzZXRGb2N1cyhidG5JbmRleCwgLTEpOwogICAgICAgIH0KCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7IC8vIEFSUk9XUyAtIHN3aXRjaCBmb2N1cyBiZXR3ZWVuIGJ1dHRvbnMKICAgICAgfSBlbHNlIGlmIChhcnJvd0tleXMuaW5kZXhPZihlLmtleSkgIT09IC0xKSB7CiAgICAgICAgLy8gZm9jdXMgQ2FuY2VsIGJ1dHRvbiBpZiBDb25maXJtIGJ1dHRvbiBpcyBjdXJyZW50bHkgZm9jdXNlZAogICAgICAgIGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSBkb21DYWNoZS5jb25maXJtQnV0dG9uICYmIGlzVmlzaWJsZShkb21DYWNoZS5jYW5jZWxCdXR0b24pKSB7CiAgICAgICAgICBkb21DYWNoZS5jYW5jZWxCdXR0b24uZm9jdXMoKTsgLy8gYW5kIHZpY2UgdmVyc2EKICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IGRvbUNhY2hlLmNhbmNlbEJ1dHRvbiAmJiBpc1Zpc2libGUoZG9tQ2FjaGUuY29uZmlybUJ1dHRvbikpIHsKICAgICAgICAgIGRvbUNhY2hlLmNvbmZpcm1CdXR0b24uZm9jdXMoKTsKICAgICAgICB9IC8vIEVTQwoKICAgICAgfSBlbHNlIGlmICgoZS5rZXkgPT09ICdFc2NhcGUnIHx8IGUua2V5ID09PSAnRXNjJykgJiYgY2FsbElmRnVuY3Rpb24oaW5uZXJQYXJhbXMuYWxsb3dFc2NhcGVLZXkpID09PSB0cnVlKSB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGRpc21pc3NXaXRoKGNvbnN0cnVjdG9yLkRpc21pc3NSZWFzb24uZXNjKTsKICAgICAgfQogICAgfTsKCiAgICBpZiAoZ2xvYmFsU3RhdGUua2V5ZG93blRhcmdldCAmJiBnbG9iYWxTdGF0ZS5rZXlkb3duSGFuZGxlckFkZGVkKSB7CiAgICAgIGdsb2JhbFN0YXRlLmtleWRvd25UYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGdsb2JhbFN0YXRlLmtleWRvd25IYW5kbGVyLCB7CiAgICAgICAgY2FwdHVyZTogZ2xvYmFsU3RhdGUua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZQogICAgICB9KTsKICAgICAgZ2xvYmFsU3RhdGUua2V5ZG93bkhhbmRsZXJBZGRlZCA9IGZhbHNlOwogICAgfQoKICAgIGlmICghaW5uZXJQYXJhbXMudG9hc3QpIHsKICAgICAgZ2xvYmFsU3RhdGUua2V5ZG93bkhhbmRsZXIgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBrZXlkb3duSGFuZGxlcihlLCBpbm5lclBhcmFtcyk7CiAgICAgIH07CgogICAgICBnbG9iYWxTdGF0ZS5rZXlkb3duVGFyZ2V0ID0gaW5uZXJQYXJhbXMua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZSA/IHdpbmRvdyA6IGRvbUNhY2hlLnBvcHVwOwogICAgICBnbG9iYWxTdGF0ZS5rZXlkb3duTGlzdGVuZXJDYXB0dXJlID0gaW5uZXJQYXJhbXMua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZTsKICAgICAgZ2xvYmFsU3RhdGUua2V5ZG93blRhcmdldC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZ2xvYmFsU3RhdGUua2V5ZG93bkhhbmRsZXIsIHsKICAgICAgICBjYXB0dXJlOiBnbG9iYWxTdGF0ZS5rZXlkb3duTGlzdGVuZXJDYXB0dXJlCiAgICAgIH0pOwogICAgICBnbG9iYWxTdGF0ZS5rZXlkb3duSGFuZGxlckFkZGVkID0gdHJ1ZTsKICAgIH0KCiAgICBfdGhpcy5lbmFibGVCdXR0b25zKCk7CgogICAgX3RoaXMuaGlkZUxvYWRpbmcoKTsKCiAgICBfdGhpcy5yZXNldFZhbGlkYXRpb25NZXNzYWdlKCk7CgogICAgaWYgKGlubmVyUGFyYW1zLnRvYXN0ICYmIChpbm5lclBhcmFtcy5pbnB1dCB8fCBpbm5lclBhcmFtcy5mb290ZXIgfHwgaW5uZXJQYXJhbXMuc2hvd0Nsb3NlQnV0dG9uKSkgewogICAgICBhZGRDbGFzcyhkb2N1bWVudC5ib2R5LCBzd2FsQ2xhc3Nlc1sndG9hc3QtY29sdW1uJ10pOwogICAgfSBlbHNlIHsKICAgICAgcmVtb3ZlQ2xhc3MoZG9jdW1lbnQuYm9keSwgc3dhbENsYXNzZXNbJ3RvYXN0LWNvbHVtbiddKTsKICAgIH0gLy8gaW5wdXRPcHRpb25zLCBpbnB1dFZhbHVlCgoKICAgIGlmIChpbm5lclBhcmFtcy5pbnB1dCA9PT0gJ3NlbGVjdCcgfHwgaW5uZXJQYXJhbXMuaW5wdXQgPT09ICdyYWRpbycpIHsKICAgICAgaGFuZGxlSW5wdXRPcHRpb25zKF90aGlzLCBpbm5lclBhcmFtcyk7CiAgICB9IGVsc2UgaWYgKFsndGV4dCcsICdlbWFpbCcsICdudW1iZXInLCAndGVsJywgJ3RleHRhcmVhJ10uaW5kZXhPZihpbm5lclBhcmFtcy5pbnB1dCkgIT09IC0xICYmIGlzUHJvbWlzZShpbm5lclBhcmFtcy5pbnB1dFZhbHVlKSkgewogICAgICBoYW5kbGVJbnB1dFZhbHVlKF90aGlzLCBpbm5lclBhcmFtcyk7CiAgICB9CgogICAgb3BlblBvcHVwKGlubmVyUGFyYW1zKTsKCiAgICBpZiAoIWlubmVyUGFyYW1zLnRvYXN0KSB7CiAgICAgIGlmICghY2FsbElmRnVuY3Rpb24oaW5uZXJQYXJhbXMuYWxsb3dFbnRlcktleSkpIHsKICAgICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiB0eXBlb2YgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoaW5uZXJQYXJhbXMuZm9jdXNDYW5jZWwgJiYgaXNWaXNpYmxlKGRvbUNhY2hlLmNhbmNlbEJ1dHRvbikpIHsKICAgICAgICBkb21DYWNoZS5jYW5jZWxCdXR0b24uZm9jdXMoKTsKICAgICAgfSBlbHNlIGlmIChpbm5lclBhcmFtcy5mb2N1c0NvbmZpcm0gJiYgaXNWaXNpYmxlKGRvbUNhY2hlLmNvbmZpcm1CdXR0b24pKSB7CiAgICAgICAgZG9tQ2FjaGUuY29uZmlybUJ1dHRvbi5mb2N1cygpOwogICAgICB9IGVsc2UgewogICAgICAgIHNldEZvY3VzKC0xLCAxKTsKICAgICAgfQogICAgfSAvLyBmaXggc2Nyb2xsCgoKICAgIGRvbUNhY2hlLmNvbnRhaW5lci5zY3JvbGxUb3AgPSAwOwogIH0pOwp9CgovKioKICogVXBkYXRlcyBwb3B1cCBwYXJhbWV0ZXJzLgogKi8KCmZ1bmN0aW9uIHVwZGF0ZShwYXJhbXMpIHsKICB2YXIgdmFsaWRVcGRhdGFibGVQYXJhbXMgPSB7fTsgLy8gYXNzaWduIHZhbGlkIHBhcmFtcyBmcm9tIGBwYXJhbXNgIHRvIGBkZWZhdWx0c2AKCiAgT2JqZWN0LmtleXMocGFyYW1zKS5mb3JFYWNoKGZ1bmN0aW9uIChwYXJhbSkgewogICAgaWYgKFN3YWwuaXNVcGRhdGFibGVQYXJhbWV0ZXIocGFyYW0pKSB7CiAgICAgIHZhbGlkVXBkYXRhYmxlUGFyYW1zW3BhcmFtXSA9IHBhcmFtc1twYXJhbV07CiAgICB9IGVsc2UgewogICAgICB3YXJuKCJJbnZhbGlkIHBhcmFtZXRlciB0byB1cGRhdGU6IFwiIi5jb25jYXQocGFyYW0sICJcIi4gVXBkYXRhYmxlIHBhcmFtcyBhcmUgbGlzdGVkIGhlcmU6IGh0dHBzOi8vZ2l0aHViLmNvbS9zd2VldGFsZXJ0Mi9zd2VldGFsZXJ0Mi9ibG9iL21hc3Rlci9zcmMvdXRpbHMvcGFyYW1zLmpzIikpOwogICAgfQogIH0pOwogIHZhciBpbm5lclBhcmFtcyA9IHByaXZhdGVQcm9wcy5pbm5lclBhcmFtcy5nZXQodGhpcyk7CgogIHZhciB1cGRhdGVkUGFyYW1zID0gX2V4dGVuZHMoe30sIGlubmVyUGFyYW1zLCB2YWxpZFVwZGF0YWJsZVBhcmFtcyk7CgogIHJlbmRlcih0aGlzLCB1cGRhdGVkUGFyYW1zKTsKICBwcml2YXRlUHJvcHMuaW5uZXJQYXJhbXMuc2V0KHRoaXMsIHVwZGF0ZWRQYXJhbXMpOwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsIHsKICAgIHBhcmFtczogewogICAgICB2YWx1ZTogX2V4dGVuZHMoe30sIHRoaXMucGFyYW1zLCBwYXJhbXMpLAogICAgICB3cml0YWJsZTogZmFsc2UsCiAgICAgIGVudW1lcmFibGU6IHRydWUKICAgIH0KICB9KTsKfQoKCgp2YXIgaW5zdGFuY2VNZXRob2RzID0gT2JqZWN0LmZyZWV6ZSh7CgloaWRlTG9hZGluZzogaGlkZUxvYWRpbmcsCglkaXNhYmxlTG9hZGluZzogaGlkZUxvYWRpbmcsCglnZXRJbnB1dDogZ2V0SW5wdXQkMSwKCWNsb3NlOiBjbG9zZSwKCWNsb3NlUG9wdXA6IGNsb3NlLAoJY2xvc2VNb2RhbDogY2xvc2UsCgljbG9zZVRvYXN0OiBjbG9zZSwKCWVuYWJsZUJ1dHRvbnM6IGVuYWJsZUJ1dHRvbnMsCglkaXNhYmxlQnV0dG9uczogZGlzYWJsZUJ1dHRvbnMsCgllbmFibGVDb25maXJtQnV0dG9uOiBlbmFibGVDb25maXJtQnV0dG9uLAoJZGlzYWJsZUNvbmZpcm1CdXR0b246IGRpc2FibGVDb25maXJtQnV0dG9uLAoJZW5hYmxlSW5wdXQ6IGVuYWJsZUlucHV0LAoJZGlzYWJsZUlucHV0OiBkaXNhYmxlSW5wdXQsCglzaG93VmFsaWRhdGlvbk1lc3NhZ2U6IHNob3dWYWxpZGF0aW9uTWVzc2FnZSwKCXJlc2V0VmFsaWRhdGlvbk1lc3NhZ2U6IHJlc2V0VmFsaWRhdGlvbk1lc3NhZ2UkMSwKCWdldFByb2dyZXNzU3RlcHM6IGdldFByb2dyZXNzU3RlcHMkMSwKCXNldFByb2dyZXNzU3RlcHM6IHNldFByb2dyZXNzU3RlcHMsCglzaG93UHJvZ3Jlc3NTdGVwczogc2hvd1Byb2dyZXNzU3RlcHMsCgloaWRlUHJvZ3Jlc3NTdGVwczogaGlkZVByb2dyZXNzU3RlcHMsCglfbWFpbjogX21haW4sCgl1cGRhdGU6IHVwZGF0ZQp9KTsKCnZhciBjdXJyZW50SW5zdGFuY2U7IC8vIFN3ZWV0QWxlcnQgY29uc3RydWN0b3IKCmZ1bmN0aW9uIFN3ZWV0QWxlcnQoKSB7CiAgLy8gUHJldmVudCBydW4gaW4gTm9kZSBlbnYKCiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7CiAgICByZXR1cm47CiAgfSAvLyBDaGVjayBmb3IgdGhlIGV4aXN0ZW5jZSBvZiBQcm9taXNlCgogIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwoKCiAgaWYgKHR5cGVvZiBQcm9taXNlID09PSAndW5kZWZpbmVkJykgewogICAgZXJyb3IoJ1RoaXMgcGFja2FnZSByZXF1aXJlcyBhIFByb21pc2UgbGlicmFyeSwgcGxlYXNlIGluY2x1ZGUgYSBzaGltIHRvIGVuYWJsZSBpdCBpbiB0aGlzIGJyb3dzZXIgKFNlZTogaHR0cHM6Ly9naXRodWIuY29tL3N3ZWV0YWxlcnQyL3N3ZWV0YWxlcnQyL3dpa2kvTWlncmF0aW9uLWZyb20tU3dlZXRBbGVydC10by1Td2VldEFsZXJ0MiMxLWllLXN1cHBvcnQpJyk7CiAgfQoKICBjdXJyZW50SW5zdGFuY2UgPSB0aGlzOwoKICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgfQoKICB2YXIgb3V0ZXJQYXJhbXMgPSBPYmplY3QuZnJlZXplKHRoaXMuY29uc3RydWN0b3IuYXJnc1RvUGFyYW1zKGFyZ3MpKTsKICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLCB7CiAgICBwYXJhbXM6IHsKICAgICAgdmFsdWU6IG91dGVyUGFyYW1zLAogICAgICB3cml0YWJsZTogZmFsc2UsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgfQogIH0pOwoKICB2YXIgcHJvbWlzZSA9IHRoaXMuX21haW4odGhpcy5wYXJhbXMpOwoKICBwcml2YXRlUHJvcHMucHJvbWlzZS5zZXQodGhpcywgcHJvbWlzZSk7Cn0gLy8gYGNhdGNoYCBjYW5ub3QgYmUgdGhlIG5hbWUgb2YgYSBtb2R1bGUgZXhwb3J0LCBzbyB3ZSBkZWZpbmUgb3VyIHRoZW5hYmxlIG1ldGhvZHMgaGVyZSBpbnN0ZWFkCgoKU3dlZXRBbGVydC5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uIChvbkZ1bGZpbGxlZCkgewogIHZhciBwcm9taXNlID0gcHJpdmF0ZVByb3BzLnByb21pc2UuZ2V0KHRoaXMpOwogIHJldHVybiBwcm9taXNlLnRoZW4ob25GdWxmaWxsZWQpOwp9OwoKU3dlZXRBbGVydC5wcm90b3R5cGVbImZpbmFsbHkiXSA9IGZ1bmN0aW9uIChvbkZpbmFsbHkpIHsKICB2YXIgcHJvbWlzZSA9IHByaXZhdGVQcm9wcy5wcm9taXNlLmdldCh0aGlzKTsKICByZXR1cm4gcHJvbWlzZVsiZmluYWxseSJdKG9uRmluYWxseSk7Cn07IC8vIEFzc2lnbiBpbnN0YW5jZSBtZXRob2RzIGZyb20gc3JjL2luc3RhbmNlTWV0aG9kcy8qLmpzIHRvIHByb3RvdHlwZQoKCl9leHRlbmRzKFN3ZWV0QWxlcnQucHJvdG90eXBlLCBpbnN0YW5jZU1ldGhvZHMpOyAvLyBBc3NpZ24gc3RhdGljIG1ldGhvZHMgZnJvbSBzcmMvc3RhdGljTWV0aG9kcy8qLmpzIHRvIGNvbnN0cnVjdG9yCgoKX2V4dGVuZHMoU3dlZXRBbGVydCwgc3RhdGljTWV0aG9kcyk7IC8vIFByb3h5IHRvIGluc3RhbmNlIG1ldGhvZHMgdG8gY29uc3RydWN0b3IsIGZvciBub3csIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eQoKCk9iamVjdC5rZXlzKGluc3RhbmNlTWV0aG9kcykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgU3dlZXRBbGVydFtrZXldID0gZnVuY3Rpb24gKCkgewogICAgaWYgKGN1cnJlbnRJbnN0YW5jZSkgewogICAgICB2YXIgX2N1cnJlbnRJbnN0YW5jZTsKCiAgICAgIHJldHVybiAoX2N1cnJlbnRJbnN0YW5jZSA9IGN1cnJlbnRJbnN0YW5jZSlba2V5XS5hcHBseShfY3VycmVudEluc3RhbmNlLCBhcmd1bWVudHMpOwogICAgfQogIH07Cn0pOwpTd2VldEFsZXJ0LkRpc21pc3NSZWFzb24gPSBEaXNtaXNzUmVhc29uOwpTd2VldEFsZXJ0LnZlcnNpb24gPSAnOC4xNC4wJzsKCnZhciBTd2FsID0gU3dlZXRBbGVydDsKU3dhbFsiZGVmYXVsdCJdID0gU3dhbDsKCnJldHVybiBTd2FsOwoKfSkpKTsKaWYgKHR5cGVvZiB0aGlzICE9PSAndW5kZWZpbmVkJyAmJiB0aGlzLlN3ZWV0YWxlcnQyKXsgIHRoaXMuc3dhbCA9IHRoaXMuc3dlZXRBbGVydCA9IHRoaXMuU3dhbCA9IHRoaXMuU3dlZXRBbGVydCA9IHRoaXMuU3dlZXRhbGVydDJ9CgoidW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50JiZmdW5jdGlvbihlLHQpe3ZhciBuPWUuY3JlYXRlRWxlbWVudCgic3R5bGUiKTtpZihlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJoZWFkIilbMF0uYXBwZW5kQ2hpbGQobiksbi5zdHlsZVNoZWV0KW4uc3R5bGVTaGVldC5kaXNhYmxlZHx8KG4uc3R5bGVTaGVldC5jc3NUZXh0PXQpO2Vsc2UgdHJ5e24uaW5uZXJIVE1MPXR9Y2F0Y2goZSl7bi5pbm5lclRleHQ9dH19KGRvY3VtZW50LCJAY2hhcnNldCBcIlVURi04XCI7QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXNob3d7MCV7dHJhbnNmb3JtOnNjYWxlKC43KX00NSV7dHJhbnNmb3JtOnNjYWxlKDEuMDUpfTgwJXt0cmFuc2Zvcm06c2NhbGUoLjk1KX0xMDAle3RyYW5zZm9ybTpzY2FsZSgxKX19QGtleWZyYW1lcyBzd2FsMi1zaG93ezAle3RyYW5zZm9ybTpzY2FsZSguNyl9NDUle3RyYW5zZm9ybTpzY2FsZSgxLjA1KX04MCV7dHJhbnNmb3JtOnNjYWxlKC45NSl9MTAwJXt0cmFuc2Zvcm06c2NhbGUoMSl9fUAtd2Via2l0LWtleWZyYW1lcyBzd2FsMi1oaWRlezAle3RyYW5zZm9ybTpzY2FsZSgxKTtvcGFjaXR5OjF9MTAwJXt0cmFuc2Zvcm06c2NhbGUoLjUpO29wYWNpdHk6MH19QGtleWZyYW1lcyBzd2FsMi1oaWRlezAle3RyYW5zZm9ybTpzY2FsZSgxKTtvcGFjaXR5OjF9MTAwJXt0cmFuc2Zvcm06c2NhbGUoLjUpO29wYWNpdHk6MH19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLWFuaW1hdGUtc3VjY2Vzcy1saW5lLXRpcHswJXt0b3A6MS4xODc1ZW07bGVmdDouMDYyNWVtO3dpZHRoOjB9NTQle3RvcDoxLjA2MjVlbTtsZWZ0Oi4xMjVlbTt3aWR0aDowfTcwJXt0b3A6Mi4xODc1ZW07bGVmdDotLjM3NWVtO3dpZHRoOjMuMTI1ZW19ODQle3RvcDozZW07bGVmdDoxLjMxMjVlbTt3aWR0aDoxLjA2MjVlbX0xMDAle3RvcDoyLjgxMjVlbTtsZWZ0Oi44NzVlbTt3aWR0aDoxLjU2MjVlbX19QGtleWZyYW1lcyBzd2FsMi1hbmltYXRlLXN1Y2Nlc3MtbGluZS10aXB7MCV7dG9wOjEuMTg3NWVtO2xlZnQ6LjA2MjVlbTt3aWR0aDowfTU0JXt0b3A6MS4wNjI1ZW07bGVmdDouMTI1ZW07d2lkdGg6MH03MCV7dG9wOjIuMTg3NWVtO2xlZnQ6LS4zNzVlbTt3aWR0aDozLjEyNWVtfTg0JXt0b3A6M2VtO2xlZnQ6MS4zMTI1ZW07d2lkdGg6MS4wNjI1ZW19MTAwJXt0b3A6Mi44MTI1ZW07bGVmdDouODc1ZW07d2lkdGg6MS41NjI1ZW19fUAtd2Via2l0LWtleWZyYW1lcyBzd2FsMi1hbmltYXRlLXN1Y2Nlc3MtbGluZS1sb25nezAle3RvcDozLjM3NWVtO3JpZ2h0OjIuODc1ZW07d2lkdGg6MH02NSV7dG9wOjMuMzc1ZW07cmlnaHQ6Mi44NzVlbTt3aWR0aDowfTg0JXt0b3A6Mi4xODc1ZW07cmlnaHQ6MDt3aWR0aDozLjQzNzVlbX0xMDAle3RvcDoyLjM3NWVtO3JpZ2h0Oi41ZW07d2lkdGg6Mi45Mzc1ZW19fUBrZXlmcmFtZXMgc3dhbDItYW5pbWF0ZS1zdWNjZXNzLWxpbmUtbG9uZ3swJXt0b3A6My4zNzVlbTtyaWdodDoyLjg3NWVtO3dpZHRoOjB9NjUle3RvcDozLjM3NWVtO3JpZ2h0OjIuODc1ZW07d2lkdGg6MH04NCV7dG9wOjIuMTg3NWVtO3JpZ2h0OjA7d2lkdGg6My40Mzc1ZW19MTAwJXt0b3A6Mi4zNzVlbTtyaWdodDouNWVtO3dpZHRoOjIuOTM3NWVtfX1ALXdlYmtpdC1rZXlmcmFtZXMgc3dhbDItcm90YXRlLXN1Y2Nlc3MtY2lyY3VsYXItbGluZXswJXt0cmFuc2Zvcm06cm90YXRlKC00NWRlZyl9NSV7dHJhbnNmb3JtOnJvdGF0ZSgtNDVkZWcpfTEyJXt0cmFuc2Zvcm06cm90YXRlKC00MDVkZWcpfTEwMCV7dHJhbnNmb3JtOnJvdGF0ZSgtNDA1ZGVnKX19QGtleWZyYW1lcyBzd2FsMi1yb3RhdGUtc3VjY2Vzcy1jaXJjdWxhci1saW5lezAle3RyYW5zZm9ybTpyb3RhdGUoLTQ1ZGVnKX01JXt0cmFuc2Zvcm06cm90YXRlKC00NWRlZyl9MTIle3RyYW5zZm9ybTpyb3RhdGUoLTQwNWRlZyl9MTAwJXt0cmFuc2Zvcm06cm90YXRlKC00MDVkZWcpfX1ALXdlYmtpdC1rZXlmcmFtZXMgc3dhbDItYW5pbWF0ZS1lcnJvci14LW1hcmt7MCV7bWFyZ2luLXRvcDoxLjYyNWVtO3RyYW5zZm9ybTpzY2FsZSguNCk7b3BhY2l0eTowfTUwJXttYXJnaW4tdG9wOjEuNjI1ZW07dHJhbnNmb3JtOnNjYWxlKC40KTtvcGFjaXR5OjB9ODAle21hcmdpbi10b3A6LS4zNzVlbTt0cmFuc2Zvcm06c2NhbGUoMS4xNSl9MTAwJXttYXJnaW4tdG9wOjA7dHJhbnNmb3JtOnNjYWxlKDEpO29wYWNpdHk6MX19QGtleWZyYW1lcyBzd2FsMi1hbmltYXRlLWVycm9yLXgtbWFya3swJXttYXJnaW4tdG9wOjEuNjI1ZW07dHJhbnNmb3JtOnNjYWxlKC40KTtvcGFjaXR5OjB9NTAle21hcmdpbi10b3A6MS42MjVlbTt0cmFuc2Zvcm06c2NhbGUoLjQpO29wYWNpdHk6MH04MCV7bWFyZ2luLXRvcDotLjM3NWVtO3RyYW5zZm9ybTpzY2FsZSgxLjE1KX0xMDAle21hcmdpbi10b3A6MDt0cmFuc2Zvcm06c2NhbGUoMSk7b3BhY2l0eToxfX1ALXdlYmtpdC1rZXlmcmFtZXMgc3dhbDItYW5pbWF0ZS1lcnJvci1pY29uezAle3RyYW5zZm9ybTpyb3RhdGVYKDEwMGRlZyk7b3BhY2l0eTowfTEwMCV7dHJhbnNmb3JtOnJvdGF0ZVgoMCk7b3BhY2l0eToxfX1Aa2V5ZnJhbWVzIHN3YWwyLWFuaW1hdGUtZXJyb3ItaWNvbnswJXt0cmFuc2Zvcm06cm90YXRlWCgxMDBkZWcpO29wYWNpdHk6MH0xMDAle3RyYW5zZm9ybTpyb3RhdGVYKDApO29wYWNpdHk6MX19Ym9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVye2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnR9Ym9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLXNob3due2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnR9Ym9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcHt0b3A6MDtyaWdodDphdXRvO2JvdHRvbTphdXRvO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpfWJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3AtZW5kLGJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3AtcmlnaHR7dG9wOjA7cmlnaHQ6MDtib3R0b206YXV0bztsZWZ0OmF1dG99Ym9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1sZWZ0LGJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3Atc3RhcnR7dG9wOjA7cmlnaHQ6YXV0bztib3R0b206YXV0bztsZWZ0OjB9Ym9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLWNlbnRlci1sZWZ0LGJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXItc3RhcnR7dG9wOjUwJTtyaWdodDphdXRvO2JvdHRvbTphdXRvO2xlZnQ6MDt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtNTAlKX1ib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVye3RvcDo1MCU7cmlnaHQ6YXV0bztib3R0b206YXV0bztsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsLTUwJSl9Ym9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLWNlbnRlci1lbmQsYm9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLWNlbnRlci1yaWdodHt0b3A6NTAlO3JpZ2h0OjA7Ym90dG9tOmF1dG87bGVmdDphdXRvO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpfWJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tbGVmdCxib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLXN0YXJ0e3RvcDphdXRvO3JpZ2h0OmF1dG87Ym90dG9tOjA7bGVmdDowfWJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b217dG9wOmF1dG87cmlnaHQ6YXV0bztib3R0b206MDtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKX1ib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLWVuZCxib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLXJpZ2h0e3RvcDphdXRvO3JpZ2h0OjA7Ym90dG9tOjA7bGVmdDphdXRvfWJvZHkuc3dhbDItdG9hc3QtY29sdW1uIC5zd2FsMi10b2FzdHtmbGV4LWRpcmVjdGlvbjpjb2x1bW47YWxpZ24taXRlbXM6c3RyZXRjaH1ib2R5LnN3YWwyLXRvYXN0LWNvbHVtbiAuc3dhbDItdG9hc3QgLnN3YWwyLWFjdGlvbnN7ZmxleDoxO2FsaWduLXNlbGY6c3RyZXRjaDtoZWlnaHQ6Mi4yZW07bWFyZ2luLXRvcDouMzEyNWVtfWJvZHkuc3dhbDItdG9hc3QtY29sdW1uIC5zd2FsMi10b2FzdCAuc3dhbDItbG9hZGluZ3tqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfWJvZHkuc3dhbDItdG9hc3QtY29sdW1uIC5zd2FsMi10b2FzdCAuc3dhbDItaW5wdXR7aGVpZ2h0OjJlbTttYXJnaW46LjMxMjVlbSBhdXRvO2ZvbnQtc2l6ZToxZW19Ym9keS5zd2FsMi10b2FzdC1jb2x1bW4gLnN3YWwyLXRvYXN0IC5zd2FsMi12YWxpZGF0aW9uLW1lc3NhZ2V7Zm9udC1zaXplOjFlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3R7ZmxleC1kaXJlY3Rpb246cm93O2FsaWduLWl0ZW1zOmNlbnRlcjt3aWR0aDphdXRvO3BhZGRpbmc6LjYyNWVtO292ZXJmbG93LXk6aGlkZGVuO2JveC1zaGFkb3c6MCAwIC42MjVlbSAjZDlkOWQ5fS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItaGVhZGVye2ZsZXgtZGlyZWN0aW9uOnJvd30uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLXRpdGxle2ZsZXgtZ3JvdzoxO2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0O21hcmdpbjowIC42ZW07Zm9udC1zaXplOjFlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLWZvb3RlcnttYXJnaW46LjVlbSAwIDA7cGFkZGluZzouNWVtIDAgMDtmb250LXNpemU6LjhlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLWNsb3Nle3Bvc2l0aW9uOnN0YXRpYzt3aWR0aDouOGVtO2hlaWdodDouOGVtO2xpbmUtaGVpZ2h0Oi44fS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItY29udGVudHtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1zdGFydDtmb250LXNpemU6MWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItaWNvbnt3aWR0aDoyZW07bWluLXdpZHRoOjJlbTtoZWlnaHQ6MmVtO21hcmdpbjowfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItaWNvbjo6YmVmb3Jle2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Zm9udC1zaXplOjJlbTtmb250LXdlaWdodDo3MDB9QG1lZGlhIGFsbCBhbmQgKC1tcy1oaWdoLWNvbnRyYXN0Om5vbmUpLCgtbXMtaGlnaC1jb250cmFzdDphY3RpdmUpey5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItaWNvbjo6YmVmb3Jle2ZvbnQtc2l6ZTouMjVlbX19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3MgLnN3YWwyLXN1Y2Nlc3MtcmluZ3t3aWR0aDoyZW07aGVpZ2h0OjJlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLWljb24uc3dhbDItZXJyb3IgW2NsYXNzXj1zd2FsMi14LW1hcmstbGluZV17dG9wOi44NzVlbTt3aWR0aDoxLjM3NWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItaWNvbi5zd2FsMi1lcnJvciBbY2xhc3NePXN3YWwyLXgtbWFyay1saW5lXVtjbGFzcyQ9bGVmdF17bGVmdDouMzEyNWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItaWNvbi5zd2FsMi1lcnJvciBbY2xhc3NePXN3YWwyLXgtbWFyay1saW5lXVtjbGFzcyQ9cmlnaHRde3JpZ2h0Oi4zMTI1ZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1hY3Rpb25ze2ZsZXgtYmFzaXM6YXV0byFpbXBvcnRhbnQ7d2lkdGg6YXV0bztoZWlnaHQ6YXV0bzttYXJnaW46MCAuMzEyNWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3R5bGVke21hcmdpbjowIC4zMTI1ZW07cGFkZGluZzouMzEyNWVtIC42MjVlbTtmb250LXNpemU6MWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3R5bGVkOmZvY3Vze2JveC1zaGFkb3c6MCAwIDAgLjA2MjVlbSAjZmZmLDAgMCAwIC4xMjVlbSByZ2JhKDUwLDEwMCwxNTAsLjQpfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2Vzc3tib3JkZXItY29sb3I6I2E1ZGM4Nn0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLXN1Y2Nlc3MgW2NsYXNzXj1zd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmVde3Bvc2l0aW9uOmFic29sdXRlO3dpZHRoOjEuNmVtO2hlaWdodDozZW07dHJhbnNmb3JtOnJvdGF0ZSg0NWRlZyk7Ym9yZGVyLXJhZGl1czo1MCV9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lXVtjbGFzcyQ9bGVmdF17dG9wOi0uOGVtO2xlZnQ6LS41ZW07dHJhbnNmb3JtOnJvdGF0ZSgtNDVkZWcpO3RyYW5zZm9ybS1vcmlnaW46MmVtIDJlbTtib3JkZXItcmFkaXVzOjRlbSAwIDAgNGVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2VzcyBbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtY2lyY3VsYXItbGluZV1bY2xhc3MkPXJpZ2h0XXt0b3A6LS4yNWVtO2xlZnQ6LjkzNzVlbTt0cmFuc2Zvcm0tb3JpZ2luOjAgMS41ZW07Ym9yZGVyLXJhZGl1czowIDRlbSA0ZW0gMH0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLXN1Y2Nlc3MgLnN3YWwyLXN1Y2Nlc3MtcmluZ3t3aWR0aDoyZW07aGVpZ2h0OjJlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLXN1Y2Nlc3MgLnN3YWwyLXN1Y2Nlc3MtZml4e3RvcDowO2xlZnQ6LjQzNzVlbTt3aWR0aDouNDM3NWVtO2hlaWdodDoyLjY4NzVlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLXN1Y2Nlc3MgW2NsYXNzXj1zd2FsMi1zdWNjZXNzLWxpbmVde2hlaWdodDouMzEyNWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2VzcyBbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtbGluZV1bY2xhc3MkPXRpcF17dG9wOjEuMTI1ZW07bGVmdDouMTg3NWVtO3dpZHRoOi43NWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2VzcyBbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtbGluZV1bY2xhc3MkPWxvbmdde3RvcDouOTM3NWVtO3JpZ2h0Oi4xODc1ZW07d2lkdGg6MS4zNzVlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3Quc3dhbDItc2hvd3std2Via2l0LWFuaW1hdGlvbjpzd2FsMi10b2FzdC1zaG93IC41czthbmltYXRpb246c3dhbDItdG9hc3Qtc2hvdyAuNXN9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0LnN3YWwyLWhpZGV7LXdlYmtpdC1hbmltYXRpb246c3dhbDItdG9hc3QtaGlkZSAuMXMgZm9yd2FyZHM7YW5pbWF0aW9uOnN3YWwyLXRvYXN0LWhpZGUgLjFzIGZvcndhcmRzfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItYW5pbWF0ZS1zdWNjZXNzLWljb24gLnN3YWwyLXN1Y2Nlc3MtbGluZS10aXB7LXdlYmtpdC1hbmltYXRpb246c3dhbDItdG9hc3QtYW5pbWF0ZS1zdWNjZXNzLWxpbmUtdGlwIC43NXM7YW5pbWF0aW9uOnN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLXRpcCAuNzVzfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItYW5pbWF0ZS1zdWNjZXNzLWljb24gLnN3YWwyLXN1Y2Nlc3MtbGluZS1sb25ney13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmcgLjc1czthbmltYXRpb246c3dhbDItdG9hc3QtYW5pbWF0ZS1zdWNjZXNzLWxpbmUtbG9uZyAuNzVzfUAtd2Via2l0LWtleWZyYW1lcyBzd2FsMi10b2FzdC1zaG93ezAle3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0uNjI1ZW0pIHJvdGF0ZVooMmRlZyl9MzMle3RyYW5zZm9ybTp0cmFuc2xhdGVZKDApIHJvdGF0ZVooLTJkZWcpfTY2JXt0cmFuc2Zvcm06dHJhbnNsYXRlWSguMzEyNWVtKSByb3RhdGVaKDJkZWcpfTEwMCV7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCkgcm90YXRlWigwKX19QGtleWZyYW1lcyBzd2FsMi10b2FzdC1zaG93ezAle3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0uNjI1ZW0pIHJvdGF0ZVooMmRlZyl9MzMle3RyYW5zZm9ybTp0cmFuc2xhdGVZKDApIHJvdGF0ZVooLTJkZWcpfTY2JXt0cmFuc2Zvcm06dHJhbnNsYXRlWSguMzEyNWVtKSByb3RhdGVaKDJkZWcpfTEwMCV7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCkgcm90YXRlWigwKX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXRvYXN0LWhpZGV7MTAwJXt0cmFuc2Zvcm06cm90YXRlWigxZGVnKTtvcGFjaXR5OjB9fUBrZXlmcmFtZXMgc3dhbDItdG9hc3QtaGlkZXsxMDAle3RyYW5zZm9ybTpyb3RhdGVaKDFkZWcpO29wYWNpdHk6MH19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLXRpcHswJXt0b3A6LjU2MjVlbTtsZWZ0Oi4wNjI1ZW07d2lkdGg6MH01NCV7dG9wOi4xMjVlbTtsZWZ0Oi4xMjVlbTt3aWR0aDowfTcwJXt0b3A6LjYyNWVtO2xlZnQ6LS4yNWVtO3dpZHRoOjEuNjI1ZW19ODQle3RvcDoxLjA2MjVlbTtsZWZ0Oi43NWVtO3dpZHRoOi41ZW19MTAwJXt0b3A6MS4xMjVlbTtsZWZ0Oi4xODc1ZW07d2lkdGg6Ljc1ZW19fUBrZXlmcmFtZXMgc3dhbDItdG9hc3QtYW5pbWF0ZS1zdWNjZXNzLWxpbmUtdGlwezAle3RvcDouNTYyNWVtO2xlZnQ6LjA2MjVlbTt3aWR0aDowfTU0JXt0b3A6LjEyNWVtO2xlZnQ6LjEyNWVtO3dpZHRoOjB9NzAle3RvcDouNjI1ZW07bGVmdDotLjI1ZW07d2lkdGg6MS42MjVlbX04NCV7dG9wOjEuMDYyNWVtO2xlZnQ6Ljc1ZW07d2lkdGg6LjVlbX0xMDAle3RvcDoxLjEyNWVtO2xlZnQ6LjE4NzVlbTt3aWR0aDouNzVlbX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmd7MCV7dG9wOjEuNjI1ZW07cmlnaHQ6MS4zNzVlbTt3aWR0aDowfTY1JXt0b3A6MS4yNWVtO3JpZ2h0Oi45Mzc1ZW07d2lkdGg6MH04NCV7dG9wOi45Mzc1ZW07cmlnaHQ6MDt3aWR0aDoxLjEyNWVtfTEwMCV7dG9wOi45Mzc1ZW07cmlnaHQ6LjE4NzVlbTt3aWR0aDoxLjM3NWVtfX1Aa2V5ZnJhbWVzIHN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmd7MCV7dG9wOjEuNjI1ZW07cmlnaHQ6MS4zNzVlbTt3aWR0aDowfTY1JXt0b3A6MS4yNWVtO3JpZ2h0Oi45Mzc1ZW07d2lkdGg6MH04NCV7dG9wOi45Mzc1ZW07cmlnaHQ6MDt3aWR0aDoxLjEyNWVtfTEwMCV7dG9wOi45Mzc1ZW07cmlnaHQ6LjE4NzVlbTt3aWR0aDoxLjM3NWVtfX1ib2R5LnN3YWwyLXNob3duOm5vdCguc3dhbDItbm8tYmFja2Ryb3ApOm5vdCguc3dhbDItdG9hc3Qtc2hvd24pe292ZXJmbG93OmhpZGRlbn1ib2R5LnN3YWwyLWhlaWdodC1hdXRve2hlaWdodDphdXRvIWltcG9ydGFudH1ib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1zaG93bnt0b3A6YXV0bztyaWdodDphdXRvO2JvdHRvbTphdXRvO2xlZnQ6YXV0bzttYXgtd2lkdGg6Y2FsYygxMDAlIC0gLjYyNWVtICogMik7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudH1ib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1zaG93bj4uc3dhbDItbW9kYWx7Ym94LXNoYWRvdzowIDAgMTBweCByZ2JhKDAsMCwwLC40KX1ib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1zaG93bi5zd2FsMi10b3B7dG9wOjA7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSl9Ym9keS5zd2FsMi1uby1iYWNrZHJvcCAuc3dhbDItc2hvd24uc3dhbDItdG9wLWxlZnQsYm9keS5zd2FsMi1uby1iYWNrZHJvcCAuc3dhbDItc2hvd24uc3dhbDItdG9wLXN0YXJ0e3RvcDowO2xlZnQ6MH1ib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1zaG93bi5zd2FsMi10b3AtZW5kLGJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLXNob3duLnN3YWwyLXRvcC1yaWdodHt0b3A6MDtyaWdodDowfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLXNob3duLnN3YWwyLWNlbnRlcnt0b3A6NTAlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGUoLTUwJSwtNTAlKX1ib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1zaG93bi5zd2FsMi1jZW50ZXItbGVmdCxib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1zaG93bi5zd2FsMi1jZW50ZXItc3RhcnR7dG9wOjUwJTtsZWZ0OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTUwJSl9Ym9keS5zd2FsMi1uby1iYWNrZHJvcCAuc3dhbDItc2hvd24uc3dhbDItY2VudGVyLWVuZCxib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1zaG93bi5zd2FsMi1jZW50ZXItcmlnaHR7dG9wOjUwJTtyaWdodDowO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLXNob3duLnN3YWwyLWJvdHRvbXtib3R0b206MDtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKX1ib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1zaG93bi5zd2FsMi1ib3R0b20tbGVmdCxib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1zaG93bi5zd2FsMi1ib3R0b20tc3RhcnR7Ym90dG9tOjA7bGVmdDowfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLXNob3duLnN3YWwyLWJvdHRvbS1lbmQsYm9keS5zd2FsMi1uby1iYWNrZHJvcCAuc3dhbDItc2hvd24uc3dhbDItYm90dG9tLXJpZ2h0e3JpZ2h0OjA7Ym90dG9tOjB9LnN3YWwyLWNvbnRhaW5lcntkaXNwbGF5OmZsZXg7cG9zaXRpb246Zml4ZWQ7ei1pbmRleDoxMDYwO3RvcDowO3JpZ2h0OjA7Ym90dG9tOjA7bGVmdDowO2ZsZXgtZGlyZWN0aW9uOnJvdzthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtwYWRkaW5nOi42MjVlbTtvdmVyZmxvdy14OmhpZGRlbjtiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50Oy13ZWJraXQtb3ZlcmZsb3ctc2Nyb2xsaW5nOnRvdWNofS5zd2FsMi1jb250YWluZXIuc3dhbDItdG9we2FsaWduLWl0ZW1zOmZsZXgtc3RhcnR9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3AtbGVmdCwuc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1zdGFydHthbGlnbi1pdGVtczpmbGV4LXN0YXJ0O2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0fS5zd2FsMi1jb250YWluZXIuc3dhbDItdG9wLWVuZCwuc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1yaWdodHthbGlnbi1pdGVtczpmbGV4LXN0YXJ0O2p1c3RpZnktY29udGVudDpmbGV4LWVuZH0uc3dhbDItY29udGFpbmVyLnN3YWwyLWNlbnRlcnthbGlnbi1pdGVtczpjZW50ZXJ9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXItbGVmdCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWNlbnRlci1zdGFydHthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmZsZXgtc3RhcnR9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXItZW5kLC5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLXJpZ2h0e2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmR9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b217YWxpZ24taXRlbXM6ZmxleC1lbmR9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tbGVmdCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbS1zdGFydHthbGlnbi1pdGVtczpmbGV4LWVuZDtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1zdGFydH0uc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbS1lbmQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tcmlnaHR7YWxpZ24taXRlbXM6ZmxleC1lbmQ7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kfS5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLWVuZD46Zmlyc3QtY2hpbGQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tbGVmdD46Zmlyc3QtY2hpbGQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tcmlnaHQ+OmZpcnN0LWNoaWxkLC5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLXN0YXJ0PjpmaXJzdC1jaGlsZCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbT46Zmlyc3QtY2hpbGR7bWFyZ2luLXRvcDphdXRvfS5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1mdWxsc2NyZWVuPi5zd2FsMi1tb2RhbHtkaXNwbGF5OmZsZXghaW1wb3J0YW50O2ZsZXg6MTthbGlnbi1zZWxmOnN0cmV0Y2g7anVzdGlmeS1jb250ZW50OmNlbnRlcn0uc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctcm93Pi5zd2FsMi1tb2RhbHtkaXNwbGF5OmZsZXghaW1wb3J0YW50O2ZsZXg6MTthbGlnbi1jb250ZW50OmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfS5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW57ZmxleDoxO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn0uc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLWJvdHRvbSwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLWNlbnRlciwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLXRvcHthbGlnbi1pdGVtczpjZW50ZXJ9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1ib3R0b20tbGVmdCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLWJvdHRvbS1zdGFydCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLWNlbnRlci1sZWZ0LC5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW4uc3dhbDItY2VudGVyLXN0YXJ0LC5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW4uc3dhbDItdG9wLWxlZnQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi10b3Atc3RhcnR7YWxpZ24taXRlbXM6ZmxleC1zdGFydH0uc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLWJvdHRvbS1lbmQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1ib3R0b20tcmlnaHQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1jZW50ZXItZW5kLC5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW4uc3dhbDItY2VudGVyLXJpZ2h0LC5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW4uc3dhbDItdG9wLWVuZCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLXRvcC1yaWdodHthbGlnbi1pdGVtczpmbGV4LWVuZH0uc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uPi5zd2FsMi1tb2RhbHtkaXNwbGF5OmZsZXghaW1wb3J0YW50O2ZsZXg6MTthbGlnbi1jb250ZW50OmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfS5zd2FsMi1jb250YWluZXI6bm90KC5zd2FsMi10b3ApOm5vdCguc3dhbDItdG9wLXN0YXJ0KTpub3QoLnN3YWwyLXRvcC1lbmQpOm5vdCguc3dhbDItdG9wLWxlZnQpOm5vdCguc3dhbDItdG9wLXJpZ2h0KTpub3QoLnN3YWwyLWNlbnRlci1zdGFydCk6bm90KC5zd2FsMi1jZW50ZXItZW5kKTpub3QoLnN3YWwyLWNlbnRlci1sZWZ0KTpub3QoLnN3YWwyLWNlbnRlci1yaWdodCk6bm90KC5zd2FsMi1ib3R0b20pOm5vdCguc3dhbDItYm90dG9tLXN0YXJ0KTpub3QoLnN3YWwyLWJvdHRvbS1lbmQpOm5vdCguc3dhbDItYm90dG9tLWxlZnQpOm5vdCguc3dhbDItYm90dG9tLXJpZ2h0KTpub3QoLnN3YWwyLWdyb3ctZnVsbHNjcmVlbik+LnN3YWwyLW1vZGFse21hcmdpbjphdXRvfUBtZWRpYSBhbGwgYW5kICgtbXMtaGlnaC1jb250cmFzdDpub25lKSwoLW1zLWhpZ2gtY29udHJhc3Q6YWN0aXZlKXsuc3dhbDItY29udGFpbmVyIC5zd2FsMi1tb2RhbHttYXJnaW46MCFpbXBvcnRhbnR9fS5zd2FsMi1jb250YWluZXIuc3dhbDItZmFkZXt0cmFuc2l0aW9uOmJhY2tncm91bmQtY29sb3IgLjFzfS5zd2FsMi1jb250YWluZXIuc3dhbDItc2hvd257YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsMCwwLC40KX0uc3dhbDItcG9wdXB7ZGlzcGxheTpub25lO3Bvc2l0aW9uOnJlbGF0aXZlO2JveC1zaXppbmc6Ym9yZGVyLWJveDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47anVzdGlmeS1jb250ZW50OmNlbnRlcjt3aWR0aDozMmVtO21heC13aWR0aDoxMDAlO3BhZGRpbmc6MS4yNWVtO2JvcmRlcjpub25lO2JvcmRlci1yYWRpdXM6LjMxMjVlbTtiYWNrZ3JvdW5kOiNmZmY7Zm9udC1mYW1pbHk6aW5oZXJpdDtmb250LXNpemU6MXJlbX0uc3dhbDItcG9wdXA6Zm9jdXN7b3V0bGluZTowfS5zd2FsMi1wb3B1cC5zd2FsMi1sb2FkaW5ne292ZXJmbG93LXk6aGlkZGVufS5zd2FsMi1oZWFkZXJ7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjthbGlnbi1pdGVtczpjZW50ZXJ9LnN3YWwyLXRpdGxle3Bvc2l0aW9uOnJlbGF0aXZlO21heC13aWR0aDoxMDAlO21hcmdpbjowIDAgLjRlbTtwYWRkaW5nOjA7Y29sb3I6IzU5NTk1OTtmb250LXNpemU6MS44NzVlbTtmb250LXdlaWdodDo2MDA7dGV4dC1hbGlnbjpjZW50ZXI7dGV4dC10cmFuc2Zvcm06bm9uZTt3b3JkLXdyYXA6YnJlYWstd29yZH0uc3dhbDItYWN0aW9uc3t6LWluZGV4OjE7ZmxleC13cmFwOndyYXA7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7d2lkdGg6MTAwJTttYXJnaW46MS4yNWVtIGF1dG8gMH0uc3dhbDItYWN0aW9uczpub3QoLnN3YWwyLWxvYWRpbmcpIC5zd2FsMi1zdHlsZWRbZGlzYWJsZWRde29wYWNpdHk6LjR9LnN3YWwyLWFjdGlvbnM6bm90KC5zd2FsMi1sb2FkaW5nKSAuc3dhbDItc3R5bGVkOmhvdmVye2JhY2tncm91bmQtaW1hZ2U6bGluZWFyLWdyYWRpZW50KHJnYmEoMCwwLDAsLjEpLHJnYmEoMCwwLDAsLjEpKX0uc3dhbDItYWN0aW9uczpub3QoLnN3YWwyLWxvYWRpbmcpIC5zd2FsMi1zdHlsZWQ6YWN0aXZle2JhY2tncm91bmQtaW1hZ2U6bGluZWFyLWdyYWRpZW50KHJnYmEoMCwwLDAsLjIpLHJnYmEoMCwwLDAsLjIpKX0uc3dhbDItYWN0aW9ucy5zd2FsMi1sb2FkaW5nIC5zd2FsMi1zdHlsZWQuc3dhbDItY29uZmlybXtib3gtc2l6aW5nOmJvcmRlci1ib3g7d2lkdGg6Mi41ZW07aGVpZ2h0OjIuNWVtO21hcmdpbjouNDY4NzVlbTtwYWRkaW5nOjA7LXdlYmtpdC1hbmltYXRpb246c3dhbDItcm90YXRlLWxvYWRpbmcgMS41cyBsaW5lYXIgMHMgaW5maW5pdGUgbm9ybWFsO2FuaW1hdGlvbjpzd2FsMi1yb3RhdGUtbG9hZGluZyAxLjVzIGxpbmVhciAwcyBpbmZpbml0ZSBub3JtYWw7Ym9yZGVyOi4yNWVtIHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1yYWRpdXM6MTAwJTtib3JkZXItY29sb3I6dHJhbnNwYXJlbnQ7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudCFpbXBvcnRhbnQ7Y29sb3I6dHJhbnNwYXJlbnQ7Y3Vyc29yOmRlZmF1bHQ7LXdlYmtpdC11c2VyLXNlbGVjdDpub25lOy1tb3otdXNlci1zZWxlY3Q6bm9uZTstbXMtdXNlci1zZWxlY3Q6bm9uZTt1c2VyLXNlbGVjdDpub25lfS5zd2FsMi1hY3Rpb25zLnN3YWwyLWxvYWRpbmcgLnN3YWwyLXN0eWxlZC5zd2FsMi1jYW5jZWx7bWFyZ2luLXJpZ2h0OjMwcHg7bWFyZ2luLWxlZnQ6MzBweH0uc3dhbDItYWN0aW9ucy5zd2FsMi1sb2FkaW5nIDpub3QoLnN3YWwyLXN0eWxlZCkuc3dhbDItY29uZmlybTo6YWZ0ZXJ7Y29udGVudDpcIlwiO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3dpZHRoOjE1cHg7aGVpZ2h0OjE1cHg7bWFyZ2luLWxlZnQ6NXB4Oy13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLXJvdGF0ZS1sb2FkaW5nIDEuNXMgbGluZWFyIDBzIGluZmluaXRlIG5vcm1hbDthbmltYXRpb246c3dhbDItcm90YXRlLWxvYWRpbmcgMS41cyBsaW5lYXIgMHMgaW5maW5pdGUgbm9ybWFsO2JvcmRlcjozcHggc29saWQgIzk5OTtib3JkZXItcmFkaXVzOjUwJTtib3JkZXItcmlnaHQtY29sb3I6dHJhbnNwYXJlbnQ7Ym94LXNoYWRvdzoxcHggMXB4IDFweCAjZmZmfS5zd2FsMi1zdHlsZWR7bWFyZ2luOi4zMTI1ZW07cGFkZGluZzouNjI1ZW0gMmVtO2JveC1zaGFkb3c6bm9uZTtmb250LXdlaWdodDo1MDB9LnN3YWwyLXN0eWxlZDpub3QoW2Rpc2FibGVkXSl7Y3Vyc29yOnBvaW50ZXJ9LnN3YWwyLXN0eWxlZC5zd2FsMi1jb25maXJte2JvcmRlcjowO2JvcmRlci1yYWRpdXM6LjI1ZW07YmFja2dyb3VuZDppbml0aWFsO2JhY2tncm91bmQtY29sb3I6IzMwODVkNjtjb2xvcjojZmZmO2ZvbnQtc2l6ZToxLjA2MjVlbX0uc3dhbDItc3R5bGVkLnN3YWwyLWNhbmNlbHtib3JkZXI6MDtib3JkZXItcmFkaXVzOi4yNWVtO2JhY2tncm91bmQ6aW5pdGlhbDtiYWNrZ3JvdW5kLWNvbG9yOiNhYWE7Y29sb3I6I2ZmZjtmb250LXNpemU6MS4wNjI1ZW19LnN3YWwyLXN0eWxlZDpmb2N1c3tvdXRsaW5lOjA7Ym94LXNoYWRvdzowIDAgMCAycHggI2ZmZiwwIDAgMCA0cHggcmdiYSg1MCwxMDAsMTUwLC40KX0uc3dhbDItc3R5bGVkOjotbW96LWZvY3VzLWlubmVye2JvcmRlcjowfS5zd2FsMi1mb290ZXJ7anVzdGlmeS1jb250ZW50OmNlbnRlcjttYXJnaW46MS4yNWVtIDAgMDtwYWRkaW5nOjFlbSAwIDA7Ym9yZGVyLXRvcDoxcHggc29saWQgI2VlZTtjb2xvcjojNTQ1NDU0O2ZvbnQtc2l6ZToxZW19LnN3YWwyLWltYWdle21heC13aWR0aDoxMDAlO21hcmdpbjoxLjI1ZW0gYXV0b30uc3dhbDItY2xvc2V7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDoyO3RvcDowO3JpZ2h0OjA7anVzdGlmeS1jb250ZW50OmNlbnRlcjt3aWR0aDoxLjJlbTtoZWlnaHQ6MS4yZW07cGFkZGluZzowO292ZXJmbG93OmhpZGRlbjt0cmFuc2l0aW9uOmNvbG9yIC4xcyBlYXNlLW91dDtib3JkZXI6bm9uZTtib3JkZXItcmFkaXVzOjA7b3V0bGluZTppbml0aWFsO2JhY2tncm91bmQ6MCAwO2NvbG9yOiNjY2M7Zm9udC1mYW1pbHk6c2VyaWY7Zm9udC1zaXplOjIuNWVtO2xpbmUtaGVpZ2h0OjEuMjtjdXJzb3I6cG9pbnRlcn0uc3dhbDItY2xvc2U6aG92ZXJ7dHJhbnNmb3JtOm5vbmU7YmFja2dyb3VuZDowIDA7Y29sb3I6I2YyNzQ3NH0uc3dhbDItY29udGVudHt6LWluZGV4OjE7anVzdGlmeS1jb250ZW50OmNlbnRlcjttYXJnaW46MDtwYWRkaW5nOjA7Y29sb3I6IzU0NTQ1NDtmb250LXNpemU6MS4xMjVlbTtmb250LXdlaWdodDozMDA7bGluZS1oZWlnaHQ6bm9ybWFsO3RleHQtYWxpZ246Y2VudGVyO3dvcmQtd3JhcDpicmVhay13b3JkfS5zd2FsMi1jaGVja2JveCwuc3dhbDItZmlsZSwuc3dhbDItaW5wdXQsLnN3YWwyLXJhZGlvLC5zd2FsMi1zZWxlY3QsLnN3YWwyLXRleHRhcmVhe21hcmdpbjoxZW0gYXV0b30uc3dhbDItZmlsZSwuc3dhbDItaW5wdXQsLnN3YWwyLXRleHRhcmVhe2JveC1zaXppbmc6Ym9yZGVyLWJveDt3aWR0aDoxMDAlO3RyYW5zaXRpb246Ym9yZGVyLWNvbG9yIC4zcyxib3gtc2hhZG93IC4zcztib3JkZXI6MXB4IHNvbGlkICNkOWQ5ZDk7Ym9yZGVyLXJhZGl1czouMTg3NWVtO2JhY2tncm91bmQ6aW5oZXJpdDtib3gtc2hhZG93Omluc2V0IDAgMXB4IDFweCByZ2JhKDAsMCwwLC4wNik7Y29sb3I6aW5oZXJpdDtmb250LXNpemU6MS4xMjVlbX0uc3dhbDItZmlsZS5zd2FsMi1pbnB1dGVycm9yLC5zd2FsMi1pbnB1dC5zd2FsMi1pbnB1dGVycm9yLC5zd2FsMi10ZXh0YXJlYS5zd2FsMi1pbnB1dGVycm9ye2JvcmRlci1jb2xvcjojZjI3NDc0IWltcG9ydGFudDtib3gtc2hhZG93OjAgMCAycHggI2YyNzQ3NCFpbXBvcnRhbnR9LnN3YWwyLWZpbGU6Zm9jdXMsLnN3YWwyLWlucHV0OmZvY3VzLC5zd2FsMi10ZXh0YXJlYTpmb2N1c3tib3JkZXI6MXB4IHNvbGlkICNiNGRiZWQ7b3V0bGluZTowO2JveC1zaGFkb3c6MCAwIDNweCAjYzRlNmY1fS5zd2FsMi1maWxlOjotd2Via2l0LWlucHV0LXBsYWNlaG9sZGVyLC5zd2FsMi1pbnB1dDo6LXdlYmtpdC1pbnB1dC1wbGFjZWhvbGRlciwuc3dhbDItdGV4dGFyZWE6Oi13ZWJraXQtaW5wdXQtcGxhY2Vob2xkZXJ7Y29sb3I6I2NjY30uc3dhbDItZmlsZTo6LW1vei1wbGFjZWhvbGRlciwuc3dhbDItaW5wdXQ6Oi1tb3otcGxhY2Vob2xkZXIsLnN3YWwyLXRleHRhcmVhOjotbW96LXBsYWNlaG9sZGVye2NvbG9yOiNjY2N9LnN3YWwyLWZpbGU6LW1zLWlucHV0LXBsYWNlaG9sZGVyLC5zd2FsMi1pbnB1dDotbXMtaW5wdXQtcGxhY2Vob2xkZXIsLnN3YWwyLXRleHRhcmVhOi1tcy1pbnB1dC1wbGFjZWhvbGRlcntjb2xvcjojY2NjfS5zd2FsMi1maWxlOjotbXMtaW5wdXQtcGxhY2Vob2xkZXIsLnN3YWwyLWlucHV0OjotbXMtaW5wdXQtcGxhY2Vob2xkZXIsLnN3YWwyLXRleHRhcmVhOjotbXMtaW5wdXQtcGxhY2Vob2xkZXJ7Y29sb3I6I2NjY30uc3dhbDItZmlsZTo6cGxhY2Vob2xkZXIsLnN3YWwyLWlucHV0OjpwbGFjZWhvbGRlciwuc3dhbDItdGV4dGFyZWE6OnBsYWNlaG9sZGVye2NvbG9yOiNjY2N9LnN3YWwyLXJhbmdle21hcmdpbjoxZW0gYXV0bztiYWNrZ3JvdW5kOmluaGVyaXR9LnN3YWwyLXJhbmdlIGlucHV0e3dpZHRoOjgwJX0uc3dhbDItcmFuZ2Ugb3V0cHV0e3dpZHRoOjIwJTtjb2xvcjppbmhlcml0O2ZvbnQtd2VpZ2h0OjYwMDt0ZXh0LWFsaWduOmNlbnRlcn0uc3dhbDItcmFuZ2UgaW5wdXQsLnN3YWwyLXJhbmdlIG91dHB1dHtoZWlnaHQ6Mi42MjVlbTtwYWRkaW5nOjA7Zm9udC1zaXplOjEuMTI1ZW07bGluZS1oZWlnaHQ6Mi42MjVlbX0uc3dhbDItaW5wdXR7aGVpZ2h0OjIuNjI1ZW07cGFkZGluZzowIC43NWVtfS5zd2FsMi1pbnB1dFt0eXBlPW51bWJlcl17bWF4LXdpZHRoOjEwZW19LnN3YWwyLWZpbGV7YmFja2dyb3VuZDppbmhlcml0O2ZvbnQtc2l6ZToxLjEyNWVtfS5zd2FsMi10ZXh0YXJlYXtoZWlnaHQ6Ni43NWVtO3BhZGRpbmc6Ljc1ZW19LnN3YWwyLXNlbGVjdHttaW4td2lkdGg6NTAlO21heC13aWR0aDoxMDAlO3BhZGRpbmc6LjM3NWVtIC42MjVlbTtiYWNrZ3JvdW5kOmluaGVyaXQ7Y29sb3I6aW5oZXJpdDtmb250LXNpemU6MS4xMjVlbX0uc3dhbDItY2hlY2tib3gsLnN3YWwyLXJhZGlve2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2JhY2tncm91bmQ6aW5oZXJpdDtjb2xvcjppbmhlcml0fS5zd2FsMi1jaGVja2JveCBsYWJlbCwuc3dhbDItcmFkaW8gbGFiZWx7bWFyZ2luOjAgLjZlbTtmb250LXNpemU6MS4xMjVlbX0uc3dhbDItY2hlY2tib3ggaW5wdXQsLnN3YWwyLXJhZGlvIGlucHV0e21hcmdpbjowIC40ZW19LnN3YWwyLXZhbGlkYXRpb24tbWVzc2FnZXtkaXNwbGF5Om5vbmU7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7cGFkZGluZzouNjI1ZW07b3ZlcmZsb3c6aGlkZGVuO2JhY2tncm91bmQ6I2YwZjBmMDtjb2xvcjojNjY2O2ZvbnQtc2l6ZToxZW07Zm9udC13ZWlnaHQ6MzAwfS5zd2FsMi12YWxpZGF0aW9uLW1lc3NhZ2U6OmJlZm9yZXtjb250ZW50OlwiIVwiO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3dpZHRoOjEuNWVtO21pbi13aWR0aDoxLjVlbTtoZWlnaHQ6MS41ZW07bWFyZ2luOjAgLjYyNWVtO3pvb206bm9ybWFsO2JvcmRlci1yYWRpdXM6NTAlO2JhY2tncm91bmQtY29sb3I6I2YyNzQ3NDtjb2xvcjojZmZmO2ZvbnQtd2VpZ2h0OjYwMDtsaW5lLWhlaWdodDoxLjVlbTt0ZXh0LWFsaWduOmNlbnRlcn1Ac3VwcG9ydHMgKC1tcy1hY2NlbGVyYXRvcjp0cnVlKXsuc3dhbDItcmFuZ2UgaW5wdXR7d2lkdGg6MTAwJSFpbXBvcnRhbnR9LnN3YWwyLXJhbmdlIG91dHB1dHtkaXNwbGF5Om5vbmV9fUBtZWRpYSBhbGwgYW5kICgtbXMtaGlnaC1jb250cmFzdDpub25lKSwoLW1zLWhpZ2gtY29udHJhc3Q6YWN0aXZlKXsuc3dhbDItcmFuZ2UgaW5wdXR7d2lkdGg6MTAwJSFpbXBvcnRhbnR9LnN3YWwyLXJhbmdlIG91dHB1dHtkaXNwbGF5Om5vbmV9fUAtbW96LWRvY3VtZW50IHVybC1wcmVmaXgoKXsuc3dhbDItY2xvc2U6Zm9jdXN7b3V0bGluZToycHggc29saWQgcmdiYSg1MCwxMDAsMTUwLC40KX19LnN3YWwyLWljb257cG9zaXRpb246cmVsYXRpdmU7Ym94LXNpemluZzpjb250ZW50LWJveDtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3dpZHRoOjVlbTtoZWlnaHQ6NWVtO21hcmdpbjoxLjI1ZW0gYXV0byAxLjg3NWVtO3pvb206bm9ybWFsO2JvcmRlcjouMjVlbSBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItcmFkaXVzOjUwJTtmb250LWZhbWlseTppbmhlcml0O2xpbmUtaGVpZ2h0OjVlbTtjdXJzb3I6ZGVmYXVsdDstd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7LW1vei11c2VyLXNlbGVjdDpub25lOy1tcy11c2VyLXNlbGVjdDpub25lO3VzZXItc2VsZWN0Om5vbmV9LnN3YWwyLWljb246OmJlZm9yZXtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2hlaWdodDo5MiU7Zm9udC1zaXplOjMuNzVlbX0uc3dhbDItaWNvbi5zd2FsMi1lcnJvcntib3JkZXItY29sb3I6I2YyNzQ3NH0uc3dhbDItaWNvbi5zd2FsMi1lcnJvciAuc3dhbDIteC1tYXJre3Bvc2l0aW9uOnJlbGF0aXZlO2ZsZXgtZ3JvdzoxfS5zd2FsMi1pY29uLnN3YWwyLWVycm9yIFtjbGFzc149c3dhbDIteC1tYXJrLWxpbmVde2Rpc3BsYXk6YmxvY2s7cG9zaXRpb246YWJzb2x1dGU7dG9wOjIuMzEyNWVtO3dpZHRoOjIuOTM3NWVtO2hlaWdodDouMzEyNWVtO2JvcmRlci1yYWRpdXM6LjEyNWVtO2JhY2tncm91bmQtY29sb3I6I2YyNzQ3NH0uc3dhbDItaWNvbi5zd2FsMi1lcnJvciBbY2xhc3NePXN3YWwyLXgtbWFyay1saW5lXVtjbGFzcyQ9bGVmdF17bGVmdDoxLjA2MjVlbTt0cmFuc2Zvcm06cm90YXRlKDQ1ZGVnKX0uc3dhbDItaWNvbi5zd2FsMi1lcnJvciBbY2xhc3NePXN3YWwyLXgtbWFyay1saW5lXVtjbGFzcyQ9cmlnaHRde3JpZ2h0OjFlbTt0cmFuc2Zvcm06cm90YXRlKC00NWRlZyl9LnN3YWwyLWljb24uc3dhbDItd2FybmluZ3tib3JkZXItY29sb3I6I2ZhY2VhODtjb2xvcjojZjhiYjg2fS5zd2FsMi1pY29uLnN3YWwyLXdhcm5pbmc6OmJlZm9yZXtjb250ZW50OlwiIVwifS5zd2FsMi1pY29uLnN3YWwyLWluZm97Ym9yZGVyLWNvbG9yOiM5ZGUwZjY7Y29sb3I6IzNmYzNlZX0uc3dhbDItaWNvbi5zd2FsMi1pbmZvOjpiZWZvcmV7Y29udGVudDpcImlcIn0uc3dhbDItaWNvbi5zd2FsMi1xdWVzdGlvbntib3JkZXItY29sb3I6I2M5ZGFlMTtjb2xvcjojODdhZGJkfS5zd2FsMi1pY29uLnN3YWwyLXF1ZXN0aW9uOjpiZWZvcmV7Y29udGVudDpcIj9cIn0uc3dhbDItaWNvbi5zd2FsMi1xdWVzdGlvbi5zd2FsMi1hcmFiaWMtcXVlc3Rpb24tbWFyazo6YmVmb3Jle2NvbnRlbnQ6XCLYn1wifS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3N7Ym9yZGVyLWNvbG9yOiNhNWRjODZ9LnN3YWwyLWljb24uc3dhbDItc3VjY2VzcyBbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtY2lyY3VsYXItbGluZV17cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6My43NWVtO2hlaWdodDo3LjVlbTt0cmFuc2Zvcm06cm90YXRlKDQ1ZGVnKTtib3JkZXItcmFkaXVzOjUwJX0uc3dhbDItaWNvbi5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lXVtjbGFzcyQ9bGVmdF17dG9wOi0uNDM3NWVtO2xlZnQ6LTIuMDYzNWVtO3RyYW5zZm9ybTpyb3RhdGUoLTQ1ZGVnKTt0cmFuc2Zvcm0tb3JpZ2luOjMuNzVlbSAzLjc1ZW07Ym9yZGVyLXJhZGl1czo3LjVlbSAwIDAgNy41ZW19LnN3YWwyLWljb24uc3dhbDItc3VjY2VzcyBbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtY2lyY3VsYXItbGluZV1bY2xhc3MkPXJpZ2h0XXt0b3A6LS42ODc1ZW07bGVmdDoxLjg3NWVtO3RyYW5zZm9ybTpyb3RhdGUoLTQ1ZGVnKTt0cmFuc2Zvcm0tb3JpZ2luOjAgMy43NWVtO2JvcmRlci1yYWRpdXM6MCA3LjVlbSA3LjVlbSAwfS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3MgLnN3YWwyLXN1Y2Nlc3MtcmluZ3twb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OjI7dG9wOi0uMjVlbTtsZWZ0Oi0uMjVlbTtib3gtc2l6aW5nOmNvbnRlbnQtYm94O3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7Ym9yZGVyOi4yNWVtIHNvbGlkIHJnYmEoMTY1LDIyMCwxMzQsLjMpO2JvcmRlci1yYWRpdXM6NTAlfS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3MgLnN3YWwyLXN1Y2Nlc3MtZml4e3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6MTt0b3A6LjVlbTtsZWZ0OjEuNjI1ZW07d2lkdGg6LjQzNzVlbTtoZWlnaHQ6NS42MjVlbTt0cmFuc2Zvcm06cm90YXRlKC00NWRlZyl9LnN3YWwyLWljb24uc3dhbDItc3VjY2VzcyBbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtbGluZV17ZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OjI7aGVpZ2h0Oi4zMTI1ZW07Ym9yZGVyLXJhZGl1czouMTI1ZW07YmFja2dyb3VuZC1jb2xvcjojYTVkYzg2fS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3MgW2NsYXNzXj1zd2FsMi1zdWNjZXNzLWxpbmVdW2NsYXNzJD10aXBde3RvcDoyLjg3NWVtO2xlZnQ6Ljg3NWVtO3dpZHRoOjEuNTYyNWVtO3RyYW5zZm9ybTpyb3RhdGUoNDVkZWcpfS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3MgW2NsYXNzXj1zd2FsMi1zdWNjZXNzLWxpbmVdW2NsYXNzJD1sb25nXXt0b3A6Mi4zNzVlbTtyaWdodDouNWVtO3dpZHRoOjIuOTM3NWVtO3RyYW5zZm9ybTpyb3RhdGUoLTQ1ZGVnKX0uc3dhbDItcHJvZ3Jlc3Mtc3RlcHN7YWxpZ24taXRlbXM6Y2VudGVyO21hcmdpbjowIDAgMS4yNWVtO3BhZGRpbmc6MDtiYWNrZ3JvdW5kOmluaGVyaXQ7Zm9udC13ZWlnaHQ6NjAwfS5zd2FsMi1wcm9ncmVzcy1zdGVwcyBsaXtkaXNwbGF5OmlubGluZS1ibG9jaztwb3NpdGlvbjpyZWxhdGl2ZX0uc3dhbDItcHJvZ3Jlc3Mtc3RlcHMgLnN3YWwyLXByb2dyZXNzLXN0ZXB7ei1pbmRleDoyMDt3aWR0aDoyZW07aGVpZ2h0OjJlbTtib3JkZXItcmFkaXVzOjJlbTtiYWNrZ3JvdW5kOiMzMDg1ZDY7Y29sb3I6I2ZmZjtsaW5lLWhlaWdodDoyZW07dGV4dC1hbGlnbjpjZW50ZXJ9LnN3YWwyLXByb2dyZXNzLXN0ZXBzIC5zd2FsMi1wcm9ncmVzcy1zdGVwLnN3YWwyLWFjdGl2ZS1wcm9ncmVzcy1zdGVwe2JhY2tncm91bmQ6IzMwODVkNn0uc3dhbDItcHJvZ3Jlc3Mtc3RlcHMgLnN3YWwyLXByb2dyZXNzLXN0ZXAuc3dhbDItYWN0aXZlLXByb2dyZXNzLXN0ZXB+LnN3YWwyLXByb2dyZXNzLXN0ZXB7YmFja2dyb3VuZDojYWRkOGU2O2NvbG9yOiNmZmZ9LnN3YWwyLXByb2dyZXNzLXN0ZXBzIC5zd2FsMi1wcm9ncmVzcy1zdGVwLnN3YWwyLWFjdGl2ZS1wcm9ncmVzcy1zdGVwfi5zd2FsMi1wcm9ncmVzcy1zdGVwLWxpbmV7YmFja2dyb3VuZDojYWRkOGU2fS5zd2FsMi1wcm9ncmVzcy1zdGVwcyAuc3dhbDItcHJvZ3Jlc3Mtc3RlcC1saW5le3otaW5kZXg6MTA7d2lkdGg6Mi41ZW07aGVpZ2h0Oi40ZW07bWFyZ2luOjAgLTFweDtiYWNrZ3JvdW5kOiMzMDg1ZDZ9W2NsYXNzXj1zd2FsMl17LXdlYmtpdC10YXAtaGlnaGxpZ2h0LWNvbG9yOnRyYW5zcGFyZW50fS5zd2FsMi1zaG93ey13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLXNob3cgLjNzO2FuaW1hdGlvbjpzd2FsMi1zaG93IC4zc30uc3dhbDItc2hvdy5zd2FsMi1ub2FuaW1hdGlvbnstd2Via2l0LWFuaW1hdGlvbjpub25lO2FuaW1hdGlvbjpub25lfS5zd2FsMi1oaWRley13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLWhpZGUgLjE1cyBmb3J3YXJkczthbmltYXRpb246c3dhbDItaGlkZSAuMTVzIGZvcndhcmRzfS5zd2FsMi1oaWRlLnN3YWwyLW5vYW5pbWF0aW9uey13ZWJraXQtYW5pbWF0aW9uOm5vbmU7YW5pbWF0aW9uOm5vbmV9LnN3YWwyLXJ0bCAuc3dhbDItY2xvc2V7cmlnaHQ6YXV0bztsZWZ0OjB9LnN3YWwyLWFuaW1hdGUtc3VjY2Vzcy1pY29uIC5zd2FsMi1zdWNjZXNzLWxpbmUtdGlwey13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLWFuaW1hdGUtc3VjY2Vzcy1saW5lLXRpcCAuNzVzO2FuaW1hdGlvbjpzd2FsMi1hbmltYXRlLXN1Y2Nlc3MtbGluZS10aXAgLjc1c30uc3dhbDItYW5pbWF0ZS1zdWNjZXNzLWljb24gLnN3YWwyLXN1Y2Nlc3MtbGluZS1sb25ney13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmcgLjc1czthbmltYXRpb246c3dhbDItYW5pbWF0ZS1zdWNjZXNzLWxpbmUtbG9uZyAuNzVzfS5zd2FsMi1hbmltYXRlLXN1Y2Nlc3MtaWNvbiAuc3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lLXJpZ2h0ey13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLXJvdGF0ZS1zdWNjZXNzLWNpcmN1bGFyLWxpbmUgNC4yNXMgZWFzZS1pbjthbmltYXRpb246c3dhbDItcm90YXRlLXN1Y2Nlc3MtY2lyY3VsYXItbGluZSA0LjI1cyBlYXNlLWlufS5zd2FsMi1hbmltYXRlLWVycm9yLWljb257LXdlYmtpdC1hbmltYXRpb246c3dhbDItYW5pbWF0ZS1lcnJvci1pY29uIC41czthbmltYXRpb246c3dhbDItYW5pbWF0ZS1lcnJvci1pY29uIC41c30uc3dhbDItYW5pbWF0ZS1lcnJvci1pY29uIC5zd2FsMi14LW1hcmt7LXdlYmtpdC1hbmltYXRpb246c3dhbDItYW5pbWF0ZS1lcnJvci14LW1hcmsgLjVzO2FuaW1hdGlvbjpzd2FsMi1hbmltYXRlLWVycm9yLXgtbWFyayAuNXN9QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXJvdGF0ZS1sb2FkaW5nezAle3RyYW5zZm9ybTpyb3RhdGUoMCl9MTAwJXt0cmFuc2Zvcm06cm90YXRlKDM2MGRlZyl9fUBrZXlmcmFtZXMgc3dhbDItcm90YXRlLWxvYWRpbmd7MCV7dHJhbnNmb3JtOnJvdGF0ZSgwKX0xMDAle3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKX19QG1lZGlhIHByaW50e2JvZHkuc3dhbDItc2hvd246bm90KC5zd2FsMi1uby1iYWNrZHJvcCk6bm90KC5zd2FsMi10b2FzdC1zaG93bil7b3ZlcmZsb3cteTpzY3JvbGwhaW1wb3J0YW50fWJvZHkuc3dhbDItc2hvd246bm90KC5zd2FsMi1uby1iYWNrZHJvcCk6bm90KC5zd2FsMi10b2FzdC1zaG93bik+W2FyaWEtaGlkZGVuPXRydWVde2Rpc3BsYXk6bm9uZX1ib2R5LnN3YWwyLXNob3duOm5vdCguc3dhbDItbm8tYmFja2Ryb3ApOm5vdCguc3dhbDItdG9hc3Qtc2hvd24pIC5zd2FsMi1jb250YWluZXJ7cG9zaXRpb246c3RhdGljIWltcG9ydGFudH19Iik7",
        "bGV0IHJlY29tbWVuZGF0aW9uRGlhbG9nID0gew0KDQogICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsDQogICAgc2hvd0RpYWxvZ0ZvclJlY29tbWVuZGF0aW9uOmZ1bmN0aW9uKHJlY29tbWVuZGF0aW9uKXsNCg0KICAgICAgICByZWNvbW1lbmRhdGlvbkRpYWxvZy5yZWNvbW1lbmRhdGlvbiA9IHJlY29tbWVuZGF0aW9uOw0KDQoNCiAgICAgICAgcmVjb21tZW5kYXRpb25EaWFsb2cuaGlkZURpYWxvZygpOw0KDQogICAgICAgIGxldCBmdW5jdGlvbkRlc2NyaXB0aW9uc0hUTUwgPSB0aGlzLmNyZWF0RnVuY3Rpb25EZXNjcmlwdGlvbkhUTUwocmVjb21tZW5kYXRpb24uZnVuY3Rpb25zKTsNCg0KICAgICAgICBsZXQgZGlhbG9nSFRNTCA9ICAnPGRpdiBjbGFzcz0ibW9kYWwgbWljcm9tb2RhbC1zbGlkZSIgaWQ9ImVyLXJlY29tbWVuZGF0aW9uLTEiIGFyaWEtaGlkZGVuPSJ0cnVlIj5cbicgKw0KICAgICAgICAgICAgJyAgICA8ZGl2IGNsYXNzPSJtb2RhbF9fb3ZlcmxheSIgdGFiaW5kZXg9Ii0xIiBkYXRhLW1pY3JvbW9kYWwtY2xvc2U+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsX19jb250YWluZXIiIHJvbGU9ImRpYWxvZyIgYXJpYS1tb2RhbD0idHJ1ZSIgYXJpYS1sYWJlbGxlZGJ5PSJlci1yZWNvbW1lbmRhdGlvbi0xLXRpdGxlIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgIDxoZWFkZXIgY2xhc3M9Im1vZGFsX19oZWFkZXIiPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgIDxoMiBjbGFzcz0ibW9kYWxfX3RpdGxlIiBpZD0iZXItcmVjb21tZW5kYXRpb24tMS10aXRsZSI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICcrcmVjb21tZW5kYXRpb24udGl0bGUrDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgIDwvaDI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibW9kYWxfX2Nsb3NlIiBhcmlhLWxhYmVsPSJDbG9zZSIgZGF0YS1taWNyb21vZGFsLWNsb3NlPjwvYnV0dG9uPicrDQogICAgICAgICAgICAnICAgICAgICAgICAgPC9oZWFkZXI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICA8bWFpbiBjbGFzcz0ibW9kYWxfX2NvbnRlbnQiIGlkPSJlci1yZWNvbW1lbmRhdGlvbi0xLWNvbnRlbnQiPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgPGRpdj48c3Ryb25nIGNsYXNzPSJyZWNvbW1lbmRhdGlvbl9kZXNjcmlwdGlvbiI+JytyZWNvbW1lbmRhdGlvbi5kZXNjcmlwdGlvbisnPC9zdHJvbmc+PC9kaXY+JyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmVjb21tZW5kYXRpb25fb3V0ZXIiPicrDQogICAgICAgICAgICBmdW5jdGlvbkRlc2NyaXB0aW9uc0hUTUwrDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgPC9kaXY+JyArDQogICAgICAgICAgICAnICAgICAgICAgICA8L21haW4+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICA8Zm9vdGVyIGNsYXNzPSJtb2RhbF9fZm9vdGVyIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJlclJlY29tbWVuZGF0aW9uRGlhbG9nWWVzIiBjbGFzcz0ibW9kYWxfX2J0biBtb2RhbF9fYnRuLXByaW1hcnkgcmVjb21tZW5kYXRpb25feWVzIiBkYXRhLW1pY3JvbW9kYWwtY2xvc2UgPicrcmVjb21tZW5kYXRpb24ueWVzKyc8L2J1dHRvbj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJlclJlY29tbWVuZGF0aW9uRGlhbG9nTm8iIGNsYXNzPSJtb2RhbF9fYnRuIHJlY29tbWVuZGF0aW9uX25vIj4nK3JlY29tbWVuZGF0aW9uLm5vKyc8L2J1dHRvbj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgIDwvZm9vdGVyPlxuJyArDQogICAgICAgICAgICAnICAgICAgICA8L2Rpdj5cbicgKw0KICAgICAgICAgICAgJyAgICA8L2Rpdj5cbicgKw0KICAgICAgICAgICAgJzwvZGl2Pic7DQoNCg0KICAgICAgICAkKCJib2R5IikuYXBwZW5kKGRpYWxvZ0hUTUwpOw0KDQogICAgICAgIE1pY3JvTW9kYWwuc2hvdygnZXItcmVjb21tZW5kYXRpb24tMScpOw0KDQogICAgICAgIHJlY29tbWVuZGF0aW9uRGlhbG9nLmRpYWxvZ1Zpc2libGUgPSB0cnVlOw0KDQoNCiAgICAgICAgJCgiI2VyUmVjb21tZW5kYXRpb25EaWFsb2dZZXMiKS5jbGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZWNvbW1lbmRhdGlvbkRpYWxvZy5yZWNvbW1lbmRhdGlvbi5yZXN1bHQgPSB0cnVlOw0KICAgICAgICAgICAgY29udGVudFNjcmlwdENvbnRyb2xsZXIuc2VuZE1lc3NhZ2VUb0JhY2tncm91bmRTY3JpcHQoew0KICAgICAgICAgICAgICAgIHR5cGU6ICJyZWNvbW1lbmRhdGlvblJlc3VsdCIsDQogICAgICAgICAgICAgICAgZGF0YTogcmVjb21tZW5kYXRpb25EaWFsb2cucmVjb21tZW5kYXRpb24sDQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgcmVjb21tZW5kYXRpb25EaWFsb2cuaGlkZURpYWxvZygpOw0KICAgICAgICB9KTsNCg0KICAgICAgICAkKCIjZXJSZWNvbW1lbmRhdGlvbkRpYWxvZ05vIikuY2xpY2soZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgcmVjb21tZW5kYXRpb25EaWFsb2cucmVjb21tZW5kYXRpb24ucmVzdWx0ID0gZmFsc2U7DQogICAgICAgICAgICBjb250ZW50U2NyaXB0Q29udHJvbGxlci5zZW5kTWVzc2FnZVRvQmFja2dyb3VuZFNjcmlwdCh7DQogICAgICAgICAgICAgICAgdHlwZTogInJlY29tbWVuZGF0aW9uUmVzdWx0IiwNCiAgICAgICAgICAgICAgICBkYXRhOiByZWNvbW1lbmRhdGlvbkRpYWxvZy5yZWNvbW1lbmRhdGlvbiwNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgcmVjb21tZW5kYXRpb25EaWFsb2cuaGlkZURpYWxvZygpOw0KICAgICAgICB9KTsNCg0KICAgIH0sDQoNCiAgICBoaWRlRGlhbG9nOiBmdW5jdGlvbiAoKSB7DQoNCiAgICAgICAgaWYocmVjb21tZW5kYXRpb25EaWFsb2cuZGlhbG9nVmlzaWJsZSl7DQogICAgICAgICAgICBNaWNyb01vZGFsLmNsb3NlKCdlci1yZWNvbW1lbmRhdGlvbi0xJyk7DQogICAgICAgICAgICAkKCIjZXItcmVjb21tZW5kYXRpb24tMSIpLnJlbW92ZSgpOw0KICAgICAgICAgICAgcmVjb21tZW5kYXRpb25EaWFsb2cuZGlhbG9nVmlzaWJsZSA9IGZhbHNlOw0KICAgICAgICB9DQoNCg0KICAgIH0sDQoNCiAgICBjcmVhdEZ1bmN0aW9uRGVzY3JpcHRpb25IVE1MOmZ1bmN0aW9uIChmdW5jdGlvbnMpIHsNCg0KICAgICAgICBsZXQgaHRtbCA9ICAiPGRpdiBjbGFzcz0ncmVjb21tZW5kYXRpb25fZnVuY3Rpb25zX2NvbnRhaW5lcic+IjsNCg0KICAgICAgICBmb3IobGV0IGk9MDsgaSA8IGZ1bmN0aW9ucy5sZW5ndGg7IGkrKyl7DQoNCiAgICAgICAgICAgIGh0bWwrPSAgICI8ZGl2IGNsYXNzPSdyZWNvbW1lbmRhdGlvbl9mdW5jdGlvbl9jb250YWluZXInPiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgIjxoMz4iK2Z1bmN0aW9uc1tpXS50cmFuc3RsYXRlZFRpdGxlKyI8L2gzPiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgIjxkaXYgY2xhc3M9J3JlY29tbWVuZGF0aW9uX2ltYWdlJz48aW1nIHNyYz0nIitmdW5jdGlvbnNbaV0uZGVmYXVsdEljb25VUkwrIicgYWx0PScnPjwvZGl2PiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgIjxkaXY+IitmdW5jdGlvbnNbaV0udHJhbnNsYXRlZERlc2NyaXB0aW9uKyI8L2Rpdj4iICsNCiAgICAgICAgICAgICAgICAgICAgICI8L2Rpdj4iOw0KDQogICAgICAgIH0NCg0KICAgICAgICBodG1sKz0iPC9kaXY+IjsNCg0KICAgICAgICByZXR1cm4gaHRtbDsNCg0KICAgIH0NCn07",
        "dmFyIGFsZXJ0TWFuYWdlciA9IHsNCg0KICAgIGFsZXJ0V2FzQ2xvc2VkOiBmYWxzZSwNCiAgICBhbGVydElzT3BlbjogZmFsc2UsDQoNCiAgICBzdXBwcmVzc0NsaWNrOmZ1bmN0aW9uICgpIHsNCg0KICAgICAgICBpZihhbGVydE1hbmFnZXIuYWxlcnRJc09wZW4pew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICBpZihhbGVydE1hbmFnZXIuYWxlcnRXYXNDbG9zZWQpew0KICAgICAgICAgICAgYWxlcnRNYW5hZ2VyLmFsZXJ0V2FzQ2xvc2VkID0gZmFsc2U7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfSwNCg0KICAgIHNob3dFcnJvckFsZXJ0OiBmdW5jdGlvbiAodGl0bGUsZGVzY3JpcHRpb24pIHsNCiAgICAgICAgYWxlcnRNYW5hZ2VyLmFsZXJ0SXNPcGVuID0gdHJ1ZTsNCiAgICAgICAgU3dhbC5maXJlKHsNCiAgICAgICAgICAgIHRpdGxlOiB0aXRsZSwNCiAgICAgICAgICAgIHRleHQ6IGRlc2NyaXB0aW9uLA0KICAgICAgICAgICAgdHlwZTogJ2Vycm9yJywNCiAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnT2snLA0KICAgICAgICAgICAgd2lkdGg6IDI1MCwNCiAgICAgICAgICAgIHBhZGRpbmc6ICcxZW0nLA0KICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHsNCiAgICAgICAgICAgIGFsZXJ0TWFuYWdlci5hbGVydFdhc0Nsb3NlZCA9IHRydWU7DQogICAgICAgICAgICBhbGVydE1hbmFnZXIuYWxlcnRJc09wZW4gPSBmYWxzZTsNCiAgICAgICAgfSk7DQogICAgfSwNCg0KICAgIHNob3dJbmZvQWxlcnQ6IGZ1bmN0aW9uICh0aXRsZSxkZXNjcmlwdGlvbikgew0KICAgICAgICBhbGVydE1hbmFnZXIuYWxlcnRJc09wZW4gPSB0cnVlOw0KICAgICAgICBTd2FsLmZpcmUoew0KICAgICAgICAgICAgdGl0bGU6IHRpdGxlLA0KICAgICAgICAgICAgdGV4dDogZGVzY3JpcHRpb24sDQogICAgICAgICAgICB0eXBlOiAnaW5mbycsDQogICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ09rJywNCiAgICAgICAgICAgIHdpZHRoOiAyNTAsDQogICAgICAgICAgICBwYWRkaW5nOiAnMWVtJywNCiAgICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7DQogICAgICAgICAgICBhbGVydE1hbmFnZXIuYWxlcnRJc09wZW4gPSB0cnVlOw0KICAgICAgICAgICAgYWxlcnRNYW5hZ2VyLmFsZXJ0SXNPcGVuID0gZmFsc2U7DQogICAgICAgIH0pOw0KICAgIH0NCg0KDQp9Ow==",
        "Ly9GUk9NOiBodHRwczovL2dpdGh1Yi5jb20vVGVzc21vcmUvc2JkCi8vIFNlbnRlbmNlIEJvdW5kYXJ5IERldGVjdGlvbiAoU0JEKQoKKGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuZXJfdG9rZW5pemVyID0gZigpfX0pKGZ1bmN0aW9uKCl7dmFyIGRlZmluZSxtb2R1bGUsZXhwb3J0cztyZXR1cm4gKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc31yZXR1cm4gZX0pKCkoezE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewp2YXIgYWJicmV2aWF0aW9uczsKdmFyIGVuZ2xpc2hBYmJyZXZpYXRpb25zID0gWwogICAgImFsIiwKICAgICJhZGoiLAogICAgImFzc24iLAogICAgIkF2ZSIsCiAgICAiQlNjIiwgIk1TYyIsCiAgICAiQ2VsbCIsCiAgICAiQ2giLAogICAgIkNvIiwKICAgICJjYyIsCiAgICAiQ29ycCIsCiAgICAiRGVtIiwKICAgICJEZXB0IiwKICAgICJlZCIsCiAgICAiZWciLAogICAgIkVxIiwKICAgICJFcXMiLAogICAgImVzdCIsCiAgICAiZXN0IiwKICAgICJldGMiLAogICAgIkV4IiwKICAgICJleHQiLCAvLyArIG51bWJlcj8KICAgICJGaWciLAogICAgImZpZyIsCiAgICAiRmlncyIsCiAgICAiZmlncyIsCiAgICAiaS5lIiwKICAgICJpZSIsCiAgICAiSW5jIiwKICAgICJpbmMiLAogICAgIkphbiIsIkZlYiIsIk1hciIsIkFwciIsIkp1biIsIkp1bCIsIkF1ZyIsIlNlcCIsIlNlcHQiLCJPY3QiLCJOb3YiLCJEZWMiLAogICAgImpyIiwKICAgICJtaSIsCiAgICAiTWlzcyIsICJNcnMiLCAiTXIiLCAiTXMiLAogICAgIk1vbCIsCiAgICAibXQiLAogICAgIm10cyIsCiAgICAibm8iLAogICAgIk5vcyIsCiAgICAiUGhEIiwgIk1EIiwgIkJBIiwgIk1BIiwgIk1NIiwKICAgICJwbCIsCiAgICAicG9wIiwKICAgICJwcCIsCiAgICAiUHJvZiIsICJEciIsCiAgICAicHQiLAogICAgIlJlZiIsCiAgICAiUmVmcyIsCiAgICAiUmVwIiwKICAgICJyZXByIiwKICAgICJyZXYiLAogICAgIlNlYyIsCiAgICAiU2VjcyIsCiAgICAiU2d0IiwgIkNvbCIsICJHZW4iLCAiUmVwIiwgIlNlbiIsJ0dvdicsICJMdCIsICJNYWoiLCAiQ2FwdCIsIlN0IiwKICAgICJTciIsICJzciIsICJKciIsICJqciIsICJSZXYiLAogICAgIlN1biIsIk1vbiIsIlR1IiwiVHVlIiwiVHVlcyIsIldlZCIsIlRoIiwiVGh1IiwiVGh1ciIsIlRodXJzIiwiRnJpIiwiU2F0IiwKICAgICJ0cmFucyIsCiAgICAiVW5pdiIsCiAgICAiVml6IiwKICAgICJWb2wiLAogICAgInZzIiwKICAgICJ2IiwKXTsKCmV4cG9ydHMuc2V0QWJicmV2aWF0aW9ucyA9IGZ1bmN0aW9uKGFiYnIpIHsKICAgIGlmKGFiYnIpewogICAgICAgIGFiYnJldmlhdGlvbnMgPSBhYmJyOwogICAgfSBlbHNlIHsKICAgICAgICBhYmJyZXZpYXRpb25zID0gZW5nbGlzaEFiYnJldmlhdGlvbnM7CiAgICB9Cn0KCnZhciBpc0NhcGl0YWxpemVkID0gZXhwb3J0cy5pc0NhcGl0YWxpemVkID0gZnVuY3Rpb24oc3RyKSB7CiAgICByZXR1cm4gL15bQS1aXVthLXpdLiovLnRlc3Qoc3RyKSB8fCBpc051bWJlcihzdHIpOwp9CgovLyBTdGFydCB3aXRoIG9wZW5pbmcgcXVvdGVzIG9yIGNhcGl0YWxpemVkIGxldHRlcgpleHBvcnRzLmlzU2VudGVuY2VTdGFydGVyID0gZnVuY3Rpb24oc3RyKSB7CiAgICByZXR1cm4gaXNDYXBpdGFsaXplZChzdHIpIHx8IC9gYHwifCcvLnRlc3Qoc3RyLnN1YnN0cmluZygwLDIpKTsKfQoKZXhwb3J0cy5pc0NvbW1vbkFiYnJldmlhdGlvbiA9IGZ1bmN0aW9uKHN0cikgewogICAgcmV0dXJuIH5hYmJyZXZpYXRpb25zLmluZGV4T2Yoc3RyLnJlcGxhY2UoL1xXKy9nLCAnJykpOwp9CgovLyBUaGlzIGlzIGdvaW5nIHRvd2FyZHMgdG9vIG11Y2ggcnVsZSBiYXNlZApleHBvcnRzLmlzVGltZUFiYnJldmlhdGlvbiA9IGZ1bmN0aW9uKHdvcmQsIG5leHQpIHsKICAgIGlmICh3b3JkID09PSAiYS5tLiIgfHwgd29yZCA9PT0gInAubS4iKSB7CiAgICAgICAgdmFyIHRtcCA9IG5leHQucmVwbGFjZSgvXFcrL2csICcnKS5zbGljZSgtMykudG9Mb3dlckNhc2UoKTsKCiAgICAgICAgaWYgKHRtcCA9PT0gImRheSIpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiBmYWxzZTsKfQoKZXhwb3J0cy5pc0RvdHRlZEFiYnJldmlhdGlvbiA9IGZ1bmN0aW9uKHdvcmQpIHsKICAgIHZhciBtYXRjaGVzID0gd29yZC5yZXBsYWNlKC9bXChcKVxbXF1ce1x9XS9nLCAnJykubWF0Y2goLyguXC4pKi8pOwogICAgcmV0dXJuIG1hdGNoZXMgJiYgbWF0Y2hlc1swXS5sZW5ndGggPiAwOwp9CgovLyBUT0RPIGxvb2sgZm9yIG5leHQgd29yZHMsIGlmIG11bHRpcGxlIGFyZSBjYXBpdGFsaXplZCwKLy8gdGhlbiBpdCdzIHByb2JhYmx5IG5vdCBhIHNlbnRlbmNlIGVuZGluZwpleHBvcnRzLmlzQ3VzdG9tQWJicmV2aWF0aW9uID0gZnVuY3Rpb24oc3RyKSB7CiAgICBpZiAoc3RyLmxlbmd0aCA8PSAzKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuIGlzQ2FwaXRhbGl6ZWQoc3RyKTsKfQoKLy8gVXNlcyBjdXJyZW50IHdvcmQgY291bnQgaW4gc2VudGVuY2UgYW5kIG5leHQgZmV3IHdvcmRzIHRvIGNoZWNrIGlmIGl0IGlzCi8vIG1vcmUgbGlrZWx5IGFuIGFiYnJldmlhdGlvbiArIG5hbWUgb3IgbmV3IHNlbnRlbmNlLgpleHBvcnRzLmlzTmFtZUFiYnJldmlhdGlvbiA9IGZ1bmN0aW9uKHdvcmRDb3VudCwgd29yZHMpIHsKICAgIGlmICh3b3Jkcy5sZW5ndGggPiAwKSB7CiAgICAgICAgaWYgKHdvcmRDb3VudCA8IDUgJiYgd29yZHNbMF0ubGVuZ3RoIDwgNiAmJiBpc0NhcGl0YWxpemVkKHdvcmRzWzBdKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHZhciBjYXBpdGFsaXplZCA9IHdvcmRzLmZpbHRlcihmdW5jdGlvbihzdHIpIHsKICAgICAgICAgICAgcmV0dXJuIC9bQS1aXS8udGVzdChzdHIuY2hhckF0KDApKTsKICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIGNhcGl0YWxpemVkLmxlbmd0aCA+PSAzOwogICAgfQoKICAgIHJldHVybiBmYWxzZTsKfQoKdmFyIGlzTnVtYmVyID0gZXhwb3J0cy5pc051bWJlciA9IGZ1bmN0aW9uKHN0ciwgZG90UG9zKSB7CiAgICBpZiAoZG90UG9zKSB7CiAgICAgICAgc3RyID0gc3RyLnNsaWNlKGRvdFBvcy0xLCBkb3RQb3MrMik7CiAgICB9CgogICAgcmV0dXJuICFpc05hTihzdHIpOwp9OwoKLy8gUGhvbmUgbnVtYmVyIG1hdGNoaW5nCi8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzEyMzY2Ni85NTE1MTcKZXhwb3J0cy5pc1Bob25lTnIgPSBmdW5jdGlvbihzdHIpIHsKICAgIHJldHVybiBzdHIubWF0Y2goL14oPzooPzpcKz8xXHMqKD86Wy4tXVxzKik/KT8oPzpcKFxzKihbMi05XTFbMDItOV18WzItOV1bMDItOF0xfFsyLTldWzAyLThdWzAyLTldKVxzKlwpfChbMi05XTFbMDItOV18WzItOV1bMDItOF0xfFsyLTldWzAyLThdWzAyLTldKSlccyooPzpbLi1dXHMqKT8pPyhbMi05XTFbMDItOV18WzItOV1bMDItOV0xfFsyLTldWzAyLTldezJ9KVxzKig/OlsuLV1ccyopPyhbMC05XXs0fSkoPzpccyooPzojfHhcLj98ZXh0XC4/fGV4dGVuc2lvbilccyooXGQrKSk/JC8pOwp9OwoKLy8gTWF0Y2ggdXJscyAvIGVtYWlscwovLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zODA5NDM1Lzk1MTUxNwpleHBvcnRzLmlzVVJMID0gZnVuY3Rpb24oc3RyKSB7CiAgICByZXR1cm4gc3RyLm1hdGNoKC9bLWEtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fVwuW2Etel17Miw2fVxiKFstYS16QS1aMC05QDolX1wrLn4jPyYvLz1dKikvKTsKfTsKCi8vIFN0YXJ0aW5nIGEgbmV3IHNlbnRlbmNlIGlmIGJlZ2lubmluZyB3aXRoIGNhcGl0YWwgbGV0dGVyCi8vIEV4Y2VwdGlvbjogVGhlIHdvcmQgaXMgZW5jbG9zZWQgaW4gYnJhY2tldHMKZXhwb3J0cy5pc0NvbmNhdGVuYXRlZCA9IGZ1bmN0aW9uKHdvcmQpIHsKICAgIHZhciBpID0gMDsKCiAgICBpZiAoKGkgPSB3b3JkLmluZGV4T2YoIi4iKSkgPiAtMSB8fAogICAgICAgIChpID0gd29yZC5pbmRleE9mKCIhIikpID4gLTEgfHwKICAgICAgICAoaSA9IHdvcmQuaW5kZXhPZigiPyIpKSA+IC0xKQogICAgewogICAgICAgIHZhciBjID0gd29yZC5jaGFyQXQoaSArIDEpOwoKICAgICAgICAvLyBDaGVjayBpZiB0aGUgbmV4dCB3b3JkIHN0YXJ0cyB3aXRoIGEgbGV0dGVyCiAgICAgICAgaWYgKGMubWF0Y2goL1thLXpBLVpdLiovKSkgewogICAgICAgICAgICByZXR1cm4gW3dvcmQuc2xpY2UoMCwgaSksIHdvcmQuc2xpY2UoaSsxKV07CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiBmYWxzZTsKfTsKCmV4cG9ydHMuaXNCb3VuZGFyeUNoYXIgPSBmdW5jdGlvbih3b3JkKSB7CiAgICByZXR1cm4gd29yZCA9PT0gIi4iIHx8CiAgICAgICAgICAgd29yZCA9PT0gIiEiIHx8CiAgICAgICAgICAgd29yZCA9PT0gIj8iOwp9OwoKfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHNhbml0aXplSHRtbCh0ZXh0LCBvcHRzKSB7CiAgLy8gU3RyaXAgSFRNTCBmcm9tIFRleHQgdXNpbmcgYnJvd3NlciBIVE1MIHBhcnNlcgogIGlmICgodHlwZW9mIHRleHQgPT0gJ3N0cmluZycgfHwgdGV4dCBpbnN0YW5jZW9mIFN0cmluZykgJiYgdHlwZW9mIGRvY3VtZW50ICE9PSAidW5kZWZpbmVkIikgewogICAgdmFyICRkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJESVYiKTsKICAgICRkaXYuaW5uZXJIVE1MID0gdGV4dDsKICAgIHRleHQgPSAoJGRpdi50ZXh0Q29udGVudCB8fCAnJykudHJpbSgpOwogIH0KICAvL0RPTSBPYmplY3QKICBlbHNlIGlmICh0eXBlb2YgdGV4dCA9PT0gJ29iamVjdCcgJiYgdGV4dC50ZXh0Q29udGVudCkgewogICAgdGV4dCA9ICh0ZXh0LnRleHRDb250ZW50IHx8ICcnKS50cmltKCk7CiAgfQoKICByZXR1cm4gdGV4dDsKfTsKCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoKZXhwb3J0cy5lbmRzV2l0aENoYXIgPSBmdW5jdGlvbiBlbmRzX3dpdGhfY2hhcih3b3JkLCBjKSB7CiAgICBpZiAoYy5sZW5ndGggPiAxKSB7CiAgICAgICAgcmV0dXJuIGMuaW5kZXhPZih3b3JkLnNsaWNlKC0xKSkgPiAtMTsKICAgIH0KCiAgICByZXR1cm4gd29yZC5zbGljZSgtMSkgPT09IGM7Cn07CgpleHBvcnRzLmVuZHNXaXRoID0gZnVuY3Rpb24gZW5kc193aXRoKHdvcmQsIGVuZCkgewogICAgcmV0dXJuIHdvcmQuc2xpY2Uod29yZC5sZW5ndGggLSBlbmQubGVuZ3RoKSA9PT0gZW5kOwp9Owp9LHt9XSw0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLypqc2hpbnQgbm9kZTp0cnVlLCBsYXhjb21tYTp0cnVlICovCiJ1c2Ugc3RyaWN0IjsKCnZhciBzYW5pdGl6ZUh0bWwgPSByZXF1aXJlKCdzYW5pdGl6ZS1odG1sJyk7Cgp2YXIgc3RyaW5nSGVscGVyID0gcmVxdWlyZSgnLi9zdHJpbmdIZWxwZXInKTsKdmFyIE1hdGNoICA9IHJlcXVpcmUoJy4vTWF0Y2gnKTsKCnZhciBuZXdsaW5lX3BsYWNlaG9sZGVyID0gIiBAfkAgIjsKdmFyIG5ld2xpbmVfcGxhY2Vob2xkZXJfdCA9IG5ld2xpbmVfcGxhY2Vob2xkZXIudHJpbSgpOwoKCnZhciB3aGl0ZVNwYWNlQ2hlY2sgPSBuZXcgUmVnRXhwKCJcXFMiLCAiIik7CnZhciBhZGROZXdMaW5lQm91bmRhcmllcyA9IG5ldyBSZWdFeHAoIlxcbit8Wy0jPV8rKl17NCx9IiwgImciKTsKdmFyIHNwbGl0SW50b1dvcmRzID0gbmV3IFJlZ0V4cCgiXFxTK3xcXG4iLCAiZyIpOwoKCi8vIFNwbGl0IHRoZSBlbnRyeSBpbnRvIHNlbnRlbmNlcy4KZXhwb3J0cy5zZW50ZW5jZXMgPSBmdW5jdGlvbih0ZXh0LCB1c2VyX29wdGlvbnMpIHsKICAgIGlmICghdGV4dCB8fCB0eXBlb2YgdGV4dCAhPT0gInN0cmluZyIgfHwgIXRleHQubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgfQoKICAgIGlmICghd2hpdGVTcGFjZUNoZWNrLnRlc3QodGV4dCkpIHsKICAgICAgLy8gd2hpdGVzcGFjZS1vbmx5IHN0cmluZyBoYXMgbm8gc2VudGVuY2VzCiAgICAgIHJldHVybiBbXTsKICAgIH0KCiAgICB2YXIgb3B0aW9ucyA9IHsKICAgICAgICAibmV3bGluZV9ib3VuZGFyaWVzIiAgOiBmYWxzZSwKICAgICAgICAiaHRtbF9ib3VuZGFyaWVzIiAgICAgOiBmYWxzZSwKICAgICAgICAiaHRtbF9ib3VuZGFyaWVzX3RhZ3MiOiBbInAiLCJkaXYiLCJ1bCIsIm9sIl0sCiAgICAgICAgInNhbml0aXplIiAgICAgICAgICAgIDogZmFsc2UsCiAgICAgICAgImFsbG93ZWRfdGFncyIgICAgICAgIDogZmFsc2UsCiAgICAgICAgInByZXNlcnZlX3doaXRlc3BhY2UiIDogZmFsc2UsCiAgICAgICAgImFiYnJldmlhdGlvbnMiICAgICAgIDogbnVsbAogICAgfTsKCiAgICBpZiAodHlwZW9mIHVzZXJfb3B0aW9ucyA9PT0gImJvb2xlYW4iKSB7CiAgICAgICAgLy8gRGVwcmVjYXRlZCBxdWljayBvcHRpb24KICAgICAgICBvcHRpb25zLm5ld2xpbmVfYm91bmRhcmllcyA9IHRydWU7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICAvLyBFeHRlbmQgb3B0aW9ucwogICAgICAgIGZvciAodmFyIGsgaW4gdXNlcl9vcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnNba10gPSB1c2VyX29wdGlvbnNba107CiAgICAgICAgfQogICAgfQoKICAgIE1hdGNoLnNldEFiYnJldmlhdGlvbnMob3B0aW9ucy5hYmJyZXZpYXRpb25zKTsKCiAgICBpZiAob3B0aW9ucy5uZXdsaW5lX2JvdW5kYXJpZXMpIHsKICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKGFkZE5ld0xpbmVCb3VuZGFyaWVzLCBuZXdsaW5lX3BsYWNlaG9sZGVyKTsKICAgIH0KCiAgICBpZiAob3B0aW9ucy5odG1sX2JvdW5kYXJpZXMpIHsKICAgICAgICB2YXIgaHRtbF9ib3VuZGFyaWVzX3JlZ2V4cCA9ICIoPGJyXFxzKlxcLz8+fDxcXC8oIiArIG9wdGlvbnMuaHRtbF9ib3VuZGFyaWVzX3RhZ3Muam9pbigifCIpICsgIik+KSI7CiAgICAgICAgdmFyIHJlID0gbmV3IFJlZ0V4cChodG1sX2JvdW5kYXJpZXNfcmVnZXhwLCAiZyIpOwogICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UocmUsICIkMSIgKyBuZXdsaW5lX3BsYWNlaG9sZGVyKTsKICAgIH0KCiAgICBpZiAob3B0aW9ucy5zYW5pdGl6ZSB8fCBvcHRpb25zLmFsbG93ZWRfdGFncykgewogICAgICAgIGlmICghIG9wdGlvbnMuYWxsb3dlZF90YWdzKSB7CiAgICAgICAgICAgIG9wdGlvbnMuYWxsb3dlZF90YWdzID0gWyIiXTsKICAgICAgICB9CgogICAgICAgIHRleHQgPSBzYW5pdGl6ZUh0bWwodGV4dCwgeyAiYWxsb3dlZFRhZ3MiIDogb3B0aW9ucy5hbGxvd2VkX3RhZ3MgfSk7CiAgICB9CgoKICAgIC8vIFNwbGl0IHRoZSB0ZXh0IGludG8gd29yZHMKICAgIHZhciB3b3JkczsKICAgIHZhciB0b2tlbnM7CgogICAgLy8gU3BsaXQgdGhlIHRleHQgaW50byB3b3JkcwogICAgaWYgKG9wdGlvbnMucHJlc2VydmVfd2hpdGVzcGFjZSkgewogICAgICAgIC8vIDxicj4gdGFncyBhcmUgdGhlIG9kZCBtYW4gb3V0LCBhcyB3aGl0ZXNwYWNlIGlzIGFsbG93ZWQgaW5zaWRlIHRoZSB0YWcKICAgICAgICB0b2tlbnMgPSB0ZXh0LnNwbGl0KC8oPGJyXHMqXC8/PnxcUyt8XG4rKS8pOwoKICAgICAgICAvLyBldmVyeSBvdGhlciB0b2tlbiBpcyBhIHdvcmQKICAgICAgICB3b3JkcyA9IHRva2Vucy5maWx0ZXIoZnVuY3Rpb24gKHRva2VuLCBpaSkgewogICAgICAgICAgcmV0dXJuIGlpICUgMjsKICAgICAgICB9KTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIC8vIC0gc2VlIGh0dHA6Ly9ibG9nLnRvbXBhd2xhay5vcmcvc3BsaXQtc3RyaW5nLWludG8tdG9rZW5zLWphdmFzY3JpcHQKICAgICAgICB3b3JkcyA9IHRleHQudHJpbSgpLm1hdGNoKHNwbGl0SW50b1dvcmRzKTsKICAgIH0KCgogICAgdmFyIHdvcmRDb3VudCA9IDA7CiAgICB2YXIgaW5kZXggPSAwOwogICAgdmFyIHRlbXAgID0gW107CiAgICB2YXIgc2VudGVuY2VzID0gW107CiAgICB2YXIgY3VycmVudCAgID0gW107CgogICAgLy8gSWYgZ2l2ZW4gdGV4dCBpcyBvbmx5IHdoaXRlc3BhY2UgKG9yIG5vdGhpbmcgb2YgXFMrKQogICAgaWYgKCF3b3JkcyB8fCAhd29yZHMubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgfQoKICAgIGZvciAodmFyIGk9MCwgTD13b3Jkcy5sZW5ndGg7IGkgPCBMOyBpKyspIHsKICAgICAgICB3b3JkQ291bnQrKzsKCiAgICAgICAgLy8gQWRkIHRoZSB3b3JkIHRvIGN1cnJlbnQgc2VudGVuY2UKICAgICAgICBjdXJyZW50LnB1c2god29yZHNbaV0pOwoKICAgICAgICAvLyBTdWItc2VudGVuY2VzLCByZXNldCBjb3VudGVyCiAgICAgICAgaWYgKH53b3Jkc1tpXS5pbmRleE9mKCcsJykpIHsKICAgICAgICAgICAgd29yZENvdW50ID0gMDsKICAgICAgICB9CgogICAgICAgIGlmIChNYXRjaC5pc0JvdW5kYXJ5Q2hhcih3b3Jkc1tpXSkgfHwgc3RyaW5nSGVscGVyLmVuZHNXaXRoQ2hhcih3b3Jkc1tpXSwgIj8hIikgfHwgd29yZHNbaV0gPT09IG5ld2xpbmVfcGxhY2Vob2xkZXJfdCkgewogICAgICAgICAgICBpZiAoKG9wdGlvbnMubmV3bGluZV9ib3VuZGFyaWVzIHx8IG9wdGlvbnMuaHRtbF9ib3VuZGFyaWVzKSAmJiB3b3Jkc1tpXSA9PT0gbmV3bGluZV9wbGFjZWhvbGRlcl90KSB7CiAgICAgICAgICAgICAgICBjdXJyZW50LnBvcCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzZW50ZW5jZXMucHVzaChjdXJyZW50KTsKCiAgICAgICAgICAgIHdvcmRDb3VudCA9IDA7CiAgICAgICAgICAgIGN1cnJlbnQgICA9IFtdOwoKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKCiAgICAgICAgaWYgKHN0cmluZ0hlbHBlci5lbmRzV2l0aENoYXIod29yZHNbaV0sICJcIiIpIHx8IHN0cmluZ0hlbHBlci5lbmRzV2l0aENoYXIod29yZHNbaV0sICLigJ0iKSkgewogICAgICAgICAgICB3b3Jkc1tpXSA9IHdvcmRzW2ldLnNsaWNlKDAsIC0xKTsKICAgICAgICB9CgogICAgICAgIC8vIEEgZG90IG1pZ2h0IGluZGljYXRlIHRoZSBlbmQgc2VudGVuY2VzCiAgICAgICAgLy8gRXhjZXB0aW9uOiBUaGUgbmV4dCBzZW50ZW5jZSBzdGFydHMgd2l0aCBhIHdvcmQgKG5vbiBhYmJyZXZpYXRpb24pCiAgICAgICAgLy8gICAgICAgICAgICB0aGF0IGhhcyBhIGNhcGl0YWwgbGV0dGVyLgogICAgICAgIGlmIChzdHJpbmdIZWxwZXIuZW5kc1dpdGhDaGFyKHdvcmRzW2ldLCAnLicpKSB7CiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZXJlIGlzIGEgbmV4dCB3b3JkCiAgICAgICAgICAgIC8vIFRoaXMgcHJvYmFibHkgbmVlZHMgdG8gYmUgaW1wcm92ZWQgd2l0aCBtYWNoaW5lIGxlYXJuaW5nCiAgICAgICAgICAgIGlmIChpKzEgPCBMKSB7CiAgICAgICAgICAgICAgICAvLyBTaW5nbGUgY2hhcmFjdGVyIGFiYnIuCiAgICAgICAgICAgICAgICBpZiAod29yZHNbaV0ubGVuZ3RoID09PSAyICYmIGlzTmFOKHdvcmRzW2ldLmNoYXJBdCgwKSkpIHsKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBDb21tb24gYWJici4gdGhhdCBvZnRlbiBkbyBub3QgZW5kIHNlbnRlbmNlcwogICAgICAgICAgICAgICAgaWYgKE1hdGNoLmlzQ29tbW9uQWJicmV2aWF0aW9uKHdvcmRzW2ldKSkgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIE5leHQgd29yZCBzdGFydHMgd2l0aCBjYXBpdGFsIHdvcmQsIGJ1dCBjdXJyZW50IHNlbnRlbmNlIGlzCiAgICAgICAgICAgICAgICAvLyBxdWl0ZSBzaG9ydAogICAgICAgICAgICAgICAgaWYgKE1hdGNoLmlzU2VudGVuY2VTdGFydGVyKHdvcmRzW2krMV0pKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGNoLmlzVGltZUFiYnJldmlhdGlvbih3b3Jkc1tpXSwgd29yZHNbaSsxXSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAvLyBEZWFsaW5nIHdpdGggbmFtZXMgYXQgdGhlIHN0YXJ0IG9mIHNlbnRlbmNlcwogICAgICAgICAgICAgICAgICAgIGlmIChNYXRjaC5pc05hbWVBYmJyZXZpYXRpb24od29yZENvdW50LCB3b3Jkcy5zbGljZShpLCA2KSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoTWF0Y2guaXNOdW1iZXIod29yZHNbaSsxXSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGNoLmlzQ3VzdG9tQWJicmV2aWF0aW9uKHdvcmRzW2ldKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGVsbGlwc2lzCiAgICAgICAgICAgICAgICAgICAgaWYgKHN0cmluZ0hlbHBlci5lbmRzV2l0aCh3b3Jkc1tpXSwgIi4uIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAvLy8vIFNraXAgYWJicmV2aWF0aW9ucwogICAgICAgICAgICAgICAgICAgIC8vIFNob3J0IHdvcmRzICsgZG90IG9yIGEgZG90IGFmdGVyIGVhY2ggbGV0dGVyCiAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGNoLmlzRG90dGVkQWJicmV2aWF0aW9uKHdvcmRzW2ldKSkgewogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmIChNYXRjaC5pc05hbWVBYmJyZXZpYXRpb24od29yZENvdW50LCB3b3Jkcy5zbGljZShpLCA1KSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBzZW50ZW5jZXMucHVzaChjdXJyZW50KTsKICAgICAgICAgICAgY3VycmVudCAgID0gW107CiAgICAgICAgICAgIHdvcmRDb3VudCA9IDA7CgogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIC8vIENoZWNrIGlmIHRoZSB3b3JkIGhhcyBhIGRvdCBpbiBpdAogICAgICAgIGlmICgoaW5kZXggPSB3b3Jkc1tpXS5pbmRleE9mKCIuIikpID4gLTEpIHsKICAgICAgICAgICAgaWYgKE1hdGNoLmlzTnVtYmVyKHdvcmRzW2ldLCBpbmRleCkpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBDdXN0b20gZG90dGVkIGFiYnJldmlhdGlvbnMgKGxpa2UgSy5MLk0gb3IgSS5DLlQpCiAgICAgICAgICAgIGlmIChNYXRjaC5pc0RvdHRlZEFiYnJldmlhdGlvbih3b3Jkc1tpXSkpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBTa2lwIHVybHMgLyBlbWFpbHMgYW5kIHRoZSBsaWtlCiAgICAgICAgICAgIGlmIChNYXRjaC5pc1VSTCh3b3Jkc1tpXSkgfHwgTWF0Y2guaXNQaG9uZU5yKHdvcmRzW2ldKSkgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICh0ZW1wID0gTWF0Y2guaXNDb25jYXRlbmF0ZWQod29yZHNbaV0pKSB7CiAgICAgICAgICAgIGN1cnJlbnQucG9wKCk7CiAgICAgICAgICAgIGN1cnJlbnQucHVzaCh0ZW1wWzBdKTsKICAgICAgICAgICAgc2VudGVuY2VzLnB1c2goY3VycmVudCk7CgogICAgICAgICAgICBjdXJyZW50ID0gW107CiAgICAgICAgICAgIHdvcmRDb3VudCA9IDA7CiAgICAgICAgICAgIGN1cnJlbnQucHVzaCh0ZW1wWzFdKTsKICAgICAgICB9CiAgICB9CgogICAgaWYgKGN1cnJlbnQubGVuZ3RoKSB7CiAgICAgICAgc2VudGVuY2VzLnB1c2goY3VycmVudCk7CiAgICB9CgoKICAgIC8vIENsZWFyICJlbXB0eSIgc2VudGVuY2VzCiAgICBzZW50ZW5jZXMgPSBzZW50ZW5jZXMuZmlsdGVyKGZ1bmN0aW9uKHMpIHsKICAgICAgICByZXR1cm4gcy5sZW5ndGggPiAwOwogICAgfSk7CgogICAgdmFyIHJlc3VsdCA9IHNlbnRlbmNlcy5zbGljZSgxKS5yZWR1Y2UoZnVuY3Rpb24gKG91dCwgc2VudGVuY2UpIHsKICAgICAgdmFyIGxhc3RTZW50ZW5jZSA9IG91dFtvdXQubGVuZ3RoIC0gMV07CiAgICAgIC8vIFNpbmdsZSB3b3JkcywgY291bGQgYmUgImVudW1lcmF0aW9uIGxpc3RzIgogICAgICBpZiAobGFzdFNlbnRlbmNlLmxlbmd0aCA9PT0gMSAmJiAvXi57MSwyfVsuXSQvLnRlc3QobGFzdFNlbnRlbmNlWzBdKSkgewogICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlcmUgaXMgYSBuZXh0IHNlbnRlbmNlCiAgICAgICAgICAvLyBJdCBzaG91bGQgbm90IGJlIGFub3RoZXIgbGlzdCBpdGVtCiAgICAgICAgICBpZiAoIS9bLl0vLnRlc3Qoc2VudGVuY2VbMF0pKSB7CiAgICAgICAgICAgICAgb3V0LnBvcCgpCiAgICAgICAgICAgICAgb3V0LnB1c2gobGFzdFNlbnRlbmNlLmNvbmNhdChzZW50ZW5jZSkpOwogICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgb3V0LnB1c2goc2VudGVuY2UpOwogICAgICByZXR1cm4gb3V0OwogICAgfSwgWyBzZW50ZW5jZXNbMF0gXSk7CgogICAgLy8gam9pbiB0b2tlbnMgYmFjayB0b2dldGhlcgogICAgcmV0dXJuIHJlc3VsdC5tYXAoZnVuY3Rpb24gKHNlbnRlbmNlLCBpaSkgewogICAgICBpZiAob3B0aW9ucy5wcmVzZXJ2ZV93aGl0ZXNwYWNlICYmICFvcHRpb25zLm5ld2xpbmVfYm91bmRhcmllcyAmJiAhb3B0aW9ucy5odG1sX2JvdW5kYXJpZXMpIHsKICAgICAgICAvLyB0b2tlbnMgbG9va3MgbGlrZSBzbzogW2xlYWRpbmctc3BhY2UgdG9rZW4sIG5vbi1zcGFjZSB0b2tlbiwgc3BhY2UKICAgICAgICAvLyB0b2tlbiwgbm9uLXNwYWNlIHRva2VuLCBzcGFjZSB0b2tlbi4uLiBdLiBJbiBvdGhlciB3b3JkcywgdGhlIGZpcnN0CiAgICAgICAgLy8gaXRlbSBpcyB0aGUgbGVhZGluZyBzcGFjZSAob3IgdGhlIGVtcHR5IHN0cmluZyksIGFuZCB0aGUgcmVzdCBvZgogICAgICAgIC8vIHRoZSB0b2tlbnMgYXJlIFtub24tc3BhY2UsIHNwYWNlXSB0b2tlbiBwYWlycy4KICAgICAgICB2YXIgdG9rZW5Db3VudCA9IHNlbnRlbmNlLmxlbmd0aCAqIDI7CiAgICAgICAgaWYgKGlpID09PSAwKSB7CiAgICAgICAgICB0b2tlbkNvdW50ICs9IDE7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0b2tlbnMuc3BsaWNlKDAsIHRva2VuQ291bnQpLmpvaW4oJycpOwogICAgICB9CiAgICAgIHJldHVybiBzZW50ZW5jZS5qb2luKCIgIik7CiAgICB9KTsKfTsKCn0seyIuL01hdGNoIjoxLCIuL3N0cmluZ0hlbHBlciI6Mywic2FuaXRpemUtaHRtbCI6Mn1dfSx7fSxbNF0pKDQpCn0pOw==",
        "Y2xhc3MgU2VudGVuY2VUb2tlbml6ZXJ7DQogICAgY29uc3RydWN0b3IoKXsNCiAgICB9DQogICAgc2V0RW50cnkoZW50cnkpew0KICAgICAgICB0aGlzLmVudHJ5ID0gdGhpcy5jb21wYWN0KGVudHJ5KTsNCiAgICAgICAgdGhpcy5zZW50ZW5jZXMgPSBudWxsOw0KICAgIH0NCg0KICAgIGdldFNlbnRlbmNlcygpew0KICAgICAgICBpZiAoIXRoaXMuZW50cnkpIHJldHVybiBbXTsNCiAgICAgICAgbGV0IHdvcmRzID0gdGhpcy5lbnRyeS5zcGxpdCgnICcpOw0KICAgICAgICBsZXQgZW5kaW5nV29yZHMgPSB3b3Jkcy5maWx0ZXIoZnVuY3Rpb24odykgew0KICAgICAgICAgICAgcmV0dXJuIHcuZW5kc1dpdGgoJy4nKSB8fCB3LmVuZHNXaXRoKCchJykgfHwgdy5lbmRzV2l0aCgnPycpOw0KICAgICAgICB9KTsNCg0KICAgICAgICBsZXQgc2VsZiA9IHRoaXM7DQogICAgICAgIGxldCBsYXN0U2VudGVuY2UgPSB3b3Jkc1swXTsNCiAgICAgICAgc2VsZi5zZW50ZW5jZXMgPSBbXTsNCiAgICAgICAgd29yZHMucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBjdXIpIHsNCg0KDQogICAgICAgICAgICBpZiAoZW5kaW5nV29yZHMuaW5kZXhPZihwcmV2KSAhPT0gLTEpIHsNCiAgICAgICAgICAgICAgICBzZWxmLnNlbnRlbmNlcy5wdXNoKHNlbGYuY29tcGFjdChsYXN0U2VudGVuY2UpKTsNCiAgICAgICAgICAgICAgICBsYXN0U2VudGVuY2UgPSAiIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGxhc3RTZW50ZW5jZSA9IGxhc3RTZW50ZW5jZSArICIgIiArIGN1cjsNCiAgICAgICAgICAgIHJldHVybiBjdXI7DQogICAgICAgIH0pOw0KICAgICAgICBzZWxmLnNlbnRlbmNlcy5wdXNoKHRoaXMuY29tcGFjdChsYXN0U2VudGVuY2UpKTsNCiAgICAgICAgcmV0dXJuIHRoaXMuc2VudGVuY2VzOw0KICAgIH0NCg0KDQogICAgY29tcGFjdChzdHIpew0KICAgICAgICBsZXQgcmVzID0gc3RyLnRyaW0oKTsNCiAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoJyAgJywgJyAnKTsNCiAgICAgICAgcmV0dXJuIHJlczsNCiAgICB9DQoNCn0NCg==",
        "dmFyIHBhZ2VVdGlscyA9IHsNCiAgICBzZW50ZW5jZVRva2VuaXplcjogbmV3IFNlbnRlbmNlVG9rZW5pemVyKCksDQogICAgY29udGFpbnNUZXh0Q29udGVudDpmdW5jdGlvbihub2RlKSB7DQoNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2RlLnRleHRDb250ZW50Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBpZiAocGFnZVV0aWxzLnV0aWwudW5pY29kZUNoYXIudGVzdChub2RlLnRleHRDb250ZW50W2ldKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiBmYWxzZTsNCg0KICAgIH0sDQogICAgcmVtb3ZlRGlzcGxheVVuZGVyUG9zaXRpb246ZnVuY3Rpb24gKHgseSkgew0KICAgICAgICBsZXQgb2xkUmVzdWx0ID0gJChkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHgsIHkpKS5jbG9zZXN0KCcuZWFzeS1yZWFkaW5nLXJlc3VsdCcpOw0KICAgICAgICBpZiAob2xkUmVzdWx0Lmxlbmd0aCkgew0KDQoNCiAgICAgICAgICAgIGxldCBwcmVzZW50YXRpb25JRCA9IG9sZFJlc3VsdC5kYXRhKCJwcmVzZW50YXRpb25pZCIpLnNwbGl0KCctJyk7DQoNCiAgICAgICAgICAgIGVhc3lSZWFkaW5nLnVzZXJJbnRlcmZhY2VzW3ByZXNlbnRhdGlvbklEWzBdXS50b29sc1twcmVzZW50YXRpb25JRFsxXV0ucHJlc2VudGF0aW9uLnJlbW92ZVJlc3VsdChvbGRSZXN1bHQuZGF0YSgicmVxdWVzdGlkIikpOw0KICAgICAgICB9DQogICAgfSwNCg0KICAgIGdldFdvcmRVbmRlclBvc2l0aW9uOiBmdW5jdGlvbiAoeCwgeSkgew0KDQoNCiAgICAgICAgLyoNCiAgICAgICAgbGV0IG9sZFJlc3VsdCA9ICQoZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludCh4LCB5KSkuY2xvc2VzdCgnLmVhc3ktcmVhZGluZy1yZXN1bHQnKTsNCiAgICAgICAgaWYgKG9sZFJlc3VsdC5sZW5ndGgpIHsNCg0KDQogICAgICAgICAgICBsZXQgcHJlc2VudGF0aW9uSUQgPSBvbGRSZXN1bHQuZGF0YSgicHJlc2VudGF0aW9uaWQiKS5zcGxpdCgnLScpOw0KICAgICAgICAgICAgZWFzeVJlYWRpbmcudXNlckludGVyZmFjZXNbcHJlc2VudGF0aW9uSURbMF1dLnRvb2xzW3ByZXNlbnRhdGlvbklEWzFdXS5wcmVzZW50YXRpb24ucmVtb3ZlUmVzdWx0KG9sZFJlc3VsdC5hdHRyKCdpZCcpKTsNCiAgICAgICAgfQ0KICAgICAgICAqLw0KDQogICAgICAgIGxldCByYW5nZSwgdGV4dE5vZGUsIG9mZnNldDsNCiAgICAgICAgLy8gSW50ZXJuZXQgRXhwbG9yZXINCiAgICAgICAgaWYgKGRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIHJhbmdlID0gZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UoKTsNCiAgICAgICAgICAgICAgICByYW5nZS5tb3ZlVG9Qb2ludCh4LCB5KTsNCiAgICAgICAgICAgICAgICByYW5nZS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICByYW5nZSA9IHBhZ2VVdGlscy51dGlsLmdldFRleHRSYW5nZUJvdW5kYXJ5UG9zaXRpb24ocmFuZ2UsIHRydWUpOw0KDQogICAgICAgICAgICAgICAgdGV4dE5vZGUgPSByYW5nZS5ub2RlOw0KICAgICAgICAgICAgICAgIG9mZnNldCA9IHJhbmdlLm9mZnNldDsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gU2lnaCwgSUUNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBGaXJlZm94LCBTYWZhcmkNCiAgICAgICAgLy8gUkVGOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvRG9jdW1lbnQvY2FyZXRQb3NpdGlvbkZyb21Qb2ludA0KICAgICAgICBlbHNlIGlmIChkb2N1bWVudC5jYXJldFBvc2l0aW9uRnJvbVBvaW50KSB7DQogICAgICAgICAgICByYW5nZSA9IGRvY3VtZW50LmNhcmV0UG9zaXRpb25Gcm9tUG9pbnQoeCwgeSk7DQogICAgICAgICAgICB0ZXh0Tm9kZSA9IHJhbmdlLm9mZnNldE5vZGU7DQogICAgICAgICAgICBvZmZzZXQgPSByYW5nZS5vZmZzZXQ7DQoNCiAgICAgICAgICAgIC8vIENocm9tZQ0KICAgICAgICAgICAgLy8gUkVGOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvZG9jdW1lbnQvY2FyZXRSYW5nZUZyb21Qb2ludA0KICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50LmNhcmV0UmFuZ2VGcm9tUG9pbnQpIHsNCiAgICAgICAgICAgIHJhbmdlID0gZG9jdW1lbnQuY2FyZXRSYW5nZUZyb21Qb2ludCh4LCB5KTsNCiAgICAgICAgICAgIHRleHROb2RlID0gcmFuZ2Uuc3RhcnRDb250YWluZXI7DQogICAgICAgICAgICBvZmZzZXQgPSByYW5nZS5zdGFydE9mZnNldDsNCiAgICAgICAgfQ0KDQoNCiAgICAgICAgLy8gT25seSBhY3Qgb24gdGV4dCBub2Rlcw0KICAgICAgICBpZiAoIXRleHROb2RlIHx8IHRleHROb2RlLm5vZGVUeXBlICE9PSBOb2RlLlRFWFRfTk9ERSkgew0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCg0KICAgICAgICBsZXQgZGF0YSA9IHRleHROb2RlLnRleHRDb250ZW50Ow0KDQogICAgICAgIC8vIFNvbWV0aW1lcyB0aGUgb2Zmc2V0IGNhbiBiZSBhdCB0aGUgJ2xlbmd0aCcgb2YgdGhlIGRhdGEuDQogICAgICAgIC8vIEl0IG1pZ2h0IGJlIGEgYnVnIHdpdGggdGhpcyAnZXhwZXJpbWVudGFsJyBmZWF0dXJlDQogICAgICAgIC8vIENvbXBlbnNhdGUgZm9yIHRoaXMgYmVsb3cNCiAgICAgICAgaWYgKG9mZnNldCA+PSBkYXRhLmxlbmd0aCkgew0KICAgICAgICAgICAgb2Zmc2V0ID0gZGF0YS5sZW5ndGggLSAxOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gSWdub3JlIHRoZSBjdXJzb3Igb24gc3BhY2VzIC0gdGhlc2UgYXJlbid0IHdvcmRzDQogICAgICAgIGlmIChwYWdlVXRpbHMudXRpbC5pc1coZGF0YVtvZmZzZXRdKSkgew0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCg0KDQogICAgICAgIC8vIFNjYW4gYmVoaW5kIHRoZSBjdXJyZW50IGNoYXJhY3RlciB1bnRpbCB3aGl0ZXNwYWNlIGlzIGZvdW5kLCBvciBiZWdpbm5pbmcNCiAgICAgICAgaSA9IG9mZnNldDsNCiAgICAgICAgd2hpbGUgKGkgPiAwICYmICFwYWdlVXRpbHMudXRpbC5pc1coZGF0YVtpIC0gMV0pKSB7DQogICAgICAgICAgICBpLS07DQogICAgICAgIH0NCiAgICAgICAgbGV0IGJlZ2luID0gaTsNCg0KICAgICAgICAvLyBTY2FuIGFoZWFkIG9mIHRoZSBjdXJyZW50IGNoYXJhY3RlciB1bnRpbCB3aGl0ZXNwYWNlIGlzIGZvdW5kLCBvciBlbmQNCiAgICAgICAgaSA9IG9mZnNldDsNCiAgICAgICAgd2hpbGUgKGkgPCBkYXRhLmxlbmd0aCAtIDEgJiYgIXBhZ2VVdGlscy51dGlsLmlzVyhkYXRhW2kgKyAxXSkpIHsNCiAgICAgICAgICAgIGkrKzsNCiAgICAgICAgfQ0KICAgICAgICBsZXQgZW5kID0gaTsNCg0KICAgICAgICAvLyBUaGlzIGlzIG91ciB0ZW1wb3Jhcnkgd29yZA0KICAgICAgICBsZXQgd29yZCA9IGRhdGEuc3Vic3RyaW5nKGJlZ2luLCBlbmQgKyAxKTsNCg0KICAgICAgICBsZXQgdGV4dE5vZGVzID0gW107DQogICAgICAgIHRleHROb2Rlcy5wdXNoKHRleHROb2RlKTsNCg0KICAgICAgICBpZiAoZW5kID09PSBkYXRhLmxlbmd0aCAtIDEpIHsNCg0KICAgICAgICAgICAgZm9yIChsZXQgbmV4dE5vZGUgPSBwYWdlVXRpbHMudXRpbC5nZXROZXh0Tm9kZSh0ZXh0Tm9kZSk7IG5leHROb2RlOyBuZXh0Tm9kZSA9IHBhZ2VVdGlscy51dGlsLmdldE5leHROb2RlKG5leHROb2RlKSkgew0KICAgICAgICAgICAgICAgIGxldCBuZXh0VGV4dCA9IG5leHROb2RlLnRleHRDb250ZW50Ow0KICAgICAgICAgICAgICAgIGlmIChuZXh0VGV4dCkgew0KICAgICAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIGxldHRlcnMgZnJvbSB0aGUgbmV4dCB0ZXh0IGJsb2NrIHVudGlsIGEgd2hpdGVzcGFjZSwgb3IgZW5kDQogICAgICAgICAgICAgICAgICAgIGxldCBpID0gMDsNCiAgICAgICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gLTE7DQogICAgICAgICAgICAgICAgICAgIHdoaWxlIChpIDwgbmV4dFRleHQubGVuZ3RoICYmICFwYWdlVXRpbHMudXRpbC5pc1cobmV4dFRleHRbaV0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB3b3JkICs9IG5leHRUZXh0W2ldOw0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kSW5kZXggPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kID0gZW5kSW5kZXg7DQogICAgICAgICAgICAgICAgICAgICAgICBpKys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKGVuZEluZGV4ICE9PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGV4dE5vZGVzLnB1c2gobmV4dE5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT09IG5leHRUZXh0Lmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCA9IGVuZEluZGV4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKGJlZ2luID09PSAwKSB7DQogICAgICAgICAgICBmb3IgKGxldCBwcmV2Tm9kZSA9IHBhZ2VVdGlscy51dGlsLmdldFByZXZOb2RlKHRleHROb2RlKTsgcHJldk5vZGU7IHByZXZOb2RlID0gcGFnZVV0aWxzLnV0aWwuZ2V0UHJldk5vZGUocHJldk5vZGUpKSB7DQogICAgICAgICAgICAgICAgbGV0IHByZXZUZXh0ID0gcHJldk5vZGUudGV4dENvbnRlbnQ7DQogICAgICAgICAgICAgICAgaWYgKHByZXZUZXh0KSB7DQogICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgbGV0dGVycyBmcm9tIHRoZSBuZXh0IHRleHQgYmxvY2sgdW50aWwgYSB3aGl0ZXNwYWNlLCBvciBlbmQNCiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSBwcmV2VGV4dC5sZW5ndGggLSAxOw0KICAgICAgICAgICAgICAgICAgICBsZXQgYmVnaW5JbmRleCA9IC0xOw0KICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFwYWdlVXRpbHMudXRpbC5pc1cocHJldlRleHRbaV0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB3b3JkID0gcHJldlRleHRbaV0gKyB3b3JkOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmVnaW5JbmRleCA9IGk7DQogICAgICAgICAgICAgICAgICAgICAgICBiZWdpbiA9IGJlZ2luSW5kZXg7DQogICAgICAgICAgICAgICAgICAgICAgICBpLS07DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZiAoaSAhPT0gcHJldlRleHQubGVuZ3RoIC0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGV4dE5vZGVzLnVuc2hpZnQocHJldk5vZGUpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmVnaW5JbmRleCAhPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlZ2luID0gYmVnaW5JbmRleDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICB0ZXh0Tm9kZXMgPSBwYWdlVXRpbHMudXRpbC5nZXRUZXh0Tm9kZXModGV4dE5vZGVzKTsNCg0KDQogICAgICAgIC8qDQogICAgICAgIFVzZWQgdG8gbWFyaw0KICAgICAgICB0ZXh0Tm9kZXNbdGV4dE5vZGVzLmxlbmd0aC0xXS5zcGxpdFRleHQoZW5kKzEpOw0KDQogICAgICAgIGlmKGJlZ2luICE9PSAwKXsNCiAgICAgICAgICAgIHRleHROb2Rlc1swXSA9IHRleHROb2Rlc1swXS5zcGxpdFRleHQoYmVnaW4pOw0KDQogICAgICAgIH0NCg0KICAgICAgICBmb3IobGV0IGk9MDsgaSA8IHRleHROb2Rlcy5sZW5ndGg7IGkrKyl7DQogICAgICAgICAgICAkKCB0ZXh0Tm9kZXNbaV0gKS53cmFwKCAiPHNwYW4gY2xhc3M9J25ldycgc3R5bGU9J2NvbG9yOiB5ZWxsb3cnPjwvc3Bhbj4iICk7DQoNCiAgICAgICAgfQ0KICAgICAgICAqLw0KDQoNCiAgICAgICAgLy9DaGVjayBpZiBlbGVtZW50IGF0IHBvaW50IGFuZCBwYXJlbnQgY29udGFpbmVyIG9mIHRleHROb2RlIGRvIG1hdGNoLg0KICAgICAgICAvL0JlY2F1c2UgY2FyZXQgcG9zaXRpb24gY2FuIHZhcnkgZnJvbSBjb250YWluZXIgcG9zaXRpb24NCg0KICAgICAgICBsZXQgZWxlbSA9ICQoZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludCh4LCB5KSk7DQogICAgICAgIGxldCBjb250YWluZXIgPSAkKHRleHROb2RlKS5wYXJlbnQoKVswXTsNCiAgICAgICAgLyoNCg0KICAgICAgICAgICAgICAgIGlmIChlbGVtWzBdICE9PSAkKHRleHROb2RlKS5wYXJlbnQoKVswXSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gIiI7DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgKi8NCg0KICAgICAgICAvL1JFTU9WRSAmc2h5Ow0KICAgICAgICB3b3JkID0gd29yZC5yZXBsYWNlKC9cdTAwQUQvZywgJycpOw0KICAgICAgICBsZXQgaXRlcmF0b3IgPSBuZXcgSFRNTEl0ZXJhdG9yKHRleHROb2Rlc1swXSk7DQogICAgICAgIGxldCBwYXJhZ3JhcGhfY29udGFpbmVyID0gaXRlcmF0b3IuZ2V0Q29udGFpbmVyT2ZUZXh0Tm9kZSh0ZXh0Tm9kZXNbMF0pOw0KDQogICAgICAgIGxldCB0ZXh0ID0gJChwYXJhZ3JhcGhfY29udGFpbmVyKS50ZXh0KCk7DQogICAgICAgIHRleHQgPSB0ZXh0LnRyaW0oKS5yZXBsYWNlKC8oXHJcblx0fFxufFxyXHQpL2dtLCAiIik7DQogICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoL1x0L2csICcnKTsNCiAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZSgvXG4vZywgJycpOw0KICAgICAgICBsZXQgdGV4dFBpZWNlcyA9IHRleHQuc3BsaXQod29yZCk7DQoNCg0KDQogICAgICAgIGxldCBtYXhTZW50ZW5jZUxlbmd0aCA9IDE1MDsNCg0KICAgICAgICBsZXQgYmVnaW5TdHJpbmcgPSB0ZXh0Tm9kZXNbMF0udGV4dENvbnRlbnQuc3Vic3RyaW5nKDAsYmVnaW4pOw0KICAgICAgICBpZihiZWdpblN0cmluZy5sZW5ndGggPCBtYXhTZW50ZW5jZUxlbmd0aCl7DQogICAgICAgICAgICBsZXQgcHJldk5vZGUgPSBwYWdlVXRpbHMudXRpbC5nZXRQcmV2Tm9kZSh0ZXh0Tm9kZXNbMF0pOw0KICAgICAgICAgICAgd2hpbGUocHJldk5vZGUpew0KDQogICAgICAgICAgICAgICAgbGV0IHByZXZUZXh0Tm9kZXMgPSBbXTsNCiAgICAgICAgICAgICAgICBpZihwcmV2Tm9kZS5ub2RlTmFtZSAhPT0gJyN0ZXh0Jyl7DQogICAgICAgICAgICAgICAgICAgIHByZXZUZXh0Tm9kZXMgPSBwYWdlVXRpbHMudXRpbC5nZXRDaGlsZFRleHROb2RlcyhwcmV2Tm9kZSk7DQogICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgIHByZXZUZXh0Tm9kZXMucHVzaChwcmV2Tm9kZSk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgbGV0IGZpbmlzaGVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgZm9yKGxldCBpPSBwcmV2VGV4dE5vZGVzLmxlbmd0aC0xOyBpID49MDsgaS0tKXsNCiAgICAgICAgICAgICAgICAgICAgYmVnaW5TdHJpbmcgPSBwcmV2VGV4dE5vZGVzW2ldLnRleHRDb250ZW50ICsgYmVnaW5TdHJpbmc7DQogICAgICAgICAgICAgICAgICAgIGlmKGJlZ2luU3RyaW5nLmxlbmd0aCA+PW1heFNlbnRlbmNlTGVuZ3RoKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmlzaGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYoIWZpbmlzaGVkKXsNCiAgICAgICAgICAgICAgICAgICAgcHJldk5vZGUgPSBwYWdlVXRpbHMudXRpbC5nZXRQcmV2Tm9kZShwcmV2Tm9kZSk7DQogICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGxldCBlbmRTdHJpbmcgPSB0ZXh0Tm9kZXNbdGV4dE5vZGVzLmxlbmd0aC0xXS50ZXh0Q29udGVudC5zdWJzdHJpbmcoZW5kKzEpOw0KDQogICAgICAgIGlmKGVuZFN0cmluZy5sZW5ndGggPCBtYXhTZW50ZW5jZUxlbmd0aCl7DQogICAgICAgICAgICBsZXQgbmV4dE5vZGUgPSBwYWdlVXRpbHMudXRpbC5nZXROZXh0Tm9kZSh0ZXh0Tm9kZXNbdGV4dE5vZGVzLmxlbmd0aC0xXSk7DQogICAgICAgICAgICB3aGlsZShuZXh0Tm9kZSl7DQoNCiAgICAgICAgICAgICAgICBsZXQgbmV4dFRleHROb2RlcyA9IFtdOw0KICAgICAgICAgICAgICAgIGlmKG5leHROb2RlLm5vZGVOYW1lICE9PSAnI3RleHQnKXsNCiAgICAgICAgICAgICAgICAgICAgbmV4dFRleHROb2RlcyA9IHBhZ2VVdGlscy51dGlsLmdldENoaWxkVGV4dE5vZGVzKG5leHROb2RlKTsNCiAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgbmV4dFRleHROb2Rlcy5wdXNoKG5leHROb2RlKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBsZXQgZmluaXNoZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICBmb3IobGV0IGk9IG5leHRUZXh0Tm9kZXMubGVuZ3RoLTE7IGkgPj0wOyBpLS0pew0KICAgICAgICAgICAgICAgICAgICBlbmRTdHJpbmcgPSAgZW5kU3RyaW5nK25leHRUZXh0Tm9kZXNbaV0udGV4dENvbnRlbnQ7DQogICAgICAgICAgICAgICAgICAgIGlmKGVuZFN0cmluZy5sZW5ndGggPj1tYXhTZW50ZW5jZUxlbmd0aCl7DQogICAgICAgICAgICAgICAgICAgICAgICBmaW5pc2hlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmKCFmaW5pc2hlZCl7DQogICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gcGFnZVV0aWxzLnV0aWwuZ2V0TmV4dE5vZGUobmV4dE5vZGUpOw0KICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KDQogICAgICAgIGJlZ2luU3RyaW5nID0gYmVnaW5TdHJpbmcudHJpbSgpLnJlcGxhY2UoLyhccyspL2dtLCAiICIpLnJlcGxhY2UoLyhbXHJcbl0pL2dtLCAiIik7DQogICAgICAgIHRoaXMuc2VudGVuY2VUb2tlbml6ZXIuc2V0RW50cnkoYmVnaW5TdHJpbmcpOw0KICAgICAgICBsZXQgYmVnaW5TZW50ZW5jZXMgPSB0aGlzLnNlbnRlbmNlVG9rZW5pemVyLmdldFNlbnRlbmNlcygpOw0KDQoNCiAgICAgICAgZW5kU3RyaW5nID0gZW5kU3RyaW5nLnRyaW0oKS5yZXBsYWNlKC8oXHMrKS9nbSwgIiAiKS5yZXBsYWNlKC8oW1xyXG5dKS9nbSwgIiIpOw0KICAgICAgICB0aGlzLnNlbnRlbmNlVG9rZW5pemVyLnNldEVudHJ5KGVuZFN0cmluZyk7DQogICAgICAgIGxldCBlbmRTZW50ZW5jZXMgPSB0aGlzLnNlbnRlbmNlVG9rZW5pemVyLmdldFNlbnRlbmNlcygpOw0KDQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHR5cGU6IFdvcmQuY2xhc3NOYW1lLA0KICAgICAgICAgICAgdmFsdWU6IHdvcmQsDQogICAgICAgICAgICB3b3JkOiB3b3JkLA0KICAgICAgICAgICAgYmVnaW46IGJlZ2luLA0KICAgICAgICAgICAgZW5kOiBlbmQsDQogICAgICAgICAgICB0ZXh0Tm9kZXM6IHRleHROb2RlcywNCiAgICAgICAgICAgIHNlbnRlbmNlQmVnaW46IGJlZ2luU2VudGVuY2VzW2JlZ2luU2VudGVuY2VzLmxlbmd0aC0xXSwNCiAgICAgICAgICAgIHNlbnRlbmNlRW5kOiBlbmRTZW50ZW5jZXNbMF0sDQogICAgICAgICAgICBsYW5nOiBwYWdlVXRpbHMudXRpbC5nZXRMYW5ndWFnZU9mRWxlbWVudCh0ZXh0Tm9kZXNbMF0pLA0KICAgICAgICAgICAgY29udGFpbmVyOiBjb250YWluZXIsDQoNCg0KICAgICAgICB9DQoNCiAgICB9LA0KICAgIHJlbW92ZURpc3BsYXlJblRleHROb2Rlcyh0ZXh0Tm9kZXMpew0KDQoNCiAgICAgICAgbGV0IGZvdW5kUmVzdWx0ID0gZmFsc2U7DQogICAgICAgIGZvcihsZXQgaT0wOyBpIDwgdGV4dE5vZGVzLmxlbmd0aDsgaSsrKXsNCiAgICAgICAgICAgIGxldCBvbGRSZXN1bHQgPSAkKHRleHROb2Rlc1tpXSkuY2xvc2VzdCgnLmVhc3ktcmVhZGluZy1yZXN1bHQnKTsNCg0KICAgICAgICAgICAgaWYgKG9sZFJlc3VsdC5sZW5ndGgpIHsNCg0KICAgICAgICAgICAgICAgIGxldCBwcmVzZW50YXRpb25JRCA9IG9sZFJlc3VsdC5kYXRhKCJwcmVzZW50YXRpb25pZCIpLnNwbGl0KCctJyk7DQogICAgICAgICAgICAgICAgZWFzeVJlYWRpbmcudXNlckludGVyZmFjZXNbcHJlc2VudGF0aW9uSURbMF1dLnRvb2xzW3ByZXNlbnRhdGlvbklEWzFdXS5wcmVzZW50YXRpb24ucmVtb3ZlUmVzdWx0KG9sZFJlc3VsdC5kYXRhKCJyZXF1ZXN0aWQiKSk7DQoNCiAgICAgICAgICAgICAgICBmb3VuZFJlc3VsdCA9ICB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZm91bmRSZXN1bHQ7DQogICAgfSwNCg0KICAgIHJlbW92ZURpc3BsYXlJblBhcmFncmFwaChlKXsNCiAgICAgICAgbGV0IHRhcmdldCA9ICQoZS50YXJnZXQpOw0KICAgICAgICBpZiAodGFyZ2V0Lmxlbmd0aCA+IDApIHsNCg0KICAgICAgICAgICAgbGV0IG9sZFJlc3VsdCA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJy5lYXN5LXJlYWRpbmctcmVzdWx0Jyk7DQogICAgICAgICAgICBpZiAob2xkUmVzdWx0Lmxlbmd0aCkgew0KDQoNCiAgICAgICAgICAgICAgICBsZXQgcHJlc2VudGF0aW9uSUQgPSBvbGRSZXN1bHQuZGF0YSgicHJlc2VudGF0aW9uaWQiKS5zcGxpdCgnLScpOw0KICAgICAgICAgICAgICAgIGVhc3lSZWFkaW5nLnVzZXJJbnRlcmZhY2VzW3ByZXNlbnRhdGlvbklEWzBdXS50b29sc1twcmVzZW50YXRpb25JRFsxXV0ucHJlc2VudGF0aW9uLnJlbW92ZVJlc3VsdChvbGRSZXN1bHQuZGF0YSgicmVxdWVzdGlkIikpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkKGUudGFyZ2V0KS5jaGlsZHJlbignLmVhc3ktcmVhZGluZy1yZXN1bHQnKS5lYWNoKGZ1bmN0aW9uICgpIHsNCg0KICAgICAgICAgICAgICAgIGxldCBwcmVzZW50YXRpb25JRCA9ICQodGhpcykuZGF0YSgicHJlc2VudGF0aW9uaWQiKS5zcGxpdCgnLScpOw0KICAgICAgICAgICAgICAgIGVhc3lSZWFkaW5nLnVzZXJJbnRlcmZhY2VzW3ByZXNlbnRhdGlvbklEWzBdXS50b29sc1twcmVzZW50YXRpb25JRFsxXV0ucHJlc2VudGF0aW9uLnJlbW92ZVJlc3VsdCgkKHRoaXMpLmRhdGEoInJlcXVlc3RpZCIpKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgfSwNCg0KICAgIGdldFBhcmFncmFwaChlKSB7DQogICAgICAgIC8vIGNvbnNvbGUubG9nKCJQYXJhZ3JhcGggYXQgcG9zaXRpb246ICgiICsgZS5jbGllbnRYICsgIiwgIiArIGUuY2xpZW50WSArICIpIik7DQogICAgICAgIGxldCB0YXJnZXQgPSAkKGUudGFyZ2V0KTsNCiAgICAgICAgaWYgKHRhcmdldC5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBsZXQgcGFyYWdyYXBoID0gJyc7DQogICAgICAgICAgICBsZXQgaXRlcmF0b3IgPSBuZXcgSFRNTEl0ZXJhdG9yKHRhcmdldFswXSk7DQogICAgICAgICAgICBsZXQgdGV4dE5vZGVzID0gaXRlcmF0b3IuZ2V0Q2hpbGRUZXh0Tm9kZXModGFyZ2V0WzBdKTsNCiAgICAgICAgICAgIGxldCBwYXJhZ3JhcGhfY29udGFpbmVyID0gaXRlcmF0b3IuZ2V0Q29udGFpbmVyT2ZUZXh0Tm9kZSh0ZXh0Tm9kZXNbMF0pOw0KDQogICAgICAgICAgICBpZighcGFyYWdyYXBoX2NvbnRhaW5lcil7DQogICAgICAgICAgICAgICAgLy9FbGVtZW50IGdvdCByZW1vdmVkLXdhcyBvbGQgcmVzdWx0IC0gZ2V0IG5ldyBlbGVtZW50DQogICAgICAgICAgICAgICAgdGFyZ2V0ID0gJChkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KGUuY2xpZW50WCxlLmNsaWVudFkpKTsNCiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0Lmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgaXRlcmF0b3IgPSBuZXcgSFRNTEl0ZXJhdG9yKHRhcmdldFswXSk7DQogICAgICAgICAgICAgICAgICAgIHRleHROb2RlcyA9IGl0ZXJhdG9yLmdldENoaWxkVGV4dE5vZGVzKHRhcmdldFswXSk7DQogICAgICAgICAgICAgICAgICAgIHBhcmFncmFwaF9jb250YWluZXIgPSBpdGVyYXRvci5nZXRDb250YWluZXJPZlRleHROb2RlKHRleHROb2Rlc1swXSk7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYoIXBhcmFncmFwaF9jb250YWluZXIpew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHBhcmFncmFwaF9jb250YWluZXIubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIHBhcmFncmFwaCA9IHBhcmFncmFwaF9jb250YWluZXJbMF0uaW5uZXJUZXh0LnRyaW0oKS5yZXBsYWNlKC8oXHJcblx0fFxufFxyXHQpL2dtLCAiIik7DQogICAgICAgICAgICAgICAgcGFyYWdyYXBoID0gcGFyYWdyYXBoLnJlcGxhY2UoL1x0L2csICcnKTsNCiAgICAgICAgICAgICAgICAvL1JlbW92ZSAmc2h5OyBldGMNCiAgICAgICAgICAgICAgICBwYXJhZ3JhcGggPSBwYXJhZ3JhcGgucmVwbGFjZSgvW1x1MDBBRFx1MDAyRFx1MjAxMV0rL2csJycpOw0KICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgIHR5cGU6IFBhcmFncmFwaC5jbGFzc05hbWUsDQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiBwYXJhZ3JhcGgsDQogICAgICAgICAgICAgICAgICAgIHdvcmQ6IHBhcmFncmFwaCwNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogcGFyYWdyYXBoX2NvbnRhaW5lclswXSwNCiAgICAgICAgICAgICAgICAgICAgdGV4dE5vZGVzOiBwYWdlVXRpbHMudXRpbC5nZXRUZXh0Tm9kZXMocGFyYWdyYXBoX2NvbnRhaW5lciksDQogICAgICAgICAgICAgICAgICAgIGxhbmc6IHBhZ2VVdGlscy51dGlsLmdldExhbmd1YWdlT2ZFbGVtZW50KHBhcmFncmFwaF9jb250YWluZXJbMF0pLA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcGFyYWdyYXBoID0gdGFyZ2V0LnRleHQoKS50cmltKCkucmVwbGFjZSgvKFxyXG5cdHxcbnxcclx0KS9nbSwgIiIpOw0KICAgICAgICAgICAgICAgIHBhcmFncmFwaCA9IHBhcmFncmFwaC5yZXBsYWNlKC9cdC9nLCAnJyk7DQogICAgICAgICAgICAgICAgLy9SZW1vdmUgJnNoeTsgZXRjDQogICAgICAgICAgICAgICAgcGFyYWdyYXBoID0gcGFyYWdyYXBoLnJlcGxhY2UoL1tcdTAwQURcdTAwMkRcdTIwMTFdKy9nLCcnKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICB0eXBlOiBQYXJhZ3JhcGguY2xhc3NOYW1lLA0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcGFyYWdyYXBoLA0KICAgICAgICAgICAgICAgICAgICB3b3JkOiBwYXJhZ3JhcGgsDQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGUudGFyZ2V0LA0KICAgICAgICAgICAgICAgICAgICB0ZXh0Tm9kZXM6IHBhZ2VVdGlscy51dGlsLmdldFRleHROb2RlcygkKGUudGFyZ2V0KSksDQogICAgICAgICAgICAgICAgICAgIGxhbmc6IHBhZ2VVdGlscy51dGlsLmdldExhbmd1YWdlT2ZFbGVtZW50KGUudGFyZ2V0KSwNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIHR5cGU6IFBhcmFncmFwaC5jbGFzc05hbWUsDQogICAgICAgICAgICAgICAgdmFsdWU6ICcnLA0KICAgICAgICAgICAgICAgIHdvcmQ6ICcnLA0KICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGUudGFyZ2V0LA0KICAgICAgICAgICAgICAgIHRleHROb2RlczogW10sDQogICAgICAgICAgICAgICAgbGFuZzogcGFnZVV0aWxzLnV0aWwuZ2V0TGFuZ3VhZ2VPZkVsZW1lbnQoZS50YXJnZXQpLA0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSwNCg0KICAgIGdldFBhcmFncmFwaFVuZGVyUG9zaXRpb24oeCx5KXsNCiAgICAgICAgbGV0IHRhcmdldCA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoeCwgeSk7DQogICAgICAgIGlmICh0YXJnZXQpIHsNCiAgICAgICAgICAgIHJldHVybiBwYWdlVXRpbHMuZ2V0UGFyYWdyYXBoKHsNCiAgICAgICAgICAgICAgICB0YXJnZXQ6IHRhcmdldCwNCiAgICAgICAgICAgICAgICBjbGllbnRYOiB4LA0KICAgICAgICAgICAgICAgIGNsaWVudFk6IHksDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICB9DQogICAgfSwNCg0KICAgIHdyYXBXb3JkSW46IGZ1bmN0aW9uICh3b3JkLCBlbGVtZW50LCBjbGFzc2VzLGF0dHJpYnV0ZXM9IiIsaWQ9IiIpIHsNCiAgICAgICAgd29yZC50ZXh0Tm9kZXNbd29yZC50ZXh0Tm9kZXMubGVuZ3RoIC0gMV0uc3BsaXRUZXh0KHdvcmQuZW5kICsgMSk7DQoNCiAgICAgICAgaWYgKHdvcmQuYmVnaW4gIT09IDApIHsNCiAgICAgICAgICAgIHdvcmQudGV4dE5vZGVzWzBdID0gd29yZC50ZXh0Tm9kZXNbMF0uc3BsaXRUZXh0KHdvcmQuYmVnaW4pOw0KDQogICAgICAgIH0NCg0KICAgICAgICBsZXQgaWRTdHJpbmc9ICIiOw0KICAgICAgICBpZihpZCl7DQogICAgICAgICAgICBpZFN0cmluZyA9ICIgaWQ9JyIgKyBpZCArICInICI7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gKCQod29yZC50ZXh0Tm9kZXMpLndyYXAoIjwiICsgZWxlbWVudCArIGlkU3RyaW5nICsgIiBjbGFzcz0nIiArIGNsYXNzZXMgKyAiJyAiK2F0dHJpYnV0ZXMrIj48LyIgKyBlbGVtZW50ICsgIj4iKS5wYXJlbnQoKSk7DQogICAgICAgIC8qZm9yKGxldCBpPTA7IGkgPCB3b3JkLnRleHROb2Rlcy5sZW5ndGg7IGkrKyl7DQogICAgICAgICAgICAkKCB3b3JkLnRleHROb2Rlc1tpXSApLndyYXAoICI8IitlbGVtZW50KyIgY2xhc3M9JyIrY2xhc3NlcysiJz48LyIrZWxlbWVudCsiPiIgKTsNCg0KICAgICAgICB9Ki8NCiAgICB9LA0KDQogICAgZ2V0U2VsZWN0ZWRUZXh0OiBmdW5jdGlvbiAoKSB7DQogICAgICAgIGxldCB0ZXh0Tm9kZXMgPSBwYWdlVXRpbHMudXRpbC5nZXRTZWxlY3RlZFRleHROb2RlcygpOw0KICAgICAgICBsZXQgdGV4dCA9ICIiOw0KICAgICAgICBpZih0ZXh0Tm9kZXMubGVuZ3RoID4gMCl7DQogICAgICAgICAgICBmb3IobGV0IGk9MDsgaSA8IHRleHROb2Rlcy5sZW5ndGg7IGkrKyl7DQogICAgICAgICAgICAgICAgdGV4dCs9dGV4dE5vZGVzW2ldLnRleHRDb250ZW50Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIHRleHROb2RlcyA9IG51bGw7DQogICAgICAgIH0NCg0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICB0eXBlOiBQYXJhZ3JhcGguY2xhc3NOYW1lLA0KICAgICAgICAgICAgdmFsdWU6IHRleHQsDQogICAgICAgICAgICB3b3JkOiB0ZXh0LA0KICAgICAgICAgICAgZWxlbWVudDogdGV4dE5vZGVzLA0KICAgICAgICAgICAgdGV4dE5vZGVzOiB0ZXh0Tm9kZXMsDQogICAgICAgICAgICBsYW5nOiBwYWdlVXRpbHMudXRpbC5nZXRMYW5ndWFnZU9mRWxlbWVudCh0ZXh0Tm9kZXNbMF0pLA0KDQogICAgICAgIH0NCg0KICAgIH0sDQogICAgZ2V0UGFyZW50QmxvY2tDb250YWluZXJGcm9tTm9kZTpmdW5jdGlvbihub2RlKSB7DQogICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSkgew0KICAgICAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50RWxlbWVudDsNCiAgICAgICAgfQ0KDQogICAgICAgIHdoaWxlICghcGFnZVV0aWxzLnV0aWwuaXNCbG9ja0Rpc3BsYXkobm9kZSkpIHsNCiAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudEVsZW1lbnQ7DQoNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBub2RlOw0KDQogICAgfSwNCiAgICB1dGlsOiB7DQoNCg0KICAgICAgICBpc0Jsb2NrRGlzcGxheTpmdW5jdGlvbihlbGVtZW50KSB7DQogICAgICAgICAgICBpZiAoZWxlbWVudC5zdHlsZS5kaXNwbGF5KSB7DQogICAgICAgICAgICAgICAgc3dpdGNoIChlbGVtZW50LnN0eWxlLmRpc3BsYXkudG9Mb3dlckNhc2UoKSkgew0KICAgICAgICAgICAgICAgICAgICBjYXNlICJibG9jayI6DQogICAgICAgICAgICAgICAgICAgIGNhc2UgImZsZXgiOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICJncmlkIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAibGlzdC1pdGVtIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAicnVuLWluIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAidGFibGUiOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICJ0YWJsZS1jYXB0aW9uIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAidGFibGUtY29sdW1uLWdyb3VwIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAidGFibGUtaGVhZGVyLWdyb3VwIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAidGFibGUtZm9vdGVyLWdyb3VwIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAidGFibGUtcm93LWdyb3VwIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAidGFibGUtY2VsbCI6DQogICAgICAgICAgICAgICAgICAgIGNhc2UgInRhYmxlLWNvbHVtbiI6DQogICAgICAgICAgICAgICAgICAgIGNhc2UgInRhYmxlLXJvdyI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHN3aXRjaCAoZWxlbWVudC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKSB7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgImJvZHkiOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICJoMSI6DQogICAgICAgICAgICAgICAgICAgIGNhc2UgImgyIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAiaDMiOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICJoNCI6DQogICAgICAgICAgICAgICAgICAgIGNhc2UgImg1IjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAiaDYiOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICJwIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAiZGl2IjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAidWwiOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICJvbCI6DQogICAgICAgICAgICAgICAgICAgIGNhc2UgImxpIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAiZGwiOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICJkdCI6DQogICAgICAgICAgICAgICAgICAgIGNhc2UgImRkIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAidGgiOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICJ0ZCI6DQogICAgICAgICAgICAgICAgICAgIGNhc2UgInRyIjoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAidGhlYWQiOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICJ0Ym9keSI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSwNCg0KICAgICAgICB1bmljb2RlV29yZDogWFJlZ0V4cCgnXlxccEwrJCcpLA0KICAgICAgICB1bmljb2RlQ2hhcjogWFJlZ0V4cCgnXlxccEwrJCcpLA0KICAgICAgICB1bmljb2RlUHVuY3R1YXRpb246IFhSZWdFeHAoIl5cXHB7UH0iKSwNCg0KICAgICAgICBnZXRTZWxlY3RlZFRleHROb2RlczpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBsZXQgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpOw0KICAgICAgICAgICAgaWYoc2VsZWN0aW9uLnJhbmdlQ291bnQgPT09IDApew0KICAgICAgICAgICAgICAgIHJldHVybiBbXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgbGV0IHRleHROb2RlcyA9IFtdOw0KDQoNCiAgICAgICAgICAgIGZvcihsZXQgaT0wOyBpIDwgc2VsZWN0aW9uLnJhbmdlQ291bnQ7IGkrKyl7DQogICAgICAgICAgICAgICAgbGV0IHJhbmdlID0gc2VsZWN0aW9uLmdldFJhbmdlQXQoaSk7DQoNCiAgICAgICAgICAgICAgICBsZXQgc3RhcnROb2RlID0gcmFuZ2Uuc3RhcnRDb250YWluZXI7DQogICAgICAgICAgICAgICAgLy9TcGxpdCB0ZXh0IGF0IHN0YXJ0DQogICAgICAgICAgICAgICAgaWYocmFuZ2Uuc3RhcnRDb250YWluZXIubm9kZU5hbWUgPT09ICcjdGV4dCcpew0KICAgICAgICAgICAgICAgICAgICBpZihyYW5nZS5zdGFydENvbnRhaW5lci5sZW5ndGggPT09IHJhbmdlLnN0YXJ0T2Zmc2V0KXsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnROb2RlID0gcmFuZ2Uuc3RhcnRDb250YWluZXIubmV4dFNpYmxpbmc7DQoNCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0Tm9kZSA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyLnNwbGl0VGV4dChyYW5nZS5zdGFydE9mZnNldCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBsZXQgZW5kTm9kZSA9IG51bGw7DQogICAgICAgICAgICAgICAgaWYocmFuZ2UuZW5kQ29udGFpbmVyLm5vZGVOYW1lID09PSAnI3RleHQnKXsNCg0KICAgICAgICAgICAgICAgICAgICBpZihyYW5nZS5lbmRDb250YWluZXIubGVuZ3RoICE9PSByYW5nZS5lbmRPZmZzZXQpew0KDQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5lbmRDb250YWluZXIuc3BsaXRUZXh0KHJhbmdlLmVuZE9mZnNldCk7DQoNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbmROb2RlID0gcmFuZ2UuZW5kQ29udGFpbmVyOw0KICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyTm9kZXMgPSBwYWdlVXRpbHMudXRpbC5nZXRDaGlsZFRleHROb2RlcyhyYW5nZS5lbmRDb250YWluZXIpOw0KDQogICAgICAgICAgICAgICAgICAgIGVuZE5vZGUgPSBjb250YWluZXJOb2Rlc1tjb250YWluZXJOb2Rlcy5sZW5ndGgtMV07DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdGV4dE5vZGVzID0gdGV4dE5vZGVzLmNvbmNhdCggcGFnZVV0aWxzLnV0aWwuZ2V0VGV4dE5vZGVzQmV0d2VlblJhbmdlKHN0YXJ0Tm9kZSwgZW5kTm9kZSkpOw0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiB0ZXh0Tm9kZXM7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBnZXRUZXh0Tm9kZXNCZXR3ZWVuUmFuZ2U6IGZ1bmN0aW9uIChub2RlLCBlbmROb2RlLCByZXN1bHQpIHsNCiAgICAgICAgICAgIGlmICghcmVzdWx0KSB7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gW107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChlbmROb2RlID09PSBub2RlKSB7DQogICAgICAgICAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgICE9PSAnI3RleHQnKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhZ2VVdGlscy51dGlsLmdldENoaWxkVGV4dE5vZGVzKG5vZGUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChlbmROb2RlKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAobm9kZS5ub2RlTmFtZSA9PT0gJyN0ZXh0Jykgew0KICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKG5vZGUpOw0KICAgICAgICAgICAgICAgIGlmIChub2RlLm5leHRTaWJsaW5nKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAgcGFnZVV0aWxzLnV0aWwuZ2V0VGV4dE5vZGVzQmV0d2VlblJhbmdlKG5vZGUubmV4dFNpYmxpbmcsIGVuZE5vZGUsIHJlc3VsdCk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dFBhcmVudE5vZGUgPSBwYWdlVXRpbHMudXRpbC5nZXROZXh0UGFyZW50Tm9kZShub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgaWYobmV4dFBhcmVudE5vZGUpew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhZ2VVdGlscy51dGlsLmdldFRleHROb2Rlc0JldHdlZW5SYW5nZShuZXh0UGFyZW50Tm9kZSwgZW5kTm9kZSwgcmVzdWx0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAvL1RoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbiAtIGJ1dCBqdXN0IGluIGNhc2UuLi4uDQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgICAgICAgaWYgKG5vZGUuZmlyc3RDaGlsZCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gIHBhZ2VVdGlscy51dGlsLmdldFRleHROb2Rlc0JldHdlZW5SYW5nZShub2RlLmZpcnN0Q2hpbGQsIGVuZE5vZGUsIHJlc3VsdCk7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlLm5leHRTaWJsaW5nKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAgcGFnZVV0aWxzLnV0aWwuZ2V0VGV4dE5vZGVzQmV0d2VlblJhbmdlKG5vZGUubmV4dFNpYmxpbmcsIGVuZE5vZGUsIHJlc3VsdCk7DQogICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICBsZXQgbmV4dFBhcmVudE5vZGUgPSAgcGFnZVV0aWxzLnV0aWwuZ2V0TmV4dFBhcmVudE5vZGUobm9kZSk7DQogICAgICAgICAgICAgICAgaWYobmV4dFBhcmVudE5vZGUpew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFnZVV0aWxzLnV0aWwuZ2V0VGV4dE5vZGVzQmV0d2VlblJhbmdlKG5leHRQYXJlbnROb2RlLCBlbmROb2RlLCByZXN1bHQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvL1RoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbiAtIGJ1dCBqdXN0IGluIGNhc2UuLi4uDQogICAgICAgICAgICAgICAgcmV0dXJuIFtdOw0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSwNCg0KICAgICAgICBnZXROZXh0UGFyZW50Tm9kZSA6IGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICBsZXQgY3VycmVudE5vZGUgPSBub2RlOw0KDQogICAgICAgICAgICB3aGlsZSAoY3VycmVudE5vZGUucGFyZW50Tm9kZSkgew0KDQogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnROb2RlLnBhcmVudE5vZGUubmV4dFNpYmxpbmcpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnROb2RlLnBhcmVudE5vZGUubmV4dFNpYmxpbmc7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5wYXJlbnROb2RlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBpc1c6IGZ1bmN0aW9uIChzKSB7DQoNCiAgICAgICAgICAgIC8vJnNoeTsgZXRjDQogICAgICAgICAgICBpZiAocy5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KSA9PT0gImFkIikgew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICByZXR1cm4gIXBhZ2VVdGlscy51dGlsLnVuaWNvZGVXb3JkLnRlc3Qocyk7DQoNCiAgICAgICAgICAgIC8qDQogICAgICAgICAgICBpZihzPT09IiAiKXsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIC9bIFxmXG5cclx0XHZcdTAwQTBcdTIwMjhcdTIwMjldLy50ZXN0KHMpOw0KICAgICAgICAgICAgKi8NCiAgICAgICAgfSwNCg0KICAgICAgICBpc0JhcnJpZXJOb2RlOiBmdW5jdGlvbiAobm9kZSkgew0KDQogICAgICAgICAgICByZXR1cm4gbm9kZSA/IC9eKEJSfERJVnxQfFBSRXxURHxUUnxUQUJMRXxIRUFEfEJPRFkpJC9pLnRlc3Qobm9kZS5ub2RlTmFtZSkgOiB0cnVlOw0KICAgICAgICB9LA0KDQogICAgICAgIGdldE5leHROb2RlOiBmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICAgICAgbGV0IG4gPSBudWxsOw0KDQogICAgICAgICAgICAvLyBEb2VzIHRoaXMgbm9kZSBoYXZlIGEgc2libGluZz8NCiAgICAgICAgICAgIGlmIChub2RlLm5leHRTaWJsaW5nKSB7DQogICAgICAgICAgICAgICAgbiA9IG5vZGUubmV4dFNpYmxpbmc7DQoNCiAgICAgICAgICAgICAgICAvLyBEb2UgdGhpcyBub2RlJ3MgY29udGFpbmVyIGhhdmUgYSBzaWJsaW5nPw0KICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlLnBhcmVudE5vZGUgJiYgbm9kZS5wYXJlbnROb2RlLm5leHRTaWJsaW5nKSB7DQogICAgICAgICAgICAgICAgaWYgKCFwYWdlVXRpbHMudXRpbC5pc0JhcnJpZXJOb2RlKG5vZGUucGFyZW50Tm9kZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgbiA9IG5vZGUucGFyZW50Tm9kZS5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBwYWdlVXRpbHMudXRpbC5pc0JhcnJpZXJOb2RlKG4pID8gbnVsbCA6IG47DQogICAgICAgIH0sDQoNCiAgICAgICAgZ2V0UHJldk5vZGU6IGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICBsZXQgbiA9IG51bGw7DQoNCiAgICAgICAgICAgIC8vIERvZXMgdGhpcyBub2RlIGhhdmUgYSBzaWJsaW5nPw0KICAgICAgICAgICAgaWYgKG5vZGUucHJldmlvdXNTaWJsaW5nKSB7DQogICAgICAgICAgICAgICAgbiA9IG5vZGUucHJldmlvdXNTaWJsaW5nOw0KDQogICAgICAgICAgICAgICAgLy8gRG9lcyB0aGlzIG5vZGUncyBjb250YWluZXIgaGF2ZSBhIHNpYmxpbmc/DQogICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGUucGFyZW50Tm9kZSAmJiBub2RlLnBhcmVudE5vZGUucHJldmlvdXNTaWJsaW5nKSB7DQogICAgICAgICAgICAgICAgaWYgKCFwYWdlVXRpbHMudXRpbC5pc0JhcnJpZXJOb2RlKG5vZGUucGFyZW50Tm9kZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgbiA9IG5vZGUucGFyZW50Tm9kZS5wcmV2aW91c1NpYmxpbmc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHBhZ2VVdGlscy51dGlsLmlzQmFycmllck5vZGUobikgPyBudWxsIDogbjsNCiAgICAgICAgfSwNCg0KDQogICAgICAgIGdldFRleHROb2RlczogZnVuY3Rpb24gKG5vZGVzKSB7DQoNCiAgICAgICAgICAgIGxldCB0ZXh0Tm9kZXMgPSBbXTsNCg0KDQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7DQoNCiAgICAgICAgICAgICAgICBpZiAobm9kZXNbaV0ubm9kZU5hbWUgIT09ICcjdGV4dCcpIHsNCg0KICAgICAgICAgICAgICAgICAgICB0ZXh0Tm9kZXMgPSB0ZXh0Tm9kZXMuY29uY2F0KHBhZ2VVdGlscy51dGlsLmdldENoaWxkVGV4dE5vZGVzKG5vZGVzW2ldKSkNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB0ZXh0Tm9kZXMucHVzaChub2Rlc1tpXSk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiB0ZXh0Tm9kZXM7DQogICAgICAgIH0sDQoNCiAgICAgICAgZ2V0Q2hpbGRUZXh0Tm9kZXM6IGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICBsZXQgdGV4dE5vZGVzID0gW107DQoNCiAgICAgICAgICAgIGxldCBjaGlsZE5vZGVzID0gbm9kZS5jaGlsZE5vZGVzOw0KICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZE5vZGVzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgaWYgKGNoaWxkTm9kZXNbaV0ubm9kZU5hbWUgIT09ICcjdGV4dCcpIHsNCiAgICAgICAgICAgICAgICAgICAgdGV4dE5vZGVzID0gdGV4dE5vZGVzLmNvbmNhdChwYWdlVXRpbHMudXRpbC5nZXRDaGlsZFRleHROb2RlcyhjaGlsZE5vZGVzW2ldKSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICB0ZXh0Tm9kZXMucHVzaChjaGlsZE5vZGVzW2ldKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gdGV4dE5vZGVzOw0KDQogICAgICAgIH0sDQoNCiAgICAgICAgZ2V0VGV4dFJhbmdlQm91bmRhcnlQb3NpdGlvbjogZnVuY3Rpb24gKHRleHRSYW5nZSwgaXNTdGFydCkgew0KDQogICAgICAgICAgICBsZXQgd29ya2luZ1JhbmdlID0gdGV4dFJhbmdlLmR1cGxpY2F0ZSgpOw0KICAgICAgICAgICAgd29ya2luZ1JhbmdlLmNvbGxhcHNlKGlzU3RhcnQpOw0KICAgICAgICAgICAgbGV0IGNvbnRhaW5lckVsZW1lbnQgPSB3b3JraW5nUmFuZ2UucGFyZW50RWxlbWVudCgpOw0KICAgICAgICAgICAgbGV0IHdvcmtpbmdOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3BhbiIpOw0KICAgICAgICAgICAgbGV0IGNvbXBhcmlzb24sIHdvcmtpbmdDb21wYXJpc29uVHlwZSA9IGlzU3RhcnQgPw0KICAgICAgICAgICAgICAgICJTdGFydFRvU3RhcnQiIDogIlN0YXJ0VG9FbmQiOw0KDQogICAgICAgICAgICBsZXQgYm91bmRhcnlQb3NpdGlvbiwgYm91bmRhcnlOb2RlOw0KDQogICAgICAgICAgICAvLyBNb3ZlIHRoZSB3b3JraW5nIHJhbmdlIHRocm91Z2ggdGhlIGNvbnRhaW5lcidzIGNoaWxkcmVuLCBzdGFydGluZyBhdA0KICAgICAgICAgICAgLy8gdGhlIGVuZCBhbmQgd29ya2luZyBiYWNrd2FyZHMsIHVudGlsIHRoZSB3b3JraW5nIHJhbmdlIHJlYWNoZXMgb3IgZ29lcw0KICAgICAgICAgICAgLy8gcGFzdCB0aGUgYm91bmRhcnkgd2UncmUgaW50ZXJlc3RlZCBpbg0KICAgICAgICAgICAgZG8gew0KICAgICAgICAgICAgICAgIGNvbnRhaW5lckVsZW1lbnQuaW5zZXJ0QmVmb3JlKHdvcmtpbmdOb2RlLCB3b3JraW5nTm9kZS5wcmV2aW91c1NpYmxpbmcpOw0KICAgICAgICAgICAgICAgIHdvcmtpbmdSYW5nZS5tb3ZlVG9FbGVtZW50VGV4dCh3b3JraW5nTm9kZSk7DQogICAgICAgICAgICB9IHdoaWxlICgoY29tcGFyaXNvbiA9IHdvcmtpbmdSYW5nZS5jb21wYXJlRW5kUG9pbnRzKA0KICAgICAgICAgICAgICAgIHdvcmtpbmdDb21wYXJpc29uVHlwZSwgdGV4dFJhbmdlKSkgPiAwICYmIHdvcmtpbmdOb2RlLnByZXZpb3VzU2libGluZyk7DQoNCiAgICAgICAgICAgIC8vIFdlJ3ZlIG5vdyByZWFjaGVkIG9yIGdvbmUgcGFzdCB0aGUgYm91bmRhcnkgb2YgdGhlIHRleHQgcmFuZ2Ugd2UncmUNCiAgICAgICAgICAgIC8vIGludGVyZXN0ZWQgaW4gc28gaGF2ZSBpZGVudGlmaWVkIHRoZSBub2RlIHdlIHdhbnQNCiAgICAgICAgICAgIGJvdW5kYXJ5Tm9kZSA9IHdvcmtpbmdOb2RlLm5leHRTaWJsaW5nOw0KICAgICAgICAgICAgaWYgKGNvbXBhcmlzb24gPT09IC0xICYmIGJvdW5kYXJ5Tm9kZSkgew0KICAgICAgICAgICAgICAgIC8vIFRoaXMgbXVzdCBiZSBhIGRhdGEgbm9kZSAodGV4dCwgY29tbWVudCwgY2RhdGEpIHNpbmNlIHdlJ3ZlIG92ZXJzaG90Lg0KICAgICAgICAgICAgICAgIC8vIFRoZSB3b3JraW5nIHJhbmdlIGlzIGNvbGxhcHNlZCBhdCB0aGUgc3RhcnQgb2YgdGhlIG5vZGUgY29udGFpbmluZw0KICAgICAgICAgICAgICAgIC8vIHRoZSB0ZXh0IHJhbmdlJ3MgYm91bmRhcnksIHNvIHdlIG1vdmUgdGhlIGVuZCBvZiB0aGUgd29ya2luZyByYW5nZQ0KICAgICAgICAgICAgICAgIC8vIHRvIHRoZSBib3VuZGFyeSBwb2ludCBhbmQgbWVhc3VyZSB0aGUgbGVuZ3RoIG9mIGl0cyB0ZXh0IHRvIGdldA0KICAgICAgICAgICAgICAgIC8vIHRoZSBib3VuZGFyeSdzIG9mZnNldCB3aXRoaW4gdGhlIG5vZGUNCiAgICAgICAgICAgICAgICB3b3JraW5nUmFuZ2Uuc2V0RW5kUG9pbnQoaXNTdGFydCA/ICJFbmRUb1N0YXJ0IiA6ICJFbmRUb0VuZCIsIHRleHRSYW5nZSk7DQoNCiAgICAgICAgICAgICAgICBib3VuZGFyeVBvc2l0aW9uID0gew0KICAgICAgICAgICAgICAgICAgICBub2RlOiBib3VuZGFyeU5vZGUsDQogICAgICAgICAgICAgICAgICAgIG9mZnNldDogd29ya2luZ1JhbmdlLnRleHQubGVuZ3RoDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy8gV2UndmUgaGl0IHRoZSBib3VuZGFyeSBleGFjdGx5LCBzbyB0aGlzIG11c3QgYmUgYW4gZWxlbWVudA0KICAgICAgICAgICAgICAgIGJvdW5kYXJ5UG9zaXRpb24gPSB7DQogICAgICAgICAgICAgICAgICAgIG5vZGU6IGNvbnRhaW5lckVsZW1lbnQsDQogICAgICAgICAgICAgICAgICAgIG9mZnNldDogZ2V0Q2hpbGRJbmRleCh3b3JraW5nTm9kZSkNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBDbGVhbiB1cA0KICAgICAgICAgICAgd29ya2luZ05vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh3b3JraW5nTm9kZSk7DQoNCiAgICAgICAgICAgIHJldHVybiBib3VuZGFyeVBvc2l0aW9uOw0KDQogICAgICAgIH0sDQogICAgICAgIGdldExhbmd1YWdlT2ZFbGVtZW50KGVsZW1lbnQpIHsNCg0KICAgICAgICAgICAgaWYgKHR5cGVvZiBlbGVtZW50ID09PSAidW5kZWZpbmVkIikgew0KICAgICAgICAgICAgICAgIHJldHVybiAidW5kZWZpbmVkIjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKHR5cGVvZiBlbGVtZW50LmxhbmcgPT09ICJ1bmRlZmluZWQiIHx8IGVsZW1lbnQubGFuZyA9PT0gIiIpIHsNCg0KDQogICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQucGFyZW50Tm9kZSAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFnZVV0aWxzLnV0aWwuZ2V0TGFuZ3VhZ2VPZkVsZW1lbnQoZWxlbWVudC5wYXJlbnROb2RlKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAvL1JldHVybiBlbmdsaXNoIGFzIGRlZmF1bHQgbGFuZ3VhZ2UNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJ1bmRlZmluZWQiOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gZWxlbWVudC5sYW5nOw0KDQogICAgICAgIH0sDQoNCiAgICB9LA0KDQoNCiAgICBnZXRTZW50ZW5jZVVuZGVyUG9zaXRpb246IGZ1bmN0aW9uICh4LCB5KSB7DQogICAgICAgIGxldCByYW5nZSwgdGV4dE5vZGUsIG9mZnNldDsNCiAgICAgICAgLy8gSW50ZXJuZXQgRXhwbG9yZXINCiAgICAgICAgaWYgKGRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIHJhbmdlID0gZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UoKTsNCiAgICAgICAgICAgICAgICByYW5nZS5tb3ZlVG9Qb2ludCh4LCB5KTsNCiAgICAgICAgICAgICAgICByYW5nZS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICByYW5nZSA9IHBhZ2VVdGlscy51dGlsLmdldFRleHRSYW5nZUJvdW5kYXJ5UG9zaXRpb24ocmFuZ2UsIHRydWUpOw0KDQogICAgICAgICAgICAgICAgdGV4dE5vZGUgPSByYW5nZS5ub2RlOw0KICAgICAgICAgICAgICAgIG9mZnNldCA9IHJhbmdlLm9mZnNldDsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gIiI7IC8vIFNpZ2gsIElFDQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gRmlyZWZveCwgU2FmYXJpDQogICAgICAgIC8vIFJFRjogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0RvY3VtZW50L2NhcmV0UG9zaXRpb25Gcm9tUG9pbnQNCiAgICAgICAgZWxzZSBpZiAoZG9jdW1lbnQuY2FyZXRQb3NpdGlvbkZyb21Qb2ludCkgew0KICAgICAgICAgICAgcmFuZ2UgPSBkb2N1bWVudC5jYXJldFBvc2l0aW9uRnJvbVBvaW50KHgsIHkpOw0KICAgICAgICAgICAgdGV4dE5vZGUgPSByYW5nZS5vZmZzZXROb2RlOw0KICAgICAgICAgICAgb2Zmc2V0ID0gcmFuZ2Uub2Zmc2V0Ow0KDQogICAgICAgICAgICAvLyBDaHJvbWUNCiAgICAgICAgICAgIC8vIFJFRjogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL2RvY3VtZW50L2NhcmV0UmFuZ2VGcm9tUG9pbnQNCiAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5jYXJldFJhbmdlRnJvbVBvaW50KSB7DQogICAgICAgICAgICByYW5nZSA9IGRvY3VtZW50LmNhcmV0UmFuZ2VGcm9tUG9pbnQoeCwgeSk7DQogICAgICAgICAgICB0ZXh0Tm9kZSA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyOw0KICAgICAgICAgICAgb2Zmc2V0ID0gcmFuZ2Uuc3RhcnRPZmZzZXQ7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBPbmx5IGFjdCBvbiB0ZXh0IG5vZGVzDQogICAgICAgIGlmICghdGV4dE5vZGUgfHwgdGV4dE5vZGUubm9kZVR5cGUgIT09IE5vZGUuVEVYVF9OT0RFKSB7DQogICAgICAgICAgICByZXR1cm4gIiI7DQogICAgICAgIH0NCg0KICAgICAgICBsZXQgZGF0YSA9IHRleHROb2RlLnRleHRDb250ZW50Ow0KDQogICAgICAgIC8vIFNvbWV0aW1lcyB0aGUgb2Zmc2V0IGNhbiBiZSBhdCB0aGUgJ2xlbmd0aCcgb2YgdGhlIGRhdGEuDQogICAgICAgIC8vIEl0IG1pZ2h0IGJlIGEgYnVnIHdpdGggdGhpcyAnZXhwZXJpbWVudGFsJyBmZWF0dXJlDQogICAgICAgIC8vIENvbXBlbnNhdGUgZm9yIHRoaXMgYmVsb3cNCiAgICAgICAgaWYgKG9mZnNldCA+PSBkYXRhLmxlbmd0aCkgew0KICAgICAgICAgICAgb2Zmc2V0ID0gZGF0YS5sZW5ndGggLSAxOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gSWdub3JlIHRoZSBjdXJzb3Igb24gc3BhY2VzIC0gdGhlc2UgYXJlbid0IHdvcmRzDQogICAgICAgIGlmIChwYWdlVXRpbHMudXRpbC5pc1coZGF0YVtvZmZzZXRdKSkgew0KICAgICAgICAgICAgcmV0dXJuICIiOw0KICAgICAgICB9DQoNCg0KICAgIH0NCg0KfTsNCg0KY2xhc3MgVGV4dFNlbGVjdGlvbiB7DQogICAgY29uc3RydWN0b3IodGV4dE5vZGVzLCBtYXhUZXh0TGVuZ3RoID0gMCkgew0KDQogICAgICAgIHRoaXMudGV4dE5vZGVzID0gdGV4dE5vZGVzOw0KICAgICAgICB0aGlzLm1heFRleHRMZW5ndGggPSBtYXhUZXh0TGVuZ3RoOw0KICAgICAgICB0aGlzLnRleHRMZW5ndGggPSAwOw0KDQogICAgICAgIGlmICh0ZXh0Tm9kZXNbMF0pIHsNCg0KICAgICAgICAgICAgdGhpcy5jdXJyZW50VGV4dE5vZGUgPSB0ZXh0Tm9kZXNbMF07DQoNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuY3VycmVudFRleHROb2RlID0gbnVsbDsNCiAgICAgICAgfQ0KDQogICAgICAgIHRoaXMudGV4dExlbmd0aCA9IHRoaXMuY2FsY3VsYXRlVGV4dExlbmd0aCgpOw0KDQoNCg0KICAgIH0NCg0KDQogICAgY2FsY3VsYXRlVGV4dExlbmd0aChmcm9tSW5kZXggPSAwKSB7DQoNCiAgICAgICAgbGV0IHRleHRMZW5ndGggPSAwOw0KICAgICAgICBmb3IgKGxldCBpID0gZnJvbUluZGV4OyBpIDwgdGhpcy50ZXh0Tm9kZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIHRleHRMZW5ndGggKz0gdGhpcy50ZXh0Tm9kZXNbaV0udGV4dENvbnRlbnQubGVuZ3RoOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRleHRMZW5ndGg7DQogICAgfQ0KDQogICAgZ2V0QmxvY2tDb250YWluZXJzRnJvbVRleHROb2RlcygpIHsNCg0KICAgICAgICBsZXQgYmxvY2tOb2RlcyA9IFtdOw0KDQogICAgICAgIGxldCBjdXJyZW50QmxvY2tOb2RlID0gbnVsbDsNCg0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudGV4dE5vZGVzLmxlbmd0aDsgaSsrKSB7DQoNCg0KICAgICAgICAgICAgbGV0IG5leHRCbG9ja05vZGUgPSB0aGlzLmdldFBhcmVudEJsb2NrQ29udGFpbmVyRnJvbU5vZGUodGhpcy50ZXh0Tm9kZXNbaV0pOw0KDQogICAgICAgICAgICBpZiAobmV4dEJsb2NrTm9kZSAhPT0gY3VycmVudEJsb2NrTm9kZSkgew0KDQogICAgICAgICAgICAgICAgaWYgKHRoaXMuY29udGFpbnNUZXh0Q29udGVudCh0aGlzLnRleHROb2Rlc1tpXSkpIHsNCg0KICAgICAgICAgICAgICAgICAgICBibG9ja05vZGVzLnB1c2gobmV4dEJsb2NrTm9kZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGN1cnJlbnRCbG9ja05vZGUgPSBuZXh0QmxvY2tOb2RlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KDQogICAgfQ0KDQogICAgZ2V0TmV4dEJsb2NrRGlzcGxheU5vZGVzRnJvbU5vZGUobm9kZSkgew0KDQogICAgICAgIGxldCBjdXJyZW50VGV4dE5vZGVJbmRleCA9IHRoaXMudGV4dE5vZGVzLmluZGV4T2Yobm9kZSk7DQoNCiAgICAgICAgbGV0IGNvbm5lY3RlZFRleHROb2RlcyA9IFtdOw0KICAgICAgICBsZXQgdGV4dENvbnRlbnRMZW5ndGggPSAwOw0KICAgICAgICBsZXQgdGV4dCA9ICIiOw0KICAgICAgICBpZiAoY3VycmVudFRleHROb2RlSW5kZXggIT09IC0xKSB7DQogICAgICAgICAgICBsZXQgY3VycmVudEJsb2NrTm9kZSA9IHRoaXMuZ2V0UGFyZW50QmxvY2tDb250YWluZXJGcm9tTm9kZSh0aGlzLnRleHROb2Rlc1tjdXJyZW50VGV4dE5vZGVJbmRleF0pOw0KDQogICAgICAgICAgICBmb3IgKGxldCBpID0gY3VycmVudFRleHROb2RlSW5kZXg7IGkgPCB0aGlzLnRleHROb2Rlcy5sZW5ndGg7IGkrKykgew0KDQogICAgICAgICAgICAgICAgbGV0IG5leHRCbG9ja05vZGUgPSB0aGlzLmdldFBhcmVudEJsb2NrQ29udGFpbmVyRnJvbU5vZGUodGhpcy50ZXh0Tm9kZXNbaV0pOw0KDQogICAgICAgICAgICAgICAgaWYgKG5leHRCbG9ja05vZGUgIT09IGN1cnJlbnRCbG9ja05vZGUpIHsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb250YWluc1RleHRDb250ZW50KHRoaXMudGV4dE5vZGVzW2ldKSkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0SW5kZXg6IGN1cnJlbnRUZXh0Tm9kZUluZGV4LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRJbmRleDogaSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0QmxvY2s6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbnRlbnRMZW5ndGg6IHRleHRDb250ZW50TGVuZ3RoLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHROb2RlczogY29ubmVjdGVkVGV4dE5vZGVzDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgY3VycmVudEJsb2NrTm9kZSA9IG5leHRCbG9ja05vZGU7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdGV4dCArPSB0aGlzLnRleHROb2Rlc1tpXS50ZXh0Q29udGVudDsNCiAgICAgICAgICAgICAgICB0ZXh0Q29udGVudExlbmd0aCArPSB0aGlzLnRleHROb2Rlc1tpXS50ZXh0Q29udGVudC5sZW5ndGg7DQogICAgICAgICAgICAgICAgY29ubmVjdGVkVGV4dE5vZGVzLnB1c2godGhpcy50ZXh0Tm9kZXNbaV0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBzdGFydEluZGV4OiBjdXJyZW50VGV4dE5vZGVJbmRleCwNCiAgICAgICAgICAgIG5leHRJbmRleDogdGhpcy50ZXh0Tm9kZXMubGVuZ3RoLA0KICAgICAgICAgICAgbGFzdEJsb2NrOiB0cnVlLA0KICAgICAgICAgICAgdGV4dDogdGV4dCwNCiAgICAgICAgICAgIHRleHRDb250ZW50TGVuZ3RoOiB0ZXh0Q29udGVudExlbmd0aCwNCiAgICAgICAgICAgIHRleHROb2RlczogY29ubmVjdGVkVGV4dE5vZGVzDQogICAgICAgIH07DQogICAgfQ0KDQogICAgY29udGFpbnNUZXh0Q29udGVudChub2RlKSB7DQoNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2RlLnRleHRDb250ZW50Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBpZiAocGFnZVV0aWxzLnV0aWwudW5pY29kZUNoYXIudGVzdChub2RlLnRleHRDb250ZW50W2ldKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiBmYWxzZTsNCg0KICAgIH0NCg0KICAgIGdldFBhcmVudEJsb2NrQ29udGFpbmVyRnJvbU5vZGUobm9kZSkgew0KICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHsNCiAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudEVsZW1lbnQ7DQogICAgICAgIH0NCg0KICAgICAgICB3aGlsZSAoIXRoaXMuaXNCbG9ja0Rpc3BsYXkobm9kZSkpIHsNCiAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudEVsZW1lbnQ7DQoNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBub2RlOw0KDQogICAgfQ0KDQogICAgaXNCbG9ja0Rpc3BsYXkoZWxlbWVudCkgew0KICAgICAgICBpZiAoZWxlbWVudC5zdHlsZS5kaXNwbGF5KSB7DQogICAgICAgICAgICBzd2l0Y2ggKGVsZW1lbnQuc3R5bGUuZGlzcGxheS50b0xvd2VyQ2FzZSgpKSB7DQogICAgICAgICAgICAgICAgY2FzZSAiYmxvY2siOg0KICAgICAgICAgICAgICAgIGNhc2UgImZsZXgiOg0KICAgICAgICAgICAgICAgIGNhc2UgImdyaWQiOg0KICAgICAgICAgICAgICAgIGNhc2UgImxpc3QtaXRlbSI6DQogICAgICAgICAgICAgICAgY2FzZSAicnVuLWluIjoNCiAgICAgICAgICAgICAgICBjYXNlICJ0YWJsZSI6DQogICAgICAgICAgICAgICAgY2FzZSAidGFibGUtY2FwdGlvbiI6DQogICAgICAgICAgICAgICAgY2FzZSAidGFibGUtY29sdW1uLWdyb3VwIjoNCiAgICAgICAgICAgICAgICBjYXNlICJ0YWJsZS1oZWFkZXItZ3JvdXAiOg0KICAgICAgICAgICAgICAgIGNhc2UgInRhYmxlLWZvb3Rlci1ncm91cCI6DQogICAgICAgICAgICAgICAgY2FzZSAidGFibGUtcm93LWdyb3VwIjoNCiAgICAgICAgICAgICAgICBjYXNlICJ0YWJsZS1jZWxsIjoNCiAgICAgICAgICAgICAgICBjYXNlICJ0YWJsZS1jb2x1bW4iOg0KICAgICAgICAgICAgICAgIGNhc2UgInRhYmxlLXJvdyI6IHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgZGVmYXVsdDogew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzd2l0Y2ggKGVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkgew0KICAgICAgICAgICAgICAgIGNhc2UgImJvZHkiOg0KICAgICAgICAgICAgICAgIGNhc2UgImgxIjoNCiAgICAgICAgICAgICAgICBjYXNlICJoMiI6DQogICAgICAgICAgICAgICAgY2FzZSAiaDMiOg0KICAgICAgICAgICAgICAgIGNhc2UgImg0IjoNCiAgICAgICAgICAgICAgICBjYXNlICJoNSI6DQogICAgICAgICAgICAgICAgY2FzZSAiaDYiOg0KICAgICAgICAgICAgICAgIGNhc2UgInAiOg0KICAgICAgICAgICAgICAgIGNhc2UgImRpdiI6DQogICAgICAgICAgICAgICAgY2FzZSAidWwiOg0KICAgICAgICAgICAgICAgIGNhc2UgIm9sIjoNCiAgICAgICAgICAgICAgICBjYXNlICJsaSI6DQogICAgICAgICAgICAgICAgY2FzZSAiZGwiOg0KICAgICAgICAgICAgICAgIGNhc2UgImR0IjoNCiAgICAgICAgICAgICAgICBjYXNlICJkZCI6DQogICAgICAgICAgICAgICAgY2FzZSAidGgiOg0KICAgICAgICAgICAgICAgIGNhc2UgInRkIjoNCiAgICAgICAgICAgICAgICBjYXNlICJ0ciI6DQogICAgICAgICAgICAgICAgY2FzZSAidGhlYWQiOg0KICAgICAgICAgICAgICAgIGNhc2UgInRib2R5Ijogew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBkZWZhdWx0OiB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgZ2V0TmV4dFBhcmFncmFwaChtYXhUZXh0TGVuZ3RoKXsNCg0KICAgICAgICBsZXQgbmV4dFBhcmFncmFwaFRleHROb2RlcyA9ICB0aGlzLmdldE5leHQobWF4VGV4dExlbmd0aCx0cnVlKTsNCg0KDQogICAgICAgIGlmKG5leHRQYXJhZ3JhcGhUZXh0Tm9kZXMpew0KICAgICAgICAgICAgbGV0IHRleHQgPSAiIjsNCiAgICAgICAgICAgIGZvcihsZXQgaT0gMDsgaSA8IG5leHRQYXJhZ3JhcGhUZXh0Tm9kZXMubGVuZ3RoOyBpKysgKXsNCiAgICAgICAgICAgICAgICB0ZXh0ICs9IG5leHRQYXJhZ3JhcGhUZXh0Tm9kZXNbaV0udGV4dENvbnRlbnQ7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgdHlwZTogUGFyYWdyYXBoLmNsYXNzTmFtZSwNCiAgICAgICAgICAgICAgICB2YWx1ZTogdGV4dCwNCiAgICAgICAgICAgICAgICB3b3JkOiB0ZXh0LA0KICAgICAgICAgICAgICAgIGVsZW1lbnQ6IG5leHRQYXJhZ3JhcGhUZXh0Tm9kZXMsDQogICAgICAgICAgICAgICAgdGV4dE5vZGVzOiBuZXh0UGFyYWdyYXBoVGV4dE5vZGVzLA0KICAgICAgICAgICAgICAgIGxhbmc6IHBhZ2VVdGlscy51dGlsLmdldExhbmd1YWdlT2ZFbGVtZW50KG5leHRQYXJhZ3JhcGhUZXh0Tm9kZXNbMF0pLA0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCg0KDQogICAgfQ0KDQogICAgZ2V0TmV4dFRleHQobWF4VGV4dExlbmd0aCl7DQogICAgICAgIGxldCBuZXh0VGV4dE5vZGVzID0gIHRoaXMuZ2V0TmV4dChtYXhUZXh0TGVuZ3RoKTsNCg0KICAgICAgICBpZihuZXh0VGV4dE5vZGVzKXsNCiAgICAgICAgICAgIGxldCB0ZXh0ID0gIiI7DQogICAgICAgICAgICBmb3IobGV0IGk9IDA7IGkgPCBuZXh0VGV4dE5vZGVzLmxlbmd0aDsgaSsrICl7DQogICAgICAgICAgICAgICAgdGV4dCArPSBuZXh0VGV4dE5vZGVzW2ldLnRleHRDb250ZW50Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIHR5cGU6IFBhcmFncmFwaC5jbGFzc05hbWUsDQogICAgICAgICAgICAgICAgdmFsdWU6IHRleHQsDQogICAgICAgICAgICAgICAgd29yZDogdGV4dCwNCiAgICAgICAgICAgICAgICBlbGVtZW50OiBuZXh0VGV4dE5vZGVzLA0KICAgICAgICAgICAgICAgIHRleHROb2RlczogbmV4dFRleHROb2RlcywNCiAgICAgICAgICAgICAgICBsYW5nOiBwYWdlVXRpbHMudXRpbC5nZXRMYW5ndWFnZU9mRWxlbWVudChuZXh0VGV4dE5vZGVzWzBdKSwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KDQoNCiAgICBnZXROZXh0KG1heFRleHRMZW5ndGgscGFyYWdyYXBoT25seSA9IGZhbHNlKSB7DQoNCiAgICAgICAgaWYobWF4VGV4dExlbmd0aCl7DQogICAgICAgICAgICB0aGlzLm1heFRleHRMZW5ndGggPSBtYXhUZXh0TGVuZ3RoOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHRoaXMuY3VycmVudFRleHROb2RlKSB7DQoNCiAgICAgICAgICAgIGxldCBjdXJyZW50VGV4dE5vZGVJbmRleCA9IHRoaXMudGV4dE5vZGVzLmluZGV4T2YodGhpcy5jdXJyZW50VGV4dE5vZGUpOw0KDQogICAgICAgICAgICBpZiAoY3VycmVudFRleHROb2RlSW5kZXggIT09IC0xKSB7DQogICAgICAgICAgICAgICAgbGV0IHJlbWFpbmluZ1RleHRMZW5ndGggPSB0aGlzLmNhbGN1bGF0ZVRleHRMZW5ndGgoY3VycmVudFRleHROb2RlSW5kZXgpOw0KDQoNCiAgICAgICAgICAgICAgICAvL0lmIHJlbWFpbmluZyB0ZXh0IGlzIHNob3J0IGVub3VnaA0KICAgICAgICAgICAgICAgIGlmIChyZW1haW5pbmdUZXh0TGVuZ3RoIDwgdGhpcy5tYXhUZXh0TGVuZ3RoKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VGV4dE5vZGUgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0Tm9kZXMuc2xpY2UoY3VycmVudFRleHROb2RlSW5kZXgpOw0KDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICAvL1NwbGl0IHJlbWFpbmluZyB0ZXh0DQogICAgICAgICAgICAgICAgICAgIGxldCBjdXJyZW50VGV4dExlbmd0aCA9IDA7DQogICAgICAgICAgICAgICAgICAgIGxldCB0ZXh0Tm9kZXMgPSBbXTsNCg0KICAgICAgICAgICAgICAgICAgICB3aGlsZSAoY3VycmVudFRleHRMZW5ndGggPD0gdGhpcy5tYXhUZXh0TGVuZ3RoKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjdXJyZW50QmxvY2sgPSB0aGlzLmdldE5leHRCbG9ja0Rpc3BsYXlOb2Rlc0Zyb21Ob2RlKHRoaXMuY3VycmVudFRleHROb2RlKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRUZXh0TGVuZ3RoICsgY3VycmVudEJsb2NrLnRleHRDb250ZW50TGVuZ3RoID4gdGhpcy5tYXhUZXh0TGVuZ3RoKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb3B0aW9ucyA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm5ld2xpbmVfYm91bmRhcmllcyIgOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImh0bWxfYm91bmRhcmllcyIgICAgOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNhbml0aXplIiAgICAgICAgICAgOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImFsbG93ZWRfdGFncyIgICAgICAgOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInByZXNlcnZlX3doaXRlc3BhY2UiIDogdHJ1ZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImFiYnJldmlhdGlvbnMiICAgICAgOiBudWxsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc2VudGVuY2VzID0gZXJfdG9rZW5pemVyLnNlbnRlbmNlcyhjdXJyZW50QmxvY2sudGV4dCwgb3B0aW9ucyk7DQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2VudGVuY2Ugc3BsaXQgcG9zc2libGUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VudGVuY2VzLmxlbmd0aCA+IDEgJiYgY3VycmVudFRleHRMZW5ndGggKyBzZW50ZW5jZXNbMF0ubGVuZ3RoIDw9IHRoaXMubWF4VGV4dExlbmd0aCkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzZW50ZW5jZUNoYXJMZW5ndGggPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbnRlbmNlcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRUZXh0TGVuZ3RoICsgc2VudGVuY2VDaGFyTGVuZ3RoICsgc2VudGVuY2VzW2ldLmxlbmd0aCA8PSB0aGlzLm1heFRleHRMZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW50ZW5jZUNoYXJMZW5ndGggKz0gc2VudGVuY2VzW2ldLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3BsaXRCbG9ja3MgPSB0aGlzLnNwbGl0QmxvY2soY3VycmVudEJsb2NrLHNlbnRlbmNlQ2hhckxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFRleHROb2RlID0gc3BsaXRCbG9ja3MucmVtYWluaW5nVGV4dE5vZGU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0Tm9kZXMuY29uY2F0KHNwbGl0QmxvY2tzLnRleHROb2Rlcyk7DQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1dlIGFscmVhZHkgaGF2ZSBhIHJlc3VsdCBhbmQgc3BsaXQgaXQgbmV4dCB0aW1lDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZW50ZW5jZXNbMF0ubGVuZ3RoIDwgdGhpcy5tYXhUZXh0TGVuZ3RoICYmIHRleHROb2Rlcy5sZW5ndGggPiAwKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXh0SW5kZXggPSB0aGlzLnRleHROb2Rlcy5pbmRleE9mKHRleHROb2Rlc1t0ZXh0Tm9kZXMubGVuZ3RoLTFdKSsxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VGV4dE5vZGUgPSB0aGlzLnRleHROb2Rlc1tuZXh0SW5kZXhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRleHROb2RlczsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0hBUkQgU1BMSVQgLSBObyBPdGhlciBjaG9pY2UgLSBUZXh0bm9kZSBpcyBiaWdnZXIgdGhlbiBtYXhUZXh0TGVuZ3RoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF4SW5kZXggPSB0aGlzLm1heFRleHRMZW5ndGggLSBjdXJyZW50VGV4dExlbmd0aDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9DaGVjayBpZiB3ZSBjYW4gc3BsaXQgQCBhIHB1bmN0dWF0aW9uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gbWF4SW5kZXg7IGkgPiAwOyBpLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFnZVV0aWxzLnV0aWwudW5pY29kZVB1bmN0dWF0aW9uLnRlc3QoY3VycmVudEJsb2NrLnRleHQuY2hhckF0KGkpKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY3VycmVudENoYXIgPSBjdXJyZW50QmxvY2sudGV4dC5jaGFyQXQoaSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGN1cnJlbnRDaGFyICE9PSAnIicgJiYgY3VycmVudENoYXIgIT09ICInIiAmJiBjdXJyZW50Q2hhciAhPT0gIsK0IiYmIGN1cnJlbnRDaGFyICE9PSAiYCIpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNwbGl0QmxvY2tzID0gdGhpcy5zcGxpdEJsb2NrKGN1cnJlbnRCbG9jayxpKzEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VGV4dE5vZGUgPSBzcGxpdEJsb2Nrcy5yZW1haW5pbmdUZXh0Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0Tm9kZXMuY29uY2F0KHNwbGl0QmxvY2tzLnRleHROb2Rlcyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IG1heEluZGV4OyBpID4gMDsgaS0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRCbG9jay50ZXh0LmNoYXJBdChpKSA9PT0iICIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNwbGl0QmxvY2tzID0gdGhpcy5zcGxpdEJsb2NrKGN1cnJlbnRCbG9jayxpKzEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUZXh0Tm9kZSA9IHNwbGl0QmxvY2tzLnJlbWFpbmluZ1RleHROb2RlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4dE5vZGVzLmNvbmNhdChzcGxpdEJsb2Nrcy50ZXh0Tm9kZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vQ2hlY2sgaWYgd2UgY2FuIHNwbGl0IEAgbm9uIHVuaWNvZGUgY2hhcg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IG1heEluZGV4OyBpID4gMDsgaS0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwYWdlVXRpbHMudXRpbC51bmljb2RlQ2hhci50ZXN0KGN1cnJlbnRCbG9jay50ZXh0LmNoYXJBdChpKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNwbGl0QmxvY2tzID0gdGhpcy5zcGxpdEJsb2NrKGN1cnJlbnRCbG9jayxpKzEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUZXh0Tm9kZSA9IHNwbGl0QmxvY2tzLnJlbWFpbmluZ1RleHROb2RlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4dE5vZGVzLmNvbmNhdChzcGxpdEJsb2Nrcy50ZXh0Tm9kZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSovDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vTm8gbm9uIHVuaWNvZGUgY2hhcnMgb3IgcHVuY3R1YXRpb25zIGRldGVjdGVkLi4uIGp1c3Qgc3BsaXQgdGhlIHRleHQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzcGxpdEJsb2NrcyA9IHRoaXMuc3BsaXRCbG9jayhjdXJyZW50QmxvY2ssbWF4SW5kZXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VGV4dE5vZGUgPSBzcGxpdEJsb2Nrcy5yZW1haW5pbmdUZXh0Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0Tm9kZXMuY29uY2F0KHNwbGl0QmxvY2tzLnRleHROb2Rlcyk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KDQoNCg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRleHRMZW5ndGgrPWN1cnJlbnRCbG9jay50ZXh0Q29udGVudExlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Tm9kZXMgPSB0ZXh0Tm9kZXMuY29uY2F0KGN1cnJlbnRCbG9jay50ZXh0Tm9kZXMpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50QmxvY2subGFzdEJsb2NrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VGV4dE5vZGUgPSBudWxsOyAvL0ZpbmlzaGVkDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRleHROb2RlczsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUZXh0Tm9kZSA9IHRoaXMudGV4dE5vZGVzW2N1cnJlbnRCbG9jay5uZXh0SW5kZXhdOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocGFyYWdyYXBoT25seSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgaT0wO2kgPCBjdXJyZW50QmxvY2sudGV4dC5sZW5ndGg7IGkrKyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihwYWdlVXRpbHMudXRpbC51bmljb2RlQ2hhci50ZXN0KGN1cnJlbnRCbG9jay50ZXh0W2ldKSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRCbG9jay50ZXh0Tm9kZXM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICB9DQoNCg0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICBzcGxpdEJsb2NrKGJsb2NrLCBzcGxpdEluZGV4KXsNCiAgICAgICAgbGV0IHNwbGl0Q2FsY3VsYXRpb24gPSB0aGlzLmNhbGN1bGF0ZVNwbGl0T2ZCbG9jayhibG9jayxzcGxpdEluZGV4KTsNCiAgICAgICAgaWYoc3BsaXRDYWxjdWxhdGlvbil7DQoNCg0KICAgICAgICAgICAgbGV0IHJlbWFpbmluZ1RleHROb2RlID0gdGhpcy5zcGxpdFRleHROb2RlKHNwbGl0Q2FsY3VsYXRpb24udGV4dE5vZGUsc3BsaXRDYWxjdWxhdGlvbi5zcGxpdEluZGV4KTsNCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICB0ZXh0Tm9kZXM6IGJsb2NrLnRleHROb2Rlcy5zbGljZSgwLHNwbGl0Q2FsY3VsYXRpb24uYmxvY2tUZXh0Tm9kZUluZGV4KzEpLA0KICAgICAgICAgICAgICAgIHJlbWFpbmluZ1RleHROb2RlOiByZW1haW5pbmdUZXh0Tm9kZSwNCiAgICAgICAgICAgIH07DQoNCg0KDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBjYWxjdWxhdGVTcGxpdE9mQmxvY2soYmxvY2ssIHNwbGl0SW5kZXgpIHsNCiAgICAgICAgbGV0IGJsb2NrVGV4dE5vZGVDaGFyTGVuZ3RoQ291bnQgPSAwOw0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJsb2NrLnRleHROb2Rlcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgaWYgKGJsb2NrVGV4dE5vZGVDaGFyTGVuZ3RoQ291bnQgKyBibG9jay50ZXh0Tm9kZXNbaV0udGV4dENvbnRlbnQubGVuZ3RoIDwgc3BsaXRJbmRleCkgew0KICAgICAgICAgICAgICAgIGJsb2NrVGV4dE5vZGVDaGFyTGVuZ3RoQ291bnQgKz0gYmxvY2sudGV4dE5vZGVzW2ldLnRleHRDb250ZW50Lmxlbmd0aDsNCiAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICB0ZXh0Tm9kZTogYmxvY2sudGV4dE5vZGVzW2ldLA0KICAgICAgICAgICAgICAgICAgICBzcGxpdEluZGV4OiBzcGxpdEluZGV4IC0gYmxvY2tUZXh0Tm9kZUNoYXJMZW5ndGhDb3VudCwNCiAgICAgICAgICAgICAgICAgICAgYmxvY2tUZXh0Tm9kZUluZGV4OiBpLA0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KICAgIH0NCg0KDQoNCiAgICBzcGxpdFRleHROb2RlKHRleHROb2RlLCBzcGxpdEluZGV4KSB7DQoNCiAgICAgICAgbGV0IHRleHROb2RlSW5kZXggPSB0aGlzLnRleHROb2Rlcy5pbmRleE9mKHRleHROb2RlKTsNCiAgICAgICAgaWYgKHRleHROb2RlSW5kZXggIT09IC0xKSB7DQogICAgICAgICAgICBsZXQgbmV3Tm9kZSA9IHRoaXMudGV4dE5vZGVzW3RleHROb2RlSW5kZXhdLnNwbGl0VGV4dChzcGxpdEluZGV4KTsNCiAgICAgICAgICAgIHRoaXMudGV4dE5vZGVzLnNwbGljZSh0ZXh0Tm9kZUluZGV4KzEsMCxuZXdOb2RlKTsNCiAgICAgICAgICAgIHJldHVybiBuZXdOb2RlOw0KDQoNCiAgICAgICAgfQ0KICAgIH0NCg0KDQp9",
        "LyoqDQogKiBVdGlsaXR5IG1ldGhvZHMgZm9yIGhhbmRsaW5nIEkvTyBUeXBlcw0KICogQENsYXNzIGlvVHlwZVV0aWxzDQogKi8NCnZhciBpb1R5cGVVdGlscyA9IHsNCiAgICAvKioNCiAgICAgKiBDb252ZXJ0cyBhbiBvYmplY3QgdG8gYSBzcGVjaWZpYyBJT1R5cGUgaW5zdGFuY2UNCiAgICAgKiBAcGFyYW0gaW9PYmplY3QNCiAgICAgKiBAcmV0dXJucyBJT1R5cGUgaW5zdGFuY2UNCiAgICAgKi8NCiAgICB0b0lPVHlwZUluc3RhbmNlKGlvT2JqZWN0KSB7DQogICAgICAgIGxldCBJT3JldCA9IG5ldyBJT1R5cGUoKTsNCiAgICAgICAgaWYgKHR5cGVvZihpb09iamVjdCkgPT09ICJvYmplY3QiICYmIGlvT2JqZWN0Lm5hbWUgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgc3dpdGNoIChpb09iamVjdC5uYW1lKSB7DQogICAgICAgICAgICAgICAgY2FzZSAnVm9pZElPVHlwZSc6DQogICAgICAgICAgICAgICAgICAgIElPcmV0ID0gbmV3IFZvaWRJT1R5cGUoKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAnV29yZCc6DQogICAgICAgICAgICAgICAgICAgIElPcmV0ID0gbmV3IFdvcmQoaW9PYmplY3Qud29yZCxpb09iamVjdC5sYW5nLGlvT2JqZWN0LnNlbnRlbmNlU3RhcnQsaW9PYmplY3Quc2VudGVuY2VFbmQpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICdTZW50ZW5jZSc6DQogICAgICAgICAgICAgICAgICAgIElPcmV0ID0gbmV3IFNlbnRlbmNlKGlvT2JqZWN0LnNlbnRlbmNlLGlvT2JqZWN0LmxhbmcpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICdQYXJhZ3JhcGgnOg0KICAgICAgICAgICAgICAgICAgICBJT3JldCA9IG5ldyBQYXJhZ3JhcGgoaW9PYmplY3QucGFyYWdyYXBoLGlvT2JqZWN0LmxhbmcpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICdBbm5vdGF0ZWRQYXJhZ3JhcGgnOg0KICAgICAgICAgICAgICAgICAgICBJT3JldCA9IG5ldyBBbm5vdGF0ZWRQYXJhZ3JhcGgoaW9PYmplY3QucGFyYWdyYXBoLGlvT2JqZWN0LmFubm90YXRpb25zLCBpb09iamVjdC5sYW5nKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAnSW1hZ2VJT1R5cGUnOg0KICAgICAgICAgICAgICAgICAgICBJT3JldCA9IG5ldyBJbWFnZUlPVHlwZShpb09iamVjdC51cmwsIGlvT2JqZWN0LmFsdCwgaW9PYmplY3QudGl0bGUpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICdBdWRpb1R5cGUnOg0KICAgICAgICAgICAgICAgICAgICBJT3JldCA9IG5ldyBBdWRpb1R5cGUoaW9PYmplY3QubXAzVVJMLCBpb09iamVjdC5zcGVlY2hNYXJrVVJMLCBpb09iamVjdC5zcGVlY2hNYXJrcyk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2UgJ0phdmFTY3JpcHRUeXBlJzoNCiAgICAgICAgICAgICAgICAgICAgSU9yZXQgPSBuZXcgSmF2YVNjcmlwdFR5cGUoaW9PYmplY3Quc2NyaXB0KTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAnVVJMVHlwZSc6DQogICAgICAgICAgICAgICAgICAgIElPcmV0ID0gbmV3IFVSTFR5cGUoaW9PYmplY3QudXJsLCBpb09iamVjdC50YXJnZXQpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICdDb250ZW50UmVwbGFjZW1lbnQnOg0KICAgICAgICAgICAgICAgICAgICBJT3JldCA9IG5ldyBDb250ZW50UmVwbGFjZW1lbnQoaW9PYmplY3QucmVwbGFjZW1lbnRzLGlvT2JqZWN0LmxhbmcpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICdFcnJvcic6DQogICAgICAgICAgICAgICAgICAgIElPcmV0ID0gbmV3IEVycm9yKGlvT2JqZWN0Lm1lc3NhZ2UsaW9PYmplY3QudHlwZSxpb09iamVjdC5uYW1lLGlvT2JqZWN0LmRlc2NyaXB0aW9uKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAnTm9SZXN1bHQnOg0KICAgICAgICAgICAgICAgICAgICBJT3JldCA9IG5ldyBOb1Jlc3VsdChpb09iamVjdC5tZXNzYWdlLCBpb09iamVjdC5uYW1lLGlvT2JqZWN0LmRlc2NyaXB0aW9uKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBpb09iamVjdDsgLy8gQmFja3dhcmRzIGNvbXBhdGliaWxpdHkNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gSU9yZXQ7DQogICAgfSwNCg0KfTs=",
        "InVzZSBzdHJpY3QiOw0KDQovKioNCiAqIElucHV0IGFuZCBPdXRwdXQgVHlwZQ0KICovDQpjbGFzcyBJT1R5cGUgew0KICAgIGNvbnN0cnVjdG9yKG5hbWU9IklPVHlwZSIsIGRlc2NyaXB0aW9uPSIiKSB7DQogICAgICAgIHRoaXMubmFtZSA9IG5hbWU7DQogICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjsNCiAgICAgICAgdGhpcy5faXNUZXh0ID0gZmFsc2U7DQogICAgfQ0KICAgIHN0YXRpYyBnZXQgY2xhc3NOYW1lKCkgew0KICAgICAgICByZXR1cm4gJ0lPVHlwZSc7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogSFRNTCBtYXJrdXAgZm9yIHRoZSBpbnN0YW5jZSwgZXhjbHVkaW5nIGFueSBtZXRhZGF0YQ0KICAgICAqIEByZXR1cm5zIHtzdHJpbmd9DQogICAgICovDQogICAgdG9IdG1sKCkgew0KICAgICAgICByZXR1cm4gJyc7DQogICAgfQ0KDQogICAgaXNUZXh0KCl7DQogICAgICAgIHJldHVybiB0aGlzLl9pc1RleHQ7DQogICAgfQ0KDQogICAgZ2V0VmFsdWUoKXsNCg0KICAgIH0NCn0NCg0KY2xhc3MgVm9pZElPVHlwZSBleHRlbmRzIElPVHlwZSB7DQogICAgY29uc3RydWN0b3IoZGVzY3JpcHRpb24gPSAiIikgew0KICAgICAgICBzdXBlcigiVm9pZElPVHlwZSIsIGRlc2NyaXB0aW9uKTsNCiAgICB9DQogICAgc3RhdGljIGdldCBjbGFzc05hbWUoKSB7DQogICAgICAgIHJldHVybiAnVm9pZElPVHlwZSc7DQogICAgfQ0KfQ0KDQpjbGFzcyBXb3JkIGV4dGVuZHMgSU9UeXBlIHsNCiAgICBjb25zdHJ1Y3Rvcih3b3JkLGxhbmc9ImVuIiwgc2VudGVuY2VTdGFydCA9ICIiLCBzZW50ZW5jZUVuZD0iIiwgZGVzY3JpcHRpb249IiIpIHsNCiAgICAgICAgc3VwZXIoIldvcmQiLCBkZXNjcmlwdGlvbik7DQogICAgICAgIHRoaXMud29yZCA9IHdvcmQ7DQogICAgICAgIHRoaXMubGFuZyA9IGxhbmc7DQogICAgICAgIHRoaXMuc2VudGVuY2VTdGFydCA9IHNlbnRlbmNlU3RhcnQ7DQogICAgICAgIHRoaXMuc2VudGVuY2VFbmQgPSBzZW50ZW5jZUVuZDsNCiAgICAgICAgdGhpcy5faXNUZXh0ID0gdHJ1ZTsNCiAgICB9DQoNCiAgICBzdGF0aWMgZ2V0IGNsYXNzTmFtZSgpIHsNCiAgICAgICAgcmV0dXJuICdXb3JkJzsNCiAgICB9DQogICAgdG9IdG1sKCkgew0KICAgICAgICByZXR1cm4gdGhpcy53b3JkOw0KICAgIH0NCg0KICAgIGdldFZhbHVlKCl7DQogICAgICAgIHJldHVybiB0aGlzLndvcmQ7DQogICAgfQ0KDQogICAgZ2V0U2VudGVuY2UoKXsNCiAgICAgICAgcmV0dXJuIHRoaXMuc2VudGVuY2VTdGFydCsiICIrdGhpcy53b3JkKyIgIit0aGlzLnNlbnRlbmNlRW5kOw0KICAgIH0NCn0NCg0KY2xhc3MgU2VudGVuY2UgZXh0ZW5kcyBJT1R5cGUgew0KICAgIGNvbnN0cnVjdG9yKHNlbnRlbmNlLCBsYW5nPSJlbiIsIGRlc2NyaXB0aW9uPSIiKSB7DQogICAgICAgIHN1cGVyKCJTZW50ZW5jZSIsIGRlc2NyaXB0aW9uKTsNCiAgICAgICAgdGhpcy5zZW50ZW5jZSA9IHNlbnRlbmNlOw0KICAgICAgICB0aGlzLmxhbmcgPSBsYW5nOw0KICAgICAgICB0aGlzLl9pc1RleHQgPSB0cnVlOw0KICAgIH07DQogICAgc3RhdGljIGdldCBjbGFzc05hbWUoKSB7DQogICAgICAgIHJldHVybiAnU2VudGVuY2UnOw0KICAgIH07DQogICAgdG9IdG1sKCkgew0KICAgICAgICByZXR1cm4gdGhpcy5zZW50ZW5jZTsNCiAgICB9DQoNCiAgICBnZXRWYWx1ZSgpew0KICAgICAgIHJldHVybiB0aGlzLnNlbnRlbmNlOw0KICAgIH0NCn0NCg0KY2xhc3MgUGFyYWdyYXBoIGV4dGVuZHMgSU9UeXBlIHsNCiAgICBjb25zdHJ1Y3RvcihwYXJhZ3JhcGgsIGxhbmc9ImVuIiwgZGVzY3JpcHRpb249IiIpIHsNCiAgICAgICAgc3VwZXIoIlBhcmFncmFwaCIsIGRlc2NyaXB0aW9uKTsNCiAgICAgICAgdGhpcy5wYXJhZ3JhcGggPSBwYXJhZ3JhcGg7DQogICAgICAgIHRoaXMubGFuZyA9IGxhbmc7DQogICAgICAgIHRoaXMuX2lzVGV4dCA9IHRydWU7DQogICAgfQ0KICAgIHN0YXRpYyBnZXQgY2xhc3NOYW1lKCkgew0KICAgICAgICByZXR1cm4gJ1BhcmFncmFwaCc7DQogICAgfQ0KICAgIHRvSHRtbCgpIHsNCiAgICAgICAgcmV0dXJuICI8cD4iICsgdGhpcy5wYXJhZ3JhcGggKyAiPC9wPiI7DQogICAgfQ0KDQogICAgZ2V0VmFsdWUoKXsNCiAgICAgICAgcmV0dXJuIHRoaXMucGFyYWdyYXBoOw0KICAgIH0NCn0NCg0KY2xhc3MgQW5ub3RhdGVkUGFyYWdyYXBoIGV4dGVuZHMgSU9UeXBlew0KICAgIGNvbnN0cnVjdG9yKHBhcmFncmFwaCxhbm5vdGF0aW9ucyA9IG51bGwsbGFuZz0iZW4iLCBkZXNjcmlwdGlvbj0iIikgew0KICAgICAgICBzdXBlcigiQW5ub3RhdGVkUGFyYWdyYXBoIiwgZGVzY3JpcHRpb24pOw0KICAgICAgICB0aGlzLnBhcmFncmFwaCA9IHBhcmFncmFwaDsNCg0KICAgICAgICBpZihhbm5vdGF0aW9ucyl7DQogICAgICAgICAgICB0aGlzLmFubm90YXRpb25zID0gYW5ub3RhdGlvbnM7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgdGhpcy5hbm5vdGF0aW9ucyA9IFtdOw0KICAgICAgICB9DQoNCiAgICAgICAgdGhpcy5sYW5nID0gbGFuZzsNCiAgICAgICAgdGhpcy5faXNUZXh0ID0gdHJ1ZTsNCiAgICB9DQogICAgc3RhdGljIGdldCBjbGFzc05hbWUoKSB7DQogICAgICAgIHJldHVybiAnQW5ub3RhdGVkUGFyYWdyYXBoJzsNCiAgICB9DQoNCiAgICBhZGRUZXh0QW5ub3RhdGlvbihwb3NpdGlvbix0ZXh0VG9Bbm5vdGF0ZSx0ZXh0KXsNCiAgICAgICAgdGhpcy5hbm5vdGF0aW9ucy5wdXNoKHsNCiAgICAgICAgICAgIHR5cGU6ICJ0ZXh0IiwNCiAgICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbiwNCiAgICAgICAgICAgIHRleHRUb0Fubm90YXRlOiB0ZXh0VG9Bbm5vdGF0ZSwNCiAgICAgICAgICAgIHRleHQ6dGV4dCwNCiAgICAgICAgfSk7DQogICAgfQ0KDQogICAgYWRkSFRNTEFubm90YXRpb24ocG9zaXRpb24sdGV4dFRvQW5ub3RhdGUsIGh0bWwpew0KICAgICAgICB0aGlzLmFubm90YXRpb25zLnB1c2goew0KICAgICAgICAgICAgdHlwZTogImh0bWwiLA0KICAgICAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLA0KICAgICAgICAgICAgdGV4dFRvQW5ub3RhdGU6IHRleHRUb0Fubm90YXRlLA0KICAgICAgICAgICAgaHRtbDpodG1sLA0KICAgICAgICB9KTsNCiAgICB9DQogICAgYWRkSW1hZ2VBbm5vdGF0aW9uKHBvc2l0aW9uLHRleHRUb0Fubm90YXRlLCBpbWFnZVVSTCxpbWFnZUFMVCl7DQogICAgICAgIHRoaXMuYW5ub3RhdGlvbnMucHVzaCh7DQogICAgICAgICAgICB0eXBlOiAiaW1hZ2UiLA0KICAgICAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLA0KICAgICAgICAgICAgdGV4dFRvQW5ub3RhdGU6IHRleHRUb0Fubm90YXRlLA0KICAgICAgICAgICAgaW1hZ2U6aW1hZ2VVUkwsDQogICAgICAgICAgICBpbWFnZUFMVDogaW1hZ2VBTFQNCiAgICAgICAgfSk7DQogICAgfQ0KDQogICAgYWRkV2lraXBlZGlhQW5ub3RhdGlvbihwb3NpdGlvbix0ZXh0VG9Bbm5vdGF0ZSx3aWtpTGlua3Mpew0KICAgICAgICB0aGlzLmFubm90YXRpb25zLnB1c2goew0KICAgICAgICAgICAgdHlwZToid2lraSIsDQogICAgICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sDQogICAgICAgICAgICB0ZXh0VG9Bbm5vdGF0ZTogdGV4dFRvQW5ub3RhdGUsDQogICAgICAgICAgICB3aWtpTGlua3M6d2lraUxpbmtzLA0KICAgICAgICB9KTsNCiAgICB9DQoNCiAgICB0b0h0bWwoKSB7DQogICAgICAgIHJldHVybiAiPHA+IiArIHRoaXMucGFyYWdyYXBoICsgIjwvcD4iOw0KICAgIH0NCg0KICAgIGdldFZhbHVlKCl7DQogICAgICAgIHJldHVybiB0aGlzLnBhcmFncmFwaDsNCiAgICB9DQp9DQoNCmNsYXNzIFBhcnNlZExhbmd1YWdlVHlwZSBleHRlbmRzIElPVHlwZSB7DQogICAgLyoqDQogICAgICogQHBhcmFtIHtzdHJpbmd9IHJhd19zdHJpbmcNCiAgICAgKiBAcGFyYW0ge0FycmF5LjxzdHJpbmc+fSBzZW50ZW5jZXMgLSBzZW50ZW5jZVt3b3JkXQ0KICAgICAqIEBwYXJhbSB7QXJyYXkuPHN0cmluZz59IHBvc190YWdzIC0gc2VudGVuY2VbUE9TX3RhZyBvZiBjb3JyZXNwb25kaW5nIHdvcmRdDQogICAgICogQHBhcmFtIHtzdHJpbmd9IGxhbmd1YWdlDQogICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUNCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGVzY3JpcHRpb24NCiAgICAgKi8NCiAgICBjb25zdHJ1Y3RvcihyYXdfc3RyaW5nID0gIiIsDQogICAgICAgICAgICAgICAgc2VudGVuY2VzPSBbXSwNCiAgICAgICAgICAgICAgICBwb3NfdGFncyA9IFtdLA0KICAgICAgICAgICAgICAgIGxhbmd1YWdlID0gIiIsDQogICAgICAgICAgICAgICAgZGVzY3JpcHRpb249IkEgcGFyYWdyYXBoIG1hZGUgdXAgb2Ygc2VudGVuY2VzIHdpdGggc3ludGFjdGljIG1ldGFkYXRhIikgew0KICAgICAgICBzdXBlcigiUGFyc2VkTGFuZ3VhZ2VUeXBlIiwgZGVzY3JpcHRpb24pOw0KICAgICAgICB0aGlzLnJhd19zdHJpbmcgPSByYXdfc3RyaW5nOw0KICAgICAgICB0aGlzLnNlbnRlbmNlcz0gc2VudGVuY2VzOw0KICAgICAgICB0aGlzLnBvc190YWdzID0gcG9zX3RhZ3M7DQogICAgICAgIHRoaXMubGFuZ3VhZ2UgPSBsYW5ndWFnZTsNCiAgICB9DQogICAgdG9IdG1sKCkgew0KICAgICAgICBsZXQgaHRtbCA9ICcnOw0KICAgICAgICBpZiAodGhpcy5zZW50ZW5jZXMgaW5zdGFuY2VvZiBBcnJheSkgew0KICAgICAgICAgICAgaHRtbCA9ICc8cD4nOw0KICAgICAgICAgICAgdGhpcy5zZW50ZW5jZXMuZm9yRWFjaCgoc2VudGVuY2UsIGkpID0+IHsNCiAgICAgICAgICAgICAgICBzZW50ZW5jZS5mb3JFYWNoKCh3b3JkLCBqKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGxldCBwb3NfdGFnID0gJyc7DQogICAgICAgICAgICAgICAgICAgIGlmIChpIDwgdGhpcy5wb3NfdGFncy5sZW5ndGggJiYgaiA8IHRoaXMucG9zX3RhZ3NbaV0ubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwb3NfdGFnID0gJzxzcGFuIGNsYXNzPSJlYXN5LXJlYWRpbmctaGlnaGxpZ2h0Ij4oJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc190YWcgKz0gdGhpcy5wb3NfdGFnc1tpXVtqXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc190YWcgKz0gJyk8L3NwYW4+ICc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSB3b3JkICsgcG9zX3RhZzsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBodG1sICs9ICc8YnIvPic7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGh0bWwgKz0gJzwvcD4nOw0KICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmF3X3N0cmluZykgew0KICAgICAgICAgICAgaHRtbCA9IHRoaXMucmF3X3N0cmluZzsNCiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcy5zZW50ZW5jZXMgPT09ICdzdHJpbmcnIHx8IHRoaXMuc2VudGVuY2VzIGluc3RhbmNlb2YgU3RyaW5nKSB7DQogICAgICAgICAgICBodG1sID0gdGhpcy5zZW50ZW5jZXM7DQogICAgICAgICAgICByZXR1cm4gaHRtbDsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KY2xhc3MgUGFnZSBleHRlbmRzIElPVHlwZSB7DQogICAgY29uc3RydWN0b3IocGFnZSwgbGFuZz0iZW4iLCBkZXNjcmlwdGlvbj0iIikgew0KICAgICAgICBzdXBlcigiUGFnZSIsIGRlc2NyaXB0aW9uKTsNCiAgICAgICAgdGhpcy5wYWdlID0gcGFnZTsNCiAgICAgICAgdGhpcy5sYW5nID0gbGFuZzsNCiAgICB9DQogICAgc3RhdGljIGdldCBjbGFzc05hbWUoKSB7DQogICAgICAgIHJldHVybiAnUGFnZSc7DQogICAgfQ0KDQogICAgZ2V0VmFsdWUoKXsNCiAgICAgICAgcmV0dXJuIHRoaXMucGFnZTsNCiAgICB9DQp9DQoNCmNsYXNzIEltYWdlSU9UeXBlIGV4dGVuZHMgSU9UeXBlIHsNCiAgICBjb25zdHJ1Y3Rvcih1cmwsIGFsdD0iIiwgdGl0bGU9IiIsIGRlc2NyaXB0aW9uPSIiKSB7DQogICAgICAgIHN1cGVyKCJJbWFnZUlPVHlwZSIsIGRlc2NyaXB0aW9uKTsNCiAgICAgICAgdGhpcy51cmwgPSB1cmw7DQogICAgICAgIHRoaXMuYWx0ID0gYWx0Ow0KICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7DQogICAgfQ0KICAgIHRvSHRtbCgpIHsNCiAgICAgICAgaWYgKCF0aGlzLnVybCkgew0KICAgICAgICAgICAgcmV0dXJuICJObyBpbWFnZXMgZm91bmQuIjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGxldCBhbHRUZXh0ID0gIiI7DQogICAgICAgICAgICBpZih0aGlzLmFsdCkgew0KICAgICAgICAgICAgICAgIGFsdFRleHQgPSB0aGlzLmFsdDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGxldCBodG1sID0gIjxpbWcgc3JjPVwiIiArIHRoaXMudXJsICsgIlwiIGFsdD1cIiIgKyBhbHRUZXh0ICsgIlwiIjsNCiAgICAgICAgICAgIGlmICh0aGlzLnRpdGxlKSB7DQogICAgICAgICAgICAgICAgaHRtbCArPSAiIHRpdGxlPVwiIiArIHRoaXMudGl0bGUgKyAiXCIiOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaHRtbCArPSAiLz4iOw0KICAgICAgICAgICAgcmV0dXJuIGh0bWw7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBnZXRWYWx1ZSgpew0KICAgICAgICByZXR1cm4gdGhpcy51cmw7DQogICAgfQ0KDQogICAgc3RhdGljIGdldCBjbGFzc05hbWUoKSB7DQogICAgICAgIHJldHVybiAnSW1hZ2VJT1R5cGUnOw0KICAgIH0NCg0KfQ0KDQpjbGFzcyBBdWRpb1R5cGUgZXh0ZW5kcyBJT1R5cGUgew0KICAgIGNvbnN0cnVjdG9yKHVybCwgc3BlZWNoTWFya1VSTCA9ICIiLCBzcGVlY2hNYXJrcyA9IFtdLCBkZXNjcmlwdGlvbj0iIikgew0KICAgICAgICBzdXBlcigiQXVkaW9UeXBlIiwgZGVzY3JpcHRpb24pOw0KICAgICAgICB0aGlzLm1wM1VSTCA9IHVybDsNCiAgICAgICAgdGhpcy5zcGVlY2hNYXJrVVJMID0gc3BlZWNoTWFya1VSTDsgLy8gVVJMIHRvIGEgSlNPTiBmaWxlIHdpdGggc3BlZWNoIG1hcmtzDQogICAgICAgIHRoaXMuc3BlZWNoTWFya3MgPSBzcGVlY2hNYXJrczsNCiAgICB9DQogICAgc3RhdGljIGdldCBjbGFzc05hbWUoKSB7DQogICAgICAgIHJldHVybiAnQXVkaW9UeXBlJzsNCiAgICB9DQogICAgdG9IdG1sKCkgew0KICAgICAgICBsZXQgaHRtbCA9ICAiPGF1ZGlvIGNvbnRyb2xzPiI7DQogICAgICAgIGh0bWwgKz0gIjxzb3VyY2Ugc3JjPVwiIiArIHRoaXMubXAzVVJMICsgIlwiIHR5cGU9XCJhdWRpby9tcGVnXCI+IjsNCiAgICAgICAgaHRtbCArPSAiWW91ciBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgdGhlIGF1ZGlvIHRhZy4gPC9hdWRpbz4iOw0KICAgICAgICByZXR1cm4gaHRtbDsNCiAgICB9DQoNCiAgICBnZXRWYWx1ZSgpew0KICAgICAgICByZXR1cm4gdGhpcy5tcDNVUkw7DQogICAgfQ0KfQ0KDQpjbGFzcyBKYXZhU2NyaXB0VHlwZSBleHRlbmRzIElPVHlwZSB7DQoNCiAgICBjb25zdHJ1Y3RvcihzY3JpcHQ9IiIsIGRlc2NyaXB0aW9uPSIiKSB7DQogICAgICAgIHN1cGVyKCJKYXZhU2NyaXB0VHlwZSIsIGRlc2NyaXB0aW9uKTsNCiAgICAgICAgdGhpcy5zY3JpcHQgPSBzY3JpcHQ7DQogICAgfQ0KICAgIHN0YXRpYyBnZXQgY2xhc3NOYW1lKCkgew0KICAgICAgICByZXR1cm4gJ0phdmFTY3JpcHRUeXBlJzsNCiAgICB9DQogICAgdG9IdG1sKCkgew0KICAgICAgICBpZiAodGhpcy5zY3JpcHQuc3RhcnRzV2l0aCgiPHNjcmlwdCIpKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5zY3JpcHQ7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gIjxzY3JpcHQ+IiArIHRoaXMuc2NyaXB0ICsgIjwvc2NyaXB0PiI7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBnZXRWYWx1ZSgpew0KICAgICAgICByZXR1cm4gdGhpcy5zY3JpcHQ7DQogICAgfQ0KfQ0KDQpjbGFzcyBVUkxUeXBlIGV4dGVuZHMgSU9UeXBlIHsNCiAgICBjb25zdHJ1Y3Rvcih1cmwsIHRhcmdldD0iIiwgZGVzY3JpcHRpb249IiIpIHsNCiAgICAgICAgc3VwZXIoIlVSTFR5cGUiLCBkZXNjcmlwdGlvbik7DQogICAgICAgIHRoaXMudXJsID0gdXJsOw0KICAgICAgICB0aGlzLnRhcmdldCA9IHRhcmdldDsNCiAgICB9DQogICAgc3RhdGljIGdldCBjbGFzc05hbWUoKSB7DQogICAgICAgIHJldHVybiAnVVJMVHlwZSc7DQogICAgfQ0KICAgIHRvSHRtbCgpIHsNCiAgICAgICAgbGV0IGh0bWwgPSAgIjxhIGhyZWY9XCIiICsgdGhpcy51cmwudG9TdHJpbmcoKSArICJcIiI7DQogICAgICAgIGlmICh0aGlzLnRhcmdldCkgew0KICAgICAgICAgICAgaHRtbCArPSAiIHRhcmdldD1cIiIgKyB0aGlzLnRhcmdldCArICJcIiI7DQogICAgICAgIH0NCiAgICAgICAgaHRtbCArPSAiLz4iOw0KICAgICAgICByZXR1cm4gaHRtbDsNCiAgICB9DQoNCiAgICBnZXRWYWx1ZSgpew0KICAgICAgICByZXR1cm4gdGhpcy51cmw7DQogICAgfQ0KDQoNCn0NCmNsYXNzIENvbnRlbnRSZXBsYWNlbWVudCBleHRlbmRzIElPVHlwZXsNCiAgICBjb25zdHJ1Y3RvcihyZXBsYWNtZW50cywgbGFuZ2UgPSAiZW4iLGRlc2NyaXB0aW9uPSIiKXsNCiAgICAgICAgc3VwZXIoIkNvbnRlbnRSZXBsYWNlbWVudCIsZGVzY3JpcHRpb24pOw0KDQogICAgICAgIGlmKHJlcGxhY21lbnRzKXsNCiAgICAgICAgICAgIHRoaXMucmVwbGFjZW1lbnRzID0gcmVwbGFjbWVudHM7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgdGhpcy5yZXBsYWNlbWVudHMgPSBbXTsNCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgYWRkUmVwbGFjZW1lbnQodHlwZSwgcmVwbGFjZW1lbnQpew0KICAgICAgICB0aGlzLnJlcGxhY2VtZW50cy5wdXNoKHsNCiAgICAgICAgICAgIHR5cGU6IHR5cGUsDQogICAgICAgICAgICByZXBsYWNlbWVudDogcmVwbGFjZW1lbnQsDQogICAgICAgIH0pDQogICAgfQ0KICAgIHN0YXRpYyBnZXQgY2xhc3NOYW1lKCkgew0KICAgICAgICByZXR1cm4gJ0NvbnRlbnRSZXBsYWNlbWVudCc7DQogICAgfQ0KfQ0KDQpjbGFzcyBUYWdnZWRUZXh0IGV4dGVuZHMgSU9UeXBlew0KICAgIGNvbnN0cnVjdG9yKG9yaWdpbmFsVGV4dCx0YWdnZWRUZXh0ID0gbnVsbCxsYW5nPSJlbiIsIGRlc2NyaXB0aW9uPSIiKSB7DQogICAgICAgIHN1cGVyKCJUYWdnZWRUZXh0IiwgZGVzY3JpcHRpb24pOw0KICAgICAgICB0aGlzLm9yaWdpbmFsVGV4dCA9IG9yaWdpbmFsVGV4dDsNCg0KICAgICAgICBpZih0YWdnZWRUZXh0KXsNCiAgICAgICAgICAgIHRoaXMudGFnZ2VkVGV4dCA9IHRhZ2dlZFRleHQ7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgdGhpcy50YWdnZWRUZXh0ID0gW1RhZ2dlZFRleHQuY3JlYXRlUE9TVGFnKHRoaXMub3JpZ2luYWxUZXh0KV07DQogICAgICAgIH0NCg0KICAgICAgICB0aGlzLmxhbmcgPSBsYW5nOw0KICAgICAgICB0aGlzLl9pc1RleHQgPSB0cnVlOw0KICAgIH0NCiAgICBzdGF0aWMgZ2V0IGNsYXNzTmFtZSgpIHsNCiAgICAgICAgcmV0dXJuICdUYWdnZWRUZXh0JzsNCiAgICB9DQoNCiAgICBzdGF0aWMgY3JlYXRlUE9TVGFnKHRleHQsdGFncz1udWxsKXsNCg0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICB0ZXh0OiB0ZXh0LA0KICAgICAgICAgICAgdGFncyA6IHRhZ3MsDQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIGdldFRleHQoKXsNCiAgICAgICAgbGV0IHRleHQgPSAiIjsNCiAgICAgICAgZm9yKGxldCBpPTA7IGkgPCB0aGlzLnRhZ2dlZFRleHQubGVuZ3RoOyBpKyspew0KDQogICAgICAgICAgICB0ZXh0Kz10aGlzLnRhZ2dlZFRleHRbaV0udGV4dDsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdGV4dDsNCiAgICB9DQp9DQoNCmNsYXNzIEVycm9yIGV4dGVuZHMgSU9UeXBlew0KICAgIGNvbnN0cnVjdG9yKGVycm9yTWVzc2FnZSxlcnJvclR5cGU9IkVycm9yIixkZXNjcmlwdGlvbj0iIil7DQogICAgICAgIHN1cGVyKCJFcnJvciIsIGRlc2NyaXB0aW9uKTsNCiAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyb3JNZXNzYWdlOw0KICAgICAgICB0aGlzLnR5cGUgPSBlcnJvclR5cGU7DQogICAgfQ0KDQogICAgZ2V0VmFsdWUoKXsNCiAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZTsNCiAgICB9DQoNCiAgICB0b0h0bWwoKSB7DQogICAgICAgIHJldHVybiB0aGlzLm1lc3NhZ2U7DQogICAgfQ0KfQ0KDQpjbGFzcyBOb1Jlc3VsdCBleHRlbmRzIElPVHlwZXsNCiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlLGRlc2NyaXB0aW9uPSIiKXsNCiAgICAgICAgc3VwZXIoIk5vUmVzdWx0IiwgZGVzY3JpcHRpb24pOw0KICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlOw0KICAgIH0NCg0KICAgIGdldFZhbHVlKCl7DQogICAgICAgIHJldHVybiB0aGlzLmRlc2NyaXB0aW9uOw0KICAgIH0NCg0KICAgIHRvSHRtbCgpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZTsNCiAgICB9DQp9DQoNCi8vIFNjcmlwdCBydW5uaW5nIG9uIE5vZGVKUw0KaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7DQogICAgbW9kdWxlLmV4cG9ydHMuSU9UeXBlcyA9IHsNCiAgICAgICAgSU9UeXBlOiBJT1R5cGUsDQogICAgICAgIFZvaWRJT1R5cGU6IFZvaWRJT1R5cGUsDQogICAgICAgIFdvcmQ6IFdvcmQsDQogICAgICAgIFNlbnRlbmNlOiBTZW50ZW5jZSwNCiAgICAgICAgUGFyYWdyYXBoOiBQYXJhZ3JhcGgsDQogICAgICAgIEFubm90YXRlZFBhcmFncmFwaDpBbm5vdGF0ZWRQYXJhZ3JhcGgsDQogICAgICAgIFBhcnNlZExhbmd1YWdlVHlwZTogUGFyc2VkTGFuZ3VhZ2VUeXBlLA0KICAgICAgICBQYWdlOiBQYWdlLA0KICAgICAgICBUYWdnZWRUZXh0OiBUYWdnZWRUZXh0LA0KICAgICAgICBJbWFnZUlPVHlwZTogSW1hZ2VJT1R5cGUsDQogICAgICAgIEF1ZGlvVHlwZTogQXVkaW9UeXBlLA0KICAgICAgICBVUkxUeXBlOiBVUkxUeXBlLA0KICAgICAgICBDb250ZW50UmVwbGFjZW1lbnQ6IENvbnRlbnRSZXBsYWNlbWVudCwNCiAgICAgICAgSmF2YVNjcmlwdFR5cGU6IEphdmFTY3JpcHRUeXBlLA0KICAgICAgICBFcnJvcjogRXJyb3IsDQogICAgICAgIE5vUmVzdWx0OiBOb1Jlc3VsdCwNCiAgICB9Ow0KfQ0K",
        "Y2xhc3MgVGV4dE1hcmtlciB7DQogICAgY29uc3RydWN0b3IodGV4dE5vZGVzLCB3b3Jkc1RvSGlnaExpZ2h0LCBjb25maWd1cmF0aW9uKSB7DQogICAgICAgIHRoaXMudGV4dE5vZGVzID0gdGV4dE5vZGVzOw0KICAgICAgICB0aGlzLm1hcmtlZFRleHROb2RlcyA9IFtdOw0KICAgICAgICB0aGlzLndvcmRzID0gd29yZHNUb0hpZ2hMaWdodDsNCg0KDQogICAgICAgIHRoaXMudGV4dE5vZGVzVG9NYXJrID0gW107DQogICAgICAgIHRoaXMuY3VycmVudE1hcmtlZFdvcmRJbmRleCA9IDA7DQoNCiAgICAgICAgdGhpcy51bmlDb2RlTGV0dGVyID0gWFJlZ0V4cCgnXlxccEwrJCcpOw0KDQogICAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsNCg0KICAgICAgICBsZXQgZGVmYXVsdENvbmZpZ3VyYXRpb24gPSB7DQogICAgICAgICAgICBoaWdobGlnaHRFbGVtZW50TmFtZTogInNwYW4iLA0KICAgICAgICAgICAgaGlnaGxpZ2h0RWxlbWVudENsYXNzOiAid29yZC1oaWdobGlnaHRlciIsDQogICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICIjMDAwMDAwIiwNCiAgICAgICAgICAgIGNvbG9yOiAiI2ZmZmYwMCIsDQoNCiAgICAgICAgfTsNCg0KICAgICAgICBpZiAoY29uZmlndXJhdGlvbikgew0KICAgICAgICAgICAgdGhpcy5jb25maWd1cmF0aW9uID0gJC5leHRlbmQoZGVmYXVsdENvbmZpZ3VyYXRpb24sIGNvbmZpZ3VyYXRpb24pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy5jb25maWd1cmF0aW9uID0gZGVmYXVsdENvbmZpZ3VyYXRpb247DQogICAgICAgIH0NCg0KDQogICAgfQ0KDQoNCiAgICBtYXJrTmV4dCgpIHsNCg0KDQogICAgICAgIGlmICh0aGlzLnRleHROb2Rlcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIGxldCBuZXh0VGV4dE5vZGVJbmRleDsNCg0KICAgICAgICBpZiAodGhpcy50ZXh0Tm9kZXNUb01hcmsubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICBuZXh0VGV4dE5vZGVJbmRleCA9IDA7DQogICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgIC8vV2hlbiBtYXJraW5nIHNlbnRlbmNlcyBhbmQgd29yZHMuIFNlbnRlbmNlIGdldHMgaGlnaGxpZ2h0ZWQgZmlyc3QuIFdyYXBzIGNsYXNzIG92ZXIgdGV4dCBub2RlLiBUZXh0IG5vZGUgZ2V0IHNlcGVyZXJhdGVkIGFuZCB3cmFwcGVkIGJ5IHdvcmQuIFdlIGZpbmQgbm93IHRoZSBsYXN0IGVsZW1lbnQNCiAgICAgICAgICAgIGxldCBjdXJyZW50VGV4dE5vZGVzID0gdGhpcy5nZXRUZXh0Tm9kZXMoJCh0aGlzLnRleHROb2Rlc1RvTWFya1t0aGlzLnRleHROb2Rlc1RvTWFyay5sZW5ndGggLSAxXSkucGFyZW50cygiLiIgKyB0aGlzLmNvbmZpZ3VyYXRpb24uaGlnaGxpZ2h0RWxlbWVudENsYXNzKSk7DQoNCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50ZXh0Tm9kZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICBpZiAodGhpcy50ZXh0Tm9kZXNbaV0gPT09IGN1cnJlbnRUZXh0Tm9kZXNbY3VycmVudFRleHROb2Rlcy5sZW5ndGggLSAxXSkgew0KICAgICAgICAgICAgICAgICAgICBuZXh0VGV4dE5vZGVJbmRleCA9IGkgKyAxOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KDQogICAgICAgIHRoaXMucmVtb3ZlKCk7DQoNCiAgICAgICAgdGhpcy50ZXh0Tm9kZXNUb01hcmsgPSBbXTsNCg0KICAgICAgICBpZiAodGhpcy5jdXJyZW50TWFya2VkV29yZEluZGV4ID09PSB0aGlzLndvcmRzLmxlbmd0aCkgew0KDQogICAgICAgICAgICAvL1dlIGFyZSBhdCB0aGUgZW5kIDstKQ0KICAgICAgICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWU7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KDQogICAgICAgIGxldCBjdXJyZW50Q2hhckluZGV4ID0gMDsNCiAgICAgICAgbGV0IHdvcmRTdGFydEluZGV4ID0gLTE7DQogICAgICAgIGxldCB3b3JkU3RhcnQgPSAtMTsNCiAgICAgICAgbGV0IGZpcnN0Q2hhckZvdW5kID0gZmFsc2U7DQoNCiAgICAgICAgZm9yIChsZXQgaSA9IG5leHRUZXh0Tm9kZUluZGV4OyBpIDwgdGhpcy50ZXh0Tm9kZXMubGVuZ3RoOyBpKyspIHsNCg0KDQogICAgICAgICAgICBsZXQgY3VycmVudFRleHQgPSB0aGlzLnRleHROb2Rlc1tpXS5kYXRhOw0KDQoNCiAgICAgICAgICAgIGxldCB2YWxpZFRleHROb2RlID0gdHJ1ZTsNCiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgY3VycmVudFRleHQubGVuZ3RoOyBrKyspIHsNCg0KICAgICAgICAgICAgICAgIGlmICh0aGlzLndvcmRzW3RoaXMuY3VycmVudE1hcmtlZFdvcmRJbmRleF0uY2hhckF0KGN1cnJlbnRDaGFySW5kZXgpID09PSBjdXJyZW50VGV4dC5jaGFyQXQoaykpIHsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAod29yZFN0YXJ0SW5kZXggPT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB3b3JkU3RhcnRJbmRleCA9IGs7DQogICAgICAgICAgICAgICAgICAgICAgICB3b3JkU3RhcnQgPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDaGFyRm91bmQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJJbmRleCsrOw0KDQogICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q2hhckluZGV4ID09PSB0aGlzLndvcmRzW3RoaXMuY3VycmVudE1hcmtlZFdvcmRJbmRleF0ubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvL1dvcmQgZm91bmQhDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRNYXJrZWRXb3JkSW5kZXgrKzsNCg0KDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHROb2Rlc1RvTWFyay5wdXNoKHRoaXMudGV4dE5vZGVzW2ldKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZvdW5kID0gZmFsc2U7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vU3BsaXQgRnJvbnQgVGV4dE5vZGUNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3b3JkU3RhcnRJbmRleCAhPT0gMCkgew0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3VGV4dE5vZGUgPSB0aGlzLnRleHROb2Rlc1t3b3JkU3RhcnRdLnNwbGl0VGV4dCh3b3JkU3RhcnRJbmRleCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RhcnRJbmRleCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgbCA9IDA7IGwgPCB0aGlzLnRleHROb2Rlcy5sZW5ndGg7IGwrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50ZXh0Tm9kZXNUb01hcmtbMF0gPT09IHRoaXMudGV4dE5vZGVzW2xdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydEluZGV4ID0gbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXh0Tm9kZXMuc3BsaWNlKHN0YXJ0SW5kZXggKyAxLCAwLCBuZXdUZXh0Tm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXh0Tm9kZXNUb01hcmtbMF0gPSBuZXdUZXh0Tm9kZTsgLy90aGlzLnRleHROb2Rlc1RvTWFya1swXS5zcGxpdFRleHQod29yZFN0YXJ0SW5kZXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvL1NwbGl0IEJhY2sgVGV4dE5vZGUNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3b3JkU3RhcnRJbmRleCAhPT0gMCAmJiB0aGlzLnRleHROb2Rlc1RvTWFyay5sZW5ndGggPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3VGV4dE5vZGUgPSB0aGlzLnRleHROb2Rlc1RvTWFya1swXS5zcGxpdFRleHQoayArIDEgLSB3b3JkU3RhcnRJbmRleCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXh0Tm9kZXMuc3BsaWNlKGkgKyAxLCAwLCBuZXdUZXh0Tm9kZSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3VGV4dE5vZGUgPSB0aGlzLnRleHROb2Rlc1tpXS5zcGxpdFRleHQoayArIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGV4dE5vZGVzLnNwbGljZShpICsgMSwgMCwgbmV3VGV4dE5vZGUpOw0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzLnRleHROb2Rlc1RvTWFyaykud3JhcCgiPCIgKyB0aGlzLmNvbmZpZ3VyYXRpb24uaGlnaGxpZ2h0RWxlbWVudE5hbWUgKyAiIGNsYXNzPSciICsgdGhpcy5jb25maWd1cmF0aW9uLmhpZ2hsaWdodEVsZW1lbnRDbGFzcyArICInIHN0eWxlPSdiYWNrZ3JvdW5kOiIgKyB0aGlzLmNvbmZpZ3VyYXRpb24uYmFja2dyb3VuZENvbG9yICsgIjsgY29sb3I6IiArIHRoaXMuY29uZmlndXJhdGlvbi5jb2xvciArICInPjwvIiArIHRoaXMuY29uZmlndXJhdGlvbi5oaWdobGlnaHRFbGVtZW50TmFtZSArICI+Iik7DQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KDQoNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzTnVtYmVyT3JVbmljb2RlTGV0dGVyKGN1cnJlbnRUZXh0LmNoYXJBdChrKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkVGV4dE5vZGUgPSBmYWxzZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIk5vdCBjb25mb3JtIGxldHRlciBkZXRlY3RlZC4iKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJUVFMgd29yZCBsZXR0ZXJzIGRvIG5vdCBtYXRjaCB0aGUgSFRNTCBsZXR0ZXJzIik7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIik7DQoNCg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHZhbGlkVGV4dE5vZGUgJiYgZmlyc3RDaGFyRm91bmQpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnRleHROb2Rlc1RvTWFyay5wdXNoKHRoaXMudGV4dE5vZGVzW2ldKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICByZW1vdmUoKSB7DQoNCiAgICAgICAgaWYgKHRoaXMudGV4dE5vZGVzLmxlbmd0aCA+IDApIHsNCg0KDQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudGV4dE5vZGVzLmxlbmd0aDsgaSsrKSB7DQoNCiAgICAgICAgICAgICAgICBsZXQgaGlnaGxpZ2h0U3BhbiA9ICQodGhpcy50ZXh0Tm9kZXNbaV0pLnBhcmVudHMoIi4iICsgdGhpcy5jb25maWd1cmF0aW9uLmhpZ2hsaWdodEVsZW1lbnRDbGFzcyk7DQogICAgICAgICAgICAgICAgaWYgKGhpZ2hsaWdodFNwYW4ubGVuZ3RoICE9PSAwKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYoaGlnaGxpZ2h0U3BhblswXS5jaGlsZE5vZGVzWzBdKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICQoaGlnaGxpZ2h0U3BhblswXS5jaGlsZE5vZGVzWzBdKS51bndyYXAoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KDQoNCiAgICB9DQoNCg0KICAgIGdldFRleHROb2RlcyhlbGVtZW50KSB7DQoNCiAgICAgICAgbGV0IHRleHROb2RlcyA9IFtdOw0KDQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZWxlbWVudC5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgaWYgKGVsZW1lbnRbaV0ubm9kZU5hbWUgIT09ICcjdGV4dCcpIHsNCiAgICAgICAgICAgICAgICB0ZXh0Tm9kZXMgPSB0ZXh0Tm9kZXMuY29uY2F0KHRoaXMuZ2V0Q2hpbGRUZXh0Tm9kZXMoZWxlbWVudFtpXSkpDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRleHROb2Rlcy5wdXNoKGVsZW1lbnRbaV0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0ZXh0Tm9kZXM7DQogICAgfQ0KDQogICAgZ2V0Q2hpbGRUZXh0Tm9kZXMobm9kZSkgew0KICAgICAgICBsZXQgdGV4dE5vZGVzID0gW107DQoNCiAgICAgICAgbGV0IGNoaWxkTm9kZXMgPSBub2RlLmNoaWxkTm9kZXM7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgaWYgKGNoaWxkTm9kZXNbaV0ubm9kZU5hbWUgIT09ICcjdGV4dCcpIHsNCiAgICAgICAgICAgICAgICB0ZXh0Tm9kZXMgPSB0ZXh0Tm9kZXMuY29uY2F0KHRoaXMuZ2V0Q2hpbGRUZXh0Tm9kZXMoY2hpbGROb2Rlc1tpXSkpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgIHRleHROb2Rlcy5wdXNoKGNoaWxkTm9kZXNbaV0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0ZXh0Tm9kZXM7DQoNCiAgICB9DQoNCiAgICBpc051bWJlck9yVW5pY29kZUxldHRlcihjaGFyKSB7DQoNCiAgICAgICAgaWYgKGNoYXIgPT09ICIiIHx8IGNoYXIgPT09ICI6IiB8fCBjaGFyID09PSAiLiIgfHwgY2hhciA9PT0gJyInIHx8IGNoYXIgPT09ICcsJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgIC8vQ2hlY2sgaWYgaXQgaXMgYSBudW1iZXIuLi4NCiAgICAgICAgaWYgKCcwMTIzNDU2Nzg5Jy5pbmRleE9mKGNoYXIpICE9PSAtMSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICAvL0NoZWNrIGlmIGl0IGlzIGEgdW5pY29jZGUgY2hhcg0KICAgICAgICByZXR1cm4gdGhpcy51bmlDb2RlTGV0dGVyLnRlc3QoY2hhcik7DQoNCiAgICB9DQoNCn0=",
        "Y2xhc3MgSFRNTEl0ZXJhdG9yew0KDQogICAgY29uc3RydWN0b3IoaW5pdGlhbEVsZW1lbnQpew0KICAgICAgICB0aGlzLmN1cnJlbnRFbGVtZW50cyA9IFtdOw0KICAgICAgICB0aGlzLmN1cnJlbnRFbGVtZW50cy5wdXNoKGluaXRpYWxFbGVtZW50KTsNCiAgICAgICAgdGhpcy5jdXJyZW50RWxlbWVudCA9ICQoaW5pdGlhbEVsZW1lbnQpOw0KICAgICAgICB0aGlzLmluaXRpYWxTdGF0ZSA9IHRydWU7DQogICAgICAgIHRoaXMudGV4dE5vZGVzID0gW107DQogICAgICAgIHRoaXMudGV4dENvbnRhaW5lclR5cGVzID0gWw0KICAgICAgICAgICAgInAiLA0KICAgICAgICAgICAgImRpdiIsDQogICAgICAgICAgICAiYm9keSIsDQogICAgICAgICAgICAiY29kZSIsDQogICAgICAgICAgICAiaDEiLA0KICAgICAgICAgICAgImgyIiwNCiAgICAgICAgICAgICJoMyIsDQogICAgICAgICAgICAiaDQiLA0KICAgICAgICAgICAgImg1IiwNCiAgICAgICAgICAgICJoNiIsDQogICAgICAgICAgICAidWwiLA0KICAgICAgICAgICAgImRsIiwNCiAgICAgICAgICAgICJvbCIsDQogICAgICAgICAgICAidWwiLA0KICAgICAgICAgICAgInRhYmxlIiwNCiAgICAgICAgICAgICJ0ZXh0YXJlYSIsDQogICAgICAgICAgICAiYmxvY2txdW90ZSIsDQogICAgICAgICAgICAiYXNpZGUiLA0KICAgICAgICAgICAgImFydGljbGUiLA0KICAgICAgICAgICAgImFkZHJlc3MiLA0KICAgICAgICAgICAgImZpZWxkc2V0IiwNCiAgICAgICAgICAgICJmaWdjYXB0aW9uIiwNCiAgICAgICAgICAgICJmb290ZXIiLA0KICAgICAgICAgICAgImZvcm0iLA0KICAgICAgICAgICAgImhlYWRlciIsDQogICAgICAgICAgICAibWFpbiIsDQogICAgICAgICAgICAibmF2IiwNCiAgICAgICAgICAgICJwcmUiLA0KICAgICAgICAgICAgInNlY3Rpb24iLA0KICAgICAgICAgICAgInRhYmxlIiwNCiAgICAgICAgICAgICJsaSIsDQogICAgICAgICAgICAidGQiLA0KDQoNCg0KDQoNCg0KICAgICAgICBdOw0KDQogICAgICAgIHRoaXMucG9zc2libGVDb250YWluZXJzID0gWw0KICAgICAgICAgICAgImIiLA0KICAgICAgICAgICAgImJpZyIsDQogICAgICAgICAgICAiaSIsDQogICAgICAgICAgICAic21hbGwiLA0KICAgICAgICAgICAgInR0IiwNCiAgICAgICAgICAgICJhYmJyIiwiYWNyb255bSIsImNpdGUiLCJjb2RlIiwiZGZuIiwiZW0iLCJrZGIiLCJzdHJvbmciLCJzYW1wIiwidmFyIiwNCiAgICAgICAgICAgICJhIiwgImJkbyIsICJiciIsICJpbWciLCAibWFwIiwgIm9iamVjdCIsICJxIiwgInN1YiIsICJzdXAiLA0KICAgICAgICAgICAgInNwYW4iLA0KICAgICAgICAgICAgImJ1dHRvbiIsDQogICAgICAgICAgICAiaW5wdXQiDQoNCg0KICAgICAgICBdOw0KDQogICAgICAgIHRoaXMubm9uVGV4dENvbnRhaW5lclR5cGVzID0gWw0KICAgICAgICAgICAgInNjcmlwdCIsDQogICAgICAgICAgICAibm9zY3JpcHQiLA0KICAgICAgICAgICAgInN0eWxlIg0KICAgICAgICBdOw0KDQogICAgICAgIHRoaXMudW5pQ29kZUxldHRlciA9IFhSZWdFeHAoJ15cXHBMKyQnKTsNCiAgICB9DQogICAgZ2V0TmV4dEVsZW1lbnRzKCl7DQoNCiAgICAgICAgdGhpcy5jdXJyZW50RWxlbWVudHMgPSBbXTsNCiAgICAgICAgaWYodGhpcy5pbml0aWFsU3RhdGUpew0KICAgICAgICAgICAgdGhpcy5pbml0aWFsU3RhdGUgPSBmYWxzZTsNCiAgICAgICAgfWVsc2V7DQoNCiAgICAgICAgICAgIGlmKHRoaXMuY3VycmVudEVsZW1lbnQubm9kZU5hbWUgPT09ICIjdGV4dCIgJiYgdGhpcy50ZXh0Tm9kZXMubGVuZ3RoICE9PSAwKXsNCiAgICAgICAgICAgICAgICAvL0lmIHRoZSBjdXJyZW50IG5vZGUgaXMgYSB0ZXh0bm9kZSBpdCBpcyBsaWtlbHkgdGhhdCBpdCBoYXMgYmVlbiBzcGxpdHRlZC4gVGhlcmVmb3JlIHdlIHRha2UgdGhlIGxhc3QgZWxlbWVudC4NCiAgICAgICAgICAgICAgICAvL3RleHROb2RlcyBpcyBzaGFyZWQgYnkgcmVmZXJlbmNlIHRvIGFsbCBvdGhlciBoaWdobGlnaHRuaW5nIG1lY2hhbmlzbXMNCiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRFbGVtZW50ID0gdGhpcy5nZXRGaXJzdEVsZW1lbnQodGhpcy50ZXh0Tm9kZXNbdGhpcy50ZXh0Tm9kZXMubGVuZ3RoLTFdKTsNCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEVsZW1lbnQgPSB0aGlzLmdldEZpcnN0RWxlbWVudCh0aGlzLmN1cnJlbnRFbGVtZW50KTsNCiAgICAgICAgICAgIH0NCg0KDQoNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLnRleHRFbGVtZW50Rm91bmQgPSBmYWxzZTsNCg0KICAgICAgICBpZih0aGlzLmN1cnJlbnRFbGVtZW50KXsNCg0KICAgICAgICAgICAgdGhpcy5jdXJyZW50RWxlbWVudHMucHVzaCh0aGlzLmN1cnJlbnRFbGVtZW50KTsNCg0KICAgICAgICAgICAgLy93aGlsZSBpdCBpcyBhIHRleHRub2RlIG9yIGlubGluZSBlbGVtZW50DQoNCiAgICAgICAgICAgIHdoaWxlKHRoaXMuY3VycmVudEVsZW1lbnQubm9kZU5hbWUgPT09IiN0ZXh0IiB8fCB0aGlzLnRleHRDb250YWluZXJUeXBlcy5pbmRleE9mKCQodGhpcy5jdXJyZW50RWxlbWVudCkucHJvcCgnbm9kZU5hbWUnKS50b0xvd2VyQ2FzZSgpKSA9PT0gLTEpew0KDQoNCiAgICAgICAgICAgICAgICBpZighdGhpcy50ZXh0RWxlbWVudEZvdW5kKXsNCiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5jdXJyZW50RWxlbWVudC5ub2RlTmFtZSA9PT0gIiN0ZXh0Iikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY29udGFpbnNUZXh0KHRoaXMuY3VycmVudEVsZW1lbnQpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHRFbGVtZW50Rm91bmQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGV4dEVsZW1lbnRGb3VuZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgIGxldCBuZXdFbGVtZW50ID0gdGhpcy5nZXROZXh0RWxlbWVudCh0aGlzLmN1cnJlbnRFbGVtZW50LCF0aGlzLnRleHRFbGVtZW50Rm91bmQpOw0KDQogICAgICAgICAgICAgICAgaWYoIW5ld0VsZW1lbnQpew0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQoNCg0KDQogICAgICAgICAgICAgICAgaWYobmV3RWxlbWVudC5ub2RlTmFtZSA9PT0iI3RleHQiIHx8IHRoaXMudGV4dENvbnRhaW5lclR5cGVzLmluZGV4T2YoJChuZXdFbGVtZW50KS5wcm9wKCdub2RlTmFtZScpLnRvTG93ZXJDYXNlKCkpID09PSAtMSl7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEVsZW1lbnQgPSBuZXdFbGVtZW50Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRFbGVtZW50cy5wdXNoKG5ld0VsZW1lbnQpOw0KICAgICAgICAgICAgICAgIH1lbHNlIGlmKCAhdGhpcy50ZXh0RWxlbWVudEZvdW5kKXsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50RWxlbWVudCA9IG5ld0VsZW1lbnQ7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEVsZW1lbnRzLnB1c2gobmV3RWxlbWVudCk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5ub3JtYWxpemVPbGRUZXh0Tm9kZXMoKTsNCg0KICAgICAgICAgICAgdGhpcy50ZXh0Tm9kZXMgPSBbXTsNCiAgICAgICAgICAgIGxldCBvbmVUZXh0Tm9kZUhhc1RleHQgPSBmYWxzZTsNCiAgICAgICAgICAgIGZvcihsZXQgaT0wOyBpIDwgdGhpcy5jdXJyZW50RWxlbWVudHMubGVuZ3RoOyBpKyspew0KICAgICAgICAgICAgICAgIGxldCBjdXJyZW50VGV4dE5vZGVzID0gdGhpcy5nZXRUZXh0Tm9kZXModGhpcy5jdXJyZW50RWxlbWVudHNbaV0pOw0KICAgICAgICAgICAgICAgIGZvcihsZXQgaz0wOyBrIDwgY3VycmVudFRleHROb2Rlcy5sZW5ndGg7IGsrKyl7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYoJChjdXJyZW50VGV4dE5vZGVzW2tdLnBhcmVudE5vZGUpLmlzKCI6dmlzaWJsZSIpICYmICQoY3VycmVudFRleHROb2Rlc1trXS5wYXJlbnROb2RlKS5jc3MoJ2Rpc3BsYXknKSAhPT0gJ25vbmUnICYmICQoY3VycmVudFRleHROb2Rlc1trXS5wYXJlbnROb2RlKS5jc3MoInZpc2liaWxpdHkiKSAhPT0gImhpZGRlbiIpew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWxlbWVudCBpcyBub3QgaGlkZGVuDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHROb2Rlcy5wdXNoKGN1cnJlbnRUZXh0Tm9kZXNba10pOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZighb25lVGV4dE5vZGVIYXNUZXh0KXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmNvbnRhaW5zVGV4dChjdXJyZW50VGV4dE5vZGVzW2tdKSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uZVRleHROb2RlSGFzVGV4dCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9DQoNCg0KDQogICAgICAgICAgICBpZih0aGlzLnRleHROb2Rlcy5sZW5ndGggPT09IDAgfHwgIW9uZVRleHROb2RlSGFzVGV4dCl7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXROZXh0RWxlbWVudHMoKTsNCiAgICAgICAgICAgIH1lbHNlew0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgdGV4dE5vZGVzOnRoaXMudGV4dE5vZGVzLA0KICAgICAgICAgICAgICAgICAgICBlbGVtZW50OnRoaXMuY3VycmVudEVsZW1lbnQsDQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzOiB0aGlzLmN1cnJlbnRFbGVtZW50cywNCiAgICAgICAgICAgICAgICAgICAgdGV4dDokKHRoaXMudGV4dE5vZGVzKS50ZXh0KCksDQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiQodGhpcy50ZXh0Tm9kZXMpLnRleHQoKSwNCiAgICAgICAgICAgICAgICAgICAgbGFuZzogcGFnZVV0aWxzLnV0aWwuZ2V0TGFuZ3VhZ2VPZkVsZW1lbnQodGhpcy50ZXh0Tm9kZXNbMF0pLA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KDQoNCg0KDQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIGdldEZpcnN0RWxlbWVudChsYXN0RWxlbWVudCl7DQoNCiAgICAgICAgaWYobGFzdEVsZW1lbnQpew0KDQoNCg0KICAgICAgICAgICAgbGV0IHRleHROb2RlID0gbnVsbDsNCiAgICAgICAgICAgIGxldCBjdXJyZW50RWxlbWVudFRlbXAgPSAkKGxhc3RFbGVtZW50KTsNCiAgICAgICAgICAgIHdoaWxlKCF0ZXh0Tm9kZSl7DQoNCiAgICAgICAgICAgICAgICAvLzxkaXY+dGV4dDwvZGl2PnN0YW5kYWxvbmVUZXh0bm9kZTxwPnNvbWUgdGV4dDwvcD4gc3RhbmRhbG9uZXRleHRub2RlID0gdGV4dG5vZGUgYmV0d2VlbiB0byBibG9ja3MNCiAgICAgICAgICAgICAgICBsZXQgc3RhbmRhbG9uZVRleHROb2RlID0gdGhpcy5nZXROZXh0U3RhbmRhbG9uZVRleHROb2RlKGN1cnJlbnRFbGVtZW50VGVtcCk7DQoNCiAgICAgICAgICAgICAgICBpZihzdGFuZGFsb25lVGV4dE5vZGUpew0KICAgICAgICAgICAgICAgICAgICAvL09ubHkgcmV0dXJuIHRoaXMgd2hlbiB0aGUgcGFyZW50IGNvbnRhaW5lciBkb2VzIGNvbnRhaW4gYmxvY2sgY29udGFpbmVycw0KICAgICAgICAgICAgICAgICAgICAvLyAgaWYodGhpcy5lbGVtZW50Q29udGFpbnNUZXh0Q29udGFpbmVyKCQoY3VycmVudEVsZW1lbnRUZW1wKS5wYXJlbnQoKSkpew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RhbmRhbG9uZVRleHROb2RlOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIH0NCg0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50VGVtcCA9IHRoaXMuZ2V0TmV4dE9yUGFyZW50TmV4dChjdXJyZW50RWxlbWVudFRlbXApOw0KDQogICAgICAgICAgICAgICAgaWYoIWN1cnJlbnRFbGVtZW50VGVtcCl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYoY3VycmVudEVsZW1lbnRUZW1wLmxlbmd0aCA9PT0gMCl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0ZXh0Tm9kZSA9IHRoaXMuZ2V0Rmlyc3RUZXh0Tm9kZShjdXJyZW50RWxlbWVudFRlbXApOw0KDQoNCiAgICAgICAgICAgICAgICBsZXQgbmV4dEVsZW1lbnQgPSB0aGlzLmdldENvbnRhaW5lck9mVGV4dE5vZGUodGV4dE5vZGUpOw0KDQoNCiAgICAgICAgICAgICAgICAvL0ZvdW5kIGJhZCBpdGVtIGxvb2tpbmcgZm9yIG5leHQNCiAgICAgICAgICAgICAgICBpZihuZXh0RWxlbWVudCl7DQogICAgICAgICAgICAgICAgICAgIGlmKHRoaXMubm9uVGV4dENvbnRhaW5lclR5cGVzLmluZGV4T2YobmV4dEVsZW1lbnQucHJvcCgnbm9kZU5hbWUnKS50b0xvd2VyQ2FzZSgpKSAhPT0gLTEpew0KDQogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RWxlbWVudFRlbXAgPSBuZXh0RWxlbWVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRFbGVtZW50ID0gbnVsbDsNCg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICBpZihuZXh0RWxlbWVudCl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0RWxlbWVudDsNCiAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgdGV4dE5vZGUgPSBudWxsOw0KICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIGdldE5leHRFbGVtZW50KGxhc3RFbGVtZW50KXsNCg0KICAgICAgICBpZihsYXN0RWxlbWVudCl7DQoNCiAgICAgICAgICAgIC8vPGRpdj50ZXh0PC9kaXY+c3RhbmRhbG9uZVRleHRub2RlPHA+c29tZSB0ZXh0PC9wPiBzdGFuZGFsb25ldGV4dG5vZGUgPSB0ZXh0bm9kZSBiZXR3ZWVuIHRvIGJsb2Nrcw0KICAgICAgICAgICAgbGV0IHN0YW5kYWxvbmVUZXh0Tm9kZSA9IHRoaXMuZ2V0TmV4dFN0YW5kYWxvbmVUZXh0Tm9kZSgkKGxhc3RFbGVtZW50KSk7DQoNCiAgICAgICAgICAgIGlmKHN0YW5kYWxvbmVUZXh0Tm9kZSl7DQogICAgICAgICAgICAgICAgLy9Pbmx5IHJldHVybiB0aGlzIHdoZW4gdGhlIHBhcmVudCBjb250YWluZXIgZG9lcyBjb250YWluIGJsb2NrIGNvbnRhaW5lcnMNCiAgICAgICAgICAgICAgICAvLyAgaWYodGhpcy5lbGVtZW50Q29udGFpbnNUZXh0Q29udGFpbmVyKCQoY3VycmVudEVsZW1lbnRUZW1wKS5wYXJlbnQoKSkpew0KICAgICAgICAgICAgICAgIHJldHVybiBzdGFuZGFsb25lVGV4dE5vZGU7DQoNCiAgICAgICAgICAgICAgICAvLyB9DQoNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYoJChsYXN0RWxlbWVudCkubmV4dCgpLmxlbmd0aCAhPT0gMCl7DQoNCiAgICAgICAgICAgICAgICAvL0JlIHN1cmUgbmV4dCBlbGVtZW50IHdvdWxkIG5vdCBiZSBhIG5ldyBibG9jayBlbGVtZW50Li4uLg0KICAgICAgICAgICAgICAgIGlmKCB0aGlzLnRleHRDb250YWluZXJUeXBlcy5pbmRleE9mKCQobGFzdEVsZW1lbnQpLm5leHQoKS5wcm9wKCdub2RlTmFtZScpLnRvTG93ZXJDYXNlKCkpID09PSAtMSApew0KDQogICAgICAgICAgICAgICAgICAgIHJldHVybiAkKGxhc3RFbGVtZW50KS5uZXh0KCk7DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIGdldEZpcnN0VGV4dE5vZGUoZWxlbWVudCkgew0KDQogICAgICAgIGZvcihsZXQgaT0wOyBpIDwgZWxlbWVudC5sZW5ndGg7IGkrKyl7DQogICAgICAgICAgICBpZihlbGVtZW50W2ldLm5vZGVOYW1lICE9PSAnI3RleHQnKXsNCg0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEZpcnN0Q2hpbGRUZXh0Tm9kZXMoZWxlbWVudFtpXSk7DQogICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICBpZih0aGlzLmNvbnRhaW5zVGV4dCggZWxlbWVudFtpXSkpew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudFtpXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBnZXRGaXJzdENoaWxkVGV4dE5vZGVzIChub2RlKSB7DQogICAgICAgIGxldCBjaGlsZE5vZGVzID0gbm9kZS5jaGlsZE5vZGVzOw0KICAgICAgICBmb3IobGV0IGk9MDsgaSA8IGNoaWxkTm9kZXMubGVuZ3RoOyBpKyspew0KICAgICAgICAgICAgaWYoY2hpbGROb2Rlc1tpXS5ub2RlTmFtZSAhPT0gJyN0ZXh0Jyl7DQogICAgICAgICAgICAgICAgbGV0IHRleHROb2RlID0gdGhpcy5nZXRGaXJzdENoaWxkVGV4dE5vZGVzKGNoaWxkTm9kZXNbaV0pOw0KICAgICAgICAgICAgICAgIGlmKHRleHROb2RlKXsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRleHROb2RlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH1lbHNlew0KDQogICAgICAgICAgICAgICAgaWYodGhpcy5jb250YWluc1RleHQoY2hpbGROb2Rlc1tpXSkpew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGROb2Rlc1tpXTsNCiAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCg0KICAgIH0NCg0KICAgIGdldFRleHROb2RlcyhlbGVtZW50KSB7DQoNCiAgICAgICAgbGV0IHRleHROb2RlcyA9IFtdOw0KICAgICAgICBpZihlbGVtZW50Lm5vZGVOYW1lID09PSAiI3RleHQiKXsNCiAgICAgICAgICAgIHRleHROb2Rlcy5wdXNoKGVsZW1lbnQpOw0KICAgICAgICAgICAgcmV0dXJuIHRleHROb2RlczsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcihsZXQgaT0wOyBpIDwgZWxlbWVudC5sZW5ndGg7IGkrKyl7DQogICAgICAgICAgICBpZihlbGVtZW50W2ldLm5vZGVOYW1lICE9PSAnI3RleHQnKXsNCiAgICAgICAgICAgICAgICB0ZXh0Tm9kZXMgPSB0ZXh0Tm9kZXMuY29uY2F0KHRoaXMuZ2V0Q2hpbGRUZXh0Tm9kZXMoZWxlbWVudFtpXSkpDQogICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICB0ZXh0Tm9kZXMucHVzaChlbGVtZW50W2ldKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdGV4dE5vZGVzOw0KICAgIH0NCg0KICAgIGdldENoaWxkVGV4dE5vZGVzIChub2RlKSB7DQogICAgICAgIGxldCB0ZXh0Tm9kZXMgPSBbXTsNCg0KICAgICAgICBsZXQgY2hpbGROb2RlcyA9IG5vZGUuY2hpbGROb2RlczsNCiAgICAgICAgZm9yKGxldCBpPTA7IGkgPCBjaGlsZE5vZGVzLmxlbmd0aDsgaSsrKXsNCiAgICAgICAgICAgIGlmKGNoaWxkTm9kZXNbaV0ubm9kZU5hbWUgIT09ICcjdGV4dCcpew0KICAgICAgICAgICAgICAgIHRleHROb2RlcyA9IHRleHROb2Rlcy5jb25jYXQodGhpcy5nZXRDaGlsZFRleHROb2RlcyhjaGlsZE5vZGVzW2ldKSk7DQogICAgICAgICAgICB9ZWxzZXsNCg0KICAgICAgICAgICAgICAgIHRleHROb2Rlcy5wdXNoKGNoaWxkTm9kZXNbaV0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0ZXh0Tm9kZXM7DQoNCiAgICB9DQoNCiAgICBnZXRDb250YWluZXJPZlRleHROb2RlKHRleHROb2RlKXsNCg0KICAgICAgICBsZXQgcGFyZW50ID0gJCh0ZXh0Tm9kZSkucGFyZW50KCk7DQoNCiAgICAgICAgaWYocGFyZW50Lmxlbmd0aCAhPT0wKXsNCg0KDQoNCiAgICAgICAgICAgIGlmKHRoaXMudGV4dENvbnRhaW5lclR5cGVzLmluZGV4T2YocGFyZW50LnByb3AoJ25vZGVOYW1lJykudG9Mb3dlckNhc2UoKSkgIT09IC0xKXsNCiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSBpZih0aGlzLm5vblRleHRDb250YWluZXJUeXBlcy5pbmRleE9mKHBhcmVudC5wcm9wKCdub2RlTmFtZScpLnRvTG93ZXJDYXNlKCkpICE9PSAtMSl7DQogICAgICAgICAgICAgICAgLy9Gb3VuZCBiYWQgaXRlbQ0KICAgICAgICAgICAgICAgIHJldHVybiBwYXJlbnQ7DQogICAgICAgICAgICB9IGVsc2V7DQoNCiAgICAgICAgICAgICAgICAvKg0KICAgICAgICAgICAgICAgIGlmKHRoaXMucG9zc2libGVDb250YWluZXJzLmluZGV4T2YocGFyZW50LnByb3AoJ25vZGVOYW1lJykudG9Mb3dlckNhc2UoKSkgIT09IC0xKXsNCg0KICAgICAgICAgICAgICAgICAgICBsZXQgcGFyZW50TmV4dCA9ICQocGFyZW50KS5uZXh0KCk7DQoNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUocGFyZW50TmV4dC5sZW5ndGggIT09IDApew0KDQogICAgICAgICAgICAgICAgICAgICAgICAvL0NoZWNrIGlmIHBhcmVudCBuZXh0IGlzIGEgdGV4dCBjb250YWluZXINCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMudGV4dENvbnRhaW5lclR5cGVzLmluZGV4T2YocGFyZW50TmV4dC5wcm9wKCdub2RlTmFtZScpLnRvTG93ZXJDYXNlKCkpICE9PSAtMSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgICAgICAgICAvL0NoZWNrIGlmIGFueSBzdWNjZXNzb3IgaXMgYSB0ZXh0IGNvbnRhaW5lcg0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpPSAwOyBpIDwgdGhpcy50ZXh0Q29udGFpbmVyVHlwZXMubGVuZ3RoOyBpKyspew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCQocGFyZW50TmV4dCkuZmluZCh0aGlzLnRleHRDb250YWluZXJUeXBlc1tpXSkubGVuZ3RoICE9PSAwKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudE5leHQgPSAkKHBhcmVudE5leHQpLm5leHQoKTsNCg0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmVudFByZXYgPSAkKHBhcmVudCkucHJldigpOw0KDQogICAgICAgICAgICAgICAgICAgIHdoaWxlKHBhcmVudFByZXYubGVuZ3RoICE9PSAwKXsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy9DaGVjayBpZiBwYXJlbnQgcHJldiBpcyBhIHRleHQgY29udGFpbmVyDQogICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnRleHRDb250YWluZXJUeXBlcy5pbmRleE9mKHBhcmVudFByZXYucHJvcCgnbm9kZU5hbWUnKS50b0xvd2VyQ2FzZSgpKSAhPT0gLTEpew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgICAgICAgICAvL0NoZWNrIGlmIGFueSBzdWNjZXNzb3IgaXMgYSB0ZXh0IGNvbnRhaW5lcg0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpPSAwOyBpIDwgdGhpcy50ZXh0Q29udGFpbmVyVHlwZXMubGVuZ3RoOyBpKyspew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJChwYXJlbnRQcmV2KS5maW5kKHRoaXMudGV4dENvbnRhaW5lclR5cGVzW2ldKS5sZW5ndGggIT09IDApew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudFByZXYgPSAkKHBhcmVudFByZXYpLnByZXYoKTsNCg0KICAgICAgICAgICAgICAgICAgICB9DQoNCg0KDQoNCg0KDQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb250YWluZXJPZlRleHROb2RlKHBhcmVudCk7DQogICAgICAgICAgICB9DQoNCg0KICAgICAgICB9DQoNCg0KDQoNCg0KDQogICAgfQ0KDQogICAgZ2V0TmV4dE9yUGFyZW50TmV4dChlbGVtZW50KXsNCg0KICAgICAgICBpZihlbGVtZW50Lm5leHQoKS5sZW5ndGggIT09IDApew0KICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQubmV4dCgpOw0KICAgICAgICB9DQoNCg0KICAgICAgICBsZXQgcGFyZW50RWxlbWVudCA9ICQoZWxlbWVudCkucGFyZW50KCk7DQogICAgICAgIHdoaWxlKHBhcmVudEVsZW1lbnQubGVuZ3RoICE9PTApew0KDQoNCiAgICAgICAgICAgIGlmKCQocGFyZW50RWxlbWVudCkubmV4dCgpLmxlbmd0aCAhPT0gMCl7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJChwYXJlbnRFbGVtZW50KS5uZXh0KCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHBhcmVudEVsZW1lbnQgPSAkKHBhcmVudEVsZW1lbnQpLnBhcmVudCgpOw0KDQoNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlzTnVtYmVyT3JVbmljb2RlTGV0dGVyKGNoYXIpew0KDQogICAgICAgIGlmKGNoYXIgPT09ICIiKXsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vQ2hlY2sgaWYgaXQgaXMgYSBudW1iZXIuLi4NCiAgICAgICAgaWYgKCcwMTIzNDU2Nzg5IS4/Jy5pbmRleE9mKGNoYXIpICE9PSAtMSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICAvL0NoZWNrIGlmIGl0IGlzIGEgdW5ub2NkZUxldHRlcg0KICAgICAgICByZXR1cm4gdGhpcy51bmlDb2RlTGV0dGVyLnRlc3QoY2hhcik7DQoNCiAgICB9DQoNCiAgICBjb250YWluc1RleHQodGV4dE5vZGUpew0KDQogICAgICAgIGxldCBjdXJyZW50VGV4dCA9IHRleHROb2RlLmRhdGE7DQoNCiAgICAgICAgZm9yIChsZXQgaT0wOyBpIDwgY3VycmVudFRleHQubGVuZ3RoOyBpKyspIHsNCg0KICAgICAgICAgICAgaWYodGhpcy5pc051bWJlck9yVW5pY29kZUxldHRlcihjdXJyZW50VGV4dC5jaGFyQXQoaSkpKXsNCg0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgZ2V0TmV4dFN0YW5kYWxvbmVUZXh0Tm9kZShlbGVtZW50KXsNCg0KICAgICAgICBsZXQgY3VycmVudEVsZW1lbnQgPSAkKGVsZW1lbnQpOw0KICAgICAgICBpZihjdXJyZW50RWxlbWVudC5sZW5ndGggPiAwKXsNCiAgICAgICAgICAgIGlmKGN1cnJlbnRFbGVtZW50WzBdLm5leHRTaWJsaW5nKXsNCiAgICAgICAgICAgICAgICBpZihjdXJyZW50RWxlbWVudFswXS5uZXh0U2libGluZy5ub2RlTmFtZSA9PT0gIiN0ZXh0Iil7DQogICAgICAgICAgICAgICAgICAgIC8vICAgICBpZih0aGlzLmNvbnRhaW5zVGV4dChjdXJyZW50RWxlbWVudFswXS5uZXh0U2libGluZykpew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3VycmVudEVsZW1lbnRbMF0ubmV4dFNpYmxpbmcNCiAgICAgICAgICAgICAgICAgICAgLy8gICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgZWxlbWVudENvbnRhaW5zVGV4dENvbnRhaW5lcihlbGVtZW50KXsNCiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMudGV4dENvbnRhaW5lclR5cGVzLmxlbmd0aDsgaSArKyl7DQoNCiAgICAgICAgICAgIGlmKCQoZWxlbWVudCkuZmluZCh0aGlzLnRleHRDb250YWluZXJUeXBlc1tpXSkubGVuZ3RoICE9PSAwKXsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQoNCiAgICBub3JtYWxpemVPbGRUZXh0Tm9kZXMoKXsNCiAgICAgICAgbGV0IHBhcmVudEVsZW1lbnRzID0gW107DQogICAgICAgIGZvcihsZXQgaT0wOyBpIDwgdGhpcy50ZXh0Tm9kZXMubGVuZ3RoOyBpKyspew0KDQogICAgICAgICAgICBpZihwYXJlbnRFbGVtZW50cy5pbmRleE9mKHRoaXMudGV4dE5vZGVzW2ldLnBhcmVudE5vZGUpID09PSAtMSl7DQogICAgICAgICAgICAgICAgcGFyZW50RWxlbWVudHMucHVzaCh0aGlzLnRleHROb2Rlc1tpXS5wYXJlbnROb2RlKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQogICAgICAgIGZvcihsZXQgaT0wOyBpIDwgcGFyZW50RWxlbWVudHMubGVuZ3RoOyBpKyspew0KICAgICAgICAgICAgaWYocGFyZW50RWxlbWVudHNbaV0pew0KICAgICAgICAgICAgICAgIHBhcmVudEVsZW1lbnRzW2ldLm5vcm1hbGl6ZSgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KICAgIH0NCg0KDQoNCg0KfQ0K",
        "bGV0IGdsb2JhbEV2ZW50TGlzdGVuZXIgPSB7DQogICAgbGlzdGVuZXJzSW5pdGlhbGl6ZWQ6ZmFsc2UsDQogICAgaW5pdDogZnVuY3Rpb24gKCkgew0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZUNsaWNrTGlzdGVuZXJzID0gW107DQogICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlTW91c2VNb3ZlTGlzdGVuZXJzID0gW107DQogICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlTW91c2VEb3duTGlzdGVuZXJzID0gW107DQogICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlTW91c2VVcExpc3RlbmVycyA9IFtdOw0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZUtleURvd25MaXN0ZW5lcnMgPSBbXTsNCiAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVLZXlVcExpc3RlbmVycyA9IFtdOw0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVdvcmRDbGlja0xpc3RlbmVycyA9IFtdOw0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVBhcmFncmFwaENsaWNrTGlzdGVuZXJzID0gW107DQogICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlV29yZE1vdmVMaXN0ZW5lcnMgPSBbXTsNCiAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVQcmVzZW50YXRpb25GaW5pc2hMaXN0ZW5lcnMgPSBbXTsNCiAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci53aWRnZXRBY3RpdmF0ZWRMaXN0ZW5lcnMgPSBbXTsNCiAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5jdXJyZW50V29yZCA9ICIiOw0KICAgIH0sDQogICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdGhpcy5pbml0KCk7DQogICAgfSwNCiAgICBpbml0RXZlbnRMaXN0ZW5lcnM6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaWYoZ2xvYmFsRXZlbnRMaXN0ZW5lci5saXN0ZW5lcnNJbml0aWFsaXplZCl7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5saXN0ZW5lcnNJbml0aWFsaXplZCA9IHRydWU7DQoNCiAgICAgICAgJChkb2N1bWVudCkub24oImNsaWNrIHRvdWNoIiwgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgICAgIGlmKGFsZXJ0TWFuYWdlci5zdXBwcmVzc0NsaWNrKCkpew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghZ2xvYmFsRXZlbnRMaXN0ZW5lci5pc0lnbm9yZWRFbGVtZW50KGUudGFyZ2V0KSkgew0KDQoNCiAgICAgICAgICAgICAgICBpZiAoZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVDbGlja0xpc3RlbmVycy5sZW5ndGggfHwgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVXb3JkQ2xpY2tMaXN0ZW5lcnMubGVuZ3RoIHx8IGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlUGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcnMubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuY2xpY2tMaXN0ZW5lcihlKTsNCiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci53b3JkQ2xpY2tMaXN0ZW5lcihlKTsNCiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5wYXJhZ3JhcGhDbGlja0xpc3RlbmVyKGUpOw0KICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgIC8qDQogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7DQogICAgICAgICAgICBpZiAoISQoZS50YXJnZXQpLmNsb3Nlc3QoJy5lYXN5LXJlYWRpbmctaW50ZXJmYWNlJykubGVuZ3RoKXsNCg0KICAgICAgICAgICAgICAgIGlmKGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlQ2xpY2tMaXN0ZW5lcnMubGVuZ3RofHxnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVdvcmRDbGlja0xpc3RlbmVycy5sZW5ndGggfHwgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVQYXJhZ3JhcGhDbGlja0xpc3RlbmVycy5sZW5ndGgpew0KICAgICAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmNsaWNrTGlzdGVuZXIoZSk7DQogICAgICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIud29yZENsaWNrTGlzdGVuZXIoZSk7DQogICAgICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIucGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcihlKTsNCiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfQ0KICAgICAgICB9LCB0cnVlKTsNCiAgICAgICAgKi8NCiAgICAgICAgLyoNCiAgICAgICAgJChkb2N1bWVudCkub24oImNsaWNrIHRvdWNoIiwgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgICAgIGlmICghJChlLnRhcmdldCkuY2xvc2VzdCgnLmVhc3ktcmVhZGluZy1pbnRlcmZhY2UnKS5sZW5ndGgpew0KICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuY2xpY2tMaXN0ZW5lcihlKTsNCiAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLndvcmRDbGlja0xpc3RlbmVyKGUpOw0KICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIucGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcihlKTsNCg0KICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgfSk7Ki8NCg0KICAgICAgICAkKGRvY3VtZW50KS5tb3VzZW1vdmUoZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIubW91c2VNb3ZlTGlzdGVuZXIoZSk7DQogICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLndvcmRNb3ZlTGlzdGVuZXIoZSk7DQoNCiAgICAgICAgfSk7DQoNCiAgICAgICAgJChkb2N1bWVudCkubW91c2V1cChmdW5jdGlvbiAoZSkgew0KICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5tb3VzZVVwTGlzdGVuZXIoZSk7DQoNCiAgICAgICAgfSk7DQoNCiAgICAgICAgJChkb2N1bWVudCkubW91c2Vkb3duKGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLm1vdXNlRG93bkxpc3RlbmVyKGUpOw0KDQoNCiAgICAgICAgfSk7DQoNCg0KICAgICAgICAkKGRvY3VtZW50KS5rZXlkb3duKGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmtleURvd25MaXN0ZW5lcihlKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgJChkb2N1bWVudCkua2V5dXAoZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIua2V5VXBMaXN0ZW5lcihlKTsNCiAgICAgICAgfSk7DQoNCg0KICAgIH0sDQoNCiAgICAvKg0KICAgIENMSUNLIExJU1RFTkVSDQogICAgICovDQogICAgYWRkQ2xpY2tMaXN0ZW5lcjogZnVuY3Rpb24gKGNsaWNrTGlzdGVuZXIpIHsNCg0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZUNsaWNrTGlzdGVuZXJzLnB1c2goY2xpY2tMaXN0ZW5lcik7DQoNCiAgICB9LA0KDQogICAgcmVtb3ZlQ2xpY2tMaXN0ZW5lcjogZnVuY3Rpb24gKGNsaWNrTGlzdGVuZXIpIHsNCiAgICAgICAgY29uc3QgaW5kZXggPSBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZUNsaWNrTGlzdGVuZXJzLmluZGV4T2YoY2xpY2tMaXN0ZW5lcik7DQogICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsNCiAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlQ2xpY2tMaXN0ZW5lcnMuc3BsaWNlKGluZGV4LCAxKTsNCiAgICAgICAgfQ0KDQogICAgfSwNCg0KICAgIGNsaWNrTGlzdGVuZXI6IGZ1bmN0aW9uIChlKSB7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVDbGlja0xpc3RlbmVycy5sZW5ndGg7IGkrKykgew0KDQogICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZUNsaWNrTGlzdGVuZXJzW2ldLm9uQ2xpY2soZSk7DQoNCiAgICAgICAgfQ0KDQoNCiAgICB9LA0KDQogICAgLyoNCiAgICBNT1VTRSBNT1ZFIExJU1RFTkVSDQogICAgICovDQogICAgYWRkTW91c2VNb3ZlTGlzdGVuZXI6IGZ1bmN0aW9uIChjbGlja0xpc3RlbmVyKSB7DQogICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlTW91c2VNb3ZlTGlzdGVuZXJzLnB1c2goY2xpY2tMaXN0ZW5lcik7DQoNCiAgICB9LA0KDQogICAgcmVtb3ZlTW91c2VNb3ZlTGlzdGVuZXI6IGZ1bmN0aW9uIChjbGlja0xpc3RlbmVyKSB7DQogICAgICAgIGNvbnN0IGluZGV4ID0gZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVNb3VzZU1vdmVMaXN0ZW5lcnMuaW5kZXhPZihjbGlja0xpc3RlbmVyKTsNCiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgew0KICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVNb3VzZU1vdmVMaXN0ZW5lcnMuc3BsaWNlKGluZGV4LCAxKTsNCiAgICAgICAgfQ0KDQogICAgfSwNCg0KDQogICAgbW91c2VNb3ZlTGlzdGVuZXI6IGZ1bmN0aW9uIChlKSB7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVNb3VzZU1vdmVMaXN0ZW5lcnMubGVuZ3RoOyBpKyspIHsNCg0KICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVNb3VzZU1vdmVMaXN0ZW5lcnNbaV0ub25Nb3VzZU1vdmUoZSk7DQoNCiAgICAgICAgfQ0KICAgIH0sDQoNCg0KICAgIC8qDQogICAgTU9VU0UgRE9XTiBMSVNURU5FUg0KICAgICAqLw0KICAgIGFkZE1vdXNlRG93bkxpc3RlbmVyOiBmdW5jdGlvbiAoY2xpY2tMaXN0ZW5lcikgew0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZU1vdXNlRG93bkxpc3RlbmVycy5wdXNoKGNsaWNrTGlzdGVuZXIpOw0KDQogICAgfSwNCg0KICAgIHJlbW92ZU1vdXNlRG93bkxpc3RlbmVyOiBmdW5jdGlvbiAoY2xpY2tMaXN0ZW5lcikgew0KICAgICAgICBjb25zdCBpbmRleCA9IGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlTW91c2VEb3duTGlzdGVuZXJzLmluZGV4T2YoY2xpY2tMaXN0ZW5lcik7DQogICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsNCiAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlTW91c2VEb3duTGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSk7DQogICAgICAgIH0NCg0KICAgIH0sDQoNCg0KICAgIG1vdXNlRG93bkxpc3RlbmVyOiBmdW5jdGlvbiAoZSkgew0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlTW91c2VEb3duTGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7DQoNCiAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlTW91c2VEb3duTGlzdGVuZXJzW2ldLm9uTW91c2VEb3duKGUpOw0KDQogICAgICAgIH0NCiAgICB9LA0KDQogICAgLyoNCiAgIE1PVVNFIFVQIExJU1RFTkVSDQogICAgKi8NCiAgICBhZGRNb3VzZVVwTGlzdGVuZXI6IGZ1bmN0aW9uIChjbGlja0xpc3RlbmVyKSB7DQogICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlTW91c2VVcExpc3RlbmVycy5wdXNoKGNsaWNrTGlzdGVuZXIpOw0KDQogICAgfSwNCg0KICAgIHJlbW92ZU1vdXNlVXBMaXN0ZW5lcjogZnVuY3Rpb24gKGNsaWNrTGlzdGVuZXIpIHsNCiAgICAgICAgY29uc3QgaW5kZXggPSBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZU1vdXNlVXBMaXN0ZW5lcnMuaW5kZXhPZihjbGlja0xpc3RlbmVyKTsNCiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgew0KICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVNb3VzZVVwTGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSk7DQogICAgICAgIH0NCg0KICAgIH0sDQoNCg0KICAgIG1vdXNlVXBMaXN0ZW5lcjogZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZU1vdXNlVXBMaXN0ZW5lcnMubGVuZ3RoOyBpKyspIHsNCg0KICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVNb3VzZVVwTGlzdGVuZXJzW2ldLm9uTW91c2VVcChlKTsNCg0KICAgICAgICB9DQogICAgfSwNCg0KICAgIC8qDQogICBLRVkgRE9XTiBMSVNURU5FUg0KICAgICovDQogICAgYWRkS2V5RG93bkxpc3RlbmVyOiBmdW5jdGlvbiAoY2xpY2tMaXN0ZW5lcikgew0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZUtleURvd25MaXN0ZW5lcnMucHVzaChjbGlja0xpc3RlbmVyKTsNCg0KICAgIH0sDQoNCiAgICByZW1vdmVLZXlEb3duTGlzdGVuZXI6IGZ1bmN0aW9uIChjbGlja0xpc3RlbmVyKSB7DQogICAgICAgIGNvbnN0IGluZGV4ID0gZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVLZXlEb3duTGlzdGVuZXJzLmluZGV4T2YoY2xpY2tMaXN0ZW5lcik7DQogICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsNCiAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlS2V5RG93bkxpc3RlbmVycy5zcGxpY2UoaW5kZXgsIDEpOw0KICAgICAgICB9DQoNCiAgICB9LA0KDQoNCiAgICBrZXlEb3duTGlzdGVuZXI6IGZ1bmN0aW9uIChlKSB7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVLZXlEb3duTGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7DQoNCiAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlS2V5RG93bkxpc3RlbmVyc1tpXS5vbktleURvd24oZSk7DQoNCiAgICAgICAgfQ0KICAgIH0sDQoNCiAgICAvKg0KICAgS0VZIFVQIExJU1RFTkVSDQogICAgKi8NCiAgICBhZGRLZXlVcExpc3RlbmVyOiBmdW5jdGlvbiAoY2xpY2tMaXN0ZW5lcikgew0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZUtleVVwTGlzdGVuZXJzLnB1c2goY2xpY2tMaXN0ZW5lcik7DQoNCiAgICB9LA0KDQogICAgcmVtb3ZlS2V5VXBMaXN0ZW5lcjogZnVuY3Rpb24gKGNsaWNrTGlzdGVuZXIpIHsNCiAgICAgICAgY29uc3QgaW5kZXggPSBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZUtleVVwTGlzdGVuZXJzLmluZGV4T2YoY2xpY2tMaXN0ZW5lcik7DQogICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsNCiAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlS2V5VXBMaXN0ZW5lcnMuc3BsaWNlKGluZGV4LCAxKTsNCiAgICAgICAgfQ0KDQogICAgfSwNCg0KDQogICAga2V5VXBMaXN0ZW5lcjogZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZUtleVVwTGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7DQoNCiAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlS2V5VXBMaXN0ZW5lcnNbaV0ub25LZXlVcChlKTsNCg0KICAgICAgICB9DQogICAgfSwNCg0KICAgIC8qDQoNCiAgICBXb3JkQ2xpY2tMaXN0ZW5lciAtIGdldHMgV29yZCB3aGVuIENsaWNrZWQNCg0KICAgICAqLw0KDQogICAgYWRkV29yZENsaWNrTGlzdGVuZXI6IGZ1bmN0aW9uIChjbGlja0xpc3RlbmVyLGNvbXBhdGlibGVXaXRoT3RoZXJQcmVzZW50YXRpb25zPSBmYWxzZSkgew0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVdvcmRDbGlja0xpc3RlbmVycy5wdXNoKHsNCiAgICAgICAgICAgIGxpc3RlbmVyOiBjbGlja0xpc3RlbmVyLA0KICAgICAgICAgICAgY29tcGF0aWJsZVdpdGhPdGhlclByZXNlbnRhdGlvbnM6IGNvbXBhdGlibGVXaXRoT3RoZXJQcmVzZW50YXRpb25zDQogICAgICAgIH0pOw0KDQogICAgfSwNCg0KDQogICAgcmVtb3ZlV29yZENsaWNrTGlzdGVuZXI6IGZ1bmN0aW9uIChjbGlja0xpc3RlbmVyKSB7DQoNCiAgICAgICAgZm9yKGxldCBpPTA7IGkgPCBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVdvcmRDbGlja0xpc3RlbmVycy5sZW5ndGg7IGkrKyl7DQogICAgICAgICAgICBpZihnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVdvcmRDbGlja0xpc3RlbmVyc1tpXS5saXN0ZW5lciA9PT0gY2xpY2tMaXN0ZW5lcil7DQogICAgICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVXb3JkQ2xpY2tMaXN0ZW5lcnMuc3BsaWNlKGksIDEpOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAvKg0KICAgICAgICBjb25zdCBpbmRleCA9IGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlV29yZENsaWNrTGlzdGVuZXJzLmluZGV4T2YoY2xpY2tMaXN0ZW5lcik7DQogICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsNCiAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlV29yZENsaWNrTGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSk7DQogICAgICAgIH0NCiAgICAgICAgKi8NCg0KICAgIH0sDQogICAgd29yZENsaWNrTGlzdGVuZXI6IGZ1bmN0aW9uIChlKSB7DQogICAgICAgIGlmIChnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVdvcmRDbGlja0xpc3RlbmVycy5sZW5ndGggPiAwKSB7DQoNCg0KICAgICAgICAgICAgZm9yKGxldCBpPTA7IGkgPCBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVdvcmRDbGlja0xpc3RlbmVycy5sZW5ndGg7IGkrKyl7DQoNCiAgICAgICAgICAgICAgICBpZighZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVXb3JkQ2xpY2tMaXN0ZW5lcnNbaV0uY29tcGF0aWJsZVdpdGhPdGhlclByZXNlbnRhdGlvbnMpew0KDQogICAgICAgICAgICAgICAgICAgIHBhZ2VVdGlscy5yZW1vdmVEaXNwbGF5VW5kZXJQb3NpdGlvbihlLmNsaWVudFgsZS5jbGllbnRZKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgbGV0IGN1cnJlbnRXb3JkID0gcGFnZVV0aWxzLmdldFdvcmRVbmRlclBvc2l0aW9uKGUuY2xpZW50WCwgZS5jbGllbnRZKTsNCiAgICAgICAgICAgIGlmIChjdXJyZW50V29yZCkgew0KICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVXb3JkQ2xpY2tMaXN0ZW5lcnMubGVuZ3RoOyBpKyspIHsNCg0KICAgICAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVdvcmRDbGlja0xpc3RlbmVyc1tpXS5saXN0ZW5lci5vbldvcmRDbGljayhjdXJyZW50V29yZCwgZSk7DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KDQogICAgfSwNCg0KICAgIGFkZFBhcmFncmFwaENsaWNrTGlzdGVuZXI6IGZ1bmN0aW9uIChjbGlja0xpc3RlbmVyLGNvbXBhdGlibGVXaXRoT3RoZXJQcmVzZW50YXRpb25zPSBmYWxzZSkgew0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVBhcmFncmFwaENsaWNrTGlzdGVuZXJzLnB1c2goew0KICAgICAgICAgICAgbGlzdGVuZXI6IGNsaWNrTGlzdGVuZXIsDQogICAgICAgICAgICBjb21wYXRpYmxlV2l0aE90aGVyUHJlc2VudGF0aW9uczogY29tcGF0aWJsZVdpdGhPdGhlclByZXNlbnRhdGlvbnMNCiAgICAgICAgfSk7DQogICAgfSwNCg0KDQogICAgcmVtb3ZlUGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcjogZnVuY3Rpb24gKGNsaWNrTGlzdGVuZXIpIHsNCiAgICAgICAgZm9yKGxldCBpPTA7IGkgPCBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVBhcmFncmFwaENsaWNrTGlzdGVuZXJzLmxlbmd0aDsgaSsrKXsNCiAgICAgICAgICAgIGlmKGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlUGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcnNbaV0ubGlzdGVuZXIgPT09IGNsaWNrTGlzdGVuZXIpew0KICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlUGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcnMuc3BsaWNlKGksIDEpOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAvKg0KICAgICAgICBjb25zdCBpbmRleCA9IGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlUGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcnMuaW5kZXhPZihjbGlja0xpc3RlbmVyKTsNCiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgew0KICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVQYXJhZ3JhcGhDbGlja0xpc3RlbmVycy5zcGxpY2UoaW5kZXgsIDEpOw0KICAgICAgICB9DQogICAgICAgICovDQogICAgfSwNCg0KDQogICAgcGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcjogZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgaWYgKGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlUGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcnMubGVuZ3RoID4gMCkgew0KDQoNCiAgICAgICAgICAgIGZvcihsZXQgaT0wOyBpIDwgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVQYXJhZ3JhcGhDbGlja0xpc3RlbmVycy5sZW5ndGg7IGkrKyl7DQoNCiAgICAgICAgICAgICAgICBpZighZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVQYXJhZ3JhcGhDbGlja0xpc3RlbmVyc1tpXS5jb21wYXRpYmxlV2l0aE90aGVyUHJlc2VudGF0aW9ucyl7DQoNCiAgICAgICAgICAgICAgICAgICAgcGFnZVV0aWxzLnJlbW92ZURpc3BsYXlJblBhcmFncmFwaChlKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgbGV0IGN1cnJlbnRQYXJhZ3JhcGggPSBwYWdlVXRpbHMuZ2V0UGFyYWdyYXBoKGUpOw0KICAgICAgICAgICAgaWYgKGN1cnJlbnRQYXJhZ3JhcGgpIHsNCiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlUGFyYWdyYXBoQ2xpY2tMaXN0ZW5lcnMubGVuZ3RoOyBpKyspIHsNCg0KICAgICAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVBhcmFncmFwaENsaWNrTGlzdGVuZXJzW2ldLmxpc3RlbmVyLm9uUGFyYWdyYXBoQ0xpY2soY3VycmVudFBhcmFncmFwaCwgZSk7DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KDQogICAgfSwNCg0KICAgIC8qDQoNCiAgICAgKi8NCiAgICBhZGRXb3JkTW92ZUxpc3RlbmVyOiBmdW5jdGlvbiAoY2xpY2tMaXN0ZW5lcikgew0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVdvcmRNb3ZlTGlzdGVuZXJzLnB1c2goY2xpY2tMaXN0ZW5lcik7DQoNCiAgICB9LA0KDQogICAgcmVtb3ZlV29yZE1vdmVMaXN0ZW5lcjogZnVuY3Rpb24gKGNsaWNrTGlzdGVuZXIpIHsNCiAgICAgICAgY29uc3QgaW5kZXggPSBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVdvcmRNb3ZlTGlzdGVuZXJzLmluZGV4T2YoY2xpY2tMaXN0ZW5lcik7DQogICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsNCiAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlV29yZE1vdmVMaXN0ZW5lcnMuc3BsaWNlKGluZGV4LCAxKTsNCiAgICAgICAgfQ0KDQogICAgfSwNCg0KDQogICAgd29yZE1vdmVMaXN0ZW5lcjogZnVuY3Rpb24gKGUpIHsNCg0KICAgICAgICBpZiAoZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVXb3JkTW92ZUxpc3RlbmVycy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBsZXQgbmV3V29yZCA9IHBhZ2VVdGlscy5nZXRXb3JkVW5kZXJQb3NpdGlvbihlLmNsaWVudFgsIGUuY2xpZW50WSk7DQoNCiAgICAgICAgICAgIGlmIChnbG9iYWxFdmVudExpc3RlbmVyLmN1cnJlbnRXb3JkLndvcmQgIT09IG5ld1dvcmQud29yZCB8fA0KICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuY3VycmVudFdvcmQuYmVnaW4gIT09IG5ld1dvcmQuYmVnaW4gfHwNCiAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmN1cnJlbnRXb3JkLmVuZCAhPT0gbmV3V29yZC5lbmQgfHwNCiAgICAgICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmN1cnJlbnRXb3JkLnRleHROb2RlICE9PSBuZXdXb3JkLnRleHROb2RlKSB7DQogICAgICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5jdXJyZW50V29yZCA9IG5ld1dvcmQ7DQogICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVdvcmRNb3ZlTGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlV29yZENsaWNrTGlzdGVuZXJzW2ldLm9uV29yZE1vdmUobmV3V29yZCwgZSk7DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgIH0sDQoNCg0KICAgIGFkZFByZXNlbnRhdGlvbkZpbmlzaExpc3RlbmVyOiBmdW5jdGlvbiAocHJlc2VudGF0aW9uRmluaXNoZWRMaXN0ZW5lcikgew0KICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVByZXNlbnRhdGlvbkZpbmlzaExpc3RlbmVycy5wdXNoKHByZXNlbnRhdGlvbkZpbmlzaGVkTGlzdGVuZXIpOw0KICAgIH0sDQoNCg0KICAgIHJlbW92ZVByZXNlbnRhdGlvbkZpbmlzaExpc3RlbmVyOiBmdW5jdGlvbiAocHJlc2VudGF0aW9uRmluaXNoZWRMaXN0ZW5lcikgew0KICAgICAgICBjb25zdCBpbmRleCA9IGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlUHJlc2VudGF0aW9uRmluaXNoTGlzdGVuZXJzLmluZGV4T2YocHJlc2VudGF0aW9uRmluaXNoZWRMaXN0ZW5lcik7DQogICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsNCiAgICAgICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuYWN0aXZlUHJlc2VudGF0aW9uRmluaXNoTGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSk7DQogICAgICAgIH0NCiAgICB9LA0KDQogICAgcHJlc2VudGF0aW9uRmluaXNoZWQocHJlc2VudGF0aW9uKSB7DQoNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnbG9iYWxFdmVudExpc3RlbmVyLmFjdGl2ZVByZXNlbnRhdGlvbkZpbmlzaExpc3RlbmVycy5sZW5ndGg7IGkrKykgew0KDQogICAgICAgICAgICBpZiAoZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVQcmVzZW50YXRpb25GaW5pc2hMaXN0ZW5lcnNbaV0udXNlckludGVyZmFjZS51aUlkID09PSBwcmVzZW50YXRpb24udXNlckludGVyZmFjZS51aUlkDQogICAgICAgICAgICAgICAgJiYgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVQcmVzZW50YXRpb25GaW5pc2hMaXN0ZW5lcnNbaV0udG9vbElkID09PSBwcmVzZW50YXRpb24uZnVuY3Rpb25JbmZvLnRvb2xJZCkgew0KDQogICAgICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci5hY3RpdmVQcmVzZW50YXRpb25GaW5pc2hMaXN0ZW5lcnNbaV0ucHJlc2VudGF0aW9uRmluaXNoZWQocHJlc2VudGF0aW9uKTsNCg0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCiAgICB9LA0KDQogICAgYWRkV2lkZ2V0QWN0aXZhdGVkTGlzdGVuZXJzOiBmdW5jdGlvbiAod2lkZ2V0QWN0aXZhdGVkTGlzdGVuZXIpIHsNCiAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci53aWRnZXRBY3RpdmF0ZWRMaXN0ZW5lcnMucHVzaCh3aWRnZXRBY3RpdmF0ZWRMaXN0ZW5lcik7DQogICAgfSwNCg0KDQogICAgcmVtb3ZlV2lkZ2V0QWN0aXZhdGVkTGlzdGVuZXJzOiBmdW5jdGlvbiAod2lkZ2V0QWN0aXZhdGVkTGlzdGVuZXIpIHsNCiAgICAgICAgY29uc3QgaW5kZXggPSBnbG9iYWxFdmVudExpc3RlbmVyLndpZGdldEFjdGl2YXRlZExpc3RlbmVycy5pbmRleE9mKHdpZGdldEFjdGl2YXRlZExpc3RlbmVyKTsNCiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgew0KICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci53aWRnZXRBY3RpdmF0ZWRMaXN0ZW5lcnMuc3BsaWNlKGluZGV4LCAxKTsNCiAgICAgICAgfQ0KICAgIH0sDQoNCiAgICB3aWRnZXRBY3RpdmF0ZWQod2lkZ2V0KSB7DQoNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnbG9iYWxFdmVudExpc3RlbmVyLndpZGdldEFjdGl2YXRlZExpc3RlbmVycy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgZ2xvYmFsRXZlbnRMaXN0ZW5lci53aWRnZXRBY3RpdmF0ZWRMaXN0ZW5lcnNbaV0ud2lkZ2V0QWN0aXZhdGVkKHdpZGdldCk7DQogICAgICAgIH0NCiAgICB9LA0KDQogICAgaXNJZ25vcmVkRWxlbWVudChlbGVtZW50KXsNCiAgICAgICAgcmV0dXJuICQoZWxlbWVudCkuY2xvc2VzdCgnLmVhc3ktcmVhZGluZy1pbnRlcmZhY2UnKS5sZW5ndGggfHwgJChlbGVtZW50KS5jbG9zZXN0KCdidXR0b24nKS5sZW5ndGggfHwgICQoZWxlbWVudCkuY2xvc2VzdCgnaW5wdXQnKS5sZW5ndGggfHwgJChlbGVtZW50KS5jbG9zZXN0KCdzZWxlY3QnKS5sZW5ndGg7DQogICAgfQ0KfTs=",
        "dmFyIGVhc3lSZWFkaW5nID0gew0KICAgIHN0YXJ0ZWQ6IGZhbHNlLA0KICAgIGN1cnJlbnRUb29sSUQ6IDAsDQogICAgaW5pdDogZnVuY3Rpb24gKCkgew0KICAgICAgICBlYXN5UmVhZGluZy51aUNvbGxlY3Rpb24gPSBbXTsNCiAgICAgICAgZWFzeVJlYWRpbmcudXNlckludGVyZmFjZXMgPSBbXTsNCiAgICAgICAgZWFzeVJlYWRpbmcud2lkZ2V0cyA9IFtdOw0KICAgICAgICBlYXN5UmVhZGluZy5wcmVzZW50YXRpb25zID0gW107DQogICAgICAgIGVhc3lSZWFkaW5nLmJ1c3lBbmltYXRpb24gPSBudWxsOw0KICAgICAgICBlYXN5UmVhZGluZy51aVVwZGF0ZWQgPSBmYWxzZTsNCiAgICAgICAgZWFzeVJlYWRpbmcuY3VycmVudFRvb2xDb3VudCA9IDA7DQogICAgICAgIGVhc3lSZWFkaW5nLmN1cnJlbnRVSUNvdW50ID0gMDsNCiAgICB9LA0KDQogICAgc3RhcnR1cDogZnVuY3Rpb24gKHVpQ29sbGVjdGlvbikgew0KDQogICAgICAgIGlmKCFjbGFzc01hcHBpbmcpew0KICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgZWFzeVJlYWRpbmcuc3RhcnR1cCh1aUNvbGxlY3Rpb24pOw0KICAgICAgICAgICAgfSwxMDAgKTsNCg0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgDQogICAgICAgIGxldCB1cGRhdGVkID0gZWFzeVJlYWRpbmcudWlVcGRhdGVkOw0KICAgICAgICB0aGlzLmluaXQoKTsNCiAgICAgICAgZWFzeVJlYWRpbmcuc3RhcnRlZCA9IHRydWU7DQogICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuaW5pdCgpOw0KICAgICAgICB0aGlzLnVpQ29sbGVjdGlvbiA9IHVpQ29sbGVjdGlvbjsNCg0KDQogICAgICAgIC8vaHR0cHM6Ly9qc3BlcmYuY29tL2Zhc3QtYXJyYXktZm9yZWFjaA0KDQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy51aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXMubGVuZ3RoOyBpKyspIHsNCg0KICAgICAgICAgICAgbGV0IHVpVGFiQ29uZmlnID0gbnVsbDsNCiAgICAgICAgICAgIGlmICh1aUNvbGxlY3Rpb24udWlUYWJDb25maWcpIHsNCg0KICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdWlDb2xsZWN0aW9uLnVpVGFiQ29uZmlnLmxlbmd0aDsgaisrKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKHVpQ29sbGVjdGlvbi51aVRhYkNvbmZpZ1tqXS5pZCA9PT0gdWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLnNvdXJjZS5pZCkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICB1aVRhYkNvbmZpZyA9IHVpQ29sbGVjdGlvbi51aVRhYkNvbmZpZ1tqXS5jb25maWd1cmF0aW9uOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGxldCBjdXJyZW50VXNlckludGVyZmFjZSA9IG5ldyBjbGFzc01hcHBpbmdbdGhpcy51aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0uc291cmNlLmltcGxlbWVudGF0aW9uQ2xhc3NdKHRoaXMudWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLmNvbmZpZ3VyYXRpb24sIHVpVGFiQ29uZmlnKTsNCiAgICAgICAgICAgIGN1cnJlbnRVc2VySW50ZXJmYWNlLmlkID0gdGhpcy51aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0uc291cmNlLmlkOw0KICAgICAgICAgICAgY3VycmVudFVzZXJJbnRlcmZhY2UudWlJZCA9IHRoaXMuY3JlYXRlVUlJRCgpOw0KICAgICAgICAgICAgY3VycmVudFVzZXJJbnRlcmZhY2UudWlJbmRleCA9IGk7DQogICAgICAgICAgICBjdXJyZW50VXNlckludGVyZmFjZS5pbml0VUkoKTsNCiAgICAgICAgICAgIGN1cnJlbnRVc2VySW50ZXJmYWNlLnRvb2xzID0gW107DQoNCg0KICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLnVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29scy5sZW5ndGg7IGorKykgew0KDQogICAgICAgICAgICAgICAgLy9VbmlxdWUgdG9vbCBpZCBkdXJpbmcgaW5zdGFuY2UNCiAgICAgICAgICAgICAgICBsZXQgdG9vbElEID0gdGhpcy5jcmVhdGVUb29sSUQoKTsNCiAgICAgICAgICAgICAgICB0aGlzLnVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29sc1tqXS5mdW5jdGlvbi50b29sSWQgPSB0b29sSUQ7DQoNCg0KICAgICAgICAgICAgICAgIGxldCB0YXJnZXRJRCA9IGN1cnJlbnRVc2VySW50ZXJmYWNlLmdldFRvb2xDb250YWluZXJJREZvckxheW91dCh0b29sSUQsIHRoaXMudWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLnRvb2xzW2pdLmxheW91dCk7DQogICAgICAgICAgICAgICAgbGV0IGN1cnJlbnRXaWRnZXQgPSBuZXcgY2xhc3NNYXBwaW5nW3RoaXMudWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLnRvb2xzW2pdLndpZGdldC5zb3VyY2UuaW1wbGVtZW50YXRpb25DbGFzc10odGhpcy51aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0udG9vbHNbal0uZnVuY3Rpb24sIGN1cnJlbnRVc2VySW50ZXJmYWNlLCB0YXJnZXRJRCwgdGhpcy51aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0udG9vbHNbal0ud2lkZ2V0LmNvbmZpZ3VyYXRpb24pOw0KICAgICAgICAgICAgICAgIHRoaXMud2lkZ2V0cy5wdXNoKGN1cnJlbnRXaWRnZXQpOw0KICAgICAgICAgICAgICAgIGxldCBjdXJyZW50UHJlc2VudGF0aW9uID0gbnVsbDsNCg0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy51aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0udG9vbHNbal0ucHJlc2VudGF0aW9uICE9PSAidW5kZWZpbmVkIikgew0KDQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcmVzZW50YXRpb24gPSBuZXcgY2xhc3NNYXBwaW5nW3RoaXMudWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLnRvb2xzW2pdLnByZXNlbnRhdGlvbi5zb3VyY2UuaW1wbGVtZW50YXRpb25DbGFzc10odGhpcy51aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0udG9vbHNbal0uZnVuY3Rpb24sIGN1cnJlbnRVc2VySW50ZXJmYWNlLCB0aGlzLnVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29sc1tqXS5wcmVzZW50YXRpb24uY29uZmlndXJhdGlvbik7DQoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVzZW50YXRpb25zLnB1c2goY3VycmVudFByZXNlbnRhdGlvbik7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgbGV0IG5ld1Rvb2wgPSB7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uOiB0aGlzLnVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29sc1tqXS5mdW5jdGlvbiwNCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0OiBjdXJyZW50V2lkZ2V0LA0KICAgICAgICAgICAgICAgICAgICBwcmVzZW50YXRpb246IGN1cnJlbnRQcmVzZW50YXRpb24sDQogICAgICAgICAgICAgICAgICAgIGlkOiB0b29sSUQsDQogICAgICAgICAgICAgICAgICAgIC8vQ3JlYXRlcyBhIHNpZ25hdHVyZSB0byBjaGVjayBpZiBhIGZ1bmN0aW9uIGhhcyBjaGFuZ2VkIHdoZW4gdXNlciBpbnRlcmZhY2VzIGlzIGNoYW5nZWQvdXBkYXRlZA0KICAgICAgICAgICAgICAgICAgICB0b29sU2lnbmF0dXJlOiB0aGlzLmNyZWF0ZVRvb2xTaWduYXR1cmVJRCh0aGlzLnVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXSwgdGhpcy51aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0udG9vbHNbal0pLA0KDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAvL1Rvb2wgaW5kZXggaXMgdGhlIGluZGV4IG9mIHRoZSB0b29sIGluIHRoZSB1c2VyIGludGVyZmFjZSBuZWVkZWQgaW4gbm9kZS5qcw0KICAgICAgICAgICAgICAgIHRoaXMuc2V0VG9vbEluZGV4SUQobmV3VG9vbCwgaik7DQogICAgICAgICAgICAgICAgY3VycmVudFVzZXJJbnRlcmZhY2UudG9vbHMucHVzaChuZXdUb29sKTsNCg0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY3VycmVudFVzZXJJbnRlcmZhY2UudG9vbHNMb2FkZWQoKTsNCiAgICAgICAgICAgIGVhc3lSZWFkaW5nLnVzZXJJbnRlcmZhY2VzLnB1c2goY3VycmVudFVzZXJJbnRlcmZhY2UpOw0KICAgICAgICB9DQoNCiAgICAgICAgZWFzeVJlYWRpbmcuYnVzeUFuaW1hdGlvbiA9IG5ldyBjbGFzc01hcHBpbmdbdGhpcy51aUNvbGxlY3Rpb24uYnVzeUFuaW1hdGlvbi5zb3VyY2UuaW1wbGVtZW50YXRpb25DbGFzc10odGhpcy51aUNvbGxlY3Rpb24uYnVzeUFuaW1hdGlvbi5jb25maWd1cmF0aW9uKTsNCg0KDQogICAgICAgIGdsb2JhbEV2ZW50TGlzdGVuZXIuaW5pdEV2ZW50TGlzdGVuZXJzKCk7DQoNCiAgICAgICAgaWYgKHVwZGF0ZWQpIHsNCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZWFzeVJlYWRpbmcudXNlckludGVyZmFjZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICBlYXN5UmVhZGluZy51c2VySW50ZXJmYWNlc1tpXS51aVVwZGF0ZWQoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGNvbnNvbGUubG9nKCJzdGFydHVwIC0gY29tcGxldGUiKTsNCg0KICAgIH0sDQogICAgc2V0VG9vbEluZGV4SUQ6IGZ1bmN0aW9uICh0b29sLCB0b29sSW5kZXgpIHsNCiAgICAgICAgdG9vbC50b29sSW5kZXggPSB0b29sSW5kZXg7DQogICAgICAgIHRvb2wuZnVuY3Rpb24udG9vbEluZGV4ID0gdG9vbEluZGV4Ow0KDQogICAgICAgIHRvb2wud2lkZ2V0LnNldFRvb2xJbmRleCh0b29sSW5kZXgpOw0KICAgICAgICBpZiAodG9vbC5wcmVzZW50YXRpb24pIHsNCiAgICAgICAgICAgIHRvb2wucHJlc2VudGF0aW9uLnNldFRvb2xJbmRleCh0b29sSW5kZXgpOw0KICAgICAgICB9DQogICAgfSwNCiAgICB1cGRhdGU6IGZ1bmN0aW9uICh1aUNvbGxlY3Rpb24pIHsNCg0KICAgICAgICBjb25zb2xlLmxvZygiVVBEQXRlIik7DQogICAgICAgIGlmIChlYXN5UmVhZGluZy5zdGFydGVkKSB7DQoNCiAgICAgICAgICAgIGxldCB1aUNoYW5nZWQgPSBmYWxzZTsNCg0KICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlcy5sZW5ndGg7IGkrKykgew0KDQogICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB1aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXMubGVuZ3RoOyBrKyspIHsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAodWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2tdLnNvdXJjZS5pZCAhPT0gdGhpcy51aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0uc291cmNlLmlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB1aUNoYW5nZWQgPSB0cnVlOw0KDQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBsZXQgb2xkQ29uZmlnID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS5jb25maWd1cmF0aW9uKSk7DQogICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvbGRDb25maWcuaWQ7DQogICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvbGRDb25maWcucmVtb3RlQXNzZXREaXJlY3Rvcnk7DQoNCiAgICAgICAgICAgICAgICAgICAgbGV0IG5ld0NvbmZpZyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2tdLmNvbmZpZ3VyYXRpb24pKTsNCiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG5ld0NvbmZpZy5pZDsNCiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG5ld0NvbmZpZy5yZW1vdGVBc3NldERpcmVjdG9yeTsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoSlNPTi5zdHJpbmdpZnkobmV3Q29uZmlnKSAhPT0gSlNPTi5zdHJpbmdpZnkob2xkQ29uZmlnKSkgew0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHVpQ2hhbmdlZCA9IHRydWU7DQoNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAodWlDaGFuZ2VkKSB7DQogICAgICAgICAgICAgICAgZWFzeVJlYWRpbmcuc2h1dGRvd24oKTsNCiAgICAgICAgICAgICAgICBlYXN5UmVhZGluZy5zdGFydHVwKHVpQ29sbGVjdGlvbik7DQoNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB1aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXMubGVuZ3RoOyBpKyspIHsNCg0KICAgICAgICAgICAgICAgICAgICBsZXQgY3VycmVudFVzZXJJbnRlcmZhY2UgPSB0aGlzLmdldFVzZXJJbnRlcmZhY2VXaXRoSUQodWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLnNvdXJjZS5pZCk7DQoNCiAgICAgICAgICAgICAgICAgICAgbGV0IHRvb2xJbmRleGVzVG9SZW1vdmUgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgLy9SZW1vdmUgb2xkIHRvb2xzDQogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgY3VycmVudFVzZXJJbnRlcmZhY2UudG9vbHMubGVuZ3RoOyBqKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0b29sRm91bmQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgdWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLnRvb2xzLmxlbmd0aDsgaysrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRvb2xTaWduYXR1cmUgPSB0aGlzLmNyZWF0ZVRvb2xTaWduYXR1cmVJRCh1aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0sIHVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29sc1trXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRvb2xTaWduYXR1cmUgPT09IGN1cnJlbnRVc2VySW50ZXJmYWNlLnRvb2xzW2pdLnRvb2xTaWduYXR1cmUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbEZvdW5kID0gdHJ1ZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0NoZWNrIGlmIGNvbmZpZ3VyYXRpb24gdXBkYXRlZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3VG9vbCA9IHVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29sc1trXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG9sZFRvb2wgPSBjdXJyZW50VXNlckludGVyZmFjZS50b29sc1tqXTsNCg0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlYXN5UmVhZGluZy5jb21wYXJlQ29uZmlndXJhdGlvbihuZXdUb29sLmZ1bmN0aW9uLmNvbmZpZ3VyYXRpb24sIG9sZFRvb2wuZnVuY3Rpb24uY29uZmlndXJhdGlvbikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2V0IGl0IHRvIGZhbHNlIHNvIGl0IGdldHMgcmUtYWRkZWQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xGb3VuZCA9IGZhbHNlOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISBlYXN5UmVhZGluZy5jb21wYXJlQ29uZmlndXJhdGlvbihuZXdUb29sLndpZGdldC5jb25maWd1cmF0aW9uLCBvbGRUb29sLndpZGdldC5jb25maWd1cmF0aW9uKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZXQgaXQgdG8gZmFsc2Ugc28gaXQgZ2V0cyByZS1hZGRlZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbEZvdW5kID0gZmFsc2U7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXdUb29sLndpZGdldC5wcmVzZW50YXRpb24pIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlYXN5UmVhZGluZy5jb21wYXJlQ29uZmlndXJhdGlvbihuZXdUb29sLnByZXNlbnRhdGlvbi5jb25maWd1cmF0aW9uLCBvbGRUb29sLnByZXNlbnRhdGlvbi5jb25maWd1cmF0aW9uKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2V0IGl0IHRvIGZhbHNlIHNvIGl0IGdldHMgcmUtYWRkZWQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sRm91bmQgPSBmYWxzZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdG9vbEZvdW5kKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VXNlckludGVyZmFjZS50b29sc1tqXS53aWRnZXQucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRVc2VySW50ZXJmYWNlLnRvb2xzW2pdLnByZXNlbnRhdGlvbikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VXNlckludGVyZmFjZS50b29sc1tqXS5wcmVzZW50YXRpb24ucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRVc2VySW50ZXJmYWNlLnJlbW92ZUNvbnRhaW5lckZvclRvb2woY3VycmVudFVzZXJJbnRlcmZhY2UudG9vbHNbal0uaWQpOw0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sSW5kZXhlc1RvUmVtb3ZlLnB1c2goaik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vUmVtb3ZlIGhpZ2ggdG8gbG93IHRvIG5vdCBmdWNrIHVwIGluZGV4ZXMNCiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHRvb2xJbmRleGVzVG9SZW1vdmUubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRVc2VySW50ZXJmYWNlLnRvb2xzLnNwbGljZSh0b29sSW5kZXhlc1RvUmVtb3ZlW2ldLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vQWRkIG5ldyB0b29scw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29scy5sZW5ndGg7IGsrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRvb2xTaWduYXR1cmUgPSB0aGlzLmNyZWF0ZVRvb2xTaWduYXR1cmVJRCh1aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0sIHVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29sc1trXSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0b29sQWxyZWFkeUluVXNlckludGVyZmFjZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50VXNlckludGVyZmFjZS50b29sc1trXSA9PT0gJ3VuZGVmaW5lZCcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sQWxyZWFkeUluVXNlckludGVyZmFjZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9vbFNpZ25hdHVyZSA9PT0gY3VycmVudFVzZXJJbnRlcmZhY2UudG9vbHNba10udG9vbFNpZ25hdHVyZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sQWxyZWFkeUluVXNlckludGVyZmFjZSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0b29sQWxyZWFkeUluVXNlckludGVyZmFjZSkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRvb2xJRCA9IHRoaXMuY3JlYXRlVG9vbElEKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLnRvb2xzW2tdLnRvb2xJZCA9IHRvb2xJRDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0YXJnZXRJRCA9IGN1cnJlbnRVc2VySW50ZXJmYWNlLmdldFRvb2xDb250YWluZXJJREZvckxheW91dCh0b29sSUQsIHVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29sc1trXS5sYXlvdXQsIGspOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjdXJyZW50V2lkZ2V0ID0gbmV3IGNsYXNzTWFwcGluZ1t1aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0udG9vbHNba10ud2lkZ2V0LnNvdXJjZS5pbXBsZW1lbnRhdGlvbkNsYXNzXSh1aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0udG9vbHNba10uZnVuY3Rpb24sIGN1cnJlbnRVc2VySW50ZXJmYWNlLCB0YXJnZXRJRCwgdWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLnRvb2xzW2tdLndpZGdldC5jb25maWd1cmF0aW9uKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndpZGdldHMucHVzaChjdXJyZW50V2lkZ2V0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY3VycmVudFByZXNlbnRhdGlvbiA9IG51bGw7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29sc1trXS5wcmVzZW50YXRpb24gIT09ICJ1bmRlZmluZWQiKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFByZXNlbnRhdGlvbiA9IG5ldyBjbGFzc01hcHBpbmdbdWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLnRvb2xzW2tdLnByZXNlbnRhdGlvbi5zb3VyY2UuaW1wbGVtZW50YXRpb25DbGFzc10odWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLnRvb2xzW2tdLmZ1bmN0aW9uLCBjdXJyZW50VXNlckludGVyZmFjZSwgdWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLnRvb2xzW2tdLnByZXNlbnRhdGlvbi5jb25maWd1cmF0aW9uKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXNlbnRhdGlvbnMucHVzaChjdXJyZW50UHJlc2VudGF0aW9uKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3VG9vbCA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb246IHVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29sc1trXS5mdW5jdGlvbiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0OiBjdXJyZW50V2lkZ2V0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVzZW50YXRpb246IGN1cnJlbnRQcmVzZW50YXRpb24sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB0b29sSUQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vQ3JlYXRlcyBhIHNpZ25hdHVyZSB0byBjaGVjayBpZiBhIGZ1bmN0aW9uIGhhcyBjaGFuZ2VkIHdoZW4gdXNlciBpbnRlcmZhY2VzIGlzIGNoYW5nZWQvdXBkYXRlZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sU2lnbmF0dXJlOiB0aGlzLmNyZWF0ZVRvb2xTaWduYXR1cmVJRCh1aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0sIHVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29sc1trXSksDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRVc2VySW50ZXJmYWNlLnRvb2xzLnNwbGljZShrLCAwLCBuZXdUb29sKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFVzZXJJbnRlcmZhY2UudG9vbHNba10ud2lkZ2V0LnVwZGF0ZUNvbmZpZ3VyYXRpb25BbmRGdW5jdGlvbih1aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0udG9vbHNba10ud2lkZ2V0LmNvbmZpZ3VyYXRpb24sIHVpQ29sbGVjdGlvbi51c2VySW50ZXJmYWNlc1tpXS50b29sc1trXS5mdW5jdGlvbik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRVc2VySW50ZXJmYWNlLnRvb2xzW2tdLnByZXNlbnRhdGlvbikgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRVc2VySW50ZXJmYWNlLnRvb2xzW2tdLnByZXNlbnRhdGlvbi51cGRhdGVDb25maWd1cmF0aW9uQW5kRnVuY3Rpb24odWlDb2xsZWN0aW9uLnVzZXJJbnRlcmZhY2VzW2ldLnRvb2xzW2tdLnByZXNlbnRhdGlvbi5jb25maWd1cmF0aW9uLCB1aUNvbGxlY3Rpb24udXNlckludGVyZmFjZXNbaV0udG9vbHNba10uZnVuY3Rpb24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRUb29sSW5kZXhJRChjdXJyZW50VXNlckludGVyZmFjZS50b29sc1trXSwgayk7DQoNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRVc2VySW50ZXJmYWNlLnVpVXBkYXRlZCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLnVpQ29sbGVjdGlvbiA9IHVpQ29sbGVjdGlvbjsNCiAgICAgICAgICAgIH0NCg0KDQogICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgIHRoaXMuc3RhcnR1cCh1aUNvbGxlY3Rpb24pOw0KICAgICAgICB9DQogICAgfSwNCiAgICBjcmVhdGVVSUlEOiBmdW5jdGlvbiAoKSB7DQogICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRVSUNvdW50Kys7DQogICAgfSwNCg0KICAgIGNyZWF0ZVRvb2xJRDogZnVuY3Rpb24gKCkgew0KICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50VG9vbENvdW50Kys7DQogICAgfSwNCg0KICAgIGNyZWF0ZVRvb2xTaWduYXR1cmVJRDogZnVuY3Rpb24gKHVzZXJJbnRlcmZhY2UsIHRvb2wpIHsNCg0KDQogICAgICAgIGxldCBpZCA9IHRvb2wuZnVuY3Rpb24uc291cmNlLmlkICsgIi0iICsgdG9vbC53aWRnZXQuc291cmNlLmlkOw0KICAgICAgICBpZiAodG9vbC5wcmVzZW50YXRpb24pIHsNCiAgICAgICAgICAgIGlkID0gaWQgKyAiLSIgKyB0b29sLnByZXNlbnRhdGlvbi5zb3VyY2UuaWQ7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGlkOw0KICAgIH0sDQoNCiAgICBnZXRVc2VySW50ZXJmYWNlV2l0aElEOiBmdW5jdGlvbiAoaWQpIHsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnVzZXJJbnRlcmZhY2VzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBpZiAodGhpcy51c2VySW50ZXJmYWNlc1tpXS5pZCA9PT0gaWQpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy51c2VySW50ZXJmYWNlc1tpXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgfSwNCg0KICAgIHNodXRkb3duOiBmdW5jdGlvbiAoKSB7DQoNCiAgICAgICAgaWYgKGVhc3lSZWFkaW5nLnN0YXJ0ZWQpIHsNCiAgICAgICAgICAgIGVhc3lSZWFkaW5nLnVpVXBkYXRlZCA9IHRydWU7DQogICAgICAgICAgICBnbG9iYWxFdmVudExpc3RlbmVyLnJlc2V0KCk7DQogICAgICAgICAgICBlYXN5UmVhZGluZy53aWRnZXRzLmZvckVhY2goZnVuY3Rpb24gKHdpZGdldCkgew0KICAgICAgICAgICAgICAgIHdpZGdldC5yZW1vdmUoKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBlYXN5UmVhZGluZy5wcmVzZW50YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKHByZXNlbnRhdGlvbikgew0KICAgICAgICAgICAgICAgIHByZXNlbnRhdGlvbi5yZW1vdmUoKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBlYXN5UmVhZGluZy51c2VySW50ZXJmYWNlcy5mb3JFYWNoKGZ1bmN0aW9uICh1c2VySW50ZXJmYWNlKSB7DQogICAgICAgICAgICAgICAgdXNlckludGVyZmFjZS5yZW1vdmUoKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBpZihlYXN5UmVhZGluZy5idXN5QW5pbWF0aW9uKXsNCiAgICAgICAgICAgICAgICBlYXN5UmVhZGluZy5idXN5QW5pbWF0aW9uLnN0b3BBbmltYXRpb24oKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVhc3lSZWFkaW5nLnN0YXJ0ZWQgPSBmYWxzZTsNCg0KICAgICAgICAgICAgY29uc29sZS5sb2coIlNIVVRJTkcgRE9XTiIpOw0KICAgICAgICB9DQoNCiAgICB9LA0KDQogICAgY29tcGFyZUNvbmZpZ3VyYXRpb246IGZ1bmN0aW9uIChjb25maWcxLCBjb25maWcyKSB7DQoNCiAgICAgICAgbGV0IGNvbmYxID0geyAuLi5jb25maWcxIH07DQogICAgICAgIGxldCBjb25mMiA9IHsgLi4uY29uZmlnMiB9Ow0KDQogICAgICAgIE9iamVjdC5rZXlzKGNvbmYxKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgew0KICAgICAgICAgICAgaWYoY29uZjFba2V5XSA9PT0gbnVsbCl7DQogICAgICAgICAgICAgICAgY29uZjFba2V5XSA9IGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCg0KICAgICAgICBPYmplY3Qua2V5cyhjb25mMikuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsNCiAgICAgICAgICAgIGlmKGNvbmYyW2tleV0gPT09IG51bGwpew0KICAgICAgICAgICAgICAgIGNvbmYyW2tleV0gPSBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgaWYoY29uZjEuaWQpew0KICAgICAgICAgICAgZGVsZXRlIGNvbmYxLmlkOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYoY29uZjIuaWQpew0KICAgICAgICAgICAgZGVsZXRlIGNvbmYyLmlkOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGNvbmYxKSA9PT0gSlNPTi5zdHJpbmdpZnkoY29uZjIpDQoNCg0KICAgIH0NCg0KfTsNCg0KDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdlYXN5UmVhZGluZ1N0YXJ0VXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICBsZXQgcmVxdWVzdFJlc3VsdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlYXN5LXJlYWRpbmctZGVidWcnKTsNCiAgICBsZXQgdWlDb2xsZWN0aW9uID0gSlNPTi5wYXJzZShyZXF1ZXN0UmVzdWx0LmRhdGFzZXQucmVzdWx0KTsNCiAgICBpZiAoZWFzeVJlYWRpbmcuc3RhcnRlZCkgew0KICAgICAgICBlYXN5UmVhZGluZy51cGRhdGUodWlDb2xsZWN0aW9uKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBlYXN5UmVhZGluZy5zaHV0ZG93bigpOw0KICAgICAgICBlYXN5UmVhZGluZy5zdGFydHVwKHVpQ29sbGVjdGlvbik7DQogICAgfQ0KDQoNCn0pOw0KDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd1c2VyTG9nb3V0JywgZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgZWFzeVJlYWRpbmcuc2h1dGRvd24oKTsNCg0KfSk7",
        "Y2xhc3MgUmVxdWVzdCB7DQogICAgY29uc3RydWN0b3IoaWQsIGlucHV0LCB1aUlkLCB0b29sSWQsIGZ1bmN0aW9uSW5mbywgYXV0b21hdGljUmVxdWVzdD1mYWxzZSwgcmVhc29uZXJfdHJpZ2dlcmVkPWZhbHNlKSB7DQogICAgICAgIHRoaXMuaWQgPSBpZDsNCiAgICAgICAgdGhpcy5pbnB1dCA9IGlucHV0Ow0KICAgICAgICB0aGlzLnVpSWQgPSB1aUlkOw0KICAgICAgICB0aGlzLnRvb2xJZCA9IHRvb2xJZDsNCiAgICAgICAgdGhpcy5mdW5jdGlvbkluZm8gPSBmdW5jdGlvbkluZm87DQoNCiAgICAgICAgdGhpcy5pbnB1dFR5cGUgPSBudWxsOw0KICAgICAgICBpZiAoaW5wdXQpIHsNCg0KICAgICAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7DQogICAgICAgICAgICAgICAgY2FzZSAiUGFyYWdyYXBoIjogew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0VHlwZSA9IG5ldyBQYXJhZ3JhcGgoaW5wdXQudmFsdWUsaW5wdXQubGFuZyk7DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAiQW5ub3RhdGVkUGFyYWdyYXBoIjogew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0VHlwZSA9IG5ldyBBbm5vdGF0ZWRQYXJhZ3JhcGgoaW5wdXQudmFsdWUsW10saW5wdXQubGFuZyk7DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KDQogICAgICAgICAgICAgICAgY2FzZSAiV29yZCI6IHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnB1dFR5cGUgPSBuZXcgV29yZChpbnB1dC52YWx1ZSxpbnB1dC5sYW5nLGlucHV0LnNlbnRlbmNlQmVnaW4saW5wdXQuc2VudGVuY2VFbmQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoNCiAgICAgICAgICAgICAgICBjYXNlICJWb2lkIjogew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0VHlwZSA9IG5ldyBWb2lkSU9UeXBlKGlucHV0LmRlc2NyaXB0aW9uKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KDQoNCiAgICAgICAgICAgICAgICBjYXNlICJVUkwiOiB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRUeXBlID0gbmV3IFVSTFR5cGUoaW5wdXQudXJsKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KDQoNCiAgICAgICAgICAgICAgICBkZWZhdWx0OiB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJpbnB1dCB0eXBlIG5vdCBzdXBwb3J0ZWQhLi4uIikNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICAvKg0KICAgICAgICAgICAgaW5wdXRJbmZvID0gew0KICAgICAgICAgICAgICAgIHZhbHVlOmlucHV0LnZhbHVlLA0KICAgICAgICAgICAgICAgIHR5cGU6aW5wdXQudHlwZSwNCiAgICAgICAgICAgICAgICBsYW5nOiBpbnB1dC5sYW5nLA0KICAgICAgICAgICAgfTsqLw0KICAgICAgICB9DQoNCiAgICAgICAgbGV0IGFnZW50ID0gJ2h1bWFuJzsNCiAgICAgICAgaWYgKHJlYXNvbmVyX3RyaWdnZXJlZCkgew0KICAgICAgICAgICAgYWdlbnQgPSAncmVhc29uZXInOw0KICAgICAgICB9DQoNCiAgICAgICAgdGhpcy5tZXNzYWdlID0gew0KICAgICAgICAgICAgaWQ6IGlkLA0KICAgICAgICAgICAgdHlwZTogImNsb3VkUmVxdWVzdCIsDQogICAgICAgICAgICBhZ2VudDogYWdlbnQsDQogICAgICAgICAgICB1aTogew0KICAgICAgICAgICAgICAgIHVpSWQ6IHVpSWQsDQogICAgICAgICAgICAgICAgdG9vbElkOiB0b29sSWQsDQogICAgICAgICAgICB9LA0KDQogICAgICAgICAgICBpbnB1dDogdGhpcy5pbnB1dFR5cGUsDQogICAgICAgICAgICByZXF1ZXN0SW5mbyA6IG5ldyBSZXF1ZXN0SW5mbyh1aUlkLCB0b29sSWQsIGF1dG9tYXRpY1JlcXVlc3QsIHJlYXNvbmVyX3RyaWdnZXJlZCksDQoNCiAgICAgICAgfTsNCg0KICAgICAgICBpZiAoZnVuY3Rpb25JbmZvLnNvdXJjZS50eXBlID09PSAiUmVtb3RlRnVuY3Rpb24iKSB7DQogICAgICAgICAgICB0aGlzLm1lc3NhZ2UuZnVuY3Rpb25JbmZvID0NCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGVuZ2luZUlkOiBmdW5jdGlvbkluZm8uc291cmNlLmVuZ2luZS5pZCwNCiAgICAgICAgICAgICAgICAgICAgZW5naW5lVmVyc2lzb246IGZ1bmN0aW9uSW5mby5zb3VyY2UuZW5naW5lLnZlcnNpb24sDQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uSWQ6IGZ1bmN0aW9uSW5mby5zb3VyY2UuaWQsDQogICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb246IGZ1bmN0aW9uSW5mby5jb25maWd1cmF0aW9uLA0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvblR5cGU6ICJSZW1vdGVGdW5jdGlvbiIsDQoNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICB9ZWxzZSBpZihmdW5jdGlvbkluZm8uc291cmNlLnR5cGUgPT09ICJDb21iaW5lZEZ1bmN0aW9uIil7DQogICAgICAgICAgICB0aGlzLm1lc3NhZ2UuZnVuY3Rpb25JbmZvID0NCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uSWQ6IGZ1bmN0aW9uSW5mby5zb3VyY2UuaWQsDQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uVHlwZTogIkNvbWJpbmVkRnVuY3Rpb24iLA0KDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgfWVsc2UgaWYoZnVuY3Rpb25JbmZvLnNvdXJjZS50eXBlID09PSAiTG9jYWxGdW5jdGlvbiIpew0KICAgICAgICAgICAgdGhpcy5tZXNzYWdlLmZ1bmN0aW9uSW5mbyA9DQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbklkOiBmdW5jdGlvbkluZm8uc291cmNlLmlkLA0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvblR5cGU6ICJDb21iaW5lZEZ1bmN0aW9uIiwNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICBiZWxvbmdzVG9XaWRnZXQod2lkZ2V0KSB7DQoNCiAgICAgICAgcmV0dXJuIHRoaXMudWlJZCA9PT0gd2lkZ2V0LnVzZXJJbnRlcmZhY2UudWlJZCAmJiB0aGlzLnRvb2xJZCA9PT0gd2lkZ2V0LnRvb2xJZCAmJiB0aGlzLmZ1bmN0aW9uSW5mbyA9PT0gd2lkZ2V0LmZ1bmN0aW9uSW5mbzsNCiAgICB9DQoNCg0KfQ0KY2xhc3MgUmVxdWVzdEluZm97DQogICAgY29uc3RydWN0b3IodWlJbmRleCwgdG9vbEluZGV4LGF1dG9tYXRpY1JlcXVlc3QsIHJlYXNvbmVyVHJpZ2dlcmVkKSB7DQogICAgICAgIHRoaXMudWlJbmRleCA9IHVpSW5kZXg7DQogICAgICAgIHRoaXMudG9vbEluZGV4ID0gdG9vbEluZGV4Ow0KICAgICAgICB0aGlzLmF1dG9tYXRpY1JlcXVlc3QgPSBhdXRvbWF0aWNSZXF1ZXN0Ow0KICAgICAgICB0aGlzLnJlYXNvbmVyVHJpZ2dlcmVkID0gcmVhc29uZXJUcmlnZ2VyZWQ7DQoNCiAgICAgICAgdGhpcy5ocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWY7DQogICAgICAgIHRoaXMuaG9zdG5hbWUgPSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWU7DQogICAgICAgIHRoaXMucGF0aG5hbWUgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7DQogICAgICAgIHRoaXMudG9vbFVzYWdlID0gcmVxdWVzdE1hbmFnZXIuZ2V0VG9vbFVzYWdlRW50cnkodWlJbmRleCx0b29sSW5kZXgpOw0KICAgIH0NCg0KfQ0KDQpsZXQgcmVxdWVzdE1hbmFnZXIgPSB7DQogICAgY3VycmVudFJlcXVlc3RJRDogMSwNCiAgICBhY3RpdmVSZXF1ZXN0czogW10sDQogICAgdG9vbFVzYWdlRW50cmllczpbXSwNCiAgICBjcmVhdGVSZXF1ZXN0OiBmdW5jdGlvbiAod2lkZ2V0LCBpbnB1dCwgZT1udWxsLCBhdXRvbWF0aWNSZXF1ZXN0PWZhbHNlKSB7DQogICAgICAgIC8vIFRocmVlIHBvc3NpYmlsaXRpZXM6IHVzZXItdHJpZ2dlcmVkIChkZWZhdWx0KSwgcmVhc29uZXItdHJpZ2dlcmVkLCB3aWRnZXQtdHJpZ2dlcmVkDQogICAgICAgIGxldCByZWFzb25lcl90cmlnZ2VyZWQgPSBmYWxzZTsNCiAgICAgICAgbGV0IGF1dG9tYXRpY19yZXF1ZXN0ID0gYXV0b21hdGljUmVxdWVzdDsNCiAgICAgICAgaWYgKGUgJiYgJ3VzZXJfdHJpZ2dlcmVkJyBpbiBlKSB7DQogICAgICAgICAgICBhdXRvbWF0aWNfcmVxdWVzdCA9ICFlWyd1c2VyX3RyaWdnZXJlZCddOw0KICAgICAgICB9DQogICAgICAgIGlmIChlICYmICdyZWFzb25lcl90cmlnZ2VyZWQnIGluIGUpIHsNCiAgICAgICAgICAgIHJlYXNvbmVyX3RyaWdnZXJlZCA9IGVbJ3JlYXNvbmVyX3RyaWdnZXJlZCddOw0KICAgICAgICB9DQogICAgICAgIGlmICghYXV0b21hdGljX3JlcXVlc3QgJiYgIXJlYXNvbmVyX3RyaWdnZXJlZCkgew0KICAgICAgICAgICAgLy8gTm90aWZ5IHVzZXIgdHJhY2tpbmcgcmVhc29uZXIgdGhhdCB1c2VyIG5lZWRzIGhlbHAgKGhhcyB0cmlnZ2VyZWQgYSB0b29sKQ0KICAgICAgICAgICAgbGV0IHAgPSB3aWRnZXQudXNlckludGVyZmFjZS50b29sc1t3aWRnZXQudG9vbEluZGV4XS5wcmVzZW50YXRpb247DQogICAgICAgICAgICBsZXQgaW5zdGFudCA9IHRydWU7ICAvLyBJZiB0b29sIGhhcyBubyBwcmVzZW50YXRpb24sIGl0IGlzIGluc3RhbnQNCiAgICAgICAgICAgIGlmIChwICE9PSBudWxsKSB7ICAvLyBPdGhlcndpc2UsIGZldGNoIHdoZXRoZXIgaXRzIHByZXNlbnRhdGlvbiBpcyBpbnN0YW50IChpLmUuIG5vdC1jb250aW51b3VzKQ0KICAgICAgICAgICAgICAgIGluc3RhbnQgPSBwLmluc3RhbnREaXNwbGF5Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY29udGVudFNjcmlwdENvbnRyb2xsZXIuc2VuZE1lc3NhZ2VUb0JhY2tncm91bmRTY3JpcHQoew0KICAgICAgICAgICAgICAgIHR5cGU6ICJ0b29sVHJpZ2dlcmVkQnlVc2VyIiwNCiAgICAgICAgICAgICAgICB3YWl0OiAhaW5zdGFudCwNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIGlmICh3aWRnZXQuZnVuY3Rpb25JbmZvLnNvdXJjZS50eXBlID09PSAiTG9jYWxGdW5jdGlvbiIpIHsNCiAgICAgICAgICAgIGZ1bmN0aW9uTWFwcGluZ1t3aWRnZXQuZnVuY3Rpb25JbmZvLnNvdXJjZS5lbnRyeVBvaW50XShpbnB1dCwgd2lkZ2V0LmZ1bmN0aW9uSW5mby5jb25maWd1cmF0aW9uLHdpZGdldCk7DQogICAgICAgICAgICAvLyAgIHdpbmRvd1t3aWRnZXQuZnVuY3Rpb25JbmZvLnNvdXJjZS5lbnRyeVBvaW50XShpbnB1dCwgd2lkZ2V0LmZ1bmN0aW9uSW5mby5jb25maWd1cmF0aW9uKTsNCg0KICAgICAgICAgICAgLy9Eb250IHB1c2ggdGhpcyBvbiBhY3RpdmUgcmVxdWVzdHMgLSBpdCBpcyBsb2NhbCBhbnl3YXkNCiAgICAgICAgICAgIGxldCBjdXJyZW50UmVxdWVzdCA9IG5ldyBSZXF1ZXN0KHRoaXMuY3VycmVudFJlcXVlc3RJRCsrLCBpbnB1dCwgd2lkZ2V0LnVzZXJJbnRlcmZhY2UudWlJbmRleCwgd2lkZ2V0LnRvb2xJbmRleCwNCiAgICAgICAgICAgICAgICB3aWRnZXQuZnVuY3Rpb25JbmZvLGF1dG9tYXRpY19yZXF1ZXN0LCByZWFzb25lcl90cmlnZ2VyZWQpOw0KICAgICAgICAgICAgY29udGVudFNjcmlwdENvbnRyb2xsZXIuc2VuZE1lc3NhZ2VUb0JhY2tncm91bmRTY3JpcHQoY3VycmVudFJlcXVlc3QubWVzc2FnZSk7DQoNCiAgICAgICAgfSBlbHNlIGlmICh3aWRnZXQuZnVuY3Rpb25JbmZvLnNvdXJjZS50eXBlID09PSAiUmVtb3RlRnVuY3Rpb24iKSB7DQoNCg0KICAgICAgICAgICAgbGV0IGN1cnJlbnRSZXF1ZXN0ID0gbmV3IFJlcXVlc3QodGhpcy5jdXJyZW50UmVxdWVzdElEKyssIGlucHV0LCB3aWRnZXQudXNlckludGVyZmFjZS51aUluZGV4LCB3aWRnZXQudG9vbEluZGV4LA0KICAgICAgICAgICAgICAgIHdpZGdldC5mdW5jdGlvbkluZm8sIGF1dG9tYXRpY19yZXF1ZXN0LCByZWFzb25lcl90cmlnZ2VyZWQpOw0KDQogICAgICAgICAgICB0aGlzLmFjdGl2ZVJlcXVlc3RzLnB1c2goY3VycmVudFJlcXVlc3QpOw0KICAgICAgICAgICAgY29udGVudFNjcmlwdENvbnRyb2xsZXIuc2VuZE1lc3NhZ2VUb0JhY2tncm91bmRTY3JpcHQoY3VycmVudFJlcXVlc3QubWVzc2FnZSk7DQoNCiAgICAgICAgICAgIGNvbnRlbnRTY3JpcHRDb250cm9sbGVyLnNlbmRNZXNzYWdlVG9CYWNrZ3JvdW5kU2NyaXB0KHt0eXBlOiAiZnJlZXplUmVhc29uZXIifSk7DQoNCiAgICAgICAgfSBlbHNlIGlmICh3aWRnZXQuZnVuY3Rpb25JbmZvLnNvdXJjZS50eXBlID09PSAiQ29tYmluZWRGdW5jdGlvbiIpIHsNCg0KDQogICAgICAgICAgICBsZXQgY3VycmVudFJlcXVlc3QgPSBuZXcgUmVxdWVzdCh0aGlzLmN1cnJlbnRSZXF1ZXN0SUQrKywgaW5wdXQsIHdpZGdldC51c2VySW50ZXJmYWNlLnVpSW5kZXgsIHdpZGdldC50b29sSW5kZXgsDQogICAgICAgICAgICAgICAgd2lkZ2V0LmZ1bmN0aW9uSW5mbywgYXV0b21hdGljX3JlcXVlc3QsIHJlYXNvbmVyX3RyaWdnZXJlZCk7DQoNCiAgICAgICAgICAgIHRoaXMuYWN0aXZlUmVxdWVzdHMucHVzaChjdXJyZW50UmVxdWVzdCk7DQogICAgICAgICAgICBjb250ZW50U2NyaXB0Q29udHJvbGxlci5zZW5kTWVzc2FnZVRvQmFja2dyb3VuZFNjcmlwdChjdXJyZW50UmVxdWVzdC5tZXNzYWdlKTsNCg0KICAgICAgICAgICAgY29udGVudFNjcmlwdENvbnRyb2xsZXIuc2VuZE1lc3NhZ2VUb0JhY2tncm91bmRTY3JpcHQoe3R5cGU6ICJmcmVlemVSZWFzb25lciJ9KTsNCg0KICAgICAgICB9DQoNCg0KICAgIH0sDQogICAgcmVjZWl2ZVJlcXVlc3RSZXN1bHQ6IGZ1bmN0aW9uIChyZXN1bHQpIHsNCg0KICAgICAgICBsZXQgcmVxdWVzdCA9IHRoaXMuZ2V0UmVxdWVzdEZvclJlc3VsdChyZXN1bHQpOw0KDQogICAgICAgIGlmIChyZXF1ZXN0KSB7DQogICAgICAgICAgICBpZiAocmVzdWx0Lm91dHB1dFR5cGUgPT09IEphdmFTY3JpcHRUeXBlLmNsYXNzTmFtZSkgew0KICAgICAgICAgICAgICAgIGV2YWwocmVzdWx0LnJlc3VsdC5zY3JpcHQpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgIHJlc3VsdC5yZXN1bHQgPSBpb1R5cGVVdGlscy50b0lPVHlwZUluc3RhbmNlKHJlc3VsdC5yZXN1bHQpOw0KICAgICAgICAgICAgICAgIGVhc3lSZWFkaW5nLnVzZXJJbnRlcmZhY2VzW3JlcXVlc3QudWlJZF0udG9vbHNbcmVxdWVzdC50b29sSWRdLnByZXNlbnRhdGlvbi5yZW5kZXJSZXN1bHQocmVxdWVzdCwgcmVzdWx0KTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZWFzeVJlYWRpbmcudXNlckludGVyZmFjZXNbcmVxdWVzdC51aUlkXS50b29sc1tyZXF1ZXN0LnRvb2xJZF0ud2lkZ2V0LnJlcXVlc3RGaW5pc2hlZCgpOw0KDQogICAgICAgIH0NCg0KICAgICAgICBpZiAodGhpcy5hY3RpdmVSZXF1ZXN0cy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgIGNvbnRlbnRTY3JpcHRDb250cm9sbGVyLnNlbmRNZXNzYWdlVG9CYWNrZ3JvdW5kU2NyaXB0KHt0eXBlOiAidW5mcmVlemVSZWFzb25lciJ9KTsNCiAgICAgICAgfQ0KDQogICAgfSwNCg0KICAgIGdldFJlcXVlc3RGb3JSZXN1bHQocmVzdWx0KSB7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5hY3RpdmVSZXF1ZXN0cy5sZW5ndGg7IGkrKykgew0KDQogICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVSZXF1ZXN0c1tpXS5pZCA9PT0gcmVzdWx0LmlkKSB7DQoNCiAgICAgICAgICAgICAgICBsZXQgY3VycmVudFJlcXVlc3QgPSB0aGlzLmFjdGl2ZVJlcXVlc3RzW2ldOw0KDQogICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVSZXF1ZXN0cy5zcGxpY2UoaSwgMSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRSZXF1ZXN0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSwNCg0KICAgIGNhbmNlbFJlcXVlc3Qod2lkZ2V0KSB7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5hY3RpdmVSZXF1ZXN0cy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlUmVxdWVzdHNbaV0uYmVsb25nc1RvV2lkZ2V0KHdpZGdldCkpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZVJlcXVlc3RzLnNwbGljZShpLCAxKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgIH0sDQoNCiAgICBnZXRUb29sVXNhZ2VFbnRyeSh1aUluZGV4LHRvb2xJbmRleCl7DQoNCiAgICAgICAgbGV0IHRvb2xJRCA9IHVpSW5kZXgrIl8iK3Rvb2xJbmRleDsNCiAgICAgICAgZm9yKGxldCBpPTA7IGk8IHJlcXVlc3RNYW5hZ2VyLnRvb2xVc2FnZUVudHJpZXMubGVuZ3RoOyBpKyspew0KDQogICAgICAgICAgICBpZihyZXF1ZXN0TWFuYWdlci50b29sVXNhZ2VFbnRyaWVzW2ldLnRvb2xJRCA9PT0gdG9vbElEKXsNCg0KICAgICAgICAgICAgICAgIHJlcXVlc3RNYW5hZ2VyLnRvb2xVc2FnZUVudHJpZXNbaV0udG9vbENvdW50Kys7DQogICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3RNYW5hZ2VyLnRvb2xVc2FnZUVudHJpZXNbaV07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBsZXQgdG9vbFVzYWdlRW50cnkgPSB7DQogICAgICAgICAgICB0b29sSUQ6dG9vbElELA0KICAgICAgICAgICAgdG9vbENvdW50OiAxLA0KICAgICAgICB9Ow0KICAgICAgICByZXF1ZXN0TWFuYWdlci50b29sVXNhZ2VFbnRyaWVzLnB1c2godG9vbFVzYWdlRW50cnkpOw0KDQogICAgICAgIHJldHVybiB0b29sVXNhZ2VFbnRyeTsNCg0KICAgIH0NCg0KDQp9Ow0KDQo=",
        "bGV0IHVpVXBkYXRlTWFuYWdlciA9IHsNCiAgICBzYXZlQ3VycmVudENvbmZpZ3VyYXRpb246IGZ1bmN0aW9uICh1aSxjb25maWd1cmF0aW9uKSB7DQoNCiAgICAgICAgbGV0IG1lc3NhZ2UgPXsNCiAgICAgICAgICAgIHR5cGU6ICJzYXZlVWlDb25maWd1cmF0aW9uRm9yVGFiIiwNCiAgICAgICAgICAgIGlkOiB1aS5pZCwNCiAgICAgICAgICAgIGNvbmZpZ3VyYXRpb246IGNvbmZpZ3VyYXRpb24sDQogICAgICAgIH07DQogICAgICAgIGNvbnRlbnRTY3JpcHRDb250cm9sbGVyLnNlbmRNZXNzYWdlVG9CYWNrZ3JvdW5kU2NyaXB0KG1lc3NhZ2UpOw0KDQogICAgfQ0KfTs=",
        "bGV0IGZlZWRiYWNrRm9ybSA9IHsNCg0KICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLA0KICAgIHZpc2libGVQYWdlOiAxLA0KICAgIHNob3dGZWVkYmFja0Zvcm06IGZ1bmN0aW9uKCkgew0KDQogICAgICAgIGZlZWRiYWNrRm9ybS5raWxsRmVlZGJhY2tGb3JtKCk7DQoNCiAgICAgICAgbGV0IGxhbmdTdHJpbmdzID0gZmVlZGJhY2tGb3JtLmkxOG4uZGU7DQogICAgICAgIGlmIChlYXN5UmVhZGluZy51aUNvbGxlY3Rpb24ubGFuZyA9PT0gImVuIikgew0KICAgICAgICAgICAgbGFuZ1N0cmluZ3MgPSBmZWVkYmFja0Zvcm0uaTE4bi5lbjsNCiAgICAgICAgfSBlbHNlIGlmIChlYXN5UmVhZGluZy51aUNvbGxlY3Rpb24ubGFuZyA9PT0gInN2Iikgew0KICAgICAgICAgICAgbGFuZ1N0cmluZ3MgPSBmZWVkYmFja0Zvcm0uaTE4bi5zdjsNCiAgICAgICAgfSBpZiAoZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLmxhbmcgPT09ICJlcyIpIHsNCiAgICAgICAgICAgIGxhbmdTdHJpbmdzID0gZmVlZGJhY2tGb3JtLmkxOG4uZXM7DQogICAgICAgIH0NCiAgICAgICAgbGV0IGZvcm1IVE1MID0gICc8ZGl2IGNsYXNzPSJtb2RhbCBtaWNyb21vZGFsLXNsaWRlIiBpZD0iZXItZmVlZGJhY2siIGFyaWEtaGlkZGVuPSJ0cnVlIj5cbicgKw0KICAgICAgICAgICAgJyAgICA8ZGl2IGNsYXNzPSJtb2RhbF9fb3ZlcmxheSIgdGFiaW5kZXg9Ii0xIiBkYXRhLW1pY3JvbW9kYWwtY2xvc2U+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsX19jb250YWluZXIiIHJvbGU9ImRpYWxvZyIgYXJpYS1tb2RhbD0idHJ1ZSIgYXJpYS1sYWJlbGxlZGJ5PSJlci1mZWVkYmFjay10aXRsZSI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICA8aGVhZGVyIGNsYXNzPSJtb2RhbF9faGVhZGVyIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICA8aDIgY2xhc3M9Im1vZGFsX190aXRsZSIgaWQ9ImVyLWZlZWRiYWNrLXRpdGxlIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPGRpdj4nICsgbGFuZ1N0cmluZ3MuaGVhZGluZyArICdcbjwvZGl2PicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSInICsgZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLnNlcnZlclVSTCArICcvaW1hZ2VzL2ZlZWRiYWNrRm9ybS9sb2dvX3cucG5nIiBhbHQ9IicgKyBsYW5nU3RyaW5ncy5hbHRfbG9nbyArICciIHRpdGxlPSInICsgbGFuZ1N0cmluZ3MuYWx0X2xvZ28gKyAnIiBpZD0iZXItZmVlZGJhY2stbG9nbyI+JyArIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICA8L2gyPlxuJyArICANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0iZXJGZWVkYmFja0NhbmNlbCIgY2xhc3M9Im1vZGFsX19jbG9zZSIgYXJpYS1sYWJlbD0iJyArIGxhbmdTdHJpbmdzLmNsb3NlQnRuX2FyaWFMYWJlbCArICciIGRhdGEtbWljcm9tb2RhbC1jbG9zZT48L2J1dHRvbj4nKw0KICAgICAgICAgICAgJyAgICAgICAgICAgIDwvaGVhZGVyPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgPG1haW4gY2xhc3M9Im1vZGFsX19jb250ZW50IiBpZD0iZXItZmVlZGJhY2stY29udGVudCI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZXJGZWVkYmFjayBlckZlZWRiYWNrX3BhZ2UxIj4nICsgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGlkPSJoZWxsb18xIj4nICsgbGFuZ1N0cmluZ3MuaGVsbG8gKyc8L2Rpdj4nICsgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGlkPSJoZWxsb18yIj4nICsgbGFuZ1N0cmluZ3MuYW5vbnltb3VzICsnPC9kaXY+JyArIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBpZD0iaGVsbG9fMyI+JyArIGxhbmdTdHJpbmdzLmNvbnNlbnQgKyc8L2Rpdj4nICsgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGlkPSJoZWxsb180Ij4nICsgbGFuZ1N0cmluZ3MucHJpdmFjeV9pbmZvICsnPC9kaXY+JyArIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj5cbicgKyAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgIDxmaWVsZHNldCBjbGFzcz0iZXJGZWVkYmFjayBlckZlZWRiYWNrX3BhZ2UyIj5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgPGxlZ2VuZCBpZD0ibGVnZW5kX3ExIj4nICsgbGFuZ1N0cmluZ3MucTFfbGVnZW5kICsgJzwvbGVnZW5kPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9IicgKyBlYXN5UmVhZGluZy51aUNvbGxlY3Rpb24uc2VydmVyVVJMICsgJy9pbWFnZXMvZmVlZGJhY2tGb3JtL2xvZ29fdy5wbmciIGFsdD0iIj4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgaWQ9InExXzFfbGFiZWwiIGNsYXNzPSJlclJhZGlvTGFiZWwiIGZvcj0icTFfMSI+JyArIGxhbmdTdHJpbmdzLnExXzEgKyAnPC9sYWJlbD5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0idHJpZWRFUiIgaWQ9InExXzEiIHZhbHVlPSIxIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuJyArIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSInICsgZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLnNlcnZlclVSTCArICcvaW1hZ2VzL2ZlZWRiYWNrRm9ybS9sb2dvX3cucG5nIiBhbHQ9IiI+JyArICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGlkPSJxMV8yX2xhYmVsIiBjbGFzcz0iZXJSYWRpb0xhYmVsIiBmb3I9InExXzIiPicgKyBsYW5nU3RyaW5ncy5xMV8yICsgJzwvbGFiZWw+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFkaW8iIG5hbWU9InRyaWVkRVIiIGlkPSJxMV8yIiB2YWx1ZT0iMiI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuJyArIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPGRpdj5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iJyArIGVhc3lSZWFkaW5nLnVpQ29sbGVjdGlvbi5zZXJ2ZXJVUkwgKyAnL2ltYWdlcy9mZWVkYmFja0Zvcm0vd29tYW5fcGFnZTEucG5nIiBhbHQ9IiI+JyArICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGlkPSJxMV8zX2xhYmVsIiBjbGFzcz0iZXJSYWRpb0xhYmVsIiBmb3I9InExXzMiPicgKyBsYW5nU3RyaW5ncy5xMV8zICsgJzwvbGFiZWw+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFkaW8iIG5hbWU9InRyaWVkRVIiIGlkPSJxMV8zIiB2YWx1ZT0iMyI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuJyArIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPGRpdj5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iJyArIGVhc3lSZWFkaW5nLnVpQ29sbGVjdGlvbi5zZXJ2ZXJVUkwgKyAnL2ltYWdlcy9mZWVkYmFja0Zvcm0vZ3V5X3BhZ2UxLnBuZyIgYWx0PSIiPicgKyAgICAgICAgICAgIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBpZD0icTFfNF9sYWJlbCIgY2xhc3M9ImVyUmFkaW9MYWJlbCIgZm9yPSJxMV80Ij4nICsgbGFuZ1N0cmluZ3MucTFfNCArICc8L2xhYmVsPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJ0cmllZEVSIiBpZD0icTFfNCIgdmFsdWU9IjQiPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbicgKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgPC9maWVsZHNldD5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICA8ZmllbGRzZXQgY2xhc3M9ImVyRmVlZGJhY2sgZXJGZWVkYmFja19wYWdlMyI+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgIDxsZWdlbmQ+PHN0cm9uZz4nICsgbGFuZ1N0cmluZ3MucTJfbGVnZW5kXzEgKyAnPC9zdHJvbmc+JyArIGxhbmdTdHJpbmdzLnEyX2xlZ2VuZF8yICsgJzwvbGVnZW5kPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyYWRpb0RpdiI+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9IicgKyBlYXN5UmVhZGluZy51aUNvbGxlY3Rpb24uc2VydmVyVVJMICsgJy9pbWFnZXMvZmVlZGJhY2tGb3JtL25vdW5fbGlrZV81OTQ0NDQucG5nIiBhbHQ9IiI+JyArICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0icTJfMSI+JyArIGxhbmdTdHJpbmdzLnEyXzEgKyAnPC9sYWJlbD5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0iaW5zdGFsbGVkRVIiIGlkPSJxMl8xIiB2YWx1ZT0iMSI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuJyArIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmFkaW9EaXYiPlxuJyArIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSInICsgZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLnNlcnZlclVSTCArICcvaW1hZ2VzL2ZlZWRiYWNrRm9ybS9ub3VuX3NwZWVjaGxlc3NfNTk0NDQzKDEpLnBuZyIgYWx0PSIiPicgKyAgICAgICAgICAgIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InEyXzIiPicgKyBsYW5nU3RyaW5ncy5xMl8yICsgJzwvbGFiZWw+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFkaW8iIG5hbWU9Imluc3RhbGxlZEVSIiBpZD0icTJfMiIgdmFsdWU9IjIiPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJhZGlvRGl2Ij5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iJyArIGVhc3lSZWFkaW5nLnVpQ29sbGVjdGlvbi5zZXJ2ZXJVUkwgKyAnL2ltYWdlcy9mZWVkYmFja0Zvcm0vbm91bl9EaXNsaWtlXzU5NDQ0NygxKS5wbmciIGFsdD0iIj4nICsgICAgICAgICAgICANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJxMl8zIj4nICsgbGFuZ1N0cmluZ3MucTJfMyArICc8L2xhYmVsPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJpbnN0YWxsZWRFUiIgaWQ9InEyXzMiIHZhbHVlPSIzIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyYWRpb0RpdiI+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9IicgKyBlYXN5UmVhZGluZy51aUNvbGxlY3Rpb24uc2VydmVyVVJMICsgJy9pbWFnZXMvZmVlZGJhY2tGb3JtL25vdW5fUXVlc3Rpb25fNzA5NjQucG5nIiBhbHQ9IiI+JyArICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0icTJfNCI+JyArIGxhbmdTdHJpbmdzLnEyXzQgKyAnPC9sYWJlbD5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0iaW5zdGFsbGVkRVIiIGlkPSJxMl80IiB2YWx1ZT0iNCI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuJyArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICA8L2ZpZWxkc2V0PlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgIDxmaWVsZHNldCBjbGFzcz0iZXJGZWVkYmFjayBlckZlZWRiYWNrX3BhZ2U0Ij5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgPGxlZ2VuZD48c3Ryb25nPicgKyBsYW5nU3RyaW5ncy5xM19sZWdlbmRfMSArICc8L3N0cm9uZz4nICsgbGFuZ1N0cmluZ3MucTNfbGVnZW5kXzIgKyAnPC9sZWdlbmQ+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJhZGlvRGl2Ij5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iJyArIGVhc3lSZWFkaW5nLnVpQ29sbGVjdGlvbi5zZXJ2ZXJVUkwgKyAnL2ltYWdlcy9mZWVkYmFja0Zvcm0vbm91bl9saWtlXzU5NDQ0NC5wbmciIGFsdD0iIj4nICsgICAgICAgICAgICANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJxM18xIj4nICsgbGFuZ1N0cmluZ3MucTNfMSArICc8L2xhYmVsPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJsaWtlRVIiIGlkPSJxM18xIiB2YWx1ZT0iMSI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuJyArIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmFkaW9EaXYiPlxuJyArIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSInICsgZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLnNlcnZlclVSTCArICcvaW1hZ2VzL2ZlZWRiYWNrRm9ybS9ub3VuX3NwZWVjaGxlc3NfNTk0NDQzKDEpLnBuZyIgYWx0PSIiPicgKyAgICAgICAgICAgIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InEzXzIiPicgKyBsYW5nU3RyaW5ncy5xM18yICsgJzwvbGFiZWw+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFkaW8iIG5hbWU9Imxpa2VFUiIgaWQ9InEzXzIiIHZhbHVlPSIyIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyYWRpb0RpdiI+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9IicgKyBlYXN5UmVhZGluZy51aUNvbGxlY3Rpb24uc2VydmVyVVJMICsgJy9pbWFnZXMvZmVlZGJhY2tGb3JtL25vdW5fRGlzbGlrZV81OTQ0NDcoMSkucG5nIiBhbHQ9IiI+JyArICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0icTNfMyI+JyArIGxhbmdTdHJpbmdzLnEzXzMgKyAnPC9sYWJlbD5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0ibGlrZUVSIiBpZD0icTNfMyIgdmFsdWU9IjMiPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJhZGlvRGl2Ij5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iJyArIGVhc3lSZWFkaW5nLnVpQ29sbGVjdGlvbi5zZXJ2ZXJVUkwgKyAnL2ltYWdlcy9mZWVkYmFja0Zvcm0vbm91bl9RdWVzdGlvbl83MDk2NC5wbmciIGFsdD0iIj4nICsgICAgICAgICAgICANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJxM180Ij4nICsgbGFuZ1N0cmluZ3MucTNfNCArICc8L2xhYmVsPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJsaWtlRVIiIGlkPSJxM180IiB2YWx1ZT0iNCI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuJyArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICA8L2ZpZWxkc2V0PlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgIDxmaWVsZHNldCBjbGFzcz0iZXJGZWVkYmFjayBlckZlZWRiYWNrX3BhZ2U1Ij5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgPGxlZ2VuZD48c3Ryb25nPicgKyBsYW5nU3RyaW5ncy5xNF9sZWdlbmRfMSArICc8L3N0cm9uZz4nICsgbGFuZ1N0cmluZ3MucTRfbGVnZW5kXzIgKyAnPC9sZWdlbmQ+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJhZGlvRGl2Ij5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iJyArIGVhc3lSZWFkaW5nLnVpQ29sbGVjdGlvbi5zZXJ2ZXJVUkwgKyAnL2ltYWdlcy9mZWVkYmFja0Zvcm0vbm91bl9saWtlXzU5NDQ0NC5wbmciIGFsdD0iIj4nICsgICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0icTRfMSI+JyArIGxhbmdTdHJpbmdzLnE0XzEgKyAnPC9sYWJlbD5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0idXNhZ2VFUiIgaWQ9InE0XzEiIHZhbHVlPSIxIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyYWRpb0RpdiI+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9IicgKyBlYXN5UmVhZGluZy51aUNvbGxlY3Rpb24uc2VydmVyVVJMICsgJy9pbWFnZXMvZmVlZGJhY2tGb3JtL25vdW5fc3BlZWNobGVzc181OTQ0NDMoMSkucG5nIiBhbHQ9IiI+JyArICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0icTRfMiI+JyArIGxhbmdTdHJpbmdzLnE0XzIgKyAnPC9sYWJlbD5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0idXNhZ2VFUiIgaWQ9InE0XzIiIHZhbHVlPSIyIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyYWRpb0RpdiI+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9IicgKyBlYXN5UmVhZGluZy51aUNvbGxlY3Rpb24uc2VydmVyVVJMICsgJy9pbWFnZXMvZmVlZGJhY2tGb3JtL25vdW5fRGlzbGlrZV81OTQ0NDcoMSkucG5nIiBhbHQ9IiI+JyArICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0icTRfMyI+JyArIGxhbmdTdHJpbmdzLnE0XzMgKyAnPC9sYWJlbD5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0idXNhZ2VFUiIgaWQ9InE0XzMiIHZhbHVlPSIzIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyYWRpb0RpdiI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iJyArIGVhc3lSZWFkaW5nLnVpQ29sbGVjdGlvbi5zZXJ2ZXJVUkwgKyAnL2ltYWdlcy9mZWVkYmFja0Zvcm0vbm91bl9RdWVzdGlvbl83MDk2NC5wbmciIGFsdD0iIj4nICsgICAgICAgICAgICANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJxNF80Ij4nICsgbGFuZ1N0cmluZ3MucTRfNCArICc8L2xhYmVsPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJ1c2FnZUVSIiBpZD0icTRfNCIgdmFsdWU9IjQiPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYWRkRGl2Ij5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InE0X2FkZCI+JyArIGxhbmdTdHJpbmdzLnE0X2FkZCArICc8L2xhYmVsPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9IicgKyBlYXN5UmVhZGluZy51aUNvbGxlY3Rpb24uc2VydmVyVVJMICsgJy9pbWFnZXMvZmVlZGJhY2tGb3JtL25vdW5fUGVuY2lsXzI0ODYxNDkucG5nIiBhbHQ9IiI+JyArICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBpZD0icTRfYWRkIiByb3dzPSIzIiBjb2x1bW5zPSI1MCI+PC90ZXh0YXJlYT5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4nICsgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbicgKyAgICAgICAgICAgIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICA8L2ZpZWxkc2V0PlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgIDxmaWVsZHNldCBjbGFzcz0iZXJGZWVkYmFjayBlckZlZWRiYWNrX3BhZ2U2Ij5cbicgKyANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgPGxlZ2VuZD48c3Ryb25nPicgKyBsYW5nU3RyaW5ncy5xNV9sZWdlbmRfMSArICc8L3N0cm9uZz4nICsgbGFuZ1N0cmluZ3MucTVfbGVnZW5kXzIgKyAnPC9sZWdlbmQ+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJhZGlvRGl2Ij5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSInICsgZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLnNlcnZlclVSTCArICcvaW1hZ2VzL2ZlZWRiYWNrRm9ybS9ub3VuX2xpa2VfNTk0NDQ0LnBuZyIgYWx0PSIiPicgKyAgICAgICAgICAgICANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJxNV8xIj4nICsgbGFuZ1N0cmluZ3MucTVfMSArICc8L2xhYmVsPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJoZWxwZWRFUiIgaWQ9InE1XzEiIHZhbHVlPSIxIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyYWRpb0RpdiI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iJyArIGVhc3lSZWFkaW5nLnVpQ29sbGVjdGlvbi5zZXJ2ZXJVUkwgKyAnL2ltYWdlcy9mZWVkYmFja0Zvcm0vbm91bl9EaXNsaWtlXzU5NDQ0NygxKS5wbmciIGFsdD0iIj4nICsgICAgICAgICAgICANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJxNV8yIj4nICsgbGFuZ1N0cmluZ3MucTVfMiArICc8L2xhYmVsPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJoZWxwZWRFUiIgaWQ9InE1XzIiIHZhbHVlPSIyIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyYWRpb0RpdiI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iJyArIGVhc3lSZWFkaW5nLnVpQ29sbGVjdGlvbi5zZXJ2ZXJVUkwgKyAnL2ltYWdlcy9mZWVkYmFja0Zvcm0vbm91bl9RdWVzdGlvbl83MDk2NC5wbmciIGFsdD0iIj4nICsgICAgICAgICAgICANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJxNV8zIj4nICsgbGFuZ1N0cmluZ3MucTVfMyArICc8L2xhYmVsPlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJoZWxwZWRFUiIgaWQ9InE1XzMiIHZhbHVlPSIzIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImFkZERpdiI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJxNV9hZGQiPicgKyBsYW5nU3RyaW5ncy5xNV9hZGQgKyAnPC9sYWJlbD5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+JyArICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSInICsgZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLnNlcnZlclVSTCArICcvaW1hZ2VzL2ZlZWRiYWNrRm9ybS9ub3VuX1BlbmNpbF8yNDg2MTQ5LnBuZyIgYWx0PSIiPicgKyAgICAgICAgICAgIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGV4dGFyZWEgaWQ9InE1X2FkZCIgcm93cz0iMyIgY29sdW1ucz0iNTAiPjwvdGV4dGFyZWE+XG4nICsgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+JyArICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4nICsgICAgICAgICAgICANCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgPC9maWVsZHNldD5cbicgKyAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImVyRmVlZGJhY2sgZXJGZWVkYmFja19wYWdlNyI+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InE2Ij48c3Ryb25nPicgKyBsYW5nU3RyaW5ncy5xNl8xICsgJzwvc3Ryb25nPicgKyBsYW5nU3RyaW5ncy5xNl8yICsgJzwvbGFiZWw+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDxkaXY+JyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9IicgKyBlYXN5UmVhZGluZy51aUNvbGxlY3Rpb24uc2VydmVyVVJMICsgJy9pbWFnZXMvZmVlZGJhY2tGb3JtL25vdW5fUGVuY2lsXzI0ODYxNDkucG5nIiBhbHQ9IiI+JyArICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPHRleHRhcmVhIGlkPSJxNiIgcm93cz0iMyIgY29sdW1ucz0iNTAiPjwvdGV4dGFyZWE+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgICAgIDwvZGl2PicgKyAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgIDwvZGl2PlxuJyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImVyRmVlZGJhY2sgZXJGZWVkYmFja19wYWdlOCI+JyArIGxhbmdTdHJpbmdzLnRoeCArICc8L2Rpdj5cbicgKyAgICAgICAgICAgICANCiAgICAgICAgICAgICcgICAgICAgICAgICA8L21haW4+XG4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICA8Zm9vdGVyIGNsYXNzPSJtb2RhbF9fZm9vdGVyIj5cbicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgICAgICA8aW1nIHNyYz0iJyArIGVhc3lSZWFkaW5nLnVpQ29sbGVjdGlvbi5zZXJ2ZXJVUkwgKyAnL2ltYWdlcy9mZWVkYmFja0Zvcm0vRVVfbG9nby5wbmciIGFsdD0iJyArIGxhbmdTdHJpbmdzLmFsdF9FVSArICciIHRpdGxlPSInICsgbGFuZ1N0cmluZ3MuYWx0X0VVICsgJyI+JyArICAgICAgICAgICAgDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgIDxkaXYgaWQ9ImVySDIwMjBOb3RlIj4nICsgbGFuZ1N0cmluZ3MuSDIwMjAgKyAnPC9kaXY+JyArDQogICAgICAgICAgICAnICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJpbWFnZSIgaWQ9ImVyQmFja0J0biIgYWx0PSInICsgbGFuZ1N0cmluZ3MuYWx0X2JhY2sgKyAnIiBzcmM9IicgKyBlYXN5UmVhZGluZy51aUNvbGxlY3Rpb24uc2VydmVyVVJMICsgJy9pbWFnZXMvZmVlZGJhY2tGb3JtL2Fycm93X2xlZnQucG5nIj4nICsNCiAgICAgICAgICAgICcgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImltYWdlIiBpZD0iZXJGb3J3YXJkQnRuIiBhbHQ9IicgKyBsYW5nU3RyaW5ncy5hbHRfZndkICsgJyIgc3JjPSInICsgZWFzeVJlYWRpbmcudWlDb2xsZWN0aW9uLnNlcnZlclVSTCArICcvaW1hZ2VzL2ZlZWRiYWNrRm9ybS9hcnJvd19yaWdodC5wbmciPicgKw0KICAgICAgICAgICAgJyAgICAgICAgICAgIDwvZm9vdGVyPlxuJyArDQogICAgICAgICAgICAnICAgICAgICA8L2Rpdj5cbicgKw0KICAgICAgICAgICAgJyAgICA8L2Rpdj5cbicgKw0KICAgICAgICAgICAgJzwvZGl2Pic7DQoNCiAgICAgICAgJCgiYm9keSIpLmFwcGVuZChmb3JtSFRNTCk7DQoNCiAgICAgICAgZmVlZGJhY2tGb3JtLmFkanVzdFBhZ2VWaXNpYmlsaXR5KCk7DQoNCiAgICAgICAgTWljcm9Nb2RhbC5zaG93KCdlci1mZWVkYmFjaycpOw0KDQogICAgICAgIGZlZWRiYWNrRm9ybS5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsNCg0KICAgICAgICAkKCIjZXJGb3J3YXJkQnRuIikuY2xpY2soZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBpZiAoZmVlZGJhY2tGb3JtLnZpc2libGVQYWdlID09PSA3KSB7DQogICAgICAgICAgICAgICAgbGV0IGZvcm1EYXRhID0gICd7JzsNCiAgICAgICAgICAgICAgICBpZiAoJCgnaW5wdXRbbmFtZT10cmllZEVSXTpjaGVja2VkJykudmFsKCkgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIGZvcm1EYXRhICs9ICcicTEiIDogJyArICQoJ2lucHV0W25hbWU9dHJpZWRFUl06Y2hlY2tlZCcpLnZhbCgpICsgJywnOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGZvcm1EYXRhICs9ICcicTEiIDogMCwnOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoJCgnaW5wdXRbbmFtZT1pbnN0YWxsZWRFUl06Y2hlY2tlZCcpLnZhbCgpICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICBmb3JtRGF0YSArPSAnInEzIiA6ICcgKyAkKCdpbnB1dFtuYW1lPWluc3RhbGxlZEVSXTpjaGVja2VkJykudmFsKCkgKyAnLCc7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgZm9ybURhdGEgKz0gJyJxMyIgOiAwLCc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICgkKCdpbnB1dFtuYW1lPWxpa2VFUl06Y2hlY2tlZCcpLnZhbCgpICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICBmb3JtRGF0YSArPSAnInEzIiA6ICcgKyAkKCdpbnB1dFtuYW1lPWxpa2VFUl06Y2hlY2tlZCcpLnZhbCgpICsgJywnOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGZvcm1EYXRhICs9ICcicTMiIDogMCwnOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmb3JtRGF0YSArPSAnInE0IiA6IHsnOw0KICAgICAgICAgICAgICAgIGlmICgkKCdpbnB1dFtuYW1lPXVzYWdlRVJdOmNoZWNrZWQnKS52YWwoKSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgZm9ybURhdGEgKz0gJyJxNF9tYWluIiA6ICcgKyAkKCdpbnB1dFtuYW1lPXVzYWdlRVJdOmNoZWNrZWQnKS52YWwoKSArICcsJzsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBmb3JtRGF0YSArPSAnInE0X21haW4iIDogMCwnOw0KICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgZm9ybURhdGEgKz0gJyJxNF9hZGQiIDogIicgKyAkKCcjcTRfYWRkJykudmFsKCkgKyAnIn0sJzsNCiAgICAgICAgICAgICAgICBmb3JtRGF0YSArPSAnInE1IiA6IHsnOw0KICAgICAgICAgICAgICAgIGlmICgkKCdpbnB1dFtuYW1lPWhlbHBlZEVSXTpjaGVja2VkJykudmFsKCkgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIGZvcm1EYXRhICs9ICcicTVfbWFpbiIgOiAnICsgJCgnaW5wdXRbbmFtZT1oZWxwZWRFUl06Y2hlY2tlZCcpLnZhbCgpICsgJywnOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGZvcm1EYXRhICs9ICcicTVfbWFpbiIgOiAwLCc7DQogICAgICAgICAgICAgICAgfSANCiAgICAgICAgICAgICAgICBmb3JtRGF0YSArPSAnInE1X2FkZCIgOiAiJyArICQoJyNxNV9hZGQnKS52YWwoKSArICcifSwnOw0KICAgICAgICAgICAgICAgIGZvcm1EYXRhICs9ICcicTYiIDogIicgKyAkKCcjcTYnKS52YWwoKS5yZXBsYWNlKC8oXHJcbnxcbnxccikvZ20sICIiKSArICcifSc7DQogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygkLnBhcnNlSlNPTihmb3JtRGF0YSkpOw0KICAgICAgICAgICAgICAgIGNvbnRlbnRTY3JpcHRDb250cm9sbGVyLnNlbmRNZXNzYWdlVG9CYWNrZ3JvdW5kU2NyaXB0KHsNCiAgICAgICAgICAgICAgICAgICAgdHlwZTogInN1cnZleVJlc3VsdCIsDQogICAgICAgICAgICAgICAgICAgIGRhdGE6IGZvcm1EYXRhLA0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZmVlZGJhY2tGb3JtLnZpc2libGVQYWdlKys7DQogICAgICAgICAgICBmZWVkYmFja0Zvcm0uYWRqdXN0UGFnZVZpc2liaWxpdHkoKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgJCgiI2VyQmFja0J0biIpLmNsaWNrKGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgZmVlZGJhY2tGb3JtLnZpc2libGVQYWdlLS07DQogICAgICAgICAgICBmZWVkYmFja0Zvcm0uYWRqdXN0UGFnZVZpc2liaWxpdHkoKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgJCgiI2VyRmVlZGJhY2tDYW5jZWwiKS5jbGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBmZWVkYmFja0Zvcm0ua2lsbEZlZWRiYWNrRm9ybSgpOw0KICAgICAgICB9KTsNCg0KICAgIH0sDQoNCiAgICBraWxsRmVlZGJhY2tGb3JtOiBmdW5jdGlvbiAoKSB7DQogICAgICAgIGlmKGZlZWRiYWNrRm9ybS5kaWFsb2dWaXNpYmxlKXsNCiAgICAgICAgICAgIE1pY3JvTW9kYWwuY2xvc2UoJ2VyLWZlZWRiYWNrJyk7DQogICAgICAgICAgICAkKCIjZXItZmVlZGJhY2siKS5yZW1vdmUoKTsNCiAgICAgICAgICAgIGZlZWRiYWNrRm9ybS5kaWFsb2dWaXNpYmxlID0gZmFsc2U7DQogICAgICAgICAgICBmZWVkYmFja0Zvcm0udmlzaWJsZVBhZ2UgPSAxOw0KICAgICAgICB9DQogICAgfSwNCg0KICAgIGFkanVzdFBhZ2VWaXNpYmlsaXR5OiBmdW5jdGlvbigpIHsNCiAgICAgICAgaWYgKGZlZWRiYWNrRm9ybS52aXNpYmxlUGFnZSA9PT0gMSkgew0KICAgICAgICAgICAgJCgnI2VyQmFja0J0bicpLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7DQogICAgICAgIH0gZWxzZSBpZiAoZmVlZGJhY2tGb3JtLnZpc2libGVQYWdlID09PSA4KSB7DQogICAgICAgICAgICAkKCIjZXJCYWNrQnRuIikucmVtb3ZlKCk7DQogICAgICAgICAgICAkKCIjZXJGb3J3YXJkQnRuIikucmVtb3ZlKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkKCcjZXJCYWNrQnRuJykucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7DQogICAgICAgIH0NCiAgICAgICAgJCgiLmVyRmVlZGJhY2siKS5jc3MoImRpc3BsYXkiLCAibm9uZSIpOw0KICAgICAgICAkKCIuZXJGZWVkYmFja19wYWdlIiArIGZlZWRiYWNrRm9ybS52aXNpYmxlUGFnZSkuY3NzKCJkaXNwbGF5IiwgImJsb2NrIik7DQogICAgfSwNCg0KICAgIGkxOG46IHsNCiAgICAgICAgZGU6IHsNCiAgICAgICAgICAgIGhlYWRpbmc6ICJSJnV1bWw7Y2ttZWxkZS1Cb2dlbiBFYXN5IFJlYWRpbmciLA0KICAgICAgICAgICAgYWx0X2xvZ286ICJMb2dvIEVhc3kgUmVhZGluZyIsDQogICAgICAgICAgICBjbG9zZUJ0bl9hcmlhTGFiZWw6ICJGZW5zdGVyIHNjaGxpZSZzemxpZztlbiIsDQogICAgICAgICAgICBoZWxsbzogIkhhbGxvLDxicj5rJm91bWw7bm5lbiBzaWUgdW5zIGVpbiBwYWFyIEZyYWdlbiBiZWFudHdvcnRlbj8iLA0KICAgICAgICAgICAgYW5vbnltb3VzOiAiSWhyZSBEYXRlbiBzaW5kIGFub255bSB1bmQgd2VyZGVuIG5pY2h0IGFuIERyaXR0ZSB3ZWl0ZXJnZWJlbi4iLA0KICAgICAgICAgICAgY29uc2VudDogIkluZGVtIHNpZSBmb3J0ZmFocmVuLCBzdGltbWVuIFNpZSB6dSwgZGFzcyBJaHJlIGFub255bWVuIEFudHdvcnRlbiBnZXNhbW1lbHQgdW5kIGYmdXVtbDtyIGRpZSBWZXJiZXNzZXJ1bmcgZGVzIEVhc3kgUmVhZGluZyBQcm9ncmFtbXMgdmVyd2VuZGV0IHdlcmRlbiBkJnV1bWw7cmZlbi4gRXMgd2VyZGVuIGtlaW5lIGFuZGVyZW4gSW5mb3JtYXRpb25lbiAmdXVtbDtiZXIgU2llIGdlc2FtbWVsdC4iLA0KICAgICAgICAgICAgcHJpdmFjeV9pbmZvOiAiTWVociBJbmZvcm1hdGlvbmVuIHp1bSBEYXRlbnNjaHV0eiBpbSBFYXN5IFJlYWRpbmcgUHJvamVrdCBmaW5kZW4gU2llIGhpZXI6PGJyPjxhIGhyZWY9J2h0dHBzOi8vd3d3LmVhc3lyZWFkaW5nLmV1Lz9wYWdlX2lkPTcyNiZsYW5nPWRlJz5odHRwczovL3d3dy5lYXN5cmVhZGluZy5ldS8/cGFnZV9pZD03MjYmbGFuZz1kZTwvYT4iLA0KICAgICAgICAgICAgcTFfbGVnZW5kOiAiSGFsbG8sIFNpZSBoYWJlbiBFYXN5IFJlYWRpbmcgYXVzcHJvYmllcnQuIiwNCiAgICAgICAgICAgIHExXzE6ICJJY2ggaGFiZSBFYXN5IFJlYWRpbmcgZGFzIDEuIE1hbCBiZW51dHp0LiIsDQogICAgICAgICAgICBxMV8yOiAiSWNoIGhhYmUgRWFzeSBSZWFkaW5nIHNjaG9uICZvdW1sO2Z0ZXIgYmVudXR6dC4iLA0KICAgICAgICAgICAgcTFfMzogIkljaCBiaW4gZWluZSBCZW51dHplcmluIG9kZXIgZWluIEJlbnV0emVyLiIsDQogICAgICAgICAgICBxMV80OiAiSWNoIGJpbiBlaW5lIFVudGVyc3QmdXVtbDt0emVyaW4gb2RlciBVbnRlcnN0JnV1bWw7dHplciw8YnI+dW5kIGRpZXMgaXN0IG1laW5lIGVpZ2VuZSBSJnV1bWw7Y2ttZWxkdW5nLiIsDQogICAgICAgICAgICBxMl9sZWdlbmRfMTogIkZyYWdlIDE8YnI+IiwNCiAgICAgICAgICAgIHEyX2xlZ2VuZF8yOiAiU2llIGhhYmVuIEVhc3kgUmVhZGluZyBhbHMgQWRkLU9uIGluc3RhbGxpZXJ0Ljxicj5IYWJlbiBzaWUgZGFzIEVhc3kgUmVhZGluZyBQcm9ncmFtbSBhbGxlaW5lIGluc3RhbGxpZXJ0PyIsDQogICAgICAgICAgICBxMl8xOiAiamEiLA0KICAgICAgICAgICAgcTJfMjogInRlaWx3ZWlzZSIsDQogICAgICAgICAgICBxMl8zOiAibmVpbiIsDQogICAgICAgICAgICBxMl80OiAid2VpJnN6bGlnOyBuaWNodCIsDQogICAgICAgICAgICBxM19sZWdlbmRfMTogIkZyYWdlIDI8YnI+IiwNCiAgICAgICAgICAgIHEzX2xlZ2VuZF8yOiAiR2VmJmF1bWw7bGx0IElobmVuIEVhc3kgUmVhZGluZz8iLA0KICAgICAgICAgICAgcTNfMTogImphIiwNCiAgICAgICAgICAgIHEzXzI6ICJ0ZWlsd2Vpc2UiLA0KICAgICAgICAgICAgcTNfMzogIm5laW4iLA0KICAgICAgICAgICAgcTNfNDogIndlaSZzemxpZzsgbmljaHQiLA0KICAgICAgICAgICAgcTRfbGVnZW5kXzE6ICJGcmFnZSAzPGJyPiIsDQogICAgICAgICAgICBxNF9sZWdlbmRfMjogIklzdCBFYXN5IFJlYWRpbmcgZWluZmFjaCB6dSBiZWRpZW5lbj8iLA0KICAgICAgICAgICAgcTRfMTogImphIiwNCiAgICAgICAgICAgIHE0XzI6ICJ0ZWlsd2Vpc2UiLA0KICAgICAgICAgICAgcTRfMzogIm5laW4iLA0KICAgICAgICAgICAgcTRfNDogIndlaSZzemxpZzsgbmljaHQiLA0KICAgICAgICAgICAgcTRfYWRkOiAiV2VubiBuZWluLDxicj53YXMgaXN0IHNjaHdpZXJpZyBhbiBkZW4gRWFzeSBSZWFkaW5nIEhpbGZlbj8iLA0KICAgICAgICAgICAgcTVfbGVnZW5kXzE6ICJGcmFnZSA0PGJyPiIsDQogICAgICAgICAgICBxNV9sZWdlbmRfMjogIkhhdCBJaG5lbiBFYXN5IFJlYWRpbmcgaW0gSW50ZXJuZXQgZ2Vob2xmZW4/IiwNCiAgICAgICAgICAgIHE1XzE6ICJqYSIsDQogICAgICAgICAgICBxNV8yOiAibmVpbiIsDQogICAgICAgICAgICBxNV8zOiAid2VpJnN6bGlnOyBuaWNodCIsDQogICAgICAgICAgICBxNV9hZGQ6ICJXZW5uIG5laW4sPGJyPndhcyBoYXQgZ2VmZWhsdD8iLCANCiAgICAgICAgICAgIHE2XzE6ICJGcmFnZSA1PGJyPiIsDQogICAgICAgICAgICBxNl8yOiAiV2llICBrYW5uIG1hbiBFYXN5IFJlYWRpbmcgbm9jaCBiZXNzZXIgbWFjaGVuPyIsDQogICAgICAgICAgICB0aHg6ICJEYW5rZSBmJnV1bWw7ciBJaHJlIE1pdGFyYmVpdCIsDQogICAgICAgICAgICBhbHRfRVU6ICJMb2dvIEV1cm9wJmF1bWw7aXNjaGUgVW5pb24iLA0KICAgICAgICAgICAgSDIwMjA6ICJEaWVzZXMgUHJvamVrdCBoYXQgdW50ZXIgVmVydHJhZ3NudW1tZXIgNzgwNTI5IEYmb3VtbDtyZGVyZ2VsZGVyIGF1cyBkZW0gSG9yaXpvbiAyMDIwIFByb2dyYW1tIGRlciBFdXJvcCZhdW1sO2lzY2hlbiBVbmlvbiBlcmhhbHRlbiIsDQogICAgICAgICAgICBhbHRfYmFjazogInp1ciZ1dW1sO2NrIiwNCiAgICAgICAgICAgIGFsdF9md2Q6ICJ3ZWl0ZXIiDQogICAgICAgIH0sDQogICAgICAgIGVuOiB7DQogICAgICAgICAgICBoZWFkaW5nOiAiRmVlZGJhY2sgU2hlZXQgRWFzeSBSZWFkaW5nIiwNCiAgICAgICAgICAgIGFsdF9sb2dvOiAiTG9nbyBFYXN5IFJlYWRpbmciLA0KICAgICAgICAgICAgY2xvc2VCdG5fYXJpYUxhYmVsOiAiQ2xvc2UiLA0KICAgICAgICAgICAgaGVsbG86ICJIZWxsbyw8YnI+Y2FuIHlvdSBhbnN3ZXIgYSBmZXcgcXVlc3Rpb25zPyIsDQogICAgICAgICAgICBhbm9ueW1vdXM6ICJZb3VyIGRhdGEgaXMgYW5vbnltb3VzIGFuZCB3aWxsIG5vdCBiZSBwYXNzZWQgb24gdG8gdGhpcmQgcGFydGllcy4iLA0KICAgICAgICAgICAgY29uc2VudDogIkJ5IGNvbnRpbnVpbmcgeW91IGFncmVlIHRoYXQgeW91ciBhbm9ueW1vdXMgYW5zd2VycyBjYW4gYmUgY29sbGVjdGVkIGFuZCB1c2VkIHRvIGltcHJvdmUgdGhlIEVhc3kgUmVhZGluZyBwcm9ncmFtLiBObyBvdGhlciBpbmZvcm1hdGlvbiBhYm91dCB5b3Ugd2lsbCBiZSBnYXRoZXJlZC4iLA0KICAgICAgICAgICAgcHJpdmFjeV9pbmZvOiAiTW9yZSBpbmZvcm1hdGlvbiBhYm91dCBkYXRhIHByaXZhY3kgaW4gdGhlIEVhc3kgUmVhZGluZyBwcm9qZWN0IGNhbiBiZSBmb3VuZCBoZXJlOjxicj48YSBocmVmPSdodHRwczovL3d3dy5lYXN5cmVhZGluZy5ldS8/cGFnZV9pZD03MjYmbGFuZz1lbic+aHR0cHM6Ly93d3cuZWFzeXJlYWRpbmcuZXUvP3BhZ2VfaWQ9NzI2Jmxhbmc9ZW48L2E+IiwNCiAgICAgICAgICAgIHExX2xlZ2VuZDogIkhlbGxvLDxicj55b3UgaGF2ZSB0cmllZCBFYXN5IFJlYWRpbmc/IiwNCiAgICAgICAgICAgIHExXzE6ICJJIHVzZWQgRWFzeSBSZWFkaW5nIGZvciB0aGUgZmlyc3QgdGltZS4iLA0KICAgICAgICAgICAgcTFfMjogIkkgaGF2ZSB1c2VkIEVhc3kgUmVhZGluZyBiZWZvcmUuIiwNCiAgICAgICAgICAgIHExXzM6ICJJIGFtIGEgVXNlci4iLA0KICAgICAgICAgICAgcTFfNDogIkkgYW0gYSBzdXBwb3J0ZXIgYW5kIHRoaXMgaXMgbXkgb3duIHJldmlldy4iLA0KICAgICAgICAgICAgcTJfbGVnZW5kXzE6ICJRdWVzdGlvbiAxPGJyPiIsDQogICAgICAgICAgICBxMl9sZWdlbmRfMjogIllvdSBpbnN0YWxsZWQgRWFzeSBSZWFkaW5nIGFzIGFuIGFkZC1vbi48YnI+RGlkIHlvdSBpbnN0YWxsIEVhc3kgUmVhZGluZyBieSB5b3Vyc2VsZj8iLA0KICAgICAgICAgICAgcTJfMTogInllcyIsDQogICAgICAgICAgICBxMl8yOiAicGFydGx5IiwNCiAgICAgICAgICAgIHEyXzM6ICJubyIsDQogICAgICAgICAgICBxMl80OiAiSSBkb24ndCBrbm93IiwNCiAgICAgICAgICAgIHEzX2xlZ2VuZF8xOiAiUXVlc3Rpb24gMjxicj4iLA0KICAgICAgICAgICAgcTNfbGVnZW5kXzI6ICJEbyB5b3UgbGlrZSBFYXN5IFJlYWRpbmc/IiwNCiAgICAgICAgICAgIHEzXzE6ICJ5ZXMiLA0KICAgICAgICAgICAgcTNfMjogInBhcnRseSIsDQogICAgICAgICAgICBxM18zOiAibm8iLA0KICAgICAgICAgICAgcTNfNDogIkkgZG9uJ3Qga25vdyIsDQogICAgICAgICAgICBxNF9sZWdlbmRfMTogIlF1ZXN0aW9uIDM8YnI+IiwNCiAgICAgICAgICAgIHE0X2xlZ2VuZF8yOiAiSXMgRWFzeSBSZWFkaW5nIGVhc3kgdG8gdXNlPyIsDQogICAgICAgICAgICBxNF8xOiAieWVzIiwNCiAgICAgICAgICAgIHE0XzI6ICJwYXJ0bHkiLA0KICAgICAgICAgICAgcTRfMzogIm5vIiwNCiAgICAgICAgICAgIHE0XzQ6ICJJIGRvbid0IGtub3ciLA0KICAgICAgICAgICAgcTRfYWRkOiAiSWYgbm8sPGJyPndoYXQgaXMgZGlmZmljdWx0IGFib3V0IHRoZSBFYXN5IFJlYWRpbmcgYWlkcz8iLA0KICAgICAgICAgICAgcTVfbGVnZW5kXzE6ICJRdWVzdGlvbiA0PGJyPiIsDQogICAgICAgICAgICBxNV9sZWdlbmRfMjogIkRpZCBFYXN5IFJlYWRpbmcgaGVscCB5b3U/IiwNCiAgICAgICAgICAgIHE1XzE6ICJ5ZXMiLA0KICAgICAgICAgICAgcTVfMjogIm5vIiwNCiAgICAgICAgICAgIHE1XzM6ICJJIGRvbid0IGtub3ciLA0KICAgICAgICAgICAgcTVfYWRkOiAiSWYgbm8sPGJyPndoYXQgZGlkIHlvdSBtaXNzIiwgDQogICAgICAgICAgICBxNl8xOiAiUXVlc3Rpb24gNTxicj4iLA0KICAgICAgICAgICAgcTZfMjogIldoYXQgY2FuIGJlIGltcHJvdmVkIHdpdGggRWFzeSBSZWFkaW5nPyIsDQogICAgICAgICAgICB0aHg6ICJUaGFuayB5b3UgZm9yIHlvdXIgY29vcGVyYXRpb24iLA0KICAgICAgICAgICAgYWx0X0VVOiAiTG9nbyBFdXJvcGVhbiBVbmlvbiIsDQogICAgICAgICAgICBIMjAyMDogIlRoaXMgcHJvamVjdCBoYXMgcmVjZWl2ZWQgZnVuZGluZyBmcm9tIHRoZSBFdXJvcGVhbiBVbmlvbidzIEhvcml6b24gMjAyMCByZXNlYXJjaCBhbmQgaW5ub3ZhdGlvbiBwcm9ncmFtbWUgdW5kZXIgZ3JhbnQgYWdyZWVtZW50IE5vLjc4MDUyOSIsDQogICAgICAgICAgICBhbHRfYmFjazogImJhY2siLA0KICAgICAgICAgICAgYWx0X2Z3ZDogImZvcndhcmQiDQogICAgICAgIH0sDQogICAgICAgIHN2OiB7DQogICAgICAgICAgICBoZWFkaW5nOiAiVXR2JmF1bWw7cmRlcmluZyBhdiBFYXN5IFJlYWRpbmciLA0KICAgICAgICAgICAgYWx0X2xvZ286ICJMb2dnYSBFYXN5IFJlYWRpbmciLA0KICAgICAgICAgICAgY2xvc2VCdG5fYXJpYUxhYmVsOiAic3QmYXVtbDtuZ2EiLA0KICAgICAgICAgICAgaGVsbG86ICJIZWosIHZpbGwgZHUgc3ZhcmEgcCZhcmluZzsgZXR0IHBhciBmciZhcmluZztnb3I/IiwgDQogICAgICAgICAgICBhbm9ueW1vdXM6ICJEaW4gZGF0YSAmYXVtbDtyIGFub255bSBvY2gga29tbWVyIGludGUgYXR0IGRlbGFzIG1lZCBuJmFyaW5nO2dvbiB0cmVkamUgcGFydC4iLA0KICAgICAgICAgICAgY29uc2VudDogIkdlbm9tIGF0dCBmb3J0cyZhdW1sO3R0YSBzYW10eWNrZXIgZHUgdGlsbCBhdHQgZGluYSBhbm9ueW1hIHN2YXIgc2FtbGFzIGluIG9jaCBhbnYmYXVtbDtuZHMgZiZvdW1sO3IgYXR0IGYmb3VtbDtyYiZhdW1sO3R0cmEgRWFzeSBSZWFkaW5nLXByb2dyYW1tZXQuIEluZ2VuIGFubmFuIGluZm9ybWF0aW9uIG9tIGRpZyBrb21tZXIgYXR0IHNhbWxhcyBpbi4iLA0KICAgICAgICAgICAgcHJpdmFjeV9pbmZvOiAiTWVyIGluZm9ybWF0aW9uIG9tIGh1ciBFYXN5IFJlYWRpbmctcHJvamVrdGV0IGhhbnRlcmFyIGluc2FtbGluZyBhdiBkYXRhIGhpdHRhciBkdSBoJmF1bWw7cjo8YnI+PGEgaHJlZj0naHR0cHM6Ly93d3cuZWFzeXJlYWRpbmcuZXUvP3BhZ2VfaWQ9NzI2Jmxhbmc9c3YnPmh0dHBzOi8vd3d3LmVhc3lyZWFkaW5nLmV1Lz9wYWdlX2lkPTcyNiZsYW5nPXN2PC9hPiIsDQogICAgICAgICAgICBxMV9sZWdlbmQ6ICJIZWosIGhhciBkdSBwcm92YXQgRWFzeSBSZWFkaW5nPyIsDQogICAgICAgICAgICBxMV8xOiAiRGV0ICZhdW1sO3IgZiZvdW1sO3JzdGEgZyZhcmluZztuZ2VuIGphZyBhbnYmYXVtbDtuZGVyIEVhc3kgUmVhZGluZyIsDQogICAgICAgICAgICBxMV8yOiAiSmFnIGhhciBhbnYmYXVtbDtudCBFYXN5IFJlYWRpbmcgZiZvdW1sO3J1dCIsDQogICAgICAgICAgICBxMV8zOiAiSmFnICZhdW1sO3IgYW52JmF1bWw7bmRhcmUiLA0KICAgICAgICAgICAgcTFfNDogIkphZyAmYXVtbDtyIHN0Jm91bWw7ZHBlcnNvbiBvY2ggc3ZhcmFyIGYmb3VtbDtyIG1pZyBzaiZhdW1sO2x2IiwNCiAgICAgICAgICAgIHEyX2xlZ2VuZF8xOiAiRnImYXJpbmc7Z2EgMSIsDQogICAgICAgICAgICBxMl9sZWdlbmRfMjogIlRhY2sgZiZvdW1sO3IgYXR0IGR1IGhhciBpbnN0YWxsZXJhdCBFYXN5IFJlYWRpbmcgc29tIGV0dCB0aWxsJmF1bWw7Z2cgdGlsbCBkaW4gd2ViYmwmYXVtbDtzYXJlLjxicj5JbnN0YWxsZXJhZGUgZHUgRWFzeSBSZWFkaW5nIHNqJmF1bWw7bHY/IiwNCiAgICAgICAgICAgIHEyXzE6ICJqYSIsDQogICAgICAgICAgICBxMl8yOiAiZGVsdmlzIiwNCiAgICAgICAgICAgIHEyXzM6ICJuZWoiLA0KICAgICAgICAgICAgcTJfNDogImphZyB2ZXQgaW50ZSIsDQogICAgICAgICAgICBxM19sZWdlbmRfMTogIkZyJmFyaW5nO2dhIDIiLA0KICAgICAgICAgICAgcTNfbGVnZW5kXzI6ICJUeWNrZXIgZHUgb20gRWFzeSBSZWFkaW5nPyIsDQogICAgICAgICAgICBxM18xOiAiamEiLA0KICAgICAgICAgICAgcTNfMjogImRlbHZpcyIsDQogICAgICAgICAgICBxM18zOiAibmVqIiwNCiAgICAgICAgICAgIHEzXzQ6ICJqYWcgdmV0IGludGUiLA0KICAgICAgICAgICAgcTRfbGVnZW5kXzE6ICJGciZhcmluZztnYSAzPGJyPiIsDQogICAgICAgICAgICBxNF9sZWdlbmRfMjogIiZBdW1sO3IgRWFzeSBSZWFkaW5nIGVua2VsdCBhdHQgYW52JmF1bWw7bmRhPyIsDQogICAgICAgICAgICBxNF8xOiAiamEiLA0KICAgICAgICAgICAgcTRfMjogImRlbHZpcyIsDQogICAgICAgICAgICBxNF8zOiAibmVqIiwNCiAgICAgICAgICAgIHE0XzQ6ICJqYWcgdmV0IGludGUiLCANCiAgICAgICAgICAgIHE0X2FkZDogIk9tIGR1IHN2YXJhZGUgbmVqLDxicj52YWQgJmF1bWw7ciBzdiZhcmluZztydCBuJmF1bWw7ciBkdSBhbnYmYXVtbDtuZGVyIEVhc3kgUmVhZGluZz8iLA0KICAgICAgICAgICAgcTVfbGVnZW5kXzE6ICJGciZhcmluZztnYSA0PGJyPiIsDQogICAgICAgICAgICBxNV9sZWdlbmRfMjogIkhqJmF1bWw7bHB0ZSBFYXN5IFJlYWRpbmcgZGlnPyIsDQogICAgICAgICAgICBxNV8xOiAiamEiLA0KICAgICAgICAgICAgcTVfMjogIm5laiIsDQogICAgICAgICAgICBxNV8zOiAiamFnIHZldCBpbnRlIiwNCiAgICAgICAgICAgIHE1X2FkZDogIk9tIGR1IHN2YXJhZGUgbmVqLDxicj52YWQgaGFkZSBkdSB2ZWxhdCBoYSBmJm91bWw7ciBoaiZhdW1sO2xwPyIsIA0KICAgICAgICAgICAgcTZfMTogIkZyJmFyaW5nO2dhIDQ8YnI+IiwNCiAgICAgICAgICAgIHE2XzI6ICJIdXIga2FuIEVhc3kgUmVhZGluZyBibGkgYiZhdW1sO3R0cmU/IiwNCiAgICAgICAgICAgIHRoeDogIlRhY2sgZiZvdW1sO3IgZGluIG1lZHZlcmthbiEiLA0KICAgICAgICAgICAgYWx0X0VVOiAiTG9nZ2EgRXVyb3BlaXNrYSB1bmlvbmVuIiwNCiAgICAgICAgICAgIEgyMDIwOiAiRGV0IGgmYXVtbDtyIHByb2pla3RldCBoYXIgZiZhcmluZzt0dCBmaW5hbnNpZXJpbmcgZnImYXJpbmc7biBIb3Jpc29udCAyMDIwLCBFdXJvcGVpc2thIFVuaW9uZW5zIHJhbXByb2dyYW0gZiZvdW1sO3IgZm9yc2tuaW5nIG9jaCBpbm5vdmF0aW9uLCBhdnRhbCBuciA3ODA1MjkiLA0KICAgICAgICAgICAgYWx0X2JhY2s6ICJ0aWxsYmFrYSIsDQogICAgICAgICAgICBhbHRfZndkOiAiZm9ydHMmYXVtbDt0dGEiDQogICAgICAgIH0sDQogICAgICAgIGVzOiB7DQogICAgICAgICAgICAvLyBUT0RPOiBzb21lb25lIHRyYW5zbGF0ZSB0byBTcGFuaXNoDQogICAgICAgICAgICBoZWFkaW5nOiAiRmVlZGJhY2sgU2hlZXQgRWFzeSBSZWFkaW5nIiwNCiAgICAgICAgICAgIGFsdF9sb2dvOiAiTG9nbyBFYXN5IFJlYWRpbmciLA0KICAgICAgICAgICAgY2xvc2VCdG5fYXJpYUxhYmVsOiAiQ2xvc2UiLA0KICAgICAgICAgICAgaGVsbG86ICJIZWxsbyw8YnI+Y2FuIHlvdSBhbnN3ZXIgYSBmZXcgcXVlc3Rpb25zPyIsDQogICAgICAgICAgICBhbm9ueW1vdXM6ICJZb3VyIGRhdGEgaXMgYW5vbnltb3VzIGFuZCB3aWxsIG5vdCBiZSBwYXNzZWQgb24gdG8gdGhpcmQgcGFydGllcy4iLA0KICAgICAgICAgICAgY29uc2VudDogIkJ5IGNvbnRpbnVpbmcgeW91IGFncmVlIHRoYXQgeW91ciBhbm9ueW1vdXMgYW5zd2VycyBjYW4gYmUgY29sbGVjdGVkIGFuZCB1c2VkIHRvIGltcHJvdmUgdGhlIEVhc3kgUmVhZGluZyBwcm9ncmFtLiBObyBvdGhlciBpbmZvcm1hdGlvbiBhYm91dCB5b3Ugd2lsbCBiZSBnYXRoZXJlZC4iLA0KICAgICAgICAgICAgcHJpdmFjeV9pbmZvOiAiTW9yZSBpbmZvcm1hdGlvbiBhYm91dCBkYXRhIHByaXZhY3kgaW4gdGhlIEVhc3kgUmVhZGluZyBwcm9qZWN0IGNhbiBiZSBmb3VuZCBoZXJlOjxicj48YSBocmVmPSdodHRwczovL3d3dy5lYXN5cmVhZGluZy5ldS8/cGFnZV9pZD03MjYmbGFuZz1lbic+aHR0cHM6Ly93d3cuZWFzeXJlYWRpbmcuZXUvP3BhZ2VfaWQ9NzI2Jmxhbmc9ZW48L2E+IiwNCiAgICAgICAgICAgIHExX2xlZ2VuZDogIkhlbGxvLDxicj55b3UgaGF2ZSB0cmllZCBFYXN5IFJlYWRpbmc/IiwNCiAgICAgICAgICAgIHExXzE6ICJJIHVzZWQgRWFzeSBSZWFkaW5nIGZvciB0aGUgZmlyc3QgdGltZS4iLA0KICAgICAgICAgICAgcTFfMjogIkkgaGF2ZSB1c2VkIEVhc3kgUmVhZGluZyBiZWZvcmUuIiwNCiAgICAgICAgICAgIHExXzM6ICJJIGFtIGEgVXNlci4iLA0KICAgICAgICAgICAgcTFfNDogIkkgYW0gYSBzdXBwb3J0ZXIgYW5kIHRoaXMgaXMgbXkgb3duIHJldmlldy4iLA0KICAgICAgICAgICAgcTJfbGVnZW5kXzE6ICJRdWVzdGlvbiAxPGJyPiIsDQogICAgICAgICAgICBxMl9sZWdlbmRfMjogIllvdSBpbnN0YWxsZWQgRWFzeSBSZWFkaW5nIGFzIGFuIGFkZC1vbi48YnI+RGlkIHlvdSBpbnN0YWxsIEVhc3kgUmVhZGluZyBieSB5b3Vyc2VsZj8iLA0KICAgICAgICAgICAgcTJfMTogInllcyIsDQogICAgICAgICAgICBxMl8yOiAicGFydGx5IiwNCiAgICAgICAgICAgIHEyXzM6ICJubyIsDQogICAgICAgICAgICBxMl80OiAiSSBkb24ndCBrbm93IiwNCiAgICAgICAgICAgIHEzX2xlZ2VuZF8xOiAiUXVlc3Rpb24gMjxicj4iLA0KICAgICAgICAgICAgcTNfbGVnZW5kXzI6ICJEbyB5b3UgbGlrZSBFYXN5IFJlYWRpbmc/IiwNCiAgICAgICAgICAgIHEzXzE6ICJ5ZXMiLA0KICAgICAgICAgICAgcTNfMjogInBhcnRseSIsDQogICAgICAgICAgICBxM18zOiAibm8iLA0KICAgICAgICAgICAgcTNfNDogIkkgZG9uJ3Qga25vdyIsDQogICAgICAgICAgICBxNF9sZWdlbmRfMTogIlF1ZXN0aW9uIDM8YnI+IiwNCiAgICAgICAgICAgIHE0X2xlZ2VuZF8yOiAiSXMgRWFzeSBSZWFkaW5nIGVhc3kgdG8gdXNlPyIsDQogICAgICAgICAgICBxNF8xOiAieWVzIiwNCiAgICAgICAgICAgIHE0XzI6ICJwYXJ0bHkiLA0KICAgICAgICAgICAgcTRfMzogIm5vIiwNCiAgICAgICAgICAgIHE0XzQ6ICJJIGRvbid0IGtub3ciLA0KICAgICAgICAgICAgcTRfYWRkOiAiSWYgbm8sPGJyPndoYXQgaXMgZGlmZmljdWx0IGFib3V0IHRoZSBFYXN5IFJlYWRpbmcgYWlkcz8iLA0KICAgICAgICAgICAgcTVfbGVnZW5kXzE6ICJRdWVzdGlvbiA0PGJyPiIsDQogICAgICAgICAgICBxNV9sZWdlbmRfMjogIkRpZCBFYXN5IFJlYWRpbmcgaGVscCB5b3U/IiwNCiAgICAgICAgICAgIHE1XzE6ICJ5ZXMiLA0KICAgICAgICAgICAgcTVfMjogIm5vIiwNCiAgICAgICAgICAgIHE1XzM6ICJJIGRvbid0IGtub3ciLA0KICAgICAgICAgICAgcTVfYWRkOiAiSWYgbm8sPGJyPndoYXQgZGlkIHlvdSBtaXNzIiwgDQogICAgICAgICAgICBxNl8xOiAiUXVlc3Rpb24gNTxicj4iLA0KICAgICAgICAgICAgcTZfMjogIldoYXQgY2FuIGJlIGltcHJvdmVkIHdpdGggRWFzeSBSZWFkaW5nPyIsDQogICAgICAgICAgICB0aHg6ICJUaGFuayB5b3UgZm9yIHlvdXIgY29vcGVyYXRpb24iLA0KICAgICAgICAgICAgYWx0X0VVOiAiTG9nbyBFdXJvcGVhbiBVbmlvbiIsDQogICAgICAgICAgICBIMjAyMDogIlRoaXMgcHJvamVjdCBoYXMgcmVjZWl2ZWQgZnVuZGluZyBmcm9tIHRoZSBFdXJvcGVhbiBVbmlvbidzIEhvcml6b24gMjAyMCByZXNlYXJjaCBhbmQgaW5ub3ZhdGlvbiBwcm9ncmFtbWUgdW5kZXIgZ3JhbnQgYWdyZWVtZW50IE5vLjc4MDUyOSIsDQogICAgICAgICAgICBhbHRfYmFjazogImJhY2siLA0KICAgICAgICAgICAgYWx0X2Z3ZDogImZvcndhcmQiDQogICAgICAgIH0gICAgICAgIA0KICAgIH0NCg0KfTs=",
        "Y2xhc3MgUHJlc2VudGF0aW9uew0KICAgIGNvbnN0cnVjdG9yKGZ1bmN0aW9uSW5mbywgdXNlckludGVyZmFjZSxjb25maWd1cmF0aW9uKXsNCg0KICAgICAgICB0aGlzLmZ1bmN0aW9uSW5mbyA9IGZ1bmN0aW9uSW5mbzsNCiAgICAgICAgdGhpcy51c2VySW50ZXJmYWNlID0gdXNlckludGVyZmFjZTsNCiAgICAgICAgdGhpcy5jb25maWd1cmF0aW9uID0gY29uZmlndXJhdGlvbjsNCiAgICAgICAgdGhpcy5yZXF1ZXN0Q291bnRlciA9IDA7DQogICAgICAgIHRoaXMuaXNDb21wYXRpYmxlV2l0aE90aGVyUHJlc2VudGF0aW9ucyA9IGZhbHNlOw0KICAgICAgICB0aGlzLmluc3RhbnREaXNwbGF5ID0gdHJ1ZTsNCiAgICAgICAgdGhpcy5sYXN0UmVxdWVzdElEID0gbnVsbDsNCg0KICAgIH0NCg0KICAgIHJlbmRlclJlc3VsdChyZXF1ZXN0LHJlc3VsdCl7DQoNCiAgICB9DQoNCg0KICAgIHJlbW92ZVJlc3VsdChyZXN1bHRJRCl7DQoNCiAgICB9DQoNCiAgICByZW1vdmVMYXN0UmVzdWx0KCkgew0KICAgICAgICBpZiAodGhpcy5sYXN0UmVxdWVzdElEKSB7DQogICAgICAgICAgICB0aGlzLnJlbW92ZVJlc3VsdCh0aGlzLmxhc3RSZXF1ZXN0SUQpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgdW5kbygpew0KDQogICAgfQ0KDQogICAgcmVtb3ZlKCl7DQogICAgICAgIGNvbnNvbGUubG9nKCJSZW1vdmluZyBwcmVzZW50YXRpb24iKTsNCiAgICB9DQoNCiAgICByZW1vdmVBbmltYXRlZFJlc3VsdCgpew0KDQogICAgfQ0KDQogICAgZ2V0SUQoKXsNCiAgICAgICAgcmV0dXJuIHRoaXMudXNlckludGVyZmFjZS51aUlkKyItIit0aGlzLmZ1bmN0aW9uSW5mby50b29sSWQ7DQogICAgfQ0KDQogICAgZ2V0UHJlc2VudGF0aW9uQW5kUmVxdWVzdElkZW50aWZpZXIocmVxdWVzdElEKXsNCiAgICAgICAgcmV0dXJuICdkYXRhLXByZXNlbnRhdGlvbmlkPSInK3RoaXMuZ2V0SUQoKSsnIiBkYXRhLXJlcXVlc3RpZD0iJytyZXF1ZXN0SUQrJyInOw0KICAgIH0NCg0KICAgIGdldFJlc3VsdENsYXNzKCl7DQogICAgICAgIHJldHVybiAiZWFzeS1yZWFkaW5nLXJlc3VsdCI7DQogICAgfQ0KDQogICAgY3JlYXRlUmVxdWVzdElkKCl7DQogICAgICAgIHRoaXMucmVxdWVzdENvdW50ZXIrKzsNCiAgICAgICAgdGhpcy5sYXN0UmVxdWVzdElEID0gImVyLXJlc3VsdC0iK3RoaXMuZ2V0SUQoKSsiLSIrdGhpcy5yZXF1ZXN0Q291bnRlcjsNCiAgICAgICAgcmV0dXJuIHRoaXMubGFzdFJlcXVlc3RJRDsNCiAgICB9DQoNCiAgICBzZXRUb29sSW5kZXgodG9vbEluZGV4KXsNCiAgICAgICAgdGhpcy50b29sSW5kZXggPSB0b29sSW5kZXg7DQogICAgfQ0KDQogICAgZ2V0V2lkZ2V0KCl7DQoNCiAgICAgICAgcmV0dXJuIHRoaXMudXNlckludGVyZmFjZS50b29sc1t0aGlzLnRvb2xJbmRleF0ud2lkZ2V0Ow0KICAgIH0NCg0KICAgIHVwZGF0ZUNvbmZpZ3VyYXRpb25BbmRGdW5jdGlvbihjb25maWd1cmF0aW9uLGZ1bmN0aW9uSW5mbyl7DQogICAgICAgIHRoaXMuZnVuY3Rpb25JbmZvID0gZnVuY3Rpb25JbmZvOw0KICAgICAgICB0aGlzLmNvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uOw0KICAgICAgICB0aGlzLnRvb2xJZCA9IHRoaXMuZnVuY3Rpb25JbmZvLnRvb2xJZDsNCiAgICB9DQoNCn0=",
        "Y2xhc3MgVXNlckludGVyZmFjZUJhc2V7DQogICAgY29uc3RydWN0b3IoY29uZmlndXJhdGlvbix0YWJDb25maWd1cmF0aW9uKXsNCg0KICAgICAgICB0aGlzLmNvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uOw0KICAgICAgICB0aGlzLnRhYkNvbmZpZ3VyYXRpb24gPSB0YWJDb25maWd1cmF0aW9uOw0KICAgIH0NCg0KDQogICAgaW5pdFVJKCl7DQoNCiAgICB9DQoNCg0KICAgIHNob3coKXsNCg0KDQogICAgfQ0KDQogICAgaGlkZSgpew0KDQogICAgfQ0KDQogICAgZ2V0VG9vbENvbnRhaW5lcklERm9yTGF5b3V0KHRvb2xJRCxsYXlvdXRDb25maWcsb3JkZXIpew0KDQogICAgfQ0KDQogICAgcmVtb3ZlQ29udGFpbmVyRm9yVG9vbCh0b29sSUQpew0KDQogICAgfQ0KDQogICAgdG9vbHNMb2FkZWQoKSB7DQoNCiAgICB9DQoNCiAgICByZW1vdmUoKXsNCiAgICAgICAgY29uc29sZS5sb2coIlJlbW92aW5nIHVzZXIgaW50ZXJmYWNlOiIpOw0KICAgIH0NCg0KICAgIHVpVXBkYXRlZCgpew0KDQoNCiAgICB9DQoNCg0KDQp9",
        "Y2xhc3MgV2lkZ2V0QmFzZXsNCg0KICAgIGNvbnN0cnVjdG9yKGZ1bmN0aW9uSW5mbywgdXNlckludGVyZmFjZSx0YXJnZXRJRCwgY29uZmlndXJhdGlvbil7DQogICAgICAgIHRoaXMuZnVuY3Rpb25JbmZvID0gZnVuY3Rpb25JbmZvOw0KICAgICAgICB0aGlzLnVzZXJJbnRlcmZhY2UgPSB1c2VySW50ZXJmYWNlOw0KICAgICAgICB0aGlzLnRhcmdldElEID0gdGFyZ2V0SUQ7DQogICAgICAgIHRoaXMuY29uZmlndXJhdGlvbiA9IGNvbmZpZ3VyYXRpb247DQogICAgICAgIHRoaXMudG9vbElkID0gdGhpcy5mdW5jdGlvbkluZm8udG9vbElkOw0KICAgICAgICB0aGlzLndpZGdldElEID0gdXNlckludGVyZmFjZS5pZCsiXyIrZnVuY3Rpb25JbmZvLnNvdXJjZS5pZCsiXyIrZnVuY3Rpb25JbmZvLnRvb2xJZDsNCg0KICAgIH0NCg0KICAgIGRpc2FibGUoKXsNCg0KICAgIH0NCg0KICAgIGVuYWJsZSgpew0KDQogICAgfQ0KDQoNCiAgICBwcmVzZW50YXRpb25GaW5pc2hlZChwcmVzZW50YXRpb24pew0KDQogICAgfQ0KDQogICAgcmVxdWVzdEZhaWxlZChyZXEsY29uZmlnKXsNCg0KICAgIH0NCg0KICAgIGFjdGl2YXRlV2lkZ2V0KCl7DQoNCg0KICAgIH0NCiAgICBkZWFjdGl2YXRlV2lkZ2V0KG1hbnVhbD10cnVlKXsNCiAgICAgICAgaWYoZWFzeVJlYWRpbmcudXNlckludGVyZmFjZXNbdGhpcy51c2VySW50ZXJmYWNlLnVpSWRdKXsNCiAgICAgICAgICAgIGlmKGVhc3lSZWFkaW5nLnVzZXJJbnRlcmZhY2VzW3RoaXMudXNlckludGVyZmFjZS51aUlkXS50b29sc1t0aGlzLnRvb2xJbmRleF0pew0KICAgICAgICAgICAgICAgIGlmKGVhc3lSZWFkaW5nLnVzZXJJbnRlcmZhY2VzW3RoaXMudXNlckludGVyZmFjZS51aUlkXS50b29sc1t0aGlzLnRvb2xJbmRleF0ucHJlc2VudGF0aW9uKXsNCiAgICAgICAgICAgICAgICAgICAgZWFzeVJlYWRpbmcudXNlckludGVyZmFjZXNbdGhpcy51c2VySW50ZXJmYWNlLnVpSWRdLnRvb2xzW3RoaXMudG9vbEluZGV4XS5wcmVzZW50YXRpb24ucmVtb3ZlQW5pbWF0ZWRSZXN1bHQoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKG1hbnVhbCkgew0KICAgICAgICAgICAgICAgICAgICAvLyBJZiByZXF1ZXN0IGhhcyBiZWVuIG1hbnVhbGx5IGNhbmNlbGxlZCBieSB1c2VyLCBpbmZvcm0gcmVhc29uZXINCiAgICAgICAgICAgICAgICAgICAgY29udGVudFNjcmlwdENvbnRyb2xsZXIuc2VuZE1lc3NhZ2VUb0JhY2tncm91bmRTY3JpcHQoew0KICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImhlbHBDYW5jZWxsZWQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgdWlfaTogdGhpcy51c2VySW50ZXJmYWNlLmlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgdG9vbF9pOiB0aGlzLnRvb2xJZCwNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJlcXVlc3RNYW5hZ2VyLmNhbmNlbFJlcXVlc3QodGhpcyk7DQogICAgfQ0KDQoNCiAgICB3aWRnZXRBY3RpdmF0ZWQod2lkZ2V0KXsNCiAgICAgICAgaWYod2lkZ2V0ICE9PSB0aGlzKXsNCg0KICAgICAgICAgICAgLyoNCiAgICAgICAgICAgIGlmKGVhc3lSZWFkaW5nLnVzZXJJbnRlcmZhY2VzW3RoaXMudXNlckludGVyZmFjZS51aUlkXSl7DQogICAgICAgICAgICAgICAgaWYoZWFzeVJlYWRpbmcudXNlckludGVyZmFjZXNbdGhpcy51c2VySW50ZXJmYWNlLnVpSWRdLnRvb2xzW3RoaXMudG9vbElkXSl7DQogICAgICAgICAgICAgICAgICAgIGlmKGVhc3lSZWFkaW5nLnVzZXJJbnRlcmZhY2VzW3RoaXMudXNlckludGVyZmFjZS51aUlkXS50b29sc1t0aGlzLnRvb2xJZF0ucHJlc2VudGF0aW9uKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVhc3lSZWFkaW5nLnVzZXJJbnRlcmZhY2VzW3RoaXMudXNlckludGVyZmFjZS51aUlkXS50b29sc1t0aGlzLnRvb2xJZF0ucHJlc2VudGF0aW9uLnJlbW92ZVJlc3VsdCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgKi8NCiAgICAgICAgICAgIHJlcXVlc3RNYW5hZ2VyLmNhbmNlbFJlcXVlc3QodGhpcyk7DQogICAgICAgICAgICB0aGlzLmRlYWN0aXZhdGVXaWRnZXQoZmFsc2UpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmVxdWVzdEZpbmlzaGVkKCkgew0KDQogICAgfQ0KDQogICAgZ2V0UHJlc2VudGF0aW9uKCl7DQoNCiAgICAgICAgcmV0dXJuIHRoaXMudXNlckludGVyZmFjZS50b29sc1t0aGlzLnRvb2xJbmRleF0ucHJlc2VudGF0aW9uOw0KICAgIH0NCg0KICAgIHN0b3BQcmVzZW50YXRpb24oKXsNCg0KICAgICAgICBsZXQgcHJlc2VudGF0aW9uID0gdGhpcy5nZXRQcmVzZW50YXRpb24oKTsNCg0KICAgICAgICBpZihwcmVzZW50YXRpb24pew0KICAgICAgICAgICAgcHJlc2VudGF0aW9uLnJlbW92ZVJlc3VsdCgpOw0KICAgICAgICB9DQoNCg0KICAgIH0NCg0KICAgIHJlbW92ZSgpew0KICAgICAgICBjb25zb2xlLmxvZygiUmVtb3Zpbmcgd2lkZ2V0OiIpOw0KICAgIH0NCg0KICAgIHNldFRvb2xJbmRleCh0b29sSW5kZXgpew0KICAgICAgICB0aGlzLnRvb2xJbmRleCA9IHRvb2xJbmRleDsNCiAgICB9DQoNCiAgICB1cGRhdGVDb25maWd1cmF0aW9uQW5kRnVuY3Rpb24oY29uZmlndXJhdGlvbixmdW5jdGlvbkluZm8pew0KICAgICAgICB0aGlzLmZ1bmN0aW9uSW5mbyA9IGZ1bmN0aW9uSW5mbzsNCiAgICAgICAgdGhpcy5jb25maWd1cmF0aW9uID0gY29uZmlndXJhdGlvbjsNCiAgICAgICAgdGhpcy50b29sSWQgPSB0aGlzLmZ1bmN0aW9uSW5mby50b29sSWQ7DQogICAgfQ0KDQoNCn0=",
        "Y2xhc3MgQnVzeUFuaW1hdGlvbiB7DQogICAgY29uc3RydWN0b3IoY29uZmlndXJhdGlvbikgew0KICAgICAgICB0aGlzLmNvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uOw0KICAgIH0NCg0KICAgIHN0YXJ0QW5pbWF0aW9uKHRleHRub2Rlcyl7DQoNCiAgICB9DQoNCiAgICBzdG9wQW5pbWF0aW9uKCl7DQoNCiAgICB9DQoNCiAgICByZW1vdmUoKXsNCiAgICAgICAgY29uc29sZS5sb2coIlJlbW92aW5nIGFuaW1hdGlvbjoiKTsNCiAgICB9DQp9DQo=",
        "Y2xhc3MgUGx1Z2luIHsNCiAgICBjb25zdHJ1Y3Rvcihjb25maWd1cmF0aW9uKSB7DQogICAgICAgIHRoaXMuY29uZmlndXJhdGlvbiA9IGNvbmZpZ3VyYXRpb247DQogICAgfQ0KfQ0K"
    ],
    "staticCSS": [
        "Lm1vZGFsIHsNCiAgICBmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSxCbGlua01hY1N5c3RlbUZvbnQsYXZlbmlyIG5leHQsYXZlbmlyLGhlbHZldGljYSBuZXVlLGhlbHZldGljYSx1YnVudHUscm9ib3RvLG5vdG8sc2Vnb2UgdWksYXJpYWwsc2Fucy1zZXJpZjsNCn0NCg0KLm1vZGFsX19vdmVybGF5IHsNCiAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgdG9wOiAwOw0KICAgIGxlZnQ6IDA7DQogICAgcmlnaHQ6IDA7DQogICAgYm90dG9tOiAwOw0KICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC42KTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi5tb2RhbF9fY29udGFpbmVyIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOw0KICAgIHBhZGRpbmc6IDMwcHg7DQogIC8qICBtYXgtd2lkdGg6IDUwMHB4OyAqLw0KICAgIG1heC1oZWlnaHQ6IDEwMHZoOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCi8qICAgIG92ZXJmbG93LXk6IGF1dG87ICovDQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgICBmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSxCbGlua01hY1N5c3RlbUZvbnQsYXZlbmlyIG5leHQsYXZlbmlyLGhlbHZldGljYSBuZXVlLGhlbHZldGljYSx1YnVudHUscm9ib3RvLG5vdG8sc2Vnb2UgdWksYXJpYWwsc2Fucy1zZXJpZiAhaW1wb3J0YW50Ow0KfQ0KDQoubW9kYWxfX2hlYWRlciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCn0NCg0KLm1vZGFsX190aXRsZSB7DQogICAgbWFyZ2luLXRvcDogMDsNCiAgICBtYXJnaW4tYm90dG9tOiAwOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgZm9udC1zaXplOiAyMHB4ICFpbXBvcnRhbnQ7DQogICAgbGluZS1oZWlnaHQ6IDEuMjU7DQogICAgY29sb3I6ICMwMDQ0OWUgIWltcG9ydGFudDsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KfQ0KDQoNCg0KLm1vZGFsX19oZWFkZXIgLm1vZGFsX19jbG9zZTpiZWZvcmUgeyBjb250ZW50OiAiXDI3MTUiOyB9DQoNCi5tb2RhbF9fY29udGVudCB7DQogICAgbWFyZ2luLXRvcDogMnJlbTsNCiAgICBtYXJnaW4tYm90dG9tOiAycmVtOw0KICAgIGxpbmUtaGVpZ2h0OiAxLjU7DQogICAgY29sb3I6IHJnYmEoMCwwLDAsLjgpOw0KfQ0KDQoubW9kYWxfX2J0biB7DQogICAgZm9udC1zaXplOiAxOHB4Ow0KICAgIHBhZGRpbmctbGVmdDogMXJlbTsNCiAgICBwYWRkaW5nLXJpZ2h0OiAxcmVtOw0KICAgIHBhZGRpbmctdG9wOiAuNXJlbTsNCiAgICBwYWRkaW5nLWJvdHRvbTogLjVyZW07DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2U2ZTZlNjsNCiAgICBjb2xvcjogcmdiYSgwLDAsMCwuOCk7DQogICAgYm9yZGVyLXJhZGl1czogLjI1cmVtOw0KICAgIGJvcmRlci1zdHlsZTogbm9uZTsNCiAgICBib3JkZXItd2lkdGg6IDA7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIC13ZWJraXQtYXBwZWFyYW5jZTogYnV0dG9uOw0KICAgIHRleHQtdHJhbnNmb3JtOiBub25lOw0KICAgIG92ZXJmbG93OiB2aXNpYmxlOw0KICAgIGxpbmUtaGVpZ2h0OiAxLjE1Ow0KICAgIG1hcmdpbjogMDsNCg0KfQ0KDQoNCi5tb2RhbF9fYnRuLXByaW1hcnkgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDQ0OWU7DQogICAgY29sb3I6ICNmZmY7DQp9DQoNCg0KDQovKioqKioqKioqKioqKioqKioqKioqKioqKipcDQogIERlbW8gQW5pbWF0aW9uIFN0eWxlDQpcKioqKioqKioqKioqKioqKioqKioqKioqKiovDQpAa2V5ZnJhbWVzIG1tZmFkZUluIHsNCiAgICBmcm9tIHsgb3BhY2l0eTogMDsgfQ0KICAgIHRvIHsgb3BhY2l0eTogMTsgfQ0KfQ0KDQpAa2V5ZnJhbWVzIG1tZmFkZU91dCB7DQogICAgZnJvbSB7IG9wYWNpdHk6IDE7IH0NCiAgICB0byB7IG9wYWNpdHk6IDA7IH0NCn0NCg0KQGtleWZyYW1lcyBtbXNsaWRlSW4gew0KICAgIGZyb20geyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMTUlKTsgfQ0KICAgIHRvIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOyB9DQp9DQoNCkBrZXlmcmFtZXMgbW1zbGlkZU91dCB7DQogICAgZnJvbSB7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgfQ0KICAgIHRvIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xMCUpOyB9DQp9DQoNCi5taWNyb21vZGFsLXNsaWRlIHsNCiAgICBkaXNwbGF5OiBub25lOw0KfQ0KDQoubWljcm9tb2RhbC1zbGlkZS5pcy1vcGVuIHsNCiAgICBkaXNwbGF5OiBibG9jazsNCn0NCg0KLm1pY3JvbW9kYWwtc2xpZGVbYXJpYS1oaWRkZW49ImZhbHNlIl0gLm1vZGFsX19vdmVybGF5IHsNCiAgICBhbmltYXRpb246IG1tZmFkZUluIC4zcyBjdWJpYy1iZXppZXIoMC4wLCAwLjAsIDAuMiwgMSk7DQp9DQoNCi5taWNyb21vZGFsLXNsaWRlW2FyaWEtaGlkZGVuPSJmYWxzZSJdIC5tb2RhbF9fY29udGFpbmVyIHsNCiAgICBhbmltYXRpb246IG1tc2xpZGVJbiAuM3MgY3ViaWMtYmV6aWVyKDAsIDAsIC4yLCAxKTsNCn0NCg0KLm1pY3JvbW9kYWwtc2xpZGVbYXJpYS1oaWRkZW49InRydWUiXSAubW9kYWxfX292ZXJsYXkgew0KICAgIGFuaW1hdGlvbjogbW1mYWRlT3V0IC4zcyBjdWJpYy1iZXppZXIoMC4wLCAwLjAsIDAuMiwgMSk7DQp9DQoNCi5taWNyb21vZGFsLXNsaWRlW2FyaWEtaGlkZGVuPSJ0cnVlIl0gLm1vZGFsX19jb250YWluZXIgew0KICAgIGFuaW1hdGlvbjogbW1zbGlkZU91dCAuM3MgY3ViaWMtYmV6aWVyKDAsIDAsIC4yLCAxKTsNCn0NCg0KLm1pY3JvbW9kYWwtc2xpZGUgLm1vZGFsX19jb250YWluZXIsDQoubWljcm9tb2RhbC1zbGlkZSAubW9kYWxfX292ZXJsYXkgew0KICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm07DQogICAgei1pbmRleDogOTk5OTk5OTk5OTk5OTk5Ow0KfQ0KDQoucmVjb21tZW5kYXRpb25faW1hZ2U+aW1new0KICAgIG1heC1oZWlnaHQ6IDE1MHB4Ow0KfQ0KLnJlY29tbWVuZGF0aW9uX3llc3sNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgbGVmdDogMjBweDsNCiAgICBtaW4td2lkdGg6IDUwcHg7DQp9DQoNCi5yZWNvbW1lbmRhdGlvbl9ub3sNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgcmlnaHQ6IDIwcHg7DQogICAgbWluLXdpZHRoOiA1MHB4Ow0KfQ0KLnJlY29tbWVuZGF0aW9uX291dGVyew0KICAgIGZsb2F0OiByaWdodDsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgbGVmdDogLTUwJTsNCn0NCg0KLnJlY29tbWVuZGF0aW9uX2Z1bmN0aW9uX2NvbnRhaW5lcnsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgYm9yZGVyOiAycHggc29saWQgYmxhY2s7DQogICAgcGFkZGluZzogMTBweDsNCiAgICBib3JkZXItcmFkaXVzOiAxMHB4Ow0KICAgIGZsb2F0OiBsZWZ0Ow0KICAgIG1heC13aWR0aDogMjUwcHg7DQogICAgbWFyZ2luOiA1cHg7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIGxlZnQ6IDUwJTsNCg0KfQ0KDQoubW9kYWxfX2Nsb3NlIHsNCiAgICBib3JkZXI6IDJweCBzb2xpZCBibGFjazsNCiAgICBib3JkZXItcmFkaXVzOiAzcHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2U2ZTZlNiAhaW1wb3J0YW50Ow0KICAgIGZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLEJsaW5rTWFjU3lzdGVtRm9udCxhdmVuaXIgbmV4dCxhdmVuaXIsaGVsdmV0aWNhIG5ldWUsaGVsdmV0aWNhLHVidW50dSxyb2JvdG8sbm90byxzZWdvZSB1aSxhcmlhbCxzYW5zLXNlcmlmOw0KICAgIC8qIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OyovDQogICAgY29sb3I6IGJsYWNrICFpbXBvcnRhbnQ7DQogICAgbWluLWhlaWdodDogMjVweDsNCiAgICBtaW4td2lkdGg6IDI1cHg7DQogICAgcGFkZGluZzogM3B4Ow0KICAgIG1hcmdpbjogaW5pdGlhbDsNCn0NCg0KLm1vZGFsX19jbG9zZTpob3ZlciwubW9kYWxfX2Nsb3NlOmZvY3Vzew0KDQogICAgY29sb3I6IHdoaXRlISBpbXBvcnRhbnQ7DQogICAgYmFja2dyb3VuZC1jb2xvcjogIzE4MTMxNyAhaW1wb3J0YW50Ow0KDQp9DQoNCg0KLnJlY29tbWVuZGF0aW9uX2Rlc2NyaXB0aW9uew0KICAgIGZvbnQtc2l6ZTogMTVweDsNCn0NCg0KDQoucmVjb21tZW5kYXRpb25fZnVuY3Rpb25fY29udGFpbmVyPmgzew0KICAgIGZvbnQtc2l6ZTogMTVweCAhaW1wb3J0YW50Ow0KICAgIGZvbnQtd2VpZ2h0OiBib2xkICFpbXBvcnRhbnQ7DQp9DQoNCi5yZWNvbW1lbmRhdGlvbl9mdW5jdGlvbl9jb250YWluZXI+aDN7DQogICAgZm9udC1zaXplOiAxNXB4ICFpbXBvcnRhbnQ7DQogICAgZm9udC13ZWlnaHQ6IGJvbGQgIWltcG9ydGFudDsNCn0NCg0KLnJlY29tbWVuZGF0aW9uX2Z1bmN0aW9uX2NvbnRhaW5lcj5kaXZ7DQogICAgZm9udC1zaXplOiAxNXB4ICFpbXBvcnRhbnQ7DQp9DQoNCi5tb2RhbF9fZm9vdGVyew0KICAgIGNsZWFyOiBib3RoOw0KfQ0KDQoubW9kYWxfX2Zvb3RlcjphZnRlcnsNCiAgICBjbGVhcjogYm90aDsNCn0=",
        "Lm1vZGFsX19jb250YWluZXIgew0KICAgIGZvbnQtZmFtaWx5OiBBcmlhbCwgSGVsdmV0aWNhLCBzYW5zLXNlcmlmOw0KICAgIGJvcmRlcjogNXB4IHNvbGlkICMwMDg1NTA7DQogICAgcGFkZGluZzogNXB4Ow0KICAgIHdpZHRoOiA0NWVtOw0KICAgIGhlaWdodDogNDJlbTsNCiAgICBmb250LXNpemU6IGluaXRpYWw7DQogICAgY29sb3I6IGJsYWNrOw0KfQ0KDQoubW9kYWxfX2NvbnRhaW5lciBmaWVsZHNldCB7DQogICAgYm9yZGVyOiBub25lOw0KfQ0KDQoubW9kYWxfX2NvbnRhaW5lciB0ZXh0YXJlYSB7DQogICAgZm9udC1zaXplOiBpbml0aWFsOw0KfQ0KDQoubW9kYWxfX2NvbnRhaW5lciBpbnB1dFt0eXBlPSdyYWRpbyddIHsNCiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuNSk7DQogICAgLW1vei10cmFuc2Zvcm06IHNjYWxlKDEuNSk7DQogICAgLXdlYmtpdC10cmFuc2Zvcm06IHNjYWxlKDEuNSk7DQogICAgYm9yZGVyOiBub25lOw0KICAgIGhlaWdodDogMS41ZW07DQogICAgd2lkdGg6IDEuNWVtOw0KICAgIC13ZWJraXQtYXBwZWFyYW5jZTogcmFkaW87DQogICAgZm9udC1zaXplOiBpbml0aWFsOw0KfQ0KDQoubW9kYWxfX2NvbnRhaW5lciBmb290ZXIgew0KICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50Ow0KICAgIHBhZGRpbmc6IDA7DQp9DQoNCiNlci1mZWVkYmFjay1sb2dvIHsNCiAgICB3aWR0aDogM2VtOw0KICAgIGhlaWdodDogM2VtOw0KfQ0KDQoubW9kYWxfX2hlYWRlciB7DQogICAgZGlzcGxheTogZ3JpZDsNCiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDMwZW0gMS41ZW07DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBtYXJnaW4tdG9wOiAwOw0KfQ0KDQoubW9kYWxfX2hlYWRlciBkaXYgew0KICAgIGZsb2F0OiBsZWZ0Ow0KICAgIG1hcmdpbi10b3A6IDAuNWVtOw0KfQ0KDQoubW9kYWxfX2NvbnRlbnQgew0KICAgIG1hcmdpbjogMWVtOw0KfQ0KDQoubW9kYWxfX2NvbnRlbnQgbGVnZW5kIHsNCiAgICBmb250LWZhbWlseTogQXJpYWwsIEhlbHZldGljYSwgc2Fucy1zZXJpZjsNCiAgICBjb2xvcjogYmxhY2s7DQogICAgcGFkZGluZy1ib3R0b206IDFlbTsNCiAgICBmb250LXNpemU6IDEuNWVtOw0KfQ0KDQoubW9kYWxfX2NvbnRlbnQgbGFiZWwgew0KICAgIGZvbnQtc2l6ZTogMS41ZW07DQp9DQoNCiNlci1mZWVkYmFjay10aXRsZSwgLmVyRmVlZGJhY2tfcGFnZTEsIC5lckZlZWRiYWNrX3BhZ2U4IHsNCiAgICBjb2xvcjogIzAwODU1MCAhaW1wb3J0YW50Ow0KfQ0KDQojaGVsbG9fMSwgLmVyRmVlZGJhY2tfcGFnZTggew0KICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgIGZvbnQtc2l6ZTogMmVtOw0KfQ0KDQojaGVsbG9fMSB7DQogICAgbWFyZ2luLXRvcDogMWVtOw0KICAgIG1hcmdpbi1ib3R0b206IDFlbTsNCn0NCg0KI2hlbGxvXzIsICNoZWxsb18zLCAjaGVsbG9fNCB7DQogICAgbWFyZ2luLWJvdHRvbTogMWVtOzsNCiAgICBmb250LXNpemU6IDEuMmVtOw0KfQ0KDQouZXJGZWVkYmFja19wYWdlOCB7DQogICAgbWFyZ2luLXRvcDogNGVtOw0KfQ0KDQouZXJGZWVkYmFja19wYWdlMiBpbnB1dFt0eXBlPSdyYWRpbyddIHsNCiAgICBtYXJnaW4tbGVmdDogMzdlbTsNCn0NCg0KLmVyRmVlZGJhY2tfcGFnZTIgaW1nIHsNCiAgICB3aWR0aDogMS44ZW07DQogICAgaGVpZ2h0OiAxLjhlbTsNCiAgICBmbG9hdDogbGVmdDsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQp9DQoNCi5lckZlZWRiYWNrX3BhZ2UyIGRpdiB7DQogICAgaGVpZ2h0OiAyLjVlbTsNCn0NCg0KLmVyUmFkaW9MYWJlbCB7DQogICAgZmxvYXQ6IGxlZnQ7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIG1hcmdpbi1sZWZ0OiAyLjNlbTsNCn0NCg0KLnJhZGlvRGl2IHsNCiAgICBmbG9hdDogbGVmdDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgcGFkZGluZy1yaWdodDogMWVtOw0KICAgIHBhZGRpbmctYm90dG9tOiAxZW07DQp9DQoNCi5yYWRpb0RpdiBpbWcgew0KICAgIGRpc3BsYXk6IGlubGluZTsNCiAgICB3aWR0aDogNGVtOw0KICAgIGhlaWdodDogNGVtOw0KfQ0KDQoucmFkaW9EaXYgbGFiZWwgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KfQ0KDQouYWRkRGl2IHsNCiAgICBjbGVhcjogbGVmdDsNCn0NCg0KLmFkZERpdiBpbWcgew0KICAgIGZsb2F0OiBsZWZ0Ow0KICAgIHdpZHRoOiAzZW07DQogICAgaGVpZ2h0OiAzZW07DQp9DQoNCiNxNF9hZGQsICNxNV9hZGQgew0KICAgIG1pbi1oZWlnaHQ6IDhlbTsNCiAgICBtaW4td2lkdGg6IDM1ZW07DQogICAgaGVpZ2h0OiA4ZW07DQogICAgd2lkdGg6IDM1ZW07DQogICAgbWF4LWhlaWdodDogOGVtOw0KICAgIG1heC13aWR0aDogMzVlbTsNCn0NCg0KI3E2IHsNCiAgICBtaW4taGVpZ2h0OiAyMmVtOw0KICAgIG1pbi13aWR0aDogMzVlbTsNCiAgICBoZWlnaHQ6IDIyZW07DQogICAgd2lkdGg6IDM1ZW07DQogICAgbWF4LWhlaWdodDogMjJlbTsNCiAgICBtYXgtd2lkdGg6IDM1ZW07DQp9DQoNCi5lckZlZWRiYWNrX3BhZ2U3IGltZyB7DQogICAgZmxvYXQ6IGxlZnQ7DQogICAgd2lkdGg6IDNlbTsNCiAgICBoZWlnaHQ6IDNlbTsNCn0NCg0KLm1vZGFsX19jbG9zZSB7DQogICAgbWFyZ2luLWJvdHRvbTogMmVtOw0KICAgIHdpZHRoOiAxLjNlbTsNCiAgICBoZWlnaHQ6IDIuN2VtOw0KfQ0KDQoubW9kYWxfX2Nsb3NlOmZvY3VzIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZTZlNmU2ICFpbXBvcnRhbnQ7DQogICAgY29sb3I6IGJsYWNrICFpbXBvcnRhbnQ7DQp9DQoNCi5tb2RhbF9fZm9vdGVyIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgdG9wOiAzN2VtOw0KICAgIGRpc3BsYXk6IGdyaWQ7DQogICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiA0ZW0gYXV0byA4ZW0gM2VtOw0KICAgIHdpZHRoOiA0My41ZW07DQp9DQoNCi5tb2RhbF9fZm9vdGVyIGltZyB7DQogICAgd2lkdGg6IDRlbTsNCiAgICBoZWlnaHQ6IDRlbTsNCn0NCg0KI2VySDIwMjBOb3RlIHsNCiAgICBmb250LXNpemU6IDcwJTsNCiAgICBtYXJnaW4tbGVmdDogMS41ZW07DQogICAgbWFyZ2luLXRvcDogMC41ZW07DQogICAgcGFkZGluZzogNXB4Ow0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA4NTUwOw0KICAgIGhlaWdodDogNWVtOw0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQp9DQoNCiNlckJhY2tCdG4gew0KICAgIGZvbnQtc2l6ZTogaW5pdGlhbDsNCiAgICB3aWR0aDogM2VtOw0KICAgIG1hcmdpbi1sZWZ0OiA1ZW07DQogICAgbWFyZ2luLXRvcDogMC41ZW07DQogICAgcGFkZGluZzogMDsNCiAgICBib3JkZXI6IG5vbmU7DQp9DQoNCiNlckZvcndhcmRCdG4gew0KICAgIGZvbnQtc2l6ZTogaW5pdGlhbDsNCiAgICB3aWR0aDogM2VtOw0KICAgIG1hcmdpbi10b3A6IDAuNWVtOw0KICAgIHBhZGRpbmc6IDA7DQogICAgYm9yZGVyOiBub25lOw0KfQ0K"
    ],
    "loginType": "Anonym",
    "busyAnimation": {
        "source": {
            "id": "spinner",
            "name": "Spinner",
            "description": "A simple spinning animation.",
            "version": "1.0",
            "versionDescription": "Initial Version",
            "debugMode": false,
            "remoteAssetDirectory": "",
            "remoteBaseDirectory": "components/busy-animation/spinner/1.0/",
            "implementationClass": "SpinnerBusyAnimation",
            "contentScripts": [
                {
                    "id": "animation/spinner.js",
                    "source": "Y2xhc3MgU3Bpbm5lckJ1c3lBbmltYXRpb24gZXh0ZW5kcyBCdXN5QW5pbWF0aW9uew0KDQogICAgY29uc3RydWN0b3IoY29uZmlndXJhdGlvbil7DQogICAgICAgIHN1cGVyKGNvbmZpZ3VyYXRpb24pOw0KDQogICAgICAgIHRoaXMubnVtYmVyT2ZCdXN5UmVxdWVzdHMgPSAwOw0KDQogICAgICAgICQoImJvZHkiKS5hcHBlbmQoJzxkaXYgaWQ9ImVyLWJ1c3ktYW5pbWF0aW9uIiBzdHlsZT0iZGlzcGxheTogbm9uZSIgY2xhc3M9Imxkcy1yaW5nIj48ZGl2PjwvZGl2PjxkaXY+PC9kaXY+PGRpdj48L2Rpdj48ZGl2PjwvZGl2PjwvZGl2PicpOw0KICAgICAgICAkKGRvY3VtZW50KS5vbignbW91c2Vtb3ZlJywgZnVuY3Rpb24oZSl7DQogICAgICAgICAgICAkKCcjZXItYnVzeS1hbmltYXRpb24nKS5jc3Moew0KICAgICAgICAgICAgICAgIGxlZnQ6ICBlLnBhZ2VYLTMwLA0KICAgICAgICAgICAgICAgIHRvcDogICBlLnBhZ2VZKzIwDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgfQ0KDQoNCiAgICBzdGFydEFuaW1hdGlvbih0ZXh0bm9kZXMpew0KICAgICAgICB0aGlzLm51bWJlck9mQnVzeVJlcXVlc3RzKys7DQogICAgICAgICQoJyNlci1idXN5LWFuaW1hdGlvbicpLnNob3coKTsNCg0KICAgIH0NCg0KICAgIHN0b3BBbmltYXRpb24oKXsNCiAgICAgICAgdGhpcy5udW1iZXJPZkJ1c3lSZXF1ZXN0cy0tOw0KICAgICAgICAkKCcjZXItYnVzeS1hbmltYXRpb24nKS5oaWRlKCk7DQoNCiAgICB9DQp9DQo="
                }
            ],
            "contentCSS": [
                {
                    "id": "animation/spinner.css",
                    "css": "Lmxkcy1yaW5nIHsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHdpZHRoOiA2NHB4Ow0KICAgIGhlaWdodDogNjRweDsNCiAgICB6LWluZGV4OiA5OTk5OTk5OTsNCn0NCi5sZHMtcmluZyBkaXYgew0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHdpZHRoOiA1MXB4Ow0KICAgIGhlaWdodDogNTFweDsNCiAgICBtYXJnaW46IDZweDsNCiAgICBib3JkZXI6IDZweCBzb2xpZCBibHVlOw0KICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICBhbmltYXRpb246IGxkcy1yaW5nIDEuMnMgY3ViaWMtYmV6aWVyKDAuNSwgMCwgMC41LCAxKSBpbmZpbml0ZTsNCiAgICBib3JkZXItY29sb3I6IGJsdWUgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQ7DQp9DQoubGRzLXJpbmcgZGl2Om50aC1jaGlsZCgxKSB7DQogICAgYW5pbWF0aW9uLWRlbGF5OiAtMC40NXM7DQp9DQoubGRzLXJpbmcgZGl2Om50aC1jaGlsZCgyKSB7DQogICAgYW5pbWF0aW9uLWRlbGF5OiAtMC4zczsNCn0NCi5sZHMtcmluZyBkaXY6bnRoLWNoaWxkKDMpIHsNCiAgICBhbmltYXRpb24tZGVsYXk6IC0wLjE1czsNCn0NCkBrZXlmcmFtZXMgbGRzLXJpbmcgew0KICAgIDAlIHsNCiAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7DQogICAgfQ0KICAgIDEwMCUgew0KICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOw0KICAgIH0NCn0="
                }
            ]
        },
        "configuration": {
            "backgroundColor": "#000000",
            "fontColor": "#FFFFFF"
        }
    },
    "isNewProfile": true,
    "classMapping": "aWYoY2xhc3NNYXBwaW5nKXtkZWxldGUgY2xhc3NNYXBwaW5nO30gdmFyIGNsYXNzTWFwcGluZyA9IHsnQ29udGludW91c0Nob2ljZUJ1dHRvbic6Q29udGludW91c0Nob2ljZUJ1dHRvbiwnQXVkaW9IaWdobGlnaHRlcic6QXVkaW9IaWdobGlnaHRlciwnVHdvU3RhdGVCdXR0b24nOlR3b1N0YXRlQnV0dG9uLCdBdXRvQnV0dG9uJzpBdXRvQnV0dG9uLCdDb250ZW50UmVwbGFjZW1lbnRTd2l0Y2hlcic6Q29udGVudFJlcGxhY2VtZW50U3dpdGNoZXIsJ0J1dHRvbic6QnV0dG9uLCdTaW5nbGVDaG9pY2VCdXR0b24nOlNpbmdsZUNob2ljZUJ1dHRvbiwnVGlwcHlUb29sdGlwJzpUaXBweVRvb2x0aXAsJ1RhYlNsaWRlT3V0VXNlckludGVyZmFjZSc6VGFiU2xpZGVPdXRVc2VySW50ZXJmYWNlLCdTcGlubmVyQnVzeUFuaW1hdGlvbic6U3Bpbm5lckJ1c3lBbmltYXRpb24sfTtpZihmdW5jdGlvbk1hcHBpbmcpe2RlbGV0ZSBmdW5jdGlvbk1hcHBpbmc7fSAgdmFyIGZ1bmN0aW9uTWFwcGluZyA9IHsnY29sb3JpemUnOmNvbG9yaXplLCdtYWduaWZ5Rm9udCc6bWFnbmlmeUZvbnQsJ3Nocmlua0ZvbnQnOnNocmlua0ZvbnQsJ2luY3JlYXNlTGluZUhlaWdodCc6aW5jcmVhc2VMaW5lSGVpZ2h0LCdkZWNyZWFzZUxpbmVIZWlnaHQnOmRlY3JlYXNlTGluZUhlaWdodCwncmVhZGFiaWxpdHknOnJlYWRhYmlsaXR5LCdlYXN5UmVhZGluZ1NjcmVlblJ1bGVyJzplYXN5UmVhZGluZ1NjcmVlblJ1bGVyLH07"
}


let webSocket = new WebSocket("wss://localhost:8080");
webSocket.onopen = function(ev){
    webSocket.send(JSON.stringify({
        type:"embeddedLogin"
    }));
};
webSocket.onmessage = function(ev){
    let receivedMessage = JSON.parse(message.data);
    contentScriptController.receiveMessageFromBackgroundScript(receivedMessage);

};
webSocket.onclose = function(ev){
    console.log(ev);
};
webSocket.onerror = function(ev){
    console.log(ev);
};

let contentScriptController = {
    debugModeListenerStarted:false,
    profileReceived: false,
    init: function () {


    },

    receiveMessageFromBackgroundScript : function (m) {
        requestManager.receiveRequestResult(m);
    },
    easyReadingUiUpdate:function (event){
        // easyReading.busyAnimation.startAnimation();
    },
    sendMessageToBackgroundScript: function(message) {
        if(message.type == "cloudRequest"){
            if(webSocket.readyState){
                webSocket.send(JSON.stringify(message));
            }

        }

    },





};

let util ={
    isDefined: function (obj) {
        if (obj !== undefined && obj !== null && obj !== "" && obj !== {} && obj !== []) {
            return true;
        }
        return true;
    },
    appendPathToUrl:function (url, str) {
        if (url.startsWith("wss://")) {
            url = url.substr(6, url.length - 1);
        }
        if (!str.startsWith('/')) {
            str = '/' + str;
        }
        return "https://" + url + '/' + str;
    }
};
easyReading.startup(uiCollection);
